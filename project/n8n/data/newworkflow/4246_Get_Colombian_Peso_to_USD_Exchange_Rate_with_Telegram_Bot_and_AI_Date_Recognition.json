{
  "url": "https://n8n.io/workflows/4246-get-colombian-peso-to-usd-exchange-rate-with-telegram-bot-and-ai-date-recognition/",
  "title": "Get Colombian Peso to USD Exchange Rate with Telegram Bot and AI Date Recognition",
  "author": "Juan Sanchez",
  "publish_date": "Last update 4 days ago",
  "publish_date_absolute": "2025-05-22",
  "categories": [
    {
      "name": "Finance"
    },
    {
      "name": "AI"
    }
  ],
  "workflow_json": "{\"id\":\"MVcw4IwqLxTDzdt5\",\"meta\":{\"instanceId\":\"51270372ea87f40bc06437a6d111ae29e684e524a2e6c52d7a6f84dde18d4a17\",\"templateCredsSetupCompleted\":true},\"name\":\"Personal - Solicitar TRM\",\"tags\":[],\"nodes\":[{\"id\":\"f1d44561-9c6a-4e5d-835b-630e858a3181\",\"name\":\"OpenAI Chat Model\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\"position\":[1140,-620],\"parameters\":{\"model\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"gpt-4.1-nano\",\"cachedResultName\":\"gpt-4.1-nano\"},\"options\":{\"maxRetries\":2,\"temperature\":0}},\"credentials\":{\"openAiApi\":{\"id\":\"BfhecJBx32L0a2gT\",\"name\":\"OpenAi account\"}},\"typeVersion\":1.2},{\"id\":\"2b3a4c40-77b2-48d3-a2af-8fc084d24183\",\"name\":\"Once a Telegram Message is received\",\"type\":\"n8n-nodes-base.telegramTrigger\",\"position\":[-400,-840],\"webhookId\":\"76fd085e-cba0-40ab-9937-3efb9057d4de\",\"parameters\":{\"updates\":[\"message\"],\"additionalFields\":{}},\"credentials\":{\"telegramApi\":{\"id\":\"xxxxxxx\",\"name\":\"name_bot\"}},\"typeVersion\":1.2},{\"id\":\"d8686b18-59d7-461d-a24a-d8f44703db2c\",\"name\":\"Local Current Date and Time\",\"type\":\"n8n-nodes-base.code\",\"position\":[920,-840],\"parameters\":{\"jsCode\":\"const now = new Date();\\n\\n// Ajustar a hora local de Colombia (UTC-5)\\nconst utc = now.getTime() + now.getTimezoneOffset() * 60000;\\nconst colombiaTime = new Date(utc - 5 * 3600000);\\n\\n// Formato YYYY-MM-DD\\nconst fecha = colombiaTime.toISOString().split('T')[0];\\n\\n// Formato YYYY-MM-DD HH:mm:ss\\nconst fechaHora = colombiaTime.toISOString().replace('T', ' ').substring(0, 19);\\n\\nreturn [\\n  {\\n    json: {\\n      fecha_actual: fecha,\\n      fecha_hora_actual: fechaHora,\\n    }\\n  }\\n];\"},\"typeVersion\":2},{\"id\":\"022626cd-5a65-4225-9307-817a024799c2\",\"name\":\"Validate if Date is in the past\",\"type\":\"n8n-nodes-base.if\",\"position\":[1700,-840],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"b245d771-5b2e-4384-8357-0357e5a1ce2e\",\"operator\":{\"type\":\"dateTime\",\"operation\":\"after\"},\"leftValue\":\"={{ $json.output.date }}\",\"rightValue\":\"={{ $('Local Current Date and Time').item.json.fecha_actual }}\"}]}},\"typeVersion\":2.2},{\"id\":\"f40edcdb-ff34-491e-b460-f09353aba40f\",\"name\":\"Notify past date\",\"type\":\"n8n-nodes-base.telegram\",\"position\":[1920,-940],\"webhookId\":\"4761d2c3-62ee-413d-b114-67ef7a49f4eb\",\"parameters\":{\"text\":\"=Fecha posterior a fecha actual\",\"chatId\":\"={{ $('Once a Telegram Message is received').item.json.message.from.id }}\",\"additionalFields\":{\"appendAttribution\":false}},\"credentials\":{\"telegramApi\":{\"id\":\"xxxxxx\",\"name\":\"name_bot\"}},\"typeVersion\":1.2},{\"id\":\"9d8c17b5-ce7f-40c0-8e35-64b9b42927f5\",\"name\":\"Get TRM\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[1920,-740],\"parameters\":{\"url\":\"=https://www.datos.gov.co/resource/32sa-8pi3.json?vigenciadesde={{ $json.output.date }}\",\"options\":{}},\"typeVersion\":4.2,\"alwaysOutputData\":true},{\"id\":\"cd58e419-7d3a-4314-afa3-9fde3c7e998b\",\"name\":\"Check if Valor exists\",\"type\":\"n8n-nodes-base.if\",\"position\":[2140,-740],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"9f3ed730-0414-4f19-9941-2e6663ae221c\",\"operator\":{\"type\":\"string\",\"operation\":\"exists\",\"singleValue\":true},\"leftValue\":\"={{ $json.valor }}\",\"rightValue\":\"\"}]}},\"typeVersion\":2.2},{\"id\":\"1813eccf-36ae-4201-bbbd-3bc6ebf63e3d\",\"name\":\"Send message to user\",\"type\":\"n8n-nodes-base.telegram\",\"position\":[2360,-840],\"webhookId\":\"4761d2c3-62ee-413d-b114-67ef7a49f4eb\",\"parameters\":{\"text\":\"={{ $json.valor }}\\nTRM del {{ $('Extractor Agent').item.json.output.date }}\",\"chatId\":\"={{ $('Once a Telegram Message is received').item.json.message.from.id }}\",\"additionalFields\":{\"appendAttribution\":false}},\"credentials\":{\"telegramApi\":{\"id\":\"xxxxxx\",\"name\":\"name_bot\"}},\"typeVersion\":1.2},{\"id\":\"93bb62fb-6e42-4498-a758-4d99ea54a852\",\"name\":\"Generate an array with 10 numbers\",\"type\":\"n8n-nodes-base.code\",\"position\":[2360,-640],\"parameters\":{\"jsCode\":\"// Generar array del 1 al 10\\nconst counter = Array.from({ length: 10 }, (_, i) => i + 1);\\n\\n// Devolver el resultado en el formato adecuado\\nreturn [\\n  {\\n    json: {\\n      counter\\n    }\\n  }\\n];\"},\"typeVersion\":2},{\"id\":\"c85942c6-1627-49d4-8f62-ffda4f08c6f1\",\"name\":\"Split Items for the loop\",\"type\":\"n8n-nodes-base.splitOut\",\"position\":[2580,-640],\"parameters\":{\"options\":{},\"fieldToSplitOut\":\"counter\"},\"typeVersion\":1},{\"id\":\"9c57b15e-958e-4b1a-ac30-701e7b874319\",\"name\":\"Get the last 10 responses\",\"type\":\"n8n-nodes-base.splitInBatches\",\"position\":[2800,-640],\"parameters\":{\"options\":{}},\"typeVersion\":3},{\"id\":\"59168aad-9ec1-4dc9-9c46-85c1cf4f40a6\",\"name\":\"Get TRM for past date\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[3240,-490],\"parameters\":{\"url\":\"=https://www.datos.gov.co/resource/32sa-8pi3.json?vigenciadesde={{ $json.adjustedDate }}\",\"options\":{}},\"typeVersion\":4.2,\"alwaysOutputData\":true},{\"id\":\"9a802ea6-8591-4229-840e-b2789e1ef4b5\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[3420,-500],\"parameters\":{\"color\":4,\"width\":400,\"height\":180,\"content\":\"## Reason for Loop\\nSome TRM are valid for several days, like during weekends or holidays, so 10 days are validated to grab the last available TRM\"},\"typeVersion\":1},{\"id\":\"ca8cae67-d0e1-4bb5-94b6-80c3d00f0b5c\",\"name\":\"Convert date\",\"type\":\"n8n-nodes-base.code\",\"position\":[3020,-640],\"parameters\":{\"jsCode\":\"const items = $input.all();\\nlet counter = $input.first().json.counter;\\n\\nreturn items.map(item => {\\n  const originalDate = new Date($('Validate if Date is in the past').item.json.output.date);\\n  originalDate.setDate(originalDate.getDate() - counter);\\n  const adjustedDate = originalDate.toISOString().split('T')[0];\\n\\n  const result = {\\n    ...item.json,\\n    adjustedDate,\\n    loopCounter: counter\\n  };\\n\\n  counter++;\\n  return { json: result };\\n});\"},\"typeVersion\":2},{\"id\":\"370fd786-7611-4148-be16-df28ef18c637\",\"name\":\"Get non-empty rows\",\"type\":\"n8n-nodes-base.filter\",\"position\":[3020,-840],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"2de92428-e76f-4a46-a67a-e28b3fefc845\",\"operator\":{\"type\":\"string\",\"operation\":\"exists\",\"singleValue\":true},\"leftValue\":\"={{ $json.valor }}\",\"rightValue\":\"\"}]}},\"typeVersion\":2.2,\"alwaysOutputData\":true},{\"id\":\"f468d509-68c5-4d78-b22d-86950d1a9792\",\"name\":\"Sort most recent data\",\"type\":\"n8n-nodes-base.sort\",\"position\":[3460,-1040],\"parameters\":{\"options\":{},\"sortFieldsUi\":{\"sortField\":[{\"order\":\"descending\",\"fieldName\":\"vigenciadesde\"}]}},\"typeVersion\":1},{\"id\":\"7696b138-dff9-4b08-848f-81d70422779a\",\"name\":\"Get the last data\",\"type\":\"n8n-nodes-base.limit\",\"position\":[3680,-1040],\"parameters\":{},\"typeVersion\":1},{\"id\":\"5fdafe49-ecec-45ac-8e58-f71951bdbacd\",\"name\":\"Send current TRM\",\"type\":\"n8n-nodes-base.telegram\",\"position\":[3900,-1040],\"webhookId\":\"4761d2c3-62ee-413d-b114-67ef7a49f4eb\",\"parameters\":{\"text\":\"={{ $json.valor }}\\nTRM del {{ $('Extractor Agent').item.json.output.date }}\",\"chatId\":\"={{ $('Once a Telegram Message is received').item.json.message.from.id }}\",\"additionalFields\":{\"appendAttribution\":false}},\"credentials\":{\"telegramApi\":{\"id\":\"xxxxxxxx\",\"name\":\"name_bot\"}},\"typeVersion\":1.2},{\"id\":\"cb29d564-95cd-4a66-b4a6-9f6ee5204452\",\"name\":\"If\",\"type\":\"n8n-nodes-base.if\",\"position\":[3240,-840],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"d8eff85a-bedc-4363-a46b-5ec32953113f\",\"operator\":{\"type\":\"string\",\"operation\":\"exists\",\"singleValue\":true},\"leftValue\":\"={{ $json.valor }}\",\"rightValue\":\"\"}]}},\"typeVersion\":2.2},{\"id\":\"dee431c6-80ee-4f37-a291-61b5ee74557e\",\"name\":\"Send no data\",\"type\":\"n8n-nodes-base.telegram\",\"position\":[3460,-840],\"webhookId\":\"4761d2c3-62ee-413d-b114-67ef7a49f4eb\",\"parameters\":{\"text\":\"=No existe informaciÃ³n para la fecha proporcionada: {{ $('Extractor Agent').item.json.output.date }}\",\"chatId\":\"={{ $('Once a Telegram Message is received').item.json.message.from.id }}\",\"additionalFields\":{\"appendAttribution\":false}},\"credentials\":{\"telegramApi\":{\"id\":\"xxxxxxx\",\"name\":\"name_bot\"}},\"typeVersion\":1.2},{\"id\":\"d3bef604-c465-48da-8f0b-50a47896968a\",\"name\":\"Calculator\",\"type\":\"@n8n/n8n-nodes-langchain.toolCalculator\",\"position\":[1260,-620],\"parameters\":{},\"typeVersion\":1},{\"id\":\"08e70a77-6801-4beb-b81f-766404cb992a\",\"name\":\"Think\",\"type\":\"@n8n/n8n-nodes-langchain.toolThink\",\"position\":[1380,-620],\"parameters\":{},\"typeVersion\":1},{\"id\":\"ffd80923-e0e2-4198-8ce5-66bff53993fe\",\"name\":\"Extractor Agent\",\"type\":\"@n8n/n8n-nodes-langchain.agent\",\"position\":[1232,-840],\"parameters\":{\"text\":\"={{ $('Edit Fields').item.json.text }}\",\"options\":{\"systemMessage\":\"=Eres un algoritmo experto en extracciÃ³n de informaciÃ³n.\\nFecha actual: {{ $json.fecha_actual }}\\nTu tarea es identificar y extraer fechas mencionadas en un texto escrito en espaÃ±ol, incluso si estÃ¡n redactadas de forma natural o ambigua.\\nSigue estas reglas:\\n\\tâ€¢\\tSi el texto menciona una fecha explÃ­cita o relativa (por ejemplo: â€œ20 de mayoâ€, â€œel 17â€, â€œayerâ€, â€œantierâ€, â€œhoyâ€), extrae la fecha en formato AAAA-MM-DD.\\n\\tâ€¢\\tSi una fecha no incluye el aÃ±o, asume el aÃ±o actual.\\n\\tâ€¢\\tSi no incluye ni mes ni aÃ±o, asume el mes y aÃ±o actuales.\\n\\tâ€¢\\tSi el texto no contiene una fecha clara pero es ambiguo (como â€œHolaâ€, â€œokâ€, â€œlistoâ€, â€œgraciasâ€), devuelve la fecha actual.\\n\\tâ€¢\\tNo generes ningÃºn texto adicional, solo la fecha en formato AAAA-MM-DD.\"},\"promptType\":\"define\",\"hasOutputParser\":true},\"typeVersion\":1.9},{\"id\":\"8b49d5c6-ce05-4ca9-a231-0bd4686040bf\",\"name\":\"Text only\",\"type\":\"n8n-nodes-base.set\",\"position\":[480,-740],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"311e21c9-7edc-446d-9857-c9e60a429678\",\"name\":\"text\",\"type\":\"string\",\"value\":\"={{ $json.message.text }}\"}]}},\"typeVersion\":3.4},{\"id\":\"e586891d-2af9-4a04-bb40-3b3f3f216bf4\",\"name\":\"Audio Text\",\"type\":\"n8n-nodes-base.set\",\"position\":[480,-940],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"49569683-a732-47a9-8fbf-6e6303c03ad1\",\"name\":\"text\",\"type\":\"string\",\"value\":\"={{ $json.text }}\"}]}},\"typeVersion\":3.4},{\"id\":\"ff0b076d-9c39-4e98-a71c-a2f3f6df3231\",\"name\":\"Edit Fields\",\"type\":\"n8n-nodes-base.set\",\"position\":[700,-840],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"72ede214-3023-459d-8a27-14be602440bf\",\"name\":\"text\",\"type\":\"string\",\"value\":\"={{ $json.text }}\"}]}},\"typeVersion\":3.4},{\"id\":\"70c427d1-8f32-49a0-ac32-6cf4a57d92e1\",\"name\":\"Structured Output Parser\",\"type\":\"@n8n/n8n-nodes-langchain.outputParserStructured\",\"position\":[1500,-620],\"parameters\":{\"jsonSchemaExample\":\"{\\n\\t\\\"date\\\": \\\"2025-04-01\\\"\\n}\"},\"typeVersion\":1.2},{\"id\":\"9cde8b3a-6e49-4843-a11d-e78d46204c4c\",\"name\":\"Validate Text or Audio\",\"type\":\"n8n-nodes-base.switch\",\"position\":[-180,-840],\"parameters\":{\"rules\":{\"values\":[{\"outputKey\":\"voice\",\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"eaaa57f6-51e2-41c9-8a56-a78547c0a8c5\",\"operator\":{\"type\":\"object\",\"operation\":\"exists\",\"singleValue\":true},\"leftValue\":\"={{ $json.message.voice }}\",\"rightValue\":\"\"}]},\"renameOutput\":true},{\"outputKey\":\"text\",\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"1fda3a77-2a23-43b2-aaae-2ed3f0eed1f6\",\"operator\":{\"type\":\"string\",\"operation\":\"exists\",\"singleValue\":true},\"leftValue\":\"={{ $json.message.text }}\",\"rightValue\":\"\"}]},\"renameOutput\":true}]},\"options\":{\"fallbackOutput\":\"none\"}},\"typeVersion\":3.2},{\"id\":\"75fc07c0-455c-490a-8ac9-422ddfee9b48\",\"name\":\"Download Audio\",\"type\":\"n8n-nodes-base.telegram\",\"position\":[40,-940],\"webhookId\":\"d8240579-0461-483d-8ed0-93ddce22a1cd\",\"parameters\":{\"fileId\":\"={{ $json.message.voice.file_id }}\",\"resource\":\"file\"},\"credentials\":{\"telegramApi\":{\"id\":\"xxxxxxx\",\"name\":\"name_bot\"}},\"typeVersion\":1.2},{\"id\":\"47379a28-148b-4a36-8f06-4c994613d83c\",\"name\":\"Transcribe Audio\",\"type\":\"@n8n/n8n-nodes-langchain.openAi\",\"position\":[260,-940],\"parameters\":{\"options\":{\"language\":\"es\",\"temperature\":0},\"resource\":\"audio\",\"operation\":\"transcribe\",\"binaryPropertyName\":\"=data\"},\"credentials\":{\"openAiApi\":{\"id\":\"BfhecJBx32L0a2gT\",\"name\":\"OpenAi account\"}},\"typeVersion\":1.8},{\"id\":\"1e3e8207-fc34-4c83-8fb4-8aa7a4639c4b\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-900,-1700],\"parameters\":{\"color\":3,\"width\":840,\"height\":780,\"content\":\"# ğŸ“Œ Workflow: Request TRM (Representative Market Rate)\\n\\n## ğŸ¯ Objective\\n\\nRetrieve the TRM (Colombian Peso to US Dollar exchange rate) for a specific date provided by the user via Telegram.\\n\\n## ğŸ”„ Summary Flow\\n\\n1. ğŸ“¨ **Telegram Message**  \\n   The user sends a text or audio to a Telegram Bot.\\n\\n2. ğŸ§  **Date Extraction**  \\n   AI (OpenAI) is used to identify the date in `YYYY-MM-DD` format.\\n\\n3. ğŸ“… **Validation**  \\n   If the date is in the future, the user is notified that it is not valid.\\n\\n4. ğŸ“¡ **TRM Query**  \\n   The bot queries the open data API from the Colombian government.\\n\\n5. ğŸ“¥ **Result**  \\n   - âœ… If TRM data exists for that date â†’ The bot replies to the user.  \\n   - âŒ If not â†’ It searches up to 10 previous days for available data.\\n\\n6. ğŸ“¤ **Final Response**  \\n   The most recent available value is sent, or a message indicating no information is available.\\n\\n## ğŸ”— Data Source\\n**datos.gov.co** â€“ [TRM](https://www.datos.gov.co/)\"},\"typeVersion\":1}],\"active\":true,\"pinData\":{\"Once a Telegram Message is received\":[{\"json\":{\"message\":{\"chat\":{\"id\":6162094450,\"type\":\"private\",\"first_name\":\"Juan\"},\"date\":1747764561,\"from\":{\"id\":6162094450,\"is_bot\":false,\"first_name\":\"Juan\",\"language_code\":\"en\"},\"text\":\"enviame un audio\",\"message_id\":61},\"update_id\":612273063}}]},\"settings\":{\"callerPolicy\":\"workflowsFromSameOwner\",\"executionOrder\":\"v1\",\"executionTimeout\":60},\"versionId\":\"1141769b-3bb4-4f42-8bcf-d8c64ae27cd6\",\"connections\":{\"If\":{\"main\":[[{\"node\":\"Sort most recent data\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Send no data\",\"type\":\"main\",\"index\":0}]]},\"Think\":{\"ai_tool\":[[{\"node\":\"Extractor Agent\",\"type\":\"ai_tool\",\"index\":0}]]},\"Get TRM\":{\"main\":[[{\"node\":\"Check if Valor exists\",\"type\":\"main\",\"index\":0}]]},\"Text only\":{\"main\":[[{\"node\":\"Edit Fields\",\"type\":\"main\",\"index\":0}]]},\"Audio Text\":{\"main\":[[{\"node\":\"Edit Fields\",\"type\":\"main\",\"index\":0}]]},\"Calculator\":{\"ai_tool\":[[{\"node\":\"Extractor Agent\",\"type\":\"ai_tool\",\"index\":0}]]},\"Edit Fields\":{\"main\":[[{\"node\":\"Local Current Date and Time\",\"type\":\"main\",\"index\":0}]]},\"Convert date\":{\"main\":[[{\"node\":\"Get TRM for past date\",\"type\":\"main\",\"index\":0}]]},\"Download Audio\":{\"main\":[[{\"node\":\"Transcribe Audio\",\"type\":\"main\",\"index\":0}]]},\"Extractor Agent\":{\"main\":[[{\"node\":\"Validate if Date is in the past\",\"type\":\"main\",\"index\":0}]]},\"Transcribe Audio\":{\"main\":[[{\"node\":\"Audio Text\",\"type\":\"main\",\"index\":0}]]},\"Get the last data\":{\"main\":[[{\"node\":\"Send current TRM\",\"type\":\"main\",\"index\":0}]]},\"OpenAI Chat Model\":{\"ai_languageModel\":[[{\"node\":\"Extractor Agent\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"Get non-empty rows\":{\"main\":[[{\"node\":\"If\",\"type\":\"main\",\"index\":0}]]},\"Check if Valor exists\":{\"main\":[[{\"node\":\"Send message to user\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Generate an array with 10 numbers\",\"type\":\"main\",\"index\":0}]]},\"Get TRM for past date\":{\"main\":[[{\"node\":\"Get the last 10 responses\",\"type\":\"main\",\"index\":0}]]},\"Sort most recent data\":{\"main\":[[{\"node\":\"Get the last data\",\"type\":\"main\",\"index\":0}]]},\"Validate Text or Audio\":{\"main\":[[{\"node\":\"Download Audio\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Text only\",\"type\":\"main\",\"index\":0}]]},\"Split Items for the loop\":{\"main\":[[{\"node\":\"Get the last 10 responses\",\"type\":\"main\",\"index\":0}]]},\"Structured Output Parser\":{\"ai_outputParser\":[[{\"node\":\"Extractor Agent\",\"type\":\"ai_outputParser\",\"index\":0}]]},\"Get the last 10 responses\":{\"main\":[[{\"node\":\"Get non-empty rows\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Convert date\",\"type\":\"main\",\"index\":0}]]},\"Local Current Date and Time\":{\"main\":[[{\"node\":\"Extractor Agent\",\"type\":\"main\",\"index\":0}]]},\"Validate if Date is in the past\":{\"main\":[[{\"node\":\"Notify past date\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Get TRM\",\"type\":\"main\",\"index\":0}]]},\"Generate an array with 10 numbers\":{\"main\":[[{\"node\":\"Split Items for the loop\",\"type\":\"main\",\"index\":0}]]},\"Once a Telegram Message is received\":{\"main\":[[{\"node\":\"Validate Text or Audio\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "# ğŸ“Œ Request TRM (Colombian Peso to US Dollar exchange rate)\n\n## ğŸ¯ Objective\n\nRetrieve the TRM (Colombian Peso to US Dollar exchange rate) for a specific date provided by the user via Telegram.\n\n## ğŸ”„ Summary Flow\n\n  1. ğŸ“¨ **Telegram Message**  \nThe user sends a text or audio message to the Telegram Bot.\n\n  2. ğŸ§  **Date Extraction**  \nAI (OpenAI) is used to identify the date in `YYYY-MM-DD` format.\n\n  3. ğŸ“… **Validation**  \nIf the date is in the future, the user is notified that it is not valid.\n\n  4. ğŸ“¡ **TRM Query**  \nThe bot queries the open data API from the Colombian government.\n\n  5. ğŸ“¥ **Result**\n\n     * âœ… If TRM data exists for that date â†’ The bot replies to the user.\n     * âŒ If not â†’ It searches up to 10 previous days for available data.\n  6. ğŸ“¤ **Final Response**  \nThe most recent available value is sent, or a message indicating no information is available.\n\n\n\n\n## ğŸ”— Data Source\n\n**[datos.gov.co](http://datos.gov.co)** â€“ [TRM](https://www.datos.gov.co/)\n",
  "crawled_at": "2025-05-26T07:25:56.104681",
  "readme_zh": "# ğŸ“Œ è¯·æ±‚å“¥ä¼¦æ¯”äºšæ¯”ç´¢å…‘ç¾å…ƒæ±‡ç‡ï¼ˆTRMï¼‰\n\n## ï¿½ ç›®æ ‡\né€šè¿‡Telegramè·å–ç”¨æˆ·æŒ‡å®šæ—¥æœŸçš„å“¥ä¼¦æ¯”äºšæ¯”ç´¢å…‘ç¾å…ƒæ±‡ç‡ï¼ˆTRMï¼‰ã€‚\n\n## ğŸ”„ æµç¨‹æ¦‚è§ˆ\n\n  1. ğŸ“¨ **Telegramæ¶ˆæ¯**  \nç”¨æˆ·å‘Telegramæœºå™¨äººå‘é€æ–‡å­—æˆ–è¯­éŸ³æ¶ˆæ¯ã€‚\n\n  2. ğŸ§  **æ—¥æœŸæå–**  \nä½¿ç”¨AIï¼ˆOpenAIï¼‰è¯†åˆ«`YYYY-MM-DD`æ ¼å¼çš„æ—¥æœŸã€‚\n\n  3. ğŸ“… **éªŒè¯**  \nè‹¥æ—¥æœŸä¸ºæœªæ¥æ—¥æœŸï¼Œåˆ™é€šçŸ¥ç”¨æˆ·è¯¥æ—¥æœŸæ— æ•ˆã€‚\n\n  4. ğŸ“¡ **æ±‡ç‡æŸ¥è¯¢**  \næœºå™¨äººå‘å“¥ä¼¦æ¯”äºšæ”¿åºœå¼€æ”¾æ•°æ®APIå‘èµ·æŸ¥è¯¢ã€‚\n\n  5. ğŸ“¥ **ç»“æœå¤„ç†**\n\n     * âœ… è‹¥è¯¥æ—¥æœŸå­˜åœ¨æ±‡ç‡æ•°æ® â†’ æœºå™¨äººå›å¤ç”¨æˆ·\n     * âŒ è‹¥ä¸å­˜åœ¨ â†’ å‘å‰è¿½æº¯æœ€å¤š10ä¸ªè‡ªç„¶æ—¥æŸ¥è¯¢å¯ç”¨æ•°æ®\n  6. ğŸ“¤ **æœ€ç»ˆå“åº”**  \nè¿”å›æœ€è¿‘å¯ç”¨æ±‡ç‡å€¼ï¼Œæˆ–æç¤ºæ— ç›¸å…³ä¿¡æ¯ã€‚\n\n## ğŸ”— æ•°æ®æº\n\n**[datos.gov.co](http://datos.gov.co)** â€“ [TRMæ•°æ®](https://www.datos.gov.co/)",
  "title_zh": "é€šè¿‡Telegramæœºå™¨äººå’ŒAIæ—¥æœŸè¯†åˆ«è·å–å“¥ä¼¦æ¯”äºšæ¯”ç´¢å…‘ç¾å…ƒæ±‡ç‡",
  "publish_date_zh": "æœ€åæ›´æ–°äº4å¤©å‰",
  "workflow_json_zh": "{\n  \"id\": \"MVcw4IwqLxTDzdt5\",\n  \"meta\": {\n    \"instanceId\": \"51270372ea87f40bc06437a6d111ae29e684e524a2e6c52d7a6f84dde18d4a17\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"name\": \"Personal - Solicitar TRM\",\n  \"tags\": [],\n  \"nodes\": [\n    {\n      \"id\": \"f1d44561-9c6a-4e5d-835b-630e858a3181\",\n      \"name\": \"OpenAI Chat Model\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\n      \"position\": [\n        1140,\n        -620\n      ],\n      \"parameters\": {\n        \"model\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"gpt-4.1-nano\",\n          \"cachedResultName\": \"gpt-4.1-nano\"\n        },\n        \"options\": {\n          \"maxRetries\": 2,\n          \"temperature\": 0\n        }\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"BfhecJBx32L0a2gT\",\n          \"name\": \"OpenAi account\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"2b3a4c40-77b2-48d3-a2af-8fc084d24183\",\n      \"name\": \"Once a Telegram Message is received\",\n      \"type\": \"n8n-nodes-base.telegramTrigger\",\n      \"position\": [\n        -400,\n        -840\n      ],\n      \"webhookId\": \"76fd085e-cba0-40ab-9937-3efb9057d4de\",\n      \"parameters\": {\n        \"updates\": [\n          \"message\"\n        ],\n        \"additionalFields\": {}\n      },\n      \"credentials\": {\n        \"telegramApi\": {\n          \"id\": \"xxxxxxx\",\n          \"name\": \"name_bot\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"d8686b18-59d7-461d-a24a-d8f44703db2c\",\n      \"name\": \"Local Current Date and Time\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        920,\n        -840\n      ],\n      \"parameters\": {\n        \"jsCode\": \"const now = new Date();\\n\\n// Ajustar a hora local de Colombia (UTC-5)\\nconst utc = now.getTime() + now.getTimezoneOffset() * 60000;\\nconst colombiaTime = new Date(utc - 5 * 3600000);\\n\\n// Formato YYYY-MM-DD\\nconst fecha = colombiaTime.toISOString().split('T')[0];\\n\\n// Formato YYYY-MM-DD HH:mm:ss\\nconst fechaHora = colombiaTime.toISOString().replace('T', ' ').substring(0, 19);\\n\\nreturn [\\n  {\\n    json: {\\n      fecha_actual: fecha,\\n      fecha_hora_actual: fechaHora,\\n    }\\n  }\\n];\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"022626cd-5a65-4225-9307-817a024799c2\",\n      \"name\": \"Validate if Date is in the past\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        1700,\n        -840\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"b245d771-5b2e-4384-8357-0357e5a1ce2e\",\n              \"operator\": {\n                \"type\": \"dateTime\",\n                \"operation\": \"after\"\n              },\n              \"leftValue\": \"={{ $json.output.date }}\",\n              \"rightValue\": \"={{ $('Local Current Date and Time').item.json.fecha_actual }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"f40edcdb-ff34-491e-b460-f09353aba40f\",\n      \"name\": \"Notify past date\",\n      \"type\": \"n8n-nodes-base.telegram\",\n      \"position\": [\n        1920,\n        -940\n      ],\n      \"webhookId\": \"4761d2c3-62ee-413d-b114-67ef7a49f4eb\",\n      \"parameters\": {\n        \"text\": \"=Fecha posterior a fecha actual\",\n        \"chatId\": \"={{ $('Once a Telegram Message is received').item.json.message.from.id }}\",\n        \"additionalFields\": {\n          \"appendAttribution\": false\n        }\n      },\n      \"credentials\": {\n        \"telegramApi\": {\n          \"id\": \"xxxxxx\",\n          \"name\": \"name_bot\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"9d8c17b5-ce7f-40c0-8e35-64b9b42927f5\",\n      \"name\": \"Get TRM\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1920,\n        -740\n      ],\n      \"parameters\": {\n        \"url\": \"=https://www.datos.gov.co/resource/32sa-8pi3.json?vigenciadesde={{ $json.output.date }}\",\n        \"options\": {}\n      },\n      \"typeVersion\": 4.2,\n      \"alwaysOutputData\": true\n    },\n    {\n      \"id\": \"cd58e419-7d3a-4314-afa3-9fde3c7e998b\",\n      \"name\": \"Check if Valor exists\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        2140,\n        -740\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"9f3ed730-0414-4f19-9941-2e6663ae221c\",\n              \"operator\": {\n                \"type\": \"string\",\n                \"operation\": \"exists\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json.valor }}\",\n              \"rightValue\": \"\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"1813eccf-36ae-4201-bbbd-3bc6ebf63e3d\",\n      \"name\": \"Send message to user\",\n      \"type\": \"n8n-nodes-base.telegram\",\n      \"position\": [\n        2360,\n        -840\n      ],\n      \"webhookId\": \"4761d2c3-62ee-413d-b114-67ef7a49f4eb\",\n      \"parameters\": {\n        \"text\": \"={{ $json.valor }}\\nTRM del {{ $('Extractor Agent').item.json.output.date }}\",\n        \"chatId\": \"={{ $('Once a Telegram Message is received').item.json.message.from.id }}\",\n        \"additionalFields\": {\n          \"appendAttribution\": false\n        }\n      },\n      \"credentials\": {\n        \"telegramApi\": {\n          \"id\": \"xxxxxx\",\n          \"name\": \"name_bot\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"93bb62fb-6e42-4498-a758-4d99ea54a852\",\n      \"name\": \"Generate an array with 10 numbers\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        2360,\n        -640\n      ],\n      \"parameters\": {\n        \"jsCode\": \"// Generar array del 1 al 10\\nconst counter = Array.from({ length: 10 }, (_, i) => i + 1);\\n\\n// Devolver el resultado en el formato adecuado\\nreturn [\\n  {\\n    json: {\\n      counter\\n    }\\n  }\\n];\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"c85942c6-1627-49d4-8f62-ffda4f08c6f1\",\n      \"name\": \"Split Items for the loop\",\n      \"type\": \"n8n-nodes-base.splitOut\",\n      \"position\": [\n        2580,\n        -640\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"fieldToSplitOut\": \"counter\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"9c57b15e-958e-4b1a-ac30-701e7b874319\",\n      \"name\": \"Get the last 10 responses\",\n      \"type\": \"n8n-nodes-base.splitInBatches\",\n      \"position\": [\n        2800,\n        -640\n      ],\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"59168aad-9ec1-4dc9-9c46-85c1cf4f40a6\",\n      \"name\": \"Get TRM for past date\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        3240,\n        -490\n      ],\n      \"parameters\": {\n        \"url\": \"=https://www.datos.gov.co/resource/32sa-8pi3.json?vigenciadesde={{ $json.adjustedDate }}\",\n        \"options\": {}\n      },\n      \"typeVersion\": 4.2,\n      \"alwaysOutputData\": true\n    },\n    {\n      \"id\": \"9a802ea6-8591-4229-840e-b2789e1ef4b5\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        3420,\n        -500\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 400,\n        \"height\": 180,\n        \"content\": \"## å¾ªç¯åŸå› \\néƒ¨åˆ†TRMï¼ˆæŠ€æœ¯å‚è€ƒæ‰‹å†Œï¼‰çš„æœ‰æ•ˆæœŸä¼šè·¨è¶Šæ•°æ—¥ï¼Œä¾‹å¦‚å‘¨æœ«æˆ–èŠ‚å‡æ—¥æœŸé—´ï¼Œå› æ­¤ç³»ç»Ÿä¼šéªŒè¯10å¤©å†…çš„æ•°æ®ä»¥è·å–æœ€åå¯ç”¨çš„TRMç‰ˆæœ¬ã€‚\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"ca8cae67-d0e1-4bb5-94b6-80c3d00f0b5c\",\n      \"name\": \"Convert date\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        3020,\n        -640\n      ],\n      \"parameters\": {\n        \"jsCode\": \"const items = $input.all();\\nlet counter = $input.first().json.counter;\\n\\nreturn items.map(item => {\\n  const originalDate = new Date($('Validate if Date is in the past').item.json.output.date);\\n  originalDate.setDate(originalDate.getDate() - counter);\\n  const adjustedDate = originalDate.toISOString().split('T')[0];\\n\\n  const result = {\\n    ...item.json,\\n    adjustedDate,\\n    loopCounter: counter\\n  };\\n\\n  counter++;\\n  return { json: result };\\n});\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"370fd786-7611-4148-be16-df28ef18c637\",\n      \"name\": \"Get non-empty rows\",\n      \"type\": \"n8n-nodes-base.filter\",\n      \"position\": [\n        3020,\n        -840\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"2de92428-e76f-4a46-a67a-e28b3fefc845\",\n              \"operator\": {\n                \"type\": \"string\",\n                \"operation\": \"exists\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json.valor }}\",\n              \"rightValue\": \"\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2,\n      \"alwaysOutputData\": true\n    },\n    {\n      \"id\": \"f468d509-68c5-4d78-b22d-86950d1a9792\",\n      \"name\": \"Sort most recent data\",\n      \"type\": \"n8n-nodes-base.sort\",\n      \"position\": [\n        3460,\n        -1040\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"sortFieldsUi\": {\n          \"sortField\": [\n            {\n              \"order\": \"descending\",\n              \"fieldName\": \"vigenciadesde\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"7696b138-dff9-4b08-848f-81d70422779a\",\n      \"name\": \"Get the last data\",\n      \"type\": \"n8n-nodes-base.limit\",\n      \"position\": [\n        3680,\n        -1040\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"5fdafe49-ecec-45ac-8e58-f71951bdbacd\",\n      \"name\": \"Send current TRM\",\n      \"type\": \"n8n-nodes-base.telegram\",\n      \"position\": [\n        3900,\n        -1040\n      ],\n      \"webhookId\": \"4761d2c3-62ee-413d-b114-67ef7a49f4eb\",\n      \"parameters\": {\n        \"text\": \"={{ $json.valor }}\\nTRM del {{ $('Extractor Agent').item.json.output.date }}\",\n        \"chatId\": \"={{ $('Once a Telegram Message is received').item.json.message.from.id }}\",\n        \"additionalFields\": {\n          \"appendAttribution\": false\n        }\n      },\n      \"credentials\": {\n        \"telegramApi\": {\n          \"id\": \"xxxxxxxx\",\n          \"name\": \"name_bot\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"cb29d564-95cd-4a66-b4a6-9f6ee5204452\",\n      \"name\": \"If\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        3240,\n        -840\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"d8eff85a-bedc-4363-a46b-5ec32953113f\",\n              \"operator\": {\n                \"type\": \"string\",\n                \"operation\": \"exists\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json.valor }}\",\n              \"rightValue\": \"\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"dee431c6-80ee-4f37-a291-61b5ee74557e\",\n      \"name\": \"Send no data\",\n      \"type\": \"n8n-nodes-base.telegram\",\n      \"position\": [\n        3460,\n        -840\n      ],\n      \"webhookId\": \"4761d2c3-62ee-413d-b114-67ef7a49f4eb\",\n      \"parameters\": {\n        \"text\": \"=No existe informaciÃ³n para la fecha proporcionada: {{ $('Extractor Agent').item.json.output.date }}\",\n        \"chatId\": \"={{ $('Once a Telegram Message is received').item.json.message.from.id }}\",\n        \"additionalFields\": {\n          \"appendAttribution\": false\n        }\n      },\n      \"credentials\": {\n        \"telegramApi\": {\n          \"id\": \"xxxxxxx\",\n          \"name\": \"name_bot\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"d3bef604-c465-48da-8f0b-50a47896968a\",\n      \"name\": \"Calculator\",\n      \"type\": \"@n8n/n8n-nodes-langchain.toolCalculator\",\n      \"position\": [\n        1260,\n        -620\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"08e70a77-6801-4beb-b81f-766404cb992a\",\n      \"name\": \"Think\",\n      \"type\": \"@n8n/n8n-nodes-langchain.toolThink\",\n      \"position\": [\n        1380,\n        -620\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"ffd80923-e0e2-4198-8ce5-66bff53993fe\",\n      \"name\": \"Extractor Agent\",\n      \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n      \"position\": [\n        1232,\n        -840\n      ],\n      \"parameters\": {\n        \"text\": \"={{ $('Edit Fields').item.json.text }}\",\n        \"options\": {\n          \"systemMessage\": \"=Eres un algoritmo experto en extracciÃ³n de informaciÃ³n.\\nFecha actual: {{ $json.fecha_actual }}\\nTu tarea es identificar y extraer fechas mencionadas en un texto escrito en espaÃ±ol, incluso si estÃ¡n redactadas de forma natural o ambigua.\\nSigue estas reglas:\\n\\tâ€¢\\tSi el texto menciona una fecha explÃ­cita o relativa (por ejemplo: â€œ20 de mayoâ€, â€œel 17â€, â€œayerâ€, â€œantierâ€, â€œhoyâ€), extrae la fecha en formato AAAA-MM-DD.\\n\\tâ€¢\\tSi una fecha no incluye el aÃ±o, asume el aÃ±o actual.\\n\\tâ€¢\\tSi no incluye ni mes ni aÃ±o, asume el mes y aÃ±o actuales.\\n\\tâ€¢\\tSi el texto no contiene una fecha clara pero es ambiguo (como â€œHolaâ€, â€œokâ€, â€œlistoâ€, â€œgraciasâ€), devuelve la fecha actual.\\n\\tâ€¢\\tNo generes ningÃºn texto adicional, solo la fecha en formato AAAA-MM-DD.\"\n        },\n        \"promptType\": \"define\",\n        \"hasOutputParser\": true\n      },\n      \"typeVersion\": 1.9\n    },\n    {\n      \"id\": \"8b49d5c6-ce05-4ca9-a231-0bd4686040bf\",\n      \"name\": \"Text only\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        480,\n        -740\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"311e21c9-7edc-446d-9857-c9e60a429678\",\n              \"name\": \"text\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.message.text }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"e586891d-2af9-4a04-bb40-3b3f3f216bf4\",\n      \"name\": \"Audio Text\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        480,\n        -940\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"49569683-a732-47a9-8fbf-6e6303c03ad1\",\n              \"name\": \"text\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.text }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"ff0b076d-9c39-4e98-a71c-a2f3f6df3231\",\n      \"name\": \"Edit Fields\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        700,\n        -840\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"72ede214-3023-459d-8a27-14be602440bf\",\n              \"name\": \"text\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.text }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"70c427d1-8f32-49a0-ac32-6cf4a57d92e1\",\n      \"name\": \"Structured Output Parser\",\n      \"type\": \"@n8n/n8n-nodes-langchain.outputParserStructured\",\n      \"position\": [\n        1500,\n        -620\n      ],\n      \"parameters\": {\n        \"jsonSchemaExample\": \"{\\n\\t\\\"date\\\": \\\"2025-04-01\\\"\\n}\"\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"9cde8b3a-6e49-4843-a11d-e78d46204c4c\",\n      \"name\": \"Validate Text or Audio\",\n      \"type\": \"n8n-nodes-base.switch\",\n      \"position\": [\n        -180,\n        -840\n      ],\n      \"parameters\": {\n        \"rules\": {\n          \"values\": [\n            {\n              \"outputKey\": \"voice\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"eaaa57f6-51e2-41c9-8a56-a78547c0a8c5\",\n                    \"operator\": {\n                      \"type\": \"object\",\n                      \"operation\": \"exists\",\n                      \"singleValue\": true\n                    },\n                    \"leftValue\": \"={{ $json.message.voice }}\",\n                    \"rightValue\": \"\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            },\n            {\n              \"outputKey\": \"text\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"1fda3a77-2a23-43b2-aaae-2ed3f0eed1f6\",\n                    \"operator\": {\n                      \"type\": \"string\",\n                      \"operation\": \"exists\",\n                      \"singleValue\": true\n                    },\n                    \"leftValue\": \"={{ $json.message.text }}\",\n                    \"rightValue\": \"\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            }\n          ]\n        },\n        \"options\": {\n          \"fallbackOutput\": \"none\"\n        }\n      },\n      \"typeVersion\": 3.2\n    },\n    {\n      \"id\": \"75fc07c0-455c-490a-8ac9-422ddfee9b48\",\n      \"name\": \"Download Audio\",\n      \"type\": \"n8n-nodes-base.telegram\",\n      \"position\": [\n        40,\n        -940\n      ],\n      \"webhookId\": \"d8240579-0461-483d-8ed0-93ddce22a1cd\",\n      \"parameters\": {\n        \"fileId\": \"={{ $json.message.voice.file_id }}\",\n        \"resource\": \"file\"\n      },\n      \"credentials\": {\n        \"telegramApi\": {\n          \"id\": \"xxxxxxx\",\n          \"name\": \"name_bot\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"47379a28-148b-4a36-8f06-4c994613d83c\",\n      \"name\": \"Transcribe Audio\",\n      \"type\": \"@n8n/n8n-nodes-langchain.openAi\",\n      \"position\": [\n        260,\n        -940\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"language\": \"es\",\n          \"temperature\": 0\n        },\n        \"resource\": \"audio\",\n        \"operation\": \"transcribe\",\n        \"binaryPropertyName\": \"=data\"\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"BfhecJBx32L0a2gT\",\n          \"name\": \"OpenAi account\"\n        }\n      },\n      \"typeVersion\": 1.8\n    },\n    {\n      \"id\": \"1e3e8207-fc34-4c83-8fb4-8aa7a4639c4b\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -900,\n        -1700\n      ],\n      \"parameters\": {\n        \"color\": 3,\n        \"width\": 840,\n        \"height\": 780,\n        \"content\": \"# ğŸ“Œ å·¥ä½œæµç¨‹ï¼šè¯·æ±‚TRMï¼ˆä»£è¡¨æ€§å¸‚åœºæ±‡ç‡ï¼‰\\n\\n## ğŸ¯ ç›®æ ‡\\né€šè¿‡ç”¨æˆ·æä¾›çš„Telegramæ¶ˆæ¯ï¼Œè·å–æŒ‡å®šæ—¥æœŸçš„å“¥ä¼¦æ¯”äºšæ¯”ç´¢å…‘ç¾å…ƒæ±‡ç‡ï¼ˆTRMï¼‰ã€‚\\n\\n## ğŸ”„ æµç¨‹æ¦‚è¿°\\n\\n1. ğŸ“¨ **Telegramæ¶ˆæ¯**  \\n   ç”¨æˆ·å‘Telegramæœºå™¨äººå‘é€æ–‡æœ¬æˆ–è¯­éŸ³æ¶ˆæ¯ã€‚\\n\\n2. ğŸ§  **æ—¥æœŸæå–**  \\n   ä½¿ç”¨AIï¼ˆOpenAIï¼‰è¯†åˆ«æ¶ˆæ¯ä¸­çš„æ—¥æœŸï¼Œå¹¶æ ¼å¼åŒ–ä¸º`YYYY-MM-DD`ã€‚\\n\\n3. ğŸ“… **éªŒè¯**  \\n   è‹¥æ—¥æœŸä¸ºæœªæ¥æ—¥æœŸï¼Œåˆ™é€šçŸ¥ç”¨æˆ·è¯¥æ—¥æœŸæ— æ•ˆã€‚\\n\\n4. ğŸ“¡ **TRMæŸ¥è¯¢**  \\n   æœºå™¨äººå‘å“¥ä¼¦æ¯”äºšæ”¿åºœå¼€æ”¾æ•°æ®APIå‘èµ·æŸ¥è¯¢è¯·æ±‚ã€‚\\n\\n5. ğŸ“¥ **ç»“æœå¤„ç†**  \\n   - âœ… è‹¥è¯¥æ—¥æœŸå­˜åœ¨TRMæ•°æ® â†’ æœºå™¨äººå›å¤ç”¨æˆ·å¯¹åº”æ±‡ç‡ã€‚  \\n   - âŒ è‹¥ä¸å­˜åœ¨ â†’ è‡ªåŠ¨å‘å‰æœç´¢æœ€å¤š10ä¸ªå·¥ä½œæ—¥ä»¥è·å–å¯ç”¨æ•°æ®ã€‚\\n\\n6. ğŸ“¤ **æœ€ç»ˆå“åº”**  \\n   è¿”å›æœ€è¿‘å¯ç”¨çš„æ±‡ç‡å€¼ï¼Œæˆ–æç¤ºæ— ç›¸å…³ä¿¡æ¯ã€‚\\n\\n## ğŸ”— æ•°æ®æº\\n**datos.gov.co** â€“ [TRMæ•°æ®å¹³å°](https://www.datos.gov.co/)\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"active\": true,\n  \"pinData\": {\n    \"Once a Telegram Message is received\": [\n      {\n        \"json\": {\n          \"message\": {\n            \"chat\": {\n              \"id\": 6162094450,\n              \"type\": \"private\",\n              \"first_name\": \"Juan\"\n            },\n            \"date\": 1747764561,\n            \"from\": {\n              \"id\": 6162094450,\n              \"is_bot\": false,\n              \"first_name\": \"Juan\",\n              \"language_code\": \"en\"\n            },\n            \"text\": \"enviame un audio\",\n            \"message_id\": 61\n          },\n          \"update_id\": 612273063\n        }\n      }\n    ]\n  },\n  \"settings\": {\n    \"callerPolicy\": \"workflowsFromSameOwner\",\n    \"executionOrder\": \"v1\",\n    \"executionTimeout\": 60\n  },\n  \"versionId\": \"1141769b-3bb4-4f42-8bcf-d8c64ae27cd6\",\n  \"connections\": {\n    \"If\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Sort most recent data\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Send no data\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Think\": {\n      \"ai_tool\": [\n        [\n          {\n            \"node\": \"Extractor Agent\",\n            \"type\": \"ai_tool\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get TRM\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Check if Valor exists\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Text only\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Edit Fields\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Audio Text\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Edit Fields\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Calculator\": {\n      \"ai_tool\": [\n        [\n          {\n            \"node\": \"Extractor Agent\",\n            \"type\": \"ai_tool\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Edit Fields\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Local Current Date and Time\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Convert date\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get TRM for past date\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Download Audio\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Transcribe Audio\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Extractor Agent\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Validate if Date is in the past\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Transcribe Audio\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Audio Text\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get the last data\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Send current TRM\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"OpenAI Chat Model\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"Extractor Agent\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get non-empty rows\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"If\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Check if Valor exists\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Send message to user\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Generate an array with 10 numbers\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get TRM for past date\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get the last 10 responses\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Sort most recent data\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get the last data\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Validate Text or Audio\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Download Audio\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Text only\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Split Items for the loop\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get the last 10 responses\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Structured Output Parser\": {\n      \"ai_outputParser\": [\n        [\n          {\n            \"node\": \"Extractor Agent\",\n            \"type\": \"ai_outputParser\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get the last 10 responses\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get non-empty rows\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Convert date\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Local Current Date and Time\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Extractor Agent\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Validate if Date is in the past\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Notify past date\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Get TRM\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Generate an array with 10 numbers\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Split Items for the loop\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Once a Telegram Message is received\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Validate Text or Audio\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}