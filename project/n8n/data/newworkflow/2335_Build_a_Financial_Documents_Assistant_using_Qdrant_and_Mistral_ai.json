{
  "url": "https://n8n.io/workflows/2335-build-a-financial-documents-assistant-using-qdrant-and-mistralai/",
  "title": "Build a Financial Documents Assistant using Qdrant and Mistral.ai",
  "author": "Jimleuk",
  "publish_date": "Last update 9 months ago",
  "publish_date_absolute": "2024-08-25",
  "categories": [
    {
      "name": "Finance"
    },
    {
      "name": "AI"
    }
  ],
  "workflow_json": "{\"meta\":{\"instanceId\":\"26ba763460b97c249b82942b23b6384876dfeb9327513332e743c5f6219c2b8e\"},\"nodes\":[{\"id\":\"c5525f47-4d91-4b98-87bb-566b90da64a1\",\"name\":\"Local File Trigger\",\"type\":\"n8n-nodes-base.localFileTrigger\",\"position\":[660,700],\"parameters\":{\"path\":\"/home/node/host_mount/local_file_search\",\"events\":[\"add\",\"change\",\"unlink\"],\"options\":{\"awaitWriteFinish\":true},\"triggerOn\":\"folder\"},\"typeVersion\":1},{\"id\":\"804334d6-e34d-40d1-9555-b331ffe66f6f\",\"name\":\"When clicking \\\"Test workflow\\\"\",\"type\":\"n8n-nodes-base.manualTrigger\",\"position\":[664.5766613599001,881.8474780113352],\"parameters\":{},\"typeVersion\":1},{\"id\":\"7ab0e284-b667-4d1f-8ceb-fb05e4081a06\",\"name\":\"Set Variables\",\"type\":\"n8n-nodes-base.set\",\"position\":[840,700],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"35ea70c4-8669-4975-a68d-bbaa094713c0\",\"name\":\"directory\",\"type\":\"string\",\"value\":\"/home/node/BankStatements\"},{\"id\":\"1d081d19-ff4e-462a-9cbe-7af2244bf87f\",\"name\":\"file_added\",\"type\":\"string\",\"value\":\"={{ $json.event === 'add' && $json.path || ''}}\"},{\"id\":\"18f8dc03-51ca-48c7-947f-87ce8e1979bf\",\"name\":\"file_changed\",\"type\":\"string\",\"value\":\"={{ $json.event === 'change' && $json.path || '' }}\"},{\"id\":\"65074ff7-037b-4b3b-b2c3-8a61755ab43b\",\"name\":\"file_deleted\",\"type\":\"string\",\"value\":\"={{ $json.event === 'unlink' && $json.path || '' }}\"},{\"id\":\"9a1902e7-f94d-4d1f-9006-91c67354d3e8\",\"name\":\"qdrant_collection\",\"type\":\"string\",\"value\":\"local_file_search\"}]}},\"typeVersion\":3.3},{\"id\":\"76173972-ceca-43a4-b85f-00b41f774304\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[580,460],\"parameters\":{\"color\":7,\"width\":665.0909497859384,\"height\":596.8351502261468,\"content\":\"## Step 1. Select the target folder\\n[Read more about local file trigger](https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.localfiletrigger)\\n\\nIn this workflow, we'll monitor a specific folder on disk that n8n has access to. Since we're using docker, we can either use the n8n volume or mount a folder from the host machine.\\n\\nThe local file trigger is useful to execute the workflow whenever changes are made to our target folder.\"},\"typeVersion\":1},{\"id\":\"eda839f7-dde4-4d1f-9fe6-692df4ac7282\",\"name\":\"Sticky Note4\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[184.57666135990007,461.84747801133517],\"parameters\":{\"width\":372.51107341403605,\"height\":356.540665091993,\"content\":\"## Try It Out!\\n### This workflow does the following:\\n* Monitors a target folder for changes using the local file trigger\\n* Synchronises files in the target folder with their vectors in Qdrant\\n* Mistral AI is used to create a Q&A AI agent on all files in the target folder\\n\\n### Need Help?\\nJoin the [Discord](https://discord.com/invite/XPKeKXeB7d) or ask in the [Forum](https://community.n8n.io/)!\\n\\nHappy Hacking!\"},\"typeVersion\":1},{\"id\":\"f82f6de0-af8f-4fdf-a733-f59ba4fed02f\",\"name\":\"Read File\",\"type\":\"n8n-nodes-base.readWriteFile\",\"position\":[1340,1120],\"parameters\":{\"options\":{},\"fileSelector\":\"={{ $json.file_added }}\"},\"typeVersion\":1},{\"id\":\"7354a080-051b-479f-97b1-49cc0c14c9d8\",\"name\":\"Embeddings Mistral Cloud\",\"type\":\"@n8n/n8n-nodes-langchain.embeddingsMistralCloud\",\"position\":[1720,1280],\"parameters\":{\"options\":{}},\"credentials\":{\"mistralCloudApi\":{\"id\":\"EIl2QxhXAS9Hkg37\",\"name\":\"Mistral Cloud account\"}},\"typeVersion\":1},{\"id\":\"a1ad45ff-a882-4aed-82e2-cad2483cf4e8\",\"name\":\"Default Data Loader\",\"type\":\"@n8n/n8n-nodes-langchain.documentDefaultDataLoader\",\"position\":[1820,1280],\"parameters\":{\"options\":{\"metadata\":{\"metadataValues\":[{\"name\":\"filter_by_filename\",\"value\":\"={{ $json.file_location }}\"},{\"name\":\"filter_by_created_month\",\"value\":\"={{ $now.year + '-' + $now.monthShort }}\"},{\"name\":\"filter_by_created_week\",\"value\":\"={{ $now.year + '-' + $now.monthShort + '-W' + $now.weekNumber }}\"}]}},\"jsonData\":\"={{ $json.data }}\",\"jsonMode\":\"expressionData\"},\"typeVersion\":1},{\"id\":\"0b0e29b9-8873-4074-94dc-9f0364c28835\",\"name\":\"Recursive Character Text Splitter\",\"type\":\"@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter\",\"position\":[1840,1400],\"parameters\":{\"options\":{}},\"typeVersion\":1},{\"id\":\"c0555ba6-a1bd-4aa9-a340-a9c617f8e6db\",\"name\":\"Prepare Embedding Document\",\"type\":\"n8n-nodes-base.set\",\"position\":[1520,1120],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"41a1d4ca-e5a5-4fb9-b249-8796ae759b33\",\"name\":\"data\",\"type\":\"string\",\"value\":\"=## file location\\n{{ [$json.directory, $json.fileName].join('/') }}\\n## file created\\n{{ $now.toISO() }}\\n## file contents\\n{{ $input.item.binary.data.data.base64Decode() }}\"},{\"id\":\"c091704d-b81c-448b-8c90-156ef568b871\",\"name\":\"file_location\",\"type\":\"string\",\"value\":\"={{ [$json.directory, $json.fileName].join('/') }}\"}]}},\"typeVersion\":3.3},{\"id\":\"ffe8c363-0809-4d21-aa8f-34b0fc2dc57f\",\"name\":\"Chat Trigger\",\"type\":\"@n8n/n8n-nodes-langchain.chatTrigger\",\"position\":[2280,680],\"webhookId\":\"37587fe0-b8db-4012-90a7-1f65b9bfd0df\",\"parameters\":{},\"typeVersion\":1},{\"id\":\"8d958669-60be-4bb2-80fc-2a6c7c7bfae6\",\"name\":\"Question and Answer Chain\",\"type\":\"@n8n/n8n-nodes-langchain.chainRetrievalQa\",\"position\":[2500,680],\"parameters\":{},\"typeVersion\":1.3},{\"id\":\"f143e438-8176-4923-a866-3f9a2a16793d\",\"name\":\"Mistral Cloud Chat Model\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatMistralCloud\",\"position\":[2500,840],\"parameters\":{\"model\":\"mistral-small-2402\",\"options\":{}},\"credentials\":{\"mistralCloudApi\":{\"id\":\"EIl2QxhXAS9Hkg37\",\"name\":\"Mistral Cloud account\"}},\"typeVersion\":1},{\"id\":\"06dd8f4c-3b66-43e0-85c8-ec222e275f87\",\"name\":\"Vector Store Retriever\",\"type\":\"@n8n/n8n-nodes-langchain.retrieverVectorStore\",\"position\":[2620,840],\"parameters\":{},\"typeVersion\":1},{\"id\":\"2fdabcb5-a7a7-4e02-8c1b-9190e2e52385\",\"name\":\"Embeddings Mistral Cloud1\",\"type\":\"@n8n/n8n-nodes-langchain.embeddingsMistralCloud\",\"position\":[2620,1080],\"parameters\":{\"options\":{}},\"credentials\":{\"mistralCloudApi\":{\"id\":\"EIl2QxhXAS9Hkg37\",\"name\":\"Mistral Cloud account\"}},\"typeVersion\":1},{\"id\":\"e5664534-de07-481f-87dd-68d7d0715baa\",\"name\":\"Remap for File_Added Flow\",\"type\":\"n8n-nodes-base.set\",\"position\":[1920,700],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"840219e1-ed47-4b00-83fd-6b3c0bd71650\",\"name\":\"file_added\",\"type\":\"string\",\"value\":\"={{ $('Set Variables').item.json.file_changed }}\"}]}},\"typeVersion\":3.3},{\"id\":\"1fd14832-aafe-4d72-b4f2-7afc72df97dc\",\"name\":\"Search For Existing Point\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[1340,280],\"parameters\":{\"url\":\"=http://qdrant:6333/collections/{{ $('Set Variables').item.json.qdrant_collection }}/points/scroll\",\"method\":\"POST\",\"options\":{},\"jsonBody\":\"={\\n    \\\"filter\\\": {\\n        \\\"must\\\": [\\n            {\\n                \\\"key\\\": \\\"metadata.filter_by_filename\\\",\\n                \\\"match\\\": {\\n                    \\\"value\\\": \\\"{{ $json.file_changed }}\\\"\\n                }\\n            }\\n        ]\\n    },\\n    \\\"limit\\\": 1,\\n    \\\"with_payload\\\": false,\\n    \\\"with_vector\\\": false\\n}\",\"sendBody\":true,\"specifyBody\":\"json\",\"authentication\":\"predefinedCredentialType\",\"nodeCredentialType\":\"qdrantApi\"},\"credentials\":{\"qdrantApi\":{\"id\":\"NyinAS3Pgfik66w5\",\"name\":\"QdrantApi account\"}},\"typeVersion\":4.2},{\"id\":\"b5fa817f-82d6-41dd-9817-4c1dd9137b76\",\"name\":\"Has Existing Point?\",\"type\":\"n8n-nodes-base.if\",\"position\":[1520,280],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"0392bac0-8fb5-406b-b59f-575edf5ab30d\",\"operator\":{\"type\":\"array\",\"operation\":\"notEmpty\",\"singleValue\":true},\"leftValue\":\"={{ $json.result.points }}\",\"rightValue\":\"\"}]}},\"typeVersion\":2},{\"id\":\"b0fa4fa4-5d1b-4a12-b8ba-a10d71f31f94\",\"name\":\"Delete Existing Point\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[1720,700],\"parameters\":{\"url\":\"=http://qdrant:6333/collections/{{ $('Set Variables').item.json.qdrant_collection }}/points/delete\",\"method\":\"POST\",\"options\":{},\"sendBody\":true,\"authentication\":\"predefinedCredentialType\",\"bodyParameters\":{\"parameters\":[{\"name\":\"points\",\"value\":\"={{ $json.result.points.map(point => point.id) }}\"}]},\"nodeCredentialType\":\"qdrantApi\"},\"credentials\":{\"qdrantApi\":{\"id\":\"NyinAS3Pgfik66w5\",\"name\":\"QdrantApi account\"}},\"typeVersion\":4.2},{\"id\":\"5408adfe-4d6b-407c-aac7-e87c9b1a1592\",\"name\":\"Search For Existing Point1\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[1340,700],\"parameters\":{\"url\":\"=http://qdrant:6333/collections/{{ $('Set Variables').item.json.qdrant_collection }}/points/scroll\",\"method\":\"POST\",\"options\":{},\"jsonBody\":\"={\\n    \\\"filter\\\": {\\n        \\\"must\\\": [\\n            {\\n                \\\"key\\\": \\\"metadata.filter_by_filename\\\",\\n                \\\"match\\\": {\\n                    \\\"value\\\": \\\"{{ $json.file_changed }}\\\"\\n                }\\n            }\\n        ]\\n    },\\n    \\\"limit\\\": 1,\\n    \\\"with_payload\\\": false,\\n    \\\"with_vector\\\": false\\n}\",\"sendBody\":true,\"specifyBody\":\"json\",\"authentication\":\"predefinedCredentialType\",\"nodeCredentialType\":\"qdrantApi\"},\"credentials\":{\"qdrantApi\":{\"id\":\"NyinAS3Pgfik66w5\",\"name\":\"QdrantApi account\"}},\"typeVersion\":4.2},{\"id\":\"fac43587-0d24-4d6e-a0d5-8cc8f9615967\",\"name\":\"Has Existing Point?1\",\"type\":\"n8n-nodes-base.if\",\"position\":[1520,700],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"0392bac0-8fb5-406b-b59f-575edf5ab30d\",\"operator\":{\"type\":\"array\",\"operation\":\"notEmpty\",\"singleValue\":true},\"leftValue\":\"={{ $json.result.points }}\",\"rightValue\":\"\"}]}},\"typeVersion\":2},{\"id\":\"010baacd-fac1-4cc1-86bf-9d6ef11916fe\",\"name\":\"Delete Existing Point1\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[1700,280],\"parameters\":{\"url\":\"=http://qdrant:6333/collections/{{ $('Set Variables').item.json.qdrant_collection }}/points/delete\",\"method\":\"POST\",\"options\":{},\"sendBody\":true,\"authentication\":\"predefinedCredentialType\",\"bodyParameters\":{\"parameters\":[{\"name\":\"points\",\"value\":\"={{ $json.result.points.map(point => point.id) }}\"}]},\"nodeCredentialType\":\"qdrantApi\"},\"credentials\":{\"qdrantApi\":{\"id\":\"NyinAS3Pgfik66w5\",\"name\":\"QdrantApi account\"}},\"typeVersion\":4.2},{\"id\":\"2d6fb29c-2fac-41de-9ad0-cc781b246378\",\"name\":\"Handle File Event\",\"type\":\"n8n-nodes-base.switch\",\"position\":[1000,700],\"parameters\":{\"rules\":{\"values\":[{\"outputKey\":\"file_deleted\",\"conditions\":{\"options\":{\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"a1f6d86a-9805-4d0e-ac70-90c9cf0ad339\",\"operator\":{\"type\":\"string\",\"operation\":\"notEmpty\",\"singleValue\":true},\"leftValue\":\"={{ $json.file_deleted }}\",\"rightValue\":\"\"}]},\"renameOutput\":true},{\"outputKey\":\"file_changed\",\"conditions\":{\"options\":{\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"d15cde67-b5b0-4676-b4fb-ead749147392\",\"operator\":{\"type\":\"string\",\"operation\":\"notEmpty\",\"singleValue\":true},\"leftValue\":\"={{ $json.file_changed }}\",\"rightValue\":\"\"}]},\"renameOutput\":true},{\"outputKey\":\"file_added\",\"conditions\":{\"options\":{\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"operator\":{\"type\":\"string\",\"operation\":\"notEmpty\",\"singleValue\":true},\"leftValue\":\"={{ $json.file_added }}\",\"rightValue\":\"\"}]},\"renameOutput\":true}]},\"options\":{}},\"typeVersion\":3},{\"id\":\"da91b2aa-613c-4e3e-af83-fbd3bb7e922e\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1280,123.92779403575491],\"parameters\":{\"color\":7,\"width\":847.032584995578,\"height\":335.8400964393443,\"content\":\"## Step 2. When files are removed, the vector point is cleared.\\n[Learn how to delete points using the Qdrant API](https://qdrant.tech/documentation/concepts/points/#delete-points)\\n\\nTo keep our vectorstore relevant, we'll implement a simple synchronisation system whereby documents deleted from the local file folder are also purged from Qdrant. This can be simply achieved using Qdrant APIs.\"},\"typeVersion\":1},{\"id\":\"2f9f5b2b-6504-4b27-a0c4-f3373df352df\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1280,480],\"parameters\":{\"color\":7,\"width\":855.9952607674757,\"height\":433.01782147687817,\"content\":\"## Step 3. When files are updated, the vector point is updated.\\n[Learn how to delete points using the Qdrant API](https://qdrant.tech/documentation/concepts/points/#delete-points)\\n\\nSimilarly to the files deleted branch, when we encounter a change in a file we'll update the matching vector point in Qdrant to ensure our vector store stays relevant. Here, we can achieve this my deleting the existing vector point and creating it anew with the updated bank statement.\"},\"typeVersion\":1},{\"id\":\"38128b7f-d0f2-405c-a7de-662df812c344\",\"name\":\"Sticky Note3\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1280,940],\"parameters\":{\"color\":7,\"width\":846.8204626627492,\"height\":629.9714759033081,\"content\":\"## Step 4. When new files are added, add them to Qdrant Vectorstore.\\n[Read more about the Qdrant node](https://docs.n8n.io/integrations/builtin/cluster-nodes/root-nodes/n8n-nodes-langchain.vectorstoreqdrant)\\n\\nUsing Qdrant, we'll able to create a simple yet powerful RAG based application for our bank statements. One of Qdrant's most powerful features is its filtering system, we'll use it to manage the synchronisation of our local file system and Qdrant.\"},\"typeVersion\":1},{\"id\":\"e85e2a30-e775-42fe-a12a-ac5de4eb4673\",\"name\":\"Sticky Note5\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[2180,491.43199269284935],\"parameters\":{\"color\":7,\"width\":744.4578330639196,\"height\":759.7908149448928,\"content\":\"## Step 5. Create AI Agent expert on historic bank statements \\n[Read more about the Question & Answer Chain](https://docs.n8n.io/integrations/builtin/cluster-nodes/root-nodes/n8n-nodes-langchain.chainretrievalqa)\\n\\nFinally, let's use a Question & Answer AI node to combine the Mistral AI model and Qdrant as the vector store retriever to create a local expert for all our bank statements questions. \"},\"typeVersion\":1},{\"id\":\"7b29b0b9-ffee-4456-b036-9b39400d2b31\",\"name\":\"Qdrant Vector Store\",\"type\":\"@n8n/n8n-nodes-langchain.vectorStoreQdrant\",\"position\":[1700,1120],\"parameters\":{\"mode\":\"insert\",\"options\":{},\"qdrantCollection\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"={{ $('Set Variables').item.json.qdrant_collection }}\"}},\"credentials\":{\"qdrantApi\":{\"id\":\"NyinAS3Pgfik66w5\",\"name\":\"QdrantApi account\"}},\"typeVersion\":1},{\"id\":\"1857bebb-b492-415e-96c8-235329bfd28a\",\"name\":\"Qdrant Vector Store1\",\"type\":\"@n8n/n8n-nodes-langchain.vectorStoreQdrant\",\"position\":[2620,960],\"parameters\":{\"qdrantCollection\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"BankStatements\"}},\"credentials\":{\"qdrantApi\":{\"id\":\"NyinAS3Pgfik66w5\",\"name\":\"QdrantApi account\"}},\"typeVersion\":1}],\"pinData\":{},\"connections\":{\"Read File\":{\"main\":[[{\"node\":\"Prepare Embedding Document\",\"type\":\"main\",\"index\":0}]]},\"Chat Trigger\":{\"main\":[[{\"node\":\"Question and Answer Chain\",\"type\":\"main\",\"index\":0}]]},\"Set Variables\":{\"main\":[[{\"node\":\"Handle File Event\",\"type\":\"main\",\"index\":0}]]},\"Handle File Event\":{\"main\":[[{\"node\":\"Search For Existing Point\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Search For Existing Point1\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Read File\",\"type\":\"main\",\"index\":0}]]},\"Local File Trigger\":{\"main\":[[{\"node\":\"Set Variables\",\"type\":\"main\",\"index\":0}]]},\"Default Data Loader\":{\"ai_document\":[[{\"node\":\"Qdrant Vector Store\",\"type\":\"ai_document\",\"index\":0}]]},\"Has Existing Point?\":{\"main\":[[{\"node\":\"Delete Existing Point1\",\"type\":\"main\",\"index\":0}]]},\"Has Existing Point?1\":{\"main\":[[{\"node\":\"Delete Existing Point\",\"type\":\"main\",\"index\":0}]]},\"Qdrant Vector Store1\":{\"ai_vectorStore\":[[{\"node\":\"Vector Store Retriever\",\"type\":\"ai_vectorStore\",\"index\":0}]]},\"Delete Existing Point\":{\"main\":[[{\"node\":\"Remap for File_Added Flow\",\"type\":\"main\",\"index\":0}]]},\"Vector Store Retriever\":{\"ai_retriever\":[[{\"node\":\"Question and Answer Chain\",\"type\":\"ai_retriever\",\"index\":0}]]},\"Embeddings Mistral Cloud\":{\"ai_embedding\":[[{\"node\":\"Qdrant Vector Store\",\"type\":\"ai_embedding\",\"index\":0}]]},\"Mistral Cloud Chat Model\":{\"ai_languageModel\":[[{\"node\":\"Question and Answer Chain\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"Embeddings Mistral Cloud1\":{\"ai_embedding\":[[{\"node\":\"Qdrant Vector Store1\",\"type\":\"ai_embedding\",\"index\":0}]]},\"Remap for File_Added Flow\":{\"main\":[[{\"node\":\"Read File\",\"type\":\"main\",\"index\":0}]]},\"Search For Existing Point\":{\"main\":[[{\"node\":\"Has Existing Point?\",\"type\":\"main\",\"index\":0}]]},\"Prepare Embedding Document\":{\"main\":[[{\"node\":\"Qdrant Vector Store\",\"type\":\"main\",\"index\":0}]]},\"Search For Existing Point1\":{\"main\":[[{\"node\":\"Has Existing Point?1\",\"type\":\"main\",\"index\":0}]]},\"When clicking \\\"Test workflow\\\"\":{\"main\":[[{\"node\":\"Set Variables\",\"type\":\"main\",\"index\":0}]]},\"Recursive Character Text Splitter\":{\"ai_textSplitter\":[[{\"node\":\"Default Data Loader\",\"type\":\"ai_textSplitter\",\"index\":0}]]}}}",
  "readme": "This n8n workflow demonstrates how to manage your Qdrant vector store when there is a need to keep it in sync with local files. It covers creating, updating and deleting vector store records ensuring our chatbot assistant is never outdated or misleading.\n\n## Disclaimer\n\nThis workflow depends on local files accessed through the local filesystem and so will only work on a self-hosted version of n8n at this time. It is possible to amend this workflow to work on n8n cloud by replacing the local file trigger and read file nodes.\n\n## How it works\n\n  * A local directory where bank statements are downloaded to is monitored via a local file trigger. The trigger watches for the file create, file changed and file deleted events.\n  * When a file is created, its contents are uploaded to the vector store.\n  * When a file is updated, its previous records are replaced.\n  * When the file is deleted, the corresponding records are also removed from the vector store.\n  * A simple Question and Answer Chatbot is setup to answer any questions about the bank statements in the system.\n\n\n\n## Requirements\n\n  * A self-hosted version of n8n. Some of the nodes used in this workflow only work with the local filesystem.\n  * Qdrant instance to store the records.\n\n\n\n## Customising the workflow\n\nThis workflow can also work with remote data. Try integrating accounting or CRM software to build a managed system for payroll, invoices and more.\n\n## Want to go fully local?\n\nA version of this workflow is available which uses Ollama instead. You can download this template here: <https://drive.google.com/file/d/189F1fNOiw6naNSlSwnyLVEm_Ho_IFfdM/view?usp=sharing>\n",
  "crawled_at": "2025-05-25T23:31:49.960171",
  "readme_zh": "此n8n工作流演示了如何在需要与本地文件保持同步时管理您的Qdrant向量存储库。它涵盖了创建、更新和删除向量存储记录的操作，确保我们的聊天机器人助手始终保持最新且不会提供误导信息。\n\n## 免责声明\n\n该工作流依赖通过本地文件系统访问的本地文件，因此目前仅适用于自托管的n8n版本。可通过替换本地文件触发器和读取文件节点来修改此工作流以适配n8n云端版本。\n\n## 工作原理\n\n* 通过本地文件触发器监控下载银行对账单的本地目录，该触发器监视文件创建、文件更改和文件删除事件。\n* 当文件创建时，其内容将被上传至向量存储库。\n* 当文件更新时，其原有记录将被替换。\n* 当文件删除时，相应记录也会从向量存储库中移除。\n* 设置了一个简单的问答聊天机器人，用于回答系统中关于银行对账单的任何问题。\n\n## 需求条件\n\n* 自托管版n8n。本工作流中使用的某些节点仅支持本地文件系统。\n* 用于存储记录的Qdrant实例。\n\n## 自定义工作流\n\n此工作流也可与远程数据协同工作。尝试集成会计或CRM软件，构建用于管理工资单、发票等事务的系统。\n\n## 想要完全本地化？\n\n我们还提供使用Ollama替代方案的版本，您可通过此链接下载模板：<https://drive.google.com/file/d/189F1fNOiw6naNSlSwnyLVEm_Ho_IFfdM/view?usp=sharing>",
  "title_zh": "利用Qdrant和Mistral.ai构建金融文档助手",
  "publish_date_zh": "最后更新于8个月前",
  "workflow_json_zh": "{\n  \"meta\": {\n    \"instanceId\": \"26ba763460b97c249b82942b23b6384876dfeb9327513332e743c5f6219c2b8e\"\n  },\n  \"nodes\": [\n    {\n      \"id\": \"c5525f47-4d91-4b98-87bb-566b90da64a1\",\n      \"name\": \"Local File Trigger\",\n      \"type\": \"n8n-nodes-base.localFileTrigger\",\n      \"position\": [\n        660,\n        700\n      ],\n      \"parameters\": {\n        \"path\": \"/home/node/host_mount/local_file_search\",\n        \"events\": [\n          \"add\",\n          \"change\",\n          \"unlink\"\n        ],\n        \"options\": {\n          \"awaitWriteFinish\": true\n        },\n        \"triggerOn\": \"folder\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"804334d6-e34d-40d1-9555-b331ffe66f6f\",\n      \"name\": \"When clicking \\\"Test workflow\\\"\",\n      \"type\": \"n8n-nodes-base.manualTrigger\",\n      \"position\": [\n        664.5766613599001,\n        881.8474780113352\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"7ab0e284-b667-4d1f-8ceb-fb05e4081a06\",\n      \"name\": \"Set Variables\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        840,\n        700\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"35ea70c4-8669-4975-a68d-bbaa094713c0\",\n              \"name\": \"directory\",\n              \"type\": \"string\",\n              \"value\": \"/home/node/BankStatements\"\n            },\n            {\n              \"id\": \"1d081d19-ff4e-462a-9cbe-7af2244bf87f\",\n              \"name\": \"file_added\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.event === 'add' && $json.path || ''}}\"\n            },\n            {\n              \"id\": \"18f8dc03-51ca-48c7-947f-87ce8e1979bf\",\n              \"name\": \"file_changed\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.event === 'change' && $json.path || '' }}\"\n            },\n            {\n              \"id\": \"65074ff7-037b-4b3b-b2c3-8a61755ab43b\",\n              \"name\": \"file_deleted\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.event === 'unlink' && $json.path || '' }}\"\n            },\n            {\n              \"id\": \"9a1902e7-f94d-4d1f-9006-91c67354d3e8\",\n              \"name\": \"qdrant_collection\",\n              \"type\": \"string\",\n              \"value\": \"local_file_search\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.3\n    },\n    {\n      \"id\": \"76173972-ceca-43a4-b85f-00b41f774304\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        580,\n        460\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 665.0909497859384,\n        \"height\": 596.8351502261468,\n        \"content\": \"## 第一步：选择目标文件夹\\n[详细了解本地文件触发器](https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.localfiletrigger)\\n\\n在本工作流中，我们将监控n8n可访问的磁盘上的特定文件夹。由于使用docker环境，我们可以选择使用n8n的存储卷，或挂载宿主机的文件夹。\\n\\n本地文件触发器的作用是：当目标文件夹内容发生变更时，自动触发工作流执行。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"eda839f7-dde4-4d1f-9fe6-692df4ac7282\",\n      \"name\": \"Sticky Note4\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        184.57666135990007,\n        461.84747801133517\n      ],\n      \"parameters\": {\n        \"width\": 372.51107341403605,\n        \"height\": 356.540665091993,\n        \"content\": \"## 试试看吧！\\n### 该工作流程实现以下功能：\\n* 通过本地文件触发器监控目标文件夹的变更\\n* 将目标文件夹中的文件与Qdrant中的向量数据同步\\n* 使用Mistral AI为目标文件夹所有文件创建问答AI代理\\n\\n### 需要帮助？\\n加入[Discord讨论组](https://discord.com/invite/XPKeKXeB7d) 或前往[论坛提问](https://community.n8n.io/)！\\n\\n祝您探索愉快！\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"f82f6de0-af8f-4fdf-a733-f59ba4fed02f\",\n      \"name\": \"Read File\",\n      \"type\": \"n8n-nodes-base.readWriteFile\",\n      \"position\": [\n        1340,\n        1120\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"fileSelector\": \"={{ $json.file_added }}\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"7354a080-051b-479f-97b1-49cc0c14c9d8\",\n      \"name\": \"Embeddings Mistral Cloud\",\n      \"type\": \"@n8n/n8n-nodes-langchain.embeddingsMistralCloud\",\n      \"position\": [\n        1720,\n        1280\n      ],\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"mistralCloudApi\": {\n          \"id\": \"EIl2QxhXAS9Hkg37\",\n          \"name\": \"Mistral Cloud account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"a1ad45ff-a882-4aed-82e2-cad2483cf4e8\",\n      \"name\": \"Default Data Loader\",\n      \"type\": \"@n8n/n8n-nodes-langchain.documentDefaultDataLoader\",\n      \"position\": [\n        1820,\n        1280\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"metadata\": {\n            \"metadataValues\": [\n              {\n                \"name\": \"filter_by_filename\",\n                \"value\": \"={{ $json.file_location }}\"\n              },\n              {\n                \"name\": \"filter_by_created_month\",\n                \"value\": \"={{ $now.year + '-' + $now.monthShort }}\"\n              },\n              {\n                \"name\": \"filter_by_created_week\",\n                \"value\": \"={{ $now.year + '-' + $now.monthShort + '-W' + $now.weekNumber }}\"\n              }\n            ]\n          }\n        },\n        \"jsonData\": \"={{ $json.data }}\",\n        \"jsonMode\": \"expressionData\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"0b0e29b9-8873-4074-94dc-9f0364c28835\",\n      \"name\": \"Recursive Character Text Splitter\",\n      \"type\": \"@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter\",\n      \"position\": [\n        1840,\n        1400\n      ],\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"c0555ba6-a1bd-4aa9-a340-a9c617f8e6db\",\n      \"name\": \"Prepare Embedding Document\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1520,\n        1120\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"41a1d4ca-e5a5-4fb9-b249-8796ae759b33\",\n              \"name\": \"data\",\n              \"type\": \"string\",\n              \"value\": \"=## file location\\n{{ [$json.directory, $json.fileName].join('/') }}\\n## file created\\n{{ $now.toISO() }}\\n## file contents\\n{{ $input.item.binary.data.data.base64Decode() }}\"\n            },\n            {\n              \"id\": \"c091704d-b81c-448b-8c90-156ef568b871\",\n              \"name\": \"file_location\",\n              \"type\": \"string\",\n              \"value\": \"={{ [$json.directory, $json.fileName].join('/') }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.3\n    },\n    {\n      \"id\": \"ffe8c363-0809-4d21-aa8f-34b0fc2dc57f\",\n      \"name\": \"Chat Trigger\",\n      \"type\": \"@n8n/n8n-nodes-langchain.chatTrigger\",\n      \"position\": [\n        2280,\n        680\n      ],\n      \"webhookId\": \"37587fe0-b8db-4012-90a7-1f65b9bfd0df\",\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"8d958669-60be-4bb2-80fc-2a6c7c7bfae6\",\n      \"name\": \"Question and Answer Chain\",\n      \"type\": \"@n8n/n8n-nodes-langchain.chainRetrievalQa\",\n      \"position\": [\n        2500,\n        680\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1.3\n    },\n    {\n      \"id\": \"f143e438-8176-4923-a866-3f9a2a16793d\",\n      \"name\": \"Mistral Cloud Chat Model\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatMistralCloud\",\n      \"position\": [\n        2500,\n        840\n      ],\n      \"parameters\": {\n        \"model\": \"mistral-small-2402\",\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"mistralCloudApi\": {\n          \"id\": \"EIl2QxhXAS9Hkg37\",\n          \"name\": \"Mistral Cloud account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"06dd8f4c-3b66-43e0-85c8-ec222e275f87\",\n      \"name\": \"Vector Store Retriever\",\n      \"type\": \"@n8n/n8n-nodes-langchain.retrieverVectorStore\",\n      \"position\": [\n        2620,\n        840\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"2fdabcb5-a7a7-4e02-8c1b-9190e2e52385\",\n      \"name\": \"Embeddings Mistral Cloud1\",\n      \"type\": \"@n8n/n8n-nodes-langchain.embeddingsMistralCloud\",\n      \"position\": [\n        2620,\n        1080\n      ],\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"mistralCloudApi\": {\n          \"id\": \"EIl2QxhXAS9Hkg37\",\n          \"name\": \"Mistral Cloud account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"e5664534-de07-481f-87dd-68d7d0715baa\",\n      \"name\": \"Remap for File_Added Flow\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1920,\n        700\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"840219e1-ed47-4b00-83fd-6b3c0bd71650\",\n              \"name\": \"file_added\",\n              \"type\": \"string\",\n              \"value\": \"={{ $('Set Variables').item.json.file_changed }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.3\n    },\n    {\n      \"id\": \"1fd14832-aafe-4d72-b4f2-7afc72df97dc\",\n      \"name\": \"Search For Existing Point\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1340,\n        280\n      ],\n      \"parameters\": {\n        \"url\": \"=http://qdrant:6333/collections/{{ $('Set Variables').item.json.qdrant_collection }}/points/scroll\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"jsonBody\": \"={\\n    \\\"filter\\\": {\\n        \\\"must\\\": [\\n            {\\n                \\\"key\\\": \\\"metadata.filter_by_filename\\\",\\n                \\\"match\\\": {\\n                    \\\"value\\\": \\\"{{ $json.file_changed }}\\\"\\n                }\\n            }\\n        ]\\n    },\\n    \\\"limit\\\": 1,\\n    \\\"with_payload\\\": false,\\n    \\\"with_vector\\\": false\\n}\",\n        \"sendBody\": true,\n        \"specifyBody\": \"json\",\n        \"authentication\": \"predefinedCredentialType\",\n        \"nodeCredentialType\": \"qdrantApi\"\n      },\n      \"credentials\": {\n        \"qdrantApi\": {\n          \"id\": \"NyinAS3Pgfik66w5\",\n          \"name\": \"QdrantApi account\"\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"b5fa817f-82d6-41dd-9817-4c1dd9137b76\",\n      \"name\": \"Has Existing Point?\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        1520,\n        280\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"0392bac0-8fb5-406b-b59f-575edf5ab30d\",\n              \"operator\": {\n                \"type\": \"array\",\n                \"operation\": \"notEmpty\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json.result.points }}\",\n              \"rightValue\": \"\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"b0fa4fa4-5d1b-4a12-b8ba-a10d71f31f94\",\n      \"name\": \"Delete Existing Point\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1720,\n        700\n      ],\n      \"parameters\": {\n        \"url\": \"=http://qdrant:6333/collections/{{ $('Set Variables').item.json.qdrant_collection }}/points/delete\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"sendBody\": true,\n        \"authentication\": \"predefinedCredentialType\",\n        \"bodyParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"points\",\n              \"value\": \"={{ $json.result.points.map(point => point.id) }}\"\n            }\n          ]\n        },\n        \"nodeCredentialType\": \"qdrantApi\"\n      },\n      \"credentials\": {\n        \"qdrantApi\": {\n          \"id\": \"NyinAS3Pgfik66w5\",\n          \"name\": \"QdrantApi account\"\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"5408adfe-4d6b-407c-aac7-e87c9b1a1592\",\n      \"name\": \"Search For Existing Point1\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1340,\n        700\n      ],\n      \"parameters\": {\n        \"url\": \"=http://qdrant:6333/collections/{{ $('Set Variables').item.json.qdrant_collection }}/points/scroll\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"jsonBody\": \"={\\n    \\\"filter\\\": {\\n        \\\"must\\\": [\\n            {\\n                \\\"key\\\": \\\"metadata.filter_by_filename\\\",\\n                \\\"match\\\": {\\n                    \\\"value\\\": \\\"{{ $json.file_changed }}\\\"\\n                }\\n            }\\n        ]\\n    },\\n    \\\"limit\\\": 1,\\n    \\\"with_payload\\\": false,\\n    \\\"with_vector\\\": false\\n}\",\n        \"sendBody\": true,\n        \"specifyBody\": \"json\",\n        \"authentication\": \"predefinedCredentialType\",\n        \"nodeCredentialType\": \"qdrantApi\"\n      },\n      \"credentials\": {\n        \"qdrantApi\": {\n          \"id\": \"NyinAS3Pgfik66w5\",\n          \"name\": \"QdrantApi account\"\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"fac43587-0d24-4d6e-a0d5-8cc8f9615967\",\n      \"name\": \"Has Existing Point?1\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        1520,\n        700\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"0392bac0-8fb5-406b-b59f-575edf5ab30d\",\n              \"operator\": {\n                \"type\": \"array\",\n                \"operation\": \"notEmpty\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json.result.points }}\",\n              \"rightValue\": \"\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"010baacd-fac1-4cc1-86bf-9d6ef11916fe\",\n      \"name\": \"Delete Existing Point1\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1700,\n        280\n      ],\n      \"parameters\": {\n        \"url\": \"=http://qdrant:6333/collections/{{ $('Set Variables').item.json.qdrant_collection }}/points/delete\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"sendBody\": true,\n        \"authentication\": \"predefinedCredentialType\",\n        \"bodyParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"points\",\n              \"value\": \"={{ $json.result.points.map(point => point.id) }}\"\n            }\n          ]\n        },\n        \"nodeCredentialType\": \"qdrantApi\"\n      },\n      \"credentials\": {\n        \"qdrantApi\": {\n          \"id\": \"NyinAS3Pgfik66w5\",\n          \"name\": \"QdrantApi account\"\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"2d6fb29c-2fac-41de-9ad0-cc781b246378\",\n      \"name\": \"Handle File Event\",\n      \"type\": \"n8n-nodes-base.switch\",\n      \"position\": [\n        1000,\n        700\n      ],\n      \"parameters\": {\n        \"rules\": {\n          \"values\": [\n            {\n              \"outputKey\": \"file_deleted\",\n              \"conditions\": {\n                \"options\": {\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"a1f6d86a-9805-4d0e-ac70-90c9cf0ad339\",\n                    \"operator\": {\n                      \"type\": \"string\",\n                      \"operation\": \"notEmpty\",\n                      \"singleValue\": true\n                    },\n                    \"leftValue\": \"={{ $json.file_deleted }}\",\n                    \"rightValue\": \"\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            },\n            {\n              \"outputKey\": \"file_changed\",\n              \"conditions\": {\n                \"options\": {\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"d15cde67-b5b0-4676-b4fb-ead749147392\",\n                    \"operator\": {\n                      \"type\": \"string\",\n                      \"operation\": \"notEmpty\",\n                      \"singleValue\": true\n                    },\n                    \"leftValue\": \"={{ $json.file_changed }}\",\n                    \"rightValue\": \"\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            },\n            {\n              \"outputKey\": \"file_added\",\n              \"conditions\": {\n                \"options\": {\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"operator\": {\n                      \"type\": \"string\",\n                      \"operation\": \"notEmpty\",\n                      \"singleValue\": true\n                    },\n                    \"leftValue\": \"={{ $json.file_added }}\",\n                    \"rightValue\": \"\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            }\n          ]\n        },\n        \"options\": {}\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"da91b2aa-613c-4e3e-af83-fbd3bb7e922e\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1280,\n        123.92779403575491\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 847.032584995578,\n        \"height\": 335.8400964393443,\n        \"content\": \"## 第二步：文件删除时同步清除向量点\\n[了解如何使用Qdrant API删除向量点](https://qdrant.tech/documentation/concepts/points/#delete-points)\\n\\n为确保向量存储库的时效性，我们将实现一个简易同步机制：当本地文件目录中的文档被删除时，Qdrant中的对应向量也将被清除。通过Qdrant提供的API接口，这一功能可轻松实现。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"2f9f5b2b-6504-4b27-a0c4-f3373df352df\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1280,\n        480\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 855.9952607674757,\n        \"height\": 433.01782147687817,\n        \"content\": \"## 第三步：文件更新时同步更新向量点\\n[了解如何使用Qdrant API删除向量点](https://qdrant.tech/documentation/concepts/points/#delete-points)\\n\\n与处理文件删除的逻辑类似，当检测到文件变更时，我们将更新Qdrant中对应的向量点，确保向量存储库保持最新状态。具体操作可通过删除原有向量点，并使用更新后的银行对账单重新创建来实现。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"38128b7f-d0f2-405c-a7de-662df812c344\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1280,\n        940\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 846.8204626627492,\n        \"height\": 629.9714759033081,\n        \"content\": \"## 步骤4. 当新增文件时，将其添加至Qdrant向量数据库\\n[详细了解Qdrant节点](https://docs.n8n.io/integrations/builtin/cluster-nodes/root-nodes/n8n-nodes-langchain.vectorstoreqdrant)\\n\\n通过Qdrant，我们将能为银行流水打造一个简洁却强大的RAG应用。Qdrant最突出的功能之一是其过滤系统，我们将利用它来协调本地文件系统与Qdrant之间的同步管理。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"e85e2a30-e775-42fe-a12a-ac5de4eb4673\",\n      \"name\": \"Sticky Note5\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        2180,\n        491.43199269284935\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 744.4578330639196,\n        \"height\": 759.7908149448928,\n        \"content\": \"## 步骤5. 创建历史银行流水AI专家  \\n[详细了解问答链](https://docs.n8n.io/integrations/builtin/cluster-nodes/root-nodes/n8n-nodes-langchain.chainretrievalqa)  \\n\\n最后，我们将使用问答AI节点，将Mistral AI模型与Qdrant向量存储检索器相结合，打造一个能解答所有银行流水问题的本地专家系统。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"7b29b0b9-ffee-4456-b036-9b39400d2b31\",\n      \"name\": \"Qdrant Vector Store\",\n      \"type\": \"@n8n/n8n-nodes-langchain.vectorStoreQdrant\",\n      \"position\": [\n        1700,\n        1120\n      ],\n      \"parameters\": {\n        \"mode\": \"insert\",\n        \"options\": {},\n        \"qdrantCollection\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $('Set Variables').item.json.qdrant_collection }}\"\n        }\n      },\n      \"credentials\": {\n        \"qdrantApi\": {\n          \"id\": \"NyinAS3Pgfik66w5\",\n          \"name\": \"QdrantApi account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"1857bebb-b492-415e-96c8-235329bfd28a\",\n      \"name\": \"Qdrant Vector Store1\",\n      \"type\": \"@n8n/n8n-nodes-langchain.vectorStoreQdrant\",\n      \"position\": [\n        2620,\n        960\n      ],\n      \"parameters\": {\n        \"qdrantCollection\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"BankStatements\"\n        }\n      },\n      \"credentials\": {\n        \"qdrantApi\": {\n          \"id\": \"NyinAS3Pgfik66w5\",\n          \"name\": \"QdrantApi account\"\n        }\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"pinData\": {},\n  \"connections\": {\n    \"Read File\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Prepare Embedding Document\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Chat Trigger\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Question and Answer Chain\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Set Variables\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Handle File Event\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Handle File Event\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Search For Existing Point\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Search For Existing Point1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Read File\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Local File Trigger\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Set Variables\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Default Data Loader\": {\n      \"ai_document\": [\n        [\n          {\n            \"node\": \"Qdrant Vector Store\",\n            \"type\": \"ai_document\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Has Existing Point?\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Delete Existing Point1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Has Existing Point?1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Delete Existing Point\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Qdrant Vector Store1\": {\n      \"ai_vectorStore\": [\n        [\n          {\n            \"node\": \"Vector Store Retriever\",\n            \"type\": \"ai_vectorStore\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Delete Existing Point\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Remap for File_Added Flow\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Vector Store Retriever\": {\n      \"ai_retriever\": [\n        [\n          {\n            \"node\": \"Question and Answer Chain\",\n            \"type\": \"ai_retriever\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Embeddings Mistral Cloud\": {\n      \"ai_embedding\": [\n        [\n          {\n            \"node\": \"Qdrant Vector Store\",\n            \"type\": \"ai_embedding\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Mistral Cloud Chat Model\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"Question and Answer Chain\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Embeddings Mistral Cloud1\": {\n      \"ai_embedding\": [\n        [\n          {\n            \"node\": \"Qdrant Vector Store1\",\n            \"type\": \"ai_embedding\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Remap for File_Added Flow\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Read File\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Search For Existing Point\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Has Existing Point?\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Prepare Embedding Document\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Qdrant Vector Store\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Search For Existing Point1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Has Existing Point?1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"When clicking \\\"Test workflow\\\"\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Set Variables\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Recursive Character Text Splitter\": {\n      \"ai_textSplitter\": [\n        [\n          {\n            \"node\": \"Default Data Loader\",\n            \"type\": \"ai_textSplitter\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}