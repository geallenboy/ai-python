{
  "url": "https://n8n.io/workflows/609-manage-incident-reporting-in-pagerduty-and-cratedb/",
  "title": "Manage incident reporting in PagerDuty and CrateDB",
  "author": "Harshil Agrawal",
  "publish_date": "Last update 10 months ago",
  "publish_date_absolute": "2024-07-25",
  "categories": [
    {
      "name": "SecOps"
    }
  ],
  "workflow_json": "{\"id\":\"168\",\"name\":\"Smart Factory Use Case\",\"nodes\":[{\"name\":\"Values higher than 50°C\",\"type\":\"n8n-nodes-base.if\",\"position\":[250,550],\"parameters\":{\"conditions\":{\"number\":[{\"value1\":\"={{$node[\\\"Data from factory sensors\\\"].json[\\\"body\\\"][\\\"temperature_celsius\\\"]}}\",\"value2\":50,\"operation\":\"largerEqual\"}]}},\"typeVersion\":1},{\"name\":\"Data from factory sensors\",\"type\":\"n8n-nodes-base.amqpTrigger\",\"position\":[50,700],\"parameters\":{\"sink\":\"berlin_factory_01\",\"options\":{}},\"credentials\":{\"amqp\":\"\"},\"typeVersion\":1},{\"name\":\"Set sensor data\",\"type\":\"n8n-nodes-base.set\",\"position\":[450,850],\"parameters\":{\"values\":{\"number\":[{\"name\":\"temeprature_fahrenheit\",\"value\":\"={{$node[\\\"Data enrichment (°C to °F)\\\"].json[\\\"temperature_fahrenheit\\\"]}}\"},{\"name\":\"temperature_celsius\",\"value\":\"={{$node[\\\"Data enrichment (°C to °F)\\\"].json[\\\"body\\\"][\\\"temperature_celsius\\\"]}}\"},{\"name\":\"machine_uptime\",\"value\":\"={{$node[\\\"Data from factory sensors\\\"].json[\\\"body\\\"][\\\"machine_id\\\"][\\\"uptime\\\"]}}\"},{\"name\":\"time_stamp\",\"value\":\"={{$node[\\\"Data from factory sensors\\\"].json[\\\"body\\\"][\\\"time_stamp\\\"]}}\"}],\"string\":[{\"name\":\"machine_name\",\"value\":\"={{$node[\\\"Data from factory sensors\\\"].json[\\\"body\\\"][\\\"machine_id\\\"][\\\"name\\\"]}}\"}]},\"options\":{}},\"typeVersion\":1},{\"name\":\"Ingest machine data\",\"type\":\"n8n-nodes-base.crateDb\",\"position\":[650,850],\"parameters\":{\"table\":\"machine_data\",\"columns\":\"temperature_fahrenheit, temperature_celsius, machine_name, machine_uptime, time_stamp\"},\"credentials\":{\"crateDb\":\"\"},\"typeVersion\":1},{\"name\":\"Ingest incident data\",\"type\":\"n8n-nodes-base.crateDb\",\"position\":[850,450],\"parameters\":{\"table\":\"incident_data\",\"columns\":\"incident_id, html_url, incident_timestamp\"},\"credentials\":{\"crateDb\":\"\"},\"typeVersion\":1},{\"name\":\"Set incident info\",\"type\":\"n8n-nodes-base.set\",\"position\":[650,450],\"parameters\":{\"values\":{\"string\":[{\"name\":\"incident_id\",\"value\":\"={{$node[\\\"Create an incident\\\"].json[\\\"id\\\"]}}\"},{\"name\":\"html_url\",\"value\":\"={{$node[\\\"Create an incident\\\"].json[\\\"html_url\\\"]}}\"},{\"name\":\"incident_timestamp\",\"value\":\"={{$node[\\\"Create an incident\\\"].json[\\\"created_at\\\"]}}\"}]},\"options\":{},\"keepOnlySet\":true},\"typeVersion\":1},{\"name\":\"Create an incident\",\"type\":\"n8n-nodes-base.pagerDuty\",\"position\":[450,450],\"parameters\":{\"title\":\"=Incident with {{$node[\\\"Data from factory sensors\\\"].json[\\\"body\\\"][\\\"machine_id\\\"][\\\"name\\\"]}}\",\"additionalFields\":{}},\"credentials\":{\"pagerDutyApi\":\"\"},\"typeVersion\":1},{\"name\":\"Data enrichment (°C to °F)\",\"type\":\"n8n-nodes-base.function\",\"position\":[250,850],\"parameters\":{\"functionCode\":\"temp_fahrenheit = (items[0].json.body.temperature_celsius * 1.8) + 32;\\nitems[0].json.temperature_fahrenheit = temp_fahrenheit;\\nreturn items;\"},\"typeVersion\":1,\"alwaysOutputData\":true},{\"name\":\"Do  nothing\",\"type\":\"n8n-nodes-base.noOp\",\"position\":[450,640],\"parameters\":{},\"typeVersion\":1}],\"active\":false,\"settings\":{},\"connections\":{\"Set sensor data\":{\"main\":[[{\"node\":\"Ingest machine data\",\"type\":\"main\",\"index\":0}]]},\"Set incident info\":{\"main\":[[{\"node\":\"Ingest incident data\",\"type\":\"main\",\"index\":0}]]},\"Create an incident\":{\"main\":[[{\"node\":\"Set incident info\",\"type\":\"main\",\"index\":0}]]},\"Values higher than 50°C\":{\"main\":[[{\"node\":\"Create an incident\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Do  nothing\",\"type\":\"main\",\"index\":0}]]},\"Data from factory sensors\":{\"main\":[[{\"node\":\"Data enrichment (°C to °F)\",\"type\":\"main\",\"index\":0},{\"node\":\"Values higher than 50°C\",\"type\":\"main\",\"index\":0}]]},\"Data enrichment (°C to °F)\":{\"main\":[[{\"node\":\"Set sensor data\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "This workflow automatically monitors the functionality of a factory. The workflow logs machine data coming from factory sensors in a CrateDB database, generates an incident report in PagerDuty, and notifies the responsible staff members when the temperature of a machine crosses the threshold value.\n\nThis workflow builds on a [workflow that generates factory data](https://n8n.io/workflows/608).\n\nRead more about this use case and how to build both workflows with step-by-step instructions in the blog post [_How to automate your factory's incident reporting_](https://n8n.io/blog/learn-to-automate-your-factorys-incident-reporting-a-step-by-step-guide/).\n\n## Prerequisites\n\n  * A PagerDuty account and [credentials](https://docs.n8n.io/integrations/nodes/n8n-nodes-base.pagerduty/)\n  * AMQP, an ActiveMQ connection, and [credentials](https://docs.n8n.io/integrations/credentials/amqp/)\n  * A CrateDB instance running locally or on a server, and [credentials](https://docs.n8n.io/integrations/credentials/cratedb/).\n\n\n\n## Nodes\n\n  * [AMQP Trigger node](https://docs.n8n.io/integrations/trigger-nodes/n8n-nodes-base.amqptrigger/) starts the workflow.\n  * [IF node](https://docs.n8n.io/integrations/core-nodes/n8n-nodes-base.if/) filters sensor values higher than 50°C.\n  * [PagerDuty node](https://docs.n8n.io/integrations/nodes/n8n-nodes-base.pagerduty/) creates an incident in the account.\n  * [Set nodes](https://docs.n8n.io/integrations/core-nodes/n8n-nodes-base.set/) set the required incident information and sensor data, respectively.\n  * [CrateDB nodes](https://docs.n8n.io/integrations/nodes/n8n-nodes-base.cratedb/) ingest the information data and machine sensor data, respectively.\n  * [Function node](https://docs.n8n.io/integrations/core-nodes/n8n-nodes-base.function/) converts degrees from Celsius to Fahrenheit.\n\n\n",
  "crawled_at": "2025-05-25T18:29:00.018733",
  "readme_zh": "This workflow automatically monitors the functionality of a factory. The workflow logs machine data coming from factory sensors in a CrateDB database, generates an incident report in PagerDuty, and notifies the responsible staff members when the temperature of a machine crosses the threshold value.\n\nThis workflow builds on a [workflow that generates factory data](https://n8n.io/workflows/608).\n\nRead more about this use case and how to build both workflows with step-by-step instructions in the blog post [_How to automate your factory's incident reporting_](https://n8n.io/blog/learn-to-automate-your-factorys-incident-reporting-a-step-by-step-guide/).\n\n## Prerequisites\n\n  * A PagerDuty account and [credentials](https://docs.n8n.io/integrations/nodes/n8n-nodes-base.pagerduty/)\n  * AMQP, an ActiveMQ connection, and [credentials](https://docs.n8n.io/integrations/credentials/amqp/)\n  * A CrateDB instance running locally or on a server, and [credentials](https://docs.n8n.io/integrations/credentials/cratedb/).\n\n\n\n## Nodes\n\n  * [AMQP Trigger node](https://docs.n8n.io/integrations/trigger-nodes/n8n-nodes-base.amqptrigger/) starts the workflow.\n  * [IF node](https://docs.n8n.io/integrations/core-nodes/n8n-nodes-base.if/) filters sensor values higher than 50°C.\n  * [PagerDuty node](https://docs.n8n.io/integrations/nodes/n8n-nodes-base.pagerduty/) creates an incident in the account.\n  * [Set nodes](https://docs.n8n.io/integrations/core-nodes/n8n-nodes-base.set/) set the required incident information and sensor data, respectively.\n  * [CrateDB nodes](https://docs.n8n.io/integrations/nodes/n8n-nodes-base.cratedb/) ingest the information data and machine sensor data, respectively.\n  * [Function node](https://docs.n8n.io/integrations/core-nodes/n8n-nodes-base.function/) converts degrees from Celsius to Fahrenheit.\n\n\n",
  "title_zh": "在PagerDuty和CrateDB中管理事件报告",
  "publish_date_zh": "最后更新于10个月前",
  "workflow_json_zh": "{\n  \"id\": \"168\",\n  \"name\": \"Smart Factory Use Case\",\n  \"nodes\": [\n    {\n      \"name\": \"Values higher than 50°C\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        250,\n        550\n      ],\n      \"parameters\": {\n        \"conditions\": {\n          \"number\": [\n            {\n              \"value1\": \"={{$node[\\\"Data from factory sensors\\\"].json[\\\"body\\\"][\\\"temperature_celsius\\\"]}}\",\n              \"value2\": 50,\n              \"operation\": \"largerEqual\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Data from factory sensors\",\n      \"type\": \"n8n-nodes-base.amqpTrigger\",\n      \"position\": [\n        50,\n        700\n      ],\n      \"parameters\": {\n        \"sink\": \"berlin_factory_01\",\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"amqp\": \"\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Set sensor data\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        450,\n        850\n      ],\n      \"parameters\": {\n        \"values\": {\n          \"number\": [\n            {\n              \"name\": \"temeprature_fahrenheit\",\n              \"value\": \"={{$node[\\\"Data enrichment (°C to °F)\\\"].json[\\\"temperature_fahrenheit\\\"]}}\"\n            },\n            {\n              \"name\": \"temperature_celsius\",\n              \"value\": \"={{$node[\\\"Data enrichment (°C to °F)\\\"].json[\\\"body\\\"][\\\"temperature_celsius\\\"]}}\"\n            },\n            {\n              \"name\": \"machine_uptime\",\n              \"value\": \"={{$node[\\\"Data from factory sensors\\\"].json[\\\"body\\\"][\\\"machine_id\\\"][\\\"uptime\\\"]}}\"\n            },\n            {\n              \"name\": \"time_stamp\",\n              \"value\": \"={{$node[\\\"Data from factory sensors\\\"].json[\\\"body\\\"][\\\"time_stamp\\\"]}}\"\n            }\n          ],\n          \"string\": [\n            {\n              \"name\": \"machine_name\",\n              \"value\": \"={{$node[\\\"Data from factory sensors\\\"].json[\\\"body\\\"][\\\"machine_id\\\"][\\\"name\\\"]}}\"\n            }\n          ]\n        },\n        \"options\": {}\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Ingest machine data\",\n      \"type\": \"n8n-nodes-base.crateDb\",\n      \"position\": [\n        650,\n        850\n      ],\n      \"parameters\": {\n        \"table\": \"machine_data\",\n        \"columns\": \"temperature_fahrenheit, temperature_celsius, machine_name, machine_uptime, time_stamp\"\n      },\n      \"credentials\": {\n        \"crateDb\": \"\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Ingest incident data\",\n      \"type\": \"n8n-nodes-base.crateDb\",\n      \"position\": [\n        850,\n        450\n      ],\n      \"parameters\": {\n        \"table\": \"incident_data\",\n        \"columns\": \"incident_id, html_url, incident_timestamp\"\n      },\n      \"credentials\": {\n        \"crateDb\": \"\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Set incident info\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        650,\n        450\n      ],\n      \"parameters\": {\n        \"values\": {\n          \"string\": [\n            {\n              \"name\": \"incident_id\",\n              \"value\": \"={{$node[\\\"Create an incident\\\"].json[\\\"id\\\"]}}\"\n            },\n            {\n              \"name\": \"html_url\",\n              \"value\": \"={{$node[\\\"Create an incident\\\"].json[\\\"html_url\\\"]}}\"\n            },\n            {\n              \"name\": \"incident_timestamp\",\n              \"value\": \"={{$node[\\\"Create an incident\\\"].json[\\\"created_at\\\"]}}\"\n            }\n          ]\n        },\n        \"options\": {},\n        \"keepOnlySet\": true\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Create an incident\",\n      \"type\": \"n8n-nodes-base.pagerDuty\",\n      \"position\": [\n        450,\n        450\n      ],\n      \"parameters\": {\n        \"title\": \"=Incident with {{$node[\\\"Data from factory sensors\\\"].json[\\\"body\\\"][\\\"machine_id\\\"][\\\"name\\\"]}}\",\n        \"additionalFields\": {}\n      },\n      \"credentials\": {\n        \"pagerDutyApi\": \"\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Data enrichment (°C to °F)\",\n      \"type\": \"n8n-nodes-base.function\",\n      \"position\": [\n        250,\n        850\n      ],\n      \"parameters\": {\n        \"functionCode\": \"temp_fahrenheit = (items[0].json.body.temperature_celsius * 1.8) + 32;\\nitems[0].json.temperature_fahrenheit = temp_fahrenheit;\\nreturn items;\"\n      },\n      \"typeVersion\": 1,\n      \"alwaysOutputData\": true\n    },\n    {\n      \"name\": \"Do  nothing\",\n      \"type\": \"n8n-nodes-base.noOp\",\n      \"position\": [\n        450,\n        640\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    }\n  ],\n  \"active\": false,\n  \"settings\": {},\n  \"connections\": {\n    \"Set sensor data\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Ingest machine data\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Set incident info\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Ingest incident data\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Create an incident\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Set incident info\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Values higher than 50°C\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Create an incident\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Do  nothing\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Data from factory sensors\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Data enrichment (°C to °F)\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Values higher than 50°C\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Data enrichment (°C to °F)\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Set sensor data\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}