{
  "url": "https://n8n.io/workflows/3328-automatically-create-and-upload-youtube-videos-with-quotes-in-thai-using-ffmpeg/",
  "title": "Automatically Create and Upload YouTube Videos with Quotes in Thai Using FFmpeg",
  "author": "Jaruphat J.",
  "publish_date": "Last update 2 months ago",
  "publish_date_absolute": "2025-03-26",
  "categories": [
    {
      "name": "Product"
    },
    {
      "name": "Building Blocks"
    }
  ],
  "workflow_json": "{\"id\":\"gI3QGKTf52zwyh6O\",\"meta\":{\"instanceId\":\"e2034325698638870d6b764285427bad9d79bf1e08a458be597c06e61ad7e545\",\"templateCredsSetupCompleted\":true},\"name\":\"AutoClip – Automatically Generate Video Clips and Upload to YouTube\",\"tags\":[],\"nodes\":[{\"id\":\"99e8f5d2-247a-44c7-85db-4bdd63c2a4f6\",\"name\":\"Start AutoClip Workflow\",\"type\":\"n8n-nodes-base.manualTrigger\",\"position\":[40,0],\"parameters\":{},\"typeVersion\":1},{\"id\":\"221b0fa1-7e71-43e1-88a6-7070c6c10ed8\",\"name\":\"Retrieve Video Background Data\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[500,180],\"parameters\":{\"columns\":{\"value\":{\"BackgroundURL\":\"={{ $json.webViewLink }}\"},\"schema\":[{\"id\":\"BackgroundURL\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"BackgroundURL\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"BackgroudStatus\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"BackgroudStatus\",\"defaultMatch\":false,\"canBeUsedToMatch\":true}],\"mappingMode\":\"defineBelow\",\"matchingColumns\":[],\"attemptToConvertTypes\":false,\"convertFieldsToString\":false},\"options\":{},\"operation\":\"append\",\"sheetName\":{\"__rl\":true,\"mode\":\"list\",\"value\":90817124,\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/184-zcrfWSzQpDa-t57Oo_8DLyAF-2B_6yvGrybrcd5I/edit#gid=90817124\",\"cachedResultName\":\"video_backgroud_list\"},\"documentId\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"184-zcrfWSzQpDa-t57Oo_8DLyAF-2B_6yvGrybrcd5I\"}},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"Ra2f1dlqOJ13jTtb\",\"name\":\"Google Sheets account\"}},\"typeVersion\":4.5},{\"id\":\"120db4aa-5a1a-4685-9d1d-6d7814b20458\",\"name\":\"Retrieve Quote Data\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[500,0],\"parameters\":{\"options\":{},\"filtersUI\":{\"values\":[{\"lookupColumn\":\"CreateStatus\"}]},\"sheetName\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"gid=0\",\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/184-zcrfWSzQpDa-t57Oo_8DLyAF-2B_6yvGrybrcd5I/edit#gid=0\",\"cachedResultName\":\"Quotes_status\"},\"documentId\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"184-zcrfWSzQpDa-t57Oo_8DLyAF-2B_6yvGrybrcd5I\"}},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"Ra2f1dlqOJ13jTtb\",\"name\":\"Google Sheets account\"}},\"typeVersion\":4.5},{\"id\":\"17e6585a-0e48-40e7-86ec-4fb53f45bd07\",\"name\":\"List Video Background Files\",\"type\":\"n8n-nodes-base.googleDrive\",\"position\":[260,180],\"parameters\":{\"filter\":{\"folderId\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"1mLOqFJZvUm563mJ7LvTsIcKrAoakX-h2\"}},\"options\":{\"fields\":[\"webViewLink\",\"id\",\"name\"]},\"resource\":\"fileFolder\"},\"credentials\":{\"googleDriveOAuth2Api\":{\"id\":\"nd1GyFEAYkpaT3xt\",\"name\":\"Google Drive account\"}},\"typeVersion\":3},{\"id\":\"34d51d42-2562-4437-8cbc-e0158badb134\",\"name\":\"Configure Music Background Folder ID\",\"type\":\"n8n-nodes-base.set\",\"position\":[40,360],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"19727718-f70d-4333-93dd-1ade2b1a66bf\",\"name\":\"MusicBackgroundFolderID\",\"type\":\"string\",\"value\":\"12T6ABEuR7WlZ2i88GqcB3U4DmuKVM4iR\"}]}},\"typeVersion\":3.4},{\"id\":\"0d819b1f-923d-4500-858a-166d65864872\",\"name\":\"List Music Background Files\",\"type\":\"n8n-nodes-base.googleDrive\",\"position\":[260,360],\"parameters\":{\"filter\":{\"folderId\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"=12T6ABEuR7WlZ2i88GqcB3U4DmuKVM4iR\"}},\"options\":{\"fields\":[\"webViewLink\",\"name\",\"id\"]},\"resource\":\"fileFolder\"},\"credentials\":{\"googleDriveOAuth2Api\":{\"id\":\"OEWvSsY5xiUhqOnx\",\"name\":\"Google Drive account - PeakWave\"}},\"typeVersion\":3},{\"id\":\"3041385c-52d9-4d95-a454-de2064164717\",\"name\":\"Retrieve Music Background Data\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[500,360],\"parameters\":{\"columns\":{\"value\":{\"MusicURL\":\"={{ $json.webViewLink }}\"},\"schema\":[{\"id\":\"MusicURL\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"MusicURL\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"MusicStatus\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"MusicStatus\",\"defaultMatch\":false,\"canBeUsedToMatch\":true}],\"mappingMode\":\"defineBelow\",\"matchingColumns\":[],\"attemptToConvertTypes\":false,\"convertFieldsToString\":false},\"options\":{},\"operation\":\"append\",\"sheetName\":{\"__rl\":true,\"mode\":\"list\",\"value\":1264732774,\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/184-zcrfWSzQpDa-t57Oo_8DLyAF-2B_6yvGrybrcd5I/edit#gid=1264732774\",\"cachedResultName\":\"music_backgroud_list\"},\"documentId\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"184-zcrfWSzQpDa-t57Oo_8DLyAF-2B_6yvGrybrcd5I\"}},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"Ra2f1dlqOJ13jTtb\",\"name\":\"Google Sheets account\"}},\"typeVersion\":4.5},{\"id\":\"ab86cac3-e44e-4e87-a467-a1c26e1f9752\",\"name\":\"Merge File Selection Data\",\"type\":\"n8n-nodes-base.merge\",\"position\":[740,200],\"parameters\":{\"numberInputs\":3},\"typeVersion\":3},{\"id\":\"28c79ad7-cb34-424a-97ed-fcec5471e179\",\"name\":\"Select Random Video, Music & Quote\",\"type\":\"n8n-nodes-base.code\",\"position\":[940,200],\"parameters\":{\"jsCode\":\"function getRandomItem(arr) {\\n  return arr[Math.floor(Math.random() * arr.length)];\\n}\\n\\n// Filter items based on unique keys from the merged inputs\\nconst videoItems = items.filter(item => item.json.BackgroundURL !== undefined);\\nconst musicItems = items.filter(item => item.json.MusicURL !== undefined);\\nconst quoteItems = items.filter(item => item.json.Qoute !== undefined);\\n\\n// Debug logs to check counts in the execution log\\nconsole.log(\\\"Video Items count: \\\" + videoItems.length);\\nconsole.log(\\\"Music Items count: \\\" + musicItems.length);\\nconsole.log(\\\"Quote Items count: \\\" + quoteItems.length);\\n\\nif (videoItems.length === 0 || musicItems.length === 0 || quoteItems.length === 0) {\\n  throw new Error(\\\"One or more input arrays are empty. Check your previous nodes.\\\");\\n}\\n\\nconst selectedVideo = getRandomItem(videoItems);\\nconst selectedMusic = getRandomItem(musicItems);\\nconst selectedQuote = getRandomItem(quoteItems);\\n\\n// Return the combined selected items\\nreturn [{\\n  video: selectedVideo.json,\\n  music: selectedMusic.json,\\n  quote: selectedQuote.json\\n}];\\n\"},\"typeVersion\":2},{\"id\":\"bd3fa420-555d-46a2-b48c-15a916f62b44\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-20,-120],\"parameters\":{\"width\":1100,\"height\":660,\"content\":\"## Data Preparation & File Selection\\nRetrieve and merge source data for quotes, video backgrounds, and music from Google Sheets and Google Drive; then randomly select one quote, one background video, and one music file.\"},\"typeVersion\":1},{\"id\":\"7da639cb-6576-4ab5-891a-308ce35aecaf\",\"name\":\"Download Selected Video Background\",\"type\":\"n8n-nodes-base.googleDrive\",\"position\":[1180,0],\"parameters\":{\"fileId\":{\"__rl\":true,\"mode\":\"url\",\"value\":\"={{ $json.video.BackgroundURL }}\"},\"options\":{\"binaryPropertyName\":\"data\"},\"operation\":\"download\"},\"credentials\":{\"googleDriveOAuth2Api\":{\"id\":\"OEWvSsY5xiUhqOnx\",\"name\":\"Google Drive account - PeakWave\"}},\"typeVersion\":3},{\"id\":\"5ee8befc-979d-4a47-8eba-b31d6de8ea1f\",\"name\":\"Download Selected Music Background\",\"type\":\"n8n-nodes-base.googleDrive\",\"position\":[1180,340],\"parameters\":{\"fileId\":{\"__rl\":true,\"mode\":\"url\",\"value\":\"={{ $json.music.MusicURL }}\"},\"options\":{\"binaryPropertyName\":\"data\"},\"operation\":\"download\"},\"credentials\":{\"googleDriveOAuth2Api\":{\"id\":\"OEWvSsY5xiUhqOnx\",\"name\":\"Google Drive account - PeakWave\"}},\"typeVersion\":3},{\"id\":\"fd8fd1f8-64a6-4bf0-8586-8f5be506c8a1\",\"name\":\"Save Video Background Locally\",\"type\":\"n8n-nodes-base.readWriteFile\",\"position\":[1420,0],\"parameters\":{\"options\":{},\"fileName\":\"video1.mp4\",\"operation\":\"write\"},\"typeVersion\":1},{\"id\":\"9a8e1891-16c2-490c-ae91-4773f90e67d3\",\"name\":\"Save Music Background Locally\",\"type\":\"n8n-nodes-base.readWriteFile\",\"position\":[1420,340],\"parameters\":{\"options\":{\"append\":false},\"fileName\":\"music1.mp3\",\"operation\":\"write\"},\"typeVersion\":1},{\"id\":\"9fdca64e-79d7-4a58-91dc-4aa9f9b3c4cc\",\"name\":\"Prepare Overlay Text (Quote & Author)\",\"type\":\"n8n-nodes-base.code\",\"position\":[1620,20],\"parameters\":{\"jsCode\":\"// Define separate configuration for the quote and the author\\nconst quoteFont = \\\"Kanit-Italic.ttf\\\";      // Font for the quote\\nconst quoteFontSize = 70;\\nconst authorFont = \\\"Kanit-Italic.ttf\\\";         // Font for the author (ensure this supports Thai)\\nconst authorFontSize = 50;\\nconst fontColor = \\\"white\\\";\\nconst lineHeightMultiplier = 1.1;\\nconst videoWidth = 1080;\\nconst margin = 40;  // Gap from left and right edges\\n\\n// Effective width for the quote text (accounting for left/right margins)\\nconst effectiveVideoWidth = videoWidth - 2 * margin;\\n\\n// Estimate average character width based on quoteFontSize (this is a rough estimate)\\nconst avgCharWidth = quoteFontSize * 0.6;\\nconst maxCharsPerLine = Math.floor(effectiveVideoWidth / avgCharWidth);\\n\\n// Retrieve the quote transcript and author from the \\\"Merge\\\" node\\nconst transcript = $node[\\\"Merge File Selection Data\\\"].json[\\\"Qoute\\\"];\\nif (!transcript) {\\n  throw new Error(\\\"Quote not found\\\");\\n}\\nconst author = $node[\\\"Merge File Selection Data\\\"].json[\\\"Author\\\"];\\nif (!author) {\\n  throw new Error(\\\"Author not found\\\");\\n}\\n\\n// Split the transcript into words and group them into lines based on maxCharsPerLine\\nconst words = transcript.split(' ');\\nconst lines = [];\\nlet currentLine = \\\"\\\";\\nlet currentCharCount = 0;\\n\\nwords.forEach(word => {\\n  const wordLength = word.length;\\n  const additionalSpace = currentLine ? 1 : 0;\\n  const potentialLength = currentCharCount + additionalSpace + wordLength;\\n  if (potentialLength <= maxCharsPerLine) {\\n    currentLine += (currentLine ? \\\" \\\" : \\\"\\\") + word;\\n    currentCharCount = potentialLength;\\n  } else {\\n    lines.push(currentLine);\\n    currentLine = word;\\n    currentCharCount = wordLength;\\n  }\\n});\\nif (currentLine) {\\n  lines.push(currentLine);\\n}\\n\\n// Calculate layout for the quote block\\nconst lineHeight = quoteFontSize * lineHeightMultiplier;\\nconst totalHeight = lines.length * lineHeight;\\n\\n// Build drawtext commands for each quote line (centered horizontally)\\n// Each line is positioned so that the entire quote block is vertically centered.\\nconst quoteCommands = lines.map((line, index) => {\\n  // Escape any single quotes in the line\\n  const escapedLine = line.replace(/'/g, \\\"\\\\\\\\'\\\");\\n  return `drawtext=fontfile=${quoteFont}:text='${escapedLine}':fontsize=${quoteFontSize}:fontcolor=${fontColor}:x=(w-text_w)/2:y=((h-${totalHeight})/2)+(${index}*${lineHeight})`;\\n});\\n\\n// Build the drawtext command for the author\\n// Place the author text below the quote block with a small gap (e.g. 20 pixels)\\n// Align it to the right by setting x = w - text_w - margin.\\nconst authorY = `((h-${totalHeight})/2)+(${lines.length}*${lineHeight})+20`;\\nconst escapedAuthor = author.replace(/'/g, \\\"\\\\\\\\'\\\");\\nconst authorCommand = `drawtext=fontfile=${authorFont}:text='${escapedAuthor}':fontsize=${authorFontSize}:fontcolor=${fontColor}:x=w-text_w-${margin}:y=${authorY}`;\\n\\n// Combine all commands (separated by commas) into one drawtext filter string.\\nconst fullDrawTextFilter = quoteCommands.concat(authorCommand).join(\\\", \\\");\\n\\n// Return the prepared filter string for insertion into your FFmpeg command.\\nreturn {\\n  json: {\\n    drawText: fullDrawTextFilter\\n  }\\n};\\n\"},\"typeVersion\":2},{\"id\":\"082cf794-89a9-42cc-b9ee-96792a17893f\",\"name\":\"Generate Final Video Clip\",\"type\":\"n8n-nodes-base.executeCommand\",\"position\":[1640,340],\"parameters\":{\"command\":\"=ffmpeg -i {{ $('Save Video Background Locally').item.json.fileName }} -i {{ $('Save Music Background Locally').item.json.fileName }} -filter_complex \\\"[0:v]scale=1080:1920:force_original_aspect_ratio=increase,crop=1080:1920[vid]; color=black@0.3:size=1080x1920:d=10[bg]; [vid][bg]overlay=shortest=1[bgvid]; [bgvid]{{ $json.drawText }}[outv]; [1:a]volume=0.8[aout]\\\" -map \\\"[outv]\\\" -map \\\"[aout]\\\" -aspect 9:16 -c:v libx264 -c:a aac -shortest output.mp4 -y\"},\"typeVersion\":1},{\"id\":\"460d3ddc-b24b-4714-8e00-023294da8375\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1100,-120],\"parameters\":{\"color\":3,\"width\":700,\"height\":660,\"content\":\"## File Download & Video Processing\\nDownload the selected files, write them to disk, prepare overlay text (quote and author), and generate the final video clip using FFmpeg.\"},\"typeVersion\":1},{\"id\":\"b148528f-7d45-4a59-9b29-52c7229f05e8\",\"name\":\"Initiate YouTube Resumable Upload\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[1860,20],\"parameters\":{\"url\":\"=https://www.googleapis.com/upload/youtube/v3/videos?part=snippet,status&uploadType=resumable\",\"body\":\"={\\n  \\\"snippet\\\": {\\n    \\\"title\\\": \\\"{{ $('Save Music Background Locally').item.json.quote.Qoute }}\\\",\\n    \\\"description\\\": \\\"{{ $('Save Music Background Locally').item.json.quote.Qoute }}\\\\n{{ $('Save Music Background Locally').item.json.quote.Author }}\\\",\\n    \\\"defaultLanguage\\\": \\\"en\\\",\\n    \\\"defaultAudioLanguage\\\": \\\"en\\\"\\n  },\\n  \\\"status\\\": {\\n    \\\"privacyStatus\\\": \\\"public\\\",\\n    \\\"license\\\": \\\"youtube\\\",\\n    \\\"embeddable\\\": true,\\n    \\\"publicStatsViewable\\\": true,\\n    \\\"madeForKids\\\": false\\n  }\\n}\",\"method\":\"POST\",\"options\":{\"response\":{\"response\":{\"fullResponse\":true}}},\"sendBody\":true,\"contentType\":\"raw\",\"sendHeaders\":true,\"authentication\":\"predefinedCredentialType\",\"rawContentType\":\"RAW/JSON\",\"headerParameters\":{\"parameters\":[{\"name\":\"Content-Type\",\"value\":\"application/json\"},{\"name\":\"X-Upload-Content-Type\",\"value\":\"video/webm\"}]},\"nodeCredentialType\":\"youTubeOAuth2Api\"},\"credentials\":{\"youTubeOAuth2Api\":{\"id\":\"f9uNp5YNQMnXrNw2\",\"name\":\"YouTube account\"}},\"typeVersion\":4.2},{\"id\":\"e8a97b56-be01-497b-bc91-ec84bc59d039\",\"name\":\"Read output file\",\"type\":\"n8n-nodes-base.readWriteFile\",\"position\":[2060,20],\"parameters\":{\"options\":{},\"fileSelector\":\"=output.mp4\"},\"typeVersion\":1},{\"id\":\"7965943e-e5c9-4c97-afca-18b3fc5881cd\",\"name\":\"Upload Video to YouTube\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[2260,20],\"parameters\":{\"url\":\"={{ $('Initiate YouTube Resumable Upload').item.json.headers.location }}\",\"method\":\"PUT\",\"options\":{},\"sendBody\":true,\"contentType\":\"binaryData\",\"sendHeaders\":true,\"authentication\":\"predefinedCredentialType\",\"headerParameters\":{\"parameters\":[{\"name\":\"Content-Type\",\"value\":\"video/webm\"}]},\"inputDataFieldName\":\"data\",\"nodeCredentialType\":\"youTubeOAuth2Api\"},\"credentials\":{\"youTubeOAuth2Api\":{\"id\":\"f9uNp5YNQMnXrNw2\",\"name\":\"YouTube account\"}},\"typeVersion\":4.2},{\"id\":\"040f9064-9d7f-4106-9f1c-55222d6bf4d4\",\"name\":\"Update Quote Upload Status\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[1860,340],\"parameters\":{\"columns\":{\"value\":{\"Index\":\"={{ $('Save Music Background Locally').item.json.quote.Index }}\",\"YoutubeURL\":\"=https://www.youtube.com/watch?v={{ $json.id }}\",\"CreateStatus\":\"DONE\"},\"schema\":[{\"id\":\"Index\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"Index\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Qoute\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"Qoute\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Author\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"Author\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"CreateStatus\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"CreateStatus\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"YoutubeURL\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"YoutubeURL\",\"defaultMatch\":false,\"canBeUsedToMatch\":true}],\"mappingMode\":\"defineBelow\",\"matchingColumns\":[\"Index\"],\"attemptToConvertTypes\":false,\"convertFieldsToString\":false},\"options\":{},\"operation\":\"appendOrUpdate\",\"sheetName\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"gid=0\",\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/184-zcrfWSzQpDa-t57Oo_8DLyAF-2B_6yvGrybrcd5I/edit#gid=0\",\"cachedResultName\":\"Quotes_status\"},\"documentId\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"184-zcrfWSzQpDa-t57Oo_8DLyAF-2B_6yvGrybrcd5I\"}},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"Ra2f1dlqOJ13jTtb\",\"name\":\"Google Sheets account\"}},\"typeVersion\":4.5},{\"id\":\"526ffabc-3f12-4619-abe3-01d729f96db6\",\"name\":\"Mark Background as Used\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[2240,340],\"parameters\":{\"columns\":{\"value\":{\"BackgroundURL\":\"{{ $('Read/Write Files from Disk1').item.json.video.BackgroundURL }}\",\"BackgroudStatus\":\"DONE\"},\"schema\":[{\"id\":\"BackgroundURL\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"BackgroundURL\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"BackgroudStatus\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"BackgroudStatus\",\"defaultMatch\":false,\"canBeUsedToMatch\":true}],\"mappingMode\":\"defineBelow\",\"matchingColumns\":[\"BackgroundURL\"],\"attemptToConvertTypes\":false,\"convertFieldsToString\":false},\"options\":{},\"operation\":\"appendOrUpdate\",\"sheetName\":{\"__rl\":true,\"mode\":\"list\",\"value\":90817124,\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/184-zcrfWSzQpDa-t57Oo_8DLyAF-2B_6yvGrybrcd5I/edit#gid=90817124\",\"cachedResultName\":\"video_backgroud_list\"},\"documentId\":{\"__rl\":true,\"mode\":\"url\",\"value\":\"https://docs.google.com/spreadsheets/d/184-zcrfWSzQpDa-t57Oo_8DLyAF-2B_6yvGrybrcd5I/edit?gid=0#gid=0\"}},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"Ra2f1dlqOJ13jTtb\",\"name\":\"Google Sheets account\"}},\"typeVersion\":4.5},{\"id\":\"5c833f0d-5c4b-489a-a53b-234b38433a2a\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1820,-120],\"parameters\":{\"width\":620,\"height\":660,\"content\":\"## Video Upload & Post-Processing\\nUpload the final video to YouTube using the YouTube API and update your Google Sheets with upload statuses and YouTube links.\"},\"typeVersion\":1}],\"active\":false,\"pinData\":{},\"settings\":{\"executionOrder\":\"v1\"},\"versionId\":\"49ffd0ae-2689-483f-9821-b99b9083ac8b\",\"connections\":{\"Read output file\":{\"main\":[[{\"node\":\"Upload Video to YouTube\",\"type\":\"main\",\"index\":0}]]},\"Retrieve Quote Data\":{\"main\":[[{\"node\":\"Merge File Selection Data\",\"type\":\"main\",\"index\":0}]]},\"Start AutoClip Workflow\":{\"main\":[[{\"node\":\"Retrieve Quote Data\",\"type\":\"main\",\"index\":0},{\"node\":\"List Video Background Files\",\"type\":\"main\",\"index\":0},{\"node\":\"Configure Music Background Folder ID\",\"type\":\"main\",\"index\":0}]]},\"Upload Video to YouTube\":{\"main\":[[{\"node\":\"Update Quote Upload Status\",\"type\":\"main\",\"index\":0}]]},\"Generate Final Video Clip\":{\"main\":[[{\"node\":\"Initiate YouTube Resumable Upload\",\"type\":\"main\",\"index\":0}]]},\"Merge File Selection Data\":{\"main\":[[{\"node\":\"Select Random Video, Music & Quote\",\"type\":\"main\",\"index\":0}]]},\"Update Quote Upload Status\":{\"main\":[[{\"node\":\"Mark Background as Used\",\"type\":\"main\",\"index\":0}]]},\"List Music Background Files\":{\"main\":[[{\"node\":\"Retrieve Music Background Data\",\"type\":\"main\",\"index\":0}]]},\"List Video Background Files\":{\"main\":[[{\"node\":\"Retrieve Video Background Data\",\"type\":\"main\",\"index\":0}]]},\"Save Music Background Locally\":{\"main\":[[{\"node\":\"Prepare Overlay Text (Quote & Author)\",\"type\":\"main\",\"index\":0}]]},\"Save Video Background Locally\":{\"main\":[[{\"node\":\"Download Selected Music Background\",\"type\":\"main\",\"index\":0}]]},\"Retrieve Music Background Data\":{\"main\":[[{\"node\":\"Merge File Selection Data\",\"type\":\"main\",\"index\":2}]]},\"Retrieve Video Background Data\":{\"main\":[[{\"node\":\"Merge File Selection Data\",\"type\":\"main\",\"index\":1}]]},\"Initiate YouTube Resumable Upload\":{\"main\":[[{\"node\":\"Read output file\",\"type\":\"main\",\"index\":0}]]},\"Download Selected Music Background\":{\"main\":[[{\"node\":\"Save Music Background Locally\",\"type\":\"main\",\"index\":0}]]},\"Download Selected Video Background\":{\"main\":[[{\"node\":\"Save Video Background Locally\",\"type\":\"main\",\"index\":0}]]},\"Select Random Video, Music & Quote\":{\"main\":[[{\"node\":\"Download Selected Video Background\",\"type\":\"main\",\"index\":0}]]},\"Configure Music Background Folder ID\":{\"main\":[[{\"node\":\"List Music Background Files\",\"type\":\"main\",\"index\":0}]]},\"Prepare Overlay Text (Quote & Author)\":{\"main\":[[{\"node\":\"Generate Final Video Clip\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "## Who is this for?\n\nThis workflow is perfect for digital content creators, marketers, and social media managers who regularly create engaging short-form videos featuring inspirational or motivational quotes. While the workflow is universally applicable, it specifically highlights Thai as an example to demonstrate effective language and font integration.\n\n## What problem is this workflow solving?\n\nCreating consistent and engaging multilingual video content manually, including attractive fonts and proper video formatting, is time-consuming and repetitive. Additionally, managing files, background music, and updating statuses manually can be tedious and prone to errors.\n\n## What this workflow does\n\n  * Automatically fetches background video and music files stored on Google Drive.\n\n  * Randomly selects a quote (demonstrated with Thai language) and author information from Google Sheets.\n\n  * Dynamically combines the selected quote and author text using appealing fonts, such as the Thai font \"Kanit,\" directly onto the video using FFmpeg on your n8n local environment.\n\n  * Creates visually engaging videos with a 9:16 aspect ratio, optimized for YouTube Shorts and other vertical video platforms.\n\n  * Automatically uploads the finalized video to YouTube.\n\n  * Updates the status and YouTube URL back into your Google Sheet, ensuring you have up-to-date records.\n\n\n\n\n## Setup\n\n### Requirements:\n\nThis workflow requires a **self-hosted n8n instance** , as the execution of FFmpeg commands is not supported on n8n Cloud. Ensure FFmpeg is installed on your self-hosted environment.\n\n### Google Sheets Setup:\n\nYour Google Sheet must include at least these columns:\n\n  * Index: (Unique identifier for each quote)\n  * Quote: (Text of the quote)\n  * Author: (Author of the quote)\n  * CreateStatus: (Track video creation status; values like 'DONE' or blank for pending)\n  * YoutubeURL: (Automatically updated after upload)\n\n\n\nTo help you get started quickly, you can use [this template spreadsheet](https://docs.google.com/spreadsheets/d/184-zcrfWSzQpDa-t57Oo_8DLyAF-2B_6yvGrybrcd5I/edit?usp=sharing).\n\n### Next steps:\n\n  1. Organize your video and music files in separate folders in Google Drive.\n  2. Authenticate your Google Sheets, Google Drive, and YouTube accounts in n8n.\n  3. Ensure fonts compatible with your target languages (such as Kanit for Thai) are available in your FFmpeg installation.\n\n\n\n## How to customize this workflow to your needs\n\n  * **Fonts:** Adjust font styles and sizes within the workflow's code node. Ensure the fonts you choose fully support the language you wish to use.\n\n  * **Quote Management:** Easily add or remove quotes and authors in your Google Sheets document.\n\n  * **Media Files:** Change or update background videos and music by modifying the files in your Google Drive folders.\n\n  * **Video Specifications:** Customize video dimensions, text positioning, opacity, and music volume directly in the provided FFmpeg commands.\n\n\n\n\n## Benefits of Using Localized Fonts and Quotes\n\nUtilizing fonts specific to your target language, as demonstrated with Thai, significantly increases audience engagement by making your content more relatable, shareable, and visually appealing. Ensure you select fonts that properly support the language you're targeting.\n",
  "crawled_at": "2025-05-26T04:14:13.777629",
  "readme_zh": "## 适用对象\n\n本工作流专为定期制作励志名言短视频的数字内容创作者、营销人员和社交媒体经理量身打造。虽然方案具有普适性，但特别以泰语为例展示语言与字体的无缝融合效果。\n\n## 解决痛点\n\n手动制作风格统一的多语言视频内容（包括字体美化与格式调整）既耗时又重复。此外，人工管理素材文件、背景音乐及状态更新不仅繁琐且易出错。\n\n## 核心功能\n\n* 自动调用Google Drive存储的背景视频与音乐素材\n* 从Google Sheets随机选取名言文本（以泰语示例）及作者信息\n* 通过本地n8n环境的FFmpeg工具，使用\"Kanit\"等特色字体将文字动态合成到视频中\n* 生成9:16竖版视频，完美适配YouTube Shorts等垂直视频平台\n* 自动上传成品至YouTube平台\n* 将视频状态及YouTube链接回写至Google Sheets，实现数据闭环\n\n## 配置指南\n\n### 环境要求\n\n需**自托管n8n服务**（n8n云端版不支持FFmpeg命令执行），确保本地环境已安装FFmpeg\n\n### 表格配置\n\nGoogle Sheets需包含以下字段：\n* Index（名言唯一标识）\n* Quote（名言正文）\n* Author（作者署名）\n* CreateStatus（视频生成状态，如'DONE'或留空待处理）\n* YoutubeURL（自动更新视频链接）\n\n快速入门可参考[模板表格](https://docs.google.com/spreadsheets/d/184-zcrfWSzQpDa-t57Oo_8DLyAF-2B_6yvGrybrcd5I/edit?usp=sharing)\n\n### 实施步骤\n\n1. 在Google Drive分文件夹管理视频与音乐素材\n2. 在n8n中完成Google Sheets/Drive/YouTube账号授权\n3. 确保FFmpeg已安装目标语言字体（如泰文需\"Kanit\"字体）\n\n## 个性化定制\n\n* **字体样式**：通过代码节点调整字体参数，务必确认所选字体支持目标语言字符集\n* **内容管理**：直接在Google Sheets增删名言数据\n* **素材替换**：更新Google Drive文件夹中的视频/音乐文件即可\n* **视频参数**：按需修改FFmpeg命令中的画幅尺寸、文字位置、透明度和音量等参数\n\n## 本地化优势\n\n如示例所示，采用目标语言专用字体（如泰文\"Kanit\"）能显著提升内容亲和力，增强视觉吸引力和传播效果。请务必选择完全支持目标语言的字体方案。",
  "title_zh": "使用FFmpeg自动创建并上传带有泰语引言的YouTube视频",
  "publish_date_zh": "上次更新于一个月前",
  "workflow_json_zh": "{\n  \"id\": \"gI3QGKTf52zwyh6O\",\n  \"meta\": {\n    \"instanceId\": \"e2034325698638870d6b764285427bad9d79bf1e08a458be597c06e61ad7e545\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"name\": \"AutoClip – Automatically Generate Video Clips and Upload to YouTube\",\n  \"tags\": [],\n  \"nodes\": [\n    {\n      \"id\": \"99e8f5d2-247a-44c7-85db-4bdd63c2a4f6\",\n      \"name\": \"Start AutoClip Workflow\",\n      \"type\": \"n8n-nodes-base.manualTrigger\",\n      \"position\": [\n        40,\n        0\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"221b0fa1-7e71-43e1-88a6-7070c6c10ed8\",\n      \"name\": \"Retrieve Video Background Data\",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"position\": [\n        500,\n        180\n      ],\n      \"parameters\": {\n        \"columns\": {\n          \"value\": {\n            \"BackgroundURL\": \"={{ $json.webViewLink }}\"\n          },\n          \"schema\": [\n            {\n              \"id\": \"BackgroundURL\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"BackgroundURL\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"BackgroudStatus\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"BackgroudStatus\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            }\n          ],\n          \"mappingMode\": \"defineBelow\",\n          \"matchingColumns\": [],\n          \"attemptToConvertTypes\": false,\n          \"convertFieldsToString\": false\n        },\n        \"options\": {},\n        \"operation\": \"append\",\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": 90817124,\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/184-zcrfWSzQpDa-t57Oo_8DLyAF-2B_6yvGrybrcd5I/edit#gid=90817124\",\n          \"cachedResultName\": \"video_backgroud_list\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"184-zcrfWSzQpDa-t57Oo_8DLyAF-2B_6yvGrybrcd5I\"\n        }\n      },\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"Ra2f1dlqOJ13jTtb\",\n          \"name\": \"Google Sheets account\"\n        }\n      },\n      \"typeVersion\": 4.5\n    },\n    {\n      \"id\": \"120db4aa-5a1a-4685-9d1d-6d7814b20458\",\n      \"name\": \"Retrieve Quote Data\",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"position\": [\n        500,\n        0\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"filtersUI\": {\n          \"values\": [\n            {\n              \"lookupColumn\": \"CreateStatus\"\n            }\n          ]\n        },\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"gid=0\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/184-zcrfWSzQpDa-t57Oo_8DLyAF-2B_6yvGrybrcd5I/edit#gid=0\",\n          \"cachedResultName\": \"Quotes_status\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"184-zcrfWSzQpDa-t57Oo_8DLyAF-2B_6yvGrybrcd5I\"\n        }\n      },\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"Ra2f1dlqOJ13jTtb\",\n          \"name\": \"Google Sheets account\"\n        }\n      },\n      \"typeVersion\": 4.5\n    },\n    {\n      \"id\": \"17e6585a-0e48-40e7-86ec-4fb53f45bd07\",\n      \"name\": \"List Video Background Files\",\n      \"type\": \"n8n-nodes-base.googleDrive\",\n      \"position\": [\n        260,\n        180\n      ],\n      \"parameters\": {\n        \"filter\": {\n          \"folderId\": {\n            \"__rl\": true,\n            \"mode\": \"id\",\n            \"value\": \"1mLOqFJZvUm563mJ7LvTsIcKrAoakX-h2\"\n          }\n        },\n        \"options\": {\n          \"fields\": [\n            \"webViewLink\",\n            \"id\",\n            \"name\"\n          ]\n        },\n        \"resource\": \"fileFolder\"\n      },\n      \"credentials\": {\n        \"googleDriveOAuth2Api\": {\n          \"id\": \"nd1GyFEAYkpaT3xt\",\n          \"name\": \"Google Drive account\"\n        }\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"34d51d42-2562-4437-8cbc-e0158badb134\",\n      \"name\": \"Configure Music Background Folder ID\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        40,\n        360\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"19727718-f70d-4333-93dd-1ade2b1a66bf\",\n              \"name\": \"MusicBackgroundFolderID\",\n              \"type\": \"string\",\n              \"value\": \"12T6ABEuR7WlZ2i88GqcB3U4DmuKVM4iR\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"0d819b1f-923d-4500-858a-166d65864872\",\n      \"name\": \"List Music Background Files\",\n      \"type\": \"n8n-nodes-base.googleDrive\",\n      \"position\": [\n        260,\n        360\n      ],\n      \"parameters\": {\n        \"filter\": {\n          \"folderId\": {\n            \"__rl\": true,\n            \"mode\": \"id\",\n            \"value\": \"=12T6ABEuR7WlZ2i88GqcB3U4DmuKVM4iR\"\n          }\n        },\n        \"options\": {\n          \"fields\": [\n            \"webViewLink\",\n            \"name\",\n            \"id\"\n          ]\n        },\n        \"resource\": \"fileFolder\"\n      },\n      \"credentials\": {\n        \"googleDriveOAuth2Api\": {\n          \"id\": \"OEWvSsY5xiUhqOnx\",\n          \"name\": \"Google Drive account - PeakWave\"\n        }\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"3041385c-52d9-4d95-a454-de2064164717\",\n      \"name\": \"Retrieve Music Background Data\",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"position\": [\n        500,\n        360\n      ],\n      \"parameters\": {\n        \"columns\": {\n          \"value\": {\n            \"MusicURL\": \"={{ $json.webViewLink }}\"\n          },\n          \"schema\": [\n            {\n              \"id\": \"MusicURL\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"MusicURL\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"MusicStatus\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"MusicStatus\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            }\n          ],\n          \"mappingMode\": \"defineBelow\",\n          \"matchingColumns\": [],\n          \"attemptToConvertTypes\": false,\n          \"convertFieldsToString\": false\n        },\n        \"options\": {},\n        \"operation\": \"append\",\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": 1264732774,\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/184-zcrfWSzQpDa-t57Oo_8DLyAF-2B_6yvGrybrcd5I/edit#gid=1264732774\",\n          \"cachedResultName\": \"music_backgroud_list\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"184-zcrfWSzQpDa-t57Oo_8DLyAF-2B_6yvGrybrcd5I\"\n        }\n      },\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"Ra2f1dlqOJ13jTtb\",\n          \"name\": \"Google Sheets account\"\n        }\n      },\n      \"typeVersion\": 4.5\n    },\n    {\n      \"id\": \"ab86cac3-e44e-4e87-a467-a1c26e1f9752\",\n      \"name\": \"Merge File Selection Data\",\n      \"type\": \"n8n-nodes-base.merge\",\n      \"position\": [\n        740,\n        200\n      ],\n      \"parameters\": {\n        \"numberInputs\": 3\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"28c79ad7-cb34-424a-97ed-fcec5471e179\",\n      \"name\": \"Select Random Video, Music & Quote\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        940,\n        200\n      ],\n      \"parameters\": {\n        \"jsCode\": \"function getRandomItem(arr) {\\n  return arr[Math.floor(Math.random() * arr.length)];\\n}\\n\\n// Filter items based on unique keys from the merged inputs\\nconst videoItems = items.filter(item => item.json.BackgroundURL !== undefined);\\nconst musicItems = items.filter(item => item.json.MusicURL !== undefined);\\nconst quoteItems = items.filter(item => item.json.Qoute !== undefined);\\n\\n// Debug logs to check counts in the execution log\\nconsole.log(\\\"Video Items count: \\\" + videoItems.length);\\nconsole.log(\\\"Music Items count: \\\" + musicItems.length);\\nconsole.log(\\\"Quote Items count: \\\" + quoteItems.length);\\n\\nif (videoItems.length === 0 || musicItems.length === 0 || quoteItems.length === 0) {\\n  throw new Error(\\\"One or more input arrays are empty. Check your previous nodes.\\\");\\n}\\n\\nconst selectedVideo = getRandomItem(videoItems);\\nconst selectedMusic = getRandomItem(musicItems);\\nconst selectedQuote = getRandomItem(quoteItems);\\n\\n// Return the combined selected items\\nreturn [{\\n  video: selectedVideo.json,\\n  music: selectedMusic.json,\\n  quote: selectedQuote.json\\n}];\\n\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"bd3fa420-555d-46a2-b48c-15a916f62b44\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -20,\n        -120\n      ],\n      \"parameters\": {\n        \"width\": 1100,\n        \"height\": 660,\n        \"content\": \"## 数据准备与文件选择\\n从Google Sheets和Google Drive获取并整合名言、视频背景及音乐的源数据；随后随机选取一条名言、一个背景视频和一首音乐文件。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"7da639cb-6576-4ab5-891a-308ce35aecaf\",\n      \"name\": \"Download Selected Video Background\",\n      \"type\": \"n8n-nodes-base.googleDrive\",\n      \"position\": [\n        1180,\n        0\n      ],\n      \"parameters\": {\n        \"fileId\": {\n          \"__rl\": true,\n          \"mode\": \"url\",\n          \"value\": \"={{ $json.video.BackgroundURL }}\"\n        },\n        \"options\": {\n          \"binaryPropertyName\": \"data\"\n        },\n        \"operation\": \"download\"\n      },\n      \"credentials\": {\n        \"googleDriveOAuth2Api\": {\n          \"id\": \"OEWvSsY5xiUhqOnx\",\n          \"name\": \"Google Drive account - PeakWave\"\n        }\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"5ee8befc-979d-4a47-8eba-b31d6de8ea1f\",\n      \"name\": \"Download Selected Music Background\",\n      \"type\": \"n8n-nodes-base.googleDrive\",\n      \"position\": [\n        1180,\n        340\n      ],\n      \"parameters\": {\n        \"fileId\": {\n          \"__rl\": true,\n          \"mode\": \"url\",\n          \"value\": \"={{ $json.music.MusicURL }}\"\n        },\n        \"options\": {\n          \"binaryPropertyName\": \"data\"\n        },\n        \"operation\": \"download\"\n      },\n      \"credentials\": {\n        \"googleDriveOAuth2Api\": {\n          \"id\": \"OEWvSsY5xiUhqOnx\",\n          \"name\": \"Google Drive account - PeakWave\"\n        }\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"fd8fd1f8-64a6-4bf0-8586-8f5be506c8a1\",\n      \"name\": \"Save Video Background Locally\",\n      \"type\": \"n8n-nodes-base.readWriteFile\",\n      \"position\": [\n        1420,\n        0\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"fileName\": \"video1.mp4\",\n        \"operation\": \"write\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"9a8e1891-16c2-490c-ae91-4773f90e67d3\",\n      \"name\": \"Save Music Background Locally\",\n      \"type\": \"n8n-nodes-base.readWriteFile\",\n      \"position\": [\n        1420,\n        340\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"append\": false\n        },\n        \"fileName\": \"music1.mp3\",\n        \"operation\": \"write\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"9fdca64e-79d7-4a58-91dc-4aa9f9b3c4cc\",\n      \"name\": \"Prepare Overlay Text (Quote & Author)\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        1620,\n        20\n      ],\n      \"parameters\": {\n        \"jsCode\": \"// Define separate configuration for the quote and the author\\nconst quoteFont = \\\"Kanit-Italic.ttf\\\";      // Font for the quote\\nconst quoteFontSize = 70;\\nconst authorFont = \\\"Kanit-Italic.ttf\\\";         // Font for the author (ensure this supports Thai)\\nconst authorFontSize = 50;\\nconst fontColor = \\\"white\\\";\\nconst lineHeightMultiplier = 1.1;\\nconst videoWidth = 1080;\\nconst margin = 40;  // Gap from left and right edges\\n\\n// Effective width for the quote text (accounting for left/right margins)\\nconst effectiveVideoWidth = videoWidth - 2 * margin;\\n\\n// Estimate average character width based on quoteFontSize (this is a rough estimate)\\nconst avgCharWidth = quoteFontSize * 0.6;\\nconst maxCharsPerLine = Math.floor(effectiveVideoWidth / avgCharWidth);\\n\\n// Retrieve the quote transcript and author from the \\\"Merge\\\" node\\nconst transcript = $node[\\\"Merge File Selection Data\\\"].json[\\\"Qoute\\\"];\\nif (!transcript) {\\n  throw new Error(\\\"Quote not found\\\");\\n}\\nconst author = $node[\\\"Merge File Selection Data\\\"].json[\\\"Author\\\"];\\nif (!author) {\\n  throw new Error(\\\"Author not found\\\");\\n}\\n\\n// Split the transcript into words and group them into lines based on maxCharsPerLine\\nconst words = transcript.split(' ');\\nconst lines = [];\\nlet currentLine = \\\"\\\";\\nlet currentCharCount = 0;\\n\\nwords.forEach(word => {\\n  const wordLength = word.length;\\n  const additionalSpace = currentLine ? 1 : 0;\\n  const potentialLength = currentCharCount + additionalSpace + wordLength;\\n  if (potentialLength <= maxCharsPerLine) {\\n    currentLine += (currentLine ? \\\" \\\" : \\\"\\\") + word;\\n    currentCharCount = potentialLength;\\n  } else {\\n    lines.push(currentLine);\\n    currentLine = word;\\n    currentCharCount = wordLength;\\n  }\\n});\\nif (currentLine) {\\n  lines.push(currentLine);\\n}\\n\\n// Calculate layout for the quote block\\nconst lineHeight = quoteFontSize * lineHeightMultiplier;\\nconst totalHeight = lines.length * lineHeight;\\n\\n// Build drawtext commands for each quote line (centered horizontally)\\n// Each line is positioned so that the entire quote block is vertically centered.\\nconst quoteCommands = lines.map((line, index) => {\\n  // Escape any single quotes in the line\\n  const escapedLine = line.replace(/'/g, \\\"\\\\\\\\'\\\");\\n  return `drawtext=fontfile=${quoteFont}:text='${escapedLine}':fontsize=${quoteFontSize}:fontcolor=${fontColor}:x=(w-text_w)/2:y=((h-${totalHeight})/2)+(${index}*${lineHeight})`;\\n});\\n\\n// Build the drawtext command for the author\\n// Place the author text below the quote block with a small gap (e.g. 20 pixels)\\n// Align it to the right by setting x = w - text_w - margin.\\nconst authorY = `((h-${totalHeight})/2)+(${lines.length}*${lineHeight})+20`;\\nconst escapedAuthor = author.replace(/'/g, \\\"\\\\\\\\'\\\");\\nconst authorCommand = `drawtext=fontfile=${authorFont}:text='${escapedAuthor}':fontsize=${authorFontSize}:fontcolor=${fontColor}:x=w-text_w-${margin}:y=${authorY}`;\\n\\n// Combine all commands (separated by commas) into one drawtext filter string.\\nconst fullDrawTextFilter = quoteCommands.concat(authorCommand).join(\\\", \\\");\\n\\n// Return the prepared filter string for insertion into your FFmpeg command.\\nreturn {\\n  json: {\\n    drawText: fullDrawTextFilter\\n  }\\n};\\n\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"082cf794-89a9-42cc-b9ee-96792a17893f\",\n      \"name\": \"Generate Final Video Clip\",\n      \"type\": \"n8n-nodes-base.executeCommand\",\n      \"position\": [\n        1640,\n        340\n      ],\n      \"parameters\": {\n        \"command\": \"=ffmpeg -i {{ $('Save Video Background Locally').item.json.fileName }} -i {{ $('Save Music Background Locally').item.json.fileName }} -filter_complex \\\"[0:v]scale=1080:1920:force_original_aspect_ratio=increase,crop=1080:1920[vid]; color=black@0.3:size=1080x1920:d=10[bg]; [vid][bg]overlay=shortest=1[bgvid]; [bgvid]{{ $json.drawText }}[outv]; [1:a]volume=0.8[aout]\\\" -map \\\"[outv]\\\" -map \\\"[aout]\\\" -aspect 9:16 -c:v libx264 -c:a aac -shortest output.mp4 -y\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"460d3ddc-b24b-4714-8e00-023294da8375\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1100,\n        -120\n      ],\n      \"parameters\": {\n        \"color\": 3,\n        \"width\": 700,\n        \"height\": 660,\n        \"content\": \"## 文件下载与视频处理\\n下载选定文件并写入磁盘，准备叠加文本（引文及作者信息），最后使用FFmpeg生成最终视频片段。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"b148528f-7d45-4a59-9b29-52c7229f05e8\",\n      \"name\": \"Initiate YouTube Resumable Upload\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1860,\n        20\n      ],\n      \"parameters\": {\n        \"url\": \"=https://www.googleapis.com/upload/youtube/v3/videos?part=snippet,status&uploadType=resumable\",\n        \"body\": \"={\\n  \\\"snippet\\\": {\\n    \\\"title\\\": \\\"{{ $('Save Music Background Locally').item.json.quote.Qoute }}\\\",\\n    \\\"description\\\": \\\"{{ $('Save Music Background Locally').item.json.quote.Qoute }}\\\\n{{ $('Save Music Background Locally').item.json.quote.Author }}\\\",\\n    \\\"defaultLanguage\\\": \\\"en\\\",\\n    \\\"defaultAudioLanguage\\\": \\\"en\\\"\\n  },\\n  \\\"status\\\": {\\n    \\\"privacyStatus\\\": \\\"public\\\",\\n    \\\"license\\\": \\\"youtube\\\",\\n    \\\"embeddable\\\": true,\\n    \\\"publicStatsViewable\\\": true,\\n    \\\"madeForKids\\\": false\\n  }\\n}\",\n        \"method\": \"POST\",\n        \"options\": {\n          \"response\": {\n            \"response\": {\n              \"fullResponse\": true\n            }\n          }\n        },\n        \"sendBody\": true,\n        \"contentType\": \"raw\",\n        \"sendHeaders\": true,\n        \"authentication\": \"predefinedCredentialType\",\n        \"rawContentType\": \"RAW/JSON\",\n        \"headerParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"Content-Type\",\n              \"value\": \"application/json\"\n            },\n            {\n              \"name\": \"X-Upload-Content-Type\",\n              \"value\": \"video/webm\"\n            }\n          ]\n        },\n        \"nodeCredentialType\": \"youTubeOAuth2Api\"\n      },\n      \"credentials\": {\n        \"youTubeOAuth2Api\": {\n          \"id\": \"f9uNp5YNQMnXrNw2\",\n          \"name\": \"YouTube account\"\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"e8a97b56-be01-497b-bc91-ec84bc59d039\",\n      \"name\": \"Read output file\",\n      \"type\": \"n8n-nodes-base.readWriteFile\",\n      \"position\": [\n        2060,\n        20\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"fileSelector\": \"=output.mp4\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"7965943e-e5c9-4c97-afca-18b3fc5881cd\",\n      \"name\": \"Upload Video to YouTube\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        2260,\n        20\n      ],\n      \"parameters\": {\n        \"url\": \"={{ $('Initiate YouTube Resumable Upload').item.json.headers.location }}\",\n        \"method\": \"PUT\",\n        \"options\": {},\n        \"sendBody\": true,\n        \"contentType\": \"binaryData\",\n        \"sendHeaders\": true,\n        \"authentication\": \"predefinedCredentialType\",\n        \"headerParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"Content-Type\",\n              \"value\": \"video/webm\"\n            }\n          ]\n        },\n        \"inputDataFieldName\": \"data\",\n        \"nodeCredentialType\": \"youTubeOAuth2Api\"\n      },\n      \"credentials\": {\n        \"youTubeOAuth2Api\": {\n          \"id\": \"f9uNp5YNQMnXrNw2\",\n          \"name\": \"YouTube account\"\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"040f9064-9d7f-4106-9f1c-55222d6bf4d4\",\n      \"name\": \"Update Quote Upload Status\",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"position\": [\n        1860,\n        340\n      ],\n      \"parameters\": {\n        \"columns\": {\n          \"value\": {\n            \"Index\": \"={{ $('Save Music Background Locally').item.json.quote.Index }}\",\n            \"YoutubeURL\": \"=https://www.youtube.com/watch?v={{ $json.id }}\",\n            \"CreateStatus\": \"DONE\"\n          },\n          \"schema\": [\n            {\n              \"id\": \"Index\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"Index\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Qoute\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"Qoute\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Author\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"Author\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"CreateStatus\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"CreateStatus\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"YoutubeURL\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"YoutubeURL\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            }\n          ],\n          \"mappingMode\": \"defineBelow\",\n          \"matchingColumns\": [\n            \"Index\"\n          ],\n          \"attemptToConvertTypes\": false,\n          \"convertFieldsToString\": false\n        },\n        \"options\": {},\n        \"operation\": \"appendOrUpdate\",\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"gid=0\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/184-zcrfWSzQpDa-t57Oo_8DLyAF-2B_6yvGrybrcd5I/edit#gid=0\",\n          \"cachedResultName\": \"Quotes_status\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"184-zcrfWSzQpDa-t57Oo_8DLyAF-2B_6yvGrybrcd5I\"\n        }\n      },\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"Ra2f1dlqOJ13jTtb\",\n          \"name\": \"Google Sheets account\"\n        }\n      },\n      \"typeVersion\": 4.5\n    },\n    {\n      \"id\": \"526ffabc-3f12-4619-abe3-01d729f96db6\",\n      \"name\": \"Mark Background as Used\",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"position\": [\n        2240,\n        340\n      ],\n      \"parameters\": {\n        \"columns\": {\n          \"value\": {\n            \"BackgroundURL\": \"{{ $('Read/Write Files from Disk1').item.json.video.BackgroundURL }}\",\n            \"BackgroudStatus\": \"DONE\"\n          },\n          \"schema\": [\n            {\n              \"id\": \"BackgroundURL\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"BackgroundURL\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"BackgroudStatus\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"BackgroudStatus\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            }\n          ],\n          \"mappingMode\": \"defineBelow\",\n          \"matchingColumns\": [\n            \"BackgroundURL\"\n          ],\n          \"attemptToConvertTypes\": false,\n          \"convertFieldsToString\": false\n        },\n        \"options\": {},\n        \"operation\": \"appendOrUpdate\",\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": 90817124,\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/184-zcrfWSzQpDa-t57Oo_8DLyAF-2B_6yvGrybrcd5I/edit#gid=90817124\",\n          \"cachedResultName\": \"video_backgroud_list\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"url\",\n          \"value\": \"https://docs.google.com/spreadsheets/d/184-zcrfWSzQpDa-t57Oo_8DLyAF-2B_6yvGrybrcd5I/edit?gid=0#gid=0\"\n        }\n      },\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"Ra2f1dlqOJ13jTtb\",\n          \"name\": \"Google Sheets account\"\n        }\n      },\n      \"typeVersion\": 4.5\n    },\n    {\n      \"id\": \"5c833f0d-5c4b-489a-a53b-234b38433a2a\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1820,\n        -120\n      ],\n      \"parameters\": {\n        \"width\": 620,\n        \"height\": 660,\n        \"content\": \"## 视频上传与后处理\\n使用YouTube API将最终视频上传至YouTube，并在Google表格中更新上传状态及YouTube链接。\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"active\": false,\n  \"pinData\": {},\n  \"settings\": {\n    \"executionOrder\": \"v1\"\n  },\n  \"versionId\": \"49ffd0ae-2689-483f-9821-b99b9083ac8b\",\n  \"connections\": {\n    \"Read output file\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Upload Video to YouTube\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Retrieve Quote Data\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge File Selection Data\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Start AutoClip Workflow\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Retrieve Quote Data\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"List Video Background Files\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Configure Music Background Folder ID\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Upload Video to YouTube\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Update Quote Upload Status\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Generate Final Video Clip\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Initiate YouTube Resumable Upload\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Merge File Selection Data\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Select Random Video, Music & Quote\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Update Quote Upload Status\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Mark Background as Used\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"List Music Background Files\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Retrieve Music Background Data\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"List Video Background Files\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Retrieve Video Background Data\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Save Music Background Locally\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Prepare Overlay Text (Quote & Author)\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Save Video Background Locally\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Download Selected Music Background\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Retrieve Music Background Data\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge File Selection Data\",\n            \"type\": \"main\",\n            \"index\": 2\n          }\n        ]\n      ]\n    },\n    \"Retrieve Video Background Data\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge File Selection Data\",\n            \"type\": \"main\",\n            \"index\": 1\n          }\n        ]\n      ]\n    },\n    \"Initiate YouTube Resumable Upload\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Read output file\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Download Selected Music Background\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Save Music Background Locally\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Download Selected Video Background\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Save Video Background Locally\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Select Random Video, Music & Quote\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Download Selected Video Background\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Configure Music Background Folder ID\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"List Music Background Files\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Prepare Overlay Text (Quote & Author)\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Generate Final Video Clip\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}