{
  "url": "https://n8n.io/workflows/2977-line-chatbot-handling-ai-responses-with-groq-and-llama3/",
  "title": "Line Chatbot Handling AI Responses with Groq and Llama3",
  "author": "Sirisak Chantanate",
  "publish_date": "Last update 3 months ago",
  "publish_date_absolute": "2025-02-26",
  "categories": [
    {
      "name": "Other"
    },
    {
      "name": "AI"
    }
  ],
  "workflow_json": "{\"id\":\"xibc6WDU53isYN1o\",\"meta\":{\"instanceId\":\"b3225e6e1bdf5f128a5dd199e31e87e9e2b7cb5f141a1bbe60059a1964dd7091\",\"templateCredsSetupCompleted\":true},\"name\":\"Line Chatbot Handling AI Responses with Groq and Llama3\",\"tags\":[],\"nodes\":[{\"id\":\"9b936123-7f31-4ddc-b1ca-fd172da9c5a8\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[0,-200],\"parameters\":{\"width\":440,\"content\":\"## Line AI Chatbot with Groq \\nThis workflow automates the process of handling messages from Line Messaging API by sending message to Groq as your AI assistant and reply back to you. In this workflow, you can see that there is no JSON error when sending long and complex message.\"},\"typeVersion\":1},{\"id\":\"0d75416e-58f0-4411-8904-7051f0d1c06a\",\"name\":\"Line: Messaging API\",\"type\":\"n8n-nodes-base.webhook\",\"position\":[0,0],\"webhookId\":\"befed026-573c-4d3a-9113-046ea8ae5930\",\"parameters\":{\"path\":\"befed026-573c-4d3a-9113-046ea8ae5930\",\"options\":{},\"httpMethod\":\"POST\"},\"typeVersion\":2},{\"id\":\"e363c981-acdf-4048-a531-31808cd3edc5\",\"name\":\"Get Messages\",\"type\":\"n8n-nodes-base.set\",\"position\":[300,0],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"654c2465-5531-46fb-9b11-74cc23c899a9\",\"name\":\"body.events[0].message.text\",\"type\":\"string\",\"value\":\"={{ $json.body.events[0].message.text }}\"},{\"id\":\"be878a5c-f3e2-40c4-b8f2-6c6708b3b2ad\",\"name\":\"body.events[0].message.id\",\"type\":\"string\",\"value\":\"={{ $json.body.events[0].message.id }}\"},{\"id\":\"de79a8fe-d9fb-4bf4-a2a7-df3969b194a4\",\"name\":\"body.events[0].source.userId\",\"type\":\"string\",\"value\":\"={{ $json.body.events[0].source.userId }}\"}]}},\"typeVersion\":3.4},{\"id\":\"6e0b17ab-9f38-4a73-b650-b35bd51657e4\",\"name\":\"Groq AI Assistant\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[580,0],\"parameters\":{\"url\":\"https://api.groq.com/openai/v1/chat/completions\",\"method\":\"POST\",\"options\":{},\"jsonBody\":\"={\\n  \\\"messages\\\": [\\n    {\\n      \\\"role\\\": \\\"user\\\",\\n      \\\"content\\\": \\\"{{ $json.body.events[0].message.text }}\\\"\\n    }\\n  ],\\n  \\\"model\\\": \\\"llama-3.3-70b-versatile\\\",\\n  \\\"temperature\\\": 1,\\n  \\\"max_completion_tokens\\\": 2500,\\n  \\\"top_p\\\": 1,\\n  \\\"stream\\\": null,\\n  \\\"stop\\\": null\\n} \",\"sendBody\":true,\"specifyBody\":\"json\",\"authentication\":\"genericCredentialType\",\"genericAuthType\":\"httpHeaderAuth\"},\"credentials\":{\"httpHeaderAuth\":{\"id\":\"iqHHZfH8mAbuFprI\",\"name\":\"Groq Authorization\"}},\"typeVersion\":4.2},{\"id\":\"25e929d1-3a38-45e1-a089-1cab0919f49d\",\"name\":\"Line: Reply Message\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[860,0],\"parameters\":{\"url\":\"https://api.line.me/v2/bot/message/reply\",\"method\":\"POST\",\"options\":{},\"jsonBody\":\"={\\n  \\\"replyToken\\\":\\\"{{ $('Line: Messaging API').item.json.body.events[0].replyToken }}\\\",\\n  \\\"messages\\\":[\\n    {\\n      \\\"type\\\":\\\"text\\\",\\n      \\\"text\\\": {{ JSON.stringify($('Groq AI Assistant).item.json.choices[0].message.content) }}\\n    }\\n  ]\\n}\",\"sendBody\":true,\"specifyBody\":\"json\",\"authentication\":\"genericCredentialType\",\"genericAuthType\":\"httpHeaderAuth\"},\"credentials\":{\"httpHeaderAuth\":{\"id\":\"hX58q9WFQLFROFui\",\"name\":\"Header Auth account\"}},\"typeVersion\":4.2},{\"id\":\"efcd27d2-a347-4ec4-8190-ccbef6616dd5\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-80,160],\"parameters\":{\"width\":260,\"content\":\"## LINE Messaging API \\nGet the access token from Line Business https://manager.line.biz/\"},\"typeVersion\":1},{\"id\":\"0c720dac-7c64-4635-9ef0-b92a4886db14\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[220,160],\"parameters\":{\"content\":\"## Get Message\\nGet message from Line account.\"},\"typeVersion\":1},{\"id\":\"b7afaacd-7d23-44e0-a601-81f7907b7af2\",\"name\":\"Sticky Note3\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[500,160],\"parameters\":{\"content\":\"## Groq API Key\\nApply Groq account and get API key then you should set ```max_completion_tokens``` less than 5000 because of Line message limitation\"},\"typeVersion\":1},{\"id\":\"e10ae59d-374a-4926-8f38-6baa79f4782b\",\"name\":\"Sticky Note4\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[780,160],\"parameters\":{\"content\":\"## Reply message\\nUse replyToken from Line messaging API and use ```choices[].message.content``` to reply to you.\"},\"typeVersion\":1}],\"active\":true,\"pinData\":{},\"settings\":{\"executionOrder\":\"v1\"},\"versionId\":\"dcdc5794-7034-4215-a719-b73513f0f0ee\",\"connections\":{\"Get Messages\":{\"main\":[[{\"node\":\"Groq AI Assistant\",\"type\":\"main\",\"index\":0}]]},\"Groq AI Assistant\":{\"main\":[[{\"node\":\"Line: Reply Message\",\"type\":\"main\",\"index\":0}]]},\"Line: Messaging API\":{\"main\":[[{\"node\":\"Get Messages\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "## Workflow overview:\n\nThis workflow is designed for dynamic and intelligent conversational capabilities. It incorporates Meta's llama3.3-versatile model for personal assistant. There are no issues when sending simple text to the LINE reply API, so in this workflow you can see how to handle large and complex text sending from AI chat without any errors.\n\n## Workflow description:\n\n  1. User uses Line Messaging API to send message to the chatbot, create line business ID from here: [Line Business](https://manager.line.biz/)\n  2. Set the message from Step 1 to the proper value\n  3. Send the message to process at Groq using API key that we have created from [Groq](groq.com)\n  4. Send the reply message from AI Agent back to Line Messaging API account\n\n\n\n## Key Features:\n\n  * Utilizes Meta's llama 3.3 model for robust conversational capabilities\n  * Handles large and complex text interactions with ease, ensuring reliable connections to LINE Messaging API\n  * Demonstrates effective strategies for processing and responding to large and complex text inputs from AI chat\n\n\n\nTo use this template, you need to be on n8n version 1.79.0 or later.\n",
  "crawled_at": "2025-05-26T02:33:16.493285",
  "readme_zh": "## 工作流概览：\n\n本工作流旨在实现动态智能的对话交互能力，集成了Meta公司的llama3.3多用途模型作为个人助手核心。由于向LINE回复接口发送简单文本时不存在技术障碍，本方案重点演示如何无差错处理AI聊天生成的大体量复杂文本的传输。\n\n## 工作流说明：\n\n1. 用户通过LINE Messaging API向聊天机器人发送消息（需先在[LINE商务管理平台](https://manager.line.biz/)创建企业账号）\n2. 将步骤1获取的消息内容进行规范化处理\n3. 通过[Groq平台](groq.com)获取的API密钥，将消息发送至Groq进行智能处理\n4. 将AI代理生成的回复消息回传至LINE Messaging API账号\n\n## 核心特性：\n\n• 采用Meta最新llama3.3模型，提供强大的多轮对话能力  \n• 可稳定处理大体量复杂文本交互，确保与LINE Messaging API的可靠对接  \n• 完整呈现AI聊天场景下复杂文本输入的处理与响应策略  \n\n使用本模板需确保n8n平台版本不低于1.79.0",
  "title_zh": "使用Groq和Llama3处理AI回复的Line聊天机器人",
  "publish_date_zh": "最后更新于2个月前",
  "workflow_json_zh": "{\n  \"id\": \"xibc6WDU53isYN1o\",\n  \"meta\": {\n    \"instanceId\": \"b3225e6e1bdf5f128a5dd199e31e87e9e2b7cb5f141a1bbe60059a1964dd7091\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"name\": \"Line Chatbot Handling AI Responses with Groq and Llama3\",\n  \"tags\": [],\n  \"nodes\": [\n    {\n      \"id\": \"9b936123-7f31-4ddc-b1ca-fd172da9c5a8\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        0,\n        -200\n      ],\n      \"parameters\": {\n        \"width\": 440,\n        \"content\": \"## 基于Groq的Line AI聊天机器人  \\n该工作流通过将Line Messaging API接收的消息自动转发至Groq人工智能助手，并将回复返回给用户，实现了消息处理的自动化。在此工作流中，您将观察到即使发送冗长复杂的消息也不会出现JSON格式错误。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"0d75416e-58f0-4411-8904-7051f0d1c06a\",\n      \"name\": \"Line: Messaging API\",\n      \"type\": \"n8n-nodes-base.webhook\",\n      \"position\": [\n        0,\n        0\n      ],\n      \"webhookId\": \"befed026-573c-4d3a-9113-046ea8ae5930\",\n      \"parameters\": {\n        \"path\": \"befed026-573c-4d3a-9113-046ea8ae5930\",\n        \"options\": {},\n        \"httpMethod\": \"POST\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"e363c981-acdf-4048-a531-31808cd3edc5\",\n      \"name\": \"Get Messages\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        300,\n        0\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"654c2465-5531-46fb-9b11-74cc23c899a9\",\n              \"name\": \"body.events[0].message.text\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.events[0].message.text }}\"\n            },\n            {\n              \"id\": \"be878a5c-f3e2-40c4-b8f2-6c6708b3b2ad\",\n              \"name\": \"body.events[0].message.id\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.events[0].message.id }}\"\n            },\n            {\n              \"id\": \"de79a8fe-d9fb-4bf4-a2a7-df3969b194a4\",\n              \"name\": \"body.events[0].source.userId\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.events[0].source.userId }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"6e0b17ab-9f38-4a73-b650-b35bd51657e4\",\n      \"name\": \"Groq AI Assistant\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        580,\n        0\n      ],\n      \"parameters\": {\n        \"url\": \"https://api.groq.com/openai/v1/chat/completions\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"jsonBody\": \"={\\n  \\\"messages\\\": [\\n    {\\n      \\\"role\\\": \\\"user\\\",\\n      \\\"content\\\": \\\"{{ $json.body.events[0].message.text }}\\\"\\n    }\\n  ],\\n  \\\"model\\\": \\\"llama-3.3-70b-versatile\\\",\\n  \\\"temperature\\\": 1,\\n  \\\"max_completion_tokens\\\": 2500,\\n  \\\"top_p\\\": 1,\\n  \\\"stream\\\": null,\\n  \\\"stop\\\": null\\n} \",\n        \"sendBody\": true,\n        \"specifyBody\": \"json\",\n        \"authentication\": \"genericCredentialType\",\n        \"genericAuthType\": \"httpHeaderAuth\"\n      },\n      \"credentials\": {\n        \"httpHeaderAuth\": {\n          \"id\": \"iqHHZfH8mAbuFprI\",\n          \"name\": \"Groq Authorization\"\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"25e929d1-3a38-45e1-a089-1cab0919f49d\",\n      \"name\": \"Line: Reply Message\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        860,\n        0\n      ],\n      \"parameters\": {\n        \"url\": \"https://api.line.me/v2/bot/message/reply\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"jsonBody\": \"={\\n  \\\"replyToken\\\":\\\"{{ $('Line: Messaging API').item.json.body.events[0].replyToken }}\\\",\\n  \\\"messages\\\":[\\n    {\\n      \\\"type\\\":\\\"text\\\",\\n      \\\"text\\\": {{ JSON.stringify($('Groq AI Assistant).item.json.choices[0].message.content) }}\\n    }\\n  ]\\n}\",\n        \"sendBody\": true,\n        \"specifyBody\": \"json\",\n        \"authentication\": \"genericCredentialType\",\n        \"genericAuthType\": \"httpHeaderAuth\"\n      },\n      \"credentials\": {\n        \"httpHeaderAuth\": {\n          \"id\": \"hX58q9WFQLFROFui\",\n          \"name\": \"Header Auth account\"\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"efcd27d2-a347-4ec4-8190-ccbef6616dd5\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -80,\n        160\n      ],\n      \"parameters\": {\n        \"width\": 260,\n        \"content\": \"## LINE 消息API  \\n从Line商务管理平台 https://manager.line.biz/ 获取访问令牌\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"0c720dac-7c64-4635-9ef0-b92a4886db14\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        220,\n        160\n      ],\n      \"parameters\": {\n        \"content\": \"## 获取消息\\n从Line账户获取消息。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"b7afaacd-7d23-44e0-a601-81f7907b7af2\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        500,\n        160\n      ],\n      \"parameters\": {\n        \"content\": \"## Groq API密钥\\n申请Groq账户并获取API密钥后，您需要将```max_completion_tokens```设置为小于5000，以符合Line消息的长度限制。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"e10ae59d-374a-4926-8f38-6baa79f4782b\",\n      \"name\": \"Sticky Note4\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        780,\n        160\n      ],\n      \"parameters\": {\n        \"content\": \"## 回复消息\\n使用Line消息API中的replyToken，并通过```choices[].message.content```的内容来回复您。\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"active\": true,\n  \"pinData\": {},\n  \"settings\": {\n    \"executionOrder\": \"v1\"\n  },\n  \"versionId\": \"dcdc5794-7034-4215-a719-b73513f0f0ee\",\n  \"connections\": {\n    \"Get Messages\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Groq AI Assistant\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Groq AI Assistant\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Line: Reply Message\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Line: Messaging API\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get Messages\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}