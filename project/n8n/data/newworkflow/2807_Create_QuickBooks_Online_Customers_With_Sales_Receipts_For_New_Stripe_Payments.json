{
  "url": "https://n8n.io/workflows/2807-create-quickbooks-online-customers-with-sales-receipts-for-new-stripe-payments/",
  "title": "Create QuickBooks Online Customers With Sales Receipts For New Stripe Payments",
  "author": "Artur",
  "publish_date": "Last update 4 months ago",
  "publish_date_absolute": "2025-01-26",
  "categories": [
    {
      "name": "Finance"
    }
  ],
  "workflow_json": "{\"meta\":{\"instanceId\":\"6f3fb2495ae05d668c93cbf9e1649128d6e08178f8a900941cf97e588f18fdfc\",\"templateCredsSetupCompleted\":true},\"nodes\":[{\"id\":\"7fe02521-c46a-4314-9387-b7b4983fa859\",\"name\":\"POST Sales Receipt\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[1320,-120],\"parameters\":{\"url\":\"https://sandbox-quickbooks.api.intuit.com/v3/company/9341453851324714/salesreceipt?minorversion=73\",\"method\":\"POST\",\"options\":{},\"jsonBody\":\"={\\n  \\\"Line\\\": [\\n    {\\n      \\\"Description\\\": \\\"{{ $json.data.object.description }}\\\",\\n      \\\"DetailType\\\": \\\"SalesItemLineDetail\\\",\\n      \\\"SalesItemLineDetail\\\": {\\n        \\\"TaxCodeRef\\\": {\\n          \\\"value\\\": \\\"NON\\\"\\n        },\\n        \\\"Qty\\\": 1,\\n        \\\"UnitPrice\\\": {{ $json.data.object.amount_received / 100 }},\\n        \\\"ItemRef\\\": {\\n          \\\"name\\\": \\\"Subscription\\\", \\n          \\\"value\\\": \\\"10\\\"\\n        }\\n      },\\n      \\\"Amount\\\": {{ $json.data.object.amount / 100 }},\\n      \\\"LineNum\\\": 1\\n    }\\n  ],\\n  \\\"CustomerRef\\\": {\\n    \\\"value\\\": {{ $input.all()[2].json.QueryResponse.Customer[0].BillAddr.Id }},\\n    \\\"name\\\": \\\"{{ $input.all()[2].json.QueryResponse.Customer[0].DisplayName }}\\\"\\n  },\\n  \\\"CurrencyRef\\\": {\\n    \\\"value\\\": \\\"{{ $json.data.object.currency.toUpperCase() }}\\\"\\n  },\\n  \\\"PrivateNote\\\": \\\"Payment from Stripe Payment Intent ID: {{ $json.data.object.id }}\\\"\\n}\",\"sendBody\":true,\"specifyBody\":\"json\",\"authentication\":\"predefinedCredentialType\",\"nodeCredentialType\":\"quickBooksOAuth2Api\"},\"credentials\":{\"quickBooksOAuth2Api\":{\"id\":\"IUNAfwwSgnbwWygB\",\"name\":\"QuickBooks Online account\"}},\"executeOnce\":true,\"typeVersion\":4.2},{\"id\":\"5ed429d7-c93d-48c8-b603-ca8d7efb57ed\",\"name\":\"GET Quickbooks Customer\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[400,-20],\"parameters\":{\"url\":\"=https://sandbox-quickbooks.api.intuit.com/v3/company/9341453851324714/query?query=select * from Customer Where PrimaryEmailAddr = '{{ $json.email }}'&minorversion=73\\n\\n\",\"options\":{},\"authentication\":\"predefinedCredentialType\",\"nodeCredentialType\":\"quickBooksOAuth2Api\"},\"credentials\":{\"httpCustomAuth\":{\"id\":\"hqXGCVkt6W41KDDK\",\"name\":\"Custom Auth account\"},\"quickBooksOAuth2Api\":{\"id\":\"IUNAfwwSgnbwWygB\",\"name\":\"QuickBooks Online account\"}},\"typeVersion\":4.2},{\"id\":\"bef5b4c3-4948-4294-bd80-7039342edf0d\",\"name\":\"Get Stripe Customer\",\"type\":\"n8n-nodes-base.stripe\",\"position\":[240,-140],\"parameters\":{\"resource\":\"customer\",\"customerId\":\"={{ $json.data.object.customer }}\"},\"credentials\":{\"stripeApi\":{\"id\":\"o6KHVZiU8S7O38wq\",\"name\":\"Stripe account\"}},\"typeVersion\":1},{\"id\":\"042fff2c-b5e7-4877-b935-f6a707118c4a\",\"name\":\"New Payment\",\"type\":\"n8n-nodes-base.stripeTrigger\",\"position\":[80,-260],\"webhookId\":\"5cc15770-f762-4389-8372-1b2926de4570\",\"parameters\":{\"events\":[\"payment_intent.succeeded\"]},\"credentials\":{\"stripeApi\":{\"id\":\"o6KHVZiU8S7O38wq\",\"name\":\"Stripe account\"}},\"typeVersion\":1},{\"id\":\"12235c25-712b-4e84-b744-60573e00d381\",\"name\":\"If Customer Exists\",\"type\":\"n8n-nodes-base.if\",\"position\":[560,100],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"aef7393c-c4ff-4196-887d-6a9b057381f8\",\"operator\":{\"type\":\"string\",\"operation\":\"exists\",\"singleValue\":true},\"leftValue\":\"={{ $json.QueryResponse.Customer[0].PrimaryEmailAddr.Address }}\",\"rightValue\":\"\"}]}},\"typeVersion\":2.2},{\"id\":\"68f63246-cb95-494f-918c-c0c6da5a64f9\",\"name\":\"Use Stripe Customer\",\"type\":\"n8n-nodes-base.merge\",\"position\":[880,120],\"parameters\":{},\"executeOnce\":true,\"typeVersion\":3},{\"id\":\"e9eea332-7109-479f-8f50-65b3b9438e0e\",\"name\":\"Create QuickBooks Customer\",\"type\":\"n8n-nodes-base.quickbooks\",\"position\":[1100,120],\"parameters\":{\"operation\":\"create\",\"displayName\":\"={{ $input.all()[0].json.name }}\",\"additionalFields\":{\"Balance\":\"={{ $input.all()[0].json.balance }}\",\"PrimaryEmailAddr\":\"={{ $input.all()[0].json.email }}\"}},\"credentials\":{\"quickBooksOAuth2Api\":{\"id\":\"IUNAfwwSgnbwWygB\",\"name\":\"QuickBooks Online account\"}},\"executeOnce\":true,\"typeVersion\":1},{\"id\":\"f805f03d-93b7-4e3b-8b6a-37d9dd802368\",\"name\":\"Merge Stripe and QuickBooks Data\",\"type\":\"n8n-nodes-base.merge\",\"position\":[1100,-120],\"parameters\":{\"numberInputs\":3},\"typeVersion\":3},{\"id\":\"b9c31838-2bb7-4882-bd15-c096cb97e225\",\"name\":\"Merge Payment and QuickBooks Customer\",\"type\":\"n8n-nodes-base.merge\",\"position\":[1320,120],\"parameters\":{},\"executeOnce\":true,\"typeVersion\":3},{\"id\":\"cb69fcee-8d5d-47ab-be76-9e25cb0a7f42\",\"name\":\"POST Sales Receipt To QuickBooks\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[1540,120],\"parameters\":{\"url\":\"https://sandbox-quickbooks.api.intuit.com/v3/company/9341453851324714/salesreceipt?minorversion=73\",\"method\":\"POST\",\"options\":{},\"jsonBody\":\"={\\n  \\\"Line\\\": [\\n    {\\n      \\\"Description\\\": \\\"{{ $json.data.object.description }}\\\",\\n      \\\"DetailType\\\": \\\"SalesItemLineDetail\\\",\\n      \\\"SalesItemLineDetail\\\": {\\n        \\\"TaxCodeRef\\\": {\\n          \\\"value\\\": \\\"NON\\\"\\n        },\\n        \\\"Qty\\\": 1,\\n        \\\"UnitPrice\\\": {{ $json.data.object.amount_received / 100 }},\\n        \\\"ItemRef\\\": {\\n          \\\"name\\\": \\\"Subscription\\\", \\n          \\\"value\\\": \\\"10\\\"\\n        }\\n      },\\n      \\\"Amount\\\": {{ $json.data.object.amount / 100 }},\\n      \\\"LineNum\\\": 1\\n    }\\n  ],\\n  \\\"CustomerRef\\\": {\\n    \\\"value\\\": {{ $input.all()[1].json.Id}},\\n    \\\"name\\\": \\\"{{ $input.all()[1].json.DisplayName }}\\\"\\n  },\\n  \\\"CurrencyRef\\\": {\\n    \\\"value\\\": \\\"{{ $json.data.object.currency.toUpperCase() }}\\\"\\n  },\\n  \\\"PrivateNote\\\": \\\"Payment from Stripe Payment Intent ID: {{ $json.data.object.id }}\\\"\\n}\",\"sendBody\":true,\"specifyBody\":\"json\",\"authentication\":\"predefinedCredentialType\",\"nodeCredentialType\":\"quickBooksOAuth2Api\"},\"credentials\":{\"quickBooksOAuth2Api\":{\"id\":\"IUNAfwwSgnbwWygB\",\"name\":\"QuickBooks Online account\"}},\"executeOnce\":true,\"typeVersion\":4.2}],\"pinData\":{\"New Payment\":[{\"id\":\"evt_3Qjf7fJJNVDH5POn01Am9Q1x\",\"data\":{\"object\":{\"id\":\"pi_3Qjf54D14htxZ8341jkWWJJs\",\"amount\":9500,\"object\":\"payment_intent\",\"review\":null,\"source\":null,\"status\":\"succeeded\",\"created\":1737456794,\"invoice\":\"in_1Qje8QD14htxZ834S3Gh3Nn6\",\"currency\":\"usd\",\"customer\":\"cus_R4OkhTTT1ebzPl\",\"livemode\":false,\"metadata\":{},\"shipping\":null,\"processing\":null,\"application\":null,\"canceled_at\":null,\"description\":\"Subscription update\",\"next_action\":null,\"on_behalf_of\":null,\"client_secret\":\"pi_3Qjf54D14htxZ8341jkWWJJs_secret_FXltcZHFUDM8I4F0AQjRPE9Vz\",\"latest_charge\":\"ch_3Qjf54D14htxZ8341xwQhggm\",\"receipt_email\":null,\"transfer_data\":null,\"amount_details\":{\"tip\":{}},\"capture_method\":\"automatic\",\"payment_method\":\"pm_1Qh6nED14htxZ834bTgSzUQy\",\"transfer_group\":null,\"amount_received\":9500,\"amount_capturable\":0,\"last_payment_error\":null,\"setup_future_usage\":null,\"cancellation_reason\":null,\"confirmation_method\":\"automatic\",\"payment_method_types\":[\"amazon_pay\",\"card\",\"cashapp\",\"link\"],\"statement_descriptor\":null,\"application_fee_amount\":null,\"payment_method_options\":{\"card\":{\"network\":null,\"installments\":null,\"mandate_options\":null,\"request_three_d_secure\":\"automatic\"},\"link\":{\"persistent_token\":null},\"cashapp\":{},\"amazon_pay\":{\"express_checkout_element_session_id\":null}},\"automatic_payment_methods\":null,\"statement_descriptor_suffix\":null,\"payment_method_configuration_details\":null}},\"type\":\"payment_intent.succeeded\",\"object\":\"event\",\"created\":1737456956,\"request\":{\"id\":\"req_vbXfG1vUORKZJ6\",\"idempotency_key\":\"e63d5e07-f753-429c-bd06-c642e23d9ff8\"},\"livemode\":false,\"api_version\":\"2020-08-27\",\"pending_webhooks\":3}],\"Get Stripe Customer\":[{\"id\":\"cus_R4OkhTTT1ebzPl\",\"name\":\"Test Usershvili\",\"email\":\"Birds@Intuit.com\",\"phone\":null,\"object\":\"customer\",\"address\":{\"city\":null,\"line1\":null,\"line2\":null,\"state\":null,\"country\":\"GE\",\"postal_code\":null},\"balance\":0,\"created\":1729495354,\"currency\":\"usd\",\"discount\":null,\"livemode\":false,\"metadata\":{},\"shipping\":null,\"delinquent\":false,\"tax_exempt\":\"none\",\"test_clock\":null,\"description\":null,\"default_source\":null,\"invoice_prefix\":\"F73B0901\",\"default_currency\":\"usd\",\"invoice_settings\":{\"footer\":null,\"custom_fields\":null,\"rendering_options\":null,\"default_payment_method\":null},\"preferred_locales\":[\"en-GB\"]}]},\"connections\":{\"New Payment\":{\"main\":[[{\"node\":\"Get Stripe Customer\",\"type\":\"main\",\"index\":0},{\"node\":\"Merge Stripe and QuickBooks Data\",\"type\":\"main\",\"index\":0},{\"node\":\"Merge Payment and QuickBooks Customer\",\"type\":\"main\",\"index\":0}]]},\"If Customer Exists\":{\"main\":[[{\"node\":\"Merge Stripe and QuickBooks Data\",\"type\":\"main\",\"index\":2}],[{\"node\":\"Use Stripe Customer\",\"type\":\"main\",\"index\":0}]]},\"POST Sales Receipt\":{\"main\":[[]]},\"Get Stripe Customer\":{\"main\":[[{\"node\":\"GET Quickbooks Customer\",\"type\":\"main\",\"index\":0},{\"node\":\"Use Stripe Customer\",\"type\":\"main\",\"index\":1}]]},\"Use Stripe Customer\":{\"main\":[[{\"node\":\"Create QuickBooks Customer\",\"type\":\"main\",\"index\":0}]]},\"GET Quickbooks Customer\":{\"main\":[[{\"node\":\"If Customer Exists\",\"type\":\"main\",\"index\":0},{\"node\":\"Merge Stripe and QuickBooks Data\",\"type\":\"main\",\"index\":1}]]},\"Create QuickBooks Customer\":{\"main\":[[{\"node\":\"Merge Payment and QuickBooks Customer\",\"type\":\"main\",\"index\":1}]]},\"Merge Stripe and QuickBooks Data\":{\"main\":[[{\"node\":\"POST Sales Receipt\",\"type\":\"main\",\"index\":0}]]},\"Merge Payment and QuickBooks Customer\":{\"main\":[[{\"node\":\"POST Sales Receipt To QuickBooks\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "Streamline your accounting by automatically creating QuickBooks Online customers and sales receipts whenever a successful Stripe payment is processed. Ideal for businesses looking to reduce manual data entry and improve accounting efficiency.\n\n## How it works\n\n  1. **Trigger** : The workflow is triggered when a new successful payment intent event is received from Stripe.\n  2. **Retrieve Customer Data** : Fetches customer details from Stripe associated with the payment.\n  3. **Check QuickBooks Customer** : Searches QuickBooks Online to see if the customer already exists using their email address.\n  4. **Create or Use Existing Customer** : If the customer doesn't exist in QuickBooks, they are created; otherwise, the existing customer is used.\n  5. **Generate Sales Receipt** : A sales receipt is created in QuickBooks Online with payment details, including item descriptions, amounts, and currency.\n\n\n\n## Set up steps\n\n  1. **Connect Accounts** : Authenticate both your QuickBooks Online and Stripe accounts in n8n.\n  2. **Webhook Setup** : Configure the Stripe webhook to send `payment_intent.succeeded` events to this workflow.\n  3. **Test the Workflow** : Trigger a test payment in Stripe to validate the integration.\n  4. **Customize Details** : Adjust item descriptions or other fields in the QuickBooks sales receipt JSON body as needed.\n\n\n\nThis workflow requires basic familiarity with n8n, but setup can be completed in under 15 minutes for most users.\n",
  "crawled_at": "2025-05-26T02:03:49.867213",
  "readme_zh": "每当成功处理一笔Stripe支付时，自动创建QuickBooks Online客户和销售收据，从而简化您的会计流程。特别适合希望减少手动数据输入并提高会计效率的企业。\n\n## 工作原理\n\n  1. **触发条件**：当从Stripe接收到新的成功支付意图事件时，工作流即被触发。\n  2. **获取客户数据**：从Stripe提取与该笔支付相关的客户详细信息。\n  3. **检查QuickBooks客户**：使用客户的电子邮件地址在QuickBooks Online中搜索，确认该客户是否已存在。\n  4. **创建或使用现有客户**：如果客户在QuickBooks中不存在，则创建新客户；否则，使用现有客户记录。\n  5. **生成销售收据**：在QuickBooks Online中创建包含支付详情的销售收据，包括项目描述、金额和货币。\n\n## 设置步骤\n\n  1. **连接账户**：在n8n中验证您的QuickBooks Online和Stripe账户。\n  2. **设置Webhook**：配置Stripe webhook，将`payment_intent.succeeded`事件发送到此工作流。\n  3. **测试工作流**：在Stripe中触发一笔测试支付，以验证集成是否成功。\n  4. **自定义详情**：根据需要调整QuickBooks销售收据JSON正文中的项目描述或其他字段。\n\n此工作流需要对n8n有基本了解，但大多数用户可在15分钟内完成设置。",
  "title_zh": "通过销售收据为新Stripe支付创建QuickBooks在线客户",
  "publish_date_zh": "最后更新于4个月前",
  "workflow_json_zh": "{\n  \"meta\": {\n    \"instanceId\": \"6f3fb2495ae05d668c93cbf9e1649128d6e08178f8a900941cf97e588f18fdfc\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"nodes\": [\n    {\n      \"id\": \"7fe02521-c46a-4314-9387-b7b4983fa859\",\n      \"name\": \"POST Sales Receipt\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1320,\n        -120\n      ],\n      \"parameters\": {\n        \"url\": \"https://sandbox-quickbooks.api.intuit.com/v3/company/9341453851324714/salesreceipt?minorversion=73\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"jsonBody\": \"={\\n  \\\"Line\\\": [\\n    {\\n      \\\"Description\\\": \\\"{{ $json.data.object.description }}\\\",\\n      \\\"DetailType\\\": \\\"SalesItemLineDetail\\\",\\n      \\\"SalesItemLineDetail\\\": {\\n        \\\"TaxCodeRef\\\": {\\n          \\\"value\\\": \\\"NON\\\"\\n        },\\n        \\\"Qty\\\": 1,\\n        \\\"UnitPrice\\\": {{ $json.data.object.amount_received / 100 }},\\n        \\\"ItemRef\\\": {\\n          \\\"name\\\": \\\"Subscription\\\", \\n          \\\"value\\\": \\\"10\\\"\\n        }\\n      },\\n      \\\"Amount\\\": {{ $json.data.object.amount / 100 }},\\n      \\\"LineNum\\\": 1\\n    }\\n  ],\\n  \\\"CustomerRef\\\": {\\n    \\\"value\\\": {{ $input.all()[2].json.QueryResponse.Customer[0].BillAddr.Id }},\\n    \\\"name\\\": \\\"{{ $input.all()[2].json.QueryResponse.Customer[0].DisplayName }}\\\"\\n  },\\n  \\\"CurrencyRef\\\": {\\n    \\\"value\\\": \\\"{{ $json.data.object.currency.toUpperCase() }}\\\"\\n  },\\n  \\\"PrivateNote\\\": \\\"Payment from Stripe Payment Intent ID: {{ $json.data.object.id }}\\\"\\n}\",\n        \"sendBody\": true,\n        \"specifyBody\": \"json\",\n        \"authentication\": \"predefinedCredentialType\",\n        \"nodeCredentialType\": \"quickBooksOAuth2Api\"\n      },\n      \"credentials\": {\n        \"quickBooksOAuth2Api\": {\n          \"id\": \"IUNAfwwSgnbwWygB\",\n          \"name\": \"QuickBooks Online account\"\n        }\n      },\n      \"executeOnce\": true,\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"5ed429d7-c93d-48c8-b603-ca8d7efb57ed\",\n      \"name\": \"GET Quickbooks Customer\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        400,\n        -20\n      ],\n      \"parameters\": {\n        \"url\": \"=https://sandbox-quickbooks.api.intuit.com/v3/company/9341453851324714/query?query=select * from Customer Where PrimaryEmailAddr = '{{ $json.email }}'&minorversion=73\\n\\n\",\n        \"options\": {},\n        \"authentication\": \"predefinedCredentialType\",\n        \"nodeCredentialType\": \"quickBooksOAuth2Api\"\n      },\n      \"credentials\": {\n        \"httpCustomAuth\": {\n          \"id\": \"hqXGCVkt6W41KDDK\",\n          \"name\": \"Custom Auth account\"\n        },\n        \"quickBooksOAuth2Api\": {\n          \"id\": \"IUNAfwwSgnbwWygB\",\n          \"name\": \"QuickBooks Online account\"\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"bef5b4c3-4948-4294-bd80-7039342edf0d\",\n      \"name\": \"Get Stripe Customer\",\n      \"type\": \"n8n-nodes-base.stripe\",\n      \"position\": [\n        240,\n        -140\n      ],\n      \"parameters\": {\n        \"resource\": \"customer\",\n        \"customerId\": \"={{ $json.data.object.customer }}\"\n      },\n      \"credentials\": {\n        \"stripeApi\": {\n          \"id\": \"o6KHVZiU8S7O38wq\",\n          \"name\": \"Stripe account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"042fff2c-b5e7-4877-b935-f6a707118c4a\",\n      \"name\": \"New Payment\",\n      \"type\": \"n8n-nodes-base.stripeTrigger\",\n      \"position\": [\n        80,\n        -260\n      ],\n      \"webhookId\": \"5cc15770-f762-4389-8372-1b2926de4570\",\n      \"parameters\": {\n        \"events\": [\n          \"payment_intent.succeeded\"\n        ]\n      },\n      \"credentials\": {\n        \"stripeApi\": {\n          \"id\": \"o6KHVZiU8S7O38wq\",\n          \"name\": \"Stripe account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"12235c25-712b-4e84-b744-60573e00d381\",\n      \"name\": \"If Customer Exists\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        560,\n        100\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"aef7393c-c4ff-4196-887d-6a9b057381f8\",\n              \"operator\": {\n                \"type\": \"string\",\n                \"operation\": \"exists\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json.QueryResponse.Customer[0].PrimaryEmailAddr.Address }}\",\n              \"rightValue\": \"\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"68f63246-cb95-494f-918c-c0c6da5a64f9\",\n      \"name\": \"Use Stripe Customer\",\n      \"type\": \"n8n-nodes-base.merge\",\n      \"position\": [\n        880,\n        120\n      ],\n      \"parameters\": {},\n      \"executeOnce\": true,\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"e9eea332-7109-479f-8f50-65b3b9438e0e\",\n      \"name\": \"Create QuickBooks Customer\",\n      \"type\": \"n8n-nodes-base.quickbooks\",\n      \"position\": [\n        1100,\n        120\n      ],\n      \"parameters\": {\n        \"operation\": \"create\",\n        \"displayName\": \"={{ $input.all()[0].json.name }}\",\n        \"additionalFields\": {\n          \"Balance\": \"={{ $input.all()[0].json.balance }}\",\n          \"PrimaryEmailAddr\": \"={{ $input.all()[0].json.email }}\"\n        }\n      },\n      \"credentials\": {\n        \"quickBooksOAuth2Api\": {\n          \"id\": \"IUNAfwwSgnbwWygB\",\n          \"name\": \"QuickBooks Online account\"\n        }\n      },\n      \"executeOnce\": true,\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"f805f03d-93b7-4e3b-8b6a-37d9dd802368\",\n      \"name\": \"Merge Stripe and QuickBooks Data\",\n      \"type\": \"n8n-nodes-base.merge\",\n      \"position\": [\n        1100,\n        -120\n      ],\n      \"parameters\": {\n        \"numberInputs\": 3\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"b9c31838-2bb7-4882-bd15-c096cb97e225\",\n      \"name\": \"Merge Payment and QuickBooks Customer\",\n      \"type\": \"n8n-nodes-base.merge\",\n      \"position\": [\n        1320,\n        120\n      ],\n      \"parameters\": {},\n      \"executeOnce\": true,\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"cb69fcee-8d5d-47ab-be76-9e25cb0a7f42\",\n      \"name\": \"POST Sales Receipt To QuickBooks\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1540,\n        120\n      ],\n      \"parameters\": {\n        \"url\": \"https://sandbox-quickbooks.api.intuit.com/v3/company/9341453851324714/salesreceipt?minorversion=73\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"jsonBody\": \"={\\n  \\\"Line\\\": [\\n    {\\n      \\\"Description\\\": \\\"{{ $json.data.object.description }}\\\",\\n      \\\"DetailType\\\": \\\"SalesItemLineDetail\\\",\\n      \\\"SalesItemLineDetail\\\": {\\n        \\\"TaxCodeRef\\\": {\\n          \\\"value\\\": \\\"NON\\\"\\n        },\\n        \\\"Qty\\\": 1,\\n        \\\"UnitPrice\\\": {{ $json.data.object.amount_received / 100 }},\\n        \\\"ItemRef\\\": {\\n          \\\"name\\\": \\\"Subscription\\\", \\n          \\\"value\\\": \\\"10\\\"\\n        }\\n      },\\n      \\\"Amount\\\": {{ $json.data.object.amount / 100 }},\\n      \\\"LineNum\\\": 1\\n    }\\n  ],\\n  \\\"CustomerRef\\\": {\\n    \\\"value\\\": {{ $input.all()[1].json.Id}},\\n    \\\"name\\\": \\\"{{ $input.all()[1].json.DisplayName }}\\\"\\n  },\\n  \\\"CurrencyRef\\\": {\\n    \\\"value\\\": \\\"{{ $json.data.object.currency.toUpperCase() }}\\\"\\n  },\\n  \\\"PrivateNote\\\": \\\"Payment from Stripe Payment Intent ID: {{ $json.data.object.id }}\\\"\\n}\",\n        \"sendBody\": true,\n        \"specifyBody\": \"json\",\n        \"authentication\": \"predefinedCredentialType\",\n        \"nodeCredentialType\": \"quickBooksOAuth2Api\"\n      },\n      \"credentials\": {\n        \"quickBooksOAuth2Api\": {\n          \"id\": \"IUNAfwwSgnbwWygB\",\n          \"name\": \"QuickBooks Online account\"\n        }\n      },\n      \"executeOnce\": true,\n      \"typeVersion\": 4.2\n    }\n  ],\n  \"pinData\": {\n    \"New Payment\": [\n      {\n        \"id\": \"evt_3Qjf7fJJNVDH5POn01Am9Q1x\",\n        \"data\": {\n          \"object\": {\n            \"id\": \"pi_3Qjf54D14htxZ8341jkWWJJs\",\n            \"amount\": 9500,\n            \"object\": \"payment_intent\",\n            \"review\": null,\n            \"source\": null,\n            \"status\": \"succeeded\",\n            \"created\": 1737456794,\n            \"invoice\": \"in_1Qje8QD14htxZ834S3Gh3Nn6\",\n            \"currency\": \"usd\",\n            \"customer\": \"cus_R4OkhTTT1ebzPl\",\n            \"livemode\": false,\n            \"metadata\": {},\n            \"shipping\": null,\n            \"processing\": null,\n            \"application\": null,\n            \"canceled_at\": null,\n            \"description\": \"Subscription update\",\n            \"next_action\": null,\n            \"on_behalf_of\": null,\n            \"client_secret\": \"pi_3Qjf54D14htxZ8341jkWWJJs_secret_FXltcZHFUDM8I4F0AQjRPE9Vz\",\n            \"latest_charge\": \"ch_3Qjf54D14htxZ8341xwQhggm\",\n            \"receipt_email\": null,\n            \"transfer_data\": null,\n            \"amount_details\": {\n              \"tip\": {}\n            },\n            \"capture_method\": \"automatic\",\n            \"payment_method\": \"pm_1Qh6nED14htxZ834bTgSzUQy\",\n            \"transfer_group\": null,\n            \"amount_received\": 9500,\n            \"amount_capturable\": 0,\n            \"last_payment_error\": null,\n            \"setup_future_usage\": null,\n            \"cancellation_reason\": null,\n            \"confirmation_method\": \"automatic\",\n            \"payment_method_types\": [\n              \"amazon_pay\",\n              \"card\",\n              \"cashapp\",\n              \"link\"\n            ],\n            \"statement_descriptor\": null,\n            \"application_fee_amount\": null,\n            \"payment_method_options\": {\n              \"card\": {\n                \"network\": null,\n                \"installments\": null,\n                \"mandate_options\": null,\n                \"request_three_d_secure\": \"automatic\"\n              },\n              \"link\": {\n                \"persistent_token\": null\n              },\n              \"cashapp\": {},\n              \"amazon_pay\": {\n                \"express_checkout_element_session_id\": null\n              }\n            },\n            \"automatic_payment_methods\": null,\n            \"statement_descriptor_suffix\": null,\n            \"payment_method_configuration_details\": null\n          }\n        },\n        \"type\": \"payment_intent.succeeded\",\n        \"object\": \"event\",\n        \"created\": 1737456956,\n        \"request\": {\n          \"id\": \"req_vbXfG1vUORKZJ6\",\n          \"idempotency_key\": \"e63d5e07-f753-429c-bd06-c642e23d9ff8\"\n        },\n        \"livemode\": false,\n        \"api_version\": \"2020-08-27\",\n        \"pending_webhooks\": 3\n      }\n    ],\n    \"Get Stripe Customer\": [\n      {\n        \"id\": \"cus_R4OkhTTT1ebzPl\",\n        \"name\": \"Test Usershvili\",\n        \"email\": \"Birds@Intuit.com\",\n        \"phone\": null,\n        \"object\": \"customer\",\n        \"address\": {\n          \"city\": null,\n          \"line1\": null,\n          \"line2\": null,\n          \"state\": null,\n          \"country\": \"GE\",\n          \"postal_code\": null\n        },\n        \"balance\": 0,\n        \"created\": 1729495354,\n        \"currency\": \"usd\",\n        \"discount\": null,\n        \"livemode\": false,\n        \"metadata\": {},\n        \"shipping\": null,\n        \"delinquent\": false,\n        \"tax_exempt\": \"none\",\n        \"test_clock\": null,\n        \"description\": null,\n        \"default_source\": null,\n        \"invoice_prefix\": \"F73B0901\",\n        \"default_currency\": \"usd\",\n        \"invoice_settings\": {\n          \"footer\": null,\n          \"custom_fields\": null,\n          \"rendering_options\": null,\n          \"default_payment_method\": null\n        },\n        \"preferred_locales\": [\n          \"en-GB\"\n        ]\n      }\n    ]\n  },\n  \"connections\": {\n    \"New Payment\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get Stripe Customer\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Merge Stripe and QuickBooks Data\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Merge Payment and QuickBooks Customer\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"If Customer Exists\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge Stripe and QuickBooks Data\",\n            \"type\": \"main\",\n            \"index\": 2\n          }\n        ],\n        [\n          {\n            \"node\": \"Use Stripe Customer\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"POST Sales Receipt\": {\n      \"main\": [\n        []\n      ]\n    },\n    \"Get Stripe Customer\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"GET Quickbooks Customer\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Use Stripe Customer\",\n            \"type\": \"main\",\n            \"index\": 1\n          }\n        ]\n      ]\n    },\n    \"Use Stripe Customer\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Create QuickBooks Customer\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"GET Quickbooks Customer\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"If Customer Exists\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Merge Stripe and QuickBooks Data\",\n            \"type\": \"main\",\n            \"index\": 1\n          }\n        ]\n      ]\n    },\n    \"Create QuickBooks Customer\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge Payment and QuickBooks Customer\",\n            \"type\": \"main\",\n            \"index\": 1\n          }\n        ]\n      ]\n    },\n    \"Merge Stripe and QuickBooks Data\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"POST Sales Receipt\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Merge Payment and QuickBooks Customer\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"POST Sales Receipt To QuickBooks\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}