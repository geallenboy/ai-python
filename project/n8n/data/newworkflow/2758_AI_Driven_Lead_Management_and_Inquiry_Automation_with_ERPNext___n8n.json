{
  "url": "https://n8n.io/workflows/2758-ai-driven-lead-management-and-inquiry-automation-with-erpnext-and-n8n/",
  "title": "AI-Driven Lead Management and Inquiry Automation with ERPNext & n8n",
  "author": "Amjid Ali",
  "publish_date": "Last update 2 months ago",
  "publish_date_absolute": "2025-03-26",
  "categories": [
    {
      "name": "Finance"
    },
    {
      "name": "AI"
    }
  ],
  "workflow_json": "{\"meta\":{\"instanceId\":\"e4f78845dfed9ddcfba1945ae00d12e9a7d76eab052afd19299228ce02349d86\"},\"nodes\":[{\"id\":\"23291d25-3e1a-4b0d-9b1d-d066e8c04a1f\",\"name\":\"Customer Lead AI Agent\",\"type\":\"@n8n/n8n-nodes-langchain.agent\",\"position\":[-640,460],\"parameters\":{\"text\":\"=**System Prompt:**\\n\\nYou are an AI assistant designed to process new leads and generate appropriate responses. Your role includes analyzing lead notes, categorizing them, and generating an email from the system to inform the relevant contact about the inquiry. Do not send the email as if it is directly from the customer; instead, draft it as a notification from the system summarizing the inquiry.\\n\\n### **Process Flow**\\n\\n1. **Analyzing Lead Notes:**\\n   - Extract key details such as the customer name, organization, contact information, and their specific request.  \\n   - Determine if the inquiry relates to products, services, or solutions offered by the company.\\n\\n2. **Finding the Appropriate Contact(s):**\\n   - Search the contact database to find the responsible person(s) for the relevant product, service, or solution.  \\n   - If one person is responsible, provide their email.  \\n   - If multiple people are responsible, list all emails separated by commas.\\n\\n3. **Generating an Email Notification:**\\n   - Draft a professional email as a notification from the system.\\n   - Summarize the customer’s inquiry.\\n   - Include all relevant details to assist the recipient in addressing the inquiry.\\n\\n4. **Handling Invalid Leads:**\\n   - If the inquiry is unrelated to products, services, or solutions (e.g., job inquiries or general product inquiries), classify it as invalid and return:  \\n     `\\\"Invalid Lead - Not related to products, services, or solutions.\\\"`\\n\\n### **Output Requirements**\\n\\n1. **For Relevant Leads:**\\n   - **Email Address(es):** Provide the appropriate email(s).  \\n   - **Email Message Body:** Generate an email notification from the system summarizing the inquiry.\\n\\n2. **For Invalid Leads:**\\n   - Return: `\\\"Invalid Lead - Not related to products, services, or solutions.\\\"`\\n\\n\\n### **Email Template for Relevant Leads**\\n\\n**Email Address(es):** [Relevant Email IDs]\\n\\n**Email Message Body:**\\n\\n_Subject: New Inquiry from Customer Regarding [Product/Service/Solution]_  \\n\\nDear [Recipient(s)],  \\n\\nWe have received a new inquiry from a customer through our system. Below are the details:  \\n\\n**Customer Name:** [Customer Name]  \\n**Organization:** [Organization Name]  \\n**Contact Information:** [Contact Details]  \\n\\n**Inquiry Summary:**  \\n[Summarized description of the customer's request, e.g., “The customer is seeking to upgrade their restroom facilities with touchless soap dispensers and tissue holders installed behind mirrors. They have requested a site visit to assess the location and provide a proposal.”]  \\n\\n**Action Required:**  \\nPlease prioritize this inquiry and reach out to the customer promptly to address their requirements.  \\n\\nThank you,  \\n[Your System Name]  \\n\\n\\n### **Example Output**\\n\\n**Input Lead Notes:**\\n*\\\"Dear Syncbricks, We are looking to Develop Workflow Automation Soluition for our company, can you let us know the details what do you offer in tems of this.\\\"*\\n\\n**Output:**\\n\\n- **Email Address(es):** employee@syncbricks.com\\n\\n- **Email Message Body:**  \\n\\n_Subject: Workflow Automation Platform Integration_  \\n\\nDear -Emploiyee Name (s) --,  \\n\\nWe have received a new inquiry from a customer through our system. Below are the details:  \\n\\n**Customer Name:** Amjid Ali \\n**Organization:** Syncbricks LLC\\n**Contact Information:** 123456789 \\n\\n**Inquiry Summary:**  \\nThe customer is asking for workflow automation for their company \\n\\n**Action Required:**  \\nPlease prioritize this inquiry and reach out to the customer promptly to address their requirements.  \\n\\nThank you,  \\nSyncbricks LLC\\n\\n---\\nHere are the Lead Details\\nLead Name : {{ $json.data.lead_name }}\\nCompany : {{ $json.data.company_name }}\\nSource : {{ $json.data.source }}\\nNotes : {{ $json.data.notes }}\\nCity : {{ $json.data.city }}\\nCountry : {{ $json.data.country }}\\nMobile : {{ $json.data.mobile_no }}\",\"options\":{},\"promptType\":\"define\"},\"typeVersion\":1.7},{\"id\":\"1831dc36-910b-4a72-a90e-b411f105a8c3\",\"name\":\"OpenAI Chat Model\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\"position\":[-800,800],\"parameters\":{\"options\":{}},\"credentials\":{\"openAiApi\":{\"id\":\"hTl3a2XqteCwExYY\",\"name\":\"OpenAi account\"}},\"typeVersion\":1},{\"id\":\"79713c56-2f7c-4872-90e4-331715f54048\",\"name\":\"Abbriviations\",\"type\":\"n8n-nodes-base.googleSheetsTool\",\"position\":[-640,800],\"parameters\":{\"options\":{},\"sheetName\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"gid=0\",\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1gtdrAe-jjQH9gQdXA9PJ5y3dSAN4i6k_Rs5sDyALIfU/edit#gid=0\",\"cachedResultName\":\"abbrivaitions\"},\"documentId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"1gtdrAe-jjQH9gQdXA9PJ5y3dSAN4i6k_Rs5sDyALIfU\",\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1gtdrAe-jjQH9gQdXA9PJ5y3dSAN4i6k_Rs5sDyALIfU/edit?usp=drivesdk\",\"cachedResultName\":\"Abbriviations List\"}},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"L3lApjbQfMm36LLX\",\"name\":\"Google Sheets account\"}},\"typeVersion\":4.5},{\"id\":\"73b1e3c9-4703-4f87-8399-e7a9bf368d4c\",\"name\":\"Lead Body\",\"type\":\"n8n-nodes-base.set\",\"position\":[-1640,640],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"82a674a2-4d12-45f2-b276-cc95cf7b2e93\",\"name\":\"body\",\"type\":\"object\",\"value\":\"={{ $json.body }}\"}]}},\"typeVersion\":3.4},{\"id\":\"5f25d846-c639-49e5-bea2-160000bfb104\",\"name\":\"Source Website and Status Open\",\"type\":\"n8n-nodes-base.if\",\"position\":[-1920,640],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"2b184de2-a64e-44e3-8f25-645539681533\",\"operator\":{\"name\":\"filter.operator.equals\",\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $json.body.source }}\",\"rightValue\":\"Website\"},{\"id\":\"9632cf65-11a1-483c-95c8-94bfe84fb243\",\"operator\":{\"name\":\"filter.operator.equals\",\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $json.body.status }}\",\"rightValue\":\"Open\"}]}},\"typeVersion\":2.2},{\"id\":\"12ba65c9-0890-4862-9704-98492eb8f637\",\"name\":\"Microsoft Outlook\",\"type\":\"n8n-nodes-base.microsoftOutlook\",\"position\":[1180,580],\"parameters\":{\"subject\":\"={{ $('Fields for Outlook').item.json.subject }}\",\"bodyContent\":\"={{ $json.html }}\\n<a href=\\\"https://erpnext.syncbricks.com/app/lead/{{ $('Webhook').item.json.body.name }}\\\" target=\\\"_blank\\\" rel=\\\"noopener noreferrer\\\">Here is Lead {{ $('Source Website and Status Open').item.json.body.name }} </a>\\n\",\"toRecipients\":\"= {{ $('Fields for Outlook').item.json.email_addresses }}\",\"additionalFields\":{\"bodyContentType\":\"html\"}},\"credentials\":{\"microsoftOutlookOAuth2Api\":{\"id\":\"9gy3uvf3pmBdpEsq\",\"name\":\"Microsoft Outlook Al Ansari\"}},\"typeVersion\":2},{\"id\":\"b1410997-3705-4234-918e-a14e4ccc6b70\",\"name\":\"Email Body Text Generated by AI\",\"type\":\"n8n-nodes-base.set\",\"position\":[700,580],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"cdce31fb-2ec9-45ce-a4ac-a6ff9c811dc3\",\"name\":\"email_body\",\"type\":\"string\",\"value\":\"={{ $json.email_body }}\"}]}},\"typeVersion\":3.4},{\"id\":\"b10684b9-9f72-42b3-a9f9-c54e711ceb59\",\"name\":\"Fields for Outlook\",\"type\":\"n8n-nodes-base.code\",\"position\":[360,600],\"parameters\":{\"jsCode\":\"// Input text from the `output` field\\nconst textOutput = $json?.output || '';\\n\\n// Function to extract values from the text\\nfunction extractFields(text) {\\n    const fields = {};\\n\\n    // Regular expressions to extract each field\\n    const emailMatch = text.match(/\\\\*\\\\*Email Address\\\\(es\\\\):\\\\*\\\\*\\\\s*([^\\\\n]+)/);\\n    const subjectMatch = text.match(/_Subject:\\\\s*([^_]+)/);\\n    const emailBodyMatch = text.match(/Dear[\\\\s\\\\S]+/);\\n\\n    // Assign extracted values to the fields\\n    fields.email_addresses = emailMatch ? emailMatch[1].trim() : null;\\n    fields.subject = subjectMatch ? subjectMatch[1].trim() : null;\\n    fields.email_body = emailBodyMatch ? emailBodyMatch[0].trim() : null;\\n\\n    return fields;\\n}\\n\\n// Extract fields from the output\\nconst extractedFields = extractFields(textOutput);\\n\\n// Return the fields as JSON\\nreturn {\\n    json: extractedFields\\n};\\n\"},\"typeVersion\":2},{\"id\":\"e2c10569-fde2-425c-8b20-fdb32a6e2bd5\",\"name\":\"Email Body for Outlook\",\"type\":\"n8n-nodes-base.code\",\"position\":[860,580],\"parameters\":{\"jsCode\":\"// Input email body\\nconst emailBody = $json.email_body || '';\\n\\n// Function to convert plain text email body into HTML\\nfunction formatEmailBodyAsHtml(body) {\\n    // Replace markdown-like sections with corresponding HTML\\n    let htmlBody = body\\n        .replace(/\\\\*\\\\*Customer Name:\\\\*\\\\* (.+)/, '<p><strong>Customer Name:</strong> $1</p>')\\n        .replace(/\\\\*\\\\*Organization:\\\\*\\\\* (.+)/, '<p><strong>Organization:</strong> $1</p>')\\n        .replace(/\\\\*\\\\*Contact Information:\\\\*\\\\* (.+)/, '<p><strong>Contact Information:</strong> $1</p>')\\n        .replace(/\\\\*\\\\*Inquiry Summary:\\\\*\\\\*\\\\s*([\\\\s\\\\S]+?)(?=\\\\n\\\\n\\\\*\\\\*Action Required:)/, '<p><strong>Inquiry Summary:</strong> $1</p>')\\n        .replace(/\\\\*\\\\*Action Required:\\\\*\\\\*\\\\s*([\\\\s\\\\S]+)/, '<p><strong>Action Required:</strong> $1</p>');\\n\\n    // Wrap each paragraph in `<p>` tags for better readability\\n    htmlBody = htmlBody\\n        .replace(/Dear (.+?),/, '<p>Dear <strong>$1</strong>,</p>')\\n        .replace(/Thank you,\\\\s+(.+)/, '<p>Thank you,<br><strong>$1</strong></p>');\\n\\n    return htmlBody;\\n}\\n\\n// Convert the email body into HTML\\nconst formattedHtmlBody = formatEmailBodyAsHtml(emailBody);\\n\\n// Return the formatted HTML\\nreturn {\\n    html: formattedHtmlBody\\n};\\n\"},\"typeVersion\":2},{\"id\":\"3297550b-ed78-4528-ad65-facdc879590a\",\"name\":\"Inquiry has Notes\",\"type\":\"n8n-nodes-base.if\",\"position\":[-1080,640],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"bc81994a-2ad8-4af7-8c58-2c7e58a0fd2e\",\"operator\":{\"type\":\"string\",\"operation\":\"exists\",\"singleValue\":true},\"leftValue\":\"={{ $json.data.notes }}\",\"rightValue\":\"\"}]}},\"typeVersion\":2.2},{\"id\":\"e2544a27-8b6d-4bb0-84f1-00c3a5e66978\",\"name\":\"Inquiry is Valid?\",\"type\":\"n8n-nodes-base.if\",\"position\":[40,620],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"ddd5e8a2-277f-4db6-b38d-28a7b91a2f66\",\"operator\":{\"type\":\"string\",\"operation\":\"notEquals\"},\"leftValue\":\"={{ $json.output }}\",\"rightValue\":\"**Invalid Lead - Not related to products, services, or solutions.**\"}]}},\"typeVersion\":2.2},{\"id\":\"39cc73e7-ceb3-4e8e-a5bc-55648595f784\",\"name\":\"Company Profile\",\"type\":\"n8n-nodes-base.googleDocsTool\",\"position\":[-540,800],\"parameters\":{\"operation\":\"get\",\"documentURL\":\"you-must-provide-the-doc-id\"},\"credentials\":{\"googleDocsOAuth2Api\":{\"id\":\"RdTuYvYpBqEKhIQ3\",\"name\":\"Google Docs account\"}},\"typeVersion\":2},{\"id\":\"8ee24c59-1acb-4d76-a136-74e69d694a49\",\"name\":\"Company Policies\",\"type\":\"n8n-nodes-base.googleDocsTool\",\"position\":[-420,780],\"parameters\":{\"operation\":\"get\",\"documentURL\":\"you-must-provide-the-doc-id\"},\"credentials\":{\"googleDocsOAuth2Api\":{\"id\":\"RdTuYvYpBqEKhIQ3\",\"name\":\"Google Docs account\"}},\"typeVersion\":2},{\"id\":\"a5db3aa7-8a77-4553-9c13-a96c51f32745\",\"name\":\"Company Contact Database\",\"type\":\"n8n-nodes-base.googleSheetsTool\",\"position\":[-300,780],\"parameters\":{\"sheetName\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"\",\"cachedResultUrl\":\"\",\"cachedResultName\":\"\"},\"documentId\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"=Telephone Directory\"}},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"L3lApjbQfMm36LLX\",\"name\":\"Google Sheets account\"}},\"typeVersion\":4.5},{\"id\":\"f3e73266-faa4-4e6d-8c60-92669d64233b\",\"name\":\"Sticky Note4\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-2000,257.53836663807056],\"parameters\":{\"color\":6,\"width\":297.84037615575886,\"height\":643.0692298205195,\"content\":\"### Filter the Lead\\nI have done only for theose which are open and where the source is Website. You can remove this if you want to have all leads.\"},\"typeVersion\":1},{\"id\":\"0056e35c-4901-406d-9a95-f6da26808841\",\"name\":\"Sticky Note6\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-60,280],\"parameters\":{\"color\":3,\"width\":302.58963031819115,\"height\":660,\"content\":\"### Output from AI Agent\\nIf the INquiry is invalid, not related to the products and services offered, it will invalidate that you can optionnally link the invalid output to email or anything. Options are limitless\"},\"typeVersion\":1},{\"id\":\"5e0e9561-0fb8-4225-aa59-58e25abc8ca1\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-880,280.0000000000002],\"parameters\":{\"color\":7,\"width\":764.2159851725196,\"height\":648.5051458745236,\"content\":\"### Customer Experience Agent (AI)\\nNow this Node is an AI Agent who is speicalized to understand the Lead Source and the Inquiry sent by Cusomter. The Agent will look at company information, which has detials of producuts and services defined in Google Docs, and the Contacts Sheet where a column must be added mentioning that who is the person dealing in which products, solutions and services. Once the inquiry is about speicifc product solution and service it will look from the sheet and then will decide to whom the email has to be sent. Details is defined in the Agent.\\nMake sure to drag fields from http request node\"},\"typeVersion\":1},{\"id\":\"5a3ca9c9-07c2-4c74-ba8c-6b14f487fc4d\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-2420,260],\"parameters\":{\"color\":5,\"width\":398,\"height\":642,\"content\":\"### Once the Lead is generatd in ERP\\n\\nConsider creating creating an inquiry web form in ERPNext and let the Website Visitor fill that Inquiry form, as soon as the iqnuiry form is filled this workflow will start.\\n\\nMake sure to create a webhook in ERPNext. Follow Below steps in ERPNext.\\n\\nGo to Wehbooks \\nDoctype : Lead\\nTrigger : on_insert\\n\\nPaste this webhook there, as test first and finally production\"},\"typeVersion\":1},{\"id\":\"cf930f52-d06b-40c1-91f5-fa1c3dfee09a\",\"name\":\"Sticky Note7\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[618.1625654107004,260],\"parameters\":{\"color\":4,\"width\":388.6432532629275,\"height\":662,\"content\":\"### Email Body\\nGet only Email body from Previous Node and then Convert this to HTML Format so that it looks professional. \\n\"},\"typeVersion\":1},{\"id\":\"a1023b2b-3e0d-486f-9050-8ff98ff060b5\",\"name\":\"Sticky Note12\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-1440,260],\"parameters\":{\"color\":5,\"width\":248.905549047384,\"height\":654.6630436071407,\"content\":\"### Get Details of Lead from ERPNext. For us most important is Notes\"},\"typeVersion\":1},{\"id\":\"732046b2-967a-4e0c-85e4-ae04e8c0f9cf\",\"name\":\"Sticky Note13\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-1680,260],\"parameters\":{\"color\":6,\"width\":222.5278407657604,\"height\":651.0941643427163,\"content\":\"### Get Lead ID\\nThis will extract the Lead Name in ERPNext. Ensure to send doc.name from the webhook in ERPnext\\n\\nIt will then send this to next node to get full details of this lead.\"},\"typeVersion\":1},{\"id\":\"b80448ee-5a15-4569-99e4-c3e616a5600d\",\"name\":\"Sticky Note14\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1035.2592266730085,260],\"parameters\":{\"color\":6,\"width\":399.43186296400074,\"height\":662,\"content\":\"### Send Email\\n\\nNow drag and drop the fields from Previous Nodes. Email Addresses Subject and Body.\\n\\nRemember all fields are selected by AI Agent, whom to send email, what to send and so on. \\n\\nYou can alternatively inform your employees by whatsapp for quick action.\"},\"typeVersion\":1},{\"id\":\"3d190d34-f6e0-47bc-9216-d312d1d6ee38\",\"name\":\"Sticky Note11\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-2920,260],\"parameters\":{\"color\":4,\"width\":475.27306699862953,\"height\":636.1483291619771,\"content\":\"## Developed by Amjid Ali\\n\\nThank you for using this workflow template. It has taken me countless hours of hard work, research, and dedication to develop, and I sincerely hope it adds value to your work.\\n\\nIf you find this template helpful, I kindly ask you to consider supporting my efforts. Your support will help me continue improving and creating more valuable resources.\\n\\nYou can contribute via PayPal here:\\n\\nhttp://paypal.me/pmptraining\\n\\nFor Full Course about ERPNext or Automation using AI follow below link\\n\\nhttp://lms.syncbricks.com\\n\\nAdditionally, when sharing this template, I would greatly appreciate it if you include my original information to ensure proper credit is given.\\n\\nThank you for your generosity and support!\\nEmail : amjid@amjidali.com\\nhttps://linkedin.com/in/amjidali\\nhttps://syncbricks.com\\nhttps://youtube.com/@syncbricks\"},\"typeVersion\":1},{\"id\":\"cfd7effc-92aa-43c6-9fc5-054b53de74a2\",\"name\":\"Sticky Note16\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-1160,280],\"parameters\":{\"color\":5,\"width\":248.905549047384,\"height\":654.6630436071407,\"content\":\"### Inquiry with Notes\\nIf inquiry is having notes then only it will forward to next node.\"},\"typeVersion\":1},{\"id\":\"e5b0992c-e360-4323-82cb-c7ddec45deb5\",\"name\":\"Get Lead Data from ERPNext\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[-1360,640],\"parameters\":{\"url\":\"=https://erpnext.syncbricks.com/api/resource/Lead/{{ $('Source Website and Status Open').item.json.body.name }}\",\"options\":{},\"authentication\":\"predefinedCredentialType\",\"nodeCredentialType\":\"erpNextApi\"},\"credentials\":{\"erpNextApi\":{\"id\":\"PInpnsxvPkvaiW0z\",\"name\":\"ERPNext account\"}},\"typeVersion\":4.2},{\"id\":\"87508043-baf5-4fa6-aa38-0f06881dc267\",\"name\":\"Sticky Note10\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[280,280],\"parameters\":{\"color\":3,\"width\":302.58963031819115,\"height\":660,\"content\":\"### Prepare for Email\\nThis node will get approprate Fields for Email \\nEmail Addresses:\\nSubject : \\nEmail Body : \"},\"typeVersion\":1},{\"id\":\"2b4c1e91-c64b-43cb-aba2-c6f8f5a17c79\",\"name\":\"Webhook\",\"type\":\"n8n-nodes-base.webhook\",\"position\":[-2300,640],\"webhookId\":\"a39ea4e2-99b7-4ae1-baff-9fb370333e2a\",\"parameters\":{\"path\":\"new-lead-generated-in-erpnext\",\"options\":{},\"httpMethod\":\"POST\"},\"typeVersion\":2}],\"pinData\":{},\"connections\":{\"Webhook\":{\"main\":[[{\"node\":\"Source Website and Status Open\",\"type\":\"main\",\"index\":0}]]},\"Lead Body\":{\"main\":[[{\"node\":\"Get Lead Data from ERPNext\",\"type\":\"main\",\"index\":0}]]},\"Abbriviations\":{\"ai_tool\":[[{\"node\":\"Customer Lead AI Agent\",\"type\":\"ai_tool\",\"index\":0}]]},\"Company Profile\":{\"ai_tool\":[[{\"node\":\"Customer Lead AI Agent\",\"type\":\"ai_tool\",\"index\":0}]]},\"Company Policies\":{\"ai_tool\":[[{\"node\":\"Customer Lead AI Agent\",\"type\":\"ai_tool\",\"index\":0}]]},\"Inquiry has Notes\":{\"main\":[[{\"node\":\"Customer Lead AI Agent\",\"type\":\"main\",\"index\":0}]]},\"Inquiry is Valid?\":{\"main\":[[{\"node\":\"Fields for Outlook\",\"type\":\"main\",\"index\":0}]]},\"OpenAI Chat Model\":{\"ai_languageModel\":[[{\"node\":\"Customer Lead AI Agent\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"Fields for Outlook\":{\"main\":[[{\"node\":\"Email Body Text Generated by AI\",\"type\":\"main\",\"index\":0}]]},\"Customer Lead AI Agent\":{\"main\":[[{\"node\":\"Inquiry is Valid?\",\"type\":\"main\",\"index\":0}]]},\"Email Body for Outlook\":{\"main\":[[{\"node\":\"Microsoft Outlook\",\"type\":\"main\",\"index\":0}]]},\"Company Contact Database\":{\"ai_tool\":[[{\"node\":\"Customer Lead AI Agent\",\"type\":\"ai_tool\",\"index\":0}]]},\"Get Lead Data from ERPNext\":{\"main\":[[{\"node\":\"Inquiry has Notes\",\"type\":\"main\",\"index\":0}]]},\"Source Website and Status Open\":{\"main\":[[{\"node\":\"Lead Body\",\"type\":\"main\",\"index\":0}]]},\"Email Body Text Generated by AI\":{\"main\":[[{\"node\":\"Email Body for Outlook\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "#### **Overview**\n\nThis workflow template automates lead management and customer inquiry processing by integrating ERPNext, AI agents, and email notifications. It streamlines the process of capturing leads, analyzing inquiries, and generating actionable responses. The workflow uses ERPNext to capture inquiries, analyzes them with AI, and notifies the appropriate team or individual, all while maintaining a professional approach.\n\n* * *\n\n### **What This Template Does**\n\n  1. **ERPNext Webhook Integration:**\n\n     * Captures leads and inquiries through ERPNext webhooks.\n     * Triggers the workflow when a new lead is created.\n  2. **AI-Powered Inquiry Analysis:**\n\n     * Uses AI to extract key details from lead notes (e.g., customer name, organization, inquiry summary).\n     * Classifies inquiries as valid or invalid based on relevance to products, services, or solutions.\n  3. **Contact Assignment:**\n\n     * Matches inquiries to the appropriate contact(s) using a Google Sheets database or ERPNext contact information.\n     * Handles multiple contacts if required.\n  4. **Email Notifications:**\n\n     * Generates professional email notifications for valid inquiries.\n     * Sends emails to the appropriate contact(s) with inquiry details and action steps.\n  5. **Invalid Lead Handling:**\n\n     * Identifies invalid inquiries (e.g., unrelated to products or services) and flags them for follow-up or dismissal.\n  6. **Custom Email Formatting:**\n\n     * Converts plain text into professionally formatted HTML emails.\n     * Ensures that communication is clear, concise, and visually appealing.\n\n\n\n* * *\n\n### **How It Works**\n\n#### **Step 1: Capture Lead Data**\n\n  * **Webhook in ERPNext:**\n\n    * Create a webhook in ERPNext for the \"Lead\" DocType.\n    * Set the trigger to `on_insert` to capture new leads in real-time.\n  * **Lead Details:**\n\n    * The workflow fetches lead details, including notes, contact information, and the source of the lead.\n\n\n\n#### **Step 2: Validate and Analyze Inquiry**\n\n  * **AI Agent for Analysis:**\n\n    * An AI agent analyzes the lead notes to extract key details and classify the inquiry as valid or invalid.\n    * The analysis includes checking the relevance of the inquiry to products, services, or solutions offered by the company.\n  * **Invalid Leads:**\n\n    * If the inquiry is invalid, the workflow flags it and stops further processing.\n\n\n\n#### **Step 3: Assign Contact(s)**\n\n  * **Google Sheets Integration:**\n\n    * Uses a Google Sheets database to map products, services, or solutions to responsible contacts.\n    * Ensures that inquiries are directed to the right person or team.\n  * **Multiple Contacts:**\n\n    * Handles cases where multiple contacts are responsible for a particular product or service.\n\n\n\n#### **Step 4: Generate and Send Email Notifications**\n\n  * **AI-Generated Emails:**\n\n    * The workflow generates a professional email summarizing the inquiry.\n    * Emails include details like customer name, organization, inquiry summary, and action steps.\n  * **Custom HTML Formatting:**\n\n    * Emails are converted to HTML for a polished and professional appearance.\n  * **Send Notifications:**\n\n    * Sends email notifications through Microsoft Outlook or another configured email client.\n    * Optionally, notifies via WhatsApp or SMS for urgent inquiries.\n\n\n\n#### **Step 5: Post-Inquiry Actions**\n\n  * **ERPNext Record Updates:**\n    * Updates the lead record in ERPNext with relevant details, including inquiry status and contact information.\n\n\n\n* * *\n\n### **Setup Instructions**\n\n#### **Prerequisites**\n\n  1. **ERPNext:**\n     * A configured ERPNext instance with lead data and a webhook for the \"Lead\" DocType.\n  2. **Google Sheets:**\n     * A sheet mapping products, services, or solutions to responsible contacts.\n  3. **AI Integration:**\n     * Credentials for OpenAI or other supported AI platforms.\n  4. **Email Client:**\n     * Credentials for Microsoft Outlook or another email client.\n\n\n\n* * *\n\n### **Step-by-Step Setup**\n\n  1. **ERPNext Configuration:**\n\n     * Create a webhook for the \"Lead\" DocType in ERPNext.\n     * Test the webhook with sample data to ensure proper integration.\n  2. **Workflow Import:**\n\n     * Import the workflow template into n8n.\n     * Configure nodes with your API credentials for ERPNext, Google Sheets, and AI tools.\n  3. **Google Sheets Integration:**\n\n     * Prepare a Google Sheet with columns for product, service, or solution and the responsible contact(s).\n     * Link the sheet to the workflow.\n  4. **AI Agent Configuration:**\n\n     * Customize the AI agent’s prompts to align with your business’s products and services.\n     * Adjust criteria for valid and invalid inquiries as needed.\n  5. **Email Setup:**\n\n     * Configure the email client node with your email service credentials.\n     * Customize the email template for your organization.\n  6. **Testing:**\n\n     * Run the workflow with sample leads to validate the entire process.\n     * Check email notifications, contact assignments, and record updates in ERPNext.\n\n\n\n* * *\n\n### **Dos and Don’ts**\n\n#### **Dos:**\n\n  * **Test Thoroughly:** Test the workflow with various scenarios before deploying in production.\n  * **Secure Credentials:** Keep API and email credentials secure to avoid unauthorized access.\n  * **Customize Prompts:** Tailor AI prompts to match your business needs and language style.\n  * **Use Professional Email Templates:** Ensure emails are clear and well-formatted.\n\n\n\n#### **Don’ts:**\n\n  * **Skip Validation:** Always validate inquiry data to avoid sending irrelevant notifications.\n  * **Overload the Workflow:** Avoid adding unnecessary nodes that can slow down processing.\n  * **Ignore Errors:** Monitor logs and address errors promptly for a smooth workflow.\n\n\n\n* * *\n\n### **Resources**\n\n### [GET n8n Now](https://www.udemy.com/course/mastering-n8n-ai-agents-api-automation-webhooks-no-code/?referralCode=0309FD70BE2D72630C09)\n\n### [N8N COURSE](https://www.udemy.com/course/mastering-n8n-ai-agents-api-automation-webhooks-no-code/?referralCode=0309FD70BE2D72630C09)\n\n### [n8n Book](https://lms.syncbricks.com/books/n8n/)\n\n  * **YouTube Tutorial:**  \nWatch the full step-by-step tutorial on setting up this workflow:  \n[SyncBricks YouTube Channel](https://youtube.com/@syncbricks)\n\n  * **Courses and Training:**  \nLearn more about ERPNext and AI automation through my comprehensive courses:  \n[SyncBricks LMS](http://lms.syncbricks.com)\n\n  * **Support and Contact:**\n\n    * **Email:** [amjid@amjidali.com](mailto:amjid@amjidali.com)\n    * **Website:** [SyncBricks](https://syncbricks.com)\n    * **LinkedIn:** [Amjid Ali](https://linkedin.com/in/amjidali)\n\n\n",
  "crawled_at": "2025-05-26T01:54:54.022162",
  "readme_zh": "#### **概述**\n\n该工作流模板通过集成ERPNext、AI智能体和邮件通知，实现了潜在客户管理和客户咨询处理的自动化。它能高效捕获线索、分析咨询内容并生成可执行的响应方案。工作流利用ERPNext收集咨询信息，借助AI进行分析，并通知相关团队或个人，全程保持专业化的处理方式。\n\n* * *\n\n### **模板功能**\n\n  1. **ERPNext Webhook集成：**\n     * 通过ERPNext的Webhook捕获潜在客户和咨询信息。\n     * 当新线索创建时触发工作流。\n  2. **AI驱动的咨询分析：**\n     * 使用AI从客户备注中提取关键信息（如客户姓名、公司、咨询摘要）。\n     * 根据咨询内容与产品、服务或解决方案的相关性，将其分类为有效或无效。\n  3. **联系人分配：**\n     * 通过Google Sheets数据库或ERPNext联系人信息，将咨询匹配至对应负责人。\n     * 支持分配至多名联系人。\n  4. **邮件通知：**\n     * 为有效咨询生成专业邮件通知。\n     * 向相关联系人发送包含咨询详情和行动步骤的邮件。\n  5. **无效线索处理：**\n     * 识别无效咨询（如与业务无关内容）并标记为需跟进或忽略。\n  6. **自定义邮件格式：**\n     * 将纯文本转换为专业排版的HTML邮件。\n     * 确保沟通内容清晰简洁且视觉美观。\n\n* * *\n\n### **运作流程**\n\n#### **步骤1：捕获线索数据**\n\n  * **ERPNext Webhook设置：**\n    * 在ERPNext中为“潜在客户”文档类型创建Webhook。\n    * 将触发器设为`on_insert`以实时捕获新线索。\n  * **线索详情获取：**\n    * 工作流提取线索详情，包括备注、联系信息和来源。\n\n#### **步骤2：验证并分析咨询**\n\n  * **AI智能体分析：**\n    * AI分析客户备注，提取关键信息并判断咨询有效性。\n    * 检查咨询内容是否与公司提供的产品、服务或解决方案相关。\n  * **无效处理：**\n    * 若咨询无效，工作流将标记并终止后续流程。\n\n#### **步骤3：分配联系人**\n\n  * **Google Sheets集成：**\n    * 通过Google Sheets数据库将产品、服务或解决方案映射至负责人。\n    * 确保咨询转至正确人员或团队。\n  * **多联系人处理：**\n    * 支持为同一产品或服务分配多名联系人。\n\n#### **步骤4：生成并发送邮件通知**\n\n  * **AI生成邮件：**\n    * 工作流生成专业邮件，汇总咨询内容。\n    * 邮件包含客户姓名、公司、咨询摘要及行动步骤。\n  * **HTML格式优化：**\n    * 邮件转换为HTML格式以提升专业度。\n  * **发送通知：**\n    * 通过Microsoft Outlook或其他配置的邮件客户端发送。\n    * 紧急情况下可额外通过WhatsApp或短信通知。\n\n#### **步骤5：咨询后处理**\n\n  * **ERPNext记录更新：**\n    * 更新ERPNext中的线索记录，包括咨询状态和联系人信息。\n\n* * *\n\n### **配置指南**\n\n#### **先决条件**\n\n  1. **ERPNext：**\n     * 已配置的ERPNext实例，需支持“潜在客户”文档类型的Webhook。\n  2. **Google Sheets：**\n     * 准备记录产品/服务与负责人映射关系的表格。\n  3. **AI集成：**\n     * 提供OpenAI或其他支持平台的API凭证。\n  4. **邮件客户端：**\n     * 配置Microsoft Outlook或其他邮件服务的访问权限。\n\n* * *\n\n### **分步配置**\n\n  1. **ERPNext设置：**\n     * 在ERPNext中创建“潜在客户”Webhook。\n     * 使用测试数据验证Webhook是否正常触发。\n  2. **工作流导入：**\n     * 将模板导入n8n，配置ERPNext、Google Sheets和AI工具的API节点。\n  3. **Google Sheets关联：**\n     * 创建包含产品/服务与联系人映射关系的表格，并与工作流链接。\n  4. **AI智能体调整：**\n     * 根据业务需求定制AI分析提示词。\n     * 按需调整有效/无效咨询的判定标准。\n  5. **邮件服务配置：**\n     * 在邮件节点中输入服务商凭证。\n     * 自定义符合企业形象的邮件模板。\n  6. **测试运行：**\n     * 使用模拟数据测试全流程。\n     * 检查邮件通知、联系人分配及ERPNext记录更新是否正常。\n\n* * *\n\n### **注意事项**\n\n#### **建议事项：**\n\n  * **充分测试：** 上线前需模拟多种场景验证流程稳定性。\n  * **保护凭证：** 妥善保管API和邮件服务密钥以防泄露。\n  * **定制提示：** 根据业务需求优化AI提示词。\n  * **专业模板：** 确保邮件内容清晰、格式规范。\n\n#### **避免事项：**\n\n  * **跳过验证：** 始终验证咨询有效性以防误发通知。\n  * **过度复杂：** 避免添加非必要节点影响处理效率。\n  * **忽视报错：** 及时监控日志并修复问题。\n\n* * *\n\n### **资源链接**\n\n### [立即获取n8n](https://www.udemy.com/course/mastering-n8n-ai-agents-api-automation-webhooks-no-code/?referralCode=0309FD70BE2D72630C09)\n\n### [N8N课程](https://www.udemy.com/course/mastering-n8n-ai-agents-api-automation-webhooks-no-code/?referralCode=0309FD70BE2D72630C09)\n\n### [n8n指南书](https://lms.syncbricks.com/books/n8n/)\n\n  * **视频教程：**  \n完整配置教程请观看：  \n[SyncBricks YouTube频道](https://youtube.com/@syncbricks)\n\n  * **系统课程：**  \n通过综合课程深入学习ERPNext与AI自动化：  \n[SyncBricks学习平台](http://lms.syncbricks.com)\n\n  * **支持联系：**\n    * **邮箱：** [amjid@amjidali.com](mailto:amjid@amjidali.com)\n    * **官网：** [SyncBricks](https://syncbricks.com)\n    * **领英：** [Amjid Ali](https://linkedin.com/in/amjidali)",
  "title_zh": "基于ERPNext与n8n的AI驱动潜在客户管理与询盘自动化",
  "publish_date_zh": "上次更新于一个月前",
  "workflow_json_zh": "{\n  \"meta\": {\n    \"instanceId\": \"e4f78845dfed9ddcfba1945ae00d12e9a7d76eab052afd19299228ce02349d86\"\n  },\n  \"nodes\": [\n    {\n      \"id\": \"23291d25-3e1a-4b0d-9b1d-d066e8c04a1f\",\n      \"name\": \"Customer Lead AI Agent\",\n      \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n      \"position\": [\n        -640,\n        460\n      ],\n      \"parameters\": {\n        \"text\": \"=**System Prompt:**\\n\\nYou are an AI assistant designed to process new leads and generate appropriate responses. Your role includes analyzing lead notes, categorizing them, and generating an email from the system to inform the relevant contact about the inquiry. Do not send the email as if it is directly from the customer; instead, draft it as a notification from the system summarizing the inquiry.\\n\\n### **Process Flow**\\n\\n1. **Analyzing Lead Notes:**\\n   - Extract key details such as the customer name, organization, contact information, and their specific request.  \\n   - Determine if the inquiry relates to products, services, or solutions offered by the company.\\n\\n2. **Finding the Appropriate Contact(s):**\\n   - Search the contact database to find the responsible person(s) for the relevant product, service, or solution.  \\n   - If one person is responsible, provide their email.  \\n   - If multiple people are responsible, list all emails separated by commas.\\n\\n3. **Generating an Email Notification:**\\n   - Draft a professional email as a notification from the system.\\n   - Summarize the customer’s inquiry.\\n   - Include all relevant details to assist the recipient in addressing the inquiry.\\n\\n4. **Handling Invalid Leads:**\\n   - If the inquiry is unrelated to products, services, or solutions (e.g., job inquiries or general product inquiries), classify it as invalid and return:  \\n     `\\\"Invalid Lead - Not related to products, services, or solutions.\\\"`\\n\\n### **Output Requirements**\\n\\n1. **For Relevant Leads:**\\n   - **Email Address(es):** Provide the appropriate email(s).  \\n   - **Email Message Body:** Generate an email notification from the system summarizing the inquiry.\\n\\n2. **For Invalid Leads:**\\n   - Return: `\\\"Invalid Lead - Not related to products, services, or solutions.\\\"`\\n\\n\\n### **Email Template for Relevant Leads**\\n\\n**Email Address(es):** [Relevant Email IDs]\\n\\n**Email Message Body:**\\n\\n_Subject: New Inquiry from Customer Regarding [Product/Service/Solution]_  \\n\\nDear [Recipient(s)],  \\n\\nWe have received a new inquiry from a customer through our system. Below are the details:  \\n\\n**Customer Name:** [Customer Name]  \\n**Organization:** [Organization Name]  \\n**Contact Information:** [Contact Details]  \\n\\n**Inquiry Summary:**  \\n[Summarized description of the customer's request, e.g., “The customer is seeking to upgrade their restroom facilities with touchless soap dispensers and tissue holders installed behind mirrors. They have requested a site visit to assess the location and provide a proposal.”]  \\n\\n**Action Required:**  \\nPlease prioritize this inquiry and reach out to the customer promptly to address their requirements.  \\n\\nThank you,  \\n[Your System Name]  \\n\\n\\n### **Example Output**\\n\\n**Input Lead Notes:**\\n*\\\"Dear Syncbricks, We are looking to Develop Workflow Automation Soluition for our company, can you let us know the details what do you offer in tems of this.\\\"*\\n\\n**Output:**\\n\\n- **Email Address(es):** employee@syncbricks.com\\n\\n- **Email Message Body:**  \\n\\n_Subject: Workflow Automation Platform Integration_  \\n\\nDear -Emploiyee Name (s) --,  \\n\\nWe have received a new inquiry from a customer through our system. Below are the details:  \\n\\n**Customer Name:** Amjid Ali \\n**Organization:** Syncbricks LLC\\n**Contact Information:** 123456789 \\n\\n**Inquiry Summary:**  \\nThe customer is asking for workflow automation for their company \\n\\n**Action Required:**  \\nPlease prioritize this inquiry and reach out to the customer promptly to address their requirements.  \\n\\nThank you,  \\nSyncbricks LLC\\n\\n---\\nHere are the Lead Details\\nLead Name : {{ $json.data.lead_name }}\\nCompany : {{ $json.data.company_name }}\\nSource : {{ $json.data.source }}\\nNotes : {{ $json.data.notes }}\\nCity : {{ $json.data.city }}\\nCountry : {{ $json.data.country }}\\nMobile : {{ $json.data.mobile_no }}\",\n        \"options\": {},\n        \"promptType\": \"define\"\n      },\n      \"typeVersion\": 1.7\n    },\n    {\n      \"id\": \"1831dc36-910b-4a72-a90e-b411f105a8c3\",\n      \"name\": \"OpenAI Chat Model\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\n      \"position\": [\n        -800,\n        800\n      ],\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"hTl3a2XqteCwExYY\",\n          \"name\": \"OpenAi account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"79713c56-2f7c-4872-90e4-331715f54048\",\n      \"name\": \"Abbriviations\",\n      \"type\": \"n8n-nodes-base.googleSheetsTool\",\n      \"position\": [\n        -640,\n        800\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"gid=0\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1gtdrAe-jjQH9gQdXA9PJ5y3dSAN4i6k_Rs5sDyALIfU/edit#gid=0\",\n          \"cachedResultName\": \"abbrivaitions\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"1gtdrAe-jjQH9gQdXA9PJ5y3dSAN4i6k_Rs5sDyALIfU\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1gtdrAe-jjQH9gQdXA9PJ5y3dSAN4i6k_Rs5sDyALIfU/edit?usp=drivesdk\",\n          \"cachedResultName\": \"Abbriviations List\"\n        }\n      },\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"L3lApjbQfMm36LLX\",\n          \"name\": \"Google Sheets account\"\n        }\n      },\n      \"typeVersion\": 4.5\n    },\n    {\n      \"id\": \"73b1e3c9-4703-4f87-8399-e7a9bf368d4c\",\n      \"name\": \"Lead Body\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        -1640,\n        640\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"82a674a2-4d12-45f2-b276-cc95cf7b2e93\",\n              \"name\": \"body\",\n              \"type\": \"object\",\n              \"value\": \"={{ $json.body }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"5f25d846-c639-49e5-bea2-160000bfb104\",\n      \"name\": \"Source Website and Status Open\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        -1920,\n        640\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"2b184de2-a64e-44e3-8f25-645539681533\",\n              \"operator\": {\n                \"name\": \"filter.operator.equals\",\n                \"type\": \"string\",\n                \"operation\": \"equals\"\n              },\n              \"leftValue\": \"={{ $json.body.source }}\",\n              \"rightValue\": \"Website\"\n            },\n            {\n              \"id\": \"9632cf65-11a1-483c-95c8-94bfe84fb243\",\n              \"operator\": {\n                \"name\": \"filter.operator.equals\",\n                \"type\": \"string\",\n                \"operation\": \"equals\"\n              },\n              \"leftValue\": \"={{ $json.body.status }}\",\n              \"rightValue\": \"Open\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"12ba65c9-0890-4862-9704-98492eb8f637\",\n      \"name\": \"Microsoft Outlook\",\n      \"type\": \"n8n-nodes-base.microsoftOutlook\",\n      \"position\": [\n        1180,\n        580\n      ],\n      \"parameters\": {\n        \"subject\": \"={{ $('Fields for Outlook').item.json.subject }}\",\n        \"bodyContent\": \"={{ $json.html }}\\n<a href=\\\"https://erpnext.syncbricks.com/app/lead/{{ $('Webhook').item.json.body.name }}\\\" target=\\\"_blank\\\" rel=\\\"noopener noreferrer\\\">Here is Lead {{ $('Source Website and Status Open').item.json.body.name }} </a>\\n\",\n        \"toRecipients\": \"= {{ $('Fields for Outlook').item.json.email_addresses }}\",\n        \"additionalFields\": {\n          \"bodyContentType\": \"html\"\n        }\n      },\n      \"credentials\": {\n        \"microsoftOutlookOAuth2Api\": {\n          \"id\": \"9gy3uvf3pmBdpEsq\",\n          \"name\": \"Microsoft Outlook Al Ansari\"\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"b1410997-3705-4234-918e-a14e4ccc6b70\",\n      \"name\": \"Email Body Text Generated by AI\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        700,\n        580\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"cdce31fb-2ec9-45ce-a4ac-a6ff9c811dc3\",\n              \"name\": \"email_body\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.email_body }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"b10684b9-9f72-42b3-a9f9-c54e711ceb59\",\n      \"name\": \"Fields for Outlook\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        360,\n        600\n      ],\n      \"parameters\": {\n        \"jsCode\": \"// Input text from the `output` field\\nconst textOutput = $json?.output || '';\\n\\n// Function to extract values from the text\\nfunction extractFields(text) {\\n    const fields = {};\\n\\n    // Regular expressions to extract each field\\n    const emailMatch = text.match(/\\\\*\\\\*Email Address\\\\(es\\\\):\\\\*\\\\*\\\\s*([^\\\\n]+)/);\\n    const subjectMatch = text.match(/_Subject:\\\\s*([^_]+)/);\\n    const emailBodyMatch = text.match(/Dear[\\\\s\\\\S]+/);\\n\\n    // Assign extracted values to the fields\\n    fields.email_addresses = emailMatch ? emailMatch[1].trim() : null;\\n    fields.subject = subjectMatch ? subjectMatch[1].trim() : null;\\n    fields.email_body = emailBodyMatch ? emailBodyMatch[0].trim() : null;\\n\\n    return fields;\\n}\\n\\n// Extract fields from the output\\nconst extractedFields = extractFields(textOutput);\\n\\n// Return the fields as JSON\\nreturn {\\n    json: extractedFields\\n};\\n\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"e2c10569-fde2-425c-8b20-fdb32a6e2bd5\",\n      \"name\": \"Email Body for Outlook\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        860,\n        580\n      ],\n      \"parameters\": {\n        \"jsCode\": \"// Input email body\\nconst emailBody = $json.email_body || '';\\n\\n// Function to convert plain text email body into HTML\\nfunction formatEmailBodyAsHtml(body) {\\n    // Replace markdown-like sections with corresponding HTML\\n    let htmlBody = body\\n        .replace(/\\\\*\\\\*Customer Name:\\\\*\\\\* (.+)/, '<p><strong>Customer Name:</strong> $1</p>')\\n        .replace(/\\\\*\\\\*Organization:\\\\*\\\\* (.+)/, '<p><strong>Organization:</strong> $1</p>')\\n        .replace(/\\\\*\\\\*Contact Information:\\\\*\\\\* (.+)/, '<p><strong>Contact Information:</strong> $1</p>')\\n        .replace(/\\\\*\\\\*Inquiry Summary:\\\\*\\\\*\\\\s*([\\\\s\\\\S]+?)(?=\\\\n\\\\n\\\\*\\\\*Action Required:)/, '<p><strong>Inquiry Summary:</strong> $1</p>')\\n        .replace(/\\\\*\\\\*Action Required:\\\\*\\\\*\\\\s*([\\\\s\\\\S]+)/, '<p><strong>Action Required:</strong> $1</p>');\\n\\n    // Wrap each paragraph in `<p>` tags for better readability\\n    htmlBody = htmlBody\\n        .replace(/Dear (.+?),/, '<p>Dear <strong>$1</strong>,</p>')\\n        .replace(/Thank you,\\\\s+(.+)/, '<p>Thank you,<br><strong>$1</strong></p>');\\n\\n    return htmlBody;\\n}\\n\\n// Convert the email body into HTML\\nconst formattedHtmlBody = formatEmailBodyAsHtml(emailBody);\\n\\n// Return the formatted HTML\\nreturn {\\n    html: formattedHtmlBody\\n};\\n\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"3297550b-ed78-4528-ad65-facdc879590a\",\n      \"name\": \"Inquiry has Notes\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        -1080,\n        640\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"bc81994a-2ad8-4af7-8c58-2c7e58a0fd2e\",\n              \"operator\": {\n                \"type\": \"string\",\n                \"operation\": \"exists\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json.data.notes }}\",\n              \"rightValue\": \"\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"e2544a27-8b6d-4bb0-84f1-00c3a5e66978\",\n      \"name\": \"Inquiry is Valid?\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        40,\n        620\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"ddd5e8a2-277f-4db6-b38d-28a7b91a2f66\",\n              \"operator\": {\n                \"type\": \"string\",\n                \"operation\": \"notEquals\"\n              },\n              \"leftValue\": \"={{ $json.output }}\",\n              \"rightValue\": \"**Invalid Lead - Not related to products, services, or solutions.**\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"39cc73e7-ceb3-4e8e-a5bc-55648595f784\",\n      \"name\": \"Company Profile\",\n      \"type\": \"n8n-nodes-base.googleDocsTool\",\n      \"position\": [\n        -540,\n        800\n      ],\n      \"parameters\": {\n        \"operation\": \"get\",\n        \"documentURL\": \"you-must-provide-the-doc-id\"\n      },\n      \"credentials\": {\n        \"googleDocsOAuth2Api\": {\n          \"id\": \"RdTuYvYpBqEKhIQ3\",\n          \"name\": \"Google Docs account\"\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"8ee24c59-1acb-4d76-a136-74e69d694a49\",\n      \"name\": \"Company Policies\",\n      \"type\": \"n8n-nodes-base.googleDocsTool\",\n      \"position\": [\n        -420,\n        780\n      ],\n      \"parameters\": {\n        \"operation\": \"get\",\n        \"documentURL\": \"you-must-provide-the-doc-id\"\n      },\n      \"credentials\": {\n        \"googleDocsOAuth2Api\": {\n          \"id\": \"RdTuYvYpBqEKhIQ3\",\n          \"name\": \"Google Docs account\"\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"a5db3aa7-8a77-4553-9c13-a96c51f32745\",\n      \"name\": \"Company Contact Database\",\n      \"type\": \"n8n-nodes-base.googleSheetsTool\",\n      \"position\": [\n        -300,\n        780\n      ],\n      \"parameters\": {\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"\",\n          \"cachedResultUrl\": \"\",\n          \"cachedResultName\": \"\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"=Telephone Directory\"\n        }\n      },\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"L3lApjbQfMm36LLX\",\n          \"name\": \"Google Sheets account\"\n        }\n      },\n      \"typeVersion\": 4.5\n    },\n    {\n      \"id\": \"f3e73266-faa4-4e6d-8c60-92669d64233b\",\n      \"name\": \"Sticky Note4\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -2000,\n        257.53836663807056\n      ],\n      \"parameters\": {\n        \"color\": 6,\n        \"width\": 297.84037615575886,\n        \"height\": 643.0692298205195,\n        \"content\": \"### 筛选潜在客户  \\n我仅处理了那些状态为开放且来源为网站的潜在客户。如需包含所有潜在客户，可删除此筛选条件。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"0056e35c-4901-406d-9a95-f6da26808841\",\n      \"name\": \"Sticky Note6\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -60,\n        280\n      ],\n      \"parameters\": {\n        \"color\": 3,\n        \"width\": 302.58963031819115,\n        \"height\": 660,\n        \"content\": \"### 中文翻译\\n如果查询无效，与所提供的产品和服务无关，您可以选择将无效输出链接至电子邮件或其他任何方式。选项是无限的。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"5e0e9561-0fb8-4225-aa59-58e25abc8ca1\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -880,\n        280.0000000000002\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 764.2159851725196,\n        \"height\": 648.5051458745236,\n        \"content\": \"### 客户体验专员（人工智能）  \\n该节点是一个专门用于理解客户来源及其咨询内容的人工智能代理。代理将查阅公司信息（其中包含谷歌文档中定义的产品与服务详情）以及联系人表格（需添加一列注明每位负责人对应的产品、解决方案及服务）。当咨询涉及特定产品、解决方案或服务时，代理将从表格中检索并决定邮件应发送给哪位负责人。具体逻辑已在代理中定义。  \\n请确保从http请求节点拖拽字段。  \\n\\n（注：根据技术文档的翻译规范，保留\\\"Node\\\"、\\\"Google Docs\\\"等专有名词不译；\\\"Lead Source\\\"译为\\\"客户来源\\\"符合行业术语；\\\"drag fields\\\"采用\\\"拖拽字段\\\"的通用技术表述；句式按中文习惯调整，拆分长句并补充衔接词确保流畅。）\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"5a3ca9c9-07c2-4c74-ba8c-6b14f487fc4d\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -2420,\n        260\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 398,\n        \"height\": 642,\n        \"content\": \"### 当潜在客户在ERP中生成后\\n\\n考虑在ERPNext中创建一个询价网页表单，让网站访客填写该询价表。一旦表单提交，此工作流将自动启动。\\n\\n确保在ERPNext中设置一个网络钩子。请按照以下步骤操作：\\n\\n进入网络钩子设置  \\n文档类型：潜在客户  \\n触发条件：新增时  \\n\\n将以下网络钩子地址粘贴至此，先进行测试，最后投入生产环境。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"cf930f52-d06b-40c1-91f5-fa1c3dfee09a\",\n      \"name\": \"Sticky Note7\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        618.1625654107004,\n        260\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 388.6432532629275,\n        \"height\": 662,\n        \"content\": \"### 邮件正文\\n仅获取上一节点的邮件正文内容，并将其转换为HTML格式，使其呈现专业外观。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"a1023b2b-3e0d-486f-9050-8ff98ff060b5\",\n      \"name\": \"Sticky Note12\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -1440,\n        260\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 248.905549047384,\n        \"height\": 654.6630436071407,\n        \"content\": \"### 从ERPNext获取潜在客户详情。对我们来说最重要的是备注信息。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"732046b2-967a-4e0c-85e4-ae04e8c0f9cf\",\n      \"name\": \"Sticky Note13\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -1680,\n        260\n      ],\n      \"parameters\": {\n        \"color\": 6,\n        \"width\": 222.5278407657604,\n        \"height\": 651.0941643427163,\n        \"content\": \"### 获取潜在客户ID\\n此操作将在ERPNext中提取潜在客户名称。请确保从ERPnext的webhook发送doc.name\\n\\n随后，系统会将此信息发送至下一节点以获取该潜在客户的完整详细信息。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"b80448ee-5a15-4569-99e4-c3e616a5600d\",\n      \"name\": \"Sticky Note14\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1035.2592266730085,\n        260\n      ],\n      \"parameters\": {\n        \"color\": 6,\n        \"width\": 399.43186296400074,\n        \"height\": 662,\n        \"content\": \"### 发送邮件\\n\\n现在将字段从“前一节点”拖放至此处。包括电子邮件地址、主题和正文。\\n\\n请注意，所有字段均由AI代理自动选择，包括收件人、邮件内容等。\\n\\n如需快速通知员工，您也可选择通过WhatsApp发送信息。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"3d190d34-f6e0-47bc-9216-d312d1d6ee38\",\n      \"name\": \"Sticky Note11\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -2920,\n        260\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 475.27306699862953,\n        \"height\": 636.1483291619771,\n        \"content\": \"## 由Amjid Ali开发\\n\\n感谢您使用此工作流模板。它凝聚了我无数小时的辛勤工作、研究及专注开发，衷心希望能为您的项目创造价值。\\n\\n若本模板对您有所帮助，恳请考虑支持我的持续创作。您的支持将助力我不断优化并产出更多优质资源。\\n\\n可通过PayPal进行赞助：\\nhttp://paypal.me/pmptraining\\n\\n获取ERPNext完整课程或AI自动化教程，请访问：\\nhttp://lms.syncbricks.com\\n\\n另请注意，在分享此模板时，若能保留原始作者信息以标明出处，我将不胜感激。\\n\\n感谢您的慷慨支持！\\n邮箱：amjid@amjidali.com\\n领英主页：https://linkedin.com/in/amjidali\\n官网：https://syncbricks.com\\nYouTube频道：https://youtube.com/@syncbricks\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"cfd7effc-92aa-43c6-9fc5-054b53de74a2\",\n      \"name\": \"Sticky Note16\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -1160,\n        280\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 248.905549047384,\n        \"height\": 654.6630436071407,\n        \"content\": \"### 带备注的查询\\n只有当查询附有备注时，才会将其转发至下一节点。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"e5b0992c-e360-4323-82cb-c7ddec45deb5\",\n      \"name\": \"Get Lead Data from ERPNext\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        -1360,\n        640\n      ],\n      \"parameters\": {\n        \"url\": \"=https://erpnext.syncbricks.com/api/resource/Lead/{{ $('Source Website and Status Open').item.json.body.name }}\",\n        \"options\": {},\n        \"authentication\": \"predefinedCredentialType\",\n        \"nodeCredentialType\": \"erpNextApi\"\n      },\n      \"credentials\": {\n        \"erpNextApi\": {\n          \"id\": \"PInpnsxvPkvaiW0z\",\n          \"name\": \"ERPNext account\"\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"87508043-baf5-4fa6-aa38-0f06881dc267\",\n      \"name\": \"Sticky Note10\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        280,\n        280\n      ],\n      \"parameters\": {\n        \"color\": 3,\n        \"width\": 302.58963031819115,\n        \"height\": 660,\n        \"content\": \"### 准备邮件\\n此节点将获取适用于邮件的字段  \\n收件人地址：  \\n主题：  \\n邮件正文：\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"2b4c1e91-c64b-43cb-aba2-c6f8f5a17c79\",\n      \"name\": \"Webhook\",\n      \"type\": \"n8n-nodes-base.webhook\",\n      \"position\": [\n        -2300,\n        640\n      ],\n      \"webhookId\": \"a39ea4e2-99b7-4ae1-baff-9fb370333e2a\",\n      \"parameters\": {\n        \"path\": \"new-lead-generated-in-erpnext\",\n        \"options\": {},\n        \"httpMethod\": \"POST\"\n      },\n      \"typeVersion\": 2\n    }\n  ],\n  \"pinData\": {},\n  \"connections\": {\n    \"Webhook\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Source Website and Status Open\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Lead Body\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get Lead Data from ERPNext\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Abbriviations\": {\n      \"ai_tool\": [\n        [\n          {\n            \"node\": \"Customer Lead AI Agent\",\n            \"type\": \"ai_tool\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Company Profile\": {\n      \"ai_tool\": [\n        [\n          {\n            \"node\": \"Customer Lead AI Agent\",\n            \"type\": \"ai_tool\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Company Policies\": {\n      \"ai_tool\": [\n        [\n          {\n            \"node\": \"Customer Lead AI Agent\",\n            \"type\": \"ai_tool\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Inquiry has Notes\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Customer Lead AI Agent\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Inquiry is Valid?\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Fields for Outlook\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"OpenAI Chat Model\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"Customer Lead AI Agent\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Fields for Outlook\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Email Body Text Generated by AI\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Customer Lead AI Agent\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Inquiry is Valid?\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Email Body for Outlook\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Microsoft Outlook\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Company Contact Database\": {\n      \"ai_tool\": [\n        [\n          {\n            \"node\": \"Customer Lead AI Agent\",\n            \"type\": \"ai_tool\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get Lead Data from ERPNext\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Inquiry has Notes\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Source Website and Status Open\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Lead Body\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Email Body Text Generated by AI\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Email Body for Outlook\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}