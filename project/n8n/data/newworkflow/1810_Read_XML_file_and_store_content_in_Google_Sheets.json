{
  "url": "https://n8n.io/workflows/1810-read-xml-file-and-store-content-in-google-sheets/",
  "title": "Read XML file and store content in Google Sheets",
  "author": "Tom",
  "publish_date": "Last update 10 months ago",
  "publish_date_absolute": "2024-07-25",
  "categories": [
    {
      "name": "Building Blocks"
    }
  ],
  "workflow_json": "{\"nodes\":[{\"id\":\"d0c92688-14fc-4393-a1d6-926eb867b81e\",\"name\":\"On clicking 'execute'\",\"type\":\"n8n-nodes-base.manualTrigger\",\"position\":[180,240],\"parameters\":{},\"typeVersion\":1},{\"id\":\"0edbad78-249b-441c-877d-bac57fb44a91\",\"name\":\"Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[180,31],\"parameters\":{\"width\":436,\"height\":169,\"content\":\"## n8n version\\n\\nThis workflow was created using n8n version 0.197.1 and uses a new [expression syntax](https://docs.n8n.io/code-examples/methods-variables-reference/) as well as a new version of the Merge node. Make sure you're also using n8n version 0.197.1 or newer when running this workflow.\"},\"typeVersion\":1},{\"id\":\"251d893c-11cb-4702-a289-44f198581722\",\"name\":\"Download XML File\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[400,240],\"parameters\":{\"url\":\"https://www.w3schools.com/xml/simple.xml\",\"options\":{}},\"typeVersion\":3},{\"id\":\"0973b302-1ba9-4faf-9d6c-2caca1b301f5\",\"name\":\"Parse XML content\",\"type\":\"n8n-nodes-base.xml\",\"position\":[620,240],\"parameters\":{\"options\":{}},\"typeVersion\":1},{\"id\":\"01854111-27cb-40c1-b95e-14f91f89e9f1\",\"name\":\"Create new spreadsheet file\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[1060,140],\"parameters\":{\"title\":\"My XML Data\",\"options\":{},\"resource\":\"spreadsheet\"},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"19\",\"name\":\"Tom's Google Sheets account\"}},\"executeOnce\":true,\"typeVersion\":2},{\"id\":\"affbcb81-5873-406e-a51d-cd6fee682992\",\"name\":\"Define header row\",\"type\":\"n8n-nodes-base.set\",\"position\":[1280,140],\"parameters\":{\"values\":{\"string\":[{\"name\":\"columns\",\"value\":\"={{ [ Object.keys($(\\\"Split out food items\\\").first().json) ] }}\"}]},\"options\":{},\"keepOnlySet\":true},\"executeOnce\":true,\"typeVersion\":1},{\"id\":\"537aff03-ae08-4712-bfae-15f0e3a5e69a\",\"name\":\"Split out food items\",\"type\":\"n8n-nodes-base.itemLists\",\"position\":[840,240],\"parameters\":{\"options\":{},\"fieldToSplitOut\":\"breakfast_menu.food\"},\"typeVersion\":1},{\"id\":\"b247f984-6ed2-4de0-8877-a61571863ff8\",\"name\":\"Write header row\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[1500,140],\"parameters\":{\"options\":{},\"rawData\":true,\"sheetId\":\"={{ $(\\\"Create new spreadsheet file\\\").first().json[\\\"spreadsheetId\\\"] }}\",\"operation\":\"update\",\"dataProperty\":\"columns\"},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"19\",\"name\":\"Tom's Google Sheets account\"}},\"typeVersion\":2},{\"id\":\"fc9e2c32-30b1-4162-a686-2d049e52e111\",\"name\":\"Wait for spreadsheet creation\",\"type\":\"n8n-nodes-base.merge\",\"position\":[1720,240],\"parameters\":{\"mode\":\"chooseBranch\",\"output\":\"input2\"},\"typeVersion\":2},{\"id\":\"fdc6d5d9-e08d-4086-a233-0edb3c11bc86\",\"name\":\"Write data to sheet\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[1940,240],\"parameters\":{\"options\":{},\"sheetId\":\"={{ $(\\\"Create new spreadsheet file\\\").first().json[\\\"spreadsheetId\\\"] }}\",\"operation\":\"append\"},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"19\",\"name\":\"Tom's Google Sheets account\"}},\"typeVersion\":2}],\"connections\":{\"Write header row\":{\"main\":[[{\"node\":\"Wait for spreadsheet creation\",\"type\":\"main\",\"index\":0}]]},\"Define header row\":{\"main\":[[{\"node\":\"Write header row\",\"type\":\"main\",\"index\":0}]]},\"Download XML File\":{\"main\":[[{\"node\":\"Parse XML content\",\"type\":\"main\",\"index\":0}]]},\"Parse XML content\":{\"main\":[[{\"node\":\"Split out food items\",\"type\":\"main\",\"index\":0}]]},\"Split out food items\":{\"main\":[[{\"node\":\"Create new spreadsheet file\",\"type\":\"main\",\"index\":0},{\"node\":\"Wait for spreadsheet creation\",\"type\":\"main\",\"index\":1}]]},\"On clicking 'execute'\":{\"main\":[[{\"node\":\"Download XML File\",\"type\":\"main\",\"index\":0}]]},\"Create new spreadsheet file\":{\"main\":[[{\"node\":\"Define header row\",\"type\":\"main\",\"index\":0}]]},\"Wait for spreadsheet creation\":{\"main\":[[{\"node\":\"Write data to sheet\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "This workflow shows a low code approach to parsing an XML file and storing its contents in a Google Sheets spreadsheet.\n\n![image.png](https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/image_6f4afeaf74.png)\n\nTo run the workflow:\n\n  * Make sure you are running n8n 0.197 or newer\n  * Have n8n authenticated with Google Sheets\n\n\n\nHow it's done:\n\n  1. This workflow first downloads an example file using the [HTTP Request](https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.httprequest/) node and reads this file using the [XML](https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.xml/) node.  \n![image.png](https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/image_343b1db525.png)\n  2. It then runs the [Item Lists](https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.itemlists/) node to split out the individual `food` items from the example file.\n  3. It then splits up the workflow into a separate branch creating a new spreadsheet file using the [Google Sheets](https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.googlesheets/) node. To read the column names we're using the [Object.keys()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/keys) method inside a [Set](https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.set/) node.\n  4. Once the spreadsheet is created (the workflow waits for this using the [Merge](https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.merge/) node), the data is appended to the newly created sheet (again using the [Google Sheets](https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.googlesheets/) node).\n\n\n",
  "crawled_at": "2025-05-25T20:08:34.873969",
  "readme_zh": "该工作流展示了一种低代码方法，用于解析XML文件并将其内容存储到Google Sheets电子表格中。\n\n![image.png](https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/image_6f4afeaf74.png)\n\n运行此工作流需满足：\n  * 确保使用n8n 0.197或更高版本\n  * 已完成n8n与Google Sheets的授权认证\n\n实现步骤：\n\n1. 工作流首先通过[HTTP请求节点](https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.httprequest/)下载示例文件，并使用[XML节点](https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.xml/)读取内容  \n![image.png](https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/image_343b1db525.png)\n2. 接着运行[项目列表节点](https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.itemlists/)从示例文件中分离出各个`food`条目\n3. 工作流分支出新路径，通过[Google Sheets节点](https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.googlesheets/)创建新电子表格文件。读取列名时，我们在[Set节点](https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.set/)中使用了[Object.keys()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/keys)方法\n4. 电子表格创建完成后（工作流通过[Merge节点](https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.merge/)等待此操作），数据将被追加到新建的工作表中（再次使用[Google Sheets节点](https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.googlesheets/)）",
  "title_zh": "读取XML文件并将内容存储到Google表格中",
  "publish_date_zh": "最后更新于10个月前",
  "workflow_json_zh": "{\"nodes\":[{\"id\":\"d0c92688-14fc-4393-a1d6-926eb867b81e\",\"name\":\"On clicking 'execute'\",\"type\":\"n8n-nodes-base.manualTrigger\",\"position\":[180,240],\"parameters\":{},\"typeVersion\":1},{\"id\":\"0edbad78-249b-441c-877d-bac57fb44a91\",\"name\":\"Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[180,31],\"parameters\":{\"width\":436,\"height\":169,\"content\":\"## n8n 版本说明\\n\\n此工作流基于 n8n 0.197.1 版本创建，采用了新版[表达式语法](https://docs.n8n.io/code-examples/methods-variables-reference/)及升级版合并节点。运行时请确保您的 n8n 版本为 0.197.1 或更高版本。\"},\"typeVersion\":1},{\"id\":\"251d893c-11cb-4702-a289-44f198581722\",\"name\":\"Download XML File\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[400,240],\"parameters\":{\"url\":\"https://www.w3schools.com/xml/simple.xml\",\"options\":{}},\"typeVersion\":3},{\"id\":\"0973b302-1ba9-4faf-9d6c-2caca1b301f5\",\"name\":\"Parse XML content\",\"type\":\"n8n-nodes-base.xml\",\"position\":[620,240],\"parameters\":{\"options\":{}},\"typeVersion\":1},{\"id\":\"01854111-27cb-40c1-b95e-14f91f89e9f1\",\"name\":\"Create new spreadsheet file\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[1060,140],\"parameters\":{\"title\":\"My XML Data\",\"options\":{},\"resource\":\"spreadsheet\"},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"19\",\"name\":\"Tom's Google Sheets account\"}},\"executeOnce\":true,\"typeVersion\":2},{\"id\":\"affbcb81-5873-406e-a51d-cd6fee682992\",\"name\":\"Define header row\",\"type\":\"n8n-nodes-base.set\",\"position\":[1280,140],\"parameters\":{\"values\":{\"string\":[{\"name\":\"columns\",\"value\":\"={{ [ Object.keys($(\\\"Split out food items\\\").first().json) ] }}\"}]},\"options\":{},\"keepOnlySet\":true},\"executeOnce\":true,\"typeVersion\":1},{\"id\":\"537aff03-ae08-4712-bfae-15f0e3a5e69a\",\"name\":\"Split out food items\",\"type\":\"n8n-nodes-base.itemLists\",\"position\":[840,240],\"parameters\":{\"options\":{},\"fieldToSplitOut\":\"breakfast_menu.food\"},\"typeVersion\":1},{\"id\":\"b247f984-6ed2-4de0-8877-a61571863ff8\",\"name\":\"Write header row\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[1500,140],\"parameters\":{\"options\":{},\"rawData\":true,\"sheetId\":\"={{ $(\\\"Create new spreadsheet file\\\").first().json[\\\"spreadsheetId\\\"] }}\",\"operation\":\"update\",\"dataProperty\":\"columns\"},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"19\",\"name\":\"Tom's Google Sheets account\"}},\"typeVersion\":2},{\"id\":\"fc9e2c32-30b1-4162-a686-2d049e52e111\",\"name\":\"Wait for spreadsheet creation\",\"type\":\"n8n-nodes-base.merge\",\"position\":[1720,240],\"parameters\":{\"mode\":\"chooseBranch\",\"output\":\"input2\"},\"typeVersion\":2},{\"id\":\"fdc6d5d9-e08d-4086-a233-0edb3c11bc86\",\"name\":\"Write data to sheet\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[1940,240],\"parameters\":{\"options\":{},\"sheetId\":\"={{ $(\\\"Create new spreadsheet file\\\").first().json[\\\"spreadsheetId\\\"] }}\",\"operation\":\"append\"},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"19\",\"name\":\"Tom's Google Sheets account\"}},\"typeVersion\":2}],\"connections\":{\"Write header row\":{\"main\":[[{\"node\":\"Wait for spreadsheet creation\",\"type\":\"main\",\"index\":0}]]},\"Define header row\":{\"main\":[[{\"node\":\"Write header row\",\"type\":\"main\",\"index\":0}]]},\"Download XML File\":{\"main\":[[{\"node\":\"Parse XML content\",\"type\":\"main\",\"index\":0}]]},\"Parse XML content\":{\"main\":[[{\"node\":\"Split out food items\",\"type\":\"main\",\"index\":0}]]},\"Split out food items\":{\"main\":[[{\"node\":\"Create new spreadsheet file\",\"type\":\"main\",\"index\":0},{\"node\":\"Wait for spreadsheet creation\",\"type\":\"main\",\"index\":1}]]},\"On clicking 'execute'\":{\"main\":[[{\"node\":\"Download XML File\",\"type\":\"main\",\"index\":0}]]},\"Create new spreadsheet file\":{\"main\":[[{\"node\":\"Define header row\",\"type\":\"main\",\"index\":0}]]},\"Wait for spreadsheet creation\":{\"main\":[[{\"node\":\"Write data to sheet\",\"type\":\"main\",\"index\":0}]]}}}"
}