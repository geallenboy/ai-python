{
  "url": "https://n8n.io/workflows/4035-automated-daily-backup-of-n8n-workflows-to-gitlab-repositories/",
  "title": "Automated Daily Backup of n8n Workflows to GitLab Repositories",
  "author": "Akhil Varma Gadiraju",
  "publish_date": "Last update 11 days ago",
  "publish_date_absolute": "2025-05-15",
  "categories": [
    {
      "name": "Engineering"
    },
    {
      "name": "DevOps"
    }
  ],
  "workflow_json": "{\"meta\":{\"instanceId\":\"7d8066d2f56a07000fe7d753d3eeabf0ecdf68413466f30d10afe0906f058427\",\"templateCredsSetupCompleted\":true},\"nodes\":[{\"id\":\"91bb5db7-0bd4-4a17-859a-672515048d9e\",\"name\":\"Globals\",\"type\":\"n8n-nodes-base.set\",\"position\":[-2060,205.5],\"parameters\":{\"fields\":{\"values\":[{\"name\":\"repo.owner\",\"stringValue\":\"={{ $json.owner.username }}\"},{\"name\":\"repo.name\",\"stringValue\":\"={{ $json.name }}\"},{\"name\":\"repo.branch\",\"stringValue\":\"={{ $json.default_branch }}\"},{\"name\":\"repo.path\",\"stringValue\":\"={{ $json.web_url }}\"}]},\"options\":{}},\"typeVersion\":3.2},{\"id\":\"b8ed50c3-3b78-428a-997b-9efc109df984\",\"name\":\"Result\",\"type\":\"n8n-nodes-base.noOp\",\"position\":[-1400,5.5],\"parameters\":{},\"typeVersion\":1},{\"id\":\"04b6d718-d3bd-481c-8b7b-5b1188df2edf\",\"name\":\"Current workflow\",\"type\":\"n8n-nodes-base.noOp\",\"position\":[-1400,205.5],\"parameters\":{},\"typeVersion\":1},{\"id\":\"5db89b68-76d1-461d-a49b-955373359830\",\"name\":\"Loop Over Workflows\",\"type\":\"n8n-nodes-base.splitInBatches\",\"position\":[-1620,205.5],\"parameters\":{\"options\":{}},\"typeVersion\":3},{\"id\":\"8944cbfa-e659-4683-a11f-c3510d0b34dc\",\"name\":\"Get file\",\"type\":\"n8n-nodes-base.gitlab\",\"onError\":\"continueErrorOutput\",\"position\":[-1180,205.5],\"parameters\":{\"owner\":\"={{ $('Globals').first().json.repo.owner }}\",\"filePath\":\"={{ $json.id }}.json\",\"resource\":\"file\",\"operation\":\"get\",\"repository\":\"={{ $('Globals').first().json.repo.name }}\",\"binaryPropertyName\":\"file-from-gitlab\",\"additionalParameters\":{\"reference\":\"={{ $('Globals').first().json.repo.branch }}\"}},\"credentials\":{\"gitlabApi\":{\"id\":\"6NLmdaoq2NsT324y\",\"name\":\"GitLab account\"}},\"executeOnce\":true,\"typeVersion\":1,\"alwaysOutputData\":false},{\"id\":\"10f24280-16ce-406c-b5fe-2d715ed66b0c\",\"name\":\"File status\",\"type\":\"n8n-nodes-base.code\",\"position\":[-520,205.5],\"parameters\":{\"mode\":\"runOnceForEachItem\",\"jsCode\":\"var item = $json;\\n\\n// Check first if is error\\nif (item.error) {\\n  if (\\\"The resource you are requesting could not be found\\\" == item.error) {\\n    item[\\\"status\\\"] = \\\"new\\\";\\n  } else {\\n    item[\\\"status\\\"] = \\\"error\\\";\\n  }\\n  return $input.item;\\n}\\n\\n// If not error check file with saved version\\nvar workflowFromN8n = item[\\\"workflow-from-n8n\\\"];\\nvar workflowFromGitlab = item[\\\"workflow-from-gitlab\\\"];\\nvar areEquals = objectsAreEquals(workflowFromN8n, workflowFromGitlab);\\n\\nif (areEquals) {\\n  item[\\\"status\\\"] = \\\"same\\\";\\n} else {\\n  item[\\\"status\\\"] = \\\"diff\\\";\\n}\\n\\n// Return Item\\nreturn item;\\n\\n/**\\n * Compare to objects\\n * @param object1 \\n * @param object2 \\n * @returns true if the are the same without ignored fields\\n */\\nfunction objectsAreEquals(object1, object2) {\\n  const objectKeys1 = Object.keys(object1);\\n  const objectKeys2 = Object.keys(object2);\\n\\n  // If the numbers of fields are differents, the objects are differents\\n  if (objectKeys1.length !== objectKeys2.length) {\\n    return false;\\n  }\\n  for (const key of objectKeys1) {\\n    // Define some fields to be ignored\\n    var ignoreCurrent = false;\\n    switch (key) {\\n      case \\\"updatedAt\\\": // Changed because workflow change... not usefull\\n      case \\\"global\\\": // changed for running reasons, no need to check\\n        ignoreCurrent = true;\\n    }\\n\\n    // If it's not an ignored field\\n    if (!ignoreCurrent) {\\n      const value1 = object1[key];\\n      const value2 = object2[key];\\n      const isBothAreObjects = isObject(value1) && isObject(value2);\\n\\n      // If it's objects recursive check\\n      if (isBothAreObjects && !objectsAreEquals(value1, value2)) {\\n        return false;\\n      }\\n\\n      // If it's not objects, just compare values\\n      if (!isBothAreObjects && value1 != value2) {\\n        return false;\\n      }\\n    }\\n  }\\n  return true;\\n}\\n\\n/**\\n * Tool function to determine if an parameter is an object\\n * @param object \\n * @returns \\n */\\nfunction isObject(object) {\\n  return object !== null && typeof object === \\\"object\\\";\\n}\\n\"},\"typeVersion\":2},{\"id\":\"548ae4ec-3d45-4880-a9a0-2abe48831e88\",\"name\":\"Status error\",\"type\":\"n8n-nodes-base.set\",\"position\":[140,80.5],\"parameters\":{\"fields\":{\"values\":[{\"name\":\"name\",\"stringValue\":\"={{ $('Current workflow').item.json.name }}\"},{\"name\":\"status\",\"stringValue\":\"=Error : {{ $json.error }}\"}]},\"include\":\"none\",\"options\":{}},\"typeVersion\":3.2},{\"id\":\"06b4fe3e-ca4b-4ad5-a2dc-ca68ac74e7e5\",\"name\":\"End Loop\",\"type\":\"n8n-nodes-base.noOp\",\"position\":[360,370],\"parameters\":{},\"typeVersion\":1},{\"id\":\"1b5df0b1-9f85-422c-9ad7-4020086d49a1\",\"name\":\"Create file\",\"type\":\"n8n-nodes-base.gitlab\",\"onError\":\"continueErrorOutput\",\"position\":[-80,-119.5],\"parameters\":{\"owner\":\"={{ $('Globals').first().json.repo.owner }}\",\"branch\":\"={{ $('Globals').first().json.repo.branch }}\",\"filePath\":\"={{ $json.id }}.json\",\"resource\":\"file\",\"repository\":\"={{ $('Globals').first().json.repo.name }}\",\"fileContent\":\"={{ JSON.stringify($('Current workflow').item.json, null, 4) }}\",\"commitMessage\":\"=Create file for workflow {{ $('Current workflow').item.json.name }}\",\"additionalParameters\":{\"author\":{\"name\":\"n8n\",\"email\":\"akhil@nuevesolutions.com\"}}},\"credentials\":{\"gitlabApi\":{\"id\":\"6NLmdaoq2NsT324y\",\"name\":\"GitLab account\"}},\"executeOnce\":true,\"typeVersion\":1,\"alwaysOutputData\":false},{\"id\":\"06c2150b-491c-4b44-9b43-88b1e1df5793\",\"name\":\"Extract From File\",\"type\":\"n8n-nodes-base.extractFromFile\",\"position\":[-960,105.5],\"parameters\":{\"options\":{},\"operation\":\"fromJson\",\"destinationKey\":\"workflow-from-gitlab\",\"binaryPropertyName\":\"file-from-gitlab\"},\"typeVersion\":1},{\"id\":\"6a9b5a29-6874-433c-849a-97e37bfba40d\",\"name\":\"Switch\",\"type\":\"n8n-nodes-base.switch\",\"position\":[-300,184.5],\"parameters\":{\"rules\":{\"values\":[{\"outputKey\":\"new\",\"conditions\":{\"options\":{\"version\":1,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"9cd88022-6d97-409f-a37e-ae6b02b6269b\",\"operator\":{\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $json.status }}\",\"rightValue\":\"new\"}]},\"renameOutput\":true},{\"outputKey\":\"same\",\"conditions\":{\"options\":{\"version\":1,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"0ff6e053-e89d-49fa-b8c8-3a51ffe016d8\",\"operator\":{\"name\":\"filter.operator.equals\",\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $json.status }}\",\"rightValue\":\"same\"}]},\"renameOutput\":true},{\"outputKey\":\"diff\",\"conditions\":{\"options\":{\"version\":1,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"b6b954c3-e74c-4f60-8e9e-ac79d4b741f3\",\"operator\":{\"name\":\"filter.operator.equals\",\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $json.status }}\",\"rightValue\":\"diff\"}]},\"renameOutput\":true}]},\"options\":{\"fallbackOutput\":\"extra\",\"renameFallbackOutput\":\"error\"}},\"typeVersion\":3},{\"id\":\"84a7f4b9-b76e-41ee-8413-26fb095627a8\",\"name\":\"New file version\",\"type\":\"n8n-nodes-base.gitlab\",\"onError\":\"continueErrorOutput\",\"position\":[-80,280.5],\"parameters\":{\"owner\":\"={{ $('Globals').first().json.repo.owner }}\",\"branch\":\"={{ $('Globals').first().json.repo.branch }}\",\"filePath\":\"={{ $json['workflow-from-n8n'].id }}.json\",\"resource\":\"file\",\"operation\":\"edit\",\"repository\":\"={{ $('Globals').first().json.repo.name }}\",\"fileContent\":\"={{ JSON.stringify($json['workflow-from-n8n'], null, 4) }}\",\"commitMessage\":\"=New file version for workflow {{ $json['workflow-from-n8n'].name }}\"},\"credentials\":{\"gitlabApi\":{\"id\":\"6NLmdaoq2NsT324y\",\"name\":\"GitLab account\"}},\"executeOnce\":true,\"typeVersion\":1,\"alwaysOutputData\":false},{\"id\":\"ec89cb60-e144-4b77-bea8-e32122a32ea1\",\"name\":\"Error output to normal output\",\"type\":\"n8n-nodes-base.noOp\",\"position\":[-740,520],\"parameters\":{},\"typeVersion\":1},{\"id\":\"f11d589b-ad66-4347-b9e8-6e56f003de5c\",\"name\":\"Status diff\",\"type\":\"n8n-nodes-base.set\",\"position\":[140,330.5],\"parameters\":{\"fields\":{\"values\":[{\"name\":\"name\",\"stringValue\":\"={{ $('Current workflow').item.json.name }}\"},{\"name\":\"status\",\"stringValue\":\"diff\"}]},\"include\":\"none\",\"options\":{}},\"typeVersion\":3.2},{\"id\":\"67a1dfc1-f35e-4854-a61b-f9ba947d6371\",\"name\":\"Status same\",\"type\":\"n8n-nodes-base.set\",\"position\":[140,530.5],\"parameters\":{\"fields\":{\"values\":[{\"name\":\"name\",\"stringValue\":\"={{ $('Current workflow').item.json.name }}\"},{\"name\":\"status\",\"stringValue\":\"same\"}]},\"include\":\"none\",\"options\":{}},\"typeVersion\":3.2},{\"id\":\"d788fe7a-c713-426b-b15b-9e3fb806c8f4\",\"name\":\"Retrieve all workflows\",\"type\":\"n8n-nodes-base.n8n\",\"position\":[-1840,205.5],\"parameters\":{\"filters\":{},\"requestOptions\":{}},\"credentials\":{\"n8nApi\":{\"id\":\"Hp7Xh2HuDWQAiZR6\",\"name\":\"n8n account\"}},\"typeVersion\":1},{\"id\":\"19cd98bf-f055-43af-a86b-d0d77a331606\",\"name\":\"Save each version in a different field\",\"type\":\"n8n-nodes-base.set\",\"position\":[-740,105.5],\"parameters\":{\"fields\":{\"values\":[{\"name\":\"workflow-from-gitlab\",\"type\":\"objectValue\",\"objectValue\":\"={{ $json['workflow-from-gitlab'] }}\"},{\"name\":\"workflow-from-n8n\",\"type\":\"objectValue\",\"objectValue\":\"={{ $('Current workflow').item.json }}\"}]},\"options\":{}},\"typeVersion\":3.2},{\"id\":\"5b62ca2a-af1b-4d47-8750-526efe24949d\",\"name\":\"Schedule Trigger\",\"type\":\"n8n-nodes-base.scheduleTrigger\",\"position\":[-2500,205.5],\"parameters\":{\"rule\":{\"interval\":[{}]}},\"typeVersion\":1.2},{\"id\":\"e0db3d90-cdbe-4854-968c-2bde224dd759\",\"name\":\"GitLab\",\"type\":\"n8n-nodes-base.gitlab\",\"position\":[-2280,205.5],\"parameters\":{\"owner\":\"{{change this to owner eg: akhil}}\",\"resource\":\"repository\",\"operation\":\"get\",\"repository\":\"n8n-workflows\"},\"credentials\":{\"gitlabApi\":{\"id\":\"6NLmdaoq2NsT324y\",\"name\":\"GitLab account\"}},\"typeVersion\":1}],\"pinData\":{},\"connections\":{\"GitLab\":{\"main\":[[{\"node\":\"Globals\",\"type\":\"main\",\"index\":0}]]},\"Switch\":{\"main\":[[{\"node\":\"Create file\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Status same\",\"type\":\"main\",\"index\":0}],[{\"node\":\"New file version\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Status error\",\"type\":\"main\",\"index\":0}]]},\"Globals\":{\"main\":[[{\"node\":\"Retrieve all workflows\",\"type\":\"main\",\"index\":0}]]},\"End Loop\":{\"main\":[[{\"node\":\"Loop Over Workflows\",\"type\":\"main\",\"index\":0}]]},\"Get file\":{\"main\":[[{\"node\":\"Extract From File\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Error output to normal output\",\"type\":\"main\",\"index\":0}]]},\"Create file\":{\"main\":[[],[{\"node\":\"Status error\",\"type\":\"main\",\"index\":0}]]},\"File status\":{\"main\":[[{\"node\":\"Switch\",\"type\":\"main\",\"index\":0}]]},\"Status diff\":{\"main\":[[{\"node\":\"End Loop\",\"type\":\"main\",\"index\":0}]]},\"Status same\":{\"main\":[[{\"node\":\"End Loop\",\"type\":\"main\",\"index\":0}]]},\"Status error\":{\"main\":[[{\"node\":\"End Loop\",\"type\":\"main\",\"index\":0}]]},\"Current workflow\":{\"main\":[[{\"node\":\"Get file\",\"type\":\"main\",\"index\":0}]]},\"New file version\":{\"main\":[[{\"node\":\"Status diff\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Status error\",\"type\":\"main\",\"index\":0}]]},\"Schedule Trigger\":{\"main\":[[{\"node\":\"GitLab\",\"type\":\"main\",\"index\":0}]]},\"Extract From File\":{\"main\":[[{\"node\":\"Save each version in a different field\",\"type\":\"main\",\"index\":0}]]},\"Loop Over Workflows\":{\"main\":[[{\"node\":\"Result\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Current workflow\",\"type\":\"main\",\"index\":0}]]},\"Retrieve all workflows\":{\"main\":[[{\"node\":\"Loop Over Workflows\",\"type\":\"main\",\"index\":0}]]},\"Error output to normal output\":{\"main\":[[{\"node\":\"File status\",\"type\":\"main\",\"index\":0}]]},\"Save each version in a different field\":{\"main\":[[{\"node\":\"File status\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "# n8n Workflow: Sync Workflows with GitLab\n\n## How It Works\n\nThis workflow ensures that your self-hosted n8n workflows are version-controlled in a GitLab repository. It compares each current workflow from n8n with its stored counterpart in GitLab. If any differences are detected, the GitLab file is updated with the latest version.\n\n### Core Logic:\n\n  1. **Retrieve Workflows** – Fetch all workflows from the n8n REST API.\n\n  2. **Compare with GitLab** – For each workflow, fetch the corresponding file from GitLab and compare the JSON.\n\n  3. **Update if Changed** – If differences exist, commit the updated workflow to GitLab using its API.\n\n\n\n\n* * *\n\n## Setup\n\nBefore using the workflow, ensure the following:\n\n### Prerequisites:\n\n  * **n8n** : Self-hosted instance with access to the `/rest/workflows` API.\n\n  * **GitLab** : A repository where workflows will be stored, and a Personal Access Token (PAT) with `api` and `write_repository` permissions.\n\n  * **n8n Nodes Required** :\n\n    * HTTP Request (to call n8n and GitLab APIs)\n    * Code or Function nodes (for diffing and formatting)\n    * Looping (`SplitInBatches` or similar)\n\n\n\n### Configuration:\n\n  * Set environment variables or workflow credentials for: \n    * `GITLAB_TOKEN`\n    * `GITLAB_REPO`\n    * `GITLAB_BRANCH` (e.g., `main`)\n    * `GITLAB_FILE_PATH_PREFIX` (e.g., `n8n-workflows/`)\n\n\n\n* * *\n\n## How to Use\n\n  1. **Import the Workflow** into your n8n instance.\n\n  2. **Configure GitLab API Credentials** :\n\n     * Set the GitLab PAT as a header in the HTTP\n\n\n\nRequest node:  \n`Private-Token: {{ $env.GITLAB_TOKEN }}`\n\n  1. **Map Workflows to GitLab Paths** :\n\n     * Use the workflow name or ID to create the file path. Example:  \n`n8n-workflows/workflow-name.json`\n  2. **Trigger the Workflow** :\n\n     * Can be manually triggered, or scheduled to run at intervals (e.g., daily).\n  3. **Review Commits in GitLab** :\n\n     * Each updated workflow will be committed with a message like:  \n`\"Update workflow: Sample Workflow\"`\n\n\n\n* * *\n\n## Disclaimer\n\n  * This workflow does **not** handle merge conflicts or manual edits made directly in GitLab. Always ensure proper coordination if multiple sources are modifying workflows.\n  * Only structural changes are tracked. Non-functional metadata (like timestamps or IDs) may trigger false positives unless filtered.\n  * Use at your own risk. Test in a safe environment before applying to production workflows.\n\n\n\n* * *\n",
  "crawled_at": "2025-05-26T06:19:41.224259",
  "readme_zh": "# n8n工作流：与GitLab同步工作流\n\n## 工作原理\n\n该工作流确保您自托管的n8n工作流在GitLab仓库中进行版本控制。它会将n8n中每个当前工作流与GitLab中存储的对应文件进行比较。如果检测到差异，GitLab文件将更新为最新版本。\n\n### 核心逻辑：\n\n1. **获取工作流** - 从n8n REST API获取所有工作流。\n\n2. **与GitLab比较** - 对于每个工作流，从GitLab获取相应文件并比较JSON内容。\n\n3. **变更时更新** - 如果存在差异，则使用GitLab API提交更新后的工作流。\n\n* * *\n\n## 设置\n\n使用工作流前，请确保满足以下条件：\n\n### 前提条件：\n\n* **n8n**：可访问`/rest/workflows`API的自托管实例。\n\n* **GitLab**：用于存储工作流的仓库，以及具有`api`和`write_repository`权限的个人访问令牌(PAT)。\n\n* **所需n8n节点**：\n  * HTTP请求节点（用于调用n8n和GitLab API）\n  * 代码或函数节点（用于差异比较和格式化）\n  * 循环节点（如`SplitInBatches`或类似功能）\n\n### 配置：\n\n* 设置环境变量或工作流凭证：\n  * `GITLAB_TOKEN`\n  * `GITLAB_REPO`\n  * `GITLAB_BRANCH`（例如`main`）\n  * `GITLAB_FILE_PATH_PREFIX`（例如`n8n-workflows/`）\n\n* * *\n\n## 使用方法\n\n1. **将工作流导入**到您的n8n实例。\n\n2. **配置GitLab API凭证**：\n   * 在HTTP请求节点中设置GitLab PAT为头部：\n   `Private-Token: {{ $env.GITLAB_TOKEN }}`\n\n3. **映射工作流到GitLab路径**：\n   * 使用工作流名称或ID创建文件路径。例如：\n   `n8n-workflows/workflow-name.json`\n\n4. **触发工作流**：\n   * 可手动触发，或设置为定期运行（如每日）。\n\n5. **在GitLab中查看提交**：\n   * 每个更新的工作流将附带类似提交信息：\n   `\"更新工作流：示例工作流\"`\n\n* * *\n\n## 免责声明\n\n* 该工作流**不**处理合并冲突或直接在GitLab中进行的手动编辑。如果有多方同时修改工作流，请确保协调一致。\n* 仅跟踪结构性变更。非功能性元数据（如时间戳或ID）可能会触发误报，除非进行过滤。\n* 使用风险自负。在生产环境应用前，请先在安全环境中测试。",
  "title_zh": "n8n工作流每日自动备份至GitLab仓库",
  "publish_date_zh": "上次更新于11天前",
  "workflow_json_zh": "{\n  \"meta\": {\n    \"instanceId\": \"7d8066d2f56a07000fe7d753d3eeabf0ecdf68413466f30d10afe0906f058427\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"nodes\": [\n    {\n      \"id\": \"91bb5db7-0bd4-4a17-859a-672515048d9e\",\n      \"name\": \"Globals\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        -2060,\n        205.5\n      ],\n      \"parameters\": {\n        \"fields\": {\n          \"values\": [\n            {\n              \"name\": \"repo.owner\",\n              \"stringValue\": \"={{ $json.owner.username }}\"\n            },\n            {\n              \"name\": \"repo.name\",\n              \"stringValue\": \"={{ $json.name }}\"\n            },\n            {\n              \"name\": \"repo.branch\",\n              \"stringValue\": \"={{ $json.default_branch }}\"\n            },\n            {\n              \"name\": \"repo.path\",\n              \"stringValue\": \"={{ $json.web_url }}\"\n            }\n          ]\n        },\n        \"options\": {}\n      },\n      \"typeVersion\": 3.2\n    },\n    {\n      \"id\": \"b8ed50c3-3b78-428a-997b-9efc109df984\",\n      \"name\": \"Result\",\n      \"type\": \"n8n-nodes-base.noOp\",\n      \"position\": [\n        -1400,\n        5.5\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"04b6d718-d3bd-481c-8b7b-5b1188df2edf\",\n      \"name\": \"Current workflow\",\n      \"type\": \"n8n-nodes-base.noOp\",\n      \"position\": [\n        -1400,\n        205.5\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"5db89b68-76d1-461d-a49b-955373359830\",\n      \"name\": \"Loop Over Workflows\",\n      \"type\": \"n8n-nodes-base.splitInBatches\",\n      \"position\": [\n        -1620,\n        205.5\n      ],\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"8944cbfa-e659-4683-a11f-c3510d0b34dc\",\n      \"name\": \"Get file\",\n      \"type\": \"n8n-nodes-base.gitlab\",\n      \"onError\": \"continueErrorOutput\",\n      \"position\": [\n        -1180,\n        205.5\n      ],\n      \"parameters\": {\n        \"owner\": \"={{ $('Globals').first().json.repo.owner }}\",\n        \"filePath\": \"={{ $json.id }}.json\",\n        \"resource\": \"file\",\n        \"operation\": \"get\",\n        \"repository\": \"={{ $('Globals').first().json.repo.name }}\",\n        \"binaryPropertyName\": \"file-from-gitlab\",\n        \"additionalParameters\": {\n          \"reference\": \"={{ $('Globals').first().json.repo.branch }}\"\n        }\n      },\n      \"credentials\": {\n        \"gitlabApi\": {\n          \"id\": \"6NLmdaoq2NsT324y\",\n          \"name\": \"GitLab account\"\n        }\n      },\n      \"executeOnce\": true,\n      \"typeVersion\": 1,\n      \"alwaysOutputData\": false\n    },\n    {\n      \"id\": \"10f24280-16ce-406c-b5fe-2d715ed66b0c\",\n      \"name\": \"File status\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        -520,\n        205.5\n      ],\n      \"parameters\": {\n        \"mode\": \"runOnceForEachItem\",\n        \"jsCode\": \"var item = $json;\\n\\n// Check first if is error\\nif (item.error) {\\n  if (\\\"The resource you are requesting could not be found\\\" == item.error) {\\n    item[\\\"status\\\"] = \\\"new\\\";\\n  } else {\\n    item[\\\"status\\\"] = \\\"error\\\";\\n  }\\n  return $input.item;\\n}\\n\\n// If not error check file with saved version\\nvar workflowFromN8n = item[\\\"workflow-from-n8n\\\"];\\nvar workflowFromGitlab = item[\\\"workflow-from-gitlab\\\"];\\nvar areEquals = objectsAreEquals(workflowFromN8n, workflowFromGitlab);\\n\\nif (areEquals) {\\n  item[\\\"status\\\"] = \\\"same\\\";\\n} else {\\n  item[\\\"status\\\"] = \\\"diff\\\";\\n}\\n\\n// Return Item\\nreturn item;\\n\\n/**\\n * Compare to objects\\n * @param object1 \\n * @param object2 \\n * @returns true if the are the same without ignored fields\\n */\\nfunction objectsAreEquals(object1, object2) {\\n  const objectKeys1 = Object.keys(object1);\\n  const objectKeys2 = Object.keys(object2);\\n\\n  // If the numbers of fields are differents, the objects are differents\\n  if (objectKeys1.length !== objectKeys2.length) {\\n    return false;\\n  }\\n  for (const key of objectKeys1) {\\n    // Define some fields to be ignored\\n    var ignoreCurrent = false;\\n    switch (key) {\\n      case \\\"updatedAt\\\": // Changed because workflow change... not usefull\\n      case \\\"global\\\": // changed for running reasons, no need to check\\n        ignoreCurrent = true;\\n    }\\n\\n    // If it's not an ignored field\\n    if (!ignoreCurrent) {\\n      const value1 = object1[key];\\n      const value2 = object2[key];\\n      const isBothAreObjects = isObject(value1) && isObject(value2);\\n\\n      // If it's objects recursive check\\n      if (isBothAreObjects && !objectsAreEquals(value1, value2)) {\\n        return false;\\n      }\\n\\n      // If it's not objects, just compare values\\n      if (!isBothAreObjects && value1 != value2) {\\n        return false;\\n      }\\n    }\\n  }\\n  return true;\\n}\\n\\n/**\\n * Tool function to determine if an parameter is an object\\n * @param object \\n * @returns \\n */\\nfunction isObject(object) {\\n  return object !== null && typeof object === \\\"object\\\";\\n}\\n\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"548ae4ec-3d45-4880-a9a0-2abe48831e88\",\n      \"name\": \"Status error\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        140,\n        80.5\n      ],\n      \"parameters\": {\n        \"fields\": {\n          \"values\": [\n            {\n              \"name\": \"name\",\n              \"stringValue\": \"={{ $('Current workflow').item.json.name }}\"\n            },\n            {\n              \"name\": \"status\",\n              \"stringValue\": \"=Error : {{ $json.error }}\"\n            }\n          ]\n        },\n        \"include\": \"none\",\n        \"options\": {}\n      },\n      \"typeVersion\": 3.2\n    },\n    {\n      \"id\": \"06b4fe3e-ca4b-4ad5-a2dc-ca68ac74e7e5\",\n      \"name\": \"End Loop\",\n      \"type\": \"n8n-nodes-base.noOp\",\n      \"position\": [\n        360,\n        370\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"1b5df0b1-9f85-422c-9ad7-4020086d49a1\",\n      \"name\": \"Create file\",\n      \"type\": \"n8n-nodes-base.gitlab\",\n      \"onError\": \"continueErrorOutput\",\n      \"position\": [\n        -80,\n        -119.5\n      ],\n      \"parameters\": {\n        \"owner\": \"={{ $('Globals').first().json.repo.owner }}\",\n        \"branch\": \"={{ $('Globals').first().json.repo.branch }}\",\n        \"filePath\": \"={{ $json.id }}.json\",\n        \"resource\": \"file\",\n        \"repository\": \"={{ $('Globals').first().json.repo.name }}\",\n        \"fileContent\": \"={{ JSON.stringify($('Current workflow').item.json, null, 4) }}\",\n        \"commitMessage\": \"=Create file for workflow {{ $('Current workflow').item.json.name }}\",\n        \"additionalParameters\": {\n          \"author\": {\n            \"name\": \"n8n\",\n            \"email\": \"akhil@nuevesolutions.com\"\n          }\n        }\n      },\n      \"credentials\": {\n        \"gitlabApi\": {\n          \"id\": \"6NLmdaoq2NsT324y\",\n          \"name\": \"GitLab account\"\n        }\n      },\n      \"executeOnce\": true,\n      \"typeVersion\": 1,\n      \"alwaysOutputData\": false\n    },\n    {\n      \"id\": \"06c2150b-491c-4b44-9b43-88b1e1df5793\",\n      \"name\": \"Extract From File\",\n      \"type\": \"n8n-nodes-base.extractFromFile\",\n      \"position\": [\n        -960,\n        105.5\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"operation\": \"fromJson\",\n        \"destinationKey\": \"workflow-from-gitlab\",\n        \"binaryPropertyName\": \"file-from-gitlab\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"6a9b5a29-6874-433c-849a-97e37bfba40d\",\n      \"name\": \"Switch\",\n      \"type\": \"n8n-nodes-base.switch\",\n      \"position\": [\n        -300,\n        184.5\n      ],\n      \"parameters\": {\n        \"rules\": {\n          \"values\": [\n            {\n              \"outputKey\": \"new\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 1,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"9cd88022-6d97-409f-a37e-ae6b02b6269b\",\n                    \"operator\": {\n                      \"type\": \"string\",\n                      \"operation\": \"equals\"\n                    },\n                    \"leftValue\": \"={{ $json.status }}\",\n                    \"rightValue\": \"new\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            },\n            {\n              \"outputKey\": \"same\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 1,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"0ff6e053-e89d-49fa-b8c8-3a51ffe016d8\",\n                    \"operator\": {\n                      \"name\": \"filter.operator.equals\",\n                      \"type\": \"string\",\n                      \"operation\": \"equals\"\n                    },\n                    \"leftValue\": \"={{ $json.status }}\",\n                    \"rightValue\": \"same\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            },\n            {\n              \"outputKey\": \"diff\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 1,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"b6b954c3-e74c-4f60-8e9e-ac79d4b741f3\",\n                    \"operator\": {\n                      \"name\": \"filter.operator.equals\",\n                      \"type\": \"string\",\n                      \"operation\": \"equals\"\n                    },\n                    \"leftValue\": \"={{ $json.status }}\",\n                    \"rightValue\": \"diff\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            }\n          ]\n        },\n        \"options\": {\n          \"fallbackOutput\": \"extra\",\n          \"renameFallbackOutput\": \"error\"\n        }\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"84a7f4b9-b76e-41ee-8413-26fb095627a8\",\n      \"name\": \"New file version\",\n      \"type\": \"n8n-nodes-base.gitlab\",\n      \"onError\": \"continueErrorOutput\",\n      \"position\": [\n        -80,\n        280.5\n      ],\n      \"parameters\": {\n        \"owner\": \"={{ $('Globals').first().json.repo.owner }}\",\n        \"branch\": \"={{ $('Globals').first().json.repo.branch }}\",\n        \"filePath\": \"={{ $json['workflow-from-n8n'].id }}.json\",\n        \"resource\": \"file\",\n        \"operation\": \"edit\",\n        \"repository\": \"={{ $('Globals').first().json.repo.name }}\",\n        \"fileContent\": \"={{ JSON.stringify($json['workflow-from-n8n'], null, 4) }}\",\n        \"commitMessage\": \"=New file version for workflow {{ $json['workflow-from-n8n'].name }}\"\n      },\n      \"credentials\": {\n        \"gitlabApi\": {\n          \"id\": \"6NLmdaoq2NsT324y\",\n          \"name\": \"GitLab account\"\n        }\n      },\n      \"executeOnce\": true,\n      \"typeVersion\": 1,\n      \"alwaysOutputData\": false\n    },\n    {\n      \"id\": \"ec89cb60-e144-4b77-bea8-e32122a32ea1\",\n      \"name\": \"Error output to normal output\",\n      \"type\": \"n8n-nodes-base.noOp\",\n      \"position\": [\n        -740,\n        520\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"f11d589b-ad66-4347-b9e8-6e56f003de5c\",\n      \"name\": \"Status diff\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        140,\n        330.5\n      ],\n      \"parameters\": {\n        \"fields\": {\n          \"values\": [\n            {\n              \"name\": \"name\",\n              \"stringValue\": \"={{ $('Current workflow').item.json.name }}\"\n            },\n            {\n              \"name\": \"status\",\n              \"stringValue\": \"diff\"\n            }\n          ]\n        },\n        \"include\": \"none\",\n        \"options\": {}\n      },\n      \"typeVersion\": 3.2\n    },\n    {\n      \"id\": \"67a1dfc1-f35e-4854-a61b-f9ba947d6371\",\n      \"name\": \"Status same\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        140,\n        530.5\n      ],\n      \"parameters\": {\n        \"fields\": {\n          \"values\": [\n            {\n              \"name\": \"name\",\n              \"stringValue\": \"={{ $('Current workflow').item.json.name }}\"\n            },\n            {\n              \"name\": \"status\",\n              \"stringValue\": \"same\"\n            }\n          ]\n        },\n        \"include\": \"none\",\n        \"options\": {}\n      },\n      \"typeVersion\": 3.2\n    },\n    {\n      \"id\": \"d788fe7a-c713-426b-b15b-9e3fb806c8f4\",\n      \"name\": \"Retrieve all workflows\",\n      \"type\": \"n8n-nodes-base.n8n\",\n      \"position\": [\n        -1840,\n        205.5\n      ],\n      \"parameters\": {\n        \"filters\": {},\n        \"requestOptions\": {}\n      },\n      \"credentials\": {\n        \"n8nApi\": {\n          \"id\": \"Hp7Xh2HuDWQAiZR6\",\n          \"name\": \"n8n account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"19cd98bf-f055-43af-a86b-d0d77a331606\",\n      \"name\": \"Save each version in a different field\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        -740,\n        105.5\n      ],\n      \"parameters\": {\n        \"fields\": {\n          \"values\": [\n            {\n              \"name\": \"workflow-from-gitlab\",\n              \"type\": \"objectValue\",\n              \"objectValue\": \"={{ $json['workflow-from-gitlab'] }}\"\n            },\n            {\n              \"name\": \"workflow-from-n8n\",\n              \"type\": \"objectValue\",\n              \"objectValue\": \"={{ $('Current workflow').item.json }}\"\n            }\n          ]\n        },\n        \"options\": {}\n      },\n      \"typeVersion\": 3.2\n    },\n    {\n      \"id\": \"5b62ca2a-af1b-4d47-8750-526efe24949d\",\n      \"name\": \"Schedule Trigger\",\n      \"type\": \"n8n-nodes-base.scheduleTrigger\",\n      \"position\": [\n        -2500,\n        205.5\n      ],\n      \"parameters\": {\n        \"rule\": {\n          \"interval\": [\n            {}\n          ]\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"e0db3d90-cdbe-4854-968c-2bde224dd759\",\n      \"name\": \"GitLab\",\n      \"type\": \"n8n-nodes-base.gitlab\",\n      \"position\": [\n        -2280,\n        205.5\n      ],\n      \"parameters\": {\n        \"owner\": \"{{change this to owner eg: akhil}}\",\n        \"resource\": \"repository\",\n        \"operation\": \"get\",\n        \"repository\": \"n8n-workflows\"\n      },\n      \"credentials\": {\n        \"gitlabApi\": {\n          \"id\": \"6NLmdaoq2NsT324y\",\n          \"name\": \"GitLab account\"\n        }\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"pinData\": {},\n  \"connections\": {\n    \"GitLab\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Globals\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Switch\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Create file\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Status same\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"New file version\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Status error\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Globals\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Retrieve all workflows\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"End Loop\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Loop Over Workflows\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get file\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Extract From File\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Error output to normal output\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Create file\": {\n      \"main\": [\n        [],\n        [\n          {\n            \"node\": \"Status error\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"File status\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Switch\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Status diff\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"End Loop\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Status same\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"End Loop\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Status error\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"End Loop\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Current workflow\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get file\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"New file version\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Status diff\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Status error\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Schedule Trigger\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"GitLab\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Extract From File\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Save each version in a different field\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Loop Over Workflows\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Result\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Current workflow\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Retrieve all workflows\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Loop Over Workflows\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Error output to normal output\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"File status\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Save each version in a different field\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"File status\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}