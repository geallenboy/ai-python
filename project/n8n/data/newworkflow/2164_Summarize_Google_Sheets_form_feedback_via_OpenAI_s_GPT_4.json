{
  "url": "https://n8n.io/workflows/2164-summarize-google-sheets-form-feedback-via-openais-gpt-4/",
  "title": "Summarize Google Sheets form feedback via OpenAI's GPT-4",
  "author": "Yulia",
  "publish_date": "Last update a year ago",
  "publish_date_absolute": "",
  "categories": [
    {
      "name": "AI"
    }
  ],
  "workflow_json": "{\"id\":\"Lwvu2jjMU2irTyAY\",\"meta\":{\"instanceId\":\"fb924c73af8f703905bc09c9ee8076f48c17b596ed05b18c0ff86915ef8a7c4a\"},\"name\":\"Summarize Google Sheets form feedback via OpenAI's GPT-4\",\"tags\":[{\"id\":\"y9tvM3hISJKT2jeo\",\"name\":\"Ted's Tech Talks\",\"createdAt\":\"2023-08-15T22:12:34.260Z\",\"updatedAt\":\"2023-08-15T22:12:34.260Z\"}],\"nodes\":[{\"id\":\"cd80cd2f-a6e1-48eb-ba05-0f8f1a0875e5\",\"name\":\"When clicking \\\"Test workflow\\\"\",\"type\":\"n8n-nodes-base.manualTrigger\",\"position\":[680,320],\"parameters\":{},\"typeVersion\":1},{\"id\":\"9f03f1c4-c47e-4eda-bc0a-a598c21e4616\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[640,130],\"parameters\":{\"width\":369.1031874662338,\"height\":349,\"content\":\"### 1. Create a Google Sheet document\\n* This tutorial uses Google Sheet document connected to Google Forms, but a standalone Sheet document will work too\\n* Adapt initial trigger to your needs: run manually or at some time intervals\\n\\n[Link to the Google Sheets template](https://docs.google.com/spreadsheets/d/1Kcr1oF_RrfNQJczmJDpwClOSYpvSnwbeX-_pdUo91-I/edit?usp=sharing)\"},\"typeVersion\":1},{\"id\":\"1e478f81-76e7-4fc3-a147-11a92d3f9998\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1040,160],\"parameters\":{\"width\":394,\"height\":319,\"content\":\"### 2. Combine all answers into an array\\n* Since the main goal is to provide an overall summary, we need to combine all answers for each Google Form question\\n* Aggregate Node takes multiple incoming items and produces just a single item which contains arrays of user feedback\"},\"typeVersion\":1},{\"id\":\"1ab06b51-3b9e-4a4c-afba-c98e529a636c\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1480,160],\"parameters\":{\"width\":432,\"height\":319,\"content\":\"### 3. Generate a summary report\\n* Enter a __system message__ with a overall instructions on how to analyze the feedback form\\n* Provide a __user message__ with JSON arrays.\\n\\n__NB! Consider splitting the form questions for a very long forms or when the number of responses is too high__\"},\"typeVersion\":1},{\"id\":\"ce0118a3-4eaf-4d60-adf0-5bde5d41328a\",\"name\":\"Sticky Note3\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1940,160],\"parameters\":{\"width\":359.1031874662346,\"height\":319,\"content\":\"### 4. Convert to HTML and send an email\\n* GPT is configured to reply in Markdown format. Markdown Node converts such text into HTML\\n* Finally, the Gmail node sends a message with HTML report\"},\"typeVersion\":1},{\"id\":\"37bc8ab5-328c-4f50-bbda-f7482bf36522\",\"name\":\"Get Google Sheets records\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[860,320],\"parameters\":{\"options\":{},\"sheetName\":{\"__rl\":true,\"mode\":\"list\",\"value\":2035968519,\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1Kcr1oF_RrfNQJczmJDpwClOSYpvSnwbeX-_pdUo91-I/edit#gid=2035968519\",\"cachedResultName\":\"Form Responses 1\"},\"documentId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"1Kcr1oF_RrfNQJczmJDpwClOSYpvSnwbeX-_pdUo91-I\",\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1Kcr1oF_RrfNQJczmJDpwClOSYpvSnwbeX-_pdUo91-I/edit?usp=drivesdk\",\"cachedResultName\":\"Event feedback form (Responses)\"}},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"RtRiRezoxiWkzZQt\",\"name\":\"Ted's Tech Talks Google account\"}},\"typeVersion\":4.2},{\"id\":\"d75b11b1-2cce-40c2-ab5a-d18fdf7f5283\",\"name\":\"Aggregate responses into arrays\",\"type\":\"n8n-nodes-base.aggregate\",\"position\":[1200,320],\"parameters\":{\"options\":{},\"fieldsToAggregate\":{\"fieldToAggregate\":[{\"fieldToAggregate\":\"['What went great?']\"},{\"fieldToAggregate\":\"['How can we improve?']\"},{\"fieldToAggregate\":\"['What is the chance of recommending our event?']\"}]}},\"typeVersion\":1},{\"id\":\"a90f83fe-809b-42db-b65d-43fb11b2979a\",\"name\":\"Summarize via GPT model\",\"type\":\"n8n-nodes-base.openAi\",\"position\":[1620,320],\"parameters\":{\"prompt\":{\"messages\":[{\"role\":\"system\",\"content\":\"Your task is to summarize event feedback form responses. You will receive answers on three questions:\\n1. What went great?\\n2. How can we improve?\\n3. What is the chance of recommending our event?\\n\\nEach questions has several answers separated by | character.\\nAnalyze each question and prepare a summary report. It should contain an overall sentiment regarding the event, followed by the constructive ideas of what to improve.\\n\\nReply in Markdown formatting\"},{\"content\":\"=1. What went great: ```{{ $json['What went great?'].join(' | ') }}```\\n2. How can we improve: ```{{ $json['How can we improve?'].join(' | ') }}```\\n3. What is the chance of recommending our event: ```{{ $json['What is the chance of recommending our event?'].join(' | ') }}```\"}]},\"options\":{\"temperature\":0.3},\"resource\":\"chat\",\"chatModel\":\"gpt-4-turbo-preview\"},\"credentials\":{\"openAiApi\":{\"id\":\"rveqdSfp7pCRON1T\",\"name\":\"Ted's Tech Talks OpenAi\"}},\"typeVersion\":1.1},{\"id\":\"2c8d4e46-9d3e-4655-952b-37d04f673914\",\"name\":\"Convet from Markdown to HTML\",\"type\":\"n8n-nodes-base.markdown\",\"position\":[1980,320],\"parameters\":{\"mode\":\"markdownToHtml\",\"options\":{\"completeHTMLDocument\":false},\"markdown\":\"={{ $json.message.content }}\"},\"typeVersion\":1},{\"id\":\"a27d8664-dc87-4458-9f12-970b88ab6515\",\"name\":\"Send via Gmail\",\"type\":\"n8n-nodes-base.gmail\",\"position\":[2160,320],\"parameters\":{\"sendTo\":\"teds.tech.talks@gmail.com\",\"message\":\"={{ $json.data }}\",\"options\":{\"appendAttribution\":false},\"subject\":\"Feedback form response\"},\"credentials\":{\"gmailOAuth2\":{\"id\":\"UllrXlZsDnkdA3tT\",\"name\":\"Gmail account\"}},\"typeVersion\":2.1}],\"active\":false,\"pinData\":{},\"settings\":{\"executionOrder\":\"v1\"},\"versionId\":\"756cdd85-49dd-4f0f-acc7-58f834a3512f\",\"connections\":{\"Summarize via GPT model\":{\"main\":[[{\"node\":\"Convet from Markdown to HTML\",\"type\":\"main\",\"index\":0}]]},\"Get Google Sheets records\":{\"main\":[[{\"node\":\"Aggregate responses into arrays\",\"type\":\"main\",\"index\":0}]]},\"Convet from Markdown to HTML\":{\"main\":[[{\"node\":\"Send via Gmail\",\"type\":\"main\",\"index\":0}]]},\"When clicking \\\"Test workflow\\\"\":{\"main\":[[{\"node\":\"Get Google Sheets records\",\"type\":\"main\",\"index\":0}]]},\"Aggregate responses into arrays\":{\"main\":[[{\"node\":\"Summarize via GPT model\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "This n8n workflow was developed to collect and summarize feedback from an event that was collected via a Google Form and saved in a Google Sheets document. The workflow is triggered manually by clicking on the \"Test workflow\" button.\n\nThe Google Sheets node retrieves the responses from the feedback form. The Aggregate node then combines all responses for each question into arrays and prepares the data for analysis.\n\nThe OpenAI node processes the aggregated feedback data. System Prompt instructs the model to analyze the responses and generate a summary report that includes the overall sentiment regarding the event and constructive suggestions for improvement.\n\nThe Markdown node converts the summary report, which is in Markdown format, into HTML. Finally, the Gmail node sends an HTML-formatted email to the specified email address.\n",
  "crawled_at": "2025-05-25T21:28:36.892500",
  "readme_zh": "该n8n工作流程专为收集并汇总通过Google表单提交、存储于Google Sheets文档中的活动反馈而设计。工作流程需手动点击\"测试工作流程\"按钮触发。\n\nGoogle Sheets节点从反馈表单中获取响应数据，随后Aggregate节点将每个问题的所有回答合并为数组，为分析做好数据准备。\n\nOpenAI节点对聚合后的反馈数据进行处理。系统提示词指导模型分析响应内容，生成包含活动整体评价和改进建议的总结报告。\n\nMarkdown节点将Markdown格式的总结报告转换为HTML格式，最终由Gmail节点向指定邮箱发送HTML格式的电子邮件。",
  "title_zh": "通过OpenAI的GPT-4汇总Google Sheets表单反馈",
  "publish_date_zh": "最后一次更新于一年前",
  "workflow_json_zh": "{\"id\":\"Lwvu2jjMU2irTyAY\",\"meta\":{\"instanceId\":\"fb924c73af8f703905bc09c9ee8076f48c17b596ed05b18c0ff86915ef8a7c4a\"},\"name\":\"Summarize Google Sheets form feedback via OpenAI's GPT-4\",\"tags\":[{\"id\":\"y9tvM3hISJKT2jeo\",\"name\":\"Ted's Tech Talks\",\"createdAt\":\"2023-08-15T22:12:34.260Z\",\"updatedAt\":\"2023-08-15T22:12:34.260Z\"}],\"nodes\":[{\"id\":\"cd80cd2f-a6e1-48eb-ba05-0f8f1a0875e5\",\"name\":\"When clicking \\\"Test workflow\\\"\",\"type\":\"n8n-nodes-base.manualTrigger\",\"position\":[680,320],\"parameters\":{},\"typeVersion\":1},{\"id\":\"9f03f1c4-c47e-4eda-bc0a-a598c21e4616\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[640,130],\"parameters\":{\"width\":369.1031874662338,\"height\":349,\"content\":\"### 1. 创建谷歌表格文档\\n* 本教程使用与谷歌表单关联的表格文档，但独立表格文档同样适用\\n* 根据需求调整初始触发方式：手动运行或按时间间隔自动触发\\n\\n[谷歌表格模板链接](https://docs.google.com/spreadsheets/d/1Kcr1oF_RrfNQJczmJDpwClOSYpvSnwbeX-_pdUo91-I/edit?usp=sharing)\"},\"typeVersion\":1},{\"id\":\"1e478f81-76e7-4fc3-a147-11a92d3f9998\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1040,160],\"parameters\":{\"width\":394,\"height\":319,\"content\":\"### 2. 将所有回答合并为一个数组\\n* 由于主要目标是提供整体摘要，我们需要将每个Google表单问题的所有回答合并起来\\n* 聚合节点接收多个传入项，并生成仅包含用户反馈数组的单一项目\"},\"typeVersion\":1},{\"id\":\"1ab06b51-3b9e-4a4c-afba-c98e529a636c\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1480,160],\"parameters\":{\"width\":432,\"height\":319,\"content\":\"### 3. 生成总结报告  \\n* 输入一条__系统消息__，包含分析反馈表的总体指导原则  \\n* 提供一条__用户消息__，附带JSON数组  \\n\\n**注意！如果表单过长或反馈数量过多，请考虑拆分表单问题**\"},\"typeVersion\":1},{\"id\":\"ce0118a3-4eaf-4d60-adf0-5bde5d41328a\",\"name\":\"Sticky Note3\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1940,160],\"parameters\":{\"width\":359.1031874662346,\"height\":319,\"content\":\"### 4. 转换为HTML并发送邮件\\n* GPT被配置为以Markdown格式回复。Markdown节点会将此类文本转换为HTML\\n* 最终，Gmail节点会发送一封包含HTML报告的消息\"},\"typeVersion\":1},{\"id\":\"37bc8ab5-328c-4f50-bbda-f7482bf36522\",\"name\":\"Get Google Sheets records\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[860,320],\"parameters\":{\"options\":{},\"sheetName\":{\"__rl\":true,\"mode\":\"list\",\"value\":2035968519,\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1Kcr1oF_RrfNQJczmJDpwClOSYpvSnwbeX-_pdUo91-I/edit#gid=2035968519\",\"cachedResultName\":\"Form Responses 1\"},\"documentId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"1Kcr1oF_RrfNQJczmJDpwClOSYpvSnwbeX-_pdUo91-I\",\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1Kcr1oF_RrfNQJczmJDpwClOSYpvSnwbeX-_pdUo91-I/edit?usp=drivesdk\",\"cachedResultName\":\"Event feedback form (Responses)\"}},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"RtRiRezoxiWkzZQt\",\"name\":\"Ted's Tech Talks Google account\"}},\"typeVersion\":4.2},{\"id\":\"d75b11b1-2cce-40c2-ab5a-d18fdf7f5283\",\"name\":\"Aggregate responses into arrays\",\"type\":\"n8n-nodes-base.aggregate\",\"position\":[1200,320],\"parameters\":{\"options\":{},\"fieldsToAggregate\":{\"fieldToAggregate\":[{\"fieldToAggregate\":\"['What went great?']\"},{\"fieldToAggregate\":\"['How can we improve?']\"},{\"fieldToAggregate\":\"['What is the chance of recommending our event?']\"}]}},\"typeVersion\":1},{\"id\":\"a90f83fe-809b-42db-b65d-43fb11b2979a\",\"name\":\"Summarize via GPT model\",\"type\":\"n8n-nodes-base.openAi\",\"position\":[1620,320],\"parameters\":{\"prompt\":{\"messages\":[{\"role\":\"system\",\"content\":\"Your task is to summarize event feedback form responses. You will receive answers on three questions:\\n1. What went great?\\n2. How can we improve?\\n3. What is the chance of recommending our event?\\n\\nEach questions has several answers separated by | character.\\nAnalyze each question and prepare a summary report. It should contain an overall sentiment regarding the event, followed by the constructive ideas of what to improve.\\n\\nReply in Markdown formatting\"},{\"content\":\"=1. What went great: ```{{ $json['What went great?'].join(' | ') }}```\\n2. How can we improve: ```{{ $json['How can we improve?'].join(' | ') }}```\\n3. What is the chance of recommending our event: ```{{ $json['What is the chance of recommending our event?'].join(' | ') }}```\"}]},\"options\":{\"temperature\":0.3},\"resource\":\"chat\",\"chatModel\":\"gpt-4-turbo-preview\"},\"credentials\":{\"openAiApi\":{\"id\":\"rveqdSfp7pCRON1T\",\"name\":\"Ted's Tech Talks OpenAi\"}},\"typeVersion\":1.1},{\"id\":\"2c8d4e46-9d3e-4655-952b-37d04f673914\",\"name\":\"Convet from Markdown to HTML\",\"type\":\"n8n-nodes-base.markdown\",\"position\":[1980,320],\"parameters\":{\"mode\":\"markdownToHtml\",\"options\":{\"completeHTMLDocument\":false},\"markdown\":\"={{ $json.message.content }}\"},\"typeVersion\":1},{\"id\":\"a27d8664-dc87-4458-9f12-970b88ab6515\",\"name\":\"Send via Gmail\",\"type\":\"n8n-nodes-base.gmail\",\"position\":[2160,320],\"parameters\":{\"sendTo\":\"teds.tech.talks@gmail.com\",\"message\":\"={{ $json.data }}\",\"options\":{\"appendAttribution\":false},\"subject\":\"Feedback form response\"},\"credentials\":{\"gmailOAuth2\":{\"id\":\"UllrXlZsDnkdA3tT\",\"name\":\"Gmail account\"}},\"typeVersion\":2.1}],\"active\":false,\"pinData\":{},\"settings\":{\"executionOrder\":\"v1\"},\"versionId\":\"756cdd85-49dd-4f0f-acc7-58f834a3512f\",\"connections\":{\"Summarize via GPT model\":{\"main\":[[{\"node\":\"Convet from Markdown to HTML\",\"type\":\"main\",\"index\":0}]]},\"Get Google Sheets records\":{\"main\":[[{\"node\":\"Aggregate responses into arrays\",\"type\":\"main\",\"index\":0}]]},\"Convet from Markdown to HTML\":{\"main\":[[{\"node\":\"Send via Gmail\",\"type\":\"main\",\"index\":0}]]},\"When clicking \\\"Test workflow\\\"\":{\"main\":[[{\"node\":\"Get Google Sheets records\",\"type\":\"main\",\"index\":0}]]},\"Aggregate responses into arrays\":{\"main\":[[{\"node\":\"Summarize via GPT model\",\"type\":\"main\",\"index\":0}]]}}}"
}