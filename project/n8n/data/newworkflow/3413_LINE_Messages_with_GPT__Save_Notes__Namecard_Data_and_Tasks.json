{
  "url": "https://n8n.io/workflows/3413-line-messages-with-gpt-save-notes-namecard-data-and-tasks/",
  "title": "LINE Messages with GPT: Save Notes, Namecard Data and Tasks",
  "author": "lin@davoy.tech",
  "publish_date": "Last update 19 days ago",
  "publish_date_absolute": "2025-05-07",
  "categories": [
    {
      "name": "Other"
    },
    {
      "name": "AI"
    },
    {
      "name": "IT Ops"
    }
  ],
  "workflow_json": "{\"id\":\"HbjZ9cBPgDdnIRjG\",\"meta\":{\"instanceId\":\"558d88703fb65b2d0e44613bc35916258b0f0bf983c5d4730c00c424b77ca36a\",\"templateCredsSetupCompleted\":true},\"name\":\"MiniBear Webhook\",\"tags\":[{\"id\":\"0xpEHcJjNRRRMtEj\",\"name\":\"lin\",\"createdAt\":\"2025-03-12T05:06:24.112Z\",\"updatedAt\":\"2025-03-12T05:06:24.112Z\"},{\"id\":\"IhTa6egt1w8uqn9Z\",\"name\":\"_ACTIVE\",\"createdAt\":\"2025-03-12T05:07:05.060Z\",\"updatedAt\":\"2025-03-12T05:07:05.060Z\"},{\"id\":\"Q0IWVCdrzoxXDC7z\",\"name\":\"error_linlinmhee_line\",\"createdAt\":\"2025-03-12T06:37:16.225Z\",\"updatedAt\":\"2025-03-12T06:37:16.225Z\"},{\"id\":\"U1ozjO3iXQZWUyfG\",\"name\":\"_Blueprint\",\"createdAt\":\"2025-03-12T06:24:40.268Z\",\"updatedAt\":\"2025-03-12T06:24:40.268Z\"}],\"nodes\":[{\"id\":\"b1f42cbd-952e-4704-9233-788891e1894d\",\"name\":\"Line Webhook\",\"type\":\"n8n-nodes-base.webhook\",\"position\":[-260,-20],\"webhookId\":\"4ef1a53c-a1ec-4a63-a7a5-469423502333\",\"parameters\":{\"path\":\"minibear\",\"options\":{},\"httpMethod\":\"POST\"},\"typeVersion\":2},{\"id\":\"ae4a46d6-0f34-484b-8be5-dbc07d5de92e\",\"name\":\"Line Loading Animation\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[120,-20],\"parameters\":{\"url\":\"https://api.line.me/v2/bot/chat/loading/start\",\"method\":\"POST\",\"options\":{},\"jsonBody\":\"={\\n    \\\"chatId\\\": \\\"{{ $json.body.events[0].source.userId }}\\\",\\n    \\\"loadingSeconds\\\": 60\\n}\",\"sendBody\":true,\"specifyBody\":\"json\",\"authentication\":\"genericCredentialType\",\"genericAuthType\":\"httpHeaderAuth\"},\"credentials\":{\"httpHeaderAuth\":{\"id\":\"lKd3b2nc8uNJ148Z\",\"name\":\"Line @271dudsw MiniBear\"}},\"typeVersion\":4.2},{\"id\":\"802eb4b2-ed1c-4cbc-9cf9-9bd8fec74b82\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-380,-100],\"parameters\":{\"color\":4,\"width\":360,\"height\":560,\"content\":\"**Webhook from Line**\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nYou need to set-up this webhook at Line Manager or Line Developer Console\\n\\nYou'll need to copy Webhook URL from this node to put in Line Console\\n\\nAlso, don't forget to remove 'test' part when going for production\\n\\nhttps://developers.line.biz/en/docs/messaging-api/receiving-messages/\\n\"},\"typeVersion\":1},{\"id\":\"965612b6-bd04-44e9-9b95-d777f92e9acf\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[0,-100],\"parameters\":{\"color\":4,\"width\":360,\"height\":560,\"content\":\"**Line Loading Animation**\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nThis node is to only give ... loading animation back in Line.\\n\\nIt seems stupid but it actually tells user that the workflow is running and you are not left waiting without hope\\n\\nTo authorize, you can fill in the Line Token in the node here, or you can you header authorization (shown at the 'reply message' node)\\n\\nhttps://developers.line.biz/en/docs/messaging-api/use-loading-indicator/\"},\"typeVersion\":1},{\"id\":\"92953054-43a6-44a3-8069-6147cbb837c3\",\"name\":\"Switch\",\"type\":\"n8n-nodes-base.switch\",\"position\":[500,80],\"parameters\":{\"rules\":{\"values\":[{\"outputKey\":\"Task\",\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"6f9aef97-cf2f-4f8e-bbc5-c17069a24c57\",\"operator\":{\"type\":\"string\",\"operation\":\"startsWith\"},\"leftValue\":\"={{ $('Line Webhook').item.json.body.events[0].message.text }}\",\"rightValue\":\"T \"}]},\"renameOutput\":true},{\"outputKey\":\"text\",\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"9f8075cf-8f3f-419f-ae0a-833ee29fc063\",\"operator\":{\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $('Line Webhook').item.json.body.events[0].message.type }}\",\"rightValue\":\"text\"}]},\"renameOutput\":true},{\"outputKey\":\"img\",\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"b7770f5b-dfb5-4b7a-8dc1-4404337dbfde\",\"operator\":{\"name\":\"filter.operator.equals\",\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $('Line Webhook').item.json.body.events[0].message.type }}\",\"rightValue\":\"image\"}]},\"renameOutput\":true},{\"outputKey\":\"audio\",\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"9faa9dd4-32ce-4287-b7e5-885a42a62e32\",\"operator\":{\"name\":\"filter.operator.equals\",\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $('Line Webhook').item.json.body.events[0].message.type }}\",\"rightValue\":\"audio\"}]},\"renameOutput\":true},{\"outputKey\":\"else\",\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"f4dbfa6a-a7f8-4c32-a94d-da384f37c0d1\",\"operator\":{\"type\":\"boolean\",\"operation\":\"true\",\"singleValue\":true},\"leftValue\":true,\"rightValue\":\"\"}]},\"renameOutput\":true}]},\"options\":{}},\"typeVersion\":3.2},{\"id\":\"ae9e08a3-0106-4e49-85b3-84eb9696673c\",\"name\":\"Sticky Note5\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[380,-100],\"parameters\":{\"color\":5,\"width\":360,\"height\":560,\"content\":\"**Router for Tasks (Text started with 'T'), other texts, images and others**\"},\"typeVersion\":1},{\"id\":\"933b7da4-95fd-4bb2-ac46-3eac62d0dcaa\",\"name\":\"Get Image\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[900,80],\"parameters\":{\"url\":\"=https://api-data.line.me/v2/bot/message/{{ $('Line Webhook').item.json.body.events[0].message.id }}/content\",\"options\":{},\"authentication\":\"genericCredentialType\",\"genericAuthType\":\"httpHeaderAuth\"},\"credentials\":{\"httpHeaderAuth\":{\"id\":\"lKd3b2nc8uNJ148Z\",\"name\":\"Line @271dudsw MiniBear\"}},\"typeVersion\":4.2},{\"id\":\"d1160e8d-b84a-4e76-b5cc-f8c960a6070b\",\"name\":\"Sticky Note9\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[820,460],\"parameters\":{\"color\":4,\"width\":360,\"height\":480,\"content\":\"**Line Reply**\\nTo reply that message is not supported\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\"},\"typeVersion\":1},{\"id\":\"b169657d-5348-4662-bdcf-6617416ec9f7\",\"name\":\"Line Reply (image)\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[3140,200],\"parameters\":{\"url\":\"https://api.line.me/v2/bot/message/reply\",\"method\":\"POST\",\"options\":{},\"jsonBody\":\"={\\n  \\\"replyToken\\\": \\\"{{ $('Line Webhook').item.json.body.events[0].replyToken }}\\\",\\n  \\\"messages\\\": [\\n    {\\n      \\\"type\\\": \\\"text\\\",\\n      \\\"text\\\": \\\"[ Message Saved in Zac&Lin > Notes ]\\\"\\n    }\\n  ]\\n} \",\"sendBody\":true,\"specifyBody\":\"json\",\"authentication\":\"genericCredentialType\",\"genericAuthType\":\"httpHeaderAuth\"},\"credentials\":{\"httpHeaderAuth\":{\"id\":\"lKd3b2nc8uNJ148Z\",\"name\":\"Line @271dudsw MiniBear\"}},\"typeVersion\":4.2},{\"id\":\"b0f63685-e8df-484e-85ea-bedabd80b61e\",\"name\":\"Line Reply (Text)\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[1300,-340],\"parameters\":{\"url\":\"https://api.line.me/v2/bot/message/reply\",\"method\":\"POST\",\"options\":{},\"jsonBody\":\"={\\n  \\\"replyToken\\\": \\\"{{ $('Line Webhook').item.json.body.events[0].replyToken }}\\\",\\n  \\\"messages\\\": [\\n    {\\n      \\\"type\\\": \\\"text\\\",\\n      \\\"text\\\": \\\"[ Message Saved in Zac&Lin > Notes ]\\\" \\n    }\\n  ]\\n} \",\"sendBody\":true,\"specifyBody\":\"json\",\"authentication\":\"genericCredentialType\",\"genericAuthType\":\"httpHeaderAuth\"},\"credentials\":{\"httpHeaderAuth\":{\"id\":\"lKd3b2nc8uNJ148Z\",\"name\":\"Line @271dudsw MiniBear\"}},\"typeVersion\":4.2},{\"id\":\"b2ee3bb5-7cdf-46de-868e-f6b81a2e0ec0\",\"name\":\"Line Reply (Not Supported 2)\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[940,740],\"parameters\":{\"url\":\"https://api.line.me/v2/bot/message/reply\",\"method\":\"POST\",\"options\":{},\"jsonBody\":\"={\\n  \\\"replyToken\\\": \\\"{{ $('Line Webhook').item.json.body.events[0].replyToken }}\\\",\\n  \\\"messages\\\": [\\n    {\\n      \\\"type\\\": \\\"text\\\",\\n      \\\"text\\\": \\\"Please try again. Message type is not supported\\\"\\n    }\\n  ]\\n} \",\"sendBody\":true,\"specifyBody\":\"json\",\"authentication\":\"genericCredentialType\",\"genericAuthType\":\"httpHeaderAuth\"},\"credentials\":{\"httpHeaderAuth\":{\"id\":\"3IEOzxKOUr6OEXyU\",\"name\":\"Line @405jtfqs LazyChinese\"}},\"typeVersion\":4.2},{\"id\":\"04f298c3-e952-4d85-aba7-0971d2f6a8b0\",\"name\":\"Line Reply (Not Supported 1)\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[940,540],\"parameters\":{\"url\":\"https://api.line.me/v2/bot/message/reply\",\"method\":\"POST\",\"options\":{},\"jsonBody\":\"={\\n  \\\"replyToken\\\": \\\"{{ $('Line Webhook').item.json.body.events[0].replyToken }}\\\",\\n  \\\"messages\\\": [\\n    {\\n      \\\"type\\\": \\\"text\\\",\\n      \\\"text\\\": \\\"Please try again. Message type is not supported\\\"\\n    }\\n  ]\\n} \",\"sendBody\":true,\"specifyBody\":\"json\",\"authentication\":\"genericCredentialType\",\"genericAuthType\":\"httpHeaderAuth\"},\"credentials\":{\"httpHeaderAuth\":{\"id\":\"3IEOzxKOUr6OEXyU\",\"name\":\"Line @405jtfqs LazyChinese\"}},\"typeVersion\":4.2},{\"id\":\"1d6d7c55-59ba-48c4-a877-6f260ede7bf5\",\"name\":\"OpenRouter Chat Model\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatOpenRouter\",\"position\":[1060,200],\"parameters\":{\"model\":\"openai/gpt-4o\",\"options\":{}},\"credentials\":{\"openRouterApi\":{\"id\":\"iQS3GMHjRv36CWYD\",\"name\":\"n8n Lin\"}},\"typeVersion\":1},{\"id\":\"dae07428-733a-4976-9553-cba198736403\",\"name\":\"Image Router\",\"type\":\"@n8n/n8n-nodes-langchain.agent\",\"position\":[1040,80],\"parameters\":{\"text\":\"You'll identify the image\\n01 Namecard\\n02 Text on screen or handwritten note\\n03 Others\\n\\nYou'll answer with only 01 02 or 03\",\"options\":{\"passthroughBinaryImages\":true},\"promptType\":\"define\"},\"typeVersion\":1.8,\"alwaysOutputData\":true},{\"id\":\"1810b10b-d326-4626-836c-4fb706deff20\",\"name\":\"Microsoft Teams\",\"type\":\"n8n-nodes-base.microsoftTeams\",\"position\":[1020,-340],\"webhookId\":\"3a9c75de-5207-4e9b-a558-6c2fd622fb5f\",\"parameters\":{\"teamId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"ebfd67d4-df6b-4ea2-9faf-81ec059170ad\",\"cachedResultName\":\"Zac&Lin\"},\"message\":\"={{ $('Line Webhook').item.json.body.events[0].message.text.replace('\\\\n\\\\n', '<br><br>').replace('\\\\n', '<br>') }}\",\"options\":{},\"resource\":\"channelMessage\",\"channelId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"19:c2966307089a4f4b98ca06b5f160999a@thread.tacv2\",\"cachedResultUrl\":\"https://teams.microsoft.com/l/channel/19%3Ac2966307089a4f4b98ca06b5f160999a%40thread.tacv2/Notes?groupId=ebfd67d4-df6b-4ea2-9faf-81ec059170ad&tenantId=77e73351-d19d-4855-9380-82ca9b459c87&allowXTenantAccess=True&ngc=True\",\"cachedResultName\":\"Notes\"},\"contentType\":\"html\"},\"credentials\":{\"microsoftTeamsOAuth2Api\":{\"id\":\"3oENQ6chN2T1DR2x\",\"name\":\"Microsoft Teams account\"}},\"typeVersion\":2},{\"id\":\"b98955e9-1c4c-473f-ac51-a8d73747ae63\",\"name\":\"Microsoft To Do\",\"type\":\"n8n-nodes-base.microsoftToDo\",\"position\":[1020,-600],\"parameters\":{\"title\":\"={{ $('Line Webhook').item.json.body.events[0].message.text.replace('T ','') }}\",\"operation\":\"create\",\"taskListId\":\"AQMkAGE1NDhhM2UxLTA3ZTQtNGIyYS1iOWFjLTlkNDAyYzkzNjE2YQAuAAADCPe-x7aF5Eqh4_vJsot6MAEAG9nUtifnkkavLabXdl_kugAAAgESAAAA\",\"additionalFields\":{}},\"credentials\":{\"microsoftToDoOAuth2Api\":{\"id\":\"Pag1nTvXIzYpG5V1\",\"name\":\"Microsoft To Do account\"}},\"typeVersion\":1},{\"id\":\"59202467-34c6-4580-8039-fca99c9467ca\",\"name\":\"Line Reply (Text)1\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[1300,-600],\"parameters\":{\"url\":\"https://api.line.me/v2/bot/message/reply\",\"method\":\"POST\",\"options\":{},\"jsonBody\":\"={\\n  \\\"replyToken\\\": \\\"{{ $('Line Webhook').item.json.body.events[0].replyToken }}\\\",\\n  \\\"messages\\\": [\\n    {\\n      \\\"type\\\": \\\"text\\\",\\n      \\\"text\\\": \\\"[ Task : {{ $('Line Webhook').item.json.body.events[0].message.text.replace('T ','') }} created successfully in Private Task ]\\\" \\n    }\\n  ]\\n} \",\"sendBody\":true,\"specifyBody\":\"json\",\"authentication\":\"genericCredentialType\",\"genericAuthType\":\"httpHeaderAuth\"},\"credentials\":{\"httpHeaderAuth\":{\"id\":\"lKd3b2nc8uNJ148Z\",\"name\":\"Line @271dudsw MiniBear\"}},\"typeVersion\":4.2},{\"id\":\"525f0a8b-0c03-4182-ab2b-ff97ba6ad50d\",\"name\":\"If namecard\",\"type\":\"n8n-nodes-base.if\",\"position\":[1480,80],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"85dc209c-a217-46a7-8289-b3e98c128d05\",\"operator\":{\"name\":\"filter.operator.equals\",\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $json.output }}\",\"rightValue\":\"01\"}]}},\"typeVersion\":2.2},{\"id\":\"113ab6ea-d66d-4b8d-ae81-eee73439c90e\",\"name\":\"Other Images\",\"type\":\"@n8n/n8n-nodes-langchain.agent\",\"position\":[2440,200],\"parameters\":{\"text\":\"=If the image is handwritten notes or text on screen in thai or english, you'll extract the text.\\n\\nElse, you'll describe the image\",\"options\":{\"passthroughBinaryImages\":true},\"promptType\":\"define\"},\"typeVersion\":1.8},{\"id\":\"596a643e-757a-4b83-878b-f5a0f1c42886\",\"name\":\"Microsoft Teams1\",\"type\":\"n8n-nodes-base.microsoftTeams\",\"position\":[2880,200],\"webhookId\":\"3a9c75de-5207-4e9b-a558-6c2fd622fb5f\",\"parameters\":{\"teamId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"ebfd67d4-df6b-4ea2-9faf-81ec059170ad\",\"cachedResultName\":\"Zac&Lin\"},\"message\":\"={{ $json.output.replace('\\\\n\\\\n', '<br><br>').replace('\\\\n', '<br>') }}\\n<br><br>\\n<img src=\\\"{{ $('Get Image2').item.json['@microsoft.graph.downloadUrl'] }}\\\">\\n</img>\",\"options\":{},\"resource\":\"channelMessage\",\"channelId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"19:c2966307089a4f4b98ca06b5f160999a@thread.tacv2\",\"cachedResultUrl\":\"https://teams.microsoft.com/l/channel/19%3Ac2966307089a4f4b98ca06b5f160999a%40thread.tacv2/Notes?groupId=ebfd67d4-df6b-4ea2-9faf-81ec059170ad&tenantId=77e73351-d19d-4855-9380-82ca9b459c87&allowXTenantAccess=True&ngc=True\",\"cachedResultName\":\"Notes\"},\"contentType\":\"html\"},\"credentials\":{\"microsoftTeamsOAuth2Api\":{\"id\":\"3oENQ6chN2T1DR2x\",\"name\":\"Microsoft Teams account\"}},\"typeVersion\":2},{\"id\":\"be5637d9-50a7-4508-b6f9-d32ac37bb2c2\",\"name\":\"OpenRouter Chat Model2\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatOpenRouter\",\"position\":[2460,320],\"parameters\":{\"model\":\"openai/gpt-4o\",\"options\":{}},\"credentials\":{\"openRouterApi\":{\"id\":\"iQS3GMHjRv36CWYD\",\"name\":\"n8n Lin\"}},\"typeVersion\":1},{\"id\":\"a7114805-80bf-428a-a717-b35cb6eb3312\",\"name\":\"Microsoft OneDrive\",\"type\":\"n8n-nodes-base.microsoftOneDrive\",\"position\":[1820,200],\"parameters\":{\"fileName\":\"testtest.jpg\",\"parentId\":\"01I7MG5Y2G7ELINW2YLJBLHHF5KDBNJDPF\",\"binaryData\":true},\"credentials\":{\"microsoftOneDriveOAuth2Api\":{\"id\":\"pM363KMLOo6btGCp\",\"name\":\"Microsoft Drive account\"}},\"typeVersion\":1},{\"id\":\"7a6f14a2-938f-40f8-a294-564fb1185de3\",\"name\":\"Microsoft OneDrive1\",\"type\":\"n8n-nodes-base.microsoftOneDrive\",\"position\":[2000,200],\"parameters\":{\"itemId\":\"={{ $json.id }}\",\"newName\":\"={{ $('Line Webhook').item.json.body.events[0].message.id }}.jpg\",\"operation\":\"rename\"},\"credentials\":{\"microsoftOneDriveOAuth2Api\":{\"id\":\"pM363KMLOo6btGCp\",\"name\":\"Microsoft Drive account\"}},\"typeVersion\":1},{\"id\":\"864fe7c5-f8f9-429e-94b7-2b760af09cd4\",\"name\":\"Get Image2\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[2260,200],\"parameters\":{\"url\":\"=https://api-data.line.me/v2/bot/message/{{ $('Line Webhook').item.json.body.events[0].message.id }}/content\",\"options\":{},\"authentication\":\"genericCredentialType\",\"genericAuthType\":\"httpHeaderAuth\"},\"credentials\":{\"httpHeaderAuth\":{\"id\":\"lKd3b2nc8uNJ148Z\",\"name\":\"Line @271dudsw MiniBear\"}},\"typeVersion\":4.2},{\"id\":\"f1108c52-9e9c-4611-9a2a-40f28871632a\",\"name\":\"Microsoft To Do1\",\"type\":\"n8n-nodes-base.microsoftToDo\",\"position\":[2400,-260],\"parameters\":{\"title\":\"=Follow-up Namecard {{ $json.output.Email }}\",\"operation\":\"create\",\"taskListId\":\"AQMkAGE1NDhhM2UxLTA3ZTQtNGIyYS1iOWFjLTlkNDAyYzkzNjE2YQAuAAADCPe-x7aF5Eqh4_vJsot6MAEAG9nUtifnkkavLabXdl_kugAAAgESAAAA\",\"additionalFields\":{}},\"credentials\":{\"microsoftToDoOAuth2Api\":{\"id\":\"Pag1nTvXIzYpG5V1\",\"name\":\"Microsoft To Do account\"}},\"typeVersion\":1},{\"id\":\"2afe30ad-ef70-45e8-9e3c-546bd3cf91a8\",\"name\":\"HTTP Request\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[2960,-260],\"parameters\":{\"url\":\"https://hook.us2.make.com/46263sznm3didxdkcuqvnlfqv2fv2l7q\",\"method\":\"POST\",\"options\":{},\"sendBody\":true,\"bodyParameters\":{\"parameters\":[{\"name\":\"MessageID\",\"value\":\"={{ $('Line Webhook').item.json.body.events[0].message.id }}\"},{\"name\":\"Content\",\"value\":\"={{ $('NamecardExtract').item.json.output }}\"},{\"name\":\"ReplyToken\",\"value\":\"={{ $('Line Webhook').item.json.body.events[0].replyToken }}\"}]}},\"typeVersion\":4.2},{\"id\":\"a94bcdea-f8cc-4eb9-847a-66eb3808ed5b\",\"name\":\"OpenRouter Chat Model3\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatOpenRouter\",\"position\":[2000,-140],\"parameters\":{\"model\":\"openai/gpt-4o\",\"options\":{}},\"credentials\":{\"openRouterApi\":{\"id\":\"iQS3GMHjRv36CWYD\",\"name\":\"n8n Lin\"}},\"typeVersion\":1},{\"id\":\"f138bdcf-1b46-4c14-b443-db2f1e3055f4\",\"name\":\"NamecardExtract\",\"type\":\"@n8n/n8n-nodes-langchain.agent\",\"position\":[2000,-260],\"parameters\":{\"text\":\"=You'll extract the data in JSON format \\n\\n--- \\n{   \\\"Nickname\\\": \\\"\\\",   \\\"FirstName\\\": \\\"\\\",   \\\"LastName\\\": \\\"\\\",   \\\"CompanyFull\\\": \\\"\\\",   \\\"Department\\\": \\\"\\\",   \\\"JobTitle\\\": \\\"\\\",   \\\"Mobile\\\": \\\"\\\",   \\\"Mobile2\\\": \\\"\\\",   \\\"Email\\\": \\\"\\\",   \\\"SocialMedia\\\": \\\"\\\",   \\\"Address\\\": \\\"\\\",   \\\"Remark\\\": \\\"\\\",   \\\"NameTH\\\": \\\"\\\" } \\n--- \\nFor Nickname, you'll see if there's any short name in the namecard. For Name TH, you'll see if there's thai name on the namecard. \\n\",\"options\":{\"passthroughBinaryImages\":true},\"promptType\":\"define\",\"hasOutputParser\":true},\"typeVersion\":1.8},{\"id\":\"df565b73-3cfe-464e-b5d2-36f2240da218\",\"name\":\"Structured Output Parser\",\"type\":\"@n8n/n8n-nodes-langchain.outputParserStructured\",\"position\":[2180,-140],\"parameters\":{\"jsonSchemaExample\":\"{   \\\"Nickname\\\": \\\"\\\",   \\\"FirstName\\\": \\\"\\\",   \\\"LastName\\\": \\\"\\\",   \\\"CompanyFull\\\": \\\"\\\",   \\\"Department\\\": \\\"\\\",   \\\"JobTitle\\\": \\\"\\\",   \\\"Mobile\\\": \\\"\\\",   \\\"Mobile2\\\": \\\"\\\",   \\\"Email\\\": \\\"\\\",   \\\"SocialMedia\\\": \\\"\\\",   \\\"Address\\\": \\\"\\\",   \\\"Remark\\\": \\\"\\\",   \\\"NameTH\\\": \\\"\\\" } \"},\"typeVersion\":1.2},{\"id\":\"c7b2b87f-3507-4a0f-a1d0-7ab9a131a619\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1220,-680],\"parameters\":{\"color\":4,\"width\":260,\"height\":240,\"content\":\"**Line Reply**\\nTo send feedback that the task has been added\\n\"},\"typeVersion\":1},{\"id\":\"6448ffd8-4a5d-4cb7-826a-b594952c6773\",\"name\":\"Sticky Note3\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1220,-420],\"parameters\":{\"color\":4,\"width\":260,\"height\":240,\"content\":\"**Line Reply**\\nTo send feedback message has been saved\"},\"typeVersion\":1},{\"id\":\"f222d983-26a5-4806-8f86-1eb32982f558\",\"name\":\"Sticky Note4\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[940,-680],\"parameters\":{\"color\":2,\"width\":260,\"height\":240,\"content\":\"**Tasks**\\nTo add in MS 'To Do' List\"},\"typeVersion\":1},{\"id\":\"d13b3145-d9c5-41bb-a384-996fcdbbc19c\",\"name\":\"Sticky Note6\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[940,-420],\"parameters\":{\"color\":3,\"width\":260,\"height\":240,\"content\":\"**MS Teams**\\nSave this message in MS Teams\"},\"typeVersion\":1},{\"id\":\"001dd5c9-b56e-47f1-bd71-31c3b2a7810c\",\"name\":\"Sticky Note7\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[2320,-340],\"parameters\":{\"color\":2,\"width\":260,\"height\":240,\"content\":\"**Tasks**\\nTo add in MS 'To Do' List to follow-up with this namecard\"},\"typeVersion\":1},{\"id\":\"94519356-9e65-473f-bfad-f89d0aecc7ff\",\"name\":\"Sticky Note8\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[2600,-340],\"parameters\":{\"color\":4,\"width\":260,\"height\":240,\"content\":\"**Line Reply**\\nTo send feedback message has been saved\"},\"typeVersion\":1},{\"id\":\"28c490ad-5fa9-435c-8d06-d3bb21c8d454\",\"name\":\"Line Reply Namecard\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[2680,-260],\"parameters\":{\"url\":\"https://api.line.me/v2/bot/message/reply\",\"method\":\"POST\",\"options\":{},\"jsonBody\":\"={\\n  \\\"replyToken\\\": \\\"{{ $('Line Webhook').item.json.body.events[0].replyToken }}\\\",\\n  \\\"messages\\\": [\\n    {\\n      \\\"type\\\": \\\"text\\\",\\n      \\\"text\\\": \\\"[ Namecard Extraction ] /n/n {{ $('NamecardExtract').item.json.output }}\\\" \\n    }\\n  ]\\n} \",\"sendBody\":true,\"specifyBody\":\"json\",\"authentication\":\"genericCredentialType\",\"genericAuthType\":\"httpHeaderAuth\"},\"credentials\":{\"httpHeaderAuth\":{\"id\":\"lKd3b2nc8uNJ148Z\",\"name\":\"Line @271dudsw MiniBear\"}},\"typeVersion\":4.2},{\"id\":\"67dd6ba3-6382-465b-a3a9-2d438e67aaf3\",\"name\":\"Sticky Note10\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[2880,-340],\"parameters\":{\"color\":4,\"width\":260,\"height\":240,\"content\":\"**HTTP Request**\\nThis is to trigger another workflow to add new rows in MS Excel 365\"},\"typeVersion\":1},{\"id\":\"e8fb90be-1371-4bf1-a945-e6fcedacb8fb\",\"name\":\"Sticky Note11\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[3080,120],\"parameters\":{\"color\":4,\"width\":260,\"height\":240,\"content\":\"**Line Reply**\\nTo send feedback message has been saved\"},\"typeVersion\":1},{\"id\":\"c43ec591-b882-4eba-95f3-827153af5890\",\"name\":\"Sticky Note12\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[2800,120],\"parameters\":{\"color\":3,\"width\":260,\"height\":240,\"content\":\"**MS Teams**\\nSave this message in MS Teams\"},\"typeVersion\":1},{\"id\":\"150c2ea3-aca6-40da-879a-ee7204f00a5f\",\"name\":\"Sticky Note13\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[840,-40],\"parameters\":{\"color\":6,\"width\":520,\"height\":400,\"content\":\"**Identify Image**\\nFirst we'll get the image from Line and we will use Tool Agent to query OpenRouter to identify whether this is namecard or not?\"},\"typeVersion\":1},{\"id\":\"694d260b-1570-430b-9a5b-5b4962af9b8b\",\"name\":\"Sticky Note14\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1780,-380],\"parameters\":{\"color\":6,\"width\":520,\"height\":400,\"content\":\"**Namecard Information Extraction**\\nFirst we'll get the image from Line and we will use Tool Agent to query OpenRouter to extract the namecard information in the structured format\"},\"typeVersion\":1},{\"id\":\"c437c0d5-3022-4469-ac3c-ceea9aaf1689\",\"name\":\"Get Image3\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[1860,-260],\"parameters\":{\"url\":\"=https://api-data.line.me/v2/bot/message/{{ $('Line Webhook').item.json.body.events[0].message.id }}/content\",\"options\":{},\"authentication\":\"genericCredentialType\",\"genericAuthType\":\"httpHeaderAuth\"},\"credentials\":{\"httpHeaderAuth\":{\"id\":\"lKd3b2nc8uNJ148Z\",\"name\":\"Line @271dudsw MiniBear\"}},\"typeVersion\":4.2},{\"id\":\"91cf0e34-831a-4c56-92bb-e26319713874\",\"name\":\"Sticky Note15\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1400,-40],\"parameters\":{\"color\":5,\"width\":280,\"height\":400,\"content\":\"**Router Namecard or not**\"},\"typeVersion\":1},{\"id\":\"65261cba-e104-404a-8af6-3c2b6cf85c2a\",\"name\":\"Sticky Note16\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[2220,80],\"parameters\":{\"color\":6,\"width\":520,\"height\":400,\"content\":\"**Text Extraction**\\nFirst we'll get the image from Line and we will use Tool Agent to query OpenRouter to identify image content such as what is written\"},\"typeVersion\":1},{\"id\":\"1170527e-0ac7-4a8b-8ae8-420713a046fa\",\"name\":\"Sticky Note17\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1740,80],\"parameters\":{\"width\":440,\"height\":340,\"content\":\"**Upload to OneDrive**\\nThis is to upload the file to OneDrive. Due to some bug I faced, we need to rename the file again.\"},\"typeVersion\":1}],\"active\":true,\"pinData\":{},\"settings\":{\"timezone\":\"Asia/Bangkok\",\"callerPolicy\":\"workflowsFromSameOwner\",\"errorWorkflow\":\"A8HoJ5iCrAMPbsLh\",\"executionOrder\":\"v1\"},\"versionId\":\"49efe864-6f48-4c6c-853b-7e8542a7ea2f\",\"connections\":{\"Switch\":{\"main\":[[{\"node\":\"Microsoft To Do\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Microsoft Teams\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Get Image\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Line Reply (Not Supported 1)\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Line Reply (Not Supported 2)\",\"type\":\"main\",\"index\":0}]]},\"Get Image\":{\"main\":[[{\"node\":\"Image Router\",\"type\":\"main\",\"index\":0}]]},\"Get Image2\":{\"main\":[[{\"node\":\"Other Images\",\"type\":\"main\",\"index\":0}]]},\"Get Image3\":{\"main\":[[{\"node\":\"NamecardExtract\",\"type\":\"main\",\"index\":0}]]},\"If namecard\":{\"main\":[[{\"node\":\"Get Image3\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Microsoft OneDrive\",\"type\":\"main\",\"index\":0}]]},\"Image Router\":{\"main\":[[{\"node\":\"If namecard\",\"type\":\"main\",\"index\":0}]]},\"Line Webhook\":{\"main\":[[{\"node\":\"Line Loading Animation\",\"type\":\"main\",\"index\":0}]]},\"Other Images\":{\"main\":[[{\"node\":\"Microsoft Teams1\",\"type\":\"main\",\"index\":0}]]},\"Microsoft Teams\":{\"main\":[[{\"node\":\"Line Reply (Text)\",\"type\":\"main\",\"index\":0}]]},\"Microsoft To Do\":{\"main\":[[{\"node\":\"Line Reply (Text)1\",\"type\":\"main\",\"index\":0}]]},\"NamecardExtract\":{\"main\":[[{\"node\":\"Microsoft To Do1\",\"type\":\"main\",\"index\":0}]]},\"Microsoft Teams1\":{\"main\":[[{\"node\":\"Line Reply (image)\",\"type\":\"main\",\"index\":0}]]},\"Microsoft To Do1\":{\"main\":[[{\"node\":\"Line Reply Namecard\",\"type\":\"main\",\"index\":0}]]},\"Microsoft OneDrive\":{\"main\":[[{\"node\":\"Microsoft OneDrive1\",\"type\":\"main\",\"index\":0}]]},\"Line Reply Namecard\":{\"main\":[[{\"node\":\"HTTP Request\",\"type\":\"main\",\"index\":0}]]},\"Microsoft OneDrive1\":{\"main\":[[{\"node\":\"Get Image2\",\"type\":\"main\",\"index\":0}]]},\"OpenRouter Chat Model\":{\"ai_languageModel\":[[{\"node\":\"Image Router\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"Line Loading Animation\":{\"main\":[[{\"node\":\"Switch\",\"type\":\"main\",\"index\":0}]]},\"OpenRouter Chat Model2\":{\"ai_languageModel\":[[{\"node\":\"Other Images\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"OpenRouter Chat Model3\":{\"ai_languageModel\":[[{\"node\":\"NamecardExtract\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"Structured Output Parser\":{\"ai_outputParser\":[[{\"node\":\"NamecardExtract\",\"type\":\"ai_outputParser\",\"index\":0}]]}}}",
  "readme": "This workflow template, \"Personal Assistant to Note Messages and Extract Namecard Information\" is designed to streamline the processing of incoming messages on the LINE messaging platform. It integrates with powerful tools like Microsoft Teams , Microsoft To Do , OneDrive , and [OpenRouter.ai](http://OpenRouter.ai) to handle tasks such as saving notes, extracting namecard information, and organizing images. Whether you’re managing personal productivity or automating workflows for teams, this template offers a versatile and customizable solution.\n\nBy leveraging this workflow, you can automate repetitive tasks, improve collaboration, and enhance efficiency in handling LINE messages.\n\n## Who Is This Template For?\n\nThis template is ideal for:\n\n  * Professionals: Who want to save important messages, extract data from namecards, or organize images automatically.\n  * Teams: Looking to integrate LINE messages into tools like Microsoft Teams and Microsoft To Do for better collaboration.\n  * Developers: Seeking to build intelligent workflows that process text, images, and other inputs from LINE.\n  * Business Owners: Who need to manage customer interactions, follow-ups, and task tracking efficiently.\n\n\n\n## What Problem Does This Workflow Solve?\n\nManaging incoming messages on LINE can be time-consuming, especially when dealing with diverse input types like text, images, and namecards. This workflow solves that problem by:\n\n  * Automatically identifying and routing different message types (text, images, namecards) to appropriate actions.\n  * Extracting structured data from namecards and saving it for follow-up tasks.\n  * Uploading images to OneDrive and saving text messages to Microsoft Teams or Microsoft To Do for easy access.\n  * Sending real-time feedback to users via LINE to confirm that their messages have been processed.\n\n\n\n## What This Workflow Does\n\n  * Receive Messages via LINE Webhook:  \nThe workflow is triggered whenever a user sends a message (text, image, or other types) to the LINE bot.\n  * Display Loading Animation:  \nA loading animation is displayed to reassure the user that their request is being processed.  \nRoute Input Types:\n\n\n\nThe workflow uses a Switch node to determine the type of input:\n\n  * Text Starting with \"T\": Adds the message as a task in Microsoft To Do.\n  * Plain Text: Saves the message in Microsoft Teams under a designated channel (e.g., \"Notes\").\n  * Images: Identifies whether the image is a namecard, handwritten note, or other content, then processes accordingly.\n  * Unsupported formats trigger a polite response indicating the limitation.  \nProcess Namecards:\n\n\n\n**Images **  \nIf the image is identified as a namecard, the workflow extracts structured data (e.g., name, email, phone number) using [OpenRouter.ai](http://OpenRouter.ai) and saves it to Microsoft To Do for follow-up tasks.  \nSave Images to OneDrive:\n\nImages are uploaded to OneDrive, renamed based on their unique message ID, and linked in Microsoft Teams for reference.\n\n**Send Feedback via LINE:**  \nThe workflow replies to the user with confirmation messages, such as \"[ Task Created ]\" or \"[ Message Saved ].\"\n\n## Setup Guide\n\n**Pre-Requisites**\n\n  * Access to the LINE Developers Console to configure your webhook and bot.\n  * Accounts for Microsoft Teams , Microsoft To Do, and OneDrive with API access.\n  * An [OpenRouter.ai](http://OpenRouter.ai) account with credentials to access models like GPT-4o.\n  * Basic knowledge of APIs, webhooks, and JSON formatting.\n\n\n\n**Step-by-Step Setup**\n\n  1. Configure the LINE Webhook:\n\n\n  * Go to the LINE Developers Console and set up a webhook to receive incoming messages.\n  * Copy the Webhook URL from the Line Webhook node and paste it into the LINE Console.\n  * Remove any \"test\" configurations when moving to production.\n\n\n  1. Set Up Microsoft Integrations:\n\n\n  * Connect your Microsoft Teams, Microsoft To Do, and OneDrive accounts to the respective nodes in the workflow.\n\n\n  1. Set Up [OpenRouter.ai](http://OpenRouter.ai):\n\n\n  * Create an account on [OpenRouter.ai](http://OpenRouter.ai) and obtain your API credentials.\n  * Connect your credentials to the OpenRouter nodes in the workflow.\n\n\n\n**Test the Workflow:**\n\n  * Simulate sending text, images, and namecards to the LINE bot to verify that all actions are processed correctly.\n\n\n\n## How to Customize This Workflow to Your Needs\n\n  * Add More Actions: Extend the workflow to handle additional input types or integrate with other tools.\n  * Enhance Image Processing: Use advanced OCR tools to improve text extraction from complex images.\n  * Customize Feedback Messages: Modify the reply format to include emojis, links, or other formatting options.\n  * Expand Use Cases: Adapt the workflow for specific industries, such as sales or customer support, by tailoring the actions to relevant tasks.\n\n\n\n**Why Use This Template?**\n\n  * Versatile Automation: Handles multiple input types (text, images, namecards) with ease.\n  * Seamless Integration: Connects LINE messages to popular productivity tools like Microsoft Teams and To Do.\n  * Structured Data Extraction: Extracts and organizes data from namecards, saving time and effort.\n  * Real-Time Feedback: Keeps users informed about the status of their requests with instant notifications.\n\n\n",
  "crawled_at": "2025-05-26T04:25:12.100539",
  "readme_zh": "该工作流模板《个人助理：消息记录与名片信息提取》专为优化LINE平台消息处理流程而设计，整合了Microsoft Teams、Microsoft To Do、OneDrive及OpenRouter.ai等工具，实现笔记保存、名片信息提取和图片整理功能。无论是提升个人效率还是团队自动化协作，本模板都提供高度灵活的定制化解决方案。\n\n通过此工作流，您可以自动化重复任务、加强协作效能，并显著提升LINE消息处理效率。\n\n▍适用人群\n• 职场人士：自动保存重要消息、提取名片数据或整理图片\n• 团队用户：将LINE消息无缝对接Microsoft Teams和To Do实现协同办公\n• 开发者：构建智能流程处理LINE的文本/图片等多样化输入\n• 企业主：高效管理客户互动、跟进事项及任务追踪\n\n▍核心价值\nLINE消息管理常因文本/图片/名片等混合内容耗时费力，本工作流通过以下方式解决问题：\n√ 智能识别消息类型并自动分流处理\n√ 从名片提取结构化数据并生成待办事项\n√ 图片自动上传至OneDrive，文本消息存档至Teams/To Do\n√ 通过LINE实时反馈处理结果\n\n▍功能详解\n❶ LINE Webhook接收\n• 当用户向LINE机器人发送消息（文本/图片等）时触发流程\n\n❷ 加载动画展示\n• 显示处理状态提升用户体验\n\n❸ 智能消息路由\n通过Switch节点自动识别：\n• 以\"T\"开头的文本 → 生成Microsoft To Do任务\n• 普通文本 → 保存至Teams指定频道（如\"笔记\"）\n• 图片 → 智能识别名片/手写笔记等类型\n• 不支持格式 → 返回友好提示\n\n❹ 名片处理\n• 通过OpenRouter.ai提取结构化数据（姓名/邮箱/电话等）\n• 自动生成Microsoft To Do跟进任务\n\n❺ 图片管理\n• 上传至OneDrive并按消息ID重命名\n• 在Teams中创建可追溯的图片链接\n\n❻ 实时反馈\n• 发送处理结果通知（如[任务已创建]/[消息已存档]）\n\n▍配置指南\n▶ 准备工作\n• LINE Developers Console配置权限\n• Microsoft系列产品API访问权限\n• OpenRouter.ai账户及GPT-4o等模型权限\n• 基础API/Webhook/JSON知识\n\n▶ 分步配置\n1. LINE Webhook设置\n   - 在LINE开发者平台配置Webhook URL\n   - 部署时移除测试配置\n\n2. 微软服务对接\n   - 将Teams/To Do/OneDrive账户关联至对应节点\n\n3. OpenRouter.ai配置\n   - 注册获取API凭证并绑定工作流\n\n▶ 测试验证\n模拟发送各类消息（文本/图片/名片）测试全流程\n\n▍定制拓展\n• 扩展功能：支持更多输入类型或集成其他工具\n• 图像增强：采用高级OCR处理复杂图片\n• 反馈优化：自定义表情/链接等回复格式\n• 场景适配：针对销售/客服等场景定制流程\n\n▍模板优势\n★ 全能处理：轻松应对文本/图片/名片等混合输入\n★ 无缝衔接：联通LINE与主流办公工具\n★ 智能解析：自动提取名片数据省时省力\n★ 即时响应：实时状态通知提升用户体验",
  "title_zh": "LINE消息与GPT：轻松保存笔记、名片数据及任务",
  "publish_date_zh": "上次更新于8天前",
  "workflow_json_zh": "{\n  \"id\": \"HbjZ9cBPgDdnIRjG\",\n  \"meta\": {\n    \"instanceId\": \"558d88703fb65b2d0e44613bc35916258b0f0bf983c5d4730c00c424b77ca36a\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"name\": \"MiniBear Webhook\",\n  \"tags\": [\n    {\n      \"id\": \"0xpEHcJjNRRRMtEj\",\n      \"name\": \"lin\",\n      \"createdAt\": \"2025-03-12T05:06:24.112Z\",\n      \"updatedAt\": \"2025-03-12T05:06:24.112Z\"\n    },\n    {\n      \"id\": \"IhTa6egt1w8uqn9Z\",\n      \"name\": \"_ACTIVE\",\n      \"createdAt\": \"2025-03-12T05:07:05.060Z\",\n      \"updatedAt\": \"2025-03-12T05:07:05.060Z\"\n    },\n    {\n      \"id\": \"Q0IWVCdrzoxXDC7z\",\n      \"name\": \"error_linlinmhee_line\",\n      \"createdAt\": \"2025-03-12T06:37:16.225Z\",\n      \"updatedAt\": \"2025-03-12T06:37:16.225Z\"\n    },\n    {\n      \"id\": \"U1ozjO3iXQZWUyfG\",\n      \"name\": \"_Blueprint\",\n      \"createdAt\": \"2025-03-12T06:24:40.268Z\",\n      \"updatedAt\": \"2025-03-12T06:24:40.268Z\"\n    }\n  ],\n  \"nodes\": [\n    {\n      \"id\": \"b1f42cbd-952e-4704-9233-788891e1894d\",\n      \"name\": \"Line Webhook\",\n      \"type\": \"n8n-nodes-base.webhook\",\n      \"position\": [\n        -260,\n        -20\n      ],\n      \"webhookId\": \"4ef1a53c-a1ec-4a63-a7a5-469423502333\",\n      \"parameters\": {\n        \"path\": \"minibear\",\n        \"options\": {},\n        \"httpMethod\": \"POST\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"ae4a46d6-0f34-484b-8be5-dbc07d5de92e\",\n      \"name\": \"Line Loading Animation\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        120,\n        -20\n      ],\n      \"parameters\": {\n        \"url\": \"https://api.line.me/v2/bot/chat/loading/start\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"jsonBody\": \"={\\n    \\\"chatId\\\": \\\"{{ $json.body.events[0].source.userId }}\\\",\\n    \\\"loadingSeconds\\\": 60\\n}\",\n        \"sendBody\": true,\n        \"specifyBody\": \"json\",\n        \"authentication\": \"genericCredentialType\",\n        \"genericAuthType\": \"httpHeaderAuth\"\n      },\n      \"credentials\": {\n        \"httpHeaderAuth\": {\n          \"id\": \"lKd3b2nc8uNJ148Z\",\n          \"name\": \"Line @271dudsw MiniBear\"\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"802eb4b2-ed1c-4cbc-9cf9-9bd8fec74b82\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -380,\n        -100\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 360,\n        \"height\": 560,\n        \"content\": \"**来自Line的Webhook**\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"965612b6-bd04-44e9-9b95-d777f92e9acf\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        0,\n        -100\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 360,\n        \"height\": 560,\n        \"content\": \"**Line加载动画**\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"92953054-43a6-44a3-8069-6147cbb837c3\",\n      \"name\": \"Switch\",\n      \"type\": \"n8n-nodes-base.switch\",\n      \"position\": [\n        500,\n        80\n      ],\n      \"parameters\": {\n        \"rules\": {\n          \"values\": [\n            {\n              \"outputKey\": \"Task\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"6f9aef97-cf2f-4f8e-bbc5-c17069a24c57\",\n                    \"operator\": {\n                      \"type\": \"string\",\n                      \"operation\": \"startsWith\"\n                    },\n                    \"leftValue\": \"={{ $('Line Webhook').item.json.body.events[0].message.text }}\",\n                    \"rightValue\": \"T \"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            },\n            {\n              \"outputKey\": \"text\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"9f8075cf-8f3f-419f-ae0a-833ee29fc063\",\n                    \"operator\": {\n                      \"type\": \"string\",\n                      \"operation\": \"equals\"\n                    },\n                    \"leftValue\": \"={{ $('Line Webhook').item.json.body.events[0].message.type }}\",\n                    \"rightValue\": \"text\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            },\n            {\n              \"outputKey\": \"img\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"b7770f5b-dfb5-4b7a-8dc1-4404337dbfde\",\n                    \"operator\": {\n                      \"name\": \"filter.operator.equals\",\n                      \"type\": \"string\",\n                      \"operation\": \"equals\"\n                    },\n                    \"leftValue\": \"={{ $('Line Webhook').item.json.body.events[0].message.type }}\",\n                    \"rightValue\": \"image\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            },\n            {\n              \"outputKey\": \"audio\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"9faa9dd4-32ce-4287-b7e5-885a42a62e32\",\n                    \"operator\": {\n                      \"name\": \"filter.operator.equals\",\n                      \"type\": \"string\",\n                      \"operation\": \"equals\"\n                    },\n                    \"leftValue\": \"={{ $('Line Webhook').item.json.body.events[0].message.type }}\",\n                    \"rightValue\": \"audio\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            },\n            {\n              \"outputKey\": \"else\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"f4dbfa6a-a7f8-4c32-a94d-da384f37c0d1\",\n                    \"operator\": {\n                      \"type\": \"boolean\",\n                      \"operation\": \"true\",\n                      \"singleValue\": true\n                    },\n                    \"leftValue\": true,\n                    \"rightValue\": \"\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            }\n          ]\n        },\n        \"options\": {}\n      },\n      \"typeVersion\": 3.2\n    },\n    {\n      \"id\": \"ae9e08a3-0106-4e49-85b3-84eb9696673c\",\n      \"name\": \"Sticky Note5\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        380,\n        -100\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 360,\n        \"height\": 560,\n        \"content\": \"**任务路由器（以'T'开头的文本）、其他文本、图片及其他内容**\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"933b7da4-95fd-4bb2-ac46-3eac62d0dcaa\",\n      \"name\": \"Get Image\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        900,\n        80\n      ],\n      \"parameters\": {\n        \"url\": \"=https://api-data.line.me/v2/bot/message/{{ $('Line Webhook').item.json.body.events[0].message.id }}/content\",\n        \"options\": {},\n        \"authentication\": \"genericCredentialType\",\n        \"genericAuthType\": \"httpHeaderAuth\"\n      },\n      \"credentials\": {\n        \"httpHeaderAuth\": {\n          \"id\": \"lKd3b2nc8uNJ148Z\",\n          \"name\": \"Line @271dudsw MiniBear\"\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"d1160e8d-b84a-4e76-b5cc-f8c960a6070b\",\n      \"name\": \"Sticky Note9\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        820,\n        460\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 360,\n        \"height\": 480,\n        \"content\": \"**线路回复**\\n回复该消息不被支持\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"b169657d-5348-4662-bdcf-6617416ec9f7\",\n      \"name\": \"Line Reply (image)\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        3140,\n        200\n      ],\n      \"parameters\": {\n        \"url\": \"https://api.line.me/v2/bot/message/reply\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"jsonBody\": \"={\\n  \\\"replyToken\\\": \\\"{{ $('Line Webhook').item.json.body.events[0].replyToken }}\\\",\\n  \\\"messages\\\": [\\n    {\\n      \\\"type\\\": \\\"text\\\",\\n      \\\"text\\\": \\\"[ Message Saved in Zac&Lin > Notes ]\\\"\\n    }\\n  ]\\n} \",\n        \"sendBody\": true,\n        \"specifyBody\": \"json\",\n        \"authentication\": \"genericCredentialType\",\n        \"genericAuthType\": \"httpHeaderAuth\"\n      },\n      \"credentials\": {\n        \"httpHeaderAuth\": {\n          \"id\": \"lKd3b2nc8uNJ148Z\",\n          \"name\": \"Line @271dudsw MiniBear\"\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"b0f63685-e8df-484e-85ea-bedabd80b61e\",\n      \"name\": \"Line Reply (Text)\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1300,\n        -340\n      ],\n      \"parameters\": {\n        \"url\": \"https://api.line.me/v2/bot/message/reply\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"jsonBody\": \"={\\n  \\\"replyToken\\\": \\\"{{ $('Line Webhook').item.json.body.events[0].replyToken }}\\\",\\n  \\\"messages\\\": [\\n    {\\n      \\\"type\\\": \\\"text\\\",\\n      \\\"text\\\": \\\"[ Message Saved in Zac&Lin > Notes ]\\\" \\n    }\\n  ]\\n} \",\n        \"sendBody\": true,\n        \"specifyBody\": \"json\",\n        \"authentication\": \"genericCredentialType\",\n        \"genericAuthType\": \"httpHeaderAuth\"\n      },\n      \"credentials\": {\n        \"httpHeaderAuth\": {\n          \"id\": \"lKd3b2nc8uNJ148Z\",\n          \"name\": \"Line @271dudsw MiniBear\"\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"b2ee3bb5-7cdf-46de-868e-f6b81a2e0ec0\",\n      \"name\": \"Line Reply (Not Supported 2)\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        940,\n        740\n      ],\n      \"parameters\": {\n        \"url\": \"https://api.line.me/v2/bot/message/reply\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"jsonBody\": \"={\\n  \\\"replyToken\\\": \\\"{{ $('Line Webhook').item.json.body.events[0].replyToken }}\\\",\\n  \\\"messages\\\": [\\n    {\\n      \\\"type\\\": \\\"text\\\",\\n      \\\"text\\\": \\\"Please try again. Message type is not supported\\\"\\n    }\\n  ]\\n} \",\n        \"sendBody\": true,\n        \"specifyBody\": \"json\",\n        \"authentication\": \"genericCredentialType\",\n        \"genericAuthType\": \"httpHeaderAuth\"\n      },\n      \"credentials\": {\n        \"httpHeaderAuth\": {\n          \"id\": \"3IEOzxKOUr6OEXyU\",\n          \"name\": \"Line @405jtfqs LazyChinese\"\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"04f298c3-e952-4d85-aba7-0971d2f6a8b0\",\n      \"name\": \"Line Reply (Not Supported 1)\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        940,\n        540\n      ],\n      \"parameters\": {\n        \"url\": \"https://api.line.me/v2/bot/message/reply\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"jsonBody\": \"={\\n  \\\"replyToken\\\": \\\"{{ $('Line Webhook').item.json.body.events[0].replyToken }}\\\",\\n  \\\"messages\\\": [\\n    {\\n      \\\"type\\\": \\\"text\\\",\\n      \\\"text\\\": \\\"Please try again. Message type is not supported\\\"\\n    }\\n  ]\\n} \",\n        \"sendBody\": true,\n        \"specifyBody\": \"json\",\n        \"authentication\": \"genericCredentialType\",\n        \"genericAuthType\": \"httpHeaderAuth\"\n      },\n      \"credentials\": {\n        \"httpHeaderAuth\": {\n          \"id\": \"3IEOzxKOUr6OEXyU\",\n          \"name\": \"Line @405jtfqs LazyChinese\"\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"1d6d7c55-59ba-48c4-a877-6f260ede7bf5\",\n      \"name\": \"OpenRouter Chat Model\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatOpenRouter\",\n      \"position\": [\n        1060,\n        200\n      ],\n      \"parameters\": {\n        \"model\": \"openai/gpt-4o\",\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"openRouterApi\": {\n          \"id\": \"iQS3GMHjRv36CWYD\",\n          \"name\": \"n8n Lin\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"dae07428-733a-4976-9553-cba198736403\",\n      \"name\": \"Image Router\",\n      \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n      \"position\": [\n        1040,\n        80\n      ],\n      \"parameters\": {\n        \"text\": \"You'll identify the image\\n01 Namecard\\n02 Text on screen or handwritten note\\n03 Others\\n\\nYou'll answer with only 01 02 or 03\",\n        \"options\": {\n          \"passthroughBinaryImages\": true\n        },\n        \"promptType\": \"define\"\n      },\n      \"typeVersion\": 1.8,\n      \"alwaysOutputData\": true\n    },\n    {\n      \"id\": \"1810b10b-d326-4626-836c-4fb706deff20\",\n      \"name\": \"Microsoft Teams\",\n      \"type\": \"n8n-nodes-base.microsoftTeams\",\n      \"position\": [\n        1020,\n        -340\n      ],\n      \"webhookId\": \"3a9c75de-5207-4e9b-a558-6c2fd622fb5f\",\n      \"parameters\": {\n        \"teamId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"ebfd67d4-df6b-4ea2-9faf-81ec059170ad\",\n          \"cachedResultName\": \"Zac&Lin\"\n        },\n        \"message\": \"={{ $('Line Webhook').item.json.body.events[0].message.text.replace('\\\\n\\\\n', '<br><br>').replace('\\\\n', '<br>') }}\",\n        \"options\": {},\n        \"resource\": \"channelMessage\",\n        \"channelId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"19:c2966307089a4f4b98ca06b5f160999a@thread.tacv2\",\n          \"cachedResultUrl\": \"https://teams.microsoft.com/l/channel/19%3Ac2966307089a4f4b98ca06b5f160999a%40thread.tacv2/Notes?groupId=ebfd67d4-df6b-4ea2-9faf-81ec059170ad&tenantId=77e73351-d19d-4855-9380-82ca9b459c87&allowXTenantAccess=True&ngc=True\",\n          \"cachedResultName\": \"Notes\"\n        },\n        \"contentType\": \"html\"\n      },\n      \"credentials\": {\n        \"microsoftTeamsOAuth2Api\": {\n          \"id\": \"3oENQ6chN2T1DR2x\",\n          \"name\": \"Microsoft Teams account\"\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"b98955e9-1c4c-473f-ac51-a8d73747ae63\",\n      \"name\": \"Microsoft To Do\",\n      \"type\": \"n8n-nodes-base.microsoftToDo\",\n      \"position\": [\n        1020,\n        -600\n      ],\n      \"parameters\": {\n        \"title\": \"={{ $('Line Webhook').item.json.body.events[0].message.text.replace('T ','') }}\",\n        \"operation\": \"create\",\n        \"taskListId\": \"AQMkAGE1NDhhM2UxLTA3ZTQtNGIyYS1iOWFjLTlkNDAyYzkzNjE2YQAuAAADCPe-x7aF5Eqh4_vJsot6MAEAG9nUtifnkkavLabXdl_kugAAAgESAAAA\",\n        \"additionalFields\": {}\n      },\n      \"credentials\": {\n        \"microsoftToDoOAuth2Api\": {\n          \"id\": \"Pag1nTvXIzYpG5V1\",\n          \"name\": \"Microsoft To Do account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"59202467-34c6-4580-8039-fca99c9467ca\",\n      \"name\": \"Line Reply (Text)1\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1300,\n        -600\n      ],\n      \"parameters\": {\n        \"url\": \"https://api.line.me/v2/bot/message/reply\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"jsonBody\": \"={\\n  \\\"replyToken\\\": \\\"{{ $('Line Webhook').item.json.body.events[0].replyToken }}\\\",\\n  \\\"messages\\\": [\\n    {\\n      \\\"type\\\": \\\"text\\\",\\n      \\\"text\\\": \\\"[ Task : {{ $('Line Webhook').item.json.body.events[0].message.text.replace('T ','') }} created successfully in Private Task ]\\\" \\n    }\\n  ]\\n} \",\n        \"sendBody\": true,\n        \"specifyBody\": \"json\",\n        \"authentication\": \"genericCredentialType\",\n        \"genericAuthType\": \"httpHeaderAuth\"\n      },\n      \"credentials\": {\n        \"httpHeaderAuth\": {\n          \"id\": \"lKd3b2nc8uNJ148Z\",\n          \"name\": \"Line @271dudsw MiniBear\"\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"525f0a8b-0c03-4182-ab2b-ff97ba6ad50d\",\n      \"name\": \"If namecard\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        1480,\n        80\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"85dc209c-a217-46a7-8289-b3e98c128d05\",\n              \"operator\": {\n                \"name\": \"filter.operator.equals\",\n                \"type\": \"string\",\n                \"operation\": \"equals\"\n              },\n              \"leftValue\": \"={{ $json.output }}\",\n              \"rightValue\": \"01\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"113ab6ea-d66d-4b8d-ae81-eee73439c90e\",\n      \"name\": \"Other Images\",\n      \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n      \"position\": [\n        2440,\n        200\n      ],\n      \"parameters\": {\n        \"text\": \"=If the image is handwritten notes or text on screen in thai or english, you'll extract the text.\\n\\nElse, you'll describe the image\",\n        \"options\": {\n          \"passthroughBinaryImages\": true\n        },\n        \"promptType\": \"define\"\n      },\n      \"typeVersion\": 1.8\n    },\n    {\n      \"id\": \"596a643e-757a-4b83-878b-f5a0f1c42886\",\n      \"name\": \"Microsoft Teams1\",\n      \"type\": \"n8n-nodes-base.microsoftTeams\",\n      \"position\": [\n        2880,\n        200\n      ],\n      \"webhookId\": \"3a9c75de-5207-4e9b-a558-6c2fd622fb5f\",\n      \"parameters\": {\n        \"teamId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"ebfd67d4-df6b-4ea2-9faf-81ec059170ad\",\n          \"cachedResultName\": \"Zac&Lin\"\n        },\n        \"message\": \"={{ $json.output.replace('\\\\n\\\\n', '<br><br>').replace('\\\\n', '<br>') }}\\n<br><br>\\n<img src=\\\"{{ $('Get Image2').item.json['@microsoft.graph.downloadUrl'] }}\\\">\\n</img>\",\n        \"options\": {},\n        \"resource\": \"channelMessage\",\n        \"channelId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"19:c2966307089a4f4b98ca06b5f160999a@thread.tacv2\",\n          \"cachedResultUrl\": \"https://teams.microsoft.com/l/channel/19%3Ac2966307089a4f4b98ca06b5f160999a%40thread.tacv2/Notes?groupId=ebfd67d4-df6b-4ea2-9faf-81ec059170ad&tenantId=77e73351-d19d-4855-9380-82ca9b459c87&allowXTenantAccess=True&ngc=True\",\n          \"cachedResultName\": \"Notes\"\n        },\n        \"contentType\": \"html\"\n      },\n      \"credentials\": {\n        \"microsoftTeamsOAuth2Api\": {\n          \"id\": \"3oENQ6chN2T1DR2x\",\n          \"name\": \"Microsoft Teams account\"\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"be5637d9-50a7-4508-b6f9-d32ac37bb2c2\",\n      \"name\": \"OpenRouter Chat Model2\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatOpenRouter\",\n      \"position\": [\n        2460,\n        320\n      ],\n      \"parameters\": {\n        \"model\": \"openai/gpt-4o\",\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"openRouterApi\": {\n          \"id\": \"iQS3GMHjRv36CWYD\",\n          \"name\": \"n8n Lin\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"a7114805-80bf-428a-a717-b35cb6eb3312\",\n      \"name\": \"Microsoft OneDrive\",\n      \"type\": \"n8n-nodes-base.microsoftOneDrive\",\n      \"position\": [\n        1820,\n        200\n      ],\n      \"parameters\": {\n        \"fileName\": \"testtest.jpg\",\n        \"parentId\": \"01I7MG5Y2G7ELINW2YLJBLHHF5KDBNJDPF\",\n        \"binaryData\": true\n      },\n      \"credentials\": {\n        \"microsoftOneDriveOAuth2Api\": {\n          \"id\": \"pM363KMLOo6btGCp\",\n          \"name\": \"Microsoft Drive account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"7a6f14a2-938f-40f8-a294-564fb1185de3\",\n      \"name\": \"Microsoft OneDrive1\",\n      \"type\": \"n8n-nodes-base.microsoftOneDrive\",\n      \"position\": [\n        2000,\n        200\n      ],\n      \"parameters\": {\n        \"itemId\": \"={{ $json.id }}\",\n        \"newName\": \"={{ $('Line Webhook').item.json.body.events[0].message.id }}.jpg\",\n        \"operation\": \"rename\"\n      },\n      \"credentials\": {\n        \"microsoftOneDriveOAuth2Api\": {\n          \"id\": \"pM363KMLOo6btGCp\",\n          \"name\": \"Microsoft Drive account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"864fe7c5-f8f9-429e-94b7-2b760af09cd4\",\n      \"name\": \"Get Image2\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        2260,\n        200\n      ],\n      \"parameters\": {\n        \"url\": \"=https://api-data.line.me/v2/bot/message/{{ $('Line Webhook').item.json.body.events[0].message.id }}/content\",\n        \"options\": {},\n        \"authentication\": \"genericCredentialType\",\n        \"genericAuthType\": \"httpHeaderAuth\"\n      },\n      \"credentials\": {\n        \"httpHeaderAuth\": {\n          \"id\": \"lKd3b2nc8uNJ148Z\",\n          \"name\": \"Line @271dudsw MiniBear\"\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"f1108c52-9e9c-4611-9a2a-40f28871632a\",\n      \"name\": \"Microsoft To Do1\",\n      \"type\": \"n8n-nodes-base.microsoftToDo\",\n      \"position\": [\n        2400,\n        -260\n      ],\n      \"parameters\": {\n        \"title\": \"=Follow-up Namecard {{ $json.output.Email }}\",\n        \"operation\": \"create\",\n        \"taskListId\": \"AQMkAGE1NDhhM2UxLTA3ZTQtNGIyYS1iOWFjLTlkNDAyYzkzNjE2YQAuAAADCPe-x7aF5Eqh4_vJsot6MAEAG9nUtifnkkavLabXdl_kugAAAgESAAAA\",\n        \"additionalFields\": {}\n      },\n      \"credentials\": {\n        \"microsoftToDoOAuth2Api\": {\n          \"id\": \"Pag1nTvXIzYpG5V1\",\n          \"name\": \"Microsoft To Do account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"2afe30ad-ef70-45e8-9e3c-546bd3cf91a8\",\n      \"name\": \"HTTP Request\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        2960,\n        -260\n      ],\n      \"parameters\": {\n        \"url\": \"https://hook.us2.make.com/46263sznm3didxdkcuqvnlfqv2fv2l7q\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"sendBody\": true,\n        \"bodyParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"MessageID\",\n              \"value\": \"={{ $('Line Webhook').item.json.body.events[0].message.id }}\"\n            },\n            {\n              \"name\": \"Content\",\n              \"value\": \"={{ $('NamecardExtract').item.json.output }}\"\n            },\n            {\n              \"name\": \"ReplyToken\",\n              \"value\": \"={{ $('Line Webhook').item.json.body.events[0].replyToken }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"a94bcdea-f8cc-4eb9-847a-66eb3808ed5b\",\n      \"name\": \"OpenRouter Chat Model3\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatOpenRouter\",\n      \"position\": [\n        2000,\n        -140\n      ],\n      \"parameters\": {\n        \"model\": \"openai/gpt-4o\",\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"openRouterApi\": {\n          \"id\": \"iQS3GMHjRv36CWYD\",\n          \"name\": \"n8n Lin\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"f138bdcf-1b46-4c14-b443-db2f1e3055f4\",\n      \"name\": \"NamecardExtract\",\n      \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n      \"position\": [\n        2000,\n        -260\n      ],\n      \"parameters\": {\n        \"text\": \"=You'll extract the data in JSON format \\n\\n--- \\n{   \\\"Nickname\\\": \\\"\\\",   \\\"FirstName\\\": \\\"\\\",   \\\"LastName\\\": \\\"\\\",   \\\"CompanyFull\\\": \\\"\\\",   \\\"Department\\\": \\\"\\\",   \\\"JobTitle\\\": \\\"\\\",   \\\"Mobile\\\": \\\"\\\",   \\\"Mobile2\\\": \\\"\\\",   \\\"Email\\\": \\\"\\\",   \\\"SocialMedia\\\": \\\"\\\",   \\\"Address\\\": \\\"\\\",   \\\"Remark\\\": \\\"\\\",   \\\"NameTH\\\": \\\"\\\" } \\n--- \\nFor Nickname, you'll see if there's any short name in the namecard. For Name TH, you'll see if there's thai name on the namecard. \\n\",\n        \"options\": {\n          \"passthroughBinaryImages\": true\n        },\n        \"promptType\": \"define\",\n        \"hasOutputParser\": true\n      },\n      \"typeVersion\": 1.8\n    },\n    {\n      \"id\": \"df565b73-3cfe-464e-b5d2-36f2240da218\",\n      \"name\": \"Structured Output Parser\",\n      \"type\": \"@n8n/n8n-nodes-langchain.outputParserStructured\",\n      \"position\": [\n        2180,\n        -140\n      ],\n      \"parameters\": {\n        \"jsonSchemaExample\": \"{   \\\"Nickname\\\": \\\"\\\",   \\\"FirstName\\\": \\\"\\\",   \\\"LastName\\\": \\\"\\\",   \\\"CompanyFull\\\": \\\"\\\",   \\\"Department\\\": \\\"\\\",   \\\"JobTitle\\\": \\\"\\\",   \\\"Mobile\\\": \\\"\\\",   \\\"Mobile2\\\": \\\"\\\",   \\\"Email\\\": \\\"\\\",   \\\"SocialMedia\\\": \\\"\\\",   \\\"Address\\\": \\\"\\\",   \\\"Remark\\\": \\\"\\\",   \\\"NameTH\\\": \\\"\\\" } \"\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"c7b2b87f-3507-4a0f-a1d0-7ab9a131a619\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1220,\n        -680\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 260,\n        \"height\": 240,\n        \"content\": \"**线路回复**\\n用于发送任务已添加的反馈\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"6448ffd8-4a5d-4cb7-826a-b594952c6773\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1220,\n        -420\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 260,\n        \"height\": 240,\n        \"content\": \"**线路回复**\\n反馈信息已保存并发送\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"f222d983-26a5-4806-8f86-1eb32982f558\",\n      \"name\": \"Sticky Note4\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        940,\n        -680\n      ],\n      \"parameters\": {\n        \"color\": 2,\n        \"width\": 260,\n        \"height\": 240,\n        \"content\": \"**任务**\\n添加到微软“待办事项”列表\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"d13b3145-d9c5-41bb-a384-996fcdbbc19c\",\n      \"name\": \"Sticky Note6\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        940,\n        -420\n      ],\n      \"parameters\": {\n        \"color\": 3,\n        \"width\": 260,\n        \"height\": 240,\n        \"content\": \"**MS Teams**  \\n将此消息保存在MS Teams中\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"001dd5c9-b56e-47f1-bd71-31c3b2a7810c\",\n      \"name\": \"Sticky Note7\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        2320,\n        -340\n      ],\n      \"parameters\": {\n        \"color\": 2,\n        \"width\": 260,\n        \"height\": 240,\n        \"content\": \"**任务**\\n将这张名片添加到微软“待办事项”列表中以便跟进\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"94519356-9e65-473f-bfad-f89d0aecc7ff\",\n      \"name\": \"Sticky Note8\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        2600,\n        -340\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 260,\n        \"height\": 240,\n        \"content\": \"**线路回复**\\n反馈信息已保存并发送\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"28c490ad-5fa9-435c-8d06-d3bb21c8d454\",\n      \"name\": \"Line Reply Namecard\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        2680,\n        -260\n      ],\n      \"parameters\": {\n        \"url\": \"https://api.line.me/v2/bot/message/reply\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"jsonBody\": \"={\\n  \\\"replyToken\\\": \\\"{{ $('Line Webhook').item.json.body.events[0].replyToken }}\\\",\\n  \\\"messages\\\": [\\n    {\\n      \\\"type\\\": \\\"text\\\",\\n      \\\"text\\\": \\\"[ Namecard Extraction ] /n/n {{ $('NamecardExtract').item.json.output }}\\\" \\n    }\\n  ]\\n} \",\n        \"sendBody\": true,\n        \"specifyBody\": \"json\",\n        \"authentication\": \"genericCredentialType\",\n        \"genericAuthType\": \"httpHeaderAuth\"\n      },\n      \"credentials\": {\n        \"httpHeaderAuth\": {\n          \"id\": \"lKd3b2nc8uNJ148Z\",\n          \"name\": \"Line @271dudsw MiniBear\"\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"67dd6ba3-6382-465b-a3a9-2d438e67aaf3\",\n      \"name\": \"Sticky Note10\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        2880,\n        -340\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 260,\n        \"height\": 240,\n        \"content\": \"**HTTP请求**  \\n此操作用于触发另一个工作流程，以在MS Excel 365中添加新行。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"e8fb90be-1371-4bf1-a945-e6fcedacb8fb\",\n      \"name\": \"Sticky Note11\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        3080,\n        120\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 260,\n        \"height\": 240,\n        \"content\": \"**线路回复**\\n反馈信息已保存\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"c43ec591-b882-4eba-95f3-827153af5890\",\n      \"name\": \"Sticky Note12\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        2800,\n        120\n      ],\n      \"parameters\": {\n        \"color\": 3,\n        \"width\": 260,\n        \"height\": 240,\n        \"content\": \"**MS Teams**  \\n将此消息保存在MS Teams中\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"150c2ea3-aca6-40da-879a-ee7204f00a5f\",\n      \"name\": \"Sticky Note13\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        840,\n        -40\n      ],\n      \"parameters\": {\n        \"color\": 6,\n        \"width\": 520,\n        \"height\": 400,\n        \"content\": \"**识别图片**\\n首先，我们将从Line获取图片，然后使用工具代理查询OpenRouter，以判断这是否为名片。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"694d260b-1570-430b-9a5b-5b4962af9b8b\",\n      \"name\": \"Sticky Note14\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1780,\n        -380\n      ],\n      \"parameters\": {\n        \"color\": 6,\n        \"width\": 520,\n        \"height\": 400,\n        \"content\": \"**名片信息提取**\\n首先，我们将从Line获取图像，然后使用工具代理查询OpenRouter，以结构化格式提取名片信息。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"c437c0d5-3022-4469-ac3c-ceea9aaf1689\",\n      \"name\": \"Get Image3\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1860,\n        -260\n      ],\n      \"parameters\": {\n        \"url\": \"=https://api-data.line.me/v2/bot/message/{{ $('Line Webhook').item.json.body.events[0].message.id }}/content\",\n        \"options\": {},\n        \"authentication\": \"genericCredentialType\",\n        \"genericAuthType\": \"httpHeaderAuth\"\n      },\n      \"credentials\": {\n        \"httpHeaderAuth\": {\n          \"id\": \"lKd3b2nc8uNJ148Z\",\n          \"name\": \"Line @271dudsw MiniBear\"\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"91cf0e34-831a-4c56-92bb-e26319713874\",\n      \"name\": \"Sticky Note15\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1400,\n        -40\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 280,\n        \"height\": 400,\n        \"content\": \"**路由器名片与否**\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"65261cba-e104-404a-8af6-3c2b6cf85c2a\",\n      \"name\": \"Sticky Note16\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        2220,\n        80\n      ],\n      \"parameters\": {\n        \"color\": 6,\n        \"width\": 520,\n        \"height\": 400,\n        \"content\": \"**文本提取**  \\n首先，我们将从Line获取图像，然后使用工具代理查询OpenRouter来识别图像内容，例如其中所写的内容。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"1170527e-0ac7-4a8b-8ae8-420713a046fa\",\n      \"name\": \"Sticky Note17\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1740,\n        80\n      ],\n      \"parameters\": {\n        \"width\": 440,\n        \"height\": 340,\n        \"content\": \"**上传至OneDrive**  \\n此操作用于将文件上传至OneDrive。由于我遇到的某些问题，我们需要再次重命名该文件。\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"active\": true,\n  \"pinData\": {},\n  \"settings\": {\n    \"timezone\": \"Asia/Bangkok\",\n    \"callerPolicy\": \"workflowsFromSameOwner\",\n    \"errorWorkflow\": \"A8HoJ5iCrAMPbsLh\",\n    \"executionOrder\": \"v1\"\n  },\n  \"versionId\": \"49efe864-6f48-4c6c-853b-7e8542a7ea2f\",\n  \"connections\": {\n    \"Switch\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Microsoft To Do\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Microsoft Teams\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Get Image\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Line Reply (Not Supported 1)\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Line Reply (Not Supported 2)\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get Image\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Image Router\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get Image2\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Other Images\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get Image3\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"NamecardExtract\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"If namecard\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get Image3\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Microsoft OneDrive\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Image Router\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"If namecard\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Line Webhook\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Line Loading Animation\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Other Images\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Microsoft Teams1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Microsoft Teams\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Line Reply (Text)\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Microsoft To Do\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Line Reply (Text)1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"NamecardExtract\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Microsoft To Do1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Microsoft Teams1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Line Reply (image)\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Microsoft To Do1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Line Reply Namecard\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Microsoft OneDrive\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Microsoft OneDrive1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Line Reply Namecard\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"HTTP Request\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Microsoft OneDrive1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get Image2\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"OpenRouter Chat Model\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"Image Router\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Line Loading Animation\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Switch\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"OpenRouter Chat Model2\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"Other Images\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"OpenRouter Chat Model3\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"NamecardExtract\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Structured Output Parser\": {\n      \"ai_outputParser\": [\n        [\n          {\n            \"node\": \"NamecardExtract\",\n            \"type\": \"ai_outputParser\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}