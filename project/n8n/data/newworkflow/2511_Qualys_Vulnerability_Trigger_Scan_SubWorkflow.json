{
  "url": "https://n8n.io/workflows/2511-qualys-vulnerability-trigger-scan-subworkflow/",
  "title": "Qualys Vulnerability Trigger Scan SubWorkflow",
  "author": "Angel Menendez",
  "publish_date": "Last update 7 months ago",
  "publish_date_absolute": "2024-10-26",
  "categories": [
    {
      "name": "SecOps"
    }
  ],
  "workflow_json": "{\"meta\":{\"instanceId\":\"03e9d14e9196363fe7191ce21dc0bb17387a6e755dcc9acc4f5904752919dca8\"},\"nodes\":[{\"id\":\"be5b0c9c-de92-4e34-88cb-98e88b0c19df\",\"name\":\"Start VM Scan in Qualys\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[1340,500],\"parameters\":{\"\":\"\",\"url\":\"={{ $json.platformurl }}/api/2.0/fo/scan/\",\"method\":\"POST\",\"options\":{},\"sendBody\":true,\"sendQuery\":true,\"curlImport\":\"\",\"contentType\":\"multipart-form-data\",\"infoMessage\":\"\",\"sendHeaders\":true,\"specifyQuery\":\"keypair\",\"authentication\":\"predefinedCredentialType\",\"bodyParameters\":{\"parameters\":[{\"name\":\"asset_groups\",\"value\":\"={{ $json.asset_groups }}\",\"parameterType\":\"formData\"},{\"name\":\"scan_title\",\"value\":\"={{ $json.scan_title }}\",\"parameterType\":\"formData\"},{\"name\":\"option_title\",\"value\":\"={{ $json.option_title }}\",\"parameterType\":\"formData\"}]},\"specifyHeaders\":\"keypair\",\"queryParameters\":{\"parameters\":[{\"name\":\"action\",\"value\":\"launch\"}]},\"headerParameters\":{\"parameters\":[{\"name\":\"X-Requested-With\",\"value\":\"n8n\"}]},\"httpVariantWarning\":\"\",\"nodeCredentialType\":\"qualysApi\",\"provideSslCertificates\":false},\"credentials\":{\"qualysApi\":{\"id\":\"KdkmNjVYkDUzHAvw\",\"name\":\"Qualys account\"}},\"typeVersion\":4.2,\"extendsCredential\":\"qualysApi\"},{\"id\":\"0d140ce1-89e0-4135-821f-0b32004fc6aa\",\"name\":\"Convert XML to JSON\",\"type\":\"n8n-nodes-base.xml\",\"position\":[1540,500],\"parameters\":{\"options\":{},\"dataPropertyName\":\"=data\"},\"typeVersion\":1},{\"id\":\"ec737485-bf8b-4e8a-9843-2566c13106a8\",\"name\":\"Fetch Scan Results\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[2640,460],\"parameters\":{\"\":\"\",\"url\":\"={{ $('Demo Data').item.json[\\\"platformurl\\\"] }}/api/2.0/fo/scan/vm/summary\",\"method\":\"GET\",\"options\":{},\"sendBody\":false,\"sendQuery\":true,\"curlImport\":\"\",\"infoMessage\":\"\",\"sendHeaders\":true,\"specifyQuery\":\"keypair\",\"authentication\":\"predefinedCredentialType\",\"specifyHeaders\":\"keypair\",\"queryParameters\":{\"parameters\":[{\"name\":\"action\",\"value\":\"list\"},{\"name\":\"scan_reference\",\"value\":\"={{ $('Convert XML to JSON').item.json.SIMPLE_RETURN.RESPONSE.ITEM_LIST.ITEM[1].VALUE }}\"}]},\"headerParameters\":{\"parameters\":[{\"name\":\"X-Requested-With\",\"value\":\"n8n\"}]},\"httpVariantWarning\":\"\",\"nodeCredentialType\":\"qualysApi\",\"provideSslCertificates\":false},\"credentials\":{\"qualysApi\":{\"id\":\"KdkmNjVYkDUzHAvw\",\"name\":\"Qualys account\"}},\"typeVersion\":4.2,\"extendsCredential\":\"qualysApi\"},{\"id\":\"56a60798-3db1-4c69-962f-75009f894196\",\"name\":\"Loop Over Items\",\"type\":\"n8n-nodes-base.splitInBatches\",\"position\":[2220,420],\"parameters\":{\"options\":{\"reset\":true}},\"typeVersion\":3},{\"id\":\"37ac0cdf-8412-40c7-b01c-d592e4d1f378\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[2560,180],\"parameters\":{\"color\":7,\"width\":596.2964035541726,\"height\":493.43675548817004,\"content\":\"![Imgur](https://uploads.n8n.io/templates/qualys.png)\\nFor more information about the query that is being performed on the Qualys end, check out the [Manage Scans Documentation](https://qualysguard.qg2.apps.qualys.com/qwebhelp/fo_portal/api_doc/scans/index.htm#t=vm_scans%2Fmanage_vm_scans.htm). The results are returned in XML, which n8n can natively convert to JSON. This allows for easy checking of the status in n8n. \"},\"typeVersion\":1},{\"id\":\"075a4e21-cc30-4e31-a1f9-d2f872ab978c\",\"name\":\"Sticky Note3\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1274.994996265108,51.04030212612997],\"parameters\":{\"color\":7,\"width\":447.57018680355174,\"height\":642.6627860215806,\"content\":\"![Qualys](https://uploads.n8n.io/templates/qualys.png)\\n## Trigger scan on Qualys agent\\nFor more information on launching a scan, visit the\\n[Launch Documentation](\\nhttps://qualysguard.qg2.apps.qualys.com/qwebhelp/fo_portal/api_doc/scans/index.htm#t=vm_scans%2Flaunch_vm_scan.htm). The responses from Qualys are in XML, which n8n makes short work of. \"},\"typeVersion\":1},{\"id\":\"5da3f500-0ccf-4eed-9d05-7709668cf2bb\",\"name\":\"Wait 5 Min\",\"type\":\"n8n-nodes-base.wait\",\"position\":[2440,460],\"webhookId\":\"f2d07724-882a-4010-9ce2-ff389ee962af\",\"parameters\":{\"unit\":\"minutes\"},\"typeVersion\":1.1},{\"id\":\"5cf921ac-cd6b-4a27-b679-3d1ecdb3eb49\",\"name\":\"Convert XML to JSON1\",\"type\":\"n8n-nodes-base.xml\",\"position\":[2800,460],\"parameters\":{\"options\":{},\"dataPropertyName\":\"=data\"},\"typeVersion\":1},{\"id\":\"0580bb11-38c4-49a1-ab00-4cdfb49c8f9d\",\"name\":\"Check if Scan Finished\",\"type\":\"n8n-nodes-base.if\",\"position\":[3000,460],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"ef397200-064a-428f-a5b2-19d2342a9113\",\"operator\":{\"name\":\"filter.operator.equals\",\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $json.SCAN_SUMMARY_OUTPUT.RESPONSE.SCAN_SUMMARY_LIST.SCAN_SUMMARY.SCAN_DETAILS.STATUS }}\",\"rightValue\":\"FINISHED\"}]}},\"typeVersion\":2},{\"id\":\"ec05f06b-e009-4f1c-97e4-223705d3be32\",\"name\":\"Execute Workflow Trigger\",\"type\":\"n8n-nodes-base.executeWorkflowTrigger\",\"position\":[260,520],\"parameters\":{},\"typeVersion\":1},{\"id\":\"1cbd10cd-342c-41bf-ae8f-832324cfbb30\",\"name\":\"Sticky Note11\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[220,40],\"parameters\":{\"color\":7,\"width\":1043.6429958055905,\"height\":657.4661247924577,\"content\":\"![Slack](https://uploads.n8n.io/templates/slack.png)\\n## Triggered from Slack Parent Workflow\\nThe workflow begins with the execute workflow trigger, but the manual execution trigger was left in to test it manually. Make sure to turn of the execute workflow trigger when running it manually. Make sure to set your Slack Channel ID in the Edit node to ensure that the same channel is set across all slack nodes. From there, n8n sends a message to slack to let the user know that their request is being processed. The two threads are then merged to ensure only one thing is done at a time. Don't forget to set your Platform URL in the Global Variables. More information about that can be found at Qualys's [Platform Documentation](https://www.qualys.com/platform-identification/) page. \"},\"typeVersion\":1},{\"id\":\"fb59e00b-36c6-429e-8696-f49b78445925\",\"name\":\"Sticky Note15\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[2160,60],\"parameters\":{\"color\":7,\"width\":387.82834121275613,\"height\":620.5198690828006,\"content\":\"![n8n](https://uploads.n8n.io/templates/n8n.png)\\n## n8n Loop Node\\nThe report objects are queried then loops every 5 min until the report returns a finished status. We have found that a report can take 40 minutes or more to complete. This is where n8n steps in and checks for us every 5 minutes. When the status of the scan changes to finished, the loop ends and the results are posted to Slack along with a link back to the scan results. \"},\"typeVersion\":1},{\"id\":\"2337ad0e-e361-474a-9923-75c4826400b6\",\"name\":\"Sticky Note13\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[3167,184.84774251864644],\"parameters\":{\"color\":7,\"width\":679.3808146538605,\"height\":493.10714356069377,\"content\":\"![Imgur](https://uploads.n8n.io/templates/slack.png)\\n## Upload Report to Slack\\nOnce the scan is completed, the summary of the report and a link to report object is posted to Slack for easy retrieval. Additionally the original receipt message is deleted to ensure the new message generates a Slack notification. \"},\"typeVersion\":1},{\"id\":\"68a9eee6-05c4-4655-ab74-4a68fc68af26\",\"name\":\"Post Receipt\",\"type\":\"n8n-nodes-base.slack\",\"position\":[740,340],\"parameters\":{\"text\":\"Vulnerability Scan request received, processing now. \",\"select\":\"channel\",\"channelId\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"={{ $('Global Variables & Slack Channel').item.json[\\\"slackChannelId\\\"] }}\"},\"otherOptions\":{\"includeLinkToWorkflow\":false}},\"credentials\":{\"slackApi\":{\"id\":\"DZJDes1ZtGpqClNk\",\"name\":\"Qualys Slack App\"}},\"typeVersion\":2.2},{\"id\":\"43af793b-061f-4048-b110-546903b803b6\",\"name\":\"Confirm Waiting\",\"type\":\"n8n-nodes-base.slack\",\"position\":[1800,540],\"parameters\":{\"ts\":\"={{ $('Save receipt message timestamp').item.json[\\\"ts\\\"] }}\",\"text\":\"=Scan successfully initiated, now waiting for `{{ $('Convert XML to JSON').item.json.SIMPLE_RETURN.RESPONSE.ITEM_LIST.ITEM[1].VALUE }}` to complete. \\n\\nNo action is needed, and I will post the summary report and link to results when it's complete. \",\"channelId\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"={{ $('Global Variables & Slack Channel').item.json[\\\"slackChannelId\\\"] }}\"},\"operation\":\"update\",\"updateFields\":{\"parse\":\"client\",\"link_names\":false}},\"credentials\":{\"slackApi\":{\"id\":\"DZJDes1ZtGpqClNk\",\"name\":\"Qualys Slack App\"}},\"typeVersion\":2.2},{\"id\":\"326bb10c-0e8e-4df7-bc67-dad015240d15\",\"name\":\"Delete Receipt\",\"type\":\"n8n-nodes-base.slack\",\"position\":[3480,440],\"parameters\":{\"select\":\"channel\",\"channelId\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"={{ $('Global Variables & Slack Channel').item.json[\\\"slackChannelId\\\"] }}\"},\"operation\":\"delete\",\"timestamp\":\"={{ $('Save receipt message timestamp').item.json[\\\"ts\\\"] }}\"},\"credentials\":{\"slackApi\":{\"id\":\"DZJDes1ZtGpqClNk\",\"name\":\"Qualys Slack App\"}},\"typeVersion\":2.2},{\"id\":\"c8668283-e6ec-4dbd-92d0-aec1f07c01a7\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1740.3532113511565,44.007696543933434],\"parameters\":{\"color\":7,\"width\":408.91770357210225,\"height\":645.055566466257,\"content\":\"![Slack](https://uploads.n8n.io/templates/slack.png)\\n## Let user's know that it's time to wait\\nGood customer service comes from communication. And that's what this section does, it alerts the user that the scan was triggered successfully, and now it is time to wait for it to finish. Feel free to change this message to better suit your needs. It will be deleted when the results are posted. \"},\"typeVersion\":1},{\"id\":\"defa2773-ea65-481d-a6d6-bb40c70e6762\",\"name\":\"Sticky Note8\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-440,40],\"parameters\":{\"width\":646.7396383244529,\"height\":994.2389415638766,\"content\":\"![n8n](https://uploads.n8n.io/templates/n8n.png)\\n# Qualys Vulnerability Trigger Scan Workflow\\n\\n## This workflow is triggered by a parent workflow initiated via a Slack shortcut. Upon activation, it collects input from a modal window in Slack and initiates a vulnerability scan using the Qualys API.\\n\\n**Key Features:**\\n- **Trigger:** Launched by a parent workflow through a Slack shortcut with modal input.\\n- **API Integration:** Utilizes the Qualys API for vulnerability scanning.\\n- **Data Conversion:** Converts XML scan results to JSON for further processing.\\n- **Loop Mechanism:** Continuously checks the scan status until completion.\\n- **Slack Notifications:** Posts scan summary and detailed results to a specified Slack channel.\\n\\n\\n**Workflow Nodes:**\\n1. **Start VM Scan in Qualys:** Initiates the scan with specified parameters.\\n2. **Convert XML to JSON:** Converts the scan results from XML format to JSON.\\n3. **Fetch Scan Results:** Retrieves scan results from Qualys.\\n4. **Check if Scan Finished:** Verifies whether the scan is complete.\\n5. **Loop Mechanism:** Handles the repetitive checking of the scan status.\\n6. **Slack Notifications:** Posts updates and results to Slack.\\n\\n\\n**Relevant Links:**\\n- [Qualys API Documentation](https://qualysguard.qg2.apps.qualys.com/qwebhelp/fo_portal/api_doc/scans/index.htm#t=vm_scans%2Flaunch_vm_scan.htm)\\n- [Qualys Platform Documentation](https://www.qualys.com/platform-identification/)\\n\"},\"typeVersion\":1},{\"id\":\"de2c15bd-4144-4ca8-9c0d-370ecf334650\",\"name\":\"Demo Data\",\"type\":\"n8n-nodes-base.set\",\"position\":[560,520],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"070178a6-73b0-458b-8657-20ab4ff0485c\",\"name\":\"option_title\",\"type\":\"string\",\"value\":\"Initial Options\"},{\"id\":\"3605424b-5bfc-44f0-b6e4-e0d6b1130b8e\",\"name\":\"scan_title\",\"type\":\"string\",\"value\":\"n8n Scan 1\"},{\"id\":\"2320d966-b834-46fb-b674-be97cc08682e\",\"name\":\"asset_groups\",\"type\":\"string\",\"value\":\"Group1\"}]}},\"typeVersion\":3.3},{\"id\":\"0ec55480-424c-4686-b8f7-8a98b5941c8e\",\"name\":\"Sticky Note4\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[820,700],\"parameters\":{\"color\":5,\"width\":535.8333316661617,\"height\":702.5170959123625,\"content\":\"![Qualys](https://uploads.n8n.io/templates/qualysmodalscan.png)\\n### 🔄The data input into this Modal will be processed in this workflow\"},\"typeVersion\":1},{\"id\":\"9f6291ad-280f-4a0c-b84a-5eebfbb9172f\",\"name\":\"Merge\",\"type\":\"n8n-nodes-base.merge\",\"position\":[1120,500],\"parameters\":{\"mode\":\"combine\",\"options\":{},\"combinationMode\":\"multiplex\"},\"typeVersion\":2.1},{\"id\":\"783d9bcd-faf1-4427-ab5c-de32df64f819\",\"name\":\"Post Vulnerability Scan Summary to Slack\",\"type\":\"n8n-nodes-base.slack\",\"position\":[3240,500],\"parameters\":{\"select\":\"channel\",\"blocksUi\":\"={\\n\\t\\\"blocks\\\": [\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"image\\\",\\n\\t\\t\\t\\\"block_id\\\": \\\"image_1\\\",\\n\\t\\t\\t\\\"image_url\\\": \\\"https://i.imgur.com/6BtgQVV.png\\\",\\n\\t\\t\\t\\\"alt_text\\\": \\\"{{ $('Convert XML to JSON').item.json[\\\"SIMPLE_RETURN\\\"][\\\"RESPONSE\\\"][\\\"ITEM_LIST\\\"][\\\"ITEM\\\"][0][\\\"VALUE\\\"] }}\\\"\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"header\\\",\\n\\t\\t\\t\\\"block_id\\\": \\\"header_1\\\",\\n\\t\\t\\t\\\"text\\\": {\\n\\t\\t\\t\\t\\\"type\\\": \\\"plain_text\\\",\\n\\t\\t\\t\\t\\\"text\\\": \\\"📊 Qualys Scan Summary\\\"\\n\\t\\t\\t}\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"section\\\",\\n\\t\\t\\t\\\"block_id\\\": \\\"section_scan_details\\\",\\n\\t\\t\\t\\\"text\\\": {\\n\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\\"text\\\": \\\"*📝 Scan Title:* {{ $json[\\\"SCAN_SUMMARY_OUTPUT\\\"][\\\"RESPONSE\\\"][\\\"SCAN_SUMMARY_LIST\\\"][\\\"SCAN_SUMMARY\\\"][\\\"SCAN_INPUT\\\"][\\\"TITLE\\\"] }}\\\\n*👤 User:* {{ $json[\\\"SCAN_SUMMARY_OUTPUT\\\"][\\\"RESPONSE\\\"][\\\"SCAN_SUMMARY_LIST\\\"][\\\"SCAN_SUMMARY\\\"][\\\"SCAN_INPUT\\\"][\\\"USER\\\"][\\\"USERNAME\\\"] }}\\\\n*🔍 Scan Status:* FINISHED\\\"\\n\\t\\t\\t}\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"section\\\",\\n\\t\\t\\t\\\"block_id\\\": \\\"section_general_info\\\",\\n\\t\\t\\t\\\"fields\\\": [\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"*⏱️ Scheduled:* {{ $json[\\\"SCAN_SUMMARY_OUTPUT\\\"][\\\"RESPONSE\\\"][\\\"SCAN_SUMMARY_LIST\\\"][\\\"SCAN_SUMMARY\\\"][\\\"SCAN_INPUT\\\"][\\\"SCHEDULED\\\"] }}\\\"\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"*📋 Option Profile:* {{ $json[\\\"SCAN_SUMMARY_OUTPUT\\\"][\\\"RESPONSE\\\"][\\\"SCAN_SUMMARY_LIST\\\"][\\\"SCAN_SUMMARY\\\"][\\\"SCAN_INPUT\\\"][\\\"OPTION_PROFILE\\\"][\\\"NAME\\\"] }}\\\"\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"*🎯 Targets:* IP List ({{ $json[\\\"SCAN_SUMMARY_OUTPUT\\\"][\\\"RESPONSE\\\"][\\\"SCAN_SUMMARY_LIST\\\"][\\\"SCAN_SUMMARY\\\"][\\\"SCAN_INPUT\\\"][\\\"TARGETS\\\"][\\\"IP_LIST\\\"][\\\"COUNT\\\"] }} IPs), Asset Group {{ $json[\\\"SCAN_SUMMARY_OUTPUT\\\"][\\\"RESPONSE\\\"][\\\"SCAN_SUMMARY_LIST\\\"][\\\"SCAN_SUMMARY\\\"][\\\"SCAN_INPUT\\\"][\\\"TARGETS\\\"][\\\"ASSET_GROUP_LIST\\\"][\\\"ASSET_GROUP_DATA\\\"][\\\"ASSET_GROUP\\\"][\\\"NAME\\\"] }}\\\"\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"*🚀 Scan Launched:* {{ $json[\\\"SCAN_SUMMARY_OUTPUT\\\"][\\\"RESPONSE\\\"][\\\"SCAN_SUMMARY_LIST\\\"][\\\"SCAN_SUMMARY\\\"][\\\"SCAN_INPUT\\\"][\\\"SCAN_DATETIME\\\"] }}\\\"\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"*⏳ Duration:* {{ $json[\\\"SCAN_SUMMARY_OUTPUT\\\"][\\\"RESPONSE\\\"][\\\"SCAN_SUMMARY_LIST\\\"][\\\"SCAN_SUMMARY\\\"][\\\"SCAN_DETAILS\\\"][\\\"DURATION\\\"] }} seconds\\\"\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"*🖥️ Detected Hosts:* {{ $json[\\\"SCAN_SUMMARY_OUTPUT\\\"][\\\"RESPONSE\\\"][\\\"SCAN_SUMMARY_LIST\\\"][\\\"SCAN_SUMMARY\\\"][\\\"SCAN_RESULTS\\\"][\\\"HOSTS\\\"][\\\"COUNT\\\"] }}\\\"\\n\\t\\t\\t\\t}\\n\\t\\t\\t]\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"section\\\",\\n\\t\\t\\t\\\"block_id\\\": \\\"section_detections_summary\\\",\\n\\t\\t\\t\\\"text\\\": {\\n\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\\"text\\\": \\\"*🔎 Detections Summary:*\\\"\\n\\t\\t\\t}\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"section\\\",\\n\\t\\t\\t\\\"block_id\\\": \\\"section_detections_details\\\",\\n\\t\\t\\t\\\"fields\\\": [\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"*🛡️ Confirmed Vulnerabilities:* {{ $json[\\\"SCAN_SUMMARY_OUTPUT\\\"][\\\"RESPONSE\\\"][\\\"SCAN_SUMMARY_LIST\\\"][\\\"SCAN_SUMMARY\\\"][\\\"SCAN_RESULTS\\\"][\\\"DETECTIONS\\\"][\\\"VULN\\\"][\\\"CONFIRMED\\\"][\\\"TOTAL_COUNT\\\"] }}\\\\n   - Minimal Severity: {{ $json[\\\"SCAN_SUMMARY_OUTPUT\\\"][\\\"RESPONSE\\\"][\\\"SCAN_SUMMARY_LIST\\\"][\\\"SCAN_SUMMARY\\\"][\\\"SCAN_RESULTS\\\"][\\\"DETECTIONS\\\"][\\\"VULN\\\"][\\\"CONFIRMED\\\"][\\\"COUNT_BY_SEVERITY\\\"][\\\"SEVERITY_1\\\"] }}\\\\n   - Medium Severity: {{ $json[\\\"SCAN_SUMMARY_OUTPUT\\\"][\\\"RESPONSE\\\"][\\\"SCAN_SUMMARY_LIST\\\"][\\\"SCAN_SUMMARY\\\"][\\\"SCAN_RESULTS\\\"][\\\"DETECTIONS\\\"][\\\"VULN\\\"][\\\"CONFIRMED\\\"][\\\"COUNT_BY_SEVERITY\\\"][\\\"SEVERITY_2\\\"] }}\\\\n   - Serious Severity: {{ $json[\\\"SCAN_SUMMARY_OUTPUT\\\"][\\\"RESPONSE\\\"][\\\"SCAN_SUMMARY_LIST\\\"][\\\"SCAN_SUMMARY\\\"][\\\"SCAN_RESULTS\\\"][\\\"DETECTIONS\\\"][\\\"VULN\\\"][\\\"CONFIRMED\\\"][\\\"COUNT_BY_SEVERITY\\\"][\\\"SEVERITY_3\\\"] }}\\\\n   - Critical Severity: {{ $json[\\\"SCAN_SUMMARY_OUTPUT\\\"][\\\"RESPONSE\\\"][\\\"SCAN_SUMMARY_LIST\\\"][\\\"SCAN_SUMMARY\\\"][\\\"SCAN_RESULTS\\\"][\\\"DETECTIONS\\\"][\\\"VULN\\\"][\\\"CONFIRMED\\\"][\\\"COUNT_BY_SEVERITY\\\"][\\\"SEVERITY_4\\\"] }}\\\\n   - Urgent Severity: {{ $json[\\\"SCAN_SUMMARY_OUTPUT\\\"][\\\"RESPONSE\\\"][\\\"SCAN_SUMMARY_LIST\\\"][\\\"SCAN_SUMMARY\\\"][\\\"SCAN_RESULTS\\\"][\\\"DETECTIONS\\\"][\\\"VULN\\\"][\\\"CONFIRMED\\\"][\\\"COUNT_BY_SEVERITY\\\"][\\\"SEVERITY_5\\\"] }}\\\"\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"*📈 Information Gathered:* {{ $json[\\\"SCAN_SUMMARY_OUTPUT\\\"][\\\"RESPONSE\\\"][\\\"SCAN_SUMMARY_LIST\\\"][\\\"SCAN_SUMMARY\\\"][\\\"SCAN_RESULTS\\\"][\\\"DETECTIONS\\\"][\\\"IG\\\"][\\\"TOTAL_COUNT\\\"] }}\\\\n   - Minimal Severity:  {{ $json[\\\"SCAN_SUMMARY_OUTPUT\\\"][\\\"RESPONSE\\\"][\\\"SCAN_SUMMARY_LIST\\\"][\\\"SCAN_SUMMARY\\\"][\\\"SCAN_RESULTS\\\"][\\\"DETECTIONS\\\"][\\\"IG\\\"][\\\"COUNT_BY_SEVERITY\\\"][\\\"SEVERITY_1\\\"] }}\\\\n   - Medium Severity: {{ $json[\\\"SCAN_SUMMARY_OUTPUT\\\"][\\\"RESPONSE\\\"][\\\"SCAN_SUMMARY_LIST\\\"][\\\"SCAN_SUMMARY\\\"][\\\"SCAN_RESULTS\\\"][\\\"DETECTIONS\\\"][\\\"IG\\\"][\\\"COUNT_BY_SEVERITY\\\"][\\\"SEVERITY_2\\\"] }}\\\\n   - Serious Severity: {{ $json[\\\"SCAN_SUMMARY_OUTPUT\\\"][\\\"RESPONSE\\\"][\\\"SCAN_SUMMARY_LIST\\\"][\\\"SCAN_SUMMARY\\\"][\\\"SCAN_RESULTS\\\"][\\\"DETECTIONS\\\"][\\\"IG\\\"][\\\"COUNT_BY_SEVERITY\\\"][\\\"SEVERITY_3\\\"] }}\\\"\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"*⚠️ Potential Vulnerabilities:* {{ $json[\\\"SCAN_SUMMARY_OUTPUT\\\"][\\\"RESPONSE\\\"][\\\"SCAN_SUMMARY_LIST\\\"][\\\"SCAN_SUMMARY\\\"][\\\"SCAN_RESULTS\\\"][\\\"DETECTIONS\\\"][\\\"VULN\\\"][\\\"POTENTIAL\\\"][\\\"TOTAL_COUNT\\\"] }}\\\\n   - Minimal Severity: {{ $json[\\\"SCAN_SUMMARY_OUTPUT\\\"][\\\"RESPONSE\\\"][\\\"SCAN_SUMMARY_LIST\\\"][\\\"SCAN_SUMMARY\\\"][\\\"SCAN_RESULTS\\\"][\\\"DETECTIONS\\\"][\\\"VULN\\\"][\\\"POTENTIAL\\\"][\\\"COUNT_BY_SEVERITY\\\"][\\\"SEVERITY_1\\\"] }}\\\\n   - Medium Severity: {{ $json[\\\"SCAN_SUMMARY_OUTPUT\\\"][\\\"RESPONSE\\\"][\\\"SCAN_SUMMARY_LIST\\\"][\\\"SCAN_SUMMARY\\\"][\\\"SCAN_RESULTS\\\"][\\\"DETECTIONS\\\"][\\\"VULN\\\"][\\\"POTENTIAL\\\"][\\\"COUNT_BY_SEVERITY\\\"][\\\"SEVERITY_2\\\"] }}\\\\n   - Serious Severity: {{ $json[\\\"SCAN_SUMMARY_OUTPUT\\\"][\\\"RESPONSE\\\"][\\\"SCAN_SUMMARY_LIST\\\"][\\\"SCAN_SUMMARY\\\"][\\\"SCAN_RESULTS\\\"][\\\"DETECTIONS\\\"][\\\"VULN\\\"][\\\"POTENTIAL\\\"][\\\"COUNT_BY_SEVERITY\\\"][\\\"SEVERITY_3\\\"] }}\\\\n   - Critical Severity: {{ $json[\\\"SCAN_SUMMARY_OUTPUT\\\"][\\\"RESPONSE\\\"][\\\"SCAN_SUMMARY_LIST\\\"][\\\"SCAN_SUMMARY\\\"][\\\"SCAN_RESULTS\\\"][\\\"DETECTIONS\\\"][\\\"VULN\\\"][\\\"POTENTIAL\\\"][\\\"COUNT_BY_SEVERITY\\\"][\\\"SEVERITY_4\\\"] }}\\\\n   - Urgent Severity: {{ $json[\\\"SCAN_SUMMARY_OUTPUT\\\"][\\\"RESPONSE\\\"][\\\"SCAN_SUMMARY_LIST\\\"][\\\"SCAN_SUMMARY\\\"][\\\"SCAN_RESULTS\\\"][\\\"DETECTIONS\\\"][\\\"VULN\\\"][\\\"POTENTIAL\\\"][\\\"COUNT_BY_SEVERITY\\\"][\\\"SEVERITY_5\\\"] }}\\\"\\n\\t\\t\\t\\t}\\n\\t\\t\\t]\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"section\\\",\\n\\t\\t\\t\\\"block_id\\\": \\\"final_section_with_button\\\",\\n\\t\\t\\t\\\"text\\\": {\\n\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\\"text\\\": \\\"🔗 View the full report in Qualys\\\"\\n\\t\\t\\t},\\n\\t\\t\\t\\\"accessory\\\": {\\n\\t\\t\\t\\t\\\"type\\\": \\\"button\\\",\\n\\t\\t\\t\\t\\\"text\\\": {\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"plain_text\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"View Report in Qualys\\\",\\n\\t\\t\\t\\t\\t\\\"emoji\\\": true\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\\"value\\\": \\\"click_me_123\\\",\\n\\t\\t\\t\\t\\\"style\\\": \\\"primary\\\",\\n\\t\\t\\t\\t\\\"url\\\": \\\"{{ $('Demo Data').item.json[\\\"platformurl\\\"] }}/fo/report/report_view.php?id={{ $('Convert XML to JSON').item.json[\\\"SIMPLE_RETURN\\\"][\\\"RESPONSE\\\"][\\\"ITEM_LIST\\\"][\\\"ITEM\\\"][0][\\\"VALUE\\\"] }}&default=1&format=30\\\",\\n\\t\\t\\t\\t\\\"action_id\\\": \\\"button-action\\\"\\n\\t\\t\\t}\\n\\t\\t}\\n\\t]\\n}\",\"channelId\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"={{ $('Global Variables & Slack Channel').item.json[\\\"slackChannelId\\\"] }}\"},\"messageType\":\"block\",\"otherOptions\":{}},\"credentials\":{\"slackApi\":{\"id\":\"DZJDes1ZtGpqClNk\",\"name\":\"Qualys Slack App\"}},\"typeVersion\":2.2},{\"id\":\"91444583-66d8-4d5b-ba88-4d8869d508b6\",\"name\":\"When clicking \\\"Test workflow\\\"\",\"type\":\"n8n-nodes-base.manualTrigger\",\"disabled\":true,\"position\":[260,340],\"parameters\":{},\"typeVersion\":1},{\"id\":\"4b8ade25-0377-4f00-a744-f610b17eea93\",\"name\":\"Begin Wait Loop\",\"type\":\"n8n-nodes-base.noOp\",\"position\":[1800,400],\"parameters\":{},\"typeVersion\":1},{\"id\":\"b830b9d8-e7aa-49bb-9640-d1def697f3e1\",\"name\":\"Merge1\",\"type\":\"n8n-nodes-base.merge\",\"position\":[2020,420],\"parameters\":{\"mode\":\"chooseBranch\"},\"typeVersion\":2.1},{\"id\":\"389381c3-bd51-4e22-a102-e47b5945576c\",\"name\":\"Save receipt message timestamp\",\"type\":\"n8n-nodes-base.set\",\"position\":[920,340],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"111526ec-0501-4af9-b66e-c677cb8fe25f\",\"name\":\"ts\",\"type\":\"string\",\"value\":\"={{ $json.message.ts }}\"}]}},\"typeVersion\":3.3},{\"id\":\"51005deb-2676-4375-9ac8-780eb301f7f5\",\"name\":\"Global Variables & Slack Channel\",\"type\":\"n8n-nodes-base.set\",\"position\":[560,340],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"9849fe48-7a7a-4f2b-a404-c7827249e9c2\",\"name\":\"slackChannelId\",\"type\":\"string\",\"value\":\"C05LAN72WJK\"},{\"id\":\"36aad8b5-b51a-4df0-b1a7-159a90b802b2\",\"name\":\"platformurl\",\"type\":\"string\",\"value\":\"https://qualysapi.qg3.apps.qualys.com\"}]}},\"typeVersion\":3.3},{\"id\":\"7d6d5ab7-5a87-46c8-baa8-d79a05d8346d\",\"name\":\"Sticky Note5\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[220,700],\"parameters\":{\"color\":5,\"width\":596.6847639718076,\"height\":438.8903816479826,\"content\":\"![Qualys](https://uploads.n8n.io/templates/qualysscanshortcut.png)\\n### 🤖 Triggering this workflow is as easy as typing a backslash in Slack and filling out the modal on the right\"},\"typeVersion\":1}],\"pinData\":{},\"connections\":{\"Merge\":{\"main\":[[{\"node\":\"Start VM Scan in Qualys\",\"type\":\"main\",\"index\":0}]]},\"Merge1\":{\"main\":[[{\"node\":\"Loop Over Items\",\"type\":\"main\",\"index\":0}]]},\"Demo Data\":{\"main\":[[{\"node\":\"Merge\",\"type\":\"main\",\"index\":1}]]},\"Wait 5 Min\":{\"main\":[[{\"node\":\"Fetch Scan Results\",\"type\":\"main\",\"index\":0}]]},\"Post Receipt\":{\"main\":[[{\"node\":\"Save receipt message timestamp\",\"type\":\"main\",\"index\":0}]]},\"Begin Wait Loop\":{\"main\":[[{\"node\":\"Merge1\",\"type\":\"main\",\"index\":0}]]},\"Confirm Waiting\":{\"main\":[[{\"node\":\"Merge1\",\"type\":\"main\",\"index\":1}]]},\"Loop Over Items\":{\"main\":[null,[{\"node\":\"Wait 5 Min\",\"type\":\"main\",\"index\":0}]]},\"Fetch Scan Results\":{\"main\":[[{\"node\":\"Convert XML to JSON1\",\"type\":\"main\",\"index\":0}]]},\"Convert XML to JSON\":{\"main\":[[{\"node\":\"Confirm Waiting\",\"type\":\"main\",\"index\":0},{\"node\":\"Begin Wait Loop\",\"type\":\"main\",\"index\":0}]]},\"Convert XML to JSON1\":{\"main\":[[{\"node\":\"Check if Scan Finished\",\"type\":\"main\",\"index\":0}]]},\"Check if Scan Finished\":{\"main\":[[{\"node\":\"Delete Receipt\",\"type\":\"main\",\"index\":0},{\"node\":\"Post Vulnerability Scan Summary to Slack\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Loop Over Items\",\"type\":\"main\",\"index\":0}]]},\"Start VM Scan in Qualys\":{\"main\":[[{\"node\":\"Convert XML to JSON\",\"type\":\"main\",\"index\":0}]]},\"Execute Workflow Trigger\":{\"main\":[[{\"node\":\"Demo Data\",\"type\":\"main\",\"index\":0},{\"node\":\"Global Variables & Slack Channel\",\"type\":\"main\",\"index\":0}]]},\"When clicking \\\"Test workflow\\\"\":{\"main\":[[{\"node\":\"Demo Data\",\"type\":\"main\",\"index\":0},{\"node\":\"Global Variables & Slack Channel\",\"type\":\"main\",\"index\":0}]]},\"Save receipt message timestamp\":{\"main\":[[{\"node\":\"Merge\",\"type\":\"main\",\"index\":0}]]},\"Global Variables & Slack Channel\":{\"main\":[[{\"node\":\"Post Receipt\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "## This workflow is triggered by a parent workflow initiated via a Slack shortcut. Upon activation, it collects input from a modal window in Slack and initiates a vulnerability scan using the Qualys API.\n\n## Key Features\n\n  * **Trigger:** Launched by a parent workflow through a Slack shortcut with modal input.\n  * **API Integration:** Utilizes the Qualys API for vulnerability scanning.\n  * **Data Conversion:** Converts XML scan results to JSON for further processing.\n  * **Loop Mechanism:** Continuously checks the scan status until completion.\n  * **Slack Notifications:** Posts scan summary and detailed results to a specified Slack channel.\n\n\n\n## Workflow Nodes\n\n  1. **Start VM Scan in Qualys:** Initiates the scan with specified parameters.\n  2. **Convert XML to JSON:** Converts the scan results from XML format to JSON.\n  3. **Fetch Scan Results:** Retrieves scan results from Qualys.\n  4. **Check if Scan Finished:** Verifies whether the scan is complete.\n  5. **Loop Mechanism:** Handles the repetitive checking of the scan status.\n  6. **Slack Notifications:** Posts updates and results to Slack.\n\n\n\nRelevant Links\n\n  * [Qualys API Documentation](https://qualysguard.qg2.apps.qualys.com/qwebhelp/fo_portal/api_doc/scans/index.htm#t=vm_scans%2Flaunch_vm_scan.htm)\n  * [Qualys Platform Documentation](https://www.qualys.com/platform-identification/)\n  * [Parent workflow link](https://n8n.io/workflows/2510-enhance-security-operations-with-the-qualys-slack-shortcut-bot/)\n  * [Link to Report Generator Subworkflow](https://n8n.io/workflows/2512-qualys-scan-slack-report-subworkflow/)\n\n\n",
  "crawled_at": "2025-05-26T00:06:38.215458",
  "readme_zh": "## 该工作流由Slack快捷方式触发的父工作流启动，通过收集Slack模态窗口的输入信息，调用Qualys API执行漏洞扫描。\n\n## 核心功能\n\n  * **触发机制:** 通过Slack快捷命令唤起模态窗口获取输入参数，由父工作流触发执行\n  * **API集成:** 调用Qualys漏洞扫描接口进行安全检测\n  * **数据转换:** 将XML格式的扫描结果转换为JSON格式便于处理\n  * **轮询机制:** 持续检查扫描任务状态直至完成\n  * **Slack通知:** 向指定频道推送扫描概览及详细结果",
  "title_zh": "Qualys漏洞触发扫描子工作流",
  "publish_date_zh": "最后更新于6个月前",
  "workflow_json_zh": "{\n  \"meta\": {\n    \"instanceId\": \"03e9d14e9196363fe7191ce21dc0bb17387a6e755dcc9acc4f5904752919dca8\"\n  },\n  \"nodes\": [\n    {\n      \"id\": \"be5b0c9c-de92-4e34-88cb-98e88b0c19df\",\n      \"name\": \"Start VM Scan in Qualys\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1340,\n        500\n      ],\n      \"parameters\": {\n        \"\": \"\",\n        \"url\": \"={{ $json.platformurl }}/api/2.0/fo/scan/\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"sendBody\": true,\n        \"sendQuery\": true,\n        \"curlImport\": \"\",\n        \"contentType\": \"multipart-form-data\",\n        \"infoMessage\": \"\",\n        \"sendHeaders\": true,\n        \"specifyQuery\": \"keypair\",\n        \"authentication\": \"predefinedCredentialType\",\n        \"bodyParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"asset_groups\",\n              \"value\": \"={{ $json.asset_groups }}\",\n              \"parameterType\": \"formData\"\n            },\n            {\n              \"name\": \"scan_title\",\n              \"value\": \"={{ $json.scan_title }}\",\n              \"parameterType\": \"formData\"\n            },\n            {\n              \"name\": \"option_title\",\n              \"value\": \"={{ $json.option_title }}\",\n              \"parameterType\": \"formData\"\n            }\n          ]\n        },\n        \"specifyHeaders\": \"keypair\",\n        \"queryParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"action\",\n              \"value\": \"launch\"\n            }\n          ]\n        },\n        \"headerParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"X-Requested-With\",\n              \"value\": \"n8n\"\n            }\n          ]\n        },\n        \"httpVariantWarning\": \"\",\n        \"nodeCredentialType\": \"qualysApi\",\n        \"provideSslCertificates\": false\n      },\n      \"credentials\": {\n        \"qualysApi\": {\n          \"id\": \"KdkmNjVYkDUzHAvw\",\n          \"name\": \"Qualys account\"\n        }\n      },\n      \"typeVersion\": 4.2,\n      \"extendsCredential\": \"qualysApi\"\n    },\n    {\n      \"id\": \"0d140ce1-89e0-4135-821f-0b32004fc6aa\",\n      \"name\": \"Convert XML to JSON\",\n      \"type\": \"n8n-nodes-base.xml\",\n      \"position\": [\n        1540,\n        500\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"dataPropertyName\": \"=data\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"ec737485-bf8b-4e8a-9843-2566c13106a8\",\n      \"name\": \"Fetch Scan Results\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        2640,\n        460\n      ],\n      \"parameters\": {\n        \"\": \"\",\n        \"url\": \"={{ $('Demo Data').item.json[\\\"platformurl\\\"] }}/api/2.0/fo/scan/vm/summary\",\n        \"method\": \"GET\",\n        \"options\": {},\n        \"sendBody\": false,\n        \"sendQuery\": true,\n        \"curlImport\": \"\",\n        \"infoMessage\": \"\",\n        \"sendHeaders\": true,\n        \"specifyQuery\": \"keypair\",\n        \"authentication\": \"predefinedCredentialType\",\n        \"specifyHeaders\": \"keypair\",\n        \"queryParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"action\",\n              \"value\": \"list\"\n            },\n            {\n              \"name\": \"scan_reference\",\n              \"value\": \"={{ $('Convert XML to JSON').item.json.SIMPLE_RETURN.RESPONSE.ITEM_LIST.ITEM[1].VALUE }}\"\n            }\n          ]\n        },\n        \"headerParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"X-Requested-With\",\n              \"value\": \"n8n\"\n            }\n          ]\n        },\n        \"httpVariantWarning\": \"\",\n        \"nodeCredentialType\": \"qualysApi\",\n        \"provideSslCertificates\": false\n      },\n      \"credentials\": {\n        \"qualysApi\": {\n          \"id\": \"KdkmNjVYkDUzHAvw\",\n          \"name\": \"Qualys account\"\n        }\n      },\n      \"typeVersion\": 4.2,\n      \"extendsCredential\": \"qualysApi\"\n    },\n    {\n      \"id\": \"56a60798-3db1-4c69-962f-75009f894196\",\n      \"name\": \"Loop Over Items\",\n      \"type\": \"n8n-nodes-base.splitInBatches\",\n      \"position\": [\n        2220,\n        420\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"reset\": true\n        }\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"37ac0cdf-8412-40c7-b01c-d592e4d1f378\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        2560,\n        180\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 596.2964035541726,\n        \"height\": 493.43675548817004,\n        \"content\": \"![Imgur](https://uploads.n8n.io/templates/qualys.png)  \\n若需了解Qualys端执行查询的更多信息，请查阅[扫描管理文档](https://qualysguard.qg2.apps.qualys.com/qwebhelp/fo_portal/api_doc/scans/index.htm#t=vm_scans%2Fmanage_vm_scans.htm)。查询结果以XML格式返回，n8n可原生转换为JSON格式，便于在n8n中轻松检查状态。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"075a4e21-cc30-4e31-a1f9-d2f872ab978c\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1274.994996265108,\n        51.04030212612997\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 447.57018680355174,\n        \"height\": 642.6627860215806,\n        \"content\": \"![Qualys](https://uploads.n8n.io/templates/qualys.png)\\n## 在Qualys代理上触发扫描\\n有关启动扫描的更多信息，请访问\\n[启动文档](\\nhttps://qualysguard.qg2.apps.qualys.com/qwebhelp/fo_portal/api_doc/scans/index.htm#t=vm_scans%2Flaunch_vm_scan.htm)。Qualys的响应为XML格式，n8n可轻松处理。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"5da3f500-0ccf-4eed-9d05-7709668cf2bb\",\n      \"name\": \"Wait 5 Min\",\n      \"type\": \"n8n-nodes-base.wait\",\n      \"position\": [\n        2440,\n        460\n      ],\n      \"webhookId\": \"f2d07724-882a-4010-9ce2-ff389ee962af\",\n      \"parameters\": {\n        \"unit\": \"minutes\"\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"5cf921ac-cd6b-4a27-b679-3d1ecdb3eb49\",\n      \"name\": \"Convert XML to JSON1\",\n      \"type\": \"n8n-nodes-base.xml\",\n      \"position\": [\n        2800,\n        460\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"dataPropertyName\": \"=data\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"0580bb11-38c4-49a1-ab00-4cdfb49c8f9d\",\n      \"name\": \"Check if Scan Finished\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        3000,\n        460\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"ef397200-064a-428f-a5b2-19d2342a9113\",\n              \"operator\": {\n                \"name\": \"filter.operator.equals\",\n                \"type\": \"string\",\n                \"operation\": \"equals\"\n              },\n              \"leftValue\": \"={{ $json.SCAN_SUMMARY_OUTPUT.RESPONSE.SCAN_SUMMARY_LIST.SCAN_SUMMARY.SCAN_DETAILS.STATUS }}\",\n              \"rightValue\": \"FINISHED\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"ec05f06b-e009-4f1c-97e4-223705d3be32\",\n      \"name\": \"Execute Workflow Trigger\",\n      \"type\": \"n8n-nodes-base.executeWorkflowTrigger\",\n      \"position\": [\n        260,\n        520\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"1cbd10cd-342c-41bf-ae8f-832324cfbb30\",\n      \"name\": \"Sticky Note11\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        220,\n        40\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 1043.6429958055905,\n        \"height\": 657.4661247924577,\n        \"content\": \"![Slack](https://uploads.n8n.io/templates/slack.png)\\n## 由Slack父工作流触发\\n该工作流始于执行工作流触发器，但保留了手动执行触发器以便手动测试。手动运行时请确保关闭执行工作流触发器。请在编辑节点中设置您的Slack频道ID，以确保所有Slack节点使用同一频道。随后，n8n会向Slack发送消息告知用户其请求正在处理中。两条线程将被合并以确保每次仅执行一项操作。别忘了在全局变量中设置您的平台URL。更多相关信息可参阅Qualys的[平台文档](https://www.qualys.com/platform-identification/)页面。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"fb59e00b-36c6-429e-8696-f49b78445925\",\n      \"name\": \"Sticky Note15\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        2160,\n        60\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 387.82834121275613,\n        \"height\": 620.5198690828006,\n        \"content\": \"![n8n](https://uploads.n8n.io/templates/n8n.png)\\n## n8n循环节点\\n系统会先查询报告对象，随后每5分钟循环检查一次，直至报告返回完成状态。我们发现一份报告可能需要40分钟甚至更长时间才能生成完毕。此时n8n便会介入，每隔5分钟自动为我们检查状态。当扫描状态变更为\\\"已完成\\\"时，循环终止，系统会将结果连同返回扫描结果的链接一并发布至Slack。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"2337ad0e-e361-474a-9923-75c4826400b6\",\n      \"name\": \"Sticky Note13\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        3167,\n        184.84774251864644\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 679.3808146538605,\n        \"height\": 493.10714356069377,\n        \"content\": \"![Imgur](https://uploads.n8n.io/templates/slack.png)\\n## 上传报告至Slack\\n扫描完成后，报告摘要及报告对象链接将发布至Slack以便快速查阅。同时系统会删除原始接收消息，确保新消息能触发Slack通知。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"68a9eee6-05c4-4655-ab74-4a68fc68af26\",\n      \"name\": \"Post Receipt\",\n      \"type\": \"n8n-nodes-base.slack\",\n      \"position\": [\n        740,\n        340\n      ],\n      \"parameters\": {\n        \"text\": \"Vulnerability Scan request received, processing now. \",\n        \"select\": \"channel\",\n        \"channelId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $('Global Variables & Slack Channel').item.json[\\\"slackChannelId\\\"] }}\"\n        },\n        \"otherOptions\": {\n          \"includeLinkToWorkflow\": false\n        }\n      },\n      \"credentials\": {\n        \"slackApi\": {\n          \"id\": \"DZJDes1ZtGpqClNk\",\n          \"name\": \"Qualys Slack App\"\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"43af793b-061f-4048-b110-546903b803b6\",\n      \"name\": \"Confirm Waiting\",\n      \"type\": \"n8n-nodes-base.slack\",\n      \"position\": [\n        1800,\n        540\n      ],\n      \"parameters\": {\n        \"ts\": \"={{ $('Save receipt message timestamp').item.json[\\\"ts\\\"] }}\",\n        \"text\": \"=Scan successfully initiated, now waiting for `{{ $('Convert XML to JSON').item.json.SIMPLE_RETURN.RESPONSE.ITEM_LIST.ITEM[1].VALUE }}` to complete. \\n\\nNo action is needed, and I will post the summary report and link to results when it's complete. \",\n        \"channelId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $('Global Variables & Slack Channel').item.json[\\\"slackChannelId\\\"] }}\"\n        },\n        \"operation\": \"update\",\n        \"updateFields\": {\n          \"parse\": \"client\",\n          \"link_names\": false\n        }\n      },\n      \"credentials\": {\n        \"slackApi\": {\n          \"id\": \"DZJDes1ZtGpqClNk\",\n          \"name\": \"Qualys Slack App\"\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"326bb10c-0e8e-4df7-bc67-dad015240d15\",\n      \"name\": \"Delete Receipt\",\n      \"type\": \"n8n-nodes-base.slack\",\n      \"position\": [\n        3480,\n        440\n      ],\n      \"parameters\": {\n        \"select\": \"channel\",\n        \"channelId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $('Global Variables & Slack Channel').item.json[\\\"slackChannelId\\\"] }}\"\n        },\n        \"operation\": \"delete\",\n        \"timestamp\": \"={{ $('Save receipt message timestamp').item.json[\\\"ts\\\"] }}\"\n      },\n      \"credentials\": {\n        \"slackApi\": {\n          \"id\": \"DZJDes1ZtGpqClNk\",\n          \"name\": \"Qualys Slack App\"\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"c8668283-e6ec-4dbd-92d0-aec1f07c01a7\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1740.3532113511565,\n        44.007696543933434\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 408.91770357210225,\n        \"height\": 645.055566466257,\n        \"content\": \"![Slack](https://uploads.n8n.io/templates/slack.png)\\n## 告知用户等待时机已至\\n优质的客户服务源于有效沟通。本环节正是为此设计——当扫描成功触发后，会主动提醒用户进入等待状态直至扫描完成。您可根据实际需求自由调整提示内容，该消息将在结果发布后自动清除。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"defa2773-ea65-481d-a6d6-bb40c70e6762\",\n      \"name\": \"Sticky Note8\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -440,\n        40\n      ],\n      \"parameters\": {\n        \"width\": 646.7396383244529,\n        \"height\": 994.2389415638766,\n        \"content\": \"![n8n](https://uploads.n8n.io/templates/n8n.png)\\n# Qualys漏洞扫描触发工作流\\n\\n## 本工作流由Slack快捷方式触发的父工作流启动。激活后，它会收集Slack模态窗口中的输入信息，并通过Qualys API发起漏洞扫描。\\n\\n**核心功能：**\\n- **触发机制：** 通过Slack快捷方式触发的父工作流配合模态窗口输入启动\\n- **API集成：** 调用Qualys API执行漏洞扫描\\n- **数据转换：** 将XML格式的扫描结果转换为JSON以便后续处理\\n- **循环检测：** 持续轮询扫描状态直至任务完成\\n- **Slack通知：** 向指定Slack频道推送扫描摘要及详细结果\\n\\n**工作流节点：**\\n1. **Qualys启动虚拟机扫描：** 根据参数配置发起扫描\\n2. **XML转JSON：** 转换扫描结果数据格式\\n3. **获取扫描结果：** 从Qualys提取扫描数据\\n4. **检测扫描状态：** 验证扫描是否完成\\n5. **循环机制：** 实现扫描状态的轮询检查\\n6. **Slack通知：** 向Slack推送状态更新和最终结果\\n\\n**相关链接：**\\n- [Qualys API文档](https://qualysguard.qg2.apps.qualys.com/qwebhelp/fo_portal/api_doc/scans/index.htm#t=vm_scans%2Flaunch_vm_scan.htm)\\n- [Qualys平台文档](https://www.qualys.com/platform-identification/)\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"de2c15bd-4144-4ca8-9c0d-370ecf334650\",\n      \"name\": \"Demo Data\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        560,\n        520\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"070178a6-73b0-458b-8657-20ab4ff0485c\",\n              \"name\": \"option_title\",\n              \"type\": \"string\",\n              \"value\": \"Initial Options\"\n            },\n            {\n              \"id\": \"3605424b-5bfc-44f0-b6e4-e0d6b1130b8e\",\n              \"name\": \"scan_title\",\n              \"type\": \"string\",\n              \"value\": \"n8n Scan 1\"\n            },\n            {\n              \"id\": \"2320d966-b834-46fb-b674-be97cc08682e\",\n              \"name\": \"asset_groups\",\n              \"type\": \"string\",\n              \"value\": \"Group1\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.3\n    },\n    {\n      \"id\": \"0ec55480-424c-4686-b8f7-8a98b5941c8e\",\n      \"name\": \"Sticky Note4\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        820,\n        700\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 535.8333316661617,\n        \"height\": 702.5170959123625,\n        \"content\": \"![Qualys](https://uploads.n8n.io/templates/qualysmodalscan.png)  \\n### 🔄此模态框中输入的数据将在本工作流中进行处理\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"9f6291ad-280f-4a0c-b84a-5eebfbb9172f\",\n      \"name\": \"Merge\",\n      \"type\": \"n8n-nodes-base.merge\",\n      \"position\": [\n        1120,\n        500\n      ],\n      \"parameters\": {\n        \"mode\": \"combine\",\n        \"options\": {},\n        \"combinationMode\": \"multiplex\"\n      },\n      \"typeVersion\": 2.1\n    },\n    {\n      \"id\": \"783d9bcd-faf1-4427-ab5c-de32df64f819\",\n      \"name\": \"Post Vulnerability Scan Summary to Slack\",\n      \"type\": \"n8n-nodes-base.slack\",\n      \"position\": [\n        3240,\n        500\n      ],\n      \"parameters\": {\n        \"select\": \"channel\",\n        \"blocksUi\": \"={\\n\\t\\\"blocks\\\": [\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"image\\\",\\n\\t\\t\\t\\\"block_id\\\": \\\"image_1\\\",\\n\\t\\t\\t\\\"image_url\\\": \\\"https://i.imgur.com/6BtgQVV.png\\\",\\n\\t\\t\\t\\\"alt_text\\\": \\\"{{ $('Convert XML to JSON').item.json[\\\"SIMPLE_RETURN\\\"][\\\"RESPONSE\\\"][\\\"ITEM_LIST\\\"][\\\"ITEM\\\"][0][\\\"VALUE\\\"] }}\\\"\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"header\\\",\\n\\t\\t\\t\\\"block_id\\\": \\\"header_1\\\",\\n\\t\\t\\t\\\"text\\\": {\\n\\t\\t\\t\\t\\\"type\\\": \\\"plain_text\\\",\\n\\t\\t\\t\\t\\\"text\\\": \\\"📊 Qualys Scan Summary\\\"\\n\\t\\t\\t}\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"section\\\",\\n\\t\\t\\t\\\"block_id\\\": \\\"section_scan_details\\\",\\n\\t\\t\\t\\\"text\\\": {\\n\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\\"text\\\": \\\"*📝 Scan Title:* {{ $json[\\\"SCAN_SUMMARY_OUTPUT\\\"][\\\"RESPONSE\\\"][\\\"SCAN_SUMMARY_LIST\\\"][\\\"SCAN_SUMMARY\\\"][\\\"SCAN_INPUT\\\"][\\\"TITLE\\\"] }}\\\\n*👤 User:* {{ $json[\\\"SCAN_SUMMARY_OUTPUT\\\"][\\\"RESPONSE\\\"][\\\"SCAN_SUMMARY_LIST\\\"][\\\"SCAN_SUMMARY\\\"][\\\"SCAN_INPUT\\\"][\\\"USER\\\"][\\\"USERNAME\\\"] }}\\\\n*🔍 Scan Status:* FINISHED\\\"\\n\\t\\t\\t}\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"section\\\",\\n\\t\\t\\t\\\"block_id\\\": \\\"section_general_info\\\",\\n\\t\\t\\t\\\"fields\\\": [\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"*⏱️ Scheduled:* {{ $json[\\\"SCAN_SUMMARY_OUTPUT\\\"][\\\"RESPONSE\\\"][\\\"SCAN_SUMMARY_LIST\\\"][\\\"SCAN_SUMMARY\\\"][\\\"SCAN_INPUT\\\"][\\\"SCHEDULED\\\"] }}\\\"\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"*📋 Option Profile:* {{ $json[\\\"SCAN_SUMMARY_OUTPUT\\\"][\\\"RESPONSE\\\"][\\\"SCAN_SUMMARY_LIST\\\"][\\\"SCAN_SUMMARY\\\"][\\\"SCAN_INPUT\\\"][\\\"OPTION_PROFILE\\\"][\\\"NAME\\\"] }}\\\"\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"*🎯 Targets:* IP List ({{ $json[\\\"SCAN_SUMMARY_OUTPUT\\\"][\\\"RESPONSE\\\"][\\\"SCAN_SUMMARY_LIST\\\"][\\\"SCAN_SUMMARY\\\"][\\\"SCAN_INPUT\\\"][\\\"TARGETS\\\"][\\\"IP_LIST\\\"][\\\"COUNT\\\"] }} IPs), Asset Group {{ $json[\\\"SCAN_SUMMARY_OUTPUT\\\"][\\\"RESPONSE\\\"][\\\"SCAN_SUMMARY_LIST\\\"][\\\"SCAN_SUMMARY\\\"][\\\"SCAN_INPUT\\\"][\\\"TARGETS\\\"][\\\"ASSET_GROUP_LIST\\\"][\\\"ASSET_GROUP_DATA\\\"][\\\"ASSET_GROUP\\\"][\\\"NAME\\\"] }}\\\"\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"*🚀 Scan Launched:* {{ $json[\\\"SCAN_SUMMARY_OUTPUT\\\"][\\\"RESPONSE\\\"][\\\"SCAN_SUMMARY_LIST\\\"][\\\"SCAN_SUMMARY\\\"][\\\"SCAN_INPUT\\\"][\\\"SCAN_DATETIME\\\"] }}\\\"\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"*⏳ Duration:* {{ $json[\\\"SCAN_SUMMARY_OUTPUT\\\"][\\\"RESPONSE\\\"][\\\"SCAN_SUMMARY_LIST\\\"][\\\"SCAN_SUMMARY\\\"][\\\"SCAN_DETAILS\\\"][\\\"DURATION\\\"] }} seconds\\\"\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"*🖥️ Detected Hosts:* {{ $json[\\\"SCAN_SUMMARY_OUTPUT\\\"][\\\"RESPONSE\\\"][\\\"SCAN_SUMMARY_LIST\\\"][\\\"SCAN_SUMMARY\\\"][\\\"SCAN_RESULTS\\\"][\\\"HOSTS\\\"][\\\"COUNT\\\"] }}\\\"\\n\\t\\t\\t\\t}\\n\\t\\t\\t]\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"section\\\",\\n\\t\\t\\t\\\"block_id\\\": \\\"section_detections_summary\\\",\\n\\t\\t\\t\\\"text\\\": {\\n\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\\"text\\\": \\\"*🔎 Detections Summary:*\\\"\\n\\t\\t\\t}\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"section\\\",\\n\\t\\t\\t\\\"block_id\\\": \\\"section_detections_details\\\",\\n\\t\\t\\t\\\"fields\\\": [\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"*🛡️ Confirmed Vulnerabilities:* {{ $json[\\\"SCAN_SUMMARY_OUTPUT\\\"][\\\"RESPONSE\\\"][\\\"SCAN_SUMMARY_LIST\\\"][\\\"SCAN_SUMMARY\\\"][\\\"SCAN_RESULTS\\\"][\\\"DETECTIONS\\\"][\\\"VULN\\\"][\\\"CONFIRMED\\\"][\\\"TOTAL_COUNT\\\"] }}\\\\n   - Minimal Severity: {{ $json[\\\"SCAN_SUMMARY_OUTPUT\\\"][\\\"RESPONSE\\\"][\\\"SCAN_SUMMARY_LIST\\\"][\\\"SCAN_SUMMARY\\\"][\\\"SCAN_RESULTS\\\"][\\\"DETECTIONS\\\"][\\\"VULN\\\"][\\\"CONFIRMED\\\"][\\\"COUNT_BY_SEVERITY\\\"][\\\"SEVERITY_1\\\"] }}\\\\n   - Medium Severity: {{ $json[\\\"SCAN_SUMMARY_OUTPUT\\\"][\\\"RESPONSE\\\"][\\\"SCAN_SUMMARY_LIST\\\"][\\\"SCAN_SUMMARY\\\"][\\\"SCAN_RESULTS\\\"][\\\"DETECTIONS\\\"][\\\"VULN\\\"][\\\"CONFIRMED\\\"][\\\"COUNT_BY_SEVERITY\\\"][\\\"SEVERITY_2\\\"] }}\\\\n   - Serious Severity: {{ $json[\\\"SCAN_SUMMARY_OUTPUT\\\"][\\\"RESPONSE\\\"][\\\"SCAN_SUMMARY_LIST\\\"][\\\"SCAN_SUMMARY\\\"][\\\"SCAN_RESULTS\\\"][\\\"DETECTIONS\\\"][\\\"VULN\\\"][\\\"CONFIRMED\\\"][\\\"COUNT_BY_SEVERITY\\\"][\\\"SEVERITY_3\\\"] }}\\\\n   - Critical Severity: {{ $json[\\\"SCAN_SUMMARY_OUTPUT\\\"][\\\"RESPONSE\\\"][\\\"SCAN_SUMMARY_LIST\\\"][\\\"SCAN_SUMMARY\\\"][\\\"SCAN_RESULTS\\\"][\\\"DETECTIONS\\\"][\\\"VULN\\\"][\\\"CONFIRMED\\\"][\\\"COUNT_BY_SEVERITY\\\"][\\\"SEVERITY_4\\\"] }}\\\\n   - Urgent Severity: {{ $json[\\\"SCAN_SUMMARY_OUTPUT\\\"][\\\"RESPONSE\\\"][\\\"SCAN_SUMMARY_LIST\\\"][\\\"SCAN_SUMMARY\\\"][\\\"SCAN_RESULTS\\\"][\\\"DETECTIONS\\\"][\\\"VULN\\\"][\\\"CONFIRMED\\\"][\\\"COUNT_BY_SEVERITY\\\"][\\\"SEVERITY_5\\\"] }}\\\"\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"*📈 Information Gathered:* {{ $json[\\\"SCAN_SUMMARY_OUTPUT\\\"][\\\"RESPONSE\\\"][\\\"SCAN_SUMMARY_LIST\\\"][\\\"SCAN_SUMMARY\\\"][\\\"SCAN_RESULTS\\\"][\\\"DETECTIONS\\\"][\\\"IG\\\"][\\\"TOTAL_COUNT\\\"] }}\\\\n   - Minimal Severity:  {{ $json[\\\"SCAN_SUMMARY_OUTPUT\\\"][\\\"RESPONSE\\\"][\\\"SCAN_SUMMARY_LIST\\\"][\\\"SCAN_SUMMARY\\\"][\\\"SCAN_RESULTS\\\"][\\\"DETECTIONS\\\"][\\\"IG\\\"][\\\"COUNT_BY_SEVERITY\\\"][\\\"SEVERITY_1\\\"] }}\\\\n   - Medium Severity: {{ $json[\\\"SCAN_SUMMARY_OUTPUT\\\"][\\\"RESPONSE\\\"][\\\"SCAN_SUMMARY_LIST\\\"][\\\"SCAN_SUMMARY\\\"][\\\"SCAN_RESULTS\\\"][\\\"DETECTIONS\\\"][\\\"IG\\\"][\\\"COUNT_BY_SEVERITY\\\"][\\\"SEVERITY_2\\\"] }}\\\\n   - Serious Severity: {{ $json[\\\"SCAN_SUMMARY_OUTPUT\\\"][\\\"RESPONSE\\\"][\\\"SCAN_SUMMARY_LIST\\\"][\\\"SCAN_SUMMARY\\\"][\\\"SCAN_RESULTS\\\"][\\\"DETECTIONS\\\"][\\\"IG\\\"][\\\"COUNT_BY_SEVERITY\\\"][\\\"SEVERITY_3\\\"] }}\\\"\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"*⚠️ Potential Vulnerabilities:* {{ $json[\\\"SCAN_SUMMARY_OUTPUT\\\"][\\\"RESPONSE\\\"][\\\"SCAN_SUMMARY_LIST\\\"][\\\"SCAN_SUMMARY\\\"][\\\"SCAN_RESULTS\\\"][\\\"DETECTIONS\\\"][\\\"VULN\\\"][\\\"POTENTIAL\\\"][\\\"TOTAL_COUNT\\\"] }}\\\\n   - Minimal Severity: {{ $json[\\\"SCAN_SUMMARY_OUTPUT\\\"][\\\"RESPONSE\\\"][\\\"SCAN_SUMMARY_LIST\\\"][\\\"SCAN_SUMMARY\\\"][\\\"SCAN_RESULTS\\\"][\\\"DETECTIONS\\\"][\\\"VULN\\\"][\\\"POTENTIAL\\\"][\\\"COUNT_BY_SEVERITY\\\"][\\\"SEVERITY_1\\\"] }}\\\\n   - Medium Severity: {{ $json[\\\"SCAN_SUMMARY_OUTPUT\\\"][\\\"RESPONSE\\\"][\\\"SCAN_SUMMARY_LIST\\\"][\\\"SCAN_SUMMARY\\\"][\\\"SCAN_RESULTS\\\"][\\\"DETECTIONS\\\"][\\\"VULN\\\"][\\\"POTENTIAL\\\"][\\\"COUNT_BY_SEVERITY\\\"][\\\"SEVERITY_2\\\"] }}\\\\n   - Serious Severity: {{ $json[\\\"SCAN_SUMMARY_OUTPUT\\\"][\\\"RESPONSE\\\"][\\\"SCAN_SUMMARY_LIST\\\"][\\\"SCAN_SUMMARY\\\"][\\\"SCAN_RESULTS\\\"][\\\"DETECTIONS\\\"][\\\"VULN\\\"][\\\"POTENTIAL\\\"][\\\"COUNT_BY_SEVERITY\\\"][\\\"SEVERITY_3\\\"] }}\\\\n   - Critical Severity: {{ $json[\\\"SCAN_SUMMARY_OUTPUT\\\"][\\\"RESPONSE\\\"][\\\"SCAN_SUMMARY_LIST\\\"][\\\"SCAN_SUMMARY\\\"][\\\"SCAN_RESULTS\\\"][\\\"DETECTIONS\\\"][\\\"VULN\\\"][\\\"POTENTIAL\\\"][\\\"COUNT_BY_SEVERITY\\\"][\\\"SEVERITY_4\\\"] }}\\\\n   - Urgent Severity: {{ $json[\\\"SCAN_SUMMARY_OUTPUT\\\"][\\\"RESPONSE\\\"][\\\"SCAN_SUMMARY_LIST\\\"][\\\"SCAN_SUMMARY\\\"][\\\"SCAN_RESULTS\\\"][\\\"DETECTIONS\\\"][\\\"VULN\\\"][\\\"POTENTIAL\\\"][\\\"COUNT_BY_SEVERITY\\\"][\\\"SEVERITY_5\\\"] }}\\\"\\n\\t\\t\\t\\t}\\n\\t\\t\\t]\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"section\\\",\\n\\t\\t\\t\\\"block_id\\\": \\\"final_section_with_button\\\",\\n\\t\\t\\t\\\"text\\\": {\\n\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\\"text\\\": \\\"🔗 View the full report in Qualys\\\"\\n\\t\\t\\t},\\n\\t\\t\\t\\\"accessory\\\": {\\n\\t\\t\\t\\t\\\"type\\\": \\\"button\\\",\\n\\t\\t\\t\\t\\\"text\\\": {\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"plain_text\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"View Report in Qualys\\\",\\n\\t\\t\\t\\t\\t\\\"emoji\\\": true\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\\"value\\\": \\\"click_me_123\\\",\\n\\t\\t\\t\\t\\\"style\\\": \\\"primary\\\",\\n\\t\\t\\t\\t\\\"url\\\": \\\"{{ $('Demo Data').item.json[\\\"platformurl\\\"] }}/fo/report/report_view.php?id={{ $('Convert XML to JSON').item.json[\\\"SIMPLE_RETURN\\\"][\\\"RESPONSE\\\"][\\\"ITEM_LIST\\\"][\\\"ITEM\\\"][0][\\\"VALUE\\\"] }}&default=1&format=30\\\",\\n\\t\\t\\t\\t\\\"action_id\\\": \\\"button-action\\\"\\n\\t\\t\\t}\\n\\t\\t}\\n\\t]\\n}\",\n        \"channelId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $('Global Variables & Slack Channel').item.json[\\\"slackChannelId\\\"] }}\"\n        },\n        \"messageType\": \"block\",\n        \"otherOptions\": {}\n      },\n      \"credentials\": {\n        \"slackApi\": {\n          \"id\": \"DZJDes1ZtGpqClNk\",\n          \"name\": \"Qualys Slack App\"\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"91444583-66d8-4d5b-ba88-4d8869d508b6\",\n      \"name\": \"When clicking \\\"Test workflow\\\"\",\n      \"type\": \"n8n-nodes-base.manualTrigger\",\n      \"disabled\": true,\n      \"position\": [\n        260,\n        340\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"4b8ade25-0377-4f00-a744-f610b17eea93\",\n      \"name\": \"Begin Wait Loop\",\n      \"type\": \"n8n-nodes-base.noOp\",\n      \"position\": [\n        1800,\n        400\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"b830b9d8-e7aa-49bb-9640-d1def697f3e1\",\n      \"name\": \"Merge1\",\n      \"type\": \"n8n-nodes-base.merge\",\n      \"position\": [\n        2020,\n        420\n      ],\n      \"parameters\": {\n        \"mode\": \"chooseBranch\"\n      },\n      \"typeVersion\": 2.1\n    },\n    {\n      \"id\": \"389381c3-bd51-4e22-a102-e47b5945576c\",\n      \"name\": \"Save receipt message timestamp\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        920,\n        340\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"111526ec-0501-4af9-b66e-c677cb8fe25f\",\n              \"name\": \"ts\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.message.ts }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.3\n    },\n    {\n      \"id\": \"51005deb-2676-4375-9ac8-780eb301f7f5\",\n      \"name\": \"Global Variables & Slack Channel\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        560,\n        340\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"9849fe48-7a7a-4f2b-a404-c7827249e9c2\",\n              \"name\": \"slackChannelId\",\n              \"type\": \"string\",\n              \"value\": \"C05LAN72WJK\"\n            },\n            {\n              \"id\": \"36aad8b5-b51a-4df0-b1a7-159a90b802b2\",\n              \"name\": \"platformurl\",\n              \"type\": \"string\",\n              \"value\": \"https://qualysapi.qg3.apps.qualys.com\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.3\n    },\n    {\n      \"id\": \"7d6d5ab7-5a87-46c8-baa8-d79a05d8346d\",\n      \"name\": \"Sticky Note5\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        220,\n        700\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 596.6847639718076,\n        \"height\": 438.8903816479826,\n        \"content\": \"![Qualys](https://uploads.n8n.io/templates/qualysscanshortcut.png)\\n### 🤖 触发此工作流只需在Slack中输入反斜杠并填写右侧的模态框即可\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"pinData\": {},\n  \"connections\": {\n    \"Merge\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Start VM Scan in Qualys\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Merge1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Loop Over Items\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Demo Data\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge\",\n            \"type\": \"main\",\n            \"index\": 1\n          }\n        ]\n      ]\n    },\n    \"Wait 5 Min\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Fetch Scan Results\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Post Receipt\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Save receipt message timestamp\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Begin Wait Loop\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Confirm Waiting\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge1\",\n            \"type\": \"main\",\n            \"index\": 1\n          }\n        ]\n      ]\n    },\n    \"Loop Over Items\": {\n      \"main\": [\n        null,\n        [\n          {\n            \"node\": \"Wait 5 Min\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Fetch Scan Results\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Convert XML to JSON1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Convert XML to JSON\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Confirm Waiting\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Begin Wait Loop\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Convert XML to JSON1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Check if Scan Finished\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Check if Scan Finished\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Delete Receipt\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Post Vulnerability Scan Summary to Slack\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Loop Over Items\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Start VM Scan in Qualys\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Convert XML to JSON\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Execute Workflow Trigger\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Demo Data\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Global Variables & Slack Channel\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"When clicking \\\"Test workflow\\\"\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Demo Data\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Global Variables & Slack Channel\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Save receipt message timestamp\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Global Variables & Slack Channel\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Post Receipt\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}