{
  "url": "https://n8n.io/workflows/4037-manage-whatsapp-chats-centrally-on-slack/",
  "title": "Manage WhatsApp Chats Centrally on Slack",
  "author": "Usman Liaqat",
  "publish_date": "Last update a day ago",
  "publish_date_absolute": "",
  "categories": [
    {
      "name": "Support"
    }
  ],
  "workflow_json": "{\"meta\":{\"instanceId\":\"4e229722e6c43a4914d2d66178b48335adf795d73afbee5b0ea0c52938ef4d8e\"},\"nodes\":[{\"id\":\"30fcebd0-d271-47ee-98e7-e1c9db4ae1f1\",\"name\":\"WhatsApp Trigger\",\"type\":\"n8n-nodes-base.whatsAppTrigger\",\"position\":[-2740,120],\"webhookId\":\"864469fd-2008-445c-83fe-852dac2b236a\",\"parameters\":{\"options\":{},\"updates\":[\"messages\"]},\"credentials\":{\"whatsAppTriggerApi\":{\"id\":\"a41n62XWot5Pm1XE\",\"name\":\"WhatsApp OAuth account\"}},\"typeVersion\":1},{\"id\":\"a71a46a0-72c6-43d3-a001-b9a2f57da8f5\",\"name\":\"Send Message in Channel\",\"type\":\"n8n-nodes-base.slack\",\"position\":[-1640,-180],\"webhookId\":\"34b58325-6711-42c5-802f-177047c02da1\",\"parameters\":{\"text\":\"={{ $('WhatsApp Trigger').item.json.messages[0].text.body }}\",\"select\":\"channel\",\"channelId\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"={{ $json.id }}\"},\"otherOptions\":{\"includeLinkToWorkflow\":false}},\"credentials\":{\"slackApi\":{\"id\":\"5PavU8rt9kHN9pW4\",\"name\":\"n8n user\"}},\"typeVersion\":2.3},{\"id\":\"aef4c666-5e07-4692-b9f1-4049bb06e6c8\",\"name\":\"Slack Trigger\",\"type\":\"n8n-nodes-base.slackTrigger\",\"position\":[-2700,920],\"webhookId\":\"88033a8d-c5a4-4226-a742-909e005bb5b3\",\"parameters\":{\"options\":{},\"trigger\":[\"message\"],\"watchWorkspace\":true},\"credentials\":{\"slackApi\":{\"id\":\"5PavU8rt9kHN9pW4\",\"name\":\"n8n user\"}},\"typeVersion\":1},{\"id\":\"b665feac-c851-4463-851f-f723a940ce80\",\"name\":\"Message Type\",\"type\":\"n8n-nodes-base.switch\",\"position\":[-1860,99],\"parameters\":{\"rules\":{\"values\":[{\"outputKey\":\"text\",\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"668fdd23-fb5c-4473-b34f-15157b2059f9\",\"operator\":{\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $('WhatsApp Trigger').item.json.messages[0].type }}\",\"rightValue\":\"text\"}]},\"renameOutput\":true},{\"outputKey\":\"audio\",\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"25381929-f26b-446e-a460-baee6b2a420e\",\"operator\":{\"name\":\"filter.operator.equals\",\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $('WhatsApp Trigger').item.json.messages[0].type }}\",\"rightValue\":\"audio\"}]},\"renameOutput\":true},{\"outputKey\":\"image\",\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"2dbde15e-324c-46f8-82e8-ccd8084e5718\",\"operator\":{\"name\":\"filter.operator.equals\",\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $('WhatsApp Trigger').item.json.messages[0].type }}\",\"rightValue\":\"image\"}]},\"renameOutput\":true},{\"outputKey\":\"document\",\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"b5ed8fb5-0519-4245-81c4-84139e4b14c0\",\"operator\":{\"name\":\"filter.operator.equals\",\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $('WhatsApp Trigger').item.json.messages[0].type }}\",\"rightValue\":\"document\"}]},\"renameOutput\":true}]},\"options\":{}},\"typeVersion\":3.2},{\"id\":\"bbe095f2-914f-41b9-ad69-b47d0217e392\",\"name\":\"get audio URL\",\"type\":\"n8n-nodes-base.whatsApp\",\"position\":[-1640,20],\"webhookId\":\"cc335545-7c02-4d40-a751-0eccaaf8b3f7\",\"parameters\":{\"resource\":\"media\",\"operation\":\"mediaUrlGet\",\"mediaGetId\":\"={{ $('WhatsApp Trigger').item.json.messages[0].audio.id }}\"},\"credentials\":{\"whatsAppApi\":{\"id\":\"yVJyvYLlRszyE5sV\",\"name\":\"WhatsApp account\"}},\"typeVersion\":1},{\"id\":\"c645ad49-d722-47fe-9b1e-c8685f0322ea\",\"name\":\"get document URL\",\"type\":\"n8n-nodes-base.whatsApp\",\"position\":[-1640,420],\"webhookId\":\"b052dd6a-55b8-4195-a64e-c0088b7419cc\",\"parameters\":{\"resource\":\"media\",\"operation\":\"mediaUrlGet\",\"mediaGetId\":\"={{ $('WhatsApp Trigger').item.json.messages[0].document.id }}\"},\"credentials\":{\"whatsAppApi\":{\"id\":\"yVJyvYLlRszyE5sV\",\"name\":\"WhatsApp account\"}},\"typeVersion\":1},{\"id\":\"2c5eb333-0d26-4ce4-b4ac-a94e183d910c\",\"name\":\"get image URL\",\"type\":\"n8n-nodes-base.whatsApp\",\"position\":[-1640,220],\"webhookId\":\"57b20ff1-0931-4eaf-8582-d0eec8bb8ad6\",\"parameters\":{\"resource\":\"media\",\"operation\":\"mediaUrlGet\",\"mediaGetId\":\"={{ $('WhatsApp Trigger').item.json.messages[0].image.id }}\"},\"credentials\":{\"whatsAppApi\":{\"id\":\"yVJyvYLlRszyE5sV\",\"name\":\"WhatsApp account\"}},\"typeVersion\":1},{\"id\":\"78012279-114e-4b8c-bd18-3e33d537c7c8\",\"name\":\"Create Channel\",\"type\":\"n8n-nodes-base.slack\",\"onError\":\"continueRegularOutput\",\"position\":[-2520,120],\"webhookId\":\"233813f2-e7d7-4e00-bcf0-a97bdefd4a9e\",\"parameters\":{\"resource\":\"channel\",\"channelId\":\"={{ $('WhatsApp Trigger').item.json.messages[0].from }}\",\"channelVisibility\":\"private\"},\"credentials\":{\"slackApi\":{\"id\":\"5PavU8rt9kHN9pW4\",\"name\":\"n8n user\"}},\"typeVersion\":2.3},{\"id\":\"9413ee28-9b92-409a-807a-38b1139cd837\",\"name\":\"get All Channels\",\"type\":\"n8n-nodes-base.slack\",\"position\":[-2300,120],\"webhookId\":\"56a4374b-19ac-453e-b6fa-4ae9f1dc7650\",\"parameters\":{\"filters\":{\"types\":[\"private_channel\"]},\"resource\":\"channel\",\"operation\":\"getAll\",\"returnAll\":true},\"credentials\":{\"slackApi\":{\"id\":\"5PavU8rt9kHN9pW4\",\"name\":\"n8n user\"}},\"typeVersion\":2.3},{\"id\":\"40d09c7b-aeb2-491f-864e-b92023dc8e57\",\"name\":\"Filter Channel by Name\",\"type\":\"n8n-nodes-base.filter\",\"position\":[-2080,120],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"or\",\"conditions\":[{\"id\":\"586f6026-e893-46f8-ac89-4b16db24339a\",\"operator\":{\"name\":\"filter.operator.equals\",\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $json.name }}\",\"rightValue\":\"={{ $('WhatsApp Trigger').item.json.messages[0].from }}\"}]}},\"retryOnFail\":false,\"typeVersion\":2.2},{\"id\":\"f0ed5738-9442-42a9-bc76-bd71eaf2fb5b\",\"name\":\"upload media\",\"type\":\"n8n-nodes-base.slack\",\"position\":[-1200,220],\"webhookId\":\"88e62808-3455-4e17-9a9b-9a21216c8daa\",\"parameters\":{\"options\":{\"channelId\":\"={{ $('Message Type').item.json.id }}\"},\"resource\":\"file\"},\"credentials\":{\"slackApi\":{\"id\":\"5PavU8rt9kHN9pW4\",\"name\":\"n8n user\"}},\"typeVersion\":2.3},{\"id\":\"6a749b7b-78c0-4462-9019-f059d0845382\",\"name\":\"download media\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[-1420,220],\"parameters\":{\"url\":\"={{ $json.url }}\",\"options\":{\"response\":{\"response\":{}}},\"authentication\":\"genericCredentialType\",\"genericAuthType\":\"httpHeaderAuth\"},\"credentials\":{\"httpBearerAuth\":{\"id\":\"Ihwbk0P1mYkOZZlr\",\"name\":\"Whatsapp APi Token\"},\"httpHeaderAuth\":{\"id\":\"Rymur2oAzX9lewU9\",\"name\":\"Whatsapp API Token\"}},\"typeVersion\":4.2},{\"id\":\"66423f74-1ce5-44e2-8b41-2dcb6d22b1a9\",\"name\":\"Get Channel by ID\",\"type\":\"n8n-nodes-base.slack\",\"position\":[-2480,920],\"webhookId\":\"dfd24042-e341-4123-acb5-61a07e888431\",\"parameters\":{\"options\":{},\"resource\":\"channel\",\"channelId\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"={{ $json.channel }}\"},\"operation\":\"get\"},\"credentials\":{\"slackApi\":{\"id\":\"5PavU8rt9kHN9pW4\",\"name\":\"n8n user\"}},\"typeVersion\":2.3},{\"id\":\"5587398a-5a6b-48b4-b056-1ef2ae40aaae\",\"name\":\"Checking Message Type\",\"type\":\"n8n-nodes-base.switch\",\"position\":[-2260,920],\"parameters\":{\"rules\":{\"values\":[{\"outputKey\":\"media\",\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"7e42c494-a9eb-45ea-86cc-8a1e1d100fe1\",\"operator\":{\"type\":\"array\",\"operation\":\"notEmpty\",\"singleValue\":true},\"leftValue\":\"={{ $('Slack Trigger').item.json.files }}\",\"rightValue\":\"\"}]},\"renameOutput\":true},{\"outputKey\":\"text\",\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"f1f5bbbd-5536-4a8c-9c93-910cf51b1847\",\"operator\":{\"type\":\"string\",\"operation\":\"notEmpty\",\"singleValue\":true},\"leftValue\":\"={{ $('Slack Trigger').item.json.text }}\",\"rightValue\":\"\"}]},\"renameOutput\":true}]},\"options\":{}},\"typeVersion\":3.2},{\"id\":\"00abbd13-b397-4a8b-ac9a-5f4c7bb37823\",\"name\":\"Send Message\",\"type\":\"n8n-nodes-base.whatsApp\",\"position\":[-2040,1020],\"webhookId\":\"296d05b6-53d0-4391-9a01-17d738889eba\",\"parameters\":{\"textBody\":\"={{ $('Slack Trigger').item.json.blocks[0].elements[0].elements[0].text }}\",\"operation\":\"send\",\"phoneNumberId\":\"=674099929114802\",\"additionalFields\":{},\"recipientPhoneNumber\":\"={{ $('Get Channel by ID').item.json.name }}\"},\"credentials\":{\"whatsAppApi\":{\"id\":\"yVJyvYLlRszyE5sV\",\"name\":\"WhatsApp account\"}},\"typeVersion\":1},{\"id\":\"52c609ed-0085-4762-badc-5fab0e526dfe\",\"name\":\"Get Media URL\",\"type\":\"n8n-nodes-base.slack\",\"position\":[-2040,820],\"webhookId\":\"693b6769-065e-4fb3-9548-2f37faeadc21\",\"parameters\":{\"fileId\":\"={{ $('Slack Trigger').item.json.files[0].id }}\",\"resource\":\"file\",\"operation\":\"get\"},\"credentials\":{\"slackApi\":{\"id\":\"5PavU8rt9kHN9pW4\",\"name\":\"n8n user\"}},\"typeVersion\":2.3},{\"id\":\"f8d972de-add6-4858-abe8-d13ceebee263\",\"name\":\"Download Media\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[-1820,820],\"parameters\":{\"url\":\"={{ $json.url_private_download }}\",\"options\":{\"response\":{\"response\":{}}},\"authentication\":\"genericCredentialType\",\"genericAuthType\":\"httpHeaderAuth\"},\"credentials\":{\"httpHeaderAuth\":{\"id\":\"TTp4u7ld1rzfYb3s\",\"name\":\"Slack n8n\"}},\"typeVersion\":4.2},{\"id\":\"1552ab2b-d8c4-4324-a1a2-4a27e981f292\",\"name\":\"Send Message1\",\"type\":\"n8n-nodes-base.whatsApp\",\"position\":[-1600,820],\"webhookId\":\"dd7a6617-6a3f-4312-9b1c-b924260026a7\",\"parameters\":{\"mediaPath\":\"useMedian8n\",\"operation\":\"send\",\"messageType\":\"document\",\"phoneNumberId\":\"=674099929114802\",\"additionalFields\":{},\"recipientPhoneNumber\":\"={{ $('Get Channel by ID').item.json.name }}\"},\"credentials\":{\"whatsAppApi\":{\"id\":\"yVJyvYLlRszyE5sV\",\"name\":\"WhatsApp account\"}},\"typeVersion\":1},{\"id\":\"592dd9e2-8b95-420a-910d-f6f3a5bd583e\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-2840,620],\"parameters\":{\"width\":1860,\"height\":560,\"content\":\"## Slack to WhatsApp Flow\\n- Trigger: Slack Trigger listens for Slack messages (text or media).\\n- Message Type Handling: Checking Message Type uses a Switch to determine whether it’s text or media.\\n- Text Handling: Extracts text and sends it back to WhatsApp via Send Message.\\n- Media Handling: Gets media URL (Get Media URL).\\n- Downloads the file (Download Media) and (presumably in the missing portion) sends it to WhatsApp as a document/media.\"},\"typeVersion\":1},{\"id\":\"23ee1ef0-ad8d-4c4a-8558-40bcbbfb1406\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-2840,-200],\"parameters\":{\"width\":1860,\"height\":780,\"content\":\"## WhatsApp to Slack Flow\\n- Trigger: WhatsApp Trigger listens for new WhatsApp messages.\\n- Message Type Routing: Message Type node uses a Switch to check if the message is text, audio, image, or document.\\n- Slack Channel Management: Checks if a private Slack channel already exists for the WhatsApp contact (from field).\\n- If not, creates one using Create Channel.\\n- Media Processing (for non-text): Gets WhatsApp media URL via get audio/image/document URL.\\n- Downloads it (download media) and uploads to Slack using upload media.\\n- Text Handling: For text, sends message directly to Slack using Send Message in Channel.\"},\"typeVersion\":1}],\"pinData\":{},\"connections\":{\"Message Type\":{\"main\":[[{\"node\":\"Send Message in Channel\",\"type\":\"main\",\"index\":0}],[{\"node\":\"get audio URL\",\"type\":\"main\",\"index\":0}],[{\"node\":\"get image URL\",\"type\":\"main\",\"index\":0}],[{\"node\":\"get document URL\",\"type\":\"main\",\"index\":0}]]},\"Get Media URL\":{\"main\":[[{\"node\":\"Download Media\",\"type\":\"main\",\"index\":0}]]},\"Slack Trigger\":{\"main\":[[{\"node\":\"Get Channel by ID\",\"type\":\"main\",\"index\":0}]]},\"get audio URL\":{\"main\":[[{\"node\":\"download media\",\"type\":\"main\",\"index\":0}]]},\"get image URL\":{\"main\":[[{\"node\":\"download media\",\"type\":\"main\",\"index\":0}]]},\"Create Channel\":{\"main\":[[{\"node\":\"get All Channels\",\"type\":\"main\",\"index\":0}]]},\"Download Media\":{\"main\":[[{\"node\":\"Send Message1\",\"type\":\"main\",\"index\":0}]]},\"download media\":{\"main\":[[{\"node\":\"upload media\",\"type\":\"main\",\"index\":0}]]},\"WhatsApp Trigger\":{\"main\":[[{\"node\":\"Create Channel\",\"type\":\"main\",\"index\":0}]]},\"get All Channels\":{\"main\":[[{\"node\":\"Filter Channel by Name\",\"type\":\"main\",\"index\":0}]]},\"get document URL\":{\"main\":[[{\"node\":\"download media\",\"type\":\"main\",\"index\":0}]]},\"Get Channel by ID\":{\"main\":[[{\"node\":\"Checking Message Type\",\"type\":\"main\",\"index\":0}]]},\"Checking Message Type\":{\"main\":[[{\"node\":\"Get Media URL\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Send Message\",\"type\":\"main\",\"index\":0}]]},\"Filter Channel by Name\":{\"main\":[[{\"node\":\"Message Type\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "This workflow enables seamless, bidirectional communication between WhatsApp and Slack using n8n. It automates the reception, processing, and forwarding of messages (text, media, and documents) between users on WhatsApp and private Slack channels.\n\n**Key Features & Flow:**\n\n**1\\. WhatsApp to Slack Flow**\n\n  * Trigger: The workflow starts with a WhatsApp Trigger node that listens for new incoming messages via a webhook.\n  * Channel Handling: It checks if a Slack channel with the WhatsApp sender’s number exists\n  * If not, it creates a private Slack channel with the sender's number as the name.\n  * Message Type Routing: A Switch Node (Message Type) inspects the message type (text, image, audio, document).\n  * Based on type: Text: Sends the message directly to Slack.\n  * Image/Audio/Document: Retrieves media URL via WhatsApp API → downloads the media → uploads it to the appropriate Slack channel.\n\n\n\n**2\\. Slack to WhatsApp Flow**\n\n  * Trigger: A Slack Trigger listens for new messages or file uploads in Slack.\n  * Message Type Routing: A second Switch Node (Checking Message Type) checks if the message is text or media.\n  * Routing Logic: Text Message: Extracts and forwards it to the WhatsApp contact (identified by the Slack channel name).\n  * Media/File Message: Retrieves media file URL from Slack → downloads it → sends it as a document via WhatsApp API.\n\n\n\n**Key Integrations:**\n\n  * WhatsApp Cloud API: For receiving messages, downloading media, and sending messages.\n  * Slack API: For creating/getting channels, posting messages, and uploading files.\n  * HTTP Request Node: Used to securely download media from Slack and WhatsApp servers with proper authentication.\n\n\n\n**Automation Use Case:**  \nThis workflow is ideal for businesses that handle customer support or conversations over WhatsApp and wish to log, respond, and collaborate using Slack as their internal communication tool.\n",
  "crawled_at": "2025-05-27T23:01:11.323308",
  "readme_zh": "该工作流通过n8n实现了WhatsApp与Slack之间的无缝双向通信，可自动接收、处理并转发用户通过WhatsApp发送的消息（包括文字、媒体及文件）至Slack私密频道，反之亦然。\n\n**核心功能与流程：**\n\n**1\\. WhatsApp至Slack流程**\n\n  * 触发机制：由WhatsApp触发器节点通过webhook监听新消息\n  * 频道管理：检查是否存在以WhatsApp发送者号码命名的Slack频道\n  * 频道创建：若不存在则新建同名私密频道\n  * 消息类型路由：通过交换节点（消息类型）识别消息类型（文字/图片/音频/文件）\n  * 分类处理：文字消息直接转发至Slack；媒体文件则通过WhatsApp API获取下载链接→下载文件→上传至对应Slack频道",
  "title_zh": "在Slack上集中管理WhatsApp聊天",
  "publish_date_zh": "最近更新于一天前",
  "workflow_json_zh": "{\"meta\":{\"instanceId\":\"4e229722e6c43a4914d2d66178b48335adf795d73afbee5b0ea0c52938ef4d8e\"},\"nodes\":[{\"id\":\"30fcebd0-d271-47ee-98e7-e1c9db4ae1f1\",\"name\":\"WhatsApp Trigger\",\"type\":\"n8n-nodes-base.whatsAppTrigger\",\"position\":[-2740,120],\"webhookId\":\"864469fd-2008-445c-83fe-852dac2b236a\",\"parameters\":{\"options\":{},\"updates\":[\"messages\"]},\"credentials\":{\"whatsAppTriggerApi\":{\"id\":\"a41n62XWot5Pm1XE\",\"name\":\"WhatsApp OAuth account\"}},\"typeVersion\":1},{\"id\":\"a71a46a0-72c6-43d3-a001-b9a2f57da8f5\",\"name\":\"Send Message in Channel\",\"type\":\"n8n-nodes-base.slack\",\"position\":[-1640,-180],\"webhookId\":\"34b58325-6711-42c5-802f-177047c02da1\",\"parameters\":{\"text\":\"={{ $('WhatsApp Trigger').item.json.messages[0].text.body }}\",\"select\":\"channel\",\"channelId\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"={{ $json.id }}\"},\"otherOptions\":{\"includeLinkToWorkflow\":false}},\"credentials\":{\"slackApi\":{\"id\":\"5PavU8rt9kHN9pW4\",\"name\":\"n8n user\"}},\"typeVersion\":2.3},{\"id\":\"aef4c666-5e07-4692-b9f1-4049bb06e6c8\",\"name\":\"Slack Trigger\",\"type\":\"n8n-nodes-base.slackTrigger\",\"position\":[-2700,920],\"webhookId\":\"88033a8d-c5a4-4226-a742-909e005bb5b3\",\"parameters\":{\"options\":{},\"trigger\":[\"message\"],\"watchWorkspace\":true},\"credentials\":{\"slackApi\":{\"id\":\"5PavU8rt9kHN9pW4\",\"name\":\"n8n user\"}},\"typeVersion\":1},{\"id\":\"b665feac-c851-4463-851f-f723a940ce80\",\"name\":\"Message Type\",\"type\":\"n8n-nodes-base.switch\",\"position\":[-1860,99],\"parameters\":{\"rules\":{\"values\":[{\"outputKey\":\"text\",\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"668fdd23-fb5c-4473-b34f-15157b2059f9\",\"operator\":{\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $('WhatsApp Trigger').item.json.messages[0].type }}\",\"rightValue\":\"text\"}]},\"renameOutput\":true},{\"outputKey\":\"audio\",\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"25381929-f26b-446e-a460-baee6b2a420e\",\"operator\":{\"name\":\"filter.operator.equals\",\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $('WhatsApp Trigger').item.json.messages[0].type }}\",\"rightValue\":\"audio\"}]},\"renameOutput\":true},{\"outputKey\":\"image\",\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"2dbde15e-324c-46f8-82e8-ccd8084e5718\",\"operator\":{\"name\":\"filter.operator.equals\",\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $('WhatsApp Trigger').item.json.messages[0].type }}\",\"rightValue\":\"image\"}]},\"renameOutput\":true},{\"outputKey\":\"document\",\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"b5ed8fb5-0519-4245-81c4-84139e4b14c0\",\"operator\":{\"name\":\"filter.operator.equals\",\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $('WhatsApp Trigger').item.json.messages[0].type }}\",\"rightValue\":\"document\"}]},\"renameOutput\":true}]},\"options\":{}},\"typeVersion\":3.2},{\"id\":\"bbe095f2-914f-41b9-ad69-b47d0217e392\",\"name\":\"get audio URL\",\"type\":\"n8n-nodes-base.whatsApp\",\"position\":[-1640,20],\"webhookId\":\"cc335545-7c02-4d40-a751-0eccaaf8b3f7\",\"parameters\":{\"resource\":\"media\",\"operation\":\"mediaUrlGet\",\"mediaGetId\":\"={{ $('WhatsApp Trigger').item.json.messages[0].audio.id }}\"},\"credentials\":{\"whatsAppApi\":{\"id\":\"yVJyvYLlRszyE5sV\",\"name\":\"WhatsApp account\"}},\"typeVersion\":1},{\"id\":\"c645ad49-d722-47fe-9b1e-c8685f0322ea\",\"name\":\"get document URL\",\"type\":\"n8n-nodes-base.whatsApp\",\"position\":[-1640,420],\"webhookId\":\"b052dd6a-55b8-4195-a64e-c0088b7419cc\",\"parameters\":{\"resource\":\"media\",\"operation\":\"mediaUrlGet\",\"mediaGetId\":\"={{ $('WhatsApp Trigger').item.json.messages[0].document.id }}\"},\"credentials\":{\"whatsAppApi\":{\"id\":\"yVJyvYLlRszyE5sV\",\"name\":\"WhatsApp account\"}},\"typeVersion\":1},{\"id\":\"2c5eb333-0d26-4ce4-b4ac-a94e183d910c\",\"name\":\"get image URL\",\"type\":\"n8n-nodes-base.whatsApp\",\"position\":[-1640,220],\"webhookId\":\"57b20ff1-0931-4eaf-8582-d0eec8bb8ad6\",\"parameters\":{\"resource\":\"media\",\"operation\":\"mediaUrlGet\",\"mediaGetId\":\"={{ $('WhatsApp Trigger').item.json.messages[0].image.id }}\"},\"credentials\":{\"whatsAppApi\":{\"id\":\"yVJyvYLlRszyE5sV\",\"name\":\"WhatsApp account\"}},\"typeVersion\":1},{\"id\":\"78012279-114e-4b8c-bd18-3e33d537c7c8\",\"name\":\"Create Channel\",\"type\":\"n8n-nodes-base.slack\",\"onError\":\"continueRegularOutput\",\"position\":[-2520,120],\"webhookId\":\"233813f2-e7d7-4e00-bcf0-a97bdefd4a9e\",\"parameters\":{\"resource\":\"channel\",\"channelId\":\"={{ $('WhatsApp Trigger').item.json.messages[0].from }}\",\"channelVisibility\":\"private\"},\"credentials\":{\"slackApi\":{\"id\":\"5PavU8rt9kHN9pW4\",\"name\":\"n8n user\"}},\"typeVersion\":2.3},{\"id\":\"9413ee28-9b92-409a-807a-38b1139cd837\",\"name\":\"get All Channels\",\"type\":\"n8n-nodes-base.slack\",\"position\":[-2300,120],\"webhookId\":\"56a4374b-19ac-453e-b6fa-4ae9f1dc7650\",\"parameters\":{\"filters\":{\"types\":[\"private_channel\"]},\"resource\":\"channel\",\"operation\":\"getAll\",\"returnAll\":true},\"credentials\":{\"slackApi\":{\"id\":\"5PavU8rt9kHN9pW4\",\"name\":\"n8n user\"}},\"typeVersion\":2.3},{\"id\":\"40d09c7b-aeb2-491f-864e-b92023dc8e57\",\"name\":\"Filter Channel by Name\",\"type\":\"n8n-nodes-base.filter\",\"position\":[-2080,120],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"or\",\"conditions\":[{\"id\":\"586f6026-e893-46f8-ac89-4b16db24339a\",\"operator\":{\"name\":\"filter.operator.equals\",\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $json.name }}\",\"rightValue\":\"={{ $('WhatsApp Trigger').item.json.messages[0].from }}\"}]}},\"retryOnFail\":false,\"typeVersion\":2.2},{\"id\":\"f0ed5738-9442-42a9-bc76-bd71eaf2fb5b\",\"name\":\"upload media\",\"type\":\"n8n-nodes-base.slack\",\"position\":[-1200,220],\"webhookId\":\"88e62808-3455-4e17-9a9b-9a21216c8daa\",\"parameters\":{\"options\":{\"channelId\":\"={{ $('Message Type').item.json.id }}\"},\"resource\":\"file\"},\"credentials\":{\"slackApi\":{\"id\":\"5PavU8rt9kHN9pW4\",\"name\":\"n8n user\"}},\"typeVersion\":2.3},{\"id\":\"6a749b7b-78c0-4462-9019-f059d0845382\",\"name\":\"download media\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[-1420,220],\"parameters\":{\"url\":\"={{ $json.url }}\",\"options\":{\"response\":{\"response\":{}}},\"authentication\":\"genericCredentialType\",\"genericAuthType\":\"httpHeaderAuth\"},\"credentials\":{\"httpBearerAuth\":{\"id\":\"Ihwbk0P1mYkOZZlr\",\"name\":\"Whatsapp APi Token\"},\"httpHeaderAuth\":{\"id\":\"Rymur2oAzX9lewU9\",\"name\":\"Whatsapp API Token\"}},\"typeVersion\":4.2},{\"id\":\"66423f74-1ce5-44e2-8b41-2dcb6d22b1a9\",\"name\":\"Get Channel by ID\",\"type\":\"n8n-nodes-base.slack\",\"position\":[-2480,920],\"webhookId\":\"dfd24042-e341-4123-acb5-61a07e888431\",\"parameters\":{\"options\":{},\"resource\":\"channel\",\"channelId\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"={{ $json.channel }}\"},\"operation\":\"get\"},\"credentials\":{\"slackApi\":{\"id\":\"5PavU8rt9kHN9pW4\",\"name\":\"n8n user\"}},\"typeVersion\":2.3},{\"id\":\"5587398a-5a6b-48b4-b056-1ef2ae40aaae\",\"name\":\"Checking Message Type\",\"type\":\"n8n-nodes-base.switch\",\"position\":[-2260,920],\"parameters\":{\"rules\":{\"values\":[{\"outputKey\":\"media\",\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"7e42c494-a9eb-45ea-86cc-8a1e1d100fe1\",\"operator\":{\"type\":\"array\",\"operation\":\"notEmpty\",\"singleValue\":true},\"leftValue\":\"={{ $('Slack Trigger').item.json.files }}\",\"rightValue\":\"\"}]},\"renameOutput\":true},{\"outputKey\":\"text\",\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"f1f5bbbd-5536-4a8c-9c93-910cf51b1847\",\"operator\":{\"type\":\"string\",\"operation\":\"notEmpty\",\"singleValue\":true},\"leftValue\":\"={{ $('Slack Trigger').item.json.text }}\",\"rightValue\":\"\"}]},\"renameOutput\":true}]},\"options\":{}},\"typeVersion\":3.2},{\"id\":\"00abbd13-b397-4a8b-ac9a-5f4c7bb37823\",\"name\":\"Send Message\",\"type\":\"n8n-nodes-base.whatsApp\",\"position\":[-2040,1020],\"webhookId\":\"296d05b6-53d0-4391-9a01-17d738889eba\",\"parameters\":{\"textBody\":\"={{ $('Slack Trigger').item.json.blocks[0].elements[0].elements[0].text }}\",\"operation\":\"send\",\"phoneNumberId\":\"=674099929114802\",\"additionalFields\":{},\"recipientPhoneNumber\":\"={{ $('Get Channel by ID').item.json.name }}\"},\"credentials\":{\"whatsAppApi\":{\"id\":\"yVJyvYLlRszyE5sV\",\"name\":\"WhatsApp account\"}},\"typeVersion\":1},{\"id\":\"52c609ed-0085-4762-badc-5fab0e526dfe\",\"name\":\"Get Media URL\",\"type\":\"n8n-nodes-base.slack\",\"position\":[-2040,820],\"webhookId\":\"693b6769-065e-4fb3-9548-2f37faeadc21\",\"parameters\":{\"fileId\":\"={{ $('Slack Trigger').item.json.files[0].id }}\",\"resource\":\"file\",\"operation\":\"get\"},\"credentials\":{\"slackApi\":{\"id\":\"5PavU8rt9kHN9pW4\",\"name\":\"n8n user\"}},\"typeVersion\":2.3},{\"id\":\"f8d972de-add6-4858-abe8-d13ceebee263\",\"name\":\"Download Media\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[-1820,820],\"parameters\":{\"url\":\"={{ $json.url_private_download }}\",\"options\":{\"response\":{\"response\":{}}},\"authentication\":\"genericCredentialType\",\"genericAuthType\":\"httpHeaderAuth\"},\"credentials\":{\"httpHeaderAuth\":{\"id\":\"TTp4u7ld1rzfYb3s\",\"name\":\"Slack n8n\"}},\"typeVersion\":4.2},{\"id\":\"1552ab2b-d8c4-4324-a1a2-4a27e981f292\",\"name\":\"Send Message1\",\"type\":\"n8n-nodes-base.whatsApp\",\"position\":[-1600,820],\"webhookId\":\"dd7a6617-6a3f-4312-9b1c-b924260026a7\",\"parameters\":{\"mediaPath\":\"useMedian8n\",\"operation\":\"send\",\"messageType\":\"document\",\"phoneNumberId\":\"=674099929114802\",\"additionalFields\":{},\"recipientPhoneNumber\":\"={{ $('Get Channel by ID').item.json.name }}\"},\"credentials\":{\"whatsAppApi\":{\"id\":\"yVJyvYLlRszyE5sV\",\"name\":\"WhatsApp account\"}},\"typeVersion\":1},{\"id\":\"592dd9e2-8b95-420a-910d-f6f3a5bd583e\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-2840,620],\"parameters\":{\"width\":1860,\"height\":560,\"content\":\"## Slack至WhatsApp流程  \\n- **触发机制**：Slack触发器监听Slack消息（文本或媒体）。  \\n- **消息类型处理**：通过\\\"条件分支\\\"模块判断消息是文本还是媒体。  \\n- **文本处理**：提取文本内容，并通过\\\"发送消息\\\"模块回传至WhatsApp。  \\n- **媒体处理**：获取媒体链接（\\\"获取媒体URL\\\"模块），下载文件（\\\"下载媒体\\\"模块），随后（流程缺失部分推测）将文件作为文档/媒体发送至WhatsApp。  \\n\\n（注：根据技术文档惯例，保留英文专有名词如\\\"Switch\\\"译为\\\"条件分支\\\"，\\\"Get Media URL\\\"等模块名保持引号标注；\\\"presumably in the missing portion\\\"采用括号补充说明形式处理，符合中文技术文档的简洁性要求）\"},\"typeVersion\":1},{\"id\":\"23ee1ef0-ad8d-4c4a-8558-40bcbbfb1406\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-2840,-200],\"parameters\":{\"width\":1860,\"height\":780,\"content\":\"## WhatsApp 到 Slack 流程\\n- 触发机制：WhatsApp触发器监听新消息\\n- 消息类型路由：通过Switch节点区分文本/音频/图片/文档\\n- Slack频道管理：检查该WhatsApp联系人(from字段)是否已有专属频道\\n  - 若无则调用创建频道功能\\n- 媒体处理（非文本类型）：\\n  - 通过获取音频/图片/文档URL取得WhatsApp媒体链接\\n  - 下载媒体文件后通过上传媒体功能发送至Slack\\n- 文本处理：直接使用频道发送消息功能转发至Slack\"},\"typeVersion\":1}],\"pinData\":{},\"connections\":{\"Message Type\":{\"main\":[[{\"node\":\"Send Message in Channel\",\"type\":\"main\",\"index\":0}],[{\"node\":\"get audio URL\",\"type\":\"main\",\"index\":0}],[{\"node\":\"get image URL\",\"type\":\"main\",\"index\":0}],[{\"node\":\"get document URL\",\"type\":\"main\",\"index\":0}]]},\"Get Media URL\":{\"main\":[[{\"node\":\"Download Media\",\"type\":\"main\",\"index\":0}]]},\"Slack Trigger\":{\"main\":[[{\"node\":\"Get Channel by ID\",\"type\":\"main\",\"index\":0}]]},\"get audio URL\":{\"main\":[[{\"node\":\"download media\",\"type\":\"main\",\"index\":0}]]},\"get image URL\":{\"main\":[[{\"node\":\"download media\",\"type\":\"main\",\"index\":0}]]},\"Create Channel\":{\"main\":[[{\"node\":\"get All Channels\",\"type\":\"main\",\"index\":0}]]},\"Download Media\":{\"main\":[[{\"node\":\"Send Message1\",\"type\":\"main\",\"index\":0}]]},\"download media\":{\"main\":[[{\"node\":\"upload media\",\"type\":\"main\",\"index\":0}]]},\"WhatsApp Trigger\":{\"main\":[[{\"node\":\"Create Channel\",\"type\":\"main\",\"index\":0}]]},\"get All Channels\":{\"main\":[[{\"node\":\"Filter Channel by Name\",\"type\":\"main\",\"index\":0}]]},\"get document URL\":{\"main\":[[{\"node\":\"download media\",\"type\":\"main\",\"index\":0}]]},\"Get Channel by ID\":{\"main\":[[{\"node\":\"Checking Message Type\",\"type\":\"main\",\"index\":0}]]},\"Checking Message Type\":{\"main\":[[{\"node\":\"Get Media URL\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Send Message\",\"type\":\"main\",\"index\":0}]]},\"Filter Channel by Name\":{\"main\":[[{\"node\":\"Message Type\",\"type\":\"main\",\"index\":0}]]}}}"
}