{
  "url": "https://n8n.io/workflows/2507-automatically-update-stock-portfolio-from-onedrive-to-excel/",
  "title": "ğŸ“‚ Automatically Update Stock Portfolio from OneDrive to Excel",
  "author": "Louis",
  "publish_date": "Last update a month ago",
  "publish_date_absolute": "",
  "categories": [
    {
      "name": "Finance"
    }
  ],
  "workflow_json": "{\"meta\":{\"instanceId\":\"6045c639951d83c8706b0dd8d6330164bda01fe58f103cedc2c276bf1f9c11f1\"},\"nodes\":[{\"id\":\"fc4361c6-494a-4962-9488-2fe8dda1948c\",\"name\":\"Triggers if new file in watched folder\",\"type\":\"n8n-nodes-base.microsoftOneDriveTrigger\",\"position\":[-400,380],\"parameters\":{},\"typeVersion\":1},{\"id\":\"7e914111-ed3b-42c1-9461-5d36739db2b3\",\"name\":\"Not CSV\",\"type\":\"n8n-nodes-base.stopAndError\",\"position\":[520,500],\"parameters\":{},\"typeVersion\":1},{\"id\":\"43f092fe-9bc5-4e5f-a80b-db8aae53c9af\",\"name\":\"Extracts data from csv\",\"type\":\"n8n-nodes-base.extractFromFile\",\"position\":[520,260],\"parameters\":{},\"typeVersion\":1},{\"id\":\"142f14e7-663f-4225-8e58-551c1e089450\",\"name\":\"Microsoft OneDrive2\",\"type\":\"n8n-nodes-base.microsoftOneDrive\",\"onError\":\"continueErrorOutput\",\"position\":[1300,260],\"parameters\":{},\"typeVersion\":1,\"alwaysOutputData\":true},{\"id\":\"4d62251b-9a0d-4426-bf31-6fab04a645a7\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-960,200],\"parameters\":{\"content\":\"\"},\"typeVersion\":1},{\"id\":\"48186060-343b-458c-bf2e-a5df501445e2\",\"name\":\"Cleans the output\",\"type\":\"n8n-nodes-base.code\",\"position\":[740,260],\"parameters\":{},\"notesInFlow\":false,\"typeVersion\":2},{\"id\":\"5914197f-f217-447b-acab-b149f70b11ab\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[660,5.929829979644694],\"parameters\":{\"content\":\"\"},\"typeVersion\":1},{\"id\":\"c2d9e3a4-b9de-4b25-a06d-49d30402dab0\",\"name\":\"No Operation, do nothing\",\"type\":\"n8n-nodes-base.noOp\",\"position\":[1540,280],\"parameters\":{},\"typeVersion\":1},{\"id\":\"8d65a94e-3946-4586-ad65-15f765f1b38c\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1500,80],\"parameters\":{\"content\":\"\"},\"typeVersion\":1},{\"id\":\"d2e0d8d2-f62a-4831-be0c-049d735c1fd5\",\"name\":\"Logs the update on sheet\",\"type\":\"n8n-nodes-base.microsoftExcel\",\"position\":[-220,380],\"parameters\":{},\"typeVersion\":2.1},{\"id\":\"ff21f07d-7b6a-46cc-87db-2a3fdcd9614f\",\"name\":\"Gets the new file infos\",\"type\":\"n8n-nodes-base.microsoftOneDrive\",\"position\":[-40,380],\"parameters\":{},\"typeVersion\":1},{\"id\":\"7cfa40a4-f3c9-464f-83d4-1eea2a869c75\",\"name\":\"Downloads the new file\",\"type\":\"n8n-nodes-base.microsoftOneDrive\",\"position\":[160,380],\"parameters\":{},\"typeVersion\":1},{\"id\":\"e936a8ec-5544-4d13-9dca-747983ab7e50\",\"name\":\"Checks if it's CSV format\",\"type\":\"n8n-nodes-base.if\",\"position\":[340,380],\"parameters\":{},\"typeVersion\":2.2},{\"id\":\"f5b24101-4cb9-4a4a-be33-9b6191e20401\",\"name\":\"Prepares the fields to put in the excel table\",\"type\":\"n8n-nodes-base.set\",\"position\":[940,260],\"parameters\":{},\"typeVersion\":3.4},{\"id\":\"47793366-1655-4322-ba74-14a5b31b03e8\",\"name\":\"Updates the excel table\",\"type\":\"n8n-nodes-base.microsoftExcel\",\"position\":[1120,260],\"parameters\":{},\"typeVersion\":2.1}],\"pinData\":{},\"connections\":{\"Cleans the output\":{\"main\":[[{\"node\":\"Prepares the fields to put in the excel table\",\"type\":\"main\",\"index\":0}]]},\"Microsoft OneDrive2\":{\"main\":[null,[{\"node\":\"No Operation, do nothing\",\"type\":\"main\",\"index\":0}]]},\"Downloads the new file\":{\"main\":[[{\"node\":\"Checks if it's CSV format\",\"type\":\"main\",\"index\":0}]]},\"Extracts data from csv\":{\"main\":[[{\"node\":\"Cleans the output\",\"type\":\"main\",\"index\":0}]]},\"Gets the new file infos\":{\"main\":[[{\"node\":\"Downloads the new file\",\"type\":\"main\",\"index\":0}]]},\"Updates the excel table\":{\"main\":[[{\"node\":\"Microsoft OneDrive2\",\"type\":\"main\",\"index\":0}]]},\"Logs the update on sheet\":{\"main\":[[{\"node\":\"Gets the new file infos\",\"type\":\"main\",\"index\":0}]]},\"Checks if it's CSV format\":{\"main\":[[{\"node\":\"Extracts data from csv\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Not CSV\",\"type\":\"main\",\"index\":0}]]},\"Triggers if new file in watched folder\":{\"main\":[[{\"node\":\"Logs the update on sheet\",\"type\":\"main\",\"index\":0}]]},\"Prepares the fields to put in the excel table\":{\"main\":[[{\"node\":\"Updates the excel table\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "## Seamlessly Sync and Update Data from a csv in OneDrive to Excel with n8n\n\nThis workflow is perfect for users who need a reliable, automated way to transfer and organize data from OneDrive into Excelâ€”especially for tasks like portfolio tracking, inventory management, and record-keeping. By monitoring your OneDrive folder for new CSV files, it performs data cleaning, transformation, and real-time updates in an Excel sheet, ensuring only new or changed records are added.\n\n* * *\n\n## How it Works\n\n  1. **Automated Monitoring** : Every minute, the workflow scans a designated OneDrive folder for new files.\n  2. **File Verification** : It checks if the detected file is in CSV format; if not, the process stops with an error message.\n  3. **Data Extraction and Cleaning** : CSV data is loaded, and irrelevant headers are removed before mapping to specified columns in Excel.\n  4. **Excel Update** : The workflow maps data to your Excel sheet, updating only new or modified entries based on a unique identifier (\"Ticker/ISIN\").\n  5. **Cleanup** : To keep your OneDrive organized, processed files are deleted after updating Excel.\n\n\n\n* * *\n\n## Setup Steps\n\n  1. **Connect OneDrive and Excel Accounts** : Link your Microsoft OneDrive and Excel accounts in n8n.\n  2. **Designate Folder and Worksheet** : Specify the OneDrive folder for monitoring and the Excel sheet for data updates.\n  3. **Configure Sync Frequency and CSV Validation** : Set the monitoring frequency to every minute and ensure the workflow identifies CSV files accurately.\n\n\n\nOnce configured, this workflow offers a hands-free, efficient solution to keep your OneDrive and Excel data synchronized effortlessly.\n",
  "crawled_at": "2025-05-26T00:05:12.612224",
  "readme_zh": "## é€šè¿‡n8nå®ç°OneDriveä¸­çš„CSVæ•°æ®ä¸Excelæ— ç¼åŒæ­¥æ›´æ–°\n\næœ¬å·¥ä½œæµä¸“ä¸ºéœ€è¦ä»OneDriveè‡ªåŠ¨åŒæ­¥æ•°æ®è‡³Excelçš„ç”¨æˆ·è®¾è®¡ï¼Œå°¤å…¶é€‚ç”¨äºæŠ•èµ„ç»„åˆè·Ÿè¸ªã€åº“å­˜ç®¡ç†å’Œæ•°æ®å½’æ¡£ç­‰åœºæ™¯ã€‚å®ƒèƒ½å®æ—¶ç›‘æ§æŒ‡å®šOneDriveæ–‡ä»¶å¤¹ä¸­çš„CSVæ–‡ä»¶ï¼Œæ‰§è¡Œæ•°æ®æ¸…æ´—ã€æ ¼å¼è½¬æ¢ç­‰æ“ä½œï¼Œå¹¶ç¡®ä¿Excelè¡¨æ ¼ä»…æ›´æ–°æ–°å¢æˆ–å˜æ›´çš„è®°å½•ã€‚\n\n* * *\n\n## è¿ä½œåŸç†\n\n  1. **è‡ªåŠ¨ç›‘æ§** ï¼šæ¯åˆ†é’Ÿæ‰«æOneDriveæŒ‡å®šæ–‡ä»¶å¤¹çš„æ–°æ–‡ä»¶\n  2. **æ–‡ä»¶éªŒè¯** ï¼šæ£€æµ‹æ˜¯å¦ä¸ºCSVæ ¼å¼ï¼ŒéCSVæ–‡ä»¶å°†è§¦å‘é”™è¯¯æç¤ºå¹¶ç»ˆæ­¢æµç¨‹\n  3. **æ•°æ®æå–ä¸æ¸…æ´—** ï¼šè¯»å–CSVæ•°æ®åè‡ªåŠ¨æ¸…é™¤å†—ä½™è¡¨å¤´ï¼Œå¹¶æŒ‰Excelé¢„è®¾åˆ—è¿›è¡Œæ˜ å°„\n  4. **Excelæ›´æ–°** ï¼šåŸºäºå”¯ä¸€æ ‡è¯†ç¬¦ï¼ˆå¦‚\"è‚¡ç¥¨ä»£ç /ISIN\"ï¼‰ä»…åŒæ­¥æ–°å¢æˆ–ä¿®æ”¹çš„è®°å½•\n  5. **è‡ªåŠ¨æ¸…ç†** ï¼šå¤„ç†å®Œæˆåè‡ªåŠ¨åˆ é™¤OneDriveä¸­çš„åŸå§‹æ–‡ä»¶ï¼Œä¿æŒäº‘ç«¯æ•´æ´\n\n* * *\n\n## é…ç½®æ­¥éª¤\n\n  1. **è´¦æˆ·æˆæƒ** ï¼šåœ¨n8nä¸­ç»‘å®šæ‚¨çš„Microsoft OneDriveå’ŒExcelè´¦æˆ·\n  2. **è·¯å¾„æŒ‡å®š** ï¼šè®¾ç½®ç›‘æ§æ–‡ä»¶å¤¹è·¯å¾„åŠç›®æ ‡Excelå·¥ä½œè¡¨\n  3. **å‚æ•°é…ç½®** ï¼šå°†æ‰«æé¢‘ç‡è®¾ä¸ºæ¯åˆ†é’Ÿï¼Œå¹¶å¯ç”¨CSVæ–‡ä»¶æ ¡éªŒåŠŸèƒ½\n\nå®Œæˆé…ç½®åï¼Œè¯¥å·¥ä½œæµå°†å…¨è‡ªåŠ¨ä¿æŒOneDriveä¸Excelçš„æ•°æ®åŒæ­¥ï¼Œå½»åº•è§£æ”¾æ‚¨çš„åŒæ‰‹ã€‚",
  "title_zh": "ğŸ“‚ è‡ªåŠ¨ä»OneDriveæ›´æ–°è‚¡ç¥¨æŠ•èµ„ç»„åˆè‡³Excel",
  "publish_date_zh": "ä¸Šæ¬¡æ›´æ–°äºä¸€ä¸ªæœˆå‰",
  "workflow_json_zh": "{\"meta\":{\"instanceId\":\"6045c639951d83c8706b0dd8d6330164bda01fe58f103cedc2c276bf1f9c11f1\"},\"nodes\":[{\"id\":\"fc4361c6-494a-4962-9488-2fe8dda1948c\",\"name\":\"Triggers if new file in watched folder\",\"type\":\"n8n-nodes-base.microsoftOneDriveTrigger\",\"position\":[-400,380],\"parameters\":{},\"typeVersion\":1},{\"id\":\"7e914111-ed3b-42c1-9461-5d36739db2b3\",\"name\":\"Not CSV\",\"type\":\"n8n-nodes-base.stopAndError\",\"position\":[520,500],\"parameters\":{},\"typeVersion\":1},{\"id\":\"43f092fe-9bc5-4e5f-a80b-db8aae53c9af\",\"name\":\"Extracts data from csv\",\"type\":\"n8n-nodes-base.extractFromFile\",\"position\":[520,260],\"parameters\":{},\"typeVersion\":1},{\"id\":\"142f14e7-663f-4225-8e58-551c1e089450\",\"name\":\"Microsoft OneDrive2\",\"type\":\"n8n-nodes-base.microsoftOneDrive\",\"onError\":\"continueErrorOutput\",\"position\":[1300,260],\"parameters\":{},\"typeVersion\":1,\"alwaysOutputData\":true},{\"id\":\"4d62251b-9a0d-4426-bf31-6fab04a645a7\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-960,200],\"parameters\":{\"content\":\"\"},\"typeVersion\":1},{\"id\":\"48186060-343b-458c-bf2e-a5df501445e2\",\"name\":\"Cleans the output\",\"type\":\"n8n-nodes-base.code\",\"position\":[740,260],\"parameters\":{},\"notesInFlow\":false,\"typeVersion\":2},{\"id\":\"5914197f-f217-447b-acab-b149f70b11ab\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[660,5.929829979644694],\"parameters\":{\"content\":\"\"},\"typeVersion\":1},{\"id\":\"c2d9e3a4-b9de-4b25-a06d-49d30402dab0\",\"name\":\"No Operation, do nothing\",\"type\":\"n8n-nodes-base.noOp\",\"position\":[1540,280],\"parameters\":{},\"typeVersion\":1},{\"id\":\"8d65a94e-3946-4586-ad65-15f765f1b38c\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1500,80],\"parameters\":{\"content\":\"\"},\"typeVersion\":1},{\"id\":\"d2e0d8d2-f62a-4831-be0c-049d735c1fd5\",\"name\":\"Logs the update on sheet\",\"type\":\"n8n-nodes-base.microsoftExcel\",\"position\":[-220,380],\"parameters\":{},\"typeVersion\":2.1},{\"id\":\"ff21f07d-7b6a-46cc-87db-2a3fdcd9614f\",\"name\":\"Gets the new file infos\",\"type\":\"n8n-nodes-base.microsoftOneDrive\",\"position\":[-40,380],\"parameters\":{},\"typeVersion\":1},{\"id\":\"7cfa40a4-f3c9-464f-83d4-1eea2a869c75\",\"name\":\"Downloads the new file\",\"type\":\"n8n-nodes-base.microsoftOneDrive\",\"position\":[160,380],\"parameters\":{},\"typeVersion\":1},{\"id\":\"e936a8ec-5544-4d13-9dca-747983ab7e50\",\"name\":\"Checks if it's CSV format\",\"type\":\"n8n-nodes-base.if\",\"position\":[340,380],\"parameters\":{},\"typeVersion\":2.2},{\"id\":\"f5b24101-4cb9-4a4a-be33-9b6191e20401\",\"name\":\"Prepares the fields to put in the excel table\",\"type\":\"n8n-nodes-base.set\",\"position\":[940,260],\"parameters\":{},\"typeVersion\":3.4},{\"id\":\"47793366-1655-4322-ba74-14a5b31b03e8\",\"name\":\"Updates the excel table\",\"type\":\"n8n-nodes-base.microsoftExcel\",\"position\":[1120,260],\"parameters\":{},\"typeVersion\":2.1}],\"pinData\":{},\"connections\":{\"Cleans the output\":{\"main\":[[{\"node\":\"Prepares the fields to put in the excel table\",\"type\":\"main\",\"index\":0}]]},\"Microsoft OneDrive2\":{\"main\":[null,[{\"node\":\"No Operation, do nothing\",\"type\":\"main\",\"index\":0}]]},\"Downloads the new file\":{\"main\":[[{\"node\":\"Checks if it's CSV format\",\"type\":\"main\",\"index\":0}]]},\"Extracts data from csv\":{\"main\":[[{\"node\":\"Cleans the output\",\"type\":\"main\",\"index\":0}]]},\"Gets the new file infos\":{\"main\":[[{\"node\":\"Downloads the new file\",\"type\":\"main\",\"index\":0}]]},\"Updates the excel table\":{\"main\":[[{\"node\":\"Microsoft OneDrive2\",\"type\":\"main\",\"index\":0}]]},\"Logs the update on sheet\":{\"main\":[[{\"node\":\"Gets the new file infos\",\"type\":\"main\",\"index\":0}]]},\"Checks if it's CSV format\":{\"main\":[[{\"node\":\"Extracts data from csv\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Not CSV\",\"type\":\"main\",\"index\":0}]]},\"Triggers if new file in watched folder\":{\"main\":[[{\"node\":\"Logs the update on sheet\",\"type\":\"main\",\"index\":0}]]},\"Prepares the fields to put in the excel table\":{\"main\":[[{\"node\":\"Updates the excel table\",\"type\":\"main\",\"index\":0}]]}}}"
}