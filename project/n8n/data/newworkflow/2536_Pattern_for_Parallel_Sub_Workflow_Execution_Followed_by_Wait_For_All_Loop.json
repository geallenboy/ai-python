{
  "url": "https://n8n.io/workflows/2536-pattern-for-parallel-sub-workflow-execution-followed-by-wait-for-all-loop/",
  "title": "Pattern for Parallel Sub-Workflow Execution Followed by Wait-For-All Loop",
  "author": "Hubschrauber",
  "publish_date": "Last update 6 months ago",
  "publish_date_absolute": "2024-11-26",
  "categories": [
    {
      "name": "Other"
    },
    {
      "name": "Building Blocks"
    }
  ],
  "workflow_json": "{\"nodes\":[{\"id\":\"0d911b91-bb9a-4177-8cd5-12ddddf1bc61\",\"name\":\"When clicking ‘Test workflow’\",\"type\":\"n8n-nodes-base.manualTrigger\",\"position\":[580,405],\"parameters\":{},\"typeVersion\":1},{\"id\":\"d13f78f7-4093-435f-8b38-722f4a5c7a1f\",\"name\":\"Loop Over Items\",\"type\":\"n8n-nodes-base.splitInBatches\",\"position\":[1020,405],\"parameters\":{\"options\":{}},\"typeVersion\":3},{\"id\":\"97d26220-a85f-4c40-b97c-b36f2d235776\",\"name\":\"Webhook Callback Wait\",\"type\":\"n8n-nodes-base.wait\",\"position\":[1720,445],\"webhookId\":\"5cd058b4-48c8-449a-9c09-959a5b8a2b48\",\"parameters\":{\"resume\":\"webhook\",\"options\":{},\"httpMethod\":\"POST\",\"responseMode\":\"responseNode\"},\"typeVersion\":1.1},{\"id\":\"ee02d5cb-8151-4b24-a630-77a677b1434a\",\"name\":\"Update finishedSet\",\"type\":\"n8n-nodes-base.code\",\"position\":[1940,445],\"parameters\":{\"jsCode\":\"let json = $('If All Finished').first().json;\\nif (!json.finishedSet) json.finishedSet = [];\\nlet finishedItemId = $('Webhook Callback Wait').item.json.body.finishedItemId;\\nif (!json.finishedSet[finishedItemId]) json.finishedSet.push(finishedItemId);\\nreturn [json];\"},\"typeVersion\":2},{\"id\":\"09f1cf3f-9e32-43f2-9e57-d7a33970dac4\",\"name\":\"Initialize finishedSet\",\"type\":\"n8n-nodes-base.set\",\"position\":[1240,285],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"193ab8f1-0e23-491c-914e-b8b26b0160f7\",\"name\":\"finishedSet\",\"type\":\"array\",\"value\":\"[]\"}]}},\"executeOnce\":true,\"typeVersion\":3.4},{\"id\":\"105d8f64-8ade-4e02-8722-587a35f2b046\",\"name\":\"Simulate Multi-Item for Parallel Processing\",\"type\":\"n8n-nodes-base.code\",\"position\":[780,405],\"parameters\":{\"jsCode\":\"return [\\n  {requestId: 'req4567'},\\n  {requestId: 'req8765'},\\n  {requestId: 'req1234'}\\n];\"},\"typeVersion\":2},{\"id\":\"c5f72fa0-693e-4134-910f-8fd0767861d1\",\"name\":\"If All Finished\",\"type\":\"n8n-nodes-base.if\",\"position\":[1460,285],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":1,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"385c3149-3623-4dd2-9022-770c32f82421\",\"operator\":{\"type\":\"number\",\"operation\":\"gte\"},\"leftValue\":\"={{ $json.finishedSet.length }}\",\"rightValue\":\"={{ $('Simulate Multi-Item for Parallel Processing').all().length }}\"}]}},\"typeVersion\":2},{\"id\":\"20d16393-8573-4cc1-adc0-034f0f1def70\",\"name\":\"Start Sub-Workflow via Webhook\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[1180,645],\"parameters\":{\"url\":\"={{ $env.WEBHOOK_URL }}/webhook/parallel-subworkflow-target\",\"method\":\"POST\",\"options\":{},\"sendBody\":true,\"sendHeaders\":true,\"bodyParameters\":{\"parameters\":[{\"name\":\"requestItemId\",\"value\":\"={{ $json.requestId }}\"}]},\"headerParameters\":{\"parameters\":[{\"name\":\"callbackurl\",\"value\":\"={{ $execution.resumeUrl }}\"}]}},\"typeVersion\":4.2},{\"id\":\"4ad48520-39b3-4016-a6a9-dd789c079e08\",\"name\":\"Acknowledge Finished\",\"type\":\"n8n-nodes-base.respondToWebhook\",\"position\":[1780,665],\"parameters\":{\"options\":{}},\"typeVersion\":1.1},{\"id\":\"ad1018a1-3b9d-4613-b23f-136763a514ba\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[720,605],\"parameters\":{\"color\":3,\"width\":390,\"height\":109,\"content\":\"### Start Multiple Sub-Workflows Asynchronously\\n* Note: Callback/Webhook \\\"internal\\\" Base-URL should be configured in the n8n instance to reference the k8s service name and internal port.\"},\"typeVersion\":1},{\"id\":\"f4171d39-8bfe-4e3a-9b94-87d969abda2d\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1740,365],\"parameters\":{\"color\":3,\"width\":283,\"height\":80,\"content\":\"### Pseudo-Synchronously Wait for All Sub-Workflows to finish\"},\"typeVersion\":1},{\"id\":\"98657cd3-968c-4d66-aea0-4e3180f8508f\",\"name\":\"Continue Workflow (noop)\",\"type\":\"n8n-nodes-base.noOp\",\"position\":[1780,205],\"parameters\":{},\"typeVersion\":1},{\"id\":\"5a9518ea-456e-4975-bf6f-71bf9ed0a6e1\",\"name\":\"Sticky Note3\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[540,180],\"parameters\":{\"width\":1577.931818181817,\"height\":684.1818181818179,\"content\":\"## Main/Parent Workflow\\n* This starts multiple executions of the sub-workflow in parallel and then loops until they all report back.\"},\"typeVersion\":1},{\"id\":\"13ad3423-c3bf-4144-b76d-03daa8877bed\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[560,900],\"parameters\":{\"width\":1477.331211260329,\"height\":189.2194473140495,\"content\":\"### Sub-Workflow\\n**Cut/Paste this into a separate workflow, and activate it!!!**\"},\"typeVersion\":1},{\"id\":\"e92865b0-b3e9-4195-ae16-5c199875a04b\",\"name\":\"Wait\",\"type\":\"n8n-nodes-base.wait\",\"position\":[1440,940],\"webhookId\":\"2d62e5c2-ad4a-4e90-a075-7ca5212e015a\",\"parameters\":{},\"typeVersion\":1.1},{\"id\":\"710456c8-394d-4c45-8d8e-16e0a4095dc3\",\"name\":\"Call Resume on Parent Workflow\",\"type\":\"n8n-nodes-base.httpRequest\",\"notes\":\"The callback resumes the parent workflow and reports which item finished.  There could be a race condition if the parent workflow was just resumed by a different sub-workflow but hasn't entered a webhook-wait again yet.  The delay and retry mitigates for the possibility that multiple subtasks complete and call back at once.\",\"position\":[1660,940],\"parameters\":{\"url\":\"={{ $('Webhook').item.json.headers.callbackurl }}\",\"method\":\"POST\",\"options\":{},\"sendBody\":true,\"bodyParameters\":{\"parameters\":[{\"name\":\"finishedItemId\",\"value\":\"={{ $('Webhook').item.json.body.requestItemId }}\"}]}},\"retryOnFail\":true,\"typeVersion\":4.2,\"waitBetweenTries\":3000},{\"id\":\"2ee41b1a-89f0-4d2f-b2ff-74aef5baaa70\",\"name\":\"Respond to Webhook\",\"type\":\"n8n-nodes-base.respondToWebhook\",\"position\":[1220,940],\"parameters\":{\"options\":{},\"respondWith\":\"json\",\"responseBody\":\"={{ \\n{\\n  \\\"finishedItemId\\\": $json.body.requestItemId\\n}\\n}}\"},\"typeVersion\":1.1},{\"id\":\"04445a9a-61f9-468e-8589-3eeb403f2553\",\"name\":\"Webhook\",\"type\":\"n8n-nodes-base.webhook\",\"position\":[1000,940],\"webhookId\":\"14776b45-77d7-4220-808f-2d0a38bec4de\",\"parameters\":{\"path\":\"parallel-subworkflow-target\",\"options\":{},\"httpMethod\":\"POST\",\"responseMode\":\"responseNode\"},\"typeVersion\":2}],\"pinData\":{},\"connections\":{\"Wait\":{\"main\":[[{\"node\":\"Call Resume on Parent Workflow\",\"type\":\"main\",\"index\":0}]]},\"Webhook\":{\"main\":[[{\"node\":\"Respond to Webhook\",\"type\":\"main\",\"index\":0}]]},\"If All Finished\":{\"main\":[[{\"node\":\"Continue Workflow (noop)\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Webhook Callback Wait\",\"type\":\"main\",\"index\":0}]]},\"Loop Over Items\":{\"main\":[[{\"node\":\"Initialize finishedSet\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Start Sub-Workflow via Webhook\",\"type\":\"main\",\"index\":0}]]},\"Respond to Webhook\":{\"main\":[[{\"node\":\"Wait\",\"type\":\"main\",\"index\":0}]]},\"Update finishedSet\":{\"main\":[[{\"node\":\"Acknowledge Finished\",\"type\":\"main\",\"index\":0}]]},\"Acknowledge Finished\":{\"main\":[[{\"node\":\"If All Finished\",\"type\":\"main\",\"index\":0}]]},\"Webhook Callback Wait\":{\"main\":[[{\"node\":\"Update finishedSet\",\"type\":\"main\",\"index\":0}]]},\"Initialize finishedSet\":{\"main\":[[{\"node\":\"If All Finished\",\"type\":\"main\",\"index\":0}]]},\"Start Sub-Workflow via Webhook\":{\"main\":[[{\"node\":\"Loop Over Items\",\"type\":\"main\",\"index\":0}]]},\"When clicking ‘Test workflow’\":{\"main\":[[{\"node\":\"Simulate Multi-Item for Parallel Processing\",\"type\":\"main\",\"index\":0}]]},\"Simulate Multi-Item for Parallel Processing\":{\"main\":[[{\"node\":\"Loop Over Items\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "## What this workflow does\n\nThis (set of) workflow(s) shows how to start multiple sub-workflows, asynchronously, in parallel, and then wait for all of them to complete. Normally sub-workflows would need to be run synchronously, in series, or, if they are executed asynchronously (to run concurrently, in parallel), there is no easy way to merge/wait for an arbitrary number of them to complete.\n\nThis is a \"design pattern\" template to show one approach for running multiple, data-driven instances of a sub-workflow \"asynchronously,\" in parallel (instead of running them one at a time in series), but still prevent the later steps in the workflow from continuing until all of the sub-workflows have reported back that they are finished, via callback URL. There are other techniques involving messaging services, database tables, or other external \"flow manager\" helpers, but this technique accomplishes the goal fully within n8n.\n\n## Setup\n\nTo implement this pattern, examine the nodes in the template and modify the incoming data leading to:\n\n  1. A split-out loop to acynchronously execute a sub-workflow multiple times, in parallel. \n     * For instance, each sub-workflow might process one of a list of incoming documents.\n     * The resumeUrl for the main/parent workflow is provided to all of the sub-workflow executions, along with a unique identifier that can be counted later (e.g. a document file-name).\n  2. A \"wait-for-all\" loop that checks whether all sub-workflows have reported back (`if` node) and builds a unique list of identifiers from the callbacks received from each execution of the sub-workflow. \n     * The sub-workflow should be designed to respond immediately (async) and later send a callback request when it has finished processing.\n     * The callback request should include the unique identifier value received when the sub-workflow it was started.\n\n\n\nThis is meant to be a possible answer to questions like [this one about running things in parallel](https://community.n8n.io/t/is-it-possible-to-run-a-part-of-the-workflow-in-parallel/60221), maybe [this one about waiting for things to finish](https://community.n8n.io/t/node-does-not-wait-for-predecessor-node-always-need-a-merge-node/60773), [this one about managing sub-batches of things by waiting for each batch](https://community.n8n.io/t/maximum-parallel-subworkflows/60052), or [this one about running things in parallel](https://community.n8n.io/t/parallel-execution-of-bat-files/49493). The topic of how to do this comes up A LOT, and this is one of the only techniques that (so far) seems to work.\n",
  "crawled_at": "2025-05-26T00:13:23.611634",
  "readme_zh": "## 工作流功能说明\n\n本（系列）工作流演示了如何异步并行启动多个子工作流，并等待所有子流程执行完毕。通常情况下，子工作流需要以同步串行方式运行；若采用异步并行执行，则缺乏简便方法来汇总/等待任意数量的子流程完成。\n\n本模板展示了一种\"设计模式\"解决方案，通过回调URL机制实现以下功能：\n1. 以数据驱动的方式异步并行运行多个子工作流实例（而非串行逐个执行）\n2. 确保主工作流后续步骤在所有子工作流完成回调前保持等待状态\n\n虽然存在消息服务、数据库表或其他外部\"流程管理器\"等替代方案，但本技术完全在n8n体系内实现了目标。\n\n## 配置指南\n\n实施此模式时，请参照模板节点结构调整输入数据流向：\n\n一、异步并行执行拆分循环\n   * 示例：每个子工作流处理一个传入文档\n   * 向所有子工作流实例提供主工作流的resumeUrl及唯一标识符（如文档文件名）\n\n二、\"全量等待\"循环机制\n   * 通过条件节点检查是否收到所有子工作流回调\n   * 根据子工作流回调构建唯一标识符列表\n   * 子工作流设计规范：\n     - 需立即异步响应，处理完成后发送回调请求\n     - 回调请求须包含启动时接收的唯一标识符\n\n本方案适用于解决以下典型问题场景：\n- [并行执行需求](https://community.n8n.io/t/is-it-possible-to-run-a-part-of-the-workflow-in-parallel/60221)\n- [流程等待机制](https://community.n8n.io/t/node-does-not-wait-for-predecessor-node-always-need-a-merge-node/60773)\n- [批次任务管理](https://community.n8n.io/t/maximum-parallel-subworkflows/60052)\n- [并行批处理](https://community.n8n.io/t/parallel-execution-of-bat-files/49493)\n\n该需求在社区频繁出现，目前此方案是经实践验证的有效解决方案之一。",
  "title_zh": "并行子工作流执行后接等待全部循环的模式",
  "publish_date_zh": "最后更新于6个月前",
  "workflow_json_zh": "{\n  \"nodes\": [\n    {\n      \"id\": \"0d911b91-bb9a-4177-8cd5-12ddddf1bc61\",\n      \"name\": \"When clicking ‘Test workflow’\",\n      \"type\": \"n8n-nodes-base.manualTrigger\",\n      \"position\": [\n        580,\n        405\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"d13f78f7-4093-435f-8b38-722f4a5c7a1f\",\n      \"name\": \"Loop Over Items\",\n      \"type\": \"n8n-nodes-base.splitInBatches\",\n      \"position\": [\n        1020,\n        405\n      ],\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"97d26220-a85f-4c40-b97c-b36f2d235776\",\n      \"name\": \"Webhook Callback Wait\",\n      \"type\": \"n8n-nodes-base.wait\",\n      \"position\": [\n        1720,\n        445\n      ],\n      \"webhookId\": \"5cd058b4-48c8-449a-9c09-959a5b8a2b48\",\n      \"parameters\": {\n        \"resume\": \"webhook\",\n        \"options\": {},\n        \"httpMethod\": \"POST\",\n        \"responseMode\": \"responseNode\"\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"ee02d5cb-8151-4b24-a630-77a677b1434a\",\n      \"name\": \"Update finishedSet\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        1940,\n        445\n      ],\n      \"parameters\": {\n        \"jsCode\": \"let json = $('If All Finished').first().json;\\nif (!json.finishedSet) json.finishedSet = [];\\nlet finishedItemId = $('Webhook Callback Wait').item.json.body.finishedItemId;\\nif (!json.finishedSet[finishedItemId]) json.finishedSet.push(finishedItemId);\\nreturn [json];\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"09f1cf3f-9e32-43f2-9e57-d7a33970dac4\",\n      \"name\": \"Initialize finishedSet\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1240,\n        285\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"193ab8f1-0e23-491c-914e-b8b26b0160f7\",\n              \"name\": \"finishedSet\",\n              \"type\": \"array\",\n              \"value\": \"[]\"\n            }\n          ]\n        }\n      },\n      \"executeOnce\": true,\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"105d8f64-8ade-4e02-8722-587a35f2b046\",\n      \"name\": \"Simulate Multi-Item for Parallel Processing\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        780,\n        405\n      ],\n      \"parameters\": {\n        \"jsCode\": \"return [\\n  {requestId: 'req4567'},\\n  {requestId: 'req8765'},\\n  {requestId: 'req1234'}\\n];\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"c5f72fa0-693e-4134-910f-8fd0767861d1\",\n      \"name\": \"If All Finished\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        1460,\n        285\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 1,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"385c3149-3623-4dd2-9022-770c32f82421\",\n              \"operator\": {\n                \"type\": \"number\",\n                \"operation\": \"gte\"\n              },\n              \"leftValue\": \"={{ $json.finishedSet.length }}\",\n              \"rightValue\": \"={{ $('Simulate Multi-Item for Parallel Processing').all().length }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"20d16393-8573-4cc1-adc0-034f0f1def70\",\n      \"name\": \"Start Sub-Workflow via Webhook\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1180,\n        645\n      ],\n      \"parameters\": {\n        \"url\": \"={{ $env.WEBHOOK_URL }}/webhook/parallel-subworkflow-target\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"sendBody\": true,\n        \"sendHeaders\": true,\n        \"bodyParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"requestItemId\",\n              \"value\": \"={{ $json.requestId }}\"\n            }\n          ]\n        },\n        \"headerParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"callbackurl\",\n              \"value\": \"={{ $execution.resumeUrl }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"4ad48520-39b3-4016-a6a9-dd789c079e08\",\n      \"name\": \"Acknowledge Finished\",\n      \"type\": \"n8n-nodes-base.respondToWebhook\",\n      \"position\": [\n        1780,\n        665\n      ],\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"ad1018a1-3b9d-4613-b23f-136763a514ba\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        720,\n        605\n      ],\n      \"parameters\": {\n        \"color\": 3,\n        \"width\": 390,\n        \"height\": 109,\n        \"content\": \"### 异步启动多个子工作流\\n* 注意：回调/网络钩子的\\\"内部\\\"基础URL需在n8n实例中配置，以引用k8s服务名称及内部端口。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"f4171d39-8bfe-4e3a-9b94-87d969abda2d\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1740,\n        365\n      ],\n      \"parameters\": {\n        \"color\": 3,\n        \"width\": 283,\n        \"height\": 80,\n        \"content\": \"### 伪同步等待所有子工作流完成\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"98657cd3-968c-4d66-aea0-4e3180f8508f\",\n      \"name\": \"Continue Workflow (noop)\",\n      \"type\": \"n8n-nodes-base.noOp\",\n      \"position\": [\n        1780,\n        205\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"5a9518ea-456e-4975-bf6f-71bf9ed0a6e1\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        540,\n        180\n      ],\n      \"parameters\": {\n        \"width\": 1577.931818181817,\n        \"height\": 684.1818181818179,\n        \"content\": \"## 主/父工作流\\n* 此流程会并行启动多个子工作流的执行实例，随后循环等待所有子流程返回结果。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"13ad3423-c3bf-4144-b76d-03daa8877bed\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        560,\n        900\n      ],\n      \"parameters\": {\n        \"width\": 1477.331211260329,\n        \"height\": 189.2194473140495,\n        \"content\": \"### 子工作流程\\n**将以下内容剪切/粘贴到独立的工作流程中，并激活它！！！**\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"e92865b0-b3e9-4195-ae16-5c199875a04b\",\n      \"name\": \"Wait\",\n      \"type\": \"n8n-nodes-base.wait\",\n      \"position\": [\n        1440,\n        940\n      ],\n      \"webhookId\": \"2d62e5c2-ad4a-4e90-a075-7ca5212e015a\",\n      \"parameters\": {},\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"710456c8-394d-4c45-8d8e-16e0a4095dc3\",\n      \"name\": \"Call Resume on Parent Workflow\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"notes\": \"The callback resumes the parent workflow and reports which item finished.  There could be a race condition if the parent workflow was just resumed by a different sub-workflow but hasn't entered a webhook-wait again yet.  The delay and retry mitigates for the possibility that multiple subtasks complete and call back at once.\",\n      \"position\": [\n        1660,\n        940\n      ],\n      \"parameters\": {\n        \"url\": \"={{ $('Webhook').item.json.headers.callbackurl }}\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"sendBody\": true,\n        \"bodyParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"finishedItemId\",\n              \"value\": \"={{ $('Webhook').item.json.body.requestItemId }}\"\n            }\n          ]\n        }\n      },\n      \"retryOnFail\": true,\n      \"typeVersion\": 4.2,\n      \"waitBetweenTries\": 3000\n    },\n    {\n      \"id\": \"2ee41b1a-89f0-4d2f-b2ff-74aef5baaa70\",\n      \"name\": \"Respond to Webhook\",\n      \"type\": \"n8n-nodes-base.respondToWebhook\",\n      \"position\": [\n        1220,\n        940\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"respondWith\": \"json\",\n        \"responseBody\": \"={{ \\n{\\n  \\\"finishedItemId\\\": $json.body.requestItemId\\n}\\n}}\"\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"04445a9a-61f9-468e-8589-3eeb403f2553\",\n      \"name\": \"Webhook\",\n      \"type\": \"n8n-nodes-base.webhook\",\n      \"position\": [\n        1000,\n        940\n      ],\n      \"webhookId\": \"14776b45-77d7-4220-808f-2d0a38bec4de\",\n      \"parameters\": {\n        \"path\": \"parallel-subworkflow-target\",\n        \"options\": {},\n        \"httpMethod\": \"POST\",\n        \"responseMode\": \"responseNode\"\n      },\n      \"typeVersion\": 2\n    }\n  ],\n  \"pinData\": {},\n  \"connections\": {\n    \"Wait\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Call Resume on Parent Workflow\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Webhook\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Respond to Webhook\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"If All Finished\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Continue Workflow (noop)\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Webhook Callback Wait\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Loop Over Items\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Initialize finishedSet\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Start Sub-Workflow via Webhook\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Respond to Webhook\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Wait\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Update finishedSet\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Acknowledge Finished\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Acknowledge Finished\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"If All Finished\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Webhook Callback Wait\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Update finishedSet\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Initialize finishedSet\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"If All Finished\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Start Sub-Workflow via Webhook\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Loop Over Items\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"When clicking ‘Test workflow’\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Simulate Multi-Item for Parallel Processing\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Simulate Multi-Item for Parallel Processing\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Loop Over Items\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}