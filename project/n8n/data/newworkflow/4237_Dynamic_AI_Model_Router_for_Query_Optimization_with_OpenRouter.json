{
  "url": "https://n8n.io/workflows/4237-dynamic-ai-model-router-for-query-optimization-with-openrouter/",
  "title": "Dynamic AI Model Router for Query Optimization with OpenRouter",
  "author": "Davide",
  "publish_date": "Last update 6 days ago",
  "publish_date_absolute": "2025-05-20",
  "categories": [
    {
      "name": "Engineering"
    },
    {
      "name": "Building Blocks"
    },
    {
      "name": "AI"
    },
    {
      "name": "IT Ops"
    }
  ],
  "workflow_json": "",
  "readme": "The **Agent Decisioner** is a dynamic, AI-powered routing system that automatically selects the most appropriate large language model (LLM) to respond to a user's query based on the queryâ€™s content and purpose.\n\nThis workflow ensures **dynamic, optimized AI responses** by intelligently routing queries to the best-suited model.\n\n* * *\n\n### **Advantages**\n\n  * **ğŸ” Automatic Model Routing:**  \nAutomatically selects the best model for the job, improving efficiency and relevance of responses.\n\n  * **ğŸ¯ Optimized Use of Resources:**  \nAvoids overuse of expensive models like GPT-4 by routing simpler queries to lightweight models.\n\n  * **ğŸ“š Model-Aware Reasoning:**  \nUses detailed metadata about model capabilities (e.g., reasoning, coding, web search) for intelligent selection.\n\n  * **ğŸ“¥ Modular and Extendable:**  \nEasy to integrate with other tools or expand by adding more models or custom decision logic.\n\n  * **ğŸ‘¨â€ğŸ’» Ideal for RAG and Multi-Agent Systems:**  \nCan serve as the brain behind more complex agent frameworks or Retrieval-Augmented Generation pipelines.\n\n\n\n\n* * *\n\n### **How It Works**\n\n  1. **Chat Trigger** : The workflow starts when a user sends a message, triggering the **Routing Agent**.\n  2. **Model Selection** : The **AI Agent** analyzes the query and selects the best-suited model from the available options (e.g., Claude 3.7 Sonnet for coding, Perplexity/Sonar for web searches, GPT-4o Mini for reasoning).\n  3. **Structured Output** : The agent returns a **JSON response** with the userâ€™s prompt and the chosen model.\n  4. **Execution** : The selected model processes the query and generates a response, ensuring optimal performance for the task.\n\n\n\n### **Set Up Steps**\n\n  1. **Configure Nodes** :\n\n     * **Chat Trigger** : Set up the webhook to receive user messages.\n     * **Routing Agent (AI Agent)** : Define the system message with model strengths and JSON output rules.\n     * **OpenRouter Chat Model** : Connect to OpenRouter for model access.\n     * **Structured Output Parser** : Ensure it validates the JSON response format (`prompt` \\+ `model`).\n     * **Execution Agent (AI Agent1)** : Configure it to forward the prompt to the selected model.\n  2. **Connect Nodes** :\n\n     * Link the **Chat Trigger** to the **Routing Agent**.\n     * Connect the **OpenRouter Chat Model** and **Output Parser** to the **Routing Agent**.\n     * Route the parsed JSON to the **Execution Agent** , which uses the chosen model via **OpenRouter Chat Model1**.\n  3. **Credentials** :\n\n     * Ensure **OpenRouter API credentials** are correctly set for both chat model nodes.\n  4. **Test & Deploy**:\n\n     * Activate the workflow and test with sample queries to verify model selection logic.\n     * Adjust the routing rules if needed for better accuracy.\n\n\n\n* * *\n\n### **Need help customizing?**\n\n[Contact me](mailto:info@n3w.it) for consulting and support or add me on [Linkedin](https://www.linkedin.com/in/davideboizza/).\n",
  "crawled_at": "2025-05-26T07:23:42.728766",
  "readme_zh": "**æ™ºèƒ½è·¯ç”±å†³ç­–å™¨ï¼ˆAgent Decisionerï¼‰** æ˜¯ä¸€ä¸ªåŠ¨æ€çš„AIé©±åŠ¨è·¯ç”±ç³»ç»Ÿï¼Œèƒ½æ ¹æ®æŸ¥è¯¢å†…å®¹ä¸ç›®çš„è‡ªåŠ¨é€‰æ‹©æœ€é€‚é…çš„å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰ç”Ÿæˆå“åº”ã€‚\n\nè¯¥å·¥ä½œæµé€šè¿‡æ™ºèƒ½è·¯ç”±æœºåˆ¶å®ç°**åŠ¨æ€ä¼˜åŒ–çš„AIå“åº”**ï¼Œç¡®ä¿æ¯ä¸ªæŸ¥è¯¢éƒ½èƒ½åŒ¹é…æœ€ä½³æ¨¡å‹ã€‚\n\n* * *\n\n### **æ ¸å¿ƒä¼˜åŠ¿**\n\n  * **ğŸ”„ è‡ªåŠ¨æ¨¡å‹è·¯ç”±**  \næ™ºèƒ½é€‰æ‹©æœ€ä¼˜æ¨¡å‹ï¼Œæå‡å“åº”æ•ˆç‡ä¸ç²¾å‡†åº¦\n\n  * **ğŸ¯ èµ„æºä¼˜åŒ–é…ç½®**  \nå°†ç®€å•æŸ¥è¯¢å¯¼å‘è½»é‡çº§æ¨¡å‹ï¼Œé¿å…GPT-4ç­‰é«˜æˆæœ¬æ¨¡å‹çš„è¿‡åº¦æ¶ˆè€—\n\n  * **ğŸ“š æ¨¡å‹èƒ½åŠ›æ„ŸçŸ¥**  \nä¾æ®æ¨¡å‹å…ƒæ•°æ®ï¼ˆæ¨ç†/ç¼–ç¨‹/ç½‘ç»œæœç´¢ç­‰èƒ½åŠ›ï¼‰è¿›è¡Œæ™ºèƒ½ç­›é€‰\n\n  * **ğŸ“¥ æ¨¡å—åŒ–æ‰©å±•**  \nå¯è½»æ¾é›†æˆå…¶ä»–å·¥å…·ï¼Œæ”¯æŒæ·»åŠ æ–°æ¨¡å‹æˆ–è‡ªå®šä¹‰å†³ç­–é€»è¾‘\n\n  * **ğŸ‘¨â€ğŸ’» é€‚é…å¤æ‚ç³»ç»Ÿ**  \nå¯ä½œä¸ºRAGæ¡†æ¶æˆ–å¤šæ™ºèƒ½ä½“ç³»ç»Ÿçš„æ ¸å¿ƒè°ƒåº¦ä¸­æ¢\n\n* * *\n\n### **è¿ä½œåŸç†**\n\n  1. **è§¦å‘ä¼šè¯**ï¼šç”¨æˆ·æ¶ˆæ¯è§¦å‘**è·¯ç”±ä»£ç†**  \n  2. **æ¨¡å‹é€‰æ‹©**ï¼šAIä»£ç†åˆ†ææŸ¥è¯¢å†…å®¹ï¼Œä»å€™é€‰æ¨¡å‹åº“ï¼ˆå¦‚Claude 3.7 Sonnetå¤„ç†ç¼–ç¨‹/Perplexity/Sonaræ‰§è¡Œç½‘ç»œæœç´¢/GPT-4o Miniè´Ÿè´£æ¨ç†ï¼‰é€‰å–æœ€ä¼˜è§£  \n  3. **ç»“æ„åŒ–è¾“å‡º**ï¼šè¿”å›å«ç”¨æˆ·æç¤ºè¯ä¸é€‰å®šæ¨¡å‹çš„**JSONå“åº”**  \n  4. **æ‰§è¡Œå“åº”**ï¼šç›®æ ‡æ¨¡å‹å¤„ç†æŸ¥è¯¢å¹¶ç”Ÿæˆä¼˜åŒ–ç»“æœ  \n\n### **é…ç½®æŒ‡å—**\n\n  1. **èŠ‚ç‚¹é…ç½®**  \n     - **èŠå¤©è§¦å‘å™¨**ï¼šè®¾ç½®æ¥æ”¶ç”¨æˆ·æ¶ˆæ¯çš„webhook  \n     - **è·¯ç”±ä»£ç†**ï¼šç¼–å†™åŒ…å«æ¨¡å‹èƒ½åŠ›è¯´æ˜ä¸JSONè¾“å‡ºè§„åˆ™çš„ç³»ç»Ÿæ¶ˆæ¯  \n     - **OpenRouterèŠå¤©æ¨¡å‹**ï¼šæ¥å…¥æ¨¡å‹æœåŠ¡å¹³å°  \n     - **ç»“æ„åŒ–è¾“å‡ºè§£æå™¨**ï¼šæ ¡éªŒJSONæ ¼å¼ï¼ˆ`prompt`+`model`ï¼‰  \n     - **æ‰§è¡Œä»£ç†**ï¼šé…ç½®è½¬å‘æœºåˆ¶è‡³ç›®æ ‡æ¨¡å‹  \n  2. **èŠ‚ç‚¹è¿æ¥**  \n     - å°†**èŠå¤©è§¦å‘å™¨**æ¥å…¥**è·¯ç”±ä»£ç†**  \n     - å…³è”**OpenRouterèŠå¤©æ¨¡å‹**ä¸**è¾“å‡ºè§£æå™¨**è‡³è·¯ç”±ä»£ç†  \n     - å°†è§£æåçš„JSONè·¯ç”±è‡³é€šè¿‡**OpenRouter Chat Model1**è°ƒç”¨æŒ‡å®šæ¨¡å‹çš„**æ‰§è¡Œä»£ç†**  \n  3. **å‡­è¯è®¾ç½®**  \n     - ç¡®ä¿æ‰€æœ‰èŠå¤©æ¨¡å‹èŠ‚ç‚¹å·²é…ç½®æ­£ç¡®çš„**OpenRouter APIå‡­è¯**  \n  4. **æµ‹è¯•éƒ¨ç½²**  \n     - æ¿€æ´»å·¥ä½œæµå¹¶é€šè¿‡æ ·ä¾‹æŸ¥è¯¢éªŒè¯è·¯ç”±é€»è¾‘  \n     - æŒ‰éœ€è°ƒæ•´é€‰æ‹©è§„åˆ™ä»¥æå‡å‡†ç¡®æ€§  \n\n* * *\n\n### **éœ€è¦å®šåˆ¶åŒ–æ”¯æŒï¼Ÿ**\n\næ¬¢è¿é€šè¿‡[é‚®ä»¶](mailto:info@n3w.it)å’¨è¯¢ï¼Œæˆ–é€šè¿‡[é¢†è‹±](https://www.linkedin.com/in/davideboizza/)è”ç³»ã€‚",
  "title_zh": "ç”¨äºOpenRouteræŸ¥è¯¢ä¼˜åŒ–çš„åŠ¨æ€AIæ¨¡å‹è·¯ç”±å™¨",
  "publish_date_zh": "æœ€åæ›´æ–°äº6å¤©å‰"
}