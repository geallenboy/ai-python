{
  "url": "https://n8n.io/workflows/2586-weekly-dinner-meal-plan-using-recipes-from-mealie/",
  "title": "Weekly dinner meal plan using recipes from Mealie",
  "author": "Damian Karzon",
  "publish_date": "Last update 6 months ago",
  "publish_date_absolute": "2024-11-26",
  "categories": [
    {
      "name": "Other"
    }
  ],
  "workflow_json": "{\"nodes\":[{\"id\":\"396bb28b-e40d-4bea-aa80-4abd04db045a\",\"name\":\"Friday 8pm\",\"type\":\"n8n-nodes-base.scheduleTrigger\",\"position\":[100,120],\"parameters\":{\"rule\":{\"interval\":[{\"field\":\"weeks\",\"triggerAtDay\":[5],\"triggerAtHour\":20}]}},\"typeVersion\":1.1},{\"id\":\"993f0d31-5639-4cea-b2f8-d1a41ecdeb83\",\"name\":\"Create Meal Plan\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[1080,120],\"parameters\":{\"url\":\"={{ $('Config').first().json.mealieBaseUrl }}/api/households/mealplans\",\"method\":\"POST\",\"options\":{\"response\":{\"response\":{\"responseFormat\":\"json\"}}},\"jsonBody\":\"={{ $json }}\",\"sendBody\":true,\"specifyBody\":\"json\",\"authentication\":\"genericCredentialType\",\"genericAuthType\":\"httpHeaderAuth\"},\"credentials\":{\"httpHeaderAuth\":{\"id\":\"oVwF1hVdy3Srvi9P\",\"name\":\"Mealie Header Auth\"}},\"typeVersion\":4.1},{\"id\":\"ad53512d-7246-49f4-a86b-f258b7c1c47e\",\"name\":\"When clicking \\\"Test workflow\\\"\",\"type\":\"n8n-nodes-base.manualTrigger\",\"position\":[100,320],\"parameters\":{},\"typeVersion\":1},{\"id\":\"c0d1d7e0-9411-4e6a-871a-0374b8a9f5db\",\"name\":\"Get Recipes\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[640,120],\"parameters\":{\"url\":\"={{ $json.mealieBaseUrl }}/api/recipes\",\"options\":{},\"sendQuery\":true,\"authentication\":\"genericCredentialType\",\"genericAuthType\":\"httpHeaderAuth\",\"queryParameters\":{\"parameters\":[{\"name\":\"perPage\",\"value\":\"100\"},{\"name\":\"categories\",\"value\":\"={{ $json.mealieCategoryId }}\"}]}},\"credentials\":{\"httpHeaderAuth\":{\"id\":\"oVwF1hVdy3Srvi9P\",\"name\":\"Mealie Header Auth\"}},\"typeVersion\":4.1},{\"id\":\"2f9757fc-77f5-4bda-ae2e-7088ea5c114d\",\"name\":\"Config\",\"type\":\"n8n-nodes-base.set\",\"position\":[380,120],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"cd2665dd-b505-41e4-936d-cfa2de7bd09b\",\"name\":\"numberOfRecipes\",\"type\":\"number\",\"value\":5},{\"id\":\"e09da5c5-3f0d-4cd3-909d-e3df2888abde\",\"name\":\"offsetPlanDays\",\"type\":\"number\",\"value\":3},{\"id\":\"80e95139-83df-45ae-99a0-fc50d3e9475f\",\"name\":\"mealieCategoryId\",\"type\":\"string\",\"value\":\"6ec172b7-a87d-4877-8fe3-34cecc20f2c5\"},{\"id\":\"f511e874-c373-4648-9e49-120367474d6d\",\"name\":\"mealieBaseUrl\",\"type\":\"string\",\"value\":\"http://192.168.1.5:9925\"}]}},\"typeVersion\":3.4},{\"id\":\"fed805ea-0580-444d-8312-a68b25e91bbd\",\"name\":\"Generate Random Items\",\"type\":\"n8n-nodes-base.code\",\"position\":[860,120],\"parameters\":{\"jsCode\":\"const numberOfRecipes = $('Config').first().json.numberOfRecipes;\\nconst offsetPlanDays = $('Config').first().json.offsetPlanDays;\\nconst items = $input.first().json.items;\\n\\nlet planFirstDate = new Date();\\nplanFirstDate.setDate(planFirstDate.getDate() + offsetPlanDays);\\n\\nconst recipeList = [];\\nconst randomNums = [];\\nlet currentItem = 0;\\n\\nwhile (recipeList.length < numberOfRecipes) {\\n  const randomNum = Math.floor(Math.random() * Math.floor(items.length));\\n\\n  if (!randomNums.includes(randomNum)) {\\n    const thisRecipe = items[randomNum];\\n\\n    const newDate = new Date(planFirstDate);\\n    newDate.setDate(planFirstDate.getDate() + currentItem);\\n  \\n    const planDate = [\\n      newDate.getFullYear(),\\n      ('0' + (newDate.getMonth() + 1)).slice(-2),\\n      ('0' + newDate.getDate()).slice(-2)\\n    ].join('-');\\n  \\n    const planDay = {\\n      \\\"date\\\": planDate,\\n      \\\"entryType\\\": \\\"dinner\\\",\\n      \\\"recipeId\\\": thisRecipe.id,\\n      \\\"name\\\": thisRecipe.name\\n    };\\n\\n    currentItem++;\\n    recipeList.push(planDay);\\n    randomNums.push(randomNum);\\n  }\\n}\\n\\nreturn recipeList;\"},\"typeVersion\":2},{\"id\":\"f440ce9d-cc27-4982-a0bd-b0ce2e5217d9\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[40,-60],\"parameters\":{\"color\":4,\"height\":340,\"content\":\"## Trigger\\nSet the trigger to run when you like\"},\"typeVersion\":1},{\"id\":\"2bac2f08-2969-4f47-9fce-0e7de416cd09\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[280,-60],\"parameters\":{\"color\":5,\"width\":300,\"height\":340,\"content\":\"## Update this Config\\nSet the base Url of your Mealie instance\\nSet number of recipes to generate and number of days to offset the plan (0 will start today).\\nGrab a category id from Mealie (or leave blank for all categories)\"},\"typeVersion\":1},{\"id\":\"a2850e39-c25f-4210-8f9e-a657c0c63bf5\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[40,-280],\"parameters\":{\"width\":540,\"height\":220,\"content\":\"## Get started\\n* Set up a credential for your Mealie API token\\n* Apply the credential to the 2 Http request nodes\\n* Set schedule trigger and desired config\"},\"typeVersion\":1},{\"id\":\"20d7301c-8946-45c3-8f5f-fbe2fc80cf37\",\"name\":\"Sticky Note3\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[580,-60],\"parameters\":{\"color\":7,\"width\":660,\"height\":340,\"content\":\"## Workflow logic\\n* Get all recipes from Mealie (within category if supplied)\\n* Randomly pick out the number set in the config\\n* Create dinner meal plans for the upcoming days\"},\"typeVersion\":1}],\"pinData\":{},\"connections\":{\"Config\":{\"main\":[[{\"node\":\"Get Recipes\",\"type\":\"main\",\"index\":0}]]},\"Friday 8pm\":{\"main\":[[{\"node\":\"Config\",\"type\":\"main\",\"index\":0}]]},\"Get Recipes\":{\"main\":[[{\"node\":\"Generate Random Items\",\"type\":\"main\",\"index\":0}]]},\"Generate Random Items\":{\"main\":[[{\"node\":\"Create Meal Plan\",\"type\":\"main\",\"index\":0}]]},\"When clicking \\\"Test workflow\\\"\":{\"main\":[[{\"node\":\"Config\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "This workflow randomly select recipes from a Mealie instance (can use a specific category) and then creates a meal plan in Mealie with those recipes.\n\n## How it works:\n\n  * Workflow has a scheduled trigger (set to run weekly on a Friday)\n  * `Config` node sets a few properties to configure the workflow\n  * A call to the Mealie API to get the list of recipes\n  * The code node holds most of the logic, this will loop through the number of recipes defined in the config node and randomly select a recipe from the list (making sure not to double up any recipes)\n  * Once all the recipes are selected it will call the Mealie API to set up the meal plan on the days\n\n\n\n## Setup\n\n  * Add your Mealie API token as a credential and set it on the Http Request nodes\n  * Set the relevant schedule trigger to run when you like\n  * Update the `Config` node with the config you want \n    * numberOfRecipes - Number of recipes to populate for the meal plan\n    * offsetPlanDays - Number of days in the future to start the plan (0 will start it today, 1 tomorrow, etc.)\n    * mealieCategoryId - A category id of the category you want to pull in recipes from (default to select from all recipes)\n    * mealieBaseUrl - The base url of your Mealie instance\n\n\n",
  "crawled_at": "2025-05-26T00:24:41.120394",
  "readme_zh": "该工作流程会从Mealie实例中随机选取食谱（可指定特定类别），随后在Mealie中用这些食谱创建膳食计划。\n\n## 运行原理：\n\n  * 工作流程设有定时触发器（设置为每周五运行）\n  * `配置`节点设置若干属性以配置工作流程\n  * 调用Mealie API获取食谱列表\n  * 代码节点包含主要逻辑，将根据配置节点定义的食谱数量循环遍历，并从列表中随机选取食谱（确保不重复选择）\n  * 选取所有食谱后，将调用Mealie API在指定日期设置膳食计划\n\n## 设置步骤：\n\n  * 将您的Mealie API令牌添加为凭证，并在HTTP请求节点上进行设置\n  * 根据需要设置定时触发器的运行时间\n  * 更新`配置`节点中的参数：\n    * numberOfRecipes - 膳食计划包含的食谱数量\n    * offsetPlanDays - 计划开始日期的未来偏移天数（0表示今天开始，1表示明天，以此类推）\n    * mealieCategoryId - 指定食谱来源的类别ID（默认为从所有食谱中选取）\n    * mealieBaseUrl - 您的Mealie实例基础网址",
  "title_zh": "使用Mealie食谱的每周晚餐计划",
  "publish_date_zh": "最后更新于5个月前",
  "workflow_json_zh": "{\n  \"nodes\": [\n    {\n      \"id\": \"396bb28b-e40d-4bea-aa80-4abd04db045a\",\n      \"name\": \"Friday 8pm\",\n      \"type\": \"n8n-nodes-base.scheduleTrigger\",\n      \"position\": [\n        100,\n        120\n      ],\n      \"parameters\": {\n        \"rule\": {\n          \"interval\": [\n            {\n              \"field\": \"weeks\",\n              \"triggerAtDay\": [\n                5\n              ],\n              \"triggerAtHour\": 20\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"993f0d31-5639-4cea-b2f8-d1a41ecdeb83\",\n      \"name\": \"Create Meal Plan\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1080,\n        120\n      ],\n      \"parameters\": {\n        \"url\": \"={{ $('Config').first().json.mealieBaseUrl }}/api/households/mealplans\",\n        \"method\": \"POST\",\n        \"options\": {\n          \"response\": {\n            \"response\": {\n              \"responseFormat\": \"json\"\n            }\n          }\n        },\n        \"jsonBody\": \"={{ $json }}\",\n        \"sendBody\": true,\n        \"specifyBody\": \"json\",\n        \"authentication\": \"genericCredentialType\",\n        \"genericAuthType\": \"httpHeaderAuth\"\n      },\n      \"credentials\": {\n        \"httpHeaderAuth\": {\n          \"id\": \"oVwF1hVdy3Srvi9P\",\n          \"name\": \"Mealie Header Auth\"\n        }\n      },\n      \"typeVersion\": 4.1\n    },\n    {\n      \"id\": \"ad53512d-7246-49f4-a86b-f258b7c1c47e\",\n      \"name\": \"When clicking \\\"Test workflow\\\"\",\n      \"type\": \"n8n-nodes-base.manualTrigger\",\n      \"position\": [\n        100,\n        320\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"c0d1d7e0-9411-4e6a-871a-0374b8a9f5db\",\n      \"name\": \"Get Recipes\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        640,\n        120\n      ],\n      \"parameters\": {\n        \"url\": \"={{ $json.mealieBaseUrl }}/api/recipes\",\n        \"options\": {},\n        \"sendQuery\": true,\n        \"authentication\": \"genericCredentialType\",\n        \"genericAuthType\": \"httpHeaderAuth\",\n        \"queryParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"perPage\",\n              \"value\": \"100\"\n            },\n            {\n              \"name\": \"categories\",\n              \"value\": \"={{ $json.mealieCategoryId }}\"\n            }\n          ]\n        }\n      },\n      \"credentials\": {\n        \"httpHeaderAuth\": {\n          \"id\": \"oVwF1hVdy3Srvi9P\",\n          \"name\": \"Mealie Header Auth\"\n        }\n      },\n      \"typeVersion\": 4.1\n    },\n    {\n      \"id\": \"2f9757fc-77f5-4bda-ae2e-7088ea5c114d\",\n      \"name\": \"Config\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        380,\n        120\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"cd2665dd-b505-41e4-936d-cfa2de7bd09b\",\n              \"name\": \"numberOfRecipes\",\n              \"type\": \"number\",\n              \"value\": 5\n            },\n            {\n              \"id\": \"e09da5c5-3f0d-4cd3-909d-e3df2888abde\",\n              \"name\": \"offsetPlanDays\",\n              \"type\": \"number\",\n              \"value\": 3\n            },\n            {\n              \"id\": \"80e95139-83df-45ae-99a0-fc50d3e9475f\",\n              \"name\": \"mealieCategoryId\",\n              \"type\": \"string\",\n              \"value\": \"6ec172b7-a87d-4877-8fe3-34cecc20f2c5\"\n            },\n            {\n              \"id\": \"f511e874-c373-4648-9e49-120367474d6d\",\n              \"name\": \"mealieBaseUrl\",\n              \"type\": \"string\",\n              \"value\": \"http://192.168.1.5:9925\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"fed805ea-0580-444d-8312-a68b25e91bbd\",\n      \"name\": \"Generate Random Items\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        860,\n        120\n      ],\n      \"parameters\": {\n        \"jsCode\": \"const numberOfRecipes = $('Config').first().json.numberOfRecipes;\\nconst offsetPlanDays = $('Config').first().json.offsetPlanDays;\\nconst items = $input.first().json.items;\\n\\nlet planFirstDate = new Date();\\nplanFirstDate.setDate(planFirstDate.getDate() + offsetPlanDays);\\n\\nconst recipeList = [];\\nconst randomNums = [];\\nlet currentItem = 0;\\n\\nwhile (recipeList.length < numberOfRecipes) {\\n  const randomNum = Math.floor(Math.random() * Math.floor(items.length));\\n\\n  if (!randomNums.includes(randomNum)) {\\n    const thisRecipe = items[randomNum];\\n\\n    const newDate = new Date(planFirstDate);\\n    newDate.setDate(planFirstDate.getDate() + currentItem);\\n  \\n    const planDate = [\\n      newDate.getFullYear(),\\n      ('0' + (newDate.getMonth() + 1)).slice(-2),\\n      ('0' + newDate.getDate()).slice(-2)\\n    ].join('-');\\n  \\n    const planDay = {\\n      \\\"date\\\": planDate,\\n      \\\"entryType\\\": \\\"dinner\\\",\\n      \\\"recipeId\\\": thisRecipe.id,\\n      \\\"name\\\": thisRecipe.name\\n    };\\n\\n    currentItem++;\\n    recipeList.push(planDay);\\n    randomNums.push(randomNum);\\n  }\\n}\\n\\nreturn recipeList;\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"f440ce9d-cc27-4982-a0bd-b0ce2e5217d9\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        40,\n        -60\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"height\": 340,\n        \"content\": \"## 触发器\\n设置触发器在您点赞时运行\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"2bac2f08-2969-4f47-9fce-0e7de416cd09\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        280,\n        -60\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 300,\n        \"height\": 340,\n        \"content\": \"## 更新此配置\\n设置您的Mealie实例的基础URL\\n设定生成的食谱数量及计划起始日期的偏移天数（设为0则从今天开始）\\n从Mealie获取分类ID（或留空以包含全部分类）\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"a2850e39-c25f-4210-8f9e-a657c0c63bf5\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        40,\n        -280\n      ],\n      \"parameters\": {\n        \"width\": 540,\n        \"height\": 220,\n        \"content\": \"## 开始使用\\n* 为您的Mealie API令牌设置凭证\\n* 将凭证应用到2个Http请求节点\\n* 设置计划触发器和所需配置\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"20d7301c-8946-45c3-8f5f-fbe2fc80cf37\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        580,\n        -60\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 660,\n        \"height\": 340,\n        \"content\": \"## 工作流程逻辑\\n* 从Mealie获取所有食谱（若指定分类则获取该分类下的食谱）\\n* 根据配置数量随机选取食谱\\n* 为未来几天创建晚餐膳食计划\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"pinData\": {},\n  \"connections\": {\n    \"Config\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get Recipes\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Friday 8pm\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Config\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get Recipes\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Generate Random Items\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Generate Random Items\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Create Meal Plan\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"When clicking \\\"Test workflow\\\"\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Config\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}