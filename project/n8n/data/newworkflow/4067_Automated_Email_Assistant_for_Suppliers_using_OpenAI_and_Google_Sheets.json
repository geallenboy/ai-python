{
  "url": "https://n8n.io/workflows/4067-automated-email-assistant-for-suppliers-using-openai-and-google-sheets/",
  "title": "Automated Email Assistant for Suppliers using OpenAI and Google Sheets",
  "author": "Omar Hdez",
  "publish_date": "Last update 5 days ago",
  "publish_date_absolute": "2025-05-21",
  "categories": [
    {
      "name": "Support"
    },
    {
      "name": "AI"
    }
  ],
  "workflow_json": "{\"id\":\"chCFNRonfZBJVoUK\",\"meta\":{\"instanceId\":\"a51a10c949270e540a12639c8a3df5e1b80aa3342c96f49f7646a09c92df9d8c\",\"templateCredsSetupCompleted\":true},\"name\":\"Personal Assistant\",\"tags\":[],\"nodes\":[{\"id\":\"f1ecb3d0-eca9-4055-966f-9afbd2ccffca\",\"name\":\"MCP Server Trigger\",\"type\":\"@n8n/n8n-nodes-langchain.mcpTrigger\",\"position\":[-20,-640],\"webhookId\":\"cbbbcf9a-2105-4289-9874-45d3ca20dd2e\",\"parameters\":{\"path\":\"cbbbcf9a-2105-4289-9874-45d3ca20dd2e\"},\"typeVersion\":1},{\"id\":\"056176ce-7aed-44e1-8c95-6545d8742d63\",\"name\":\"Send message by Gmail\",\"type\":\"n8n-nodes-base.gmailTool\",\"position\":[300,-460],\"webhookId\":\"101ef28f-8092-4013-8f87-c5b81e9dbfa5\",\"parameters\":{\"sendTo\":\"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('To', ``, 'string') }}\",\"message\":\"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Message', ``, 'string') }}\",\"options\":{},\"subject\":\"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Subject', ``, 'string') }}\",\"emailType\":\"text\"},\"credentials\":{\"gmailOAuth2\":{\"id\":\"N9jC76TL1WVjVRW4\",\"name\":\"Gmail account\"}},\"typeVersion\":2.1},{\"id\":\"579d3a6f-8f64-4d1f-8837-ed566ffe56cc\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-620,-720],\"parameters\":{\"color\":4,\"width\":1140,\"height\":480,\"content\":\"## To implement this personal email assistant for suppliers,\\n## you need to follow these steps.\\n\\n### In Google Drive, create a Google Sheets file named \\\"Suppliers\\\",\\nwhich should contain 2 columns:\\n(Supplier Name, Contact Email)\\nThis is the MCP Server.\\n\\n\"},\"typeVersion\":1},{\"id\":\"0e3e99ef-434c-4c65-b282-6f2d267ad9f9\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-620,-200],\"parameters\":{\"color\":5,\"width\":1140,\"height\":660,\"content\":\"## This would be the AI Agent that connects to the MCP Server — in other words, it is the MCP Client.\\n\\n### 1. The message arrives and is passed to the AI agent.\\n### 2. The assistant first executes the node that helps it think — the \\\"Thinker\\\".\\n### 3. Then it runs the Google Sheets node to search for the supplier,\\n### in case the user only mentions the name and doesn't provide the email.\\n### 4. It executes the MCP Server and sends the email as requested.\\n\"},\"typeVersion\":1},{\"id\":\"fda2fd56-fb9b-4074-9a4f-ae14e94d95de\",\"name\":\"Entry Point: Chat with the Agent\",\"type\":\"@n8n/n8n-nodes-langchain.chatTrigger\",\"position\":[-300,40],\"webhookId\":\"0a1b3beb-fe6e-4a05-9150-944517f0a65b\",\"parameters\":{\"options\":{}},\"typeVersion\":1.1},{\"id\":\"de8be0e7-2eea-43d5-9f8c-a6232986c524\",\"name\":\"Personal Email Assistant\",\"type\":\"@n8n/n8n-nodes-langchain.agent\",\"position\":[60,40],\"parameters\":{\"options\":{\"systemMessage\":\"=Eres mi asistente personal. Tienes acceso a diferentes herramientas (como Think y Google Sheets). Sigue estas instrucciones paso a paso para responder correctamente:\\n\\n1. Ejecuta la herramienta **Think** para analizar si tienes toda la información necesaria para completar la solicitud del usuario.\\n2. La fecha y hora actual es: {{ $now.setZone('America/Mexico_City').toFormat('yyyy-MM-dd HH:mm') }}.\\n3. Si para cumplir la solicitud del usuario necesitas el **correo de un proveedor**, búscalo usando la herramienta **Google Sheets** con el nombre del proveedor como referencia.\\n4. Una vez tengas toda la información, **realiza la acción solicitada por el usuario** y responde de forma clara y directa.\\n5. Si falta información o no puedes encontrarla, pide al usuario que complete lo que falta o reporta que no la encontraste.\\n\"}},\"typeVersion\":1.9},{\"id\":\"05ab000e-3d2c-4429-a75e-7b4db94baa03\",\"name\":\"AI Model Open AI\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\"position\":[-160,260],\"parameters\":{\"model\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"gpt-4o-mini\"},\"options\":{}},\"credentials\":{\"openAiApi\":{\"id\":\"QDynOcTL9yRJIEpN\",\"name\":\"OpenAi account\"}},\"typeVersion\":1.2},{\"id\":\"cd649882-bd30-4589-ac73-e23da4f4d16e\",\"name\":\"Chat Memory\",\"type\":\"@n8n/n8n-nodes-langchain.memoryBufferWindow\",\"position\":[-20,240],\"parameters\":{\"contextWindowLength\":20},\"typeVersion\":1.3},{\"id\":\"804571d9-95b1-427e-90ad-a6562c246310\",\"name\":\"Node that connects to the MCP server.\",\"type\":\"@n8n/n8n-nodes-langchain.mcpClientTool\",\"position\":[120,260],\"parameters\":{\"sseEndpoint\":\"https://lucychats-n8n.jpe85q.easypanel.host/mcp/cbbbcf9a-2105-4289-9874-45d3ca20dd2e/sse\"},\"typeVersion\":1},{\"id\":\"df1ba763-2ab5-4cc9-adf0-47f39bf6e0ec\",\"name\":\"Thinker, think before executing.\",\"type\":\"@n8n/n8n-nodes-langchain.toolThink\",\"position\":[260,220],\"parameters\":{},\"typeVersion\":1},{\"id\":\"e2721ce5-6283-4c20-945f-e0e88b25514f\",\"name\":\"Supplier database.\",\"type\":\"n8n-nodes-base.googleSheetsTool\",\"position\":[400,260],\"parameters\":{\"options\":{},\"filtersUI\":{\"values\":[{\"lookupValue\":\"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('values0_Value', ``, 'string') }}\",\"lookupColumn\":\"Nombre del Proveedor\"}]},\"sheetName\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"gid=0\",\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1vFkApkyOU1npZJvl90sIZ4x8xnSXylfTjvCGhWTeOB8/edit#gid=0\",\"cachedResultName\":\"Hoja 1\"},\"documentId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"1vFkApkyOU1npZJvl90sIZ4x8xnSXylfTjvCGhWTeOB8\",\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1vFkApkyOU1npZJvl90sIZ4x8xnSXylfTjvCGhWTeOB8/edit?usp=drivesdk\",\"cachedResultName\":\"Proveedores\"}},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"kbToWpEBxTdKlK78\",\"name\":\"Google Sheets account\"}},\"typeVersion\":4.5}],\"active\":true,\"pinData\":{},\"settings\":{\"executionOrder\":\"v1\"},\"versionId\":\"517b84f6-a704-4934-87a9-d550677b7bee\",\"connections\":{\"Gmail\":{\"ai_tool\":[[{\"node\":\"MCP Server Trigger\",\"type\":\"ai_tool\",\"index\":0}]]},\"Chat Memory\":{\"ai_memory\":[[{\"node\":\"Personal Email Assistant\",\"type\":\"ai_memory\",\"index\":0}]]},\"AI Model Open AI\":{\"ai_languageModel\":[[{\"node\":\"Personal Email Assistant\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"Supplier database.\":{\"ai_tool\":[[{\"node\":\"Personal Email Assistant\",\"type\":\"ai_tool\",\"index\":0}]]},\"Personal Email Assistant\":{\"main\":[[]]},\"Entry Point: Chat with the Agent\":{\"main\":[[{\"node\":\"Personal Email Assistant\",\"type\":\"main\",\"index\":0}]]},\"Thinker, think before executing.\":{\"ai_tool\":[[{\"node\":\"Personal Email Assistant\",\"type\":\"ai_tool\",\"index\":0}]]},\"Node that connects to the MCP server.\":{\"ai_tool\":[[{\"node\":\"Personal Email Assistant\",\"type\":\"ai_tool\",\"index\":0}]]}}}",
  "readme": "## Automated Email Assistant for Busy Professionals\n\nThis assistant is designed for people who don't have time to write and send emails to suppliers. With just one request, it drafts and sends clear, professional messages automatically.\n\n## How It Works\n\nThe user makes a request (e.g., “Send an email to my fruit supplier asking for a quote on 1 crate of mangoes.”).\n\n## Workflow:\n\n  1. The AI agent searches for the supplier in a Google Sheets database.\n\n  2. It automatically drafts the email using OpenAI (with the tone and style you define).\n\n  3. It sends the email using your Gmail account connected through n8n.\n\n\n\n\n## This assistant uses:\n\n  * Google Sheets to manage your suppliers (name and email).\n\n  * OpenAI to generate clear, natural messages.\n\n  * MCP (client-server logic) to handle request processing.\n\n  * Gmail as the sending channel for automated emails.\n\n\n\n\n## Setup Instructions\n\n  1. Create a Google Sheets document with the supplier name and email, like this:\n\nSupplier name | Email  \n---|---  \nProveedor de frutas Alvarez | [fruteriaalvarez@alvarez.com](mailto:fruteriaalvarez@alvarez.com)  \n  \n  1. Connect your Google Sheets and Gmail accounts within n8n.\n\n  2. Add your OpenAI API key.\n\n\n\n\nTest the automation by chatting with the integrated assistant.  \nIt will generate and send the email automatically to the indicated supplier.\n\n## Requirements\n\n  * OpenAI API key to generate email content.\n  * Gmail account connected via OAuth2.\n  * Google Sheets document with your supplier database.\n  * n8n instance (cloud or self-hosted).\n\n\n\n## Customization\n\nAdjust the OpenAI prompt to make the email tone more formal, casual, or technical.\n\nAdd custom fields to your supplier sheet (location, notes, special conditions).\n\nReplace Google Sheets with a real database like Supabase or PostgreSQL for greater scalability.\n",
  "crawled_at": "2025-05-26T06:26:28.149063",
  "readme_zh": "## 商务邮件自动助理（专为繁忙人士设计）\n\n本助手专为无暇撰写供应商邮件人士打造。只需一句指令，即可自动生成并发送专业商务邮件。\n\n## 运行原理\n\n用户提出需求（例如：\"给水果供应商发邮件询问一箱芒果的报价\"）\n\n## 工作流程：\n\n1. AI代理通过Google Sheets数据库检索供应商信息\n2. 调用OpenAI自动撰写邮件（支持自定义语气与风格）\n3. 通过n8n连接的Gmail账户自动发送邮件\n\n## 核心技术组件：\n\n* Google Sheets - 供应商信息管理（名称/邮箱）\n* OpenAI - 生成自然流畅的邮件内容\n* MCP架构 - 处理客户端-服务端逻辑\n* Gmail - 自动化邮件发送通道\n\n## 配置指南\n\n1. 创建Google Sheets文档（供应商名称与邮箱格式示例）：\n\n| 供应商名称            | 邮箱地址                     |\n|-----------------------|-----------------------------|\n| 阿尔瓦雷斯水果供应商  | fruteriaalvarez@alvarez.com |\n\n2. 在n8n中关联Google Sheets与Gmail账户\n3. 添加OpenAI API密钥\n\n完成配置后，直接与集成助手对话即可测试：系统将自动生成邮件并发送至指定供应商。\n\n## 系统要求\n\n* OpenAI API密钥（用于内容生成）\n* 通过OAuth2验证的Gmail账户\n* 包含供应商数据库的Google Sheets文档\n* n8n实例（云端或自托管皆可）\n\n## 定制化选项\n\n* 修改OpenAI提示词调整邮件风格（正式/随意/技术型）\n* 在供应商表格添加自定义字段（地理位置/备注/特殊条款）\n* 如需扩展性，可将Google Sheets替换为Supabase/PostgreSQL等专业数据库",
  "title_zh": "供应商自动化邮件助手（基于OpenAI与Google Sheets）",
  "publish_date_zh": "上次更新于5天前",
  "workflow_json_zh": "{\"id\":\"chCFNRonfZBJVoUK\",\"meta\":{\"instanceId\":\"a51a10c949270e540a12639c8a3df5e1b80aa3342c96f49f7646a09c92df9d8c\",\"templateCredsSetupCompleted\":true},\"name\":\"Personal Assistant\",\"tags\":[],\"nodes\":[{\"id\":\"f1ecb3d0-eca9-4055-966f-9afbd2ccffca\",\"name\":\"MCP Server Trigger\",\"type\":\"@n8n/n8n-nodes-langchain.mcpTrigger\",\"position\":[-20,-640],\"webhookId\":\"cbbbcf9a-2105-4289-9874-45d3ca20dd2e\",\"parameters\":{\"path\":\"cbbbcf9a-2105-4289-9874-45d3ca20dd2e\"},\"typeVersion\":1},{\"id\":\"056176ce-7aed-44e1-8c95-6545d8742d63\",\"name\":\"Send message by Gmail\",\"type\":\"n8n-nodes-base.gmailTool\",\"position\":[300,-460],\"webhookId\":\"101ef28f-8092-4013-8f87-c5b81e9dbfa5\",\"parameters\":{\"sendTo\":\"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('To', ``, 'string') }}\",\"message\":\"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Message', ``, 'string') }}\",\"options\":{},\"subject\":\"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Subject', ``, 'string') }}\",\"emailType\":\"text\"},\"credentials\":{\"gmailOAuth2\":{\"id\":\"N9jC76TL1WVjVRW4\",\"name\":\"Gmail account\"}},\"typeVersion\":2.1},{\"id\":\"579d3a6f-8f64-4d1f-8837-ed566ffe56cc\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-620,-720],\"parameters\":{\"color\":4,\"width\":1140,\"height\":480,\"content\":\"## 要实现这个面向供应商的个人邮件助手，\\n## 请按照以下步骤操作。\\n\\n### 在Google云端硬盘中创建一个名为\\\"供应商\\\"的Google表格文件，\\n该文件应包含2列：\\n（供应商名称，联系邮箱）\\n这就是MCP服务器。\"},\"typeVersion\":1},{\"id\":\"0e3e99ef-434c-4c65-b282-6f2d267ad9f9\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-620,-200],\"parameters\":{\"color\":5,\"width\":1140,\"height\":660,\"content\":\"## 该AI代理将作为连接MCP服务器的客户端——换言之，即MCP客户端。\\n\\n### 1. 消息抵达后传递给AI代理\\n### 2. 助手首先运行辅助思考的节点——\\\"思考者\\\"\\n### 3. 接着执行Google表格节点搜索供应商信息\\n### （适用于用户仅提及名称但未提供邮箱的情况）\\n### 4. 最终调用MCP服务器发送指定邮件\"},\"typeVersion\":1},{\"id\":\"fda2fd56-fb9b-4074-9a4f-ae14e94d95de\",\"name\":\"Entry Point: Chat with the Agent\",\"type\":\"@n8n/n8n-nodes-langchain.chatTrigger\",\"position\":[-300,40],\"webhookId\":\"0a1b3beb-fe6e-4a05-9150-944517f0a65b\",\"parameters\":{\"options\":{}},\"typeVersion\":1.1},{\"id\":\"de8be0e7-2eea-43d5-9f8c-a6232986c524\",\"name\":\"Personal Email Assistant\",\"type\":\"@n8n/n8n-nodes-langchain.agent\",\"position\":[60,40],\"parameters\":{\"options\":{\"systemMessage\":\"=Eres mi asistente personal. Tienes acceso a diferentes herramientas (como Think y Google Sheets). Sigue estas instrucciones paso a paso para responder correctamente:\\n\\n1. Ejecuta la herramienta **Think** para analizar si tienes toda la información necesaria para completar la solicitud del usuario.\\n2. La fecha y hora actual es: {{ $now.setZone('America/Mexico_City').toFormat('yyyy-MM-dd HH:mm') }}.\\n3. Si para cumplir la solicitud del usuario necesitas el **correo de un proveedor**, búscalo usando la herramienta **Google Sheets** con el nombre del proveedor como referencia.\\n4. Una vez tengas toda la información, **realiza la acción solicitada por el usuario** y responde de forma clara y directa.\\n5. Si falta información o no puedes encontrarla, pide al usuario que complete lo que falta o reporta que no la encontraste.\\n\"}},\"typeVersion\":1.9},{\"id\":\"05ab000e-3d2c-4429-a75e-7b4db94baa03\",\"name\":\"AI Model Open AI\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\"position\":[-160,260],\"parameters\":{\"model\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"gpt-4o-mini\"},\"options\":{}},\"credentials\":{\"openAiApi\":{\"id\":\"QDynOcTL9yRJIEpN\",\"name\":\"OpenAi account\"}},\"typeVersion\":1.2},{\"id\":\"cd649882-bd30-4589-ac73-e23da4f4d16e\",\"name\":\"Chat Memory\",\"type\":\"@n8n/n8n-nodes-langchain.memoryBufferWindow\",\"position\":[-20,240],\"parameters\":{\"contextWindowLength\":20},\"typeVersion\":1.3},{\"id\":\"804571d9-95b1-427e-90ad-a6562c246310\",\"name\":\"Node that connects to the MCP server.\",\"type\":\"@n8n/n8n-nodes-langchain.mcpClientTool\",\"position\":[120,260],\"parameters\":{\"sseEndpoint\":\"https://lucychats-n8n.jpe85q.easypanel.host/mcp/cbbbcf9a-2105-4289-9874-45d3ca20dd2e/sse\"},\"typeVersion\":1},{\"id\":\"df1ba763-2ab5-4cc9-adf0-47f39bf6e0ec\",\"name\":\"Thinker, think before executing.\",\"type\":\"@n8n/n8n-nodes-langchain.toolThink\",\"position\":[260,220],\"parameters\":{},\"typeVersion\":1},{\"id\":\"e2721ce5-6283-4c20-945f-e0e88b25514f\",\"name\":\"Supplier database.\",\"type\":\"n8n-nodes-base.googleSheetsTool\",\"position\":[400,260],\"parameters\":{\"options\":{},\"filtersUI\":{\"values\":[{\"lookupValue\":\"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('values0_Value', ``, 'string') }}\",\"lookupColumn\":\"Nombre del Proveedor\"}]},\"sheetName\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"gid=0\",\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1vFkApkyOU1npZJvl90sIZ4x8xnSXylfTjvCGhWTeOB8/edit#gid=0\",\"cachedResultName\":\"Hoja 1\"},\"documentId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"1vFkApkyOU1npZJvl90sIZ4x8xnSXylfTjvCGhWTeOB8\",\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1vFkApkyOU1npZJvl90sIZ4x8xnSXylfTjvCGhWTeOB8/edit?usp=drivesdk\",\"cachedResultName\":\"Proveedores\"}},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"kbToWpEBxTdKlK78\",\"name\":\"Google Sheets account\"}},\"typeVersion\":4.5}],\"active\":true,\"pinData\":{},\"settings\":{\"executionOrder\":\"v1\"},\"versionId\":\"517b84f6-a704-4934-87a9-d550677b7bee\",\"connections\":{\"Gmail\":{\"ai_tool\":[[{\"node\":\"MCP Server Trigger\",\"type\":\"ai_tool\",\"index\":0}]]},\"Chat Memory\":{\"ai_memory\":[[{\"node\":\"Personal Email Assistant\",\"type\":\"ai_memory\",\"index\":0}]]},\"AI Model Open AI\":{\"ai_languageModel\":[[{\"node\":\"Personal Email Assistant\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"Supplier database.\":{\"ai_tool\":[[{\"node\":\"Personal Email Assistant\",\"type\":\"ai_tool\",\"index\":0}]]},\"Personal Email Assistant\":{\"main\":[[]]},\"Entry Point: Chat with the Agent\":{\"main\":[[{\"node\":\"Personal Email Assistant\",\"type\":\"main\",\"index\":0}]]},\"Thinker, think before executing.\":{\"ai_tool\":[[{\"node\":\"Personal Email Assistant\",\"type\":\"ai_tool\",\"index\":0}]]},\"Node that connects to the MCP server.\":{\"ai_tool\":[[{\"node\":\"Personal Email Assistant\",\"type\":\"ai_tool\",\"index\":0}]]}}}"
}