{
  "url": "https://n8n.io/workflows/4213-automatic-media-download-from-whatsapp-business-messages-with-http-storage/",
  "title": "Automatic Media Download from WhatsApp Business Messages with HTTP Storage",
  "author": "Usman Liaqat",
  "publish_date": "Last update 6 days ago",
  "publish_date_absolute": "2025-05-20",
  "categories": [
    {
      "name": "Building Blocks"
    },
    {
      "name": "Marketing"
    }
  ],
  "workflow_json": "{\"meta\":{\"instanceId\":\"4e229722e6c43a4914d2d66178b48335adf795d73afbee5b0ea0c52938ef4d8e\",\"templateCredsSetupCompleted\":true},\"nodes\":[{\"id\":\"a24e0949-dcf6-48d4-8b9e-ce201e8b87d8\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-2380,-400],\"parameters\":{\"width\":320,\"height\":240,\"content\":\"This note indicates that the workflow triggers when a new WhatsApp message with media is received.\"},\"typeVersion\":1},{\"id\":\"f513cc8b-89d3-4481-b7fa-ac9d33ba8562\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-1980,-400],\"parameters\":{\"width\":320,\"height\":240,\"content\":\"This note explains that the media ID is used to retrieve a private URL for downloading the media.\"},\"typeVersion\":1},{\"id\":\"3bae6af6-8858-4da4-ab2c-846a2c3e0ffe\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-1600,-400],\"parameters\":{\"width\":320,\"height\":240,\"content\":\"This note highlights that the media file is downloaded using the retrieved private URL.\"},\"typeVersion\":1},{\"id\":\"f694abd7-dacf-41a7-82aa-157bfcf54f83\",\"name\":\"Trigger WhatsApp Media\",\"type\":\"n8n-nodes-base.whatsAppTrigger\",\"position\":[-2280,-320],\"webhookId\":\"864469fd-2008-445c-83fe-852dac2b236a\",\"parameters\":{\"options\":{},\"updates\":[\"messages\"]},\"credentials\":{\"whatsAppTriggerApi\":{\"id\":\"a41n62XWot5Pm1XE\",\"name\":\"WhatsApp OAuth account\"}},\"typeVersion\":1},{\"id\":\"33e74a92-4475-470d-8003-7631ea0b706f\",\"name\":\"Fetch Media Download URL\",\"type\":\"n8n-nodes-base.whatsApp\",\"position\":[-1880,-320],\"webhookId\":\"b052dd6a-55b8-4195-a64e-c0088b7419cc\",\"parameters\":{\"resource\":\"media\",\"operation\":\"mediaUrlGet\",\"mediaGetId\":\"={{ $json.messages[0].image.id }}\"},\"credentials\":{\"whatsAppApi\":{\"id\":\"yVJyvYLlRszyE5sV\",\"name\":\"WhatsApp account\"}},\"typeVersion\":1},{\"id\":\"5e9b09e8-b9d2-4571-a897-d49d32a68c3c\",\"name\":\"Download Media File\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[-1500,-320],\"parameters\":{\"url\":\"={{ $json.url }}\",\"options\":{\"response\":{\"response\":{}}},\"authentication\":\"genericCredentialType\",\"genericAuthType\":\"httpHeaderAuth\"},\"credentials\":{\"httpBearerAuth\":{\"id\":\"Ihwbk0P1mYkOZZlr\",\"name\":\"Whatsapp APi Token\"},\"httpHeaderAuth\":{\"id\":\"Rymur2oAzX9lewU9\",\"name\":\"Whatsapp API Token\"}},\"typeVersion\":4.2}],\"pinData\":{},\"connections\":{\"Trigger WhatsApp Media\":{\"main\":[[{\"node\":\"Fetch Media Download URL\",\"type\":\"main\",\"index\":0}]]},\"Fetch Media Download URL\":{\"main\":[[{\"node\":\"Download Media File\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "This workflow listens for incoming WhatsApp messages that contain media (e.g., images) and automatically downloads the media file using WhatsApp's private media URL.\n\n  * The trigger node activates when a WhatsApp message with media is received.\n  * The media ID is extracted from the message payload.\n  * A private media URL is retrieved using the media ID.\n  * The media file is downloaded using an authenticated HTTP request.\n\n\n\nIdeal for:\n\n  * Archiving WhatsApp media to external systems.\n  * Triggering further automations based on received media.\n  * Integrating with cloud storage like Google Drive, Dropbox, or Amazon S3.\n\n\n\nSet up steps\n\n  * Connect your WhatsApp Business API account.\n  * Add HTTP credentials for downloading media via private URL.\n  * Set up the webhook in your WhatsApp Business account.\n  * Extend the workflow as needed for your use case (e.g., file storage, alerts).\n\n\n",
  "crawled_at": "2025-05-26T07:18:32.091216",
  "readme_zh": "该工作流监听包含媒体文件（如图片）的WhatsApp消息，并利用WhatsApp私有媒体链接自动下载媒体文件。\n\n  * 触发节点在收到带媒体附件的WhatsApp消息时激活\n  * 从消息数据中提取媒体ID\n  * 通过媒体ID获取私有媒体访问链接\n  * 使用认证HTTP请求下载媒体文件\n\n适用场景：\n\n  * 将WhatsApp媒体存档至外部系统\n  * 根据接收的媒体触发后续自动化流程\n  * 与Google Drive、Dropbox或Amazon S3等云存储集成\n\n配置步骤：\n\n  * 连接您的WhatsApp Business API账户\n  * 添加通过私有链接下载媒体所需的HTTP凭证\n  * 在WhatsApp Business账户中设置Webhook\n  * 根据实际需求扩展工作流（如文件存储、提醒通知等）",
  "title_zh": "通过HTTP存储自动下载WhatsApp商务消息中的媒体文件",
  "publish_date_zh": "最后更新于6天前",
  "workflow_json_zh": "{\"meta\":{\"instanceId\":\"4e229722e6c43a4914d2d66178b48335adf795d73afbee5b0ea0c52938ef4d8e\",\"templateCredsSetupCompleted\":true},\"nodes\":[{\"id\":\"a24e0949-dcf6-48d4-8b9e-ce201e8b87d8\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-2380,-400],\"parameters\":{\"width\":320,\"height\":240,\"content\":\"本说明指出，当收到带有媒体的新WhatsApp消息时，工作流程将被触发。\"},\"typeVersion\":1},{\"id\":\"f513cc8b-89d3-4481-b7fa-ac9d33ba8562\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-1980,-400],\"parameters\":{\"width\":320,\"height\":240,\"content\":\"本说明指出，媒体ID用于获取下载该媒体的私有URL。\"},\"typeVersion\":1},{\"id\":\"3bae6af6-8858-4da4-ab2c-846a2c3e0ffe\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-1600,-400],\"parameters\":{\"width\":320,\"height\":240,\"content\":\"本说明指出，媒体文件是通过获取的私有URL下载的。\"},\"typeVersion\":1},{\"id\":\"f694abd7-dacf-41a7-82aa-157bfcf54f83\",\"name\":\"Trigger WhatsApp Media\",\"type\":\"n8n-nodes-base.whatsAppTrigger\",\"position\":[-2280,-320],\"webhookId\":\"864469fd-2008-445c-83fe-852dac2b236a\",\"parameters\":{\"options\":{},\"updates\":[\"messages\"]},\"credentials\":{\"whatsAppTriggerApi\":{\"id\":\"a41n62XWot5Pm1XE\",\"name\":\"WhatsApp OAuth account\"}},\"typeVersion\":1},{\"id\":\"33e74a92-4475-470d-8003-7631ea0b706f\",\"name\":\"Fetch Media Download URL\",\"type\":\"n8n-nodes-base.whatsApp\",\"position\":[-1880,-320],\"webhookId\":\"b052dd6a-55b8-4195-a64e-c0088b7419cc\",\"parameters\":{\"resource\":\"media\",\"operation\":\"mediaUrlGet\",\"mediaGetId\":\"={{ $json.messages[0].image.id }}\"},\"credentials\":{\"whatsAppApi\":{\"id\":\"yVJyvYLlRszyE5sV\",\"name\":\"WhatsApp account\"}},\"typeVersion\":1},{\"id\":\"5e9b09e8-b9d2-4571-a897-d49d32a68c3c\",\"name\":\"Download Media File\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[-1500,-320],\"parameters\":{\"url\":\"={{ $json.url }}\",\"options\":{\"response\":{\"response\":{}}},\"authentication\":\"genericCredentialType\",\"genericAuthType\":\"httpHeaderAuth\"},\"credentials\":{\"httpBearerAuth\":{\"id\":\"Ihwbk0P1mYkOZZlr\",\"name\":\"Whatsapp APi Token\"},\"httpHeaderAuth\":{\"id\":\"Rymur2oAzX9lewU9\",\"name\":\"Whatsapp API Token\"}},\"typeVersion\":4.2}],\"pinData\":{},\"connections\":{\"Trigger WhatsApp Media\":{\"main\":[[{\"node\":\"Fetch Media Download URL\",\"type\":\"main\",\"index\":0}]]},\"Fetch Media Download URL\":{\"main\":[[{\"node\":\"Download Media File\",\"type\":\"main\",\"index\":0}]]}}}"
}