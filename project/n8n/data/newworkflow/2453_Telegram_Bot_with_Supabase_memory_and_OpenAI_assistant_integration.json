{
  "url": "https://n8n.io/workflows/2453-telegram-bot-with-supabase-memory-and-openai-assistant-integration/",
  "title": "Telegram Bot with Supabase memory and OpenAI assistant integration",
  "author": "Mark Shcherbakov",
  "publish_date": "Last update 6 months ago",
  "publish_date_absolute": "2024-11-25",
  "categories": [
    {
      "name": "AI"
    }
  ],
  "workflow_json": "{\"nodes\":[{\"id\":\"9cc26a42-eb43-40c4-b507-cbaf187a5e15\",\"name\":\"Get New Message\",\"type\":\"n8n-nodes-base.telegramTrigger\",\"position\":[1120,500],\"webhookId\":\"464f0a75-56d1-402f-8b12-b358452e9736\",\"parameters\":{\"updates\":[\"message\"],\"additionalFields\":{}},\"credentials\":{\"telegramApi\":{\"id\":\"rI0zyfIYVIyXt2fL\",\"name\":\"Telegram Club\"}},\"typeVersion\":1.1},{\"id\":\"098b6fcf-7cb6-4730-8892-949fedc946b3\",\"name\":\"OPENAI - Create thread\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[1740,640],\"parameters\":{\"url\":\"https://api.openai.com/v1/threads\",\"method\":\"POST\",\"options\":{},\"sendHeaders\":true,\"authentication\":\"predefinedCredentialType\",\"headerParameters\":{\"parameters\":[{\"name\":\"OpenAI-Beta\",\"value\":\"assistants=v2\"}]},\"nodeCredentialType\":\"openAiApi\"},\"credentials\":{\"openAiApi\":{\"id\":\"zJhr5piyEwVnWtaI\",\"name\":\"OpenAi club\"}},\"typeVersion\":4.2},{\"id\":\"fa157f8c-b776-4b20-bfaf-c17460383505\",\"name\":\"Create User\",\"type\":\"n8n-nodes-base.supabase\",\"position\":[1900,640],\"parameters\":{\"tableId\":\"telegram_users\",\"fieldsUi\":{\"fieldValues\":[{\"fieldId\":\"telegram_id\",\"fieldValue\":\"={{ $('Get New Message').item.json.message.chat.id }}\"},{\"fieldId\":\"openai_thread_id\",\"fieldValue\":\"={{ $('OPENAI - Create thread').item.json.id }}\"}]}},\"credentials\":{\"supabaseApi\":{\"id\":\"QBhcokohbJHfQZ9A\",\"name\":\"Supabase club\"}},\"typeVersion\":1},{\"id\":\"115e417f-5962-409b-8adf-ff236eb9ce2e\",\"name\":\"Merge\",\"type\":\"n8n-nodes-base.merge\",\"position\":[2080,500],\"parameters\":{},\"typeVersion\":3},{\"id\":\"ba5c7385-8c80-43c8-9de2-430175bda70b\",\"name\":\"OPENAI - Send message\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[2240,500],\"parameters\":{\"url\":\"=https://api.openai.com/v1/threads/{{ $('Merge').item.json.openai_thread_id }}/messages \",\"method\":\"POST\",\"options\":{},\"sendBody\":true,\"sendHeaders\":true,\"authentication\":\"predefinedCredentialType\",\"bodyParameters\":{\"parameters\":[{\"name\":\"role\",\"value\":\"user\"},{\"name\":\"content\",\"value\":\"={{ $('Get New Message').item.json.message.text }}\"}]},\"headerParameters\":{\"parameters\":[{\"name\":\"OpenAI-Beta\",\"value\":\"assistants=v2\"}]},\"nodeCredentialType\":\"openAiApi\"},\"credentials\":{\"openAiApi\":{\"id\":\"fLfRtaXbR0EVD0pl\",\"name\":\"OpenAi account\"}},\"typeVersion\":4.2},{\"id\":\"024832bc-3d42-4879-a57f-b23e962b4c69\",\"name\":\"OPENAI - Run assistant\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[2440,500],\"parameters\":{\"url\":\"=https://api.openai.com/v1/threads/{{ $('Merge').item.json.openai_thread_id }}/runs\",\"method\":\"POST\",\"options\":{},\"sendBody\":true,\"sendHeaders\":true,\"authentication\":\"predefinedCredentialType\",\"bodyParameters\":{\"parameters\":[{\"name\":\"assistant_id\",\"value\":\"asst_b0QhuzySG6jofHFdzPZD7WEz\"},{\"name\":\"stream\",\"value\":\"={{true}}\"}]},\"headerParameters\":{\"parameters\":[{\"name\":\"OpenAI-Beta\",\"value\":\"assistants=v2\"}]},\"nodeCredentialType\":\"openAiApi\"},\"credentials\":{\"openAiApi\":{\"id\":\"fLfRtaXbR0EVD0pl\",\"name\":\"OpenAi account\"}},\"typeVersion\":4.2},{\"id\":\"bc191e2b-15f4-45b7-af2e-19ed1639b7f5\",\"name\":\"OPENAI - Get messages\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[2640,500],\"parameters\":{\"url\":\"=https://api.openai.com/v1/threads/{{ $('Merge').item.json.openai_thread_id }}/messages\",\"options\":{},\"sendHeaders\":true,\"authentication\":\"predefinedCredentialType\",\"headerParameters\":{\"parameters\":[{\"name\":\"OpenAI-Beta\",\"value\":\"assistants=v2\"}]},\"nodeCredentialType\":\"openAiApi\"},\"credentials\":{\"openAiApi\":{\"id\":\"zJhr5piyEwVnWtaI\",\"name\":\"OpenAi club\"}},\"typeVersion\":4.2},{\"id\":\"c22e05e5-f0a7-4a09-a864-acfc58469b30\",\"name\":\"Send Message to User\",\"type\":\"n8n-nodes-base.telegram\",\"position\":[2840,500],\"parameters\":{\"text\":\"={{ $('OPENAI - Get messages').item.json.data[0].content[0].text.value }}\",\"chatId\":\"={{ $('Get New Message').item.json.message.chat.id }}\",\"additionalFields\":{\"appendAttribution\":false}},\"credentials\":{\"telegramApi\":{\"id\":\"rI0zyfIYVIyXt2fL\",\"name\":\"Telegram Club\"}},\"typeVersion\":1.2},{\"id\":\"0673be1f-3cae-42a0-9c62-1ed570859043\",\"name\":\"If User exists\",\"type\":\"n8n-nodes-base.if\",\"position\":[1560,500],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"b6e69a1f-eb42-4ef6-b80c-3167f1b8c830\",\"operator\":{\"type\":\"string\",\"operation\":\"exists\",\"singleValue\":true},\"leftValue\":\"={{ $json.id }}\",\"rightValue\":\"\"}]}},\"typeVersion\":2.1},{\"id\":\"a4916f54-ae6b-495d-979b-92dca965e3bb\",\"name\":\"Find User\",\"type\":\"n8n-nodes-base.supabase\",\"position\":[1360,500],\"parameters\":{\"filters\":{\"conditions\":[{\"keyName\":\"telegram_id\",\"keyValue\":\"={{ $json.message.chat.id }}\",\"condition\":\"eq\"}]},\"tableId\":\"telegram_users\",\"operation\":\"getAll\"},\"credentials\":{\"supabaseApi\":{\"id\":\"QBhcokohbJHfQZ9A\",\"name\":\"Supabase club\"}},\"typeVersion\":1,\"alwaysOutputData\":true},{\"id\":\"6d01d7ed-e96b-47cf-9a5f-46608031baa2\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1300,800],\"parameters\":{\"color\":7,\"width\":600.723278204605,\"height\":213.15921994594194,\"content\":\"SQL query to create table in Supabase:\\n\\n```\\ncreate table\\n  public.telegram_users (\\n    id uuid not null default gen_random_uuid (),\\n    date_created timestamp with time zone not null default (now() at time zone 'utc'::text),\\n    telegram_id bigint null,\\n    openai_thread_id text null,\\n    constraint telegram_users_pkey primary key (id)\\n  ) tablespace pg_default;\\n```\"},\"typeVersion\":1},{\"id\":\"1a996da0-6022-48d7-ba40-1d137547a3d7\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[2340,360],\"parameters\":{\"color\":3,\"width\":282.075050779723,\"height\":80,\"content\":\"Create assistant in [OpenAI](https://platform.openai.com/assistants).\\n\\n**Specify own assistant id here**\\n\"},\"typeVersion\":1},{\"id\":\"b24d2008-7950-41f0-a7fa-50360c0c6854\",\"name\":\"Sticky Note3\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1040,380],\"parameters\":{\"color\":3,\"width\":235.09282368774151,\"height\":80,\"content\":\"Create own Telegram bot in [Botfather bot](https://t.me/botfather)\"},\"typeVersion\":1},{\"id\":\"9eb2491e-5ad9-4015-8ed9-611e72924503\",\"name\":\"Sticky Note4\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1300,680],\"parameters\":{\"color\":3,\"height\":80,\"content\":\"Create table in [Supabase](https://supabase.com) with SQL query\"},\"typeVersion\":1},{\"id\":\"884b5a1b-007c-4752-becc-46c8fc58db92\",\"name\":\"Sticky Note5\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[200,120],\"parameters\":{\"color\":7,\"width\":280.2462120317618,\"height\":438.5821431288714,\"content\":\"### Set up steps\\n1. **Create a Telegram Bot** using the [Botfather](https://t.me/botfather) and obtain the bot token.\\n2. **Set up Supabase:**\\n\\t1. Create a new project and generate a ```SUPABASE_URL``` and ```SUPABASE_KEY```.\\n\\t2. Create a new table named ```telegram_users``` with the following SQL query:\\n```\\ncreate table\\n  public.telegram_users (\\n    id uuid not null default gen_random_uuid (),\\n    date_created timestamp with time zone not null default (now() at time zone 'utc'::text),\\n    telegram_id bigint null,\\n    openai_thread_id text null,\\n    constraint telegram_users_pkey primary key (id)\\n  ) tablespace pg_default;\\n```\\n3. **OpenAI Setup:**\\n\\t1. Create an OpenAI assistant and obtain the ```OPENAI_API_KEY```.\\n\\t2. Customize your assistant’s personality or use cases according to your requirements.\\n4. **Environment Configuration in n8n:**\\n\\t1. Configure the Telegram, Supabase, and OpenAI nodes with the appropriate credentials.\\n\\t2. Set up triggers for receiving messages and handling conversation logic.\\n\\t3. Set up OpenAI assistant ID in \\\"++OPENAI - Run assistant++\\\" node.\"},\"typeVersion\":1},{\"id\":\"02db77ac-4909-4a56-a558-03c86d8b8552\",\"name\":\"Sticky Note6\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[200,-400],\"parameters\":{\"color\":7,\"width\":636.2128494576581,\"height\":494.9629292914819,\"content\":\"![5min Logo](https://cflobdhpqwnoisuctsoc.supabase.co/storage/v1/object/public/my_storage/Untitled%20(1500%20x%20300%20px).png)\\n## AI Telegram Bot with Supabase memory\\n**Made by [Mark Shcherbakov](https://www.linkedin.com/in/marklowcoding/) from community [5minAI](https://www.skool.com/5minai-2861)**\\n\\nMany simple chatbots lack context awareness and user memory. This workflow solves that by integrating Supabase to keep track of user sessions (via ```telegram_id``` and ```openai_thread_id```), allowing the bot to maintain continuity and context in conversations, leading to a more human-like and engaging experience.\\n\\nThis Telegram bot template connects with OpenAI to answer user queries while storing and retrieving user information from a Supabase database. The memory component ensures that the bot can reference past interactions, making it suitable for use cases such as customer support, virtual assistants, or any application where context retention is crucial.\\n\\n\"},\"typeVersion\":1},{\"id\":\"a991a7c9-ea5f-4a25-aa92-6dc2fce11b05\",\"name\":\"Sticky Note7\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[500,120],\"parameters\":{\"color\":7,\"width\":330.5152611046425,\"height\":240.6839895136402,\"content\":\"### ... or watch set up video [5 min]\\n[![Youtube Thumbnail](https://cflobdhpqwnoisuctsoc.supabase.co/storage/v1/object/public/my_storage/Youtube%20thumb%20(3).png)](https://www.youtube.com/watch?v=kS41gut8l0g)\\n\"},\"typeVersion\":1}],\"pinData\":{\"Merge\":[{\"id\":\"4a5d71a4-a2f7-43e2-936f-37ee5bf5cc9e\",\"telegram_id\":1468754364,\"date_created\":\"2024-10-04T08:29:07.458869+00:00\",\"openai_thread_id\":null}],\"Find User\":[{\"id\":\"4a5d71a4-a2f7-43e2-936f-37ee5bf5cc9e\",\"telegram_id\":1468754364,\"date_created\":\"2024-10-04T08:29:07.458869+00:00\",\"openai_thread_id\":null}],\"Get New Message\":[{\"message\":{\"chat\":{\"id\":1468754364,\"type\":\"private\",\"username\":\"low_code\",\"first_name\":\"Mark\"},\"date\":1727961249,\"from\":{\"id\":1468754364,\"is_bot\":false,\"username\":\"low_code\",\"first_name\":\"Mark\",\"language_code\":\"en\"},\"text\":\"Hello, how are you?\",\"entities\":[{\"type\":\"bot_command\",\"length\":6,\"offset\":0}],\"message_id\":3},\"update_id\":412281353}],\"Send Message to User\":[{\"ok\":true,\"result\":{\"chat\":{\"id\":1468754364,\"type\":\"private\",\"username\":\"low_code\",\"first_name\":\"Mark\"},\"date\":1727971919,\"from\":{\"id\":7999029315,\"is_bot\":true,\"username\":\"test241234_bot\",\"first_name\":\"Test bot\"},\"text\":\"Hello! I'm just a program, but I'm here and ready to help you. How can I assist you today?\",\"message_id\":7}}],\"OPENAI - Get messages\":[{\"data\":[{\"id\":\"msg_C7aXbSotAl6xCxjR9avi4wUz\",\"role\":\"assistant\",\"object\":\"thread.message\",\"run_id\":\"run_9avgP4lZ1FRSsL3y9UO8HPa1\",\"content\":[{\"text\":{\"value\":\"Hello! I'm just a program, but I'm here and ready to help you. How can I assist you today?\",\"annotations\":[]},\"type\":\"text\"}],\"metadata\":{},\"thread_id\":\"thread_laO8JLPW6L1upYHW6fSRj8Bt\",\"created_at\":1727971739,\"attachments\":[],\"assistant_id\":\"asst_b0QhuzySG6jofHFdzPZD7WEz\"},{\"id\":\"msg_fVGPVHR03QKheHXh54SFpmpm\",\"role\":\"user\",\"object\":\"thread.message\",\"run_id\":null,\"content\":[{\"text\":{\"value\":\"Hello, how are you?\",\"annotations\":[]},\"type\":\"text\"}],\"metadata\":{},\"thread_id\":\"thread_laO8JLPW6L1upYHW6fSRj8Bt\",\"created_at\":1727971467,\"attachments\":[],\"assistant_id\":null}],\"object\":\"list\",\"last_id\":\"msg_fVGPVHR03QKheHXh54SFpmpm\",\"first_id\":\"msg_C7aXbSotAl6xCxjR9avi4wUz\",\"has_more\":false}],\"OPENAI - Send message\":[{\"id\":\"msg_fVGPVHR03QKheHXh54SFpmpm\",\"role\":\"user\",\"object\":\"thread.message\",\"run_id\":null,\"content\":[{\"text\":{\"value\":\"Hello, how are you?\",\"annotations\":[]},\"type\":\"text\"}],\"metadata\":{},\"thread_id\":\"thread_laO8JLPW6L1upYHW6fSRj8Bt\",\"created_at\":1727971467,\"attachments\":[],\"assistant_id\":null}],\"OPENAI - Create thread\":[{\"id\":\"thread_laO8JLPW6L1upYHW6fSRj8Bt\",\"object\":\"thread\",\"metadata\":{},\"created_at\":1727971362,\"tool_resources\":{}}],\"OPENAI - Run assistant\":[{\"data\":\"event: thread.run.created\\ndata: {\\\"id\\\":\\\"run_9avgP4lZ1FRSsL3y9UO8HPa1\\\",\\\"object\\\":\\\"thread.run\\\",\\\"created_at\\\":1727971737,\\\"assistant_id\\\":\\\"asst_b0QhuzySG6jofHFdzPZD7WEz\\\",\\\"thread_id\\\":\\\"thread_laO8JLPW6L1upYHW6fSRj8Bt\\\",\\\"status\\\":\\\"queued\\\",\\\"started_at\\\":null,\\\"expires_at\\\":1727972337,\\\"cancelled_at\\\":null,\\\"failed_at\\\":null,\\\"completed_at\\\":null,\\\"required_action\\\":null,\\\"last_error\\\":null,\\\"model\\\":\\\"gpt-4o-mini\\\",\\\"instructions\\\":\\\"You are ChatGPT\\\",\\\"tools\\\":[],\\\"tool_resources\\\":{\\\"code_interpreter\\\":{\\\"file_ids\\\":[]}},\\\"metadata\\\":{},\\\"temperature\\\":1.0,\\\"top_p\\\":1.0,\\\"max_completion_tokens\\\":null,\\\"max_prompt_tokens\\\":null,\\\"truncation_strategy\\\":{\\\"type\\\":\\\"auto\\\",\\\"last_messages\\\":null},\\\"incomplete_details\\\":null,\\\"usage\\\":null,\\\"response_format\\\":\\\"auto\\\",\\\"tool_choice\\\":\\\"auto\\\",\\\"parallel_tool_calls\\\":true}\\n\\nevent: thread.run.queued\\ndata: {\\\"id\\\":\\\"run_9avgP4lZ1FRSsL3y9UO8HPa1\\\",\\\"object\\\":\\\"thread.run\\\",\\\"created_at\\\":1727971737,\\\"assistant_id\\\":\\\"asst_b0QhuzySG6jofHFdzPZD7WEz\\\",\\\"thread_id\\\":\\\"thread_laO8JLPW6L1upYHW6fSRj8Bt\\\",\\\"status\\\":\\\"queued\\\",\\\"started_at\\\":null,\\\"expires_at\\\":1727972337,\\\"cancelled_at\\\":null,\\\"failed_at\\\":null,\\\"completed_at\\\":null,\\\"required_action\\\":null,\\\"last_error\\\":null,\\\"model\\\":\\\"gpt-4o-mini\\\",\\\"instructions\\\":\\\"You are ChatGPT\\\",\\\"tools\\\":[],\\\"tool_resources\\\":{\\\"code_interpreter\\\":{\\\"file_ids\\\":[]}},\\\"metadata\\\":{},\\\"temperature\\\":1.0,\\\"top_p\\\":1.0,\\\"max_completion_tokens\\\":null,\\\"max_prompt_tokens\\\":null,\\\"truncation_strategy\\\":{\\\"type\\\":\\\"auto\\\",\\\"last_messages\\\":null},\\\"incomplete_details\\\":null,\\\"usage\\\":null,\\\"response_format\\\":\\\"auto\\\",\\\"tool_choice\\\":\\\"auto\\\",\\\"parallel_tool_calls\\\":true}\\n\\nevent: thread.run.in_progress\\ndata: {\\\"id\\\":\\\"run_9avgP4lZ1FRSsL3y9UO8HPa1\\\",\\\"object\\\":\\\"thread.run\\\",\\\"created_at\\\":1727971737,\\\"assistant_id\\\":\\\"asst_b0QhuzySG6jofHFdzPZD7WEz\\\",\\\"thread_id\\\":\\\"thread_laO8JLPW6L1upYHW6fSRj8Bt\\\",\\\"status\\\":\\\"in_progress\\\",\\\"started_at\\\":1727971738,\\\"expires_at\\\":1727972337,\\\"cancelled_at\\\":null,\\\"failed_at\\\":null,\\\"completed_at\\\":null,\\\"required_action\\\":null,\\\"last_error\\\":null,\\\"model\\\":\\\"gpt-4o-mini\\\",\\\"instructions\\\":\\\"You are ChatGPT\\\",\\\"tools\\\":[],\\\"tool_resources\\\":{\\\"code_interpreter\\\":{\\\"file_ids\\\":[]}},\\\"metadata\\\":{},\\\"temperature\\\":1.0,\\\"top_p\\\":1.0,\\\"max_completion_tokens\\\":null,\\\"max_prompt_tokens\\\":null,\\\"truncation_strategy\\\":{\\\"type\\\":\\\"auto\\\",\\\"last_messages\\\":null},\\\"incomplete_details\\\":null,\\\"usage\\\":null,\\\"response_format\\\":\\\"auto\\\",\\\"tool_choice\\\":\\\"auto\\\",\\\"parallel_tool_calls\\\":true}\\n\\nevent: thread.run.step.created\\ndata: {\\\"id\\\":\\\"step_b0iFvL1q1UEZDfBRbbNTiulO\\\",\\\"object\\\":\\\"thread.run.step\\\",\\\"created_at\\\":1727971739,\\\"run_id\\\":\\\"run_9avgP4lZ1FRSsL3y9UO8HPa1\\\",\\\"assistant_id\\\":\\\"asst_b0QhuzySG6jofHFdzPZD7WEz\\\",\\\"thread_id\\\":\\\"thread_laO8JLPW6L1upYHW6fSRj8Bt\\\",\\\"type\\\":\\\"message_creation\\\",\\\"status\\\":\\\"in_progress\\\",\\\"cancelled_at\\\":null,\\\"completed_at\\\":null,\\\"expires_at\\\":1727972337,\\\"failed_at\\\":null,\\\"last_error\\\":null,\\\"step_details\\\":{\\\"type\\\":\\\"message_creation\\\",\\\"message_creation\\\":{\\\"message_id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\"}},\\\"usage\\\":null}\\n\\nevent: thread.run.step.in_progress\\ndata: {\\\"id\\\":\\\"step_b0iFvL1q1UEZDfBRbbNTiulO\\\",\\\"object\\\":\\\"thread.run.step\\\",\\\"created_at\\\":1727971739,\\\"run_id\\\":\\\"run_9avgP4lZ1FRSsL3y9UO8HPa1\\\",\\\"assistant_id\\\":\\\"asst_b0QhuzySG6jofHFdzPZD7WEz\\\",\\\"thread_id\\\":\\\"thread_laO8JLPW6L1upYHW6fSRj8Bt\\\",\\\"type\\\":\\\"message_creation\\\",\\\"status\\\":\\\"in_progress\\\",\\\"cancelled_at\\\":null,\\\"completed_at\\\":null,\\\"expires_at\\\":1727972337,\\\"failed_at\\\":null,\\\"last_error\\\":null,\\\"step_details\\\":{\\\"type\\\":\\\"message_creation\\\",\\\"message_creation\\\":{\\\"message_id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\"}},\\\"usage\\\":null}\\n\\nevent: thread.message.created\\ndata: {\\\"id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\",\\\"object\\\":\\\"thread.message\\\",\\\"created_at\\\":1727971739,\\\"assistant_id\\\":\\\"asst_b0QhuzySG6jofHFdzPZD7WEz\\\",\\\"thread_id\\\":\\\"thread_laO8JLPW6L1upYHW6fSRj8Bt\\\",\\\"run_id\\\":\\\"run_9avgP4lZ1FRSsL3y9UO8HPa1\\\",\\\"status\\\":\\\"in_progress\\\",\\\"incomplete_details\\\":null,\\\"incomplete_at\\\":null,\\\"completed_at\\\":null,\\\"role\\\":\\\"assistant\\\",\\\"content\\\":[],\\\"attachments\\\":[],\\\"metadata\\\":{}}\\n\\nevent: thread.message.in_progress\\ndata: {\\\"id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\",\\\"object\\\":\\\"thread.message\\\",\\\"created_at\\\":1727971739,\\\"assistant_id\\\":\\\"asst_b0QhuzySG6jofHFdzPZD7WEz\\\",\\\"thread_id\\\":\\\"thread_laO8JLPW6L1upYHW6fSRj8Bt\\\",\\\"run_id\\\":\\\"run_9avgP4lZ1FRSsL3y9UO8HPa1\\\",\\\"status\\\":\\\"in_progress\\\",\\\"incomplete_details\\\":null,\\\"incomplete_at\\\":null,\\\"completed_at\\\":null,\\\"role\\\":\\\"assistant\\\",\\\"content\\\":[],\\\"attachments\\\":[],\\\"metadata\\\":{}}\\n\\nevent: thread.message.delta\\ndata: {\\\"id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\",\\\"object\\\":\\\"thread.message.delta\\\",\\\"delta\\\":{\\\"content\\\":[{\\\"index\\\":0,\\\"type\\\":\\\"text\\\",\\\"text\\\":{\\\"value\\\":\\\"Hello\\\",\\\"annotations\\\":[]}}]}}\\n\\nevent: thread.message.delta\\ndata: {\\\"id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\",\\\"object\\\":\\\"thread.message.delta\\\",\\\"delta\\\":{\\\"content\\\":[{\\\"index\\\":0,\\\"type\\\":\\\"text\\\",\\\"text\\\":{\\\"value\\\":\\\"!\\\"}}]}}\\n\\nevent: thread.message.delta\\ndata: {\\\"id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\",\\\"object\\\":\\\"thread.message.delta\\\",\\\"delta\\\":{\\\"content\\\":[{\\\"index\\\":0,\\\"type\\\":\\\"text\\\",\\\"text\\\":{\\\"value\\\":\\\" I'm\\\"}}]}}\\n\\nevent: thread.message.delta\\ndata: {\\\"id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\",\\\"object\\\":\\\"thread.message.delta\\\",\\\"delta\\\":{\\\"content\\\":[{\\\"index\\\":0,\\\"type\\\":\\\"text\\\",\\\"text\\\":{\\\"value\\\":\\\" just\\\"}}]}}\\n\\nevent: thread.message.delta\\ndata: {\\\"id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\",\\\"object\\\":\\\"thread.message.delta\\\",\\\"delta\\\":{\\\"content\\\":[{\\\"index\\\":0,\\\"type\\\":\\\"text\\\",\\\"text\\\":{\\\"value\\\":\\\" a\\\"}}]}}\\n\\nevent: thread.message.delta\\ndata: {\\\"id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\",\\\"object\\\":\\\"thread.message.delta\\\",\\\"delta\\\":{\\\"content\\\":[{\\\"index\\\":0,\\\"type\\\":\\\"text\\\",\\\"text\\\":{\\\"value\\\":\\\" program\\\"}}]}}\\n\\nevent: thread.message.delta\\ndata: {\\\"id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\",\\\"object\\\":\\\"thread.message.delta\\\",\\\"delta\\\":{\\\"content\\\":[{\\\"index\\\":0,\\\"type\\\":\\\"text\\\",\\\"text\\\":{\\\"value\\\":\\\",\\\"}}]}}\\n\\nevent: thread.message.delta\\ndata: {\\\"id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\",\\\"object\\\":\\\"thread.message.delta\\\",\\\"delta\\\":{\\\"content\\\":[{\\\"index\\\":0,\\\"type\\\":\\\"text\\\",\\\"text\\\":{\\\"value\\\":\\\" but\\\"}}]}}\\n\\nevent: thread.message.delta\\ndata: {\\\"id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\",\\\"object\\\":\\\"thread.message.delta\\\",\\\"delta\\\":{\\\"content\\\":[{\\\"index\\\":0,\\\"type\\\":\\\"text\\\",\\\"text\\\":{\\\"value\\\":\\\" I'm\\\"}}]}}\\n\\nevent: thread.message.delta\\ndata: {\\\"id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\",\\\"object\\\":\\\"thread.message.delta\\\",\\\"delta\\\":{\\\"content\\\":[{\\\"index\\\":0,\\\"type\\\":\\\"text\\\",\\\"text\\\":{\\\"value\\\":\\\" here\\\"}}]}}\\n\\nevent: thread.message.delta\\ndata: {\\\"id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\",\\\"object\\\":\\\"thread.message.delta\\\",\\\"delta\\\":{\\\"content\\\":[{\\\"index\\\":0,\\\"type\\\":\\\"text\\\",\\\"text\\\":{\\\"value\\\":\\\" and\\\"}}]}}\\n\\nevent: thread.message.delta\\ndata: {\\\"id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\",\\\"object\\\":\\\"thread.message.delta\\\",\\\"delta\\\":{\\\"content\\\":[{\\\"index\\\":0,\\\"type\\\":\\\"text\\\",\\\"text\\\":{\\\"value\\\":\\\" ready\\\"}}]}}\\n\\nevent: thread.message.delta\\ndata: {\\\"id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\",\\\"object\\\":\\\"thread.message.delta\\\",\\\"delta\\\":{\\\"content\\\":[{\\\"index\\\":0,\\\"type\\\":\\\"text\\\",\\\"text\\\":{\\\"value\\\":\\\" to\\\"}}]}}\\n\\nevent: thread.message.delta\\ndata: {\\\"id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\",\\\"object\\\":\\\"thread.message.delta\\\",\\\"delta\\\":{\\\"content\\\":[{\\\"index\\\":0,\\\"type\\\":\\\"text\\\",\\\"text\\\":{\\\"value\\\":\\\" help\\\"}}]}}\\n\\nevent: thread.message.delta\\ndata: {\\\"id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\",\\\"object\\\":\\\"thread.message.delta\\\",\\\"delta\\\":{\\\"content\\\":[{\\\"index\\\":0,\\\"type\\\":\\\"text\\\",\\\"text\\\":{\\\"value\\\":\\\" you\\\"}}]}}\\n\\nevent: thread.message.delta\\ndata: {\\\"id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\",\\\"object\\\":\\\"thread.message.delta\\\",\\\"delta\\\":{\\\"content\\\":[{\\\"index\\\":0,\\\"type\\\":\\\"text\\\",\\\"text\\\":{\\\"value\\\":\\\".\\\"}}]}}\\n\\nevent: thread.message.delta\\ndata: {\\\"id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\",\\\"object\\\":\\\"thread.message.delta\\\",\\\"delta\\\":{\\\"content\\\":[{\\\"index\\\":0,\\\"type\\\":\\\"text\\\",\\\"text\\\":{\\\"value\\\":\\\" How\\\"}}]}}\\n\\nevent: thread.message.delta\\ndata: {\\\"id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\",\\\"object\\\":\\\"thread.message.delta\\\",\\\"delta\\\":{\\\"content\\\":[{\\\"index\\\":0,\\\"type\\\":\\\"text\\\",\\\"text\\\":{\\\"value\\\":\\\" can\\\"}}]}}\\n\\nevent: thread.message.delta\\ndata: {\\\"id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\",\\\"object\\\":\\\"thread.message.delta\\\",\\\"delta\\\":{\\\"content\\\":[{\\\"index\\\":0,\\\"type\\\":\\\"text\\\",\\\"text\\\":{\\\"value\\\":\\\" I\\\"}}]}}\\n\\nevent: thread.message.delta\\ndata: {\\\"id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\",\\\"object\\\":\\\"thread.message.delta\\\",\\\"delta\\\":{\\\"content\\\":[{\\\"index\\\":0,\\\"type\\\":\\\"text\\\",\\\"text\\\":{\\\"value\\\":\\\" assist\\\"}}]}}\\n\\nevent: thread.message.delta\\ndata: {\\\"id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\",\\\"object\\\":\\\"thread.message.delta\\\",\\\"delta\\\":{\\\"content\\\":[{\\\"index\\\":0,\\\"type\\\":\\\"text\\\",\\\"text\\\":{\\\"value\\\":\\\" you\\\"}}]}}\\n\\nevent: thread.message.delta\\ndata: {\\\"id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\",\\\"object\\\":\\\"thread.message.delta\\\",\\\"delta\\\":{\\\"content\\\":[{\\\"index\\\":0,\\\"type\\\":\\\"text\\\",\\\"text\\\":{\\\"value\\\":\\\" today\\\"}}]}}\\n\\nevent: thread.message.delta\\ndata: {\\\"id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\",\\\"object\\\":\\\"thread.message.delta\\\",\\\"delta\\\":{\\\"content\\\":[{\\\"index\\\":0,\\\"type\\\":\\\"text\\\",\\\"text\\\":{\\\"value\\\":\\\"?\\\"}}]}}\\n\\nevent: thread.message.completed\\ndata: {\\\"id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\",\\\"object\\\":\\\"thread.message\\\",\\\"created_at\\\":1727971739,\\\"assistant_id\\\":\\\"asst_b0QhuzySG6jofHFdzPZD7WEz\\\",\\\"thread_id\\\":\\\"thread_laO8JLPW6L1upYHW6fSRj8Bt\\\",\\\"run_id\\\":\\\"run_9avgP4lZ1FRSsL3y9UO8HPa1\\\",\\\"status\\\":\\\"completed\\\",\\\"incomplete_details\\\":null,\\\"incomplete_at\\\":null,\\\"completed_at\\\":1727971740,\\\"role\\\":\\\"assistant\\\",\\\"content\\\":[{\\\"type\\\":\\\"text\\\",\\\"text\\\":{\\\"value\\\":\\\"Hello! I'm just a program, but I'm here and ready to help you. How can I assist you today?\\\",\\\"annotations\\\":[]}}],\\\"attachments\\\":[],\\\"metadata\\\":{}}\\n\\nevent: thread.run.step.completed\\ndata: {\\\"id\\\":\\\"step_b0iFvL1q1UEZDfBRbbNTiulO\\\",\\\"object\\\":\\\"thread.run.step\\\",\\\"created_at\\\":1727971739,\\\"run_id\\\":\\\"run_9avgP4lZ1FRSsL3y9UO8HPa1\\\",\\\"assistant_id\\\":\\\"asst_b0QhuzySG6jofHFdzPZD7WEz\\\",\\\"thread_id\\\":\\\"thread_laO8JLPW6L1upYHW6fSRj8Bt\\\",\\\"type\\\":\\\"message_creation\\\",\\\"status\\\":\\\"completed\\\",\\\"cancelled_at\\\":null,\\\"completed_at\\\":1727971740,\\\"expires_at\\\":1727972337,\\\"failed_at\\\":null,\\\"last_error\\\":null,\\\"step_details\\\":{\\\"type\\\":\\\"message_creation\\\",\\\"message_creation\\\":{\\\"message_id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\"}},\\\"usage\\\":{\\\"prompt_tokens\\\":39,\\\"completion_tokens\\\":25,\\\"total_tokens\\\":64}}\\n\\nevent: thread.run.completed\\ndata: {\\\"id\\\":\\\"run_9avgP4lZ1FRSsL3y9UO8HPa1\\\",\\\"object\\\":\\\"thread.run\\\",\\\"created_at\\\":1727971737,\\\"assistant_id\\\":\\\"asst_b0QhuzySG6jofHFdzPZD7WEz\\\",\\\"thread_id\\\":\\\"thread_laO8JLPW6L1upYHW6fSRj8Bt\\\",\\\"status\\\":\\\"completed\\\",\\\"started_at\\\":1727971738,\\\"expires_at\\\":null,\\\"cancelled_at\\\":null,\\\"failed_at\\\":null,\\\"completed_at\\\":1727971740,\\\"required_action\\\":null,\\\"last_error\\\":null,\\\"model\\\":\\\"gpt-4o-mini\\\",\\\"instructions\\\":\\\"You are ChatGPT\\\",\\\"tools\\\":[],\\\"tool_resources\\\":{\\\"code_interpreter\\\":{\\\"file_ids\\\":[]}},\\\"metadata\\\":{},\\\"temperature\\\":1.0,\\\"top_p\\\":1.0,\\\"max_completion_tokens\\\":null,\\\"max_prompt_tokens\\\":null,\\\"truncation_strategy\\\":{\\\"type\\\":\\\"auto\\\",\\\"last_messages\\\":null},\\\"incomplete_details\\\":null,\\\"usage\\\":{\\\"prompt_tokens\\\":39,\\\"completion_tokens\\\":25,\\\"total_tokens\\\":64},\\\"response_format\\\":\\\"auto\\\",\\\"tool_choice\\\":\\\"auto\\\",\\\"parallel_tool_calls\\\":true}\\n\\nevent: done\\ndata: [DONE]\\n\\n\"}]},\"connections\":{\"Merge\":{\"main\":[[{\"node\":\"OPENAI - Send message\",\"type\":\"main\",\"index\":0}]]},\"Find User\":{\"main\":[[{\"node\":\"If User exists\",\"type\":\"main\",\"index\":0}]]},\"Create User\":{\"main\":[[{\"node\":\"Merge\",\"type\":\"main\",\"index\":1}]]},\"If User exists\":{\"main\":[[{\"node\":\"Merge\",\"type\":\"main\",\"index\":0}],[{\"node\":\"OPENAI - Create thread\",\"type\":\"main\",\"index\":0}]]},\"Get New Message\":{\"main\":[[{\"node\":\"Find User\",\"type\":\"main\",\"index\":0}]]},\"OPENAI - Get messages\":{\"main\":[[{\"node\":\"Send Message to User\",\"type\":\"main\",\"index\":0}]]},\"OPENAI - Send message\":{\"main\":[[{\"node\":\"OPENAI - Run assistant\",\"type\":\"main\",\"index\":0}]]},\"OPENAI - Create thread\":{\"main\":[[{\"node\":\"Create User\",\"type\":\"main\",\"index\":0}]]},\"OPENAI - Run assistant\":{\"main\":[[{\"node\":\"OPENAI - Get messages\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "### Video Guide\n\nI prepared a detailed guide that showed the whole process of building an AI bot, from the simplest version to the most complex in a template.\n\n[![Youtube thumb 3.png](https://cflobdhpqwnoisuctsoc.supabase.co/storage/v1/object/public/my_storage/Youtube%20thumb%20\\(3\\).png)](https://www.youtube.com/watch?v=QrZxuWgFqBI)\n\n### Who is this for?\n\nThis workflow is ideal for developers, chatbot enthusiasts, and businesses looking to build a dynamic Telegram bot with memory capabilities. The bot leverages OpenAI's assistant to interact with users and stores user data in Supabase for personalized conversations.\n\n### What problem does this workflow solve?\n\nMany simple chatbots lack context awareness and user memory. This workflow solves that by integrating Supabase to keep track of user sessions (via `telegram_id` and `openai_thread_id`), allowing the bot to maintain continuity and context in conversations, leading to a more human-like and engaging experience.\n\n### What this workflow does\n\nThis Telegram bot template connects with OpenAI to answer user queries while storing and retrieving user information from a Supabase database. The memory component ensures that the bot can reference past interactions, making it suitable for use cases such as customer support, virtual assistants, or any application where context retention is crucial.\n\n1.**Receive New Message:** The bot listens for incoming messages from users in Telegram.  \n2\\. **Check User in Database:** The workflow checks if the user is already in the Supabase database using the `telegram_id`.  \n3\\. **Create New User (if necessary):** If the user does not exist, a new record is created in Supabase with the telegram_id and a unique `openai_thread_id`.  \n4\\. **Start or Continue Conversation with OpenAI:** Based on the user’s context, the bot either creates a new thread or continues an existing one using the stored `openai_thread_id`.  \n5\\. **Merge Data:** User-specific data and conversation context are merged.  \n6\\. **Send and Receive Messages:** The message is sent to OpenAI, and the response is received and processed.  \n7\\. **Reply to User:** The bot sends OpenAI’s response back to the user in Telegram.\n\n### Setup\n\n  1. **Create a Telegram Bot** using the [Botfather](https://t.me/botfather) and obtain the bot token.\n  2. **Set up Supabase:**\n     1. Create a new project and generate a `SUPABASE_URL` and `SUPABASE_KEY`.\n     2. Create a new table named `telegram_users` with the following SQL query:\n\n\n    \n    \n    create table\n      public.telegram_users (\n        id uuid not null default gen_random_uuid (),\n        date_created timestamp with time zone not null default (now() at time zone 'utc'::text),\n        telegram_id bigint null,\n        openai_thread_id text null,\n        constraint telegram_users_pkey primary key (id)\n      ) tablespace pg_default;\n    \n\n  1. **OpenAI Setup:**\n     1. Create an OpenAI assistant and obtain the `OPENAI_API_KEY`.\n     2. Customize your assistant’s personality or use cases according to your requirements.\n  2. **Environment Configuration in n8n:**\n     1. Configure the Telegram, Supabase, and OpenAI nodes with the appropriate credentials.\n     2. Set up triggers for receiving messages and handling conversation logic.\n     3. Set up OpenAI assistant ID in \"++OPENAI - Run assistant++\" node.\n\n\n",
  "crawled_at": "2025-05-25T23:55:44.279603",
  "readme_zh": "### 视频教程\n\n我制作了一份详细指南，完整演示了从最简版本到模板中最复杂版本的AI机器人构建全流程。\n\n[![Youtube缩略图3.png](https://cflobdhpqwnoisuctsoc.supabase.co/storage/v1/object/public/my_storage/Youtube%20thumb%20\\(3\\).png)](https://www.youtube.com/watch?v=QrZxuWgFqBI)\n\n### 适用人群\n\n本工作流特别适合以下用户：\n- 开发者\n- 聊天机器人爱好者\n- 需要构建具备记忆功能的动态Telegram机器人的企业\n\n该机器人通过OpenAI助手与用户交互，并将用户数据存储在Supabase中实现个性化对话。\n\n### 解决痛点\n\n普通聊天机器人往往缺乏上下文感知和用户记忆功能。本方案通过Supabase集成追踪用户会话（通过`telegram_id`和`openai_thread_id`），使机器人能保持对话连续性和上下文理解，提供更拟人化的交互体验。\n\n### 功能说明\n\n这个Telegram机器人模板具备以下能力：\n- 连接OpenAI解答用户咨询\n- 通过Supabase数据库存储/读取用户信息\n- 记忆功能可追溯历史对话\n\n特别适用于客服系统、虚拟助手等需要保持对话场景的应用场景。\n\n**完整工作流：**\n1. **接收消息**：监听Telegram用户消息  \n2. **数据库校验**：通过`telegram_id`查询Supabase用户记录  \n3. **新用户注册**：未注册用户将自动创建记录（含telegram_id和openai_thread_id）  \n4. **对话管理**：根据上下文新建或延续OpenAI对话线程  \n5. **数据融合**：整合用户数据与对话上下文  \n6. **消息处理**：将消息发送至OpenAI并接收响应  \n7. **回复用户**：将OpenAI响应返回Telegram用户\n\n### 配置指南\n\n1. **创建Telegram机器人**  \n   - 通过[Botfather](https://t.me/botfather)获取机器人令牌\n\n2. **配置Supabase**  \n   - 创建新项目，获取`SUPABASE_URL`和`SUPABASE_KEY`  \n   - 执行以下SQL创建用户表：\n\n```sql\ncreate table\n  public.telegram_users (\n    id uuid not null default gen_random_uuid (),\n    date_created timestamp with time zone not null default (now() at time zone 'utc'::text),\n    telegram_id bigint null,\n    openai_thread_id text null,\n    constraint telegram_users_pkey primary key (id)\n  tablespace pg_default;\n```\n\n3. **OpenAI配置**  \n   - 创建OpenAI助手并获取`OPENAI_API_KEY`  \n   - 按需定制助手特性\n\n4. **n8n环境配置**  \n   - 为Telegram/Supabase/OpenAI节点配置凭证  \n   - 设置消息接收触发器及对话逻辑  \n   - 在\"++OPENAI - Run assistant++\"节点配置助手ID\n\n（注：视频链接格式已修正为标准URL格式）",
  "title_zh": "集成Supabase存储与OpenAI助手的Telegram机器人",
  "publish_date_zh": "最后更新于5个月前",
  "workflow_json_zh": "{\n  \"nodes\": [\n    {\n      \"id\": \"9cc26a42-eb43-40c4-b507-cbaf187a5e15\",\n      \"name\": \"Get New Message\",\n      \"type\": \"n8n-nodes-base.telegramTrigger\",\n      \"position\": [\n        1120,\n        500\n      ],\n      \"webhookId\": \"464f0a75-56d1-402f-8b12-b358452e9736\",\n      \"parameters\": {\n        \"updates\": [\n          \"message\"\n        ],\n        \"additionalFields\": {}\n      },\n      \"credentials\": {\n        \"telegramApi\": {\n          \"id\": \"rI0zyfIYVIyXt2fL\",\n          \"name\": \"Telegram Club\"\n        }\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"098b6fcf-7cb6-4730-8892-949fedc946b3\",\n      \"name\": \"OPENAI - Create thread\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1740,\n        640\n      ],\n      \"parameters\": {\n        \"url\": \"https://api.openai.com/v1/threads\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"sendHeaders\": true,\n        \"authentication\": \"predefinedCredentialType\",\n        \"headerParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"OpenAI-Beta\",\n              \"value\": \"assistants=v2\"\n            }\n          ]\n        },\n        \"nodeCredentialType\": \"openAiApi\"\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"zJhr5piyEwVnWtaI\",\n          \"name\": \"OpenAi club\"\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"fa157f8c-b776-4b20-bfaf-c17460383505\",\n      \"name\": \"Create User\",\n      \"type\": \"n8n-nodes-base.supabase\",\n      \"position\": [\n        1900,\n        640\n      ],\n      \"parameters\": {\n        \"tableId\": \"telegram_users\",\n        \"fieldsUi\": {\n          \"fieldValues\": [\n            {\n              \"fieldId\": \"telegram_id\",\n              \"fieldValue\": \"={{ $('Get New Message').item.json.message.chat.id }}\"\n            },\n            {\n              \"fieldId\": \"openai_thread_id\",\n              \"fieldValue\": \"={{ $('OPENAI - Create thread').item.json.id }}\"\n            }\n          ]\n        }\n      },\n      \"credentials\": {\n        \"supabaseApi\": {\n          \"id\": \"QBhcokohbJHfQZ9A\",\n          \"name\": \"Supabase club\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"115e417f-5962-409b-8adf-ff236eb9ce2e\",\n      \"name\": \"Merge\",\n      \"type\": \"n8n-nodes-base.merge\",\n      \"position\": [\n        2080,\n        500\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"ba5c7385-8c80-43c8-9de2-430175bda70b\",\n      \"name\": \"OPENAI - Send message\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        2240,\n        500\n      ],\n      \"parameters\": {\n        \"url\": \"=https://api.openai.com/v1/threads/{{ $('Merge').item.json.openai_thread_id }}/messages \",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"sendBody\": true,\n        \"sendHeaders\": true,\n        \"authentication\": \"predefinedCredentialType\",\n        \"bodyParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"role\",\n              \"value\": \"user\"\n            },\n            {\n              \"name\": \"content\",\n              \"value\": \"={{ $('Get New Message').item.json.message.text }}\"\n            }\n          ]\n        },\n        \"headerParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"OpenAI-Beta\",\n              \"value\": \"assistants=v2\"\n            }\n          ]\n        },\n        \"nodeCredentialType\": \"openAiApi\"\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"fLfRtaXbR0EVD0pl\",\n          \"name\": \"OpenAi account\"\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"024832bc-3d42-4879-a57f-b23e962b4c69\",\n      \"name\": \"OPENAI - Run assistant\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        2440,\n        500\n      ],\n      \"parameters\": {\n        \"url\": \"=https://api.openai.com/v1/threads/{{ $('Merge').item.json.openai_thread_id }}/runs\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"sendBody\": true,\n        \"sendHeaders\": true,\n        \"authentication\": \"predefinedCredentialType\",\n        \"bodyParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"assistant_id\",\n              \"value\": \"asst_b0QhuzySG6jofHFdzPZD7WEz\"\n            },\n            {\n              \"name\": \"stream\",\n              \"value\": \"={{true}}\"\n            }\n          ]\n        },\n        \"headerParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"OpenAI-Beta\",\n              \"value\": \"assistants=v2\"\n            }\n          ]\n        },\n        \"nodeCredentialType\": \"openAiApi\"\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"fLfRtaXbR0EVD0pl\",\n          \"name\": \"OpenAi account\"\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"bc191e2b-15f4-45b7-af2e-19ed1639b7f5\",\n      \"name\": \"OPENAI - Get messages\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        2640,\n        500\n      ],\n      \"parameters\": {\n        \"url\": \"=https://api.openai.com/v1/threads/{{ $('Merge').item.json.openai_thread_id }}/messages\",\n        \"options\": {},\n        \"sendHeaders\": true,\n        \"authentication\": \"predefinedCredentialType\",\n        \"headerParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"OpenAI-Beta\",\n              \"value\": \"assistants=v2\"\n            }\n          ]\n        },\n        \"nodeCredentialType\": \"openAiApi\"\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"zJhr5piyEwVnWtaI\",\n          \"name\": \"OpenAi club\"\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"c22e05e5-f0a7-4a09-a864-acfc58469b30\",\n      \"name\": \"Send Message to User\",\n      \"type\": \"n8n-nodes-base.telegram\",\n      \"position\": [\n        2840,\n        500\n      ],\n      \"parameters\": {\n        \"text\": \"={{ $('OPENAI - Get messages').item.json.data[0].content[0].text.value }}\",\n        \"chatId\": \"={{ $('Get New Message').item.json.message.chat.id }}\",\n        \"additionalFields\": {\n          \"appendAttribution\": false\n        }\n      },\n      \"credentials\": {\n        \"telegramApi\": {\n          \"id\": \"rI0zyfIYVIyXt2fL\",\n          \"name\": \"Telegram Club\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"0673be1f-3cae-42a0-9c62-1ed570859043\",\n      \"name\": \"If User exists\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        1560,\n        500\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"b6e69a1f-eb42-4ef6-b80c-3167f1b8c830\",\n              \"operator\": {\n                \"type\": \"string\",\n                \"operation\": \"exists\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json.id }}\",\n              \"rightValue\": \"\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.1\n    },\n    {\n      \"id\": \"a4916f54-ae6b-495d-979b-92dca965e3bb\",\n      \"name\": \"Find User\",\n      \"type\": \"n8n-nodes-base.supabase\",\n      \"position\": [\n        1360,\n        500\n      ],\n      \"parameters\": {\n        \"filters\": {\n          \"conditions\": [\n            {\n              \"keyName\": \"telegram_id\",\n              \"keyValue\": \"={{ $json.message.chat.id }}\",\n              \"condition\": \"eq\"\n            }\n          ]\n        },\n        \"tableId\": \"telegram_users\",\n        \"operation\": \"getAll\"\n      },\n      \"credentials\": {\n        \"supabaseApi\": {\n          \"id\": \"QBhcokohbJHfQZ9A\",\n          \"name\": \"Supabase club\"\n        }\n      },\n      \"typeVersion\": 1,\n      \"alwaysOutputData\": true\n    },\n    {\n      \"id\": \"6d01d7ed-e96b-47cf-9a5f-46608031baa2\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1300,\n        800\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 600.723278204605,\n        \"height\": 213.15921994594194,\n        \"content\": \"在Supabase中创建表的SQL查询：\\n\\n```\\n创建表\\n  公共.telegram用户 (\\n    id uuid 非空 默认 gen_random_uuid (),\\n    创建日期 带时区的时间戳 非空 默认 (当前时间 at time zone 'utc'::text),\\n    telegram_id 大整数 可空,\\n    openai_thread_id 文本 可空,\\n    约束 telegram_users_pkey 主键 (id)\\n  ) 表空间 pg_default;\\n```\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"1a996da0-6022-48d7-ba40-1d137547a3d7\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        2340,\n        360\n      ],\n      \"parameters\": {\n        \"color\": 3,\n        \"width\": 282.075050779723,\n        \"height\": 80,\n        \"content\": \"在[OpenAI](https://platform.openai.com/assistants)平台创建助手。\\n\\n**在此处指定您自己的助手ID**\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"b24d2008-7950-41f0-a7fa-50360c0c6854\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1040,\n        380\n      ],\n      \"parameters\": {\n        \"color\": 3,\n        \"width\": 235.09282368774151,\n        \"height\": 80,\n        \"content\": \"在[Botfather机器人](https://t.me/botfather)中创建自己的Telegram机器人\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"9eb2491e-5ad9-4015-8ed9-611e72924503\",\n      \"name\": \"Sticky Note4\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1300,\n        680\n      ],\n      \"parameters\": {\n        \"color\": 3,\n        \"height\": 80,\n        \"content\": \"在[Supabase](https://supabase.com)中使用SQL查询创建表\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"884b5a1b-007c-4752-becc-46c8fc58db92\",\n      \"name\": \"Sticky Note5\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        200,\n        120\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 280.2462120317618,\n        \"height\": 438.5821431288714,\n        \"content\": \"### 设置步骤  \\n1. **创建Telegram机器人**  \\n   通过[Botfather](https://t.me/botfather)创建机器人并获取机器人令牌。  \\n\\n2. **配置Supabase数据库**  \\n   ① 新建项目，生成```SUPABASE_URL```和```SUPABASE_KEY```  \\n   ② 执行以下SQL语句创建```telegram_users```表：  \\n```sql\\ncreate table\\n  public.telegram_users (\\n    id uuid not null default gen_random_uuid (),\\n    date_created timestamp with time zone not null default (now() at time zone 'utc'::text),\\n    telegram_id bigint null,\\n    openai_thread_id text null,\\n    constraint telegram_users_pkey primary key (id)\\n  tablespace pg_default;\\n```\\n\\n3. **OpenAI配置**  \\n   ① 创建OpenAI助手并获取```OPENAI_API_KEY```  \\n   ② 根据需求自定义助手个性或使用场景  \\n\\n4. **n8n环境配置**  \\n   ① 在对应节点配置Telegram、Supabase和OpenAI的凭证  \\n   ② 设置消息接收触发器及会话逻辑处理  \\n   ③ 在\\\"++OPENAI - 运行助手++\\\"节点中配置OpenAI助手ID\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"02db77ac-4909-4a56-a558-03c86d8b8552\",\n      \"name\": \"Sticky Note6\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        200,\n        -400\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 636.2128494576581,\n        \"height\": 494.9629292914819,\n        \"content\": \"![5min 标志](https://cflobdhpqwnoisuctsoc.supabase.co/storage/v1/object/public/my_storage/Untitled%20(1500%20x%20300%20px).png)\\n## 搭载Supabase记忆功能的AI电报机器人\\n**由[5minAI社区](https://www.skool.com/5minai-2861)的[马克·谢尔巴科夫](https://www.linkedin.com/in/marklowcoding/)开发**\\n\\n许多简易聊天机器人缺乏上下文感知和用户记忆功能。本解决方案通过集成Supabase来追踪用户会话（通过```telegram_id```和```openai_thread_id```），使机器人能够保持对话的连续性和上下文，从而提供更拟人化、更具吸引力的交互体验。\\n\\n该电报机器人模板连接OpenAI处理用户查询，同时通过Supabase数据库存储和检索用户信息。记忆组件确保机器人能追溯历史对话，非常适合需要保持上下文的应用场景，如客户支持、虚拟助手等关键领域。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"a991a7c9-ea5f-4a25-aa92-6dc2fce11b05\",\n      \"name\": \"Sticky Note7\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        500,\n        120\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 330.5152611046425,\n        \"height\": 240.6839895136402,\n        \"content\": \"### ...或观看安装视频 [5分钟]\\n[![YouTube缩略图](https://cflobdhpqwnoisuctsoc.supabase.co/storage/v1/object/public/my_storage/Youtube%20thumb%20(3).png)](https://www.youtube.com/watch?v=kS41gut8l0g)\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"pinData\": {\n    \"Merge\": [\n      {\n        \"id\": \"4a5d71a4-a2f7-43e2-936f-37ee5bf5cc9e\",\n        \"telegram_id\": 1468754364,\n        \"date_created\": \"2024-10-04T08:29:07.458869+00:00\",\n        \"openai_thread_id\": null\n      }\n    ],\n    \"Find User\": [\n      {\n        \"id\": \"4a5d71a4-a2f7-43e2-936f-37ee5bf5cc9e\",\n        \"telegram_id\": 1468754364,\n        \"date_created\": \"2024-10-04T08:29:07.458869+00:00\",\n        \"openai_thread_id\": null\n      }\n    ],\n    \"Get New Message\": [\n      {\n        \"message\": {\n          \"chat\": {\n            \"id\": 1468754364,\n            \"type\": \"private\",\n            \"username\": \"low_code\",\n            \"first_name\": \"Mark\"\n          },\n          \"date\": 1727961249,\n          \"from\": {\n            \"id\": 1468754364,\n            \"is_bot\": false,\n            \"username\": \"low_code\",\n            \"first_name\": \"Mark\",\n            \"language_code\": \"en\"\n          },\n          \"text\": \"Hello, how are you?\",\n          \"entities\": [\n            {\n              \"type\": \"bot_command\",\n              \"length\": 6,\n              \"offset\": 0\n            }\n          ],\n          \"message_id\": 3\n        },\n        \"update_id\": 412281353\n      }\n    ],\n    \"Send Message to User\": [\n      {\n        \"ok\": true,\n        \"result\": {\n          \"chat\": {\n            \"id\": 1468754364,\n            \"type\": \"private\",\n            \"username\": \"low_code\",\n            \"first_name\": \"Mark\"\n          },\n          \"date\": 1727971919,\n          \"from\": {\n            \"id\": 7999029315,\n            \"is_bot\": true,\n            \"username\": \"test241234_bot\",\n            \"first_name\": \"Test bot\"\n          },\n          \"text\": \"Hello! I'm just a program, but I'm here and ready to help you. How can I assist you today?\",\n          \"message_id\": 7\n        }\n      }\n    ],\n    \"OPENAI - Get messages\": [\n      {\n        \"data\": [\n          {\n            \"id\": \"msg_C7aXbSotAl6xCxjR9avi4wUz\",\n            \"role\": \"assistant\",\n            \"object\": \"thread.message\",\n            \"run_id\": \"run_9avgP4lZ1FRSsL3y9UO8HPa1\",\n            \"content\": [\n              {\n                \"text\": {\n                  \"value\": \"Hello! I'm just a program, but I'm here and ready to help you. How can I assist you today?\",\n                  \"annotations\": []\n                },\n                \"type\": \"text\"\n              }\n            ],\n            \"metadata\": {},\n            \"thread_id\": \"thread_laO8JLPW6L1upYHW6fSRj8Bt\",\n            \"created_at\": 1727971739,\n            \"attachments\": [],\n            \"assistant_id\": \"asst_b0QhuzySG6jofHFdzPZD7WEz\"\n          },\n          {\n            \"id\": \"msg_fVGPVHR03QKheHXh54SFpmpm\",\n            \"role\": \"user\",\n            \"object\": \"thread.message\",\n            \"run_id\": null,\n            \"content\": [\n              {\n                \"text\": {\n                  \"value\": \"Hello, how are you?\",\n                  \"annotations\": []\n                },\n                \"type\": \"text\"\n              }\n            ],\n            \"metadata\": {},\n            \"thread_id\": \"thread_laO8JLPW6L1upYHW6fSRj8Bt\",\n            \"created_at\": 1727971467,\n            \"attachments\": [],\n            \"assistant_id\": null\n          }\n        ],\n        \"object\": \"list\",\n        \"last_id\": \"msg_fVGPVHR03QKheHXh54SFpmpm\",\n        \"first_id\": \"msg_C7aXbSotAl6xCxjR9avi4wUz\",\n        \"has_more\": false\n      }\n    ],\n    \"OPENAI - Send message\": [\n      {\n        \"id\": \"msg_fVGPVHR03QKheHXh54SFpmpm\",\n        \"role\": \"user\",\n        \"object\": \"thread.message\",\n        \"run_id\": null,\n        \"content\": [\n          {\n            \"text\": {\n              \"value\": \"Hello, how are you?\",\n              \"annotations\": []\n            },\n            \"type\": \"text\"\n          }\n        ],\n        \"metadata\": {},\n        \"thread_id\": \"thread_laO8JLPW6L1upYHW6fSRj8Bt\",\n        \"created_at\": 1727971467,\n        \"attachments\": [],\n        \"assistant_id\": null\n      }\n    ],\n    \"OPENAI - Create thread\": [\n      {\n        \"id\": \"thread_laO8JLPW6L1upYHW6fSRj8Bt\",\n        \"object\": \"thread\",\n        \"metadata\": {},\n        \"created_at\": 1727971362,\n        \"tool_resources\": {}\n      }\n    ],\n    \"OPENAI - Run assistant\": [\n      {\n        \"data\": \"event: thread.run.created\\ndata: {\\\"id\\\":\\\"run_9avgP4lZ1FRSsL3y9UO8HPa1\\\",\\\"object\\\":\\\"thread.run\\\",\\\"created_at\\\":1727971737,\\\"assistant_id\\\":\\\"asst_b0QhuzySG6jofHFdzPZD7WEz\\\",\\\"thread_id\\\":\\\"thread_laO8JLPW6L1upYHW6fSRj8Bt\\\",\\\"status\\\":\\\"queued\\\",\\\"started_at\\\":null,\\\"expires_at\\\":1727972337,\\\"cancelled_at\\\":null,\\\"failed_at\\\":null,\\\"completed_at\\\":null,\\\"required_action\\\":null,\\\"last_error\\\":null,\\\"model\\\":\\\"gpt-4o-mini\\\",\\\"instructions\\\":\\\"You are ChatGPT\\\",\\\"tools\\\":[],\\\"tool_resources\\\":{\\\"code_interpreter\\\":{\\\"file_ids\\\":[]}},\\\"metadata\\\":{},\\\"temperature\\\":1.0,\\\"top_p\\\":1.0,\\\"max_completion_tokens\\\":null,\\\"max_prompt_tokens\\\":null,\\\"truncation_strategy\\\":{\\\"type\\\":\\\"auto\\\",\\\"last_messages\\\":null},\\\"incomplete_details\\\":null,\\\"usage\\\":null,\\\"response_format\\\":\\\"auto\\\",\\\"tool_choice\\\":\\\"auto\\\",\\\"parallel_tool_calls\\\":true}\\n\\nevent: thread.run.queued\\ndata: {\\\"id\\\":\\\"run_9avgP4lZ1FRSsL3y9UO8HPa1\\\",\\\"object\\\":\\\"thread.run\\\",\\\"created_at\\\":1727971737,\\\"assistant_id\\\":\\\"asst_b0QhuzySG6jofHFdzPZD7WEz\\\",\\\"thread_id\\\":\\\"thread_laO8JLPW6L1upYHW6fSRj8Bt\\\",\\\"status\\\":\\\"queued\\\",\\\"started_at\\\":null,\\\"expires_at\\\":1727972337,\\\"cancelled_at\\\":null,\\\"failed_at\\\":null,\\\"completed_at\\\":null,\\\"required_action\\\":null,\\\"last_error\\\":null,\\\"model\\\":\\\"gpt-4o-mini\\\",\\\"instructions\\\":\\\"You are ChatGPT\\\",\\\"tools\\\":[],\\\"tool_resources\\\":{\\\"code_interpreter\\\":{\\\"file_ids\\\":[]}},\\\"metadata\\\":{},\\\"temperature\\\":1.0,\\\"top_p\\\":1.0,\\\"max_completion_tokens\\\":null,\\\"max_prompt_tokens\\\":null,\\\"truncation_strategy\\\":{\\\"type\\\":\\\"auto\\\",\\\"last_messages\\\":null},\\\"incomplete_details\\\":null,\\\"usage\\\":null,\\\"response_format\\\":\\\"auto\\\",\\\"tool_choice\\\":\\\"auto\\\",\\\"parallel_tool_calls\\\":true}\\n\\nevent: thread.run.in_progress\\ndata: {\\\"id\\\":\\\"run_9avgP4lZ1FRSsL3y9UO8HPa1\\\",\\\"object\\\":\\\"thread.run\\\",\\\"created_at\\\":1727971737,\\\"assistant_id\\\":\\\"asst_b0QhuzySG6jofHFdzPZD7WEz\\\",\\\"thread_id\\\":\\\"thread_laO8JLPW6L1upYHW6fSRj8Bt\\\",\\\"status\\\":\\\"in_progress\\\",\\\"started_at\\\":1727971738,\\\"expires_at\\\":1727972337,\\\"cancelled_at\\\":null,\\\"failed_at\\\":null,\\\"completed_at\\\":null,\\\"required_action\\\":null,\\\"last_error\\\":null,\\\"model\\\":\\\"gpt-4o-mini\\\",\\\"instructions\\\":\\\"You are ChatGPT\\\",\\\"tools\\\":[],\\\"tool_resources\\\":{\\\"code_interpreter\\\":{\\\"file_ids\\\":[]}},\\\"metadata\\\":{},\\\"temperature\\\":1.0,\\\"top_p\\\":1.0,\\\"max_completion_tokens\\\":null,\\\"max_prompt_tokens\\\":null,\\\"truncation_strategy\\\":{\\\"type\\\":\\\"auto\\\",\\\"last_messages\\\":null},\\\"incomplete_details\\\":null,\\\"usage\\\":null,\\\"response_format\\\":\\\"auto\\\",\\\"tool_choice\\\":\\\"auto\\\",\\\"parallel_tool_calls\\\":true}\\n\\nevent: thread.run.step.created\\ndata: {\\\"id\\\":\\\"step_b0iFvL1q1UEZDfBRbbNTiulO\\\",\\\"object\\\":\\\"thread.run.step\\\",\\\"created_at\\\":1727971739,\\\"run_id\\\":\\\"run_9avgP4lZ1FRSsL3y9UO8HPa1\\\",\\\"assistant_id\\\":\\\"asst_b0QhuzySG6jofHFdzPZD7WEz\\\",\\\"thread_id\\\":\\\"thread_laO8JLPW6L1upYHW6fSRj8Bt\\\",\\\"type\\\":\\\"message_creation\\\",\\\"status\\\":\\\"in_progress\\\",\\\"cancelled_at\\\":null,\\\"completed_at\\\":null,\\\"expires_at\\\":1727972337,\\\"failed_at\\\":null,\\\"last_error\\\":null,\\\"step_details\\\":{\\\"type\\\":\\\"message_creation\\\",\\\"message_creation\\\":{\\\"message_id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\"}},\\\"usage\\\":null}\\n\\nevent: thread.run.step.in_progress\\ndata: {\\\"id\\\":\\\"step_b0iFvL1q1UEZDfBRbbNTiulO\\\",\\\"object\\\":\\\"thread.run.step\\\",\\\"created_at\\\":1727971739,\\\"run_id\\\":\\\"run_9avgP4lZ1FRSsL3y9UO8HPa1\\\",\\\"assistant_id\\\":\\\"asst_b0QhuzySG6jofHFdzPZD7WEz\\\",\\\"thread_id\\\":\\\"thread_laO8JLPW6L1upYHW6fSRj8Bt\\\",\\\"type\\\":\\\"message_creation\\\",\\\"status\\\":\\\"in_progress\\\",\\\"cancelled_at\\\":null,\\\"completed_at\\\":null,\\\"expires_at\\\":1727972337,\\\"failed_at\\\":null,\\\"last_error\\\":null,\\\"step_details\\\":{\\\"type\\\":\\\"message_creation\\\",\\\"message_creation\\\":{\\\"message_id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\"}},\\\"usage\\\":null}\\n\\nevent: thread.message.created\\ndata: {\\\"id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\",\\\"object\\\":\\\"thread.message\\\",\\\"created_at\\\":1727971739,\\\"assistant_id\\\":\\\"asst_b0QhuzySG6jofHFdzPZD7WEz\\\",\\\"thread_id\\\":\\\"thread_laO8JLPW6L1upYHW6fSRj8Bt\\\",\\\"run_id\\\":\\\"run_9avgP4lZ1FRSsL3y9UO8HPa1\\\",\\\"status\\\":\\\"in_progress\\\",\\\"incomplete_details\\\":null,\\\"incomplete_at\\\":null,\\\"completed_at\\\":null,\\\"role\\\":\\\"assistant\\\",\\\"content\\\":[],\\\"attachments\\\":[],\\\"metadata\\\":{}}\\n\\nevent: thread.message.in_progress\\ndata: {\\\"id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\",\\\"object\\\":\\\"thread.message\\\",\\\"created_at\\\":1727971739,\\\"assistant_id\\\":\\\"asst_b0QhuzySG6jofHFdzPZD7WEz\\\",\\\"thread_id\\\":\\\"thread_laO8JLPW6L1upYHW6fSRj8Bt\\\",\\\"run_id\\\":\\\"run_9avgP4lZ1FRSsL3y9UO8HPa1\\\",\\\"status\\\":\\\"in_progress\\\",\\\"incomplete_details\\\":null,\\\"incomplete_at\\\":null,\\\"completed_at\\\":null,\\\"role\\\":\\\"assistant\\\",\\\"content\\\":[],\\\"attachments\\\":[],\\\"metadata\\\":{}}\\n\\nevent: thread.message.delta\\ndata: {\\\"id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\",\\\"object\\\":\\\"thread.message.delta\\\",\\\"delta\\\":{\\\"content\\\":[{\\\"index\\\":0,\\\"type\\\":\\\"text\\\",\\\"text\\\":{\\\"value\\\":\\\"Hello\\\",\\\"annotations\\\":[]}}]}}\\n\\nevent: thread.message.delta\\ndata: {\\\"id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\",\\\"object\\\":\\\"thread.message.delta\\\",\\\"delta\\\":{\\\"content\\\":[{\\\"index\\\":0,\\\"type\\\":\\\"text\\\",\\\"text\\\":{\\\"value\\\":\\\"!\\\"}}]}}\\n\\nevent: thread.message.delta\\ndata: {\\\"id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\",\\\"object\\\":\\\"thread.message.delta\\\",\\\"delta\\\":{\\\"content\\\":[{\\\"index\\\":0,\\\"type\\\":\\\"text\\\",\\\"text\\\":{\\\"value\\\":\\\" I'm\\\"}}]}}\\n\\nevent: thread.message.delta\\ndata: {\\\"id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\",\\\"object\\\":\\\"thread.message.delta\\\",\\\"delta\\\":{\\\"content\\\":[{\\\"index\\\":0,\\\"type\\\":\\\"text\\\",\\\"text\\\":{\\\"value\\\":\\\" just\\\"}}]}}\\n\\nevent: thread.message.delta\\ndata: {\\\"id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\",\\\"object\\\":\\\"thread.message.delta\\\",\\\"delta\\\":{\\\"content\\\":[{\\\"index\\\":0,\\\"type\\\":\\\"text\\\",\\\"text\\\":{\\\"value\\\":\\\" a\\\"}}]}}\\n\\nevent: thread.message.delta\\ndata: {\\\"id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\",\\\"object\\\":\\\"thread.message.delta\\\",\\\"delta\\\":{\\\"content\\\":[{\\\"index\\\":0,\\\"type\\\":\\\"text\\\",\\\"text\\\":{\\\"value\\\":\\\" program\\\"}}]}}\\n\\nevent: thread.message.delta\\ndata: {\\\"id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\",\\\"object\\\":\\\"thread.message.delta\\\",\\\"delta\\\":{\\\"content\\\":[{\\\"index\\\":0,\\\"type\\\":\\\"text\\\",\\\"text\\\":{\\\"value\\\":\\\",\\\"}}]}}\\n\\nevent: thread.message.delta\\ndata: {\\\"id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\",\\\"object\\\":\\\"thread.message.delta\\\",\\\"delta\\\":{\\\"content\\\":[{\\\"index\\\":0,\\\"type\\\":\\\"text\\\",\\\"text\\\":{\\\"value\\\":\\\" but\\\"}}]}}\\n\\nevent: thread.message.delta\\ndata: {\\\"id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\",\\\"object\\\":\\\"thread.message.delta\\\",\\\"delta\\\":{\\\"content\\\":[{\\\"index\\\":0,\\\"type\\\":\\\"text\\\",\\\"text\\\":{\\\"value\\\":\\\" I'm\\\"}}]}}\\n\\nevent: thread.message.delta\\ndata: {\\\"id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\",\\\"object\\\":\\\"thread.message.delta\\\",\\\"delta\\\":{\\\"content\\\":[{\\\"index\\\":0,\\\"type\\\":\\\"text\\\",\\\"text\\\":{\\\"value\\\":\\\" here\\\"}}]}}\\n\\nevent: thread.message.delta\\ndata: {\\\"id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\",\\\"object\\\":\\\"thread.message.delta\\\",\\\"delta\\\":{\\\"content\\\":[{\\\"index\\\":0,\\\"type\\\":\\\"text\\\",\\\"text\\\":{\\\"value\\\":\\\" and\\\"}}]}}\\n\\nevent: thread.message.delta\\ndata: {\\\"id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\",\\\"object\\\":\\\"thread.message.delta\\\",\\\"delta\\\":{\\\"content\\\":[{\\\"index\\\":0,\\\"type\\\":\\\"text\\\",\\\"text\\\":{\\\"value\\\":\\\" ready\\\"}}]}}\\n\\nevent: thread.message.delta\\ndata: {\\\"id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\",\\\"object\\\":\\\"thread.message.delta\\\",\\\"delta\\\":{\\\"content\\\":[{\\\"index\\\":0,\\\"type\\\":\\\"text\\\",\\\"text\\\":{\\\"value\\\":\\\" to\\\"}}]}}\\n\\nevent: thread.message.delta\\ndata: {\\\"id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\",\\\"object\\\":\\\"thread.message.delta\\\",\\\"delta\\\":{\\\"content\\\":[{\\\"index\\\":0,\\\"type\\\":\\\"text\\\",\\\"text\\\":{\\\"value\\\":\\\" help\\\"}}]}}\\n\\nevent: thread.message.delta\\ndata: {\\\"id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\",\\\"object\\\":\\\"thread.message.delta\\\",\\\"delta\\\":{\\\"content\\\":[{\\\"index\\\":0,\\\"type\\\":\\\"text\\\",\\\"text\\\":{\\\"value\\\":\\\" you\\\"}}]}}\\n\\nevent: thread.message.delta\\ndata: {\\\"id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\",\\\"object\\\":\\\"thread.message.delta\\\",\\\"delta\\\":{\\\"content\\\":[{\\\"index\\\":0,\\\"type\\\":\\\"text\\\",\\\"text\\\":{\\\"value\\\":\\\".\\\"}}]}}\\n\\nevent: thread.message.delta\\ndata: {\\\"id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\",\\\"object\\\":\\\"thread.message.delta\\\",\\\"delta\\\":{\\\"content\\\":[{\\\"index\\\":0,\\\"type\\\":\\\"text\\\",\\\"text\\\":{\\\"value\\\":\\\" How\\\"}}]}}\\n\\nevent: thread.message.delta\\ndata: {\\\"id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\",\\\"object\\\":\\\"thread.message.delta\\\",\\\"delta\\\":{\\\"content\\\":[{\\\"index\\\":0,\\\"type\\\":\\\"text\\\",\\\"text\\\":{\\\"value\\\":\\\" can\\\"}}]}}\\n\\nevent: thread.message.delta\\ndata: {\\\"id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\",\\\"object\\\":\\\"thread.message.delta\\\",\\\"delta\\\":{\\\"content\\\":[{\\\"index\\\":0,\\\"type\\\":\\\"text\\\",\\\"text\\\":{\\\"value\\\":\\\" I\\\"}}]}}\\n\\nevent: thread.message.delta\\ndata: {\\\"id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\",\\\"object\\\":\\\"thread.message.delta\\\",\\\"delta\\\":{\\\"content\\\":[{\\\"index\\\":0,\\\"type\\\":\\\"text\\\",\\\"text\\\":{\\\"value\\\":\\\" assist\\\"}}]}}\\n\\nevent: thread.message.delta\\ndata: {\\\"id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\",\\\"object\\\":\\\"thread.message.delta\\\",\\\"delta\\\":{\\\"content\\\":[{\\\"index\\\":0,\\\"type\\\":\\\"text\\\",\\\"text\\\":{\\\"value\\\":\\\" you\\\"}}]}}\\n\\nevent: thread.message.delta\\ndata: {\\\"id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\",\\\"object\\\":\\\"thread.message.delta\\\",\\\"delta\\\":{\\\"content\\\":[{\\\"index\\\":0,\\\"type\\\":\\\"text\\\",\\\"text\\\":{\\\"value\\\":\\\" today\\\"}}]}}\\n\\nevent: thread.message.delta\\ndata: {\\\"id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\",\\\"object\\\":\\\"thread.message.delta\\\",\\\"delta\\\":{\\\"content\\\":[{\\\"index\\\":0,\\\"type\\\":\\\"text\\\",\\\"text\\\":{\\\"value\\\":\\\"?\\\"}}]}}\\n\\nevent: thread.message.completed\\ndata: {\\\"id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\",\\\"object\\\":\\\"thread.message\\\",\\\"created_at\\\":1727971739,\\\"assistant_id\\\":\\\"asst_b0QhuzySG6jofHFdzPZD7WEz\\\",\\\"thread_id\\\":\\\"thread_laO8JLPW6L1upYHW6fSRj8Bt\\\",\\\"run_id\\\":\\\"run_9avgP4lZ1FRSsL3y9UO8HPa1\\\",\\\"status\\\":\\\"completed\\\",\\\"incomplete_details\\\":null,\\\"incomplete_at\\\":null,\\\"completed_at\\\":1727971740,\\\"role\\\":\\\"assistant\\\",\\\"content\\\":[{\\\"type\\\":\\\"text\\\",\\\"text\\\":{\\\"value\\\":\\\"Hello! I'm just a program, but I'm here and ready to help you. How can I assist you today?\\\",\\\"annotations\\\":[]}}],\\\"attachments\\\":[],\\\"metadata\\\":{}}\\n\\nevent: thread.run.step.completed\\ndata: {\\\"id\\\":\\\"step_b0iFvL1q1UEZDfBRbbNTiulO\\\",\\\"object\\\":\\\"thread.run.step\\\",\\\"created_at\\\":1727971739,\\\"run_id\\\":\\\"run_9avgP4lZ1FRSsL3y9UO8HPa1\\\",\\\"assistant_id\\\":\\\"asst_b0QhuzySG6jofHFdzPZD7WEz\\\",\\\"thread_id\\\":\\\"thread_laO8JLPW6L1upYHW6fSRj8Bt\\\",\\\"type\\\":\\\"message_creation\\\",\\\"status\\\":\\\"completed\\\",\\\"cancelled_at\\\":null,\\\"completed_at\\\":1727971740,\\\"expires_at\\\":1727972337,\\\"failed_at\\\":null,\\\"last_error\\\":null,\\\"step_details\\\":{\\\"type\\\":\\\"message_creation\\\",\\\"message_creation\\\":{\\\"message_id\\\":\\\"msg_C7aXbSotAl6xCxjR9avi4wUz\\\"}},\\\"usage\\\":{\\\"prompt_tokens\\\":39,\\\"completion_tokens\\\":25,\\\"total_tokens\\\":64}}\\n\\nevent: thread.run.completed\\ndata: {\\\"id\\\":\\\"run_9avgP4lZ1FRSsL3y9UO8HPa1\\\",\\\"object\\\":\\\"thread.run\\\",\\\"created_at\\\":1727971737,\\\"assistant_id\\\":\\\"asst_b0QhuzySG6jofHFdzPZD7WEz\\\",\\\"thread_id\\\":\\\"thread_laO8JLPW6L1upYHW6fSRj8Bt\\\",\\\"status\\\":\\\"completed\\\",\\\"started_at\\\":1727971738,\\\"expires_at\\\":null,\\\"cancelled_at\\\":null,\\\"failed_at\\\":null,\\\"completed_at\\\":1727971740,\\\"required_action\\\":null,\\\"last_error\\\":null,\\\"model\\\":\\\"gpt-4o-mini\\\",\\\"instructions\\\":\\\"You are ChatGPT\\\",\\\"tools\\\":[],\\\"tool_resources\\\":{\\\"code_interpreter\\\":{\\\"file_ids\\\":[]}},\\\"metadata\\\":{},\\\"temperature\\\":1.0,\\\"top_p\\\":1.0,\\\"max_completion_tokens\\\":null,\\\"max_prompt_tokens\\\":null,\\\"truncation_strategy\\\":{\\\"type\\\":\\\"auto\\\",\\\"last_messages\\\":null},\\\"incomplete_details\\\":null,\\\"usage\\\":{\\\"prompt_tokens\\\":39,\\\"completion_tokens\\\":25,\\\"total_tokens\\\":64},\\\"response_format\\\":\\\"auto\\\",\\\"tool_choice\\\":\\\"auto\\\",\\\"parallel_tool_calls\\\":true}\\n\\nevent: done\\ndata: [DONE]\\n\\n\"\n      }\n    ]\n  },\n  \"connections\": {\n    \"Merge\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"OPENAI - Send message\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Find User\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"If User exists\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Create User\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge\",\n            \"type\": \"main\",\n            \"index\": 1\n          }\n        ]\n      ]\n    },\n    \"If User exists\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"OPENAI - Create thread\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get New Message\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Find User\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"OPENAI - Get messages\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Send Message to User\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"OPENAI - Send message\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"OPENAI - Run assistant\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"OPENAI - Create thread\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Create User\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"OPENAI - Run assistant\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"OPENAI - Get messages\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}