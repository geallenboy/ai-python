{
  "url": "https://n8n.io/workflows/694-transform-data-in-google-sheets/",
  "title": "Transform data in Google Sheets",
  "author": "Harshil Agrawal",
  "publish_date": "Last update 10 months ago",
  "publish_date_absolute": "2024-07-25",
  "categories": [
    {
      "name": "Building Blocks"
    }
  ],
  "workflow_json": "{\"id\":\"5\",\"name\":\"Append, lookup, update, and read data from a Google Sheets spreadsheet\",\"nodes\":[{\"name\":\"On clicking 'execute'\",\"type\":\"n8n-nodes-base.manualTrigger\",\"position\":[450,450],\"parameters\":{},\"typeVersion\":1},{\"name\":\"Google Sheets2\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[1450,450],\"parameters\":{\"key\":\"ID\",\"range\":\"A:D\",\"options\":{\"valueInputMode\":\"USER_ENTERED\",\"valueRenderMode\":\"UNFORMATTED_VALUE\"},\"sheetId\":\"1remFwo--5ehUgIU7UUndKldPI0Xm93e1T3DldD9GOg0\",\"operation\":\"update\",\"authentication\":\"oAuth2\"},\"credentials\":{\"googleSheetsOAuth2Api\":\"google-sheet\"},\"typeVersion\":1},{\"name\":\"Set1\",\"type\":\"n8n-nodes-base.set\",\"position\":[1250,450],\"parameters\":{\"values\":{\"number\":[{\"name\":\"Rent\",\"value\":\"={{$node[\\\"Google Sheets1\\\"].json[\\\"Rent\\\"]+100}}\"},{\"name\":\"ID\",\"value\":\"={{$node[\\\"Google Sheets1\\\"].json[\\\"ID\\\"]}}\"}],\"string\":[{\"name\":\"Name\",\"value\":\"={{$node[\\\"Google Sheets1\\\"].json[\\\"Name\\\"]}}\"},{\"name\":\"City\",\"value\":\"={{$node[\\\"Google Sheets1\\\"].json[\\\"City\\\"]}}\"}]},\"options\":{},\"keepOnlySet\":true},\"typeVersion\":1},{\"name\":\"Google Sheets1\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[1050,450],\"parameters\":{\"range\":\"A:D\",\"options\":{\"valueRenderMode\":\"UNFORMATTED_VALUE\",\"returnAllMatches\":true},\"sheetId\":\"1remFwo--5ehUgIU7UUndKldPI0Xm93e1T3DldD9GOg0\",\"operation\":\"lookup\",\"lookupValue\":\"Berlin\",\"lookupColumn\":\"City\",\"authentication\":\"oAuth2\"},\"credentials\":{\"googleSheetsOAuth2Api\":\"google-sheet\"},\"typeVersion\":1},{\"name\":\"Google Sheets\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[850,450],\"parameters\":{\"range\":\"A:D\",\"options\":{\"valueInputMode\":\"USER_ENTERED\"},\"sheetId\":\"1remFwo--5ehUgIU7UUndKldPI0Xm93e1T3DldD9GOg0\",\"operation\":\"append\",\"authentication\":\"oAuth2\"},\"credentials\":{\"googleSheetsOAuth2Api\":\"google-sheet\"},\"typeVersion\":1},{\"name\":\"Google Sheets3\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[1650,450],\"parameters\":{\"range\":\"A:D\",\"options\":{\"valueRenderMode\":\"FORMATTED_VALUE\"},\"sheetId\":\"1remFwo--5ehUgIU7UUndKldPI0Xm93e1T3DldD9GOg0\",\"authentication\":\"oAuth2\"},\"credentials\":{\"googleSheetsOAuth2Api\":\"google-sheet\"},\"typeVersion\":1},{\"name\":\"Set\",\"type\":\"n8n-nodes-base.set\",\"position\":[650,450],\"parameters\":{\"values\":{\"number\":[{\"name\":\"ID\",\"value\":\"={{Math.floor(Math.random()*1000)}}\"}],\"string\":[{\"name\":\"Name\",\"value\":\"John's Place\"},{\"name\":\"Rent\",\"value\":\"$1,000\"},{\"name\":\"City\",\"value\":\"Berlin\"}]},\"options\":{},\"keepOnlySet\":true},\"typeVersion\":1}],\"active\":false,\"settings\":{},\"connections\":{\"Set\":{\"main\":[[{\"node\":\"Google Sheets\",\"type\":\"main\",\"index\":0}]]},\"Set1\":{\"main\":[[{\"node\":\"Google Sheets2\",\"type\":\"main\",\"index\":0}]]},\"Google Sheets\":{\"main\":[[{\"node\":\"Google Sheets1\",\"type\":\"main\",\"index\":0}]]},\"Google Sheets1\":{\"main\":[[{\"node\":\"Set1\",\"type\":\"main\",\"index\":0}]]},\"Google Sheets2\":{\"main\":[[{\"node\":\"Google Sheets3\",\"type\":\"main\",\"index\":0}]]},\"On clicking 'execute'\":{\"main\":[[{\"node\":\"Set\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "This workflow appends, lookup, updates, and reads data from a Google Sheet spreadsheet.\n\n**Set node:** The Set node is used to generate data that we want to add to Google Sheets. Depending on your use-case you might have data coming from a different source. For example, you might be fetching data from a WebHook call. Add the node that will fetch the data that you want to add to the Google Sheet.  \nUse can then use the Set node to set the data that you want to add to the Google Sheets.\n\n**Google Sheets node:** This node will add the data from the Set node in a new row to the Google Sheet. You will have to enter the Spreadsheet ID and the Range to specify which sheet you want to add the data to.\n\n**Google Sheets1 node:** This node looks for a specific value in the Google Sheet and returns all the rows that contain the value. In this example, we are looking for the value Berlin in our Google Sheet. If you want to look for a different value, enter that value in the _**Lookup Value**_ field, and specify the column in the _**Lookup Column**_ field.\n\n**Set1 node:** The Set node sets the value of the rent by $100 for the houses in Berlin. We pass this new data to the next nodes in the workflow.\n\n**Google Sheets2 node:** This node will update the rent for the houses in Berlin with the new rent set in the previous node. We are mapping the rows with their ID. Depending on your use-case, you might want to map the values with a different column. To set this enter the column name in the _**Key**_ field.\n\n**Google Sheets3 node:** This node returns the information from the Google Sheet. You can specify the columns that should get returned in the _**Range**_ field. Currently, the node fetches the data for columns A to D. To fetch the data only for columns A to C set the range to `A:C`.\n\nThis workflow can be broken down into different workflows each with its own use case. For example, we can have a workflow that appends new data to a Google Sheet, and another workflow that lookups for a certain value and returns that value.\n\nYou can learn to build this workflow on the documentation page of the [Google Sheets](https://docs.n8n.io/nodes/n8n-nodes-base.googleSheets/#google-sheets) node.\n",
  "crawled_at": "2025-05-25T18:38:17.948084",
  "readme_zh": "该工作流实现了向Google Sheets电子表格追加、查询、更新及读取数据的操作。\n\n**Set节点：** 用于生成待添加至Google Sheets的数据。根据实际场景，数据可能来自不同来源（例如通过WebHook调用获取）。添加相应节点获取数据后，可通过Set节点设定待写入Google Sheets的数据内容。\n\n**Google Sheets节点：** 将Set节点的数据作为新行追加至指定电子表格。需填写Spreadsheet ID和Range参数以定位目标工作表。\n\n**Google Sheets1节点：** 在电子表格中搜索特定值并返回包含该值的所有行。本示例以\"Berlin\"为搜索值，用户可通过_**Lookup Value**_字段修改搜索值，并在_**Lookup Column**_字段指定搜索列。\n\n**Set1节点：** 将柏林地区房屋租金统一上调100美元，并将新数据传递至后续节点。\n\n**Google Sheets2节点：** 根据前序节点设定的新租金值，更新柏林地区房屋数据。系统默认通过ID列匹配行记录，用户可通过_**Key**_字段指定其他匹配列。\n\n**Google Sheets3节点：** 从电子表格返回指定列数据。当前配置（A:D）返回A至D列数据，若需调整为A至C列，可将range参数修改为`A:C`。\n\n该工作流可拆分为多个独立场景的子工作流，例如：实现数据追加的独立工作流，或专用于特定值查询返回的工作流。\n\n具体构建方法可参阅[Google Sheets节点](https://docs.n8n.io/nodes/n8n-nodes-base.googleSheets/#google-sheets)的官方文档页面。",
  "title_zh": "在Google表格中转换数据",
  "publish_date_zh": "最后更新于10个月前",
  "workflow_json_zh": "{\"id\":\"5\",\"name\":\"Append, lookup, update, and read data from a Google Sheets spreadsheet\",\"nodes\":[{\"name\":\"On clicking 'execute'\",\"type\":\"n8n-nodes-base.manualTrigger\",\"position\":[450,450],\"parameters\":{},\"typeVersion\":1},{\"name\":\"Google Sheets2\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[1450,450],\"parameters\":{\"key\":\"ID\",\"range\":\"A:D\",\"options\":{\"valueInputMode\":\"USER_ENTERED\",\"valueRenderMode\":\"UNFORMATTED_VALUE\"},\"sheetId\":\"1remFwo--5ehUgIU7UUndKldPI0Xm93e1T3DldD9GOg0\",\"operation\":\"update\",\"authentication\":\"oAuth2\"},\"credentials\":{\"googleSheetsOAuth2Api\":\"google-sheet\"},\"typeVersion\":1},{\"name\":\"Set1\",\"type\":\"n8n-nodes-base.set\",\"position\":[1250,450],\"parameters\":{\"values\":{\"number\":[{\"name\":\"Rent\",\"value\":\"={{$node[\\\"Google Sheets1\\\"].json[\\\"Rent\\\"]+100}}\"},{\"name\":\"ID\",\"value\":\"={{$node[\\\"Google Sheets1\\\"].json[\\\"ID\\\"]}}\"}],\"string\":[{\"name\":\"Name\",\"value\":\"={{$node[\\\"Google Sheets1\\\"].json[\\\"Name\\\"]}}\"},{\"name\":\"City\",\"value\":\"={{$node[\\\"Google Sheets1\\\"].json[\\\"City\\\"]}}\"}]},\"options\":{},\"keepOnlySet\":true},\"typeVersion\":1},{\"name\":\"Google Sheets1\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[1050,450],\"parameters\":{\"range\":\"A:D\",\"options\":{\"valueRenderMode\":\"UNFORMATTED_VALUE\",\"returnAllMatches\":true},\"sheetId\":\"1remFwo--5ehUgIU7UUndKldPI0Xm93e1T3DldD9GOg0\",\"operation\":\"lookup\",\"lookupValue\":\"Berlin\",\"lookupColumn\":\"City\",\"authentication\":\"oAuth2\"},\"credentials\":{\"googleSheetsOAuth2Api\":\"google-sheet\"},\"typeVersion\":1},{\"name\":\"Google Sheets\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[850,450],\"parameters\":{\"range\":\"A:D\",\"options\":{\"valueInputMode\":\"USER_ENTERED\"},\"sheetId\":\"1remFwo--5ehUgIU7UUndKldPI0Xm93e1T3DldD9GOg0\",\"operation\":\"append\",\"authentication\":\"oAuth2\"},\"credentials\":{\"googleSheetsOAuth2Api\":\"google-sheet\"},\"typeVersion\":1},{\"name\":\"Google Sheets3\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[1650,450],\"parameters\":{\"range\":\"A:D\",\"options\":{\"valueRenderMode\":\"FORMATTED_VALUE\"},\"sheetId\":\"1remFwo--5ehUgIU7UUndKldPI0Xm93e1T3DldD9GOg0\",\"authentication\":\"oAuth2\"},\"credentials\":{\"googleSheetsOAuth2Api\":\"google-sheet\"},\"typeVersion\":1},{\"name\":\"Set\",\"type\":\"n8n-nodes-base.set\",\"position\":[650,450],\"parameters\":{\"values\":{\"number\":[{\"name\":\"ID\",\"value\":\"={{Math.floor(Math.random()*1000)}}\"}],\"string\":[{\"name\":\"Name\",\"value\":\"John's Place\"},{\"name\":\"Rent\",\"value\":\"$1,000\"},{\"name\":\"City\",\"value\":\"Berlin\"}]},\"options\":{},\"keepOnlySet\":true},\"typeVersion\":1}],\"active\":false,\"settings\":{},\"connections\":{\"Set\":{\"main\":[[{\"node\":\"Google Sheets\",\"type\":\"main\",\"index\":0}]]},\"Set1\":{\"main\":[[{\"node\":\"Google Sheets2\",\"type\":\"main\",\"index\":0}]]},\"Google Sheets\":{\"main\":[[{\"node\":\"Google Sheets1\",\"type\":\"main\",\"index\":0}]]},\"Google Sheets1\":{\"main\":[[{\"node\":\"Set1\",\"type\":\"main\",\"index\":0}]]},\"Google Sheets2\":{\"main\":[[{\"node\":\"Google Sheets3\",\"type\":\"main\",\"index\":0}]]},\"On clicking 'execute'\":{\"main\":[[{\"node\":\"Set\",\"type\":\"main\",\"index\":0}]]}}}"
}