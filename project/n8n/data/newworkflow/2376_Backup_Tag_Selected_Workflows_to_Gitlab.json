{
  "url": "https://n8n.io/workflows/2376-backup-tag-selected-workflows-to-gitlab/",
  "title": "Backup Tag-Selected Workflows to Gitlab",
  "author": "Hubschrauber",
  "publish_date": "Last update 9 months ago",
  "publish_date_absolute": "2024-08-25",
  "categories": [
    {
      "name": "DevOps"
    }
  ],
  "workflow_json": "{\"nodes\":[{\"id\":\"3e2820cb-24a4-491b-8f8b-60f97b0748dc\",\"name\":\"Backup Now - Manual Trigger\",\"type\":\"n8n-nodes-base.manualTrigger\",\"position\":[520,320],\"parameters\":{},\"typeVersion\":1},{\"id\":\"bc5588e5-b67a-4713-b8e7-c21227048a2d\",\"name\":\"n8n\",\"type\":\"n8n-nodes-base.n8n\",\"position\":[980,520],\"parameters\":{\"filters\":{\"tags\":\"={{ $('Globals').first().json.tags_to_match_for_backup }}\"},\"requestOptions\":{}},\"credentials\":{\"n8nApi\":{\"id\":\"L3X3qWRmwZRYCpV8\",\"name\":\"Source n8n Account\"}},\"typeVersion\":1},{\"id\":\"2a5af64d-b5c3-4180-bae5-9efeeaeba99d\",\"name\":\"Globals\",\"type\":\"n8n-nodes-base.set\",\"position\":[740,400],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"150135fb-c0fb-444b-aeed-eac851af255d\",\"name\":\"gitlab_owner\",\"type\":\"string\",\"value\":\"mygitlabownername\"},{\"id\":\"8a9359c0-5a16-482b-8f3a-c8b20fbc13c0\",\"name\":\"gitlab_project\",\"type\":\"string\",\"value\":\"n8n_workflow_backups\"},{\"id\":\"00843c18-7d09-4d60-ab70-534ca0791504\",\"name\":\"gitlab_workflow_path\",\"type\":\"string\",\"value\":\"workflow_definitions\"},{\"id\":\"8fbcc201-dbff-440b-b440-42e8f1735548\",\"name\":\"tags_to_match_for_backup\",\"type\":\"string\",\"value\":\"gitlab_backup_enabled\"},{\"id\":\"e17051bc-d8b3-4cef-bad0-efe38a7be464\",\"name\":\"execution_type\",\"type\":\"string\",\"value\":\"={{ ( $('Schedule Trigger').isExecuted) ? 'Scheduled' : 'Manual' }}\"},{\"id\":\"8b90fba9-df11-4e07-a7ae-31405143e831\",\"name\":\"execution_time\",\"type\":\"string\",\"value\":\"={{ $now }}\"}]}},\"typeVersion\":3.4},{\"id\":\"b6b44b4b-e5a7-4ce6-9cff-e7a21679ad32\",\"name\":\"Create New File(s)\",\"type\":\"n8n-nodes-base.gitlab\",\"position\":[2060,540],\"parameters\":{\"owner\":\"={{ $('Globals').first().json.gitlab_owner }}\",\"branch\":\"main\",\"filePath\":\"={{ $('Globals').first().json.gitlab_workflow_path }}/{{ $('Derive Filename From Workflow Name').item.json.normalized_filename }}\",\"resource\":\"file\",\"repository\":\"={{ $('Globals').first().json.gitlab_project }}\",\"fileContent\":\"={{ JSON.stringify($('n8n').item.json, null, 4) }}\",\"commitMessage\":\"=(Initial) {{ $('Globals').first().json.execution_type }} Backup - {{ $('Globals').first().json.execution_time }}.\"},\"credentials\":{\"gitlabApi\":{\"id\":\"Nv1DoplS64rrPZVm\",\"name\":\"Target GitLab Account\"}},\"typeVersion\":1},{\"id\":\"167ae6cd-b8dd-4e01-aca4-4888fcaf9958\",\"name\":\"Edit Existing File(s)\",\"type\":\"n8n-nodes-base.gitlab\",\"position\":[2060,340],\"parameters\":{\"owner\":\"={{ $('Globals').first().json.gitlab_owner }}\",\"branch\":\"main\",\"filePath\":\"={{ $('Globals').first().json.gitlab_workflow_path }}/{{ $('Derive Filename From Workflow Name').item.json.normalized_filename }}\",\"resource\":\"file\",\"operation\":\"edit\",\"repository\":\"={{ $('Globals').first().json.gitlab_project }}\",\"fileContent\":\"={{ JSON.stringify($('n8n').item.json, null, 4) }}\",\"commitMessage\":\"={{ $('Globals').first().json.execution_type }} Backup - {{ $('Globals').first().json.execution_time }}.\"},\"credentials\":{\"gitlabApi\":{\"id\":\"Nv1DoplS64rrPZVm\",\"name\":\"Target GitLab Account\"}},\"typeVersion\":1},{\"id\":\"a4437388-9143-4c91-841e-c062ab9af3c0\",\"name\":\"Derive Filename From Workflow Name\",\"type\":\"n8n-nodes-base.set\",\"position\":[1160,520],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"d2110dc6-1f31-46b3-991e-556b2255d76e\",\"name\":\"normalized_filename\",\"type\":\"string\",\"value\":\"={{ $json.name.replace(/[^a-zA-Z0-9]/g, '') }}.json\"}]}},\"typeVersion\":3.4},{\"id\":\"cb0fca8f-dc43-4903-a8e1-5b7acf9157b1\",\"name\":\"Fetch Existing File Content\",\"type\":\"n8n-nodes-base.gitlab\",\"position\":[1640,340],\"parameters\":{\"owner\":\"={{ $('Globals').first().json.gitlab_owner }}\",\"filePath\":\"={{ $('Globals').first().json.gitlab_workflow_path }}/{{ $('Derive Filename From Workflow Name').item.json.normalized_filename }}\",\"resource\":\"file\",\"operation\":\"get\",\"repository\":\"={{ $('Globals').first().json.gitlab_project }}\",\"asBinaryProperty\":false,\"additionalParameters\":{\"reference\":\"main\"}},\"credentials\":{\"gitlabApi\":{\"id\":\"Nv1DoplS64rrPZVm\",\"name\":\"Target GitLab Account\"}},\"typeVersion\":1},{\"id\":\"816843c4-769c-4033-a38e-1c6ef5325e15\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[940,120],\"parameters\":{\"color\":5,\"width\":401,\"height\":246,\"content\":\"## Gather Gitlab Info\"},\"typeVersion\":1},{\"id\":\"19f3fe4d-acba-4e7b-b92c-ce9024a8f37d\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[940,460],\"parameters\":{\"color\":5,\"width\":398,\"height\":240,\"content\":\"## Gather n8n Info\"},\"typeVersion\":1},{\"id\":\"418bef31-adf6-419b-87f1-faa2581e5766\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1380,280],\"parameters\":{\"width\":598,\"height\":384.41789416257484,\"content\":\"## Decide Whether to Create or Edit or Skip\"},\"typeVersion\":1},{\"id\":\"f3b98ded-c767-4822-bcf4-25931be03f48\",\"name\":\"Skip Unchanged Files\",\"type\":\"n8n-nodes-base.filter\",\"position\":[1820,340],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"3298ab8b-9934-4ed7-9c38-03f325dc71e2\",\"operator\":{\"type\":\"string\",\"operation\":\"notEquals\"},\"leftValue\":\"={{ JSON.stringify($('n8n').item.json, null, 4) }}\",\"rightValue\":\"={{ $json.content.base64Decode() }}\"}]}},\"typeVersion\":2},{\"id\":\"6bbf5146-7129-4ca8-8576-39d5cbe8e0b9\",\"name\":\"Sticky Note3\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[480,220],\"parameters\":{\"color\":4,\"width\":402,\"height\":452,\"content\":\"## Start / Trigger & Configure\"},\"typeVersion\":1},{\"id\":\"0e5d9c9f-40b4-494d-8233-a2b4fea67d76\",\"name\":\"Schedule Trigger\",\"type\":\"n8n-nodes-base.scheduleTrigger\",\"position\":[520,520],\"parameters\":{\"rule\":{\"interval\":[{\"field\":\"cronExpression\",\"expression\":\"30 21 * * 6\"}]}},\"typeVersion\":1.2},{\"id\":\"be08176e-3961-43d7-b182-89a4f45805f6\",\"name\":\"Fetch List of Existing Files\",\"type\":\"n8n-nodes-base.gitlab\",\"position\":[980,180],\"parameters\":{\"owner\":\"={{ $('Globals').first().json.gitlab_owner }}\",\"filePath\":\"={{ $('Globals').first().json.gitlab_workflow_path }}\",\"resource\":\"file\",\"operation\":\"list\",\"returnAll\":true,\"repository\":\"={{ $('Globals').item.json.gitlab_project }}\",\"additionalParameters\":{\"ref\":\"main\"}},\"credentials\":{\"gitlabApi\":{\"id\":\"Nv1DoplS64rrPZVm\",\"name\":\"Target GitLab Account\"}},\"typeVersion\":1},{\"id\":\"674cdaa8-f8fe-4f6d-8743-062d3fd1ff95\",\"name\":\"Combine Gitlab Existing Files as Single List Item\",\"type\":\"n8n-nodes-base.aggregate\",\"position\":[1180,180],\"parameters\":{\"options\":{},\"fieldsToAggregate\":{\"fieldToAggregate\":[{\"renameField\":true,\"outputFieldName\":\"gitlab_existing_filenames\",\"fieldToAggregate\":\"name\"}]}},\"typeVersion\":1},{\"id\":\"463ae3fb-4d66-497d-81eb-7e55b5945d84\",\"name\":\"File Exists in Gitlab?\",\"type\":\"n8n-nodes-base.if\",\"position\":[1440,460],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"0740c2be-ab9d-4249-af46-0d94f58c318f\",\"operator\":{\"type\":\"array\",\"operation\":\"contains\",\"rightType\":\"any\"},\"leftValue\":\"={{ $('Combine Gitlab Existing Files as Single List Item').first().json.gitlab_existing_filenames }}\",\"rightValue\":\"={{ $('Derive Filename From Workflow Name').item.json.normalized_filename }}\"}]}},\"typeVersion\":2}],\"connections\":{\"n8n\":{\"main\":[[{\"node\":\"Derive Filename From Workflow Name\",\"type\":\"main\",\"index\":0}]]},\"Globals\":{\"main\":[[{\"node\":\"Fetch List of Existing Files\",\"type\":\"main\",\"index\":0}]]},\"Schedule Trigger\":{\"main\":[[{\"node\":\"Globals\",\"type\":\"main\",\"index\":0}]]},\"Skip Unchanged Files\":{\"main\":[[{\"node\":\"Edit Existing File(s)\",\"type\":\"main\",\"index\":0}]]},\"File Exists in Gitlab?\":{\"main\":[[{\"node\":\"Fetch Existing File Content\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Create New File(s)\",\"type\":\"main\",\"index\":0}]]},\"Backup Now - Manual Trigger\":{\"main\":[[{\"node\":\"Globals\",\"type\":\"main\",\"index\":0}]]},\"Fetch Existing File Content\":{\"main\":[[{\"node\":\"Skip Unchanged Files\",\"type\":\"main\",\"index\":0}]]},\"Fetch List of Existing Files\":{\"main\":[[{\"node\":\"Combine Gitlab Existing Files as Single List Item\",\"type\":\"main\",\"index\":0}]]},\"Derive Filename From Workflow Name\":{\"main\":[[{\"node\":\"File Exists in Gitlab?\",\"type\":\"main\",\"index\":0}]]},\"Combine Gitlab Existing Files as Single List Item\":{\"main\":[[{\"node\":\"n8n\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "Fetches workflow definitions from within n8n, selecting only the ones that have one or more (configurable) assigned tags and then:\n\n  1. Derives a suitable backup filename by reducing the workflow name to a string with alphanumeric characters and no-spaces \n     * _Note: This isn't bulletproof, but works as long as workflow names aren't too crazy._\n  2. Determines which workflows need to be backed up based on whether each one: \n     * has been modified. (_Note: Even repositioning a node counts._)  \n...or...\n     * is new. (_Note: Renaming counts as this._)\n  3. Commits JSON copies of each workflow, as necessary, to a Gitlab repository with a generated, date-stamped commit message.\n\n\n\n## Setup\n\n### Credentials\n\n  * Create a Gitlab Credentials item and assign it to all Gitlab nodes.\n  * Create an n8n Credentials item and assign it to the n8n node \n    * Note: This was tested with **<http://localhost:5678/api/v1>** but should work with any reachable n8n instance and API key.\n\n\n\n### Modify these values in the \"Globals\" Node\n\n  * **gitlab_owner** \\- {{your gitlab account}}\n  * **gitlab_project** \\- {{ your gitlab project name }}\n  * **gitlab_workflow_path** \\- {{ subdirectory in the project where backup files should be saved/committed }}\n  * **tags_to_match_for_backup** \\- {{tag(s) to match for backup selection}} \n    * _**ALERT:** According to the **n8n** node's **Filters - > tags** field annotations, and API documentation, this supports a CSV list of multiple tags (e.g. tag1,tag2), **but** the API behavior requires workflows to have **all-of** the listed tags, not **any-of** them._\n      * **See:** <https://github.com/n8n-io/n8n/issues/10348>\n      * **TL/DR** \\- Don't expect a multiple tag list to be **more** inclusive.\n      * **Possible workaround:** To match more than one tag value, duplicate the n8n node into multiple single-tag matches, or split and iterate multiple values, and merge the results.\n\n\n\n## Possible Enhancements\n\n  * Make the branch (\"Reference\") for all the gitlab nodes configurable. Fixed on all as \"main\" in the template.\n  * Add an n8n node to generate an audit and store the output in gitlab along with the backups.\n  * Extend the workflow at the end to create a Gitlab release/tag whenever any backup files are actually updated or created.\n\n\n",
  "crawled_at": "2025-05-25T23:38:45.550112",
  "readme_zh": "从n8n中获取工作流定义，仅筛选出带有一个或多个（可配置）指定标签的工作流，随后执行以下操作：\n\n1. 通过将工作流名称简化为仅含字母数字且无空格的字符串，生成合适的备份文件名  \n   *注：此方法虽非万无一失，但只要工作流名称不过于怪异即可生效。*\n2. 根据以下条件判断哪些工作流需要备份：  \n   * 是否被修改（*注：节点位置变动也会触发*）  \n   ...或...  \n   * 是否为新创建（*注：重命名视为新建*）\n3. 将各工作流的JSON副本按需提交至Gitlab仓库，并自动生成带时间戳的提交信息。\n\n## 配置说明\n\n### 凭证设置\n* 创建Gitlab凭证项并分配给所有Gitlab节点\n* 创建n8n凭证项并分配给n8n节点  \n  *注：测试环境使用**<http://localhost:5678/api/v1>**，但任何可访问的n8n实例及API密钥均应适用*\n\n### 修改\"Globals\"节点中的参数\n* **gitlab_owner** \\- {{您的Gitlab账户}}\n* **gitlab_project** \\- {{Gitlab项目名称}}\n* **gitlab_workflow_path** \\- {{项目内用于存储备份文件的子目录}}\n* **tags_to_match_for_backup** \\- {{触发备份的匹配标签}}  \n  * *重要提示：根据**n8n**节点的**筛选器->标签**字段说明及API文档，此处支持多标签CSV列表（如tag1,tag2），但API实际要求工作流必须包含*所有*指定标签，而非*任一*标签*  \n    * **参见**：<https://github.com/n8n-io/n8n/issues/10348>  \n    * **简而言之**：多标签列表不会扩大匹配范围  \n    * **变通方案**：如需匹配多个标签值，可复制n8n节点进行单标签匹配，或拆分迭代多个标签值后合并结果\n\n## 优化建议\n* 将Gitlab节点的分支（\"Reference\"）设为可配置参数（模板中固定为\"main\"）\n* 添加n8n节点生成审计日志，与备份文件一并存储至Gitlab\n* 在流程末端扩展功能：当备份文件更新或新建时，自动创建Gitlab版本/标签",
  "title_zh": "备份标记选定的工作流程至Gitlab",
  "publish_date_zh": "最后更新于9个月前",
  "workflow_json_zh": "{\"nodes\":[{\"id\":\"3e2820cb-24a4-491b-8f8b-60f97b0748dc\",\"name\":\"Backup Now - Manual Trigger\",\"type\":\"n8n-nodes-base.manualTrigger\",\"position\":[520,320],\"parameters\":{},\"typeVersion\":1},{\"id\":\"bc5588e5-b67a-4713-b8e7-c21227048a2d\",\"name\":\"n8n\",\"type\":\"n8n-nodes-base.n8n\",\"position\":[980,520],\"parameters\":{\"filters\":{\"tags\":\"={{ $('Globals').first().json.tags_to_match_for_backup }}\"},\"requestOptions\":{}},\"credentials\":{\"n8nApi\":{\"id\":\"L3X3qWRmwZRYCpV8\",\"name\":\"Source n8n Account\"}},\"typeVersion\":1},{\"id\":\"2a5af64d-b5c3-4180-bae5-9efeeaeba99d\",\"name\":\"Globals\",\"type\":\"n8n-nodes-base.set\",\"position\":[740,400],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"150135fb-c0fb-444b-aeed-eac851af255d\",\"name\":\"gitlab_owner\",\"type\":\"string\",\"value\":\"mygitlabownername\"},{\"id\":\"8a9359c0-5a16-482b-8f3a-c8b20fbc13c0\",\"name\":\"gitlab_project\",\"type\":\"string\",\"value\":\"n8n_workflow_backups\"},{\"id\":\"00843c18-7d09-4d60-ab70-534ca0791504\",\"name\":\"gitlab_workflow_path\",\"type\":\"string\",\"value\":\"workflow_definitions\"},{\"id\":\"8fbcc201-dbff-440b-b440-42e8f1735548\",\"name\":\"tags_to_match_for_backup\",\"type\":\"string\",\"value\":\"gitlab_backup_enabled\"},{\"id\":\"e17051bc-d8b3-4cef-bad0-efe38a7be464\",\"name\":\"execution_type\",\"type\":\"string\",\"value\":\"={{ ( $('Schedule Trigger').isExecuted) ? 'Scheduled' : 'Manual' }}\"},{\"id\":\"8b90fba9-df11-4e07-a7ae-31405143e831\",\"name\":\"execution_time\",\"type\":\"string\",\"value\":\"={{ $now }}\"}]}},\"typeVersion\":3.4},{\"id\":\"b6b44b4b-e5a7-4ce6-9cff-e7a21679ad32\",\"name\":\"Create New File(s)\",\"type\":\"n8n-nodes-base.gitlab\",\"position\":[2060,540],\"parameters\":{\"owner\":\"={{ $('Globals').first().json.gitlab_owner }}\",\"branch\":\"main\",\"filePath\":\"={{ $('Globals').first().json.gitlab_workflow_path }}/{{ $('Derive Filename From Workflow Name').item.json.normalized_filename }}\",\"resource\":\"file\",\"repository\":\"={{ $('Globals').first().json.gitlab_project }}\",\"fileContent\":\"={{ JSON.stringify($('n8n').item.json, null, 4) }}\",\"commitMessage\":\"=(Initial) {{ $('Globals').first().json.execution_type }} Backup - {{ $('Globals').first().json.execution_time }}.\"},\"credentials\":{\"gitlabApi\":{\"id\":\"Nv1DoplS64rrPZVm\",\"name\":\"Target GitLab Account\"}},\"typeVersion\":1},{\"id\":\"167ae6cd-b8dd-4e01-aca4-4888fcaf9958\",\"name\":\"Edit Existing File(s)\",\"type\":\"n8n-nodes-base.gitlab\",\"position\":[2060,340],\"parameters\":{\"owner\":\"={{ $('Globals').first().json.gitlab_owner }}\",\"branch\":\"main\",\"filePath\":\"={{ $('Globals').first().json.gitlab_workflow_path }}/{{ $('Derive Filename From Workflow Name').item.json.normalized_filename }}\",\"resource\":\"file\",\"operation\":\"edit\",\"repository\":\"={{ $('Globals').first().json.gitlab_project }}\",\"fileContent\":\"={{ JSON.stringify($('n8n').item.json, null, 4) }}\",\"commitMessage\":\"={{ $('Globals').first().json.execution_type }} Backup - {{ $('Globals').first().json.execution_time }}.\"},\"credentials\":{\"gitlabApi\":{\"id\":\"Nv1DoplS64rrPZVm\",\"name\":\"Target GitLab Account\"}},\"typeVersion\":1},{\"id\":\"a4437388-9143-4c91-841e-c062ab9af3c0\",\"name\":\"Derive Filename From Workflow Name\",\"type\":\"n8n-nodes-base.set\",\"position\":[1160,520],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"d2110dc6-1f31-46b3-991e-556b2255d76e\",\"name\":\"normalized_filename\",\"type\":\"string\",\"value\":\"={{ $json.name.replace(/[^a-zA-Z0-9]/g, '') }}.json\"}]}},\"typeVersion\":3.4},{\"id\":\"cb0fca8f-dc43-4903-a8e1-5b7acf9157b1\",\"name\":\"Fetch Existing File Content\",\"type\":\"n8n-nodes-base.gitlab\",\"position\":[1640,340],\"parameters\":{\"owner\":\"={{ $('Globals').first().json.gitlab_owner }}\",\"filePath\":\"={{ $('Globals').first().json.gitlab_workflow_path }}/{{ $('Derive Filename From Workflow Name').item.json.normalized_filename }}\",\"resource\":\"file\",\"operation\":\"get\",\"repository\":\"={{ $('Globals').first().json.gitlab_project }}\",\"asBinaryProperty\":false,\"additionalParameters\":{\"reference\":\"main\"}},\"credentials\":{\"gitlabApi\":{\"id\":\"Nv1DoplS64rrPZVm\",\"name\":\"Target GitLab Account\"}},\"typeVersion\":1},{\"id\":\"816843c4-769c-4033-a38e-1c6ef5325e15\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[940,120],\"parameters\":{\"color\":5,\"width\":401,\"height\":246,\"content\":\"## 收集Gitlab信息\"},\"typeVersion\":1},{\"id\":\"19f3fe4d-acba-4e7b-b92c-ce9024a8f37d\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[940,460],\"parameters\":{\"color\":5,\"width\":398,\"height\":240,\"content\":\"## 收集n8n信息\"},\"typeVersion\":1},{\"id\":\"418bef31-adf6-419b-87f1-faa2581e5766\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1380,280],\"parameters\":{\"width\":598,\"height\":384.41789416257484,\"content\":\"## 决定创建、编辑或跳过\"},\"typeVersion\":1},{\"id\":\"f3b98ded-c767-4822-bcf4-25931be03f48\",\"name\":\"Skip Unchanged Files\",\"type\":\"n8n-nodes-base.filter\",\"position\":[1820,340],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"3298ab8b-9934-4ed7-9c38-03f325dc71e2\",\"operator\":{\"type\":\"string\",\"operation\":\"notEquals\"},\"leftValue\":\"={{ JSON.stringify($('n8n').item.json, null, 4) }}\",\"rightValue\":\"={{ $json.content.base64Decode() }}\"}]}},\"typeVersion\":2},{\"id\":\"6bbf5146-7129-4ca8-8576-39d5cbe8e0b9\",\"name\":\"Sticky Note3\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[480,220],\"parameters\":{\"color\":4,\"width\":402,\"height\":452,\"content\":\"## 启动 / 触发与配置\"},\"typeVersion\":1},{\"id\":\"0e5d9c9f-40b4-494d-8233-a2b4fea67d76\",\"name\":\"Schedule Trigger\",\"type\":\"n8n-nodes-base.scheduleTrigger\",\"position\":[520,520],\"parameters\":{\"rule\":{\"interval\":[{\"field\":\"cronExpression\",\"expression\":\"30 21 * * 6\"}]}},\"typeVersion\":1.2},{\"id\":\"be08176e-3961-43d7-b182-89a4f45805f6\",\"name\":\"Fetch List of Existing Files\",\"type\":\"n8n-nodes-base.gitlab\",\"position\":[980,180],\"parameters\":{\"owner\":\"={{ $('Globals').first().json.gitlab_owner }}\",\"filePath\":\"={{ $('Globals').first().json.gitlab_workflow_path }}\",\"resource\":\"file\",\"operation\":\"list\",\"returnAll\":true,\"repository\":\"={{ $('Globals').item.json.gitlab_project }}\",\"additionalParameters\":{\"ref\":\"main\"}},\"credentials\":{\"gitlabApi\":{\"id\":\"Nv1DoplS64rrPZVm\",\"name\":\"Target GitLab Account\"}},\"typeVersion\":1},{\"id\":\"674cdaa8-f8fe-4f6d-8743-062d3fd1ff95\",\"name\":\"Combine Gitlab Existing Files as Single List Item\",\"type\":\"n8n-nodes-base.aggregate\",\"position\":[1180,180],\"parameters\":{\"options\":{},\"fieldsToAggregate\":{\"fieldToAggregate\":[{\"renameField\":true,\"outputFieldName\":\"gitlab_existing_filenames\",\"fieldToAggregate\":\"name\"}]}},\"typeVersion\":1},{\"id\":\"463ae3fb-4d66-497d-81eb-7e55b5945d84\",\"name\":\"File Exists in Gitlab?\",\"type\":\"n8n-nodes-base.if\",\"position\":[1440,460],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"0740c2be-ab9d-4249-af46-0d94f58c318f\",\"operator\":{\"type\":\"array\",\"operation\":\"contains\",\"rightType\":\"any\"},\"leftValue\":\"={{ $('Combine Gitlab Existing Files as Single List Item').first().json.gitlab_existing_filenames }}\",\"rightValue\":\"={{ $('Derive Filename From Workflow Name').item.json.normalized_filename }}\"}]}},\"typeVersion\":2}],\"connections\":{\"n8n\":{\"main\":[[{\"node\":\"Derive Filename From Workflow Name\",\"type\":\"main\",\"index\":0}]]},\"Globals\":{\"main\":[[{\"node\":\"Fetch List of Existing Files\",\"type\":\"main\",\"index\":0}]]},\"Schedule Trigger\":{\"main\":[[{\"node\":\"Globals\",\"type\":\"main\",\"index\":0}]]},\"Skip Unchanged Files\":{\"main\":[[{\"node\":\"Edit Existing File(s)\",\"type\":\"main\",\"index\":0}]]},\"File Exists in Gitlab?\":{\"main\":[[{\"node\":\"Fetch Existing File Content\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Create New File(s)\",\"type\":\"main\",\"index\":0}]]},\"Backup Now - Manual Trigger\":{\"main\":[[{\"node\":\"Globals\",\"type\":\"main\",\"index\":0}]]},\"Fetch Existing File Content\":{\"main\":[[{\"node\":\"Skip Unchanged Files\",\"type\":\"main\",\"index\":0}]]},\"Fetch List of Existing Files\":{\"main\":[[{\"node\":\"Combine Gitlab Existing Files as Single List Item\",\"type\":\"main\",\"index\":0}]]},\"Derive Filename From Workflow Name\":{\"main\":[[{\"node\":\"File Exists in Gitlab?\",\"type\":\"main\",\"index\":0}]]},\"Combine Gitlab Existing Files as Single List Item\":{\"main\":[[{\"node\":\"n8n\",\"type\":\"main\",\"index\":0}]]}}}"
}