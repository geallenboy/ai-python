{
  "url": "https://n8n.io/workflows/3386-automate-docker-container-updates-with-telegram-approval-system/",
  "title": "Automate Docker Container Updates with Telegram Approval System",
  "author": "Jaber Zare",
  "publish_date": "Last update a month ago",
  "publish_date_absolute": "",
  "categories": [
    {
      "name": "DevOps"
    },
    {
      "name": "IT Ops"
    }
  ],
  "workflow_json": "{\"id\":\"PVBUCGQUOiOrIfli\",\"meta\":{\"instanceId\":\"740d0a59ff901341d9247a8b17beaace585edc6342f8d716c9cf18ea3ac6313a\",\"templateCredsSetupCompleted\":true},\"name\":\"n8n update\",\"tags\":[{\"id\":\"AW45ve4sa5vbdnkZ\",\"name\":\"#n8n\",\"createdAt\":\"2025-03-30T00:22:43.140Z\",\"updatedAt\":\"2025-03-30T00:22:43.140Z\"}],\"nodes\":[{\"id\":\"445aa127-ac55-4e01-ab07-90a45cf0fab1\",\"name\":\"Pull n8n Image\",\"type\":\"n8n-nodes-base.ssh\",\"position\":[300,-240],\"parameters\":{\"cwd\":\"={{ $('Set Default variable').item.json['working-directory'] }}\",\"command\":\"sudo docker pull docker.n8n.io/n8nio/n8n\"},\"credentials\":{\"sshPassword\":{\"id\":\"tqNyOVbQTikb35Tk\",\"name\":\"SSH Password account\"}},\"typeVersion\":1},{\"id\":\"e437f006-cdee-4ab3-bfaa-f323b072c380\",\"name\":\"docker compose pull\",\"type\":\"n8n-nodes-base.ssh\",\"position\":[560,-240],\"parameters\":{\"cwd\":\"={{ $('Set Default variable').item.json['working-directory'] }}\",\"command\":\"sudo docker compose pull\"},\"credentials\":{\"sshPassword\":{\"id\":\"tqNyOVbQTikb35Tk\",\"name\":\"SSH Password account\"}},\"typeVersion\":1},{\"id\":\"79e7a23e-1bd6-45c8-b9b0-ee959c11aa01\",\"name\":\"check n8n installed version\",\"type\":\"n8n-nodes-base.ssh\",\"position\":[-1100,-660],\"parameters\":{\"cwd\":\"={{ $json['working-directory'] }}\",\"command\":\"=sudo docker inspect \\\"{{ $json['n8n-container-name'] }}\\\" | jq -r '.[0].Config.Labels[\\\"org.opencontainers.image.version\\\"]'\"},\"credentials\":{\"sshPassword\":{\"id\":\"tqNyOVbQTikb35Tk\",\"name\":\"SSH Password account\"}},\"executeOnce\":false,\"typeVersion\":1,\"alwaysOutputData\":false},{\"id\":\"a84ab5f7-da59-4d7a-aeac-ec1651115924\",\"name\":\"When clicking ‘Test workflow’\",\"type\":\"n8n-nodes-base.manualTrigger\",\"position\":[-1800,-200],\"parameters\":{},\"typeVersion\":1},{\"id\":\"9306fb33-0780-49db-bf22-13e264f0c2bf\",\"name\":\"Schedule Trigger\",\"type\":\"n8n-nodes-base.scheduleTrigger\",\"position\":[-1800,-460],\"parameters\":{\"rule\":{\"interval\":[{\"daysInterval\":3,\"triggerAtHour\":13}]}},\"typeVersion\":1.2},{\"id\":\"a47fe6aa-f12b-4974-ac55-214b2fd76eff\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-1540,-660],\"parameters\":{\"height\":500,\"content\":\"## Default Variables  \\nBefore starting, please set the following variables:  \\n\\n- **working-directory**: The directory where your `docker-compose.yml` file is located.  \\n- **n8n-container-name**: The name of your n8n Docker container.  \\n- **telegram-id**: Your Telegram chat ID. You can find it by messaging `@get_id_bot` on Telegram.  \\n\"},\"typeVersion\":1},{\"id\":\"bd9cba21-5ce6-4ce1-803b-ac77b9e58f45\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-1300,-240],\"parameters\":{\"height\":300,\"content\":\"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nGet information from the n8n GitHub repository to find the latest released version of n8n.  \\n\"},\"typeVersion\":1},{\"id\":\"4db11a08-3feb-4f91-9671-a675a2e7ae76\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-1040,-240],\"parameters\":{\"height\":300,\"content\":\"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nThis node removes \\\"n8n@\\\" from the version string.  \\nFor example:  \\n- Before: `n8n@1.84.3`  \\n- After: `1.84.3`  \\n\\n\"},\"typeVersion\":1},{\"id\":\"d479524f-143e-4894-909d-e9970590e0e2\",\"name\":\"Sticky Note3\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-1160,-880],\"parameters\":{\"height\":400,\"content\":\"## Check Installed Image Version  \\nExecute a command on the server to determine which version of n8n is currently running.  \\n\"},\"typeVersion\":1},{\"id\":\"f896acec-2dc5-477b-88f2-9b8e36550006\",\"name\":\"Sticky Note4\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-820,-880],\"parameters\":{\"width\":420,\"height\":520,\"content\":\"## SQL Query: Merging Inputs  \\nThis query retrieves the `stdout` field from `input1` and `tag_name` from `input2`.  \\nIt uses a `LEFT JOIN` to merge the data based on matching `id` fields.  \\n\\nQuery:  \\n```sql\\nSELECT input1.stdout AS stdout, \\ninput2.tag_name AS tag_name\\nFROM input1\\nLEFT JOIN input2 ON input1.id = input2.id;\\n\"},\"typeVersion\":1},{\"id\":\"7913800b-b46f-40e2-851d-cc3cc2104843\",\"name\":\"Sticky Note5\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-60,-1080],\"parameters\":{\"height\":380,\"content\":\"## Telegram Notificaton [OPTIONAL]\\nSend a Telegram message and inform that there is nothing to do and n8n is already on the latest version.\\n\\n\\n\\n\\n\\n\\n\\n\\n\"},\"typeVersion\":1},{\"id\":\"63ef2c3f-d0d2-438e-9427-90592397df22\",\"name\":\"Sticky Note6\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-380,-680],\"parameters\":{\"height\":340,\"content\":\"## Compare Versions  \\nThis node compares two versions: one from Docker and another from the n8n GitHub repository.  \\nIf a new version is available, it will be detected.  \\n\\n\\n\"},\"typeVersion\":1},{\"id\":\"77ebd46f-09af-4e68-a1a7-a6d97c3f9021\",\"name\":\"Sticky Note7\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-40,-420],\"parameters\":{\"height\":340,\"content\":\"## Telegram Approve\\nSend a Telegram notification and inform that a new version is available. Ask if the user wants to update.\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\"},\"typeVersion\":1},{\"id\":\"7365971c-1e77-4eae-a23f-9f7843b40889\",\"name\":\"Sticky Note8\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[220,-420],\"parameters\":{\"height\":340,\"content\":\"## Pull Docker Image\\nPull the latest n8n image. You can modify the command as needed.\\n\\n\\n\\n\\n\\n\\n\\n\\n\"},\"typeVersion\":1},{\"id\":\"1e7b547c-e9b1-4b91-8241-6cdd6a746100\",\"name\":\"Sticky Note9\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[500,-420],\"parameters\":{\"height\":340,\"content\":\"## Docker Compose Pull\\nRuns in the directory you defined in the Default variable.\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\"},\"typeVersion\":1},{\"id\":\"f2817779-b2e9-4205-baf7-1f0481bae0e4\",\"name\":\"Sticky Note10\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[780,-420],\"parameters\":{\"height\":340,\"content\":\"## Docker Compose Up \\nIn this step, the container will be started with the new image.\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\"},\"typeVersion\":1},{\"id\":\"4823d32f-9237-444f-812f-1bc494d0e087\",\"name\":\"Sticky Note11\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1060,-420],\"parameters\":{\"height\":340,\"content\":\"## Telegram Notificaton\\nSend a Telegram notification and inform that n8n has been updated.\\n\\n\\n\\n\\n\\n\\n\\n\\n\"},\"typeVersion\":1},{\"id\":\"8bcf0308-7904-4635-8f0e-7335e360dabc\",\"name\":\"docker compose up\",\"type\":\"n8n-nodes-base.ssh\",\"position\":[840,-240],\"parameters\":{\"cwd\":\"={{ $('Set Default variable').item.json['working-directory'] }}\",\"command\":\"sudo docker compose up -d\"},\"credentials\":{\"sshPassword\":{\"id\":\"tqNyOVbQTikb35Tk\",\"name\":\"SSH Password account\"}},\"typeVersion\":1},{\"id\":\"add506c6-88b7-480c-be13-2de86f6094ca\",\"name\":\"Sticky Note12\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-1840,-660],\"parameters\":{\"height\":340,\"content\":\"## Schedule Trigger  \\nYou can schedule this workflow, for example, every three days to check n8n images.\\n\\n\\n\\n\\n\\n\"},\"typeVersion\":1},{\"id\":\"045ebd0a-9d54-4cae-8307-f23ed26103f9\",\"name\":\"Set Default variable\",\"type\":\"n8n-nodes-base.set\",\"position\":[-1480,-320],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"c06b2d24-1fd7-40f0-aee5-b5d6553e289e\",\"name\":\"working-directory\",\"type\":\"string\",\"value\":\"\"},{\"id\":\"451aad67-5190-4eab-a982-56092734bb07\",\"name\":\"n8n-container-name\",\"type\":\"string\",\"value\":\"\"},{\"id\":\"8a294900-f367-47a2-b260-344b133dc2ff\",\"name\":\"telegram-id\",\"type\":\"string\",\"value\":\"598677820\"}]}},\"typeVersion\":3.4,\"alwaysOutputData\":true},{\"id\":\"6bc2b28c-0f3c-44aa-a536-766f972f9e22\",\"name\":\"Github HTTP Request\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[-1240,-220],\"parameters\":{\"url\":\"https://api.github.com/repos/n8n-io/n8n/releases/latest\",\"options\":{}},\"typeVersion\":4.2,\"alwaysOutputData\":false},{\"id\":\"8ba3f574-9f2b-48d2-95fc-b57d57ecf6c1\",\"name\":\"Merge Results\",\"type\":\"n8n-nodes-base.merge\",\"position\":[-660,-560],\"parameters\":{\"mode\":\"combineBySql\",\"query\":\"SELECT input1.stdout, input2.tag_name \\nFROM input1 \\nLEFT JOIN input2 ON true;\"},\"typeVersion\":3.1},{\"id\":\"c97723c3-1733-4481-add2-7ecae02ea144\",\"name\":\"Edit Version String\",\"type\":\"n8n-nodes-base.set\",\"position\":[-960,-220],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"f6e5cc51-aa49-46e5-aa4c-73baec811afa\",\"name\":\"tag_name\",\"type\":\"string\",\"value\":\"={{ $json[\\\"tag_name\\\"].replace(\\\"n8n@\\\", \\\"\\\") }}\"}]}},\"typeVersion\":3.4},{\"id\":\"22bec435-84ba-44bb-8127-c5b099fda7f2\",\"name\":\"Comapre Two Input\",\"type\":\"n8n-nodes-base.if\",\"position\":[-320,-500],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"e88d2c77-5ee1-4296-a612-d9b2290f6e03\",\"operator\":{\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $json.stdout }}\",\"rightValue\":\"={{ $json.tag_name }}\"}]},\"looseTypeValidation\":\"=\"},\"typeVersion\":2.2},{\"id\":\"be9bdef5-88f4-4f12-8938-82f8206b8655\",\"name\":\"Telegram Notif\",\"type\":\"n8n-nodes-base.telegram\",\"position\":[0,-860],\"webhookId\":\"38d19f3d-0ef4-40df-b831-701ea242bb8f\",\"parameters\":{\"text\":\"n8n is up to date.\",\"chatId\":\"={{ $('Set Default variable').item.json['telegram-id'] }}\",\"additionalFields\":{}},\"credentials\":{\"telegramApi\":{\"id\":\"Zx3ibmlSzRKZQsFa\",\"name\":\"Telegram account\"}},\"typeVersion\":1.2},{\"id\":\"59ece477-dcf2-4898-a362-7fcd35a49315\",\"name\":\"Telegram Approve\",\"type\":\"n8n-nodes-base.telegram\",\"position\":[20,-240],\"webhookId\":\"e816696f-cb7a-4036-92bf-eafb5f06778c\",\"parameters\":{\"chatId\":\"={{ $('Set Default variable').item.json['telegram-id'] }}\",\"message\":\"Hi, \\na new n8n version is available. \\nI'm ready to update. \\nCan I start now?\",\"options\":{},\"operation\":\"sendAndWait\"},\"credentials\":{\"telegramApi\":{\"id\":\"Zx3ibmlSzRKZQsFa\",\"name\":\"Telegram account\"}},\"typeVersion\":1.2},{\"id\":\"292efcfd-bbd7-4170-9e9f-020f10483c5e\",\"name\":\"Telegram Notif1\",\"type\":\"n8n-nodes-base.telegram\",\"position\":[1120,-240],\"webhookId\":\"254019a6-a298-4a9e-b100-8b92f22469c3\",\"parameters\":{\"text\":\"We are updating n8n to the latest version.\",\"chatId\":\"={{ $('Set Default variable').item.json['telegram-id'] }}\",\"additionalFields\":{}},\"credentials\":{\"telegramApi\":{\"id\":\"Zx3ibmlSzRKZQsFa\",\"name\":\"Telegram account\"}},\"typeVersion\":1.2}],\"active\":true,\"pinData\":{},\"settings\":{\"timezone\":\"Asia/Tehran\",\"callerPolicy\":\"workflowsFromSameOwner\",\"executionOrder\":\"v1\",\"saveExecutionProgress\":false},\"versionId\":\"e7c52f1d-e131-4911-bf04-5d3ebefc8271\",\"connections\":{\"Merge Results\":{\"main\":[[{\"node\":\"Comapre Two Input\",\"type\":\"main\",\"index\":0}]]},\"Pull n8n Image\":{\"main\":[[{\"node\":\"docker compose pull\",\"type\":\"main\",\"index\":0}]]},\"Telegram Notif1\":{\"main\":[[{\"node\":\"Comapre Two Input\",\"type\":\"main\",\"index\":0}]]},\"Schedule Trigger\":{\"main\":[[{\"node\":\"Set Default variable\",\"type\":\"main\",\"index\":0}]]},\"Telegram Approve\":{\"main\":[[{\"node\":\"Pull n8n Image\",\"type\":\"main\",\"index\":0}]]},\"Comapre Two Input\":{\"main\":[[{\"node\":\"Telegram Notif\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Telegram Approve\",\"type\":\"main\",\"index\":0}]]},\"docker compose up\":{\"main\":[[{\"node\":\"Telegram Notif1\",\"type\":\"main\",\"index\":0}]]},\"Edit Version String\":{\"main\":[[{\"node\":\"Merge Results\",\"type\":\"main\",\"index\":1}]]},\"Github HTTP Request\":{\"main\":[[{\"node\":\"Edit Version String\",\"type\":\"main\",\"index\":0}]]},\"docker compose pull\":{\"main\":[[{\"node\":\"docker compose up\",\"type\":\"main\",\"index\":0}]]},\"Set Default variable\":{\"main\":[[{\"node\":\"check n8n installed version\",\"type\":\"main\",\"index\":0},{\"node\":\"Github HTTP Request\",\"type\":\"main\",\"index\":0}]]},\"check n8n installed version\":{\"main\":[[{\"node\":\"Merge Results\",\"type\":\"main\",\"index\":0}]]},\"When clicking ‘Test workflow’\":{\"main\":[[{\"node\":\"Set Default variable\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "#### Who is this for?\n\nThis workflow is for DevOps engineers, system administrators, and Docker users who want to automate the process of checking for updates, verifying them, and applying updates to their Docker-based deployment in a controlled manner.  \nFor example, this workflow is used to update the n8n Docker image.\n\n#### What does this workflow do?\n\n  * Fetches the latest Docker image version from GitHub.\n  * Compares it with the currently running version on the server.\n  * Sends a Telegram message requesting confirmation if an update is available.\n  * If confirmed, pulls the latest n8n Docker image, updates the container, and restarts it.\n  * Sends a Telegram message confirming the update is completed.\n  * Schedules automatic checks, Uses a cron trigger in n8n to check for updates at regular intervals.\n\n\n\n#### Setup\n\n  * Ensure n8n is installed and running in a Docker container.\n  * Create a Telegram bot using BotFather.\n  * Set up Telegram credentials.\n  * Set up SSH credentials (ensure the SSH user has sudo access).\n  * Obtain the bot token and chat ID.\n  * Set the Default variable node \n    * telegram-id (You can find it by messaging @get_id_bot).\n    * n8n-container-name (Specify the name of the n8n container.)\n    * working-directory (The directory where your docker-compose.yml is).\n  * You can use a manual trigger or a schedule trigger to update (for n8n, I use Cron every 3 days to check for a new version).\n\n\n\n#### How to customize this workflow\n\n  * Change the update mechanism: Modify the Docker commands if using a different container runtime or orchestration tool.\n  * Modify the confirmation flow: Add extra validation steps, such as checking for breaking changes before updating.\n  * Use a different notification method: Replace Telegram with Slack, email, or another notification service.\n\n\n",
  "crawled_at": "2025-05-26T04:21:10.370536",
  "readme_zh": "#### 适用对象\n\n本工作流专为希望以可控方式自动化检查、验证并应用Docker部署更新的DevOps工程师、系统管理员及Docker用户设计。  \n例如：该工作流可用于更新n8n的Docker镜像。\n\n#### 功能说明\n\n  * 从GitHub获取最新Docker镜像版本\n  * 与服务器当前运行版本进行比对\n  * 检测到更新时发送Telegram确认请求\n  * 获得确认后，拉取最新n8n镜像并更新重启容器\n  * 更新完成后发送Telegram确认通知\n  * 通过n8n的cron触发器实现定期自动检查（默认每3天检测一次新版本）\n\n#### 配置步骤\n\n  * 确保n8n已在Docker容器中安装运行\n  * 通过BotFather创建Telegram机器人\n  * 配置Telegram凭证\n  * 设置SSH凭证（需确保SSH用户拥有sudo权限）\n  * 获取机器人token和聊天ID\n  * 设置默认变量节点：\n    * telegram-id（可通过@get_id_bot获取）\n    * n8n-container-name（指定n8n容器名称）\n    * working-directory（docker-compose.yml所在目录）\n  * 可选择手动触发或定时触发（推荐使用n8n的Cron功能每3天检查）\n\n#### 自定义指南\n\n  * 更新机制调整：若使用不同容器运行时或编排工具，需修改Docker命令\n  * 确认流程优化：可添加额外验证步骤（如更新前检查重大变更）\n  * 通知方式替换：可将Telegram替换为Slack、邮件等其他通知服务",
  "title_zh": "通过Telegram审批系统自动化Docker容器更新",
  "publish_date_zh": "上次更新于12天前",
  "workflow_json_zh": "{\n  \"id\": \"PVBUCGQUOiOrIfli\",\n  \"meta\": {\n    \"instanceId\": \"740d0a59ff901341d9247a8b17beaace585edc6342f8d716c9cf18ea3ac6313a\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"name\": \"n8n update\",\n  \"tags\": [\n    {\n      \"id\": \"AW45ve4sa5vbdnkZ\",\n      \"name\": \"#n8n\",\n      \"createdAt\": \"2025-03-30T00:22:43.140Z\",\n      \"updatedAt\": \"2025-03-30T00:22:43.140Z\"\n    }\n  ],\n  \"nodes\": [\n    {\n      \"id\": \"445aa127-ac55-4e01-ab07-90a45cf0fab1\",\n      \"name\": \"Pull n8n Image\",\n      \"type\": \"n8n-nodes-base.ssh\",\n      \"position\": [\n        300,\n        -240\n      ],\n      \"parameters\": {\n        \"cwd\": \"={{ $('Set Default variable').item.json['working-directory'] }}\",\n        \"command\": \"sudo docker pull docker.n8n.io/n8nio/n8n\"\n      },\n      \"credentials\": {\n        \"sshPassword\": {\n          \"id\": \"tqNyOVbQTikb35Tk\",\n          \"name\": \"SSH Password account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"e437f006-cdee-4ab3-bfaa-f323b072c380\",\n      \"name\": \"docker compose pull\",\n      \"type\": \"n8n-nodes-base.ssh\",\n      \"position\": [\n        560,\n        -240\n      ],\n      \"parameters\": {\n        \"cwd\": \"={{ $('Set Default variable').item.json['working-directory'] }}\",\n        \"command\": \"sudo docker compose pull\"\n      },\n      \"credentials\": {\n        \"sshPassword\": {\n          \"id\": \"tqNyOVbQTikb35Tk\",\n          \"name\": \"SSH Password account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"79e7a23e-1bd6-45c8-b9b0-ee959c11aa01\",\n      \"name\": \"check n8n installed version\",\n      \"type\": \"n8n-nodes-base.ssh\",\n      \"position\": [\n        -1100,\n        -660\n      ],\n      \"parameters\": {\n        \"cwd\": \"={{ $json['working-directory'] }}\",\n        \"command\": \"=sudo docker inspect \\\"{{ $json['n8n-container-name'] }}\\\" | jq -r '.[0].Config.Labels[\\\"org.opencontainers.image.version\\\"]'\"\n      },\n      \"credentials\": {\n        \"sshPassword\": {\n          \"id\": \"tqNyOVbQTikb35Tk\",\n          \"name\": \"SSH Password account\"\n        }\n      },\n      \"executeOnce\": false,\n      \"typeVersion\": 1,\n      \"alwaysOutputData\": false\n    },\n    {\n      \"id\": \"a84ab5f7-da59-4d7a-aeac-ec1651115924\",\n      \"name\": \"When clicking ‘Test workflow’\",\n      \"type\": \"n8n-nodes-base.manualTrigger\",\n      \"position\": [\n        -1800,\n        -200\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"9306fb33-0780-49db-bf22-13e264f0c2bf\",\n      \"name\": \"Schedule Trigger\",\n      \"type\": \"n8n-nodes-base.scheduleTrigger\",\n      \"position\": [\n        -1800,\n        -460\n      ],\n      \"parameters\": {\n        \"rule\": {\n          \"interval\": [\n            {\n              \"daysInterval\": 3,\n              \"triggerAtHour\": 13\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"a47fe6aa-f12b-4974-ac55-214b2fd76eff\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -1540,\n        -660\n      ],\n      \"parameters\": {\n        \"height\": 500,\n        \"content\": \"## 默认变量  \\n在开始之前，请先设置以下变量：  \\n\\n- **working-directory**：存放 `docker-compose.yml` 文件的目录路径。  \\n- **n8n-container-name**：你的 n8n Docker 容器名称。  \\n- **telegram-id**：你的 Telegram 聊天 ID。可通过在 Telegram 上向 `@get_id_bot` 发送消息获取。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"bd9cba21-5ce6-4ce1-803b-ac77b9e58f45\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -1300,\n        -240\n      ],\n      \"parameters\": {\n        \"height\": 300,\n        \"content\": \"从n8n的GitHub仓库获取信息，以查找n8n的最新发布版本。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"4db11a08-3feb-4f91-9671-a675a2e7ae76\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -1040,\n        -240\n      ],\n      \"parameters\": {\n        \"height\": 300,\n        \"content\": \"该节点会移除版本字符串中的 \\\"n8n@\\\"。  \\n例如：  \\n- 处理前：`n8n@1.84.3`  \\n- 处理后：`1.84.3`\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"d479524f-143e-4894-909d-e9970590e0e2\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -1160,\n        -880\n      ],\n      \"parameters\": {\n        \"height\": 400,\n        \"content\": \"## 检查已安装的镜像版本  \\n在服务器上执行命令以确定当前运行的n8n版本。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"f896acec-2dc5-477b-88f2-9b8e36550006\",\n      \"name\": \"Sticky Note4\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -820,\n        -880\n      ],\n      \"parameters\": {\n        \"width\": 420,\n        \"height\": 520,\n        \"content\": \"## SQL查询：合并输入数据  \\n本查询从`input1`表中获取`stdout`字段，从`input2`表中获取`tag_name`字段。  \\n通过`LEFT JOIN`操作，基于匹配的`id`字段进行数据合并。  \\n\\n查询语句：  \\n```sql\\nSELECT input1.stdout AS stdout, \\ninput2.tag_name AS tag_name\\nFROM input1\\nLEFT JOIN input2 ON input1.id = input2.id;\\n```\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"7913800b-b46f-40e2-851d-cc3cc2104843\",\n      \"name\": \"Sticky Note5\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -60,\n        -1080\n      ],\n      \"parameters\": {\n        \"height\": 380,\n        \"content\": \"## Telegram 通知 [可选]\\n发送一条 Telegram 消息，告知无需任何操作，n8n 已是最新版本。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"63ef2c3f-d0d2-438e-9427-90592397df22\",\n      \"name\": \"Sticky Note6\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -380,\n        -680\n      ],\n      \"parameters\": {\n        \"height\": 340,\n        \"content\": \"## 版本比较  \\n该节点用于对比两个版本：一个来自Docker，另一个来自n8n的GitHub仓库。  \\n若有新版本发布，将会被检测到。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"77ebd46f-09af-4e68-a1a7-a6d97c3f9021\",\n      \"name\": \"Sticky Note7\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -40,\n        -420\n      ],\n      \"parameters\": {\n        \"height\": 340,\n        \"content\": \"## Telegram 确认\\n发送Telegram通知并告知有新版本可用。询问用户是否要更新。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"7365971c-1e77-4eae-a23f-9f7843b40889\",\n      \"name\": \"Sticky Note8\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        220,\n        -420\n      ],\n      \"parameters\": {\n        \"height\": 340,\n        \"content\": \"## 拉取Docker镜像\\n获取最新版n8n镜像。您可根据需求调整此命令。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"1e7b547c-e9b1-4b91-8241-6cdd6a746100\",\n      \"name\": \"Sticky Note9\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        500,\n        -420\n      ],\n      \"parameters\": {\n        \"height\": 340,\n        \"content\": \"## Docker Compose 拉取\\n运行在您于默认变量中定义的目录下。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"f2817779-b2e9-4205-baf7-1f0481bae0e4\",\n      \"name\": \"Sticky Note10\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        780,\n        -420\n      ],\n      \"parameters\": {\n        \"height\": 340,\n        \"content\": \"## Docker Compose 启动\\n此步骤将使用新镜像启动容器。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"4823d32f-9237-444f-812f-1bc494d0e087\",\n      \"name\": \"Sticky Note11\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1060,\n        -420\n      ],\n      \"parameters\": {\n        \"height\": 340,\n        \"content\": \"## Telegram 通知\\n发送一条 Telegram 通知，告知 n8n 已更新。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"8bcf0308-7904-4635-8f0e-7335e360dabc\",\n      \"name\": \"docker compose up\",\n      \"type\": \"n8n-nodes-base.ssh\",\n      \"position\": [\n        840,\n        -240\n      ],\n      \"parameters\": {\n        \"cwd\": \"={{ $('Set Default variable').item.json['working-directory'] }}\",\n        \"command\": \"sudo docker compose up -d\"\n      },\n      \"credentials\": {\n        \"sshPassword\": {\n          \"id\": \"tqNyOVbQTikb35Tk\",\n          \"name\": \"SSH Password account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"add506c6-88b7-480c-be13-2de86f6094ca\",\n      \"name\": \"Sticky Note12\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -1840,\n        -660\n      ],\n      \"parameters\": {\n        \"height\": 340,\n        \"content\": \"## 定时触发器  \\n您可以为此工作流程设置定时任务，例如每三天检查一次n8n镜像。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"045ebd0a-9d54-4cae-8307-f23ed26103f9\",\n      \"name\": \"Set Default variable\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        -1480,\n        -320\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"c06b2d24-1fd7-40f0-aee5-b5d6553e289e\",\n              \"name\": \"working-directory\",\n              \"type\": \"string\",\n              \"value\": \"\"\n            },\n            {\n              \"id\": \"451aad67-5190-4eab-a982-56092734bb07\",\n              \"name\": \"n8n-container-name\",\n              \"type\": \"string\",\n              \"value\": \"\"\n            },\n            {\n              \"id\": \"8a294900-f367-47a2-b260-344b133dc2ff\",\n              \"name\": \"telegram-id\",\n              \"type\": \"string\",\n              \"value\": \"598677820\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4,\n      \"alwaysOutputData\": true\n    },\n    {\n      \"id\": \"6bc2b28c-0f3c-44aa-a536-766f972f9e22\",\n      \"name\": \"Github HTTP Request\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        -1240,\n        -220\n      ],\n      \"parameters\": {\n        \"url\": \"https://api.github.com/repos/n8n-io/n8n/releases/latest\",\n        \"options\": {}\n      },\n      \"typeVersion\": 4.2,\n      \"alwaysOutputData\": false\n    },\n    {\n      \"id\": \"8ba3f574-9f2b-48d2-95fc-b57d57ecf6c1\",\n      \"name\": \"Merge Results\",\n      \"type\": \"n8n-nodes-base.merge\",\n      \"position\": [\n        -660,\n        -560\n      ],\n      \"parameters\": {\n        \"mode\": \"combineBySql\",\n        \"query\": \"SELECT input1.stdout, input2.tag_name \\nFROM input1 \\nLEFT JOIN input2 ON true;\"\n      },\n      \"typeVersion\": 3.1\n    },\n    {\n      \"id\": \"c97723c3-1733-4481-add2-7ecae02ea144\",\n      \"name\": \"Edit Version String\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        -960,\n        -220\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"f6e5cc51-aa49-46e5-aa4c-73baec811afa\",\n              \"name\": \"tag_name\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json[\\\"tag_name\\\"].replace(\\\"n8n@\\\", \\\"\\\") }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"22bec435-84ba-44bb-8127-c5b099fda7f2\",\n      \"name\": \"Comapre Two Input\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        -320,\n        -500\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"e88d2c77-5ee1-4296-a612-d9b2290f6e03\",\n              \"operator\": {\n                \"type\": \"string\",\n                \"operation\": \"equals\"\n              },\n              \"leftValue\": \"={{ $json.stdout }}\",\n              \"rightValue\": \"={{ $json.tag_name }}\"\n            }\n          ]\n        },\n        \"looseTypeValidation\": \"=\"\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"be9bdef5-88f4-4f12-8938-82f8206b8655\",\n      \"name\": \"Telegram Notif\",\n      \"type\": \"n8n-nodes-base.telegram\",\n      \"position\": [\n        0,\n        -860\n      ],\n      \"webhookId\": \"38d19f3d-0ef4-40df-b831-701ea242bb8f\",\n      \"parameters\": {\n        \"text\": \"n8n is up to date.\",\n        \"chatId\": \"={{ $('Set Default variable').item.json['telegram-id'] }}\",\n        \"additionalFields\": {}\n      },\n      \"credentials\": {\n        \"telegramApi\": {\n          \"id\": \"Zx3ibmlSzRKZQsFa\",\n          \"name\": \"Telegram account\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"59ece477-dcf2-4898-a362-7fcd35a49315\",\n      \"name\": \"Telegram Approve\",\n      \"type\": \"n8n-nodes-base.telegram\",\n      \"position\": [\n        20,\n        -240\n      ],\n      \"webhookId\": \"e816696f-cb7a-4036-92bf-eafb5f06778c\",\n      \"parameters\": {\n        \"chatId\": \"={{ $('Set Default variable').item.json['telegram-id'] }}\",\n        \"message\": \"Hi, \\na new n8n version is available. \\nI'm ready to update. \\nCan I start now?\",\n        \"options\": {},\n        \"operation\": \"sendAndWait\"\n      },\n      \"credentials\": {\n        \"telegramApi\": {\n          \"id\": \"Zx3ibmlSzRKZQsFa\",\n          \"name\": \"Telegram account\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"292efcfd-bbd7-4170-9e9f-020f10483c5e\",\n      \"name\": \"Telegram Notif1\",\n      \"type\": \"n8n-nodes-base.telegram\",\n      \"position\": [\n        1120,\n        -240\n      ],\n      \"webhookId\": \"254019a6-a298-4a9e-b100-8b92f22469c3\",\n      \"parameters\": {\n        \"text\": \"We are updating n8n to the latest version.\",\n        \"chatId\": \"={{ $('Set Default variable').item.json['telegram-id'] }}\",\n        \"additionalFields\": {}\n      },\n      \"credentials\": {\n        \"telegramApi\": {\n          \"id\": \"Zx3ibmlSzRKZQsFa\",\n          \"name\": \"Telegram account\"\n        }\n      },\n      \"typeVersion\": 1.2\n    }\n  ],\n  \"active\": true,\n  \"pinData\": {},\n  \"settings\": {\n    \"timezone\": \"Asia/Tehran\",\n    \"callerPolicy\": \"workflowsFromSameOwner\",\n    \"executionOrder\": \"v1\",\n    \"saveExecutionProgress\": false\n  },\n  \"versionId\": \"e7c52f1d-e131-4911-bf04-5d3ebefc8271\",\n  \"connections\": {\n    \"Merge Results\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Comapre Two Input\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Pull n8n Image\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"docker compose pull\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Telegram Notif1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Comapre Two Input\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Schedule Trigger\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Set Default variable\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Telegram Approve\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Pull n8n Image\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Comapre Two Input\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Telegram Notif\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Telegram Approve\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"docker compose up\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Telegram Notif1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Edit Version String\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge Results\",\n            \"type\": \"main\",\n            \"index\": 1\n          }\n        ]\n      ]\n    },\n    \"Github HTTP Request\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Edit Version String\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"docker compose pull\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"docker compose up\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Set Default variable\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"check n8n installed version\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Github HTTP Request\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"check n8n installed version\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge Results\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"When clicking ‘Test workflow’\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Set Default variable\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}