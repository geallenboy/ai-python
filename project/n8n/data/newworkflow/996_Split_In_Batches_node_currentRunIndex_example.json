{
  "url": "https://n8n.io/workflows/996-split-in-batches-node-currentrunindex-example/",
  "title": "Split In Batches node currentRunIndex example",
  "author": "Harshil Agrawal",
  "publish_date": "Last update 10 months ago",
  "publish_date_absolute": "2024-07-25",
  "categories": [
    {
      "name": "Building Blocks"
    }
  ],
  "workflow_json": "{\"nodes\":[{\"name\":\"On clicking 'execute'\",\"type\":\"n8n-nodes-base.manualTrigger\",\"position\":[430,310],\"parameters\":{},\"typeVersion\":1},{\"name\":\"Function\",\"type\":\"n8n-nodes-base.function\",\"position\":[630,310],\"parameters\":{\"functionCode\":\"const newItems = [];\\n\\nfor (let i=0;i<10;i++) {\\n  newItems.push({json:{i}});\\n}\\n\\nreturn newItems;\"},\"typeVersion\":1},{\"name\":\"SplitInBatches\",\"type\":\"n8n-nodes-base.splitInBatches\",\"position\":[830,310],\"parameters\":{\"options\":{},\"batchSize\":1},\"typeVersion\":1},{\"name\":\"IF\",\"type\":\"n8n-nodes-base.if\",\"position\":[1030,460],\"parameters\":{\"conditions\":{\"number\":[{\"value1\":\"={{$node[\\\"SplitInBatches\\\"].context[\\\"currentRunIndex\\\"];}}\",\"value2\":5,\"operation\":\"equal\"}],\"boolean\":[]}},\"typeVersion\":1},{\"name\":\"Set\",\"type\":\"n8n-nodes-base.set\",\"position\":[1230,360],\"parameters\":{\"values\":{\"string\":[{\"name\":\"Message\",\"value\":\"Loop Ended\"}]},\"options\":{},\"keepOnlySet\":true},\"typeVersion\":1}],\"connections\":{\"IF\":{\"main\":[[{\"node\":\"Set\",\"type\":\"main\",\"index\":0}],[{\"node\":\"SplitInBatches\",\"type\":\"main\",\"index\":0}]]},\"Function\":{\"main\":[[{\"node\":\"SplitInBatches\",\"type\":\"main\",\"index\":0}]]},\"SplitInBatches\":{\"main\":[[{\"node\":\"IF\",\"type\":\"main\",\"index\":0}]]},\"On clicking 'execute'\":{\"main\":[[{\"node\":\"Function\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "This workflow demonstrates how to use `currentRunIndex` to get the running index.\n\n**Function node:** This node generates mock data for the workflow. Replace it with the node whose data you want to split into batches.\n\n**SplitInBatches node:** This node splits the data with the batch size equal to `1`. Based on your use-case, set the value of the Batch Size.\n\n**IF node:** This node checks the running index. If the running index equals `5` the node returns `true` and breaks the loop.  \nThe node uses the expression `{{$node[\"SplitInBatches\"].context[\"currentRunIndex\"];}}`, which returns the running index.\n\n**Set node:** This node prints a message `Loop Ended`. Based on your use-case, connect the false output of the _IF_ node to the input of the node you want to execute if the condition is `false`.\n",
  "crawled_at": "2025-05-25T19:13:18.583277",
  "readme_zh": "本工作流演示了如何利用`currentRunIndex`获取当前运行索引。\n\n**函数节点：** 该节点为工作流生成模拟数据，实际使用时请替换为需要分批次处理数据的节点。\n\n**分批处理节点：** 以批次大小为`1`对数据进行拆分，请根据实际需求调整批次大小数值。\n\n**条件判断节点：** 该节点检测运行索引，当索引值等于`5`时返回`true`并终止循环。  \n节点使用表达式`{{$node[\"SplitInBatches\"].context[\"currentRunIndex\"];}}`来获取当前运行索引值。\n\n**设置节点：** 该节点输出消息`循环结束`。根据业务需求，可将条件判断节点的`false`输出端连接至条件不成立时需要执行的节点输入端。",
  "title_zh": "分批处理节点 currentRunIndex 示例",
  "publish_date_zh": "最后更新于10个月前",
  "workflow_json_zh": "{\n  \"nodes\": [\n    {\n      \"name\": \"On clicking 'execute'\",\n      \"type\": \"n8n-nodes-base.manualTrigger\",\n      \"position\": [\n        430,\n        310\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Function\",\n      \"type\": \"n8n-nodes-base.function\",\n      \"position\": [\n        630,\n        310\n      ],\n      \"parameters\": {\n        \"functionCode\": \"const newItems = [];\\n\\nfor (let i=0;i<10;i++) {\\n  newItems.push({json:{i}});\\n}\\n\\nreturn newItems;\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"SplitInBatches\",\n      \"type\": \"n8n-nodes-base.splitInBatches\",\n      \"position\": [\n        830,\n        310\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"batchSize\": 1\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"IF\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        1030,\n        460\n      ],\n      \"parameters\": {\n        \"conditions\": {\n          \"number\": [\n            {\n              \"value1\": \"={{$node[\\\"SplitInBatches\\\"].context[\\\"currentRunIndex\\\"];}}\",\n              \"value2\": 5,\n              \"operation\": \"equal\"\n            }\n          ],\n          \"boolean\": []\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Set\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1230,\n        360\n      ],\n      \"parameters\": {\n        \"values\": {\n          \"string\": [\n            {\n              \"name\": \"Message\",\n              \"value\": \"Loop Ended\"\n            }\n          ]\n        },\n        \"options\": {},\n        \"keepOnlySet\": true\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"connections\": {\n    \"IF\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Set\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"SplitInBatches\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Function\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"SplitInBatches\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"SplitInBatches\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"IF\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"On clicking 'execute'\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Function\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}