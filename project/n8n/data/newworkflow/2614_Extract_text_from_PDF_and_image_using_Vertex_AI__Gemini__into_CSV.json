{
  "url": "https://n8n.io/workflows/2614-extract-text-from-pdf-and-image-using-vertex-ai-gemini-into-csv/",
  "title": "Extract text from PDF and image using Vertex AI (Gemini) into CSV",
  "author": "Keith Rumjahn",
  "publish_date": "Last update 6 months ago",
  "publish_date_absolute": "2024-11-26",
  "categories": [
    {
      "name": "AI"
    }
  ],
  "workflow_json": "",
  "readme": "![Cover1024x576.png](https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/Cover_1024x576_751377aeda.png)\n\n# Case Study\n\nI'm too lazy to record every transaction for my expense tracking. Since all my expenses are digital, I just extract the transactions from bank PDF statements and screenshots into CSV to import into my budgeting software.\n\n[Read more -> How I used A.I. to track all my expenses](https://rumjahn.com/how-to-extract-pdf-and-image-text-into-csv-using-n8n-without-manual-data-entry/)\n\n# What this workflow does\n\n  * Upload your PDF or screenshots into Google Drive\n  * It then passes the PDF/image to Vertex Gemini to do some A.I. image recognition\n  * It then sends the transactions as CSV and stores it into another Google Drive folder\n\n\n\n# Setup\n\n  1. Set up 2 google drive folders. 1 for uploading and 1 for the output.\n  2. Input your Google Drive crendtials\n  3. Input your Vertex Gemini credentials\n\n\n\n# How to adjust it to your needs\n\n  * You can upload other types of documents for information extraction.\n  * You can extract any text data from any image or PDF\n  * You can adjust the A.I. prompt to do different things\n\n\n",
  "crawled_at": "2025-05-26T00:45:03.007694",
  "readme_zh": "![å°é¢1024x576.png](https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/Cover_1024x576_751377aeda.png)\n\n# æ¡ˆä¾‹ç ”ç©¶\n\næˆ‘æ‡’å¾—é€ç¬”è®°å½•æ¯é¡¹æ¶ˆè´¹å¼€æ”¯ã€‚ç”±äºæ‰€æœ‰æ”¯å‡ºéƒ½æ˜¯æ•°å­—åŒ–çš„ï¼Œæˆ‘ç›´æ¥ä»é“¶è¡ŒPDFå¯¹è´¦å•å’Œæˆªå›¾ä¸­æå–äº¤æ˜“è®°å½•ï¼Œè½¬æ¢æˆCSVæ ¼å¼å¯¼å…¥é¢„ç®—ç®¡ç†è½¯ä»¶ã€‚\n\n[é˜…è¯»å…¨æ–‡ -> å¦‚ä½•åˆ©ç”¨äººå·¥æ™ºèƒ½è¿½è¸ªæ‰€æœ‰å¼€æ”¯](https://rumjahn.com/how-to-extract-pdf-and-image-text-into-csv-using-n8n-without-manual-data-entry/)\n\n# æœ¬å·¥ä½œæµåŠŸèƒ½\n\n  * å°†PDFæˆ–æˆªå›¾ä¸Šä¼ è‡³Google Drive\n  * é€šè¿‡Vertex Geminiè¿›è¡ŒAIå›¾åƒè¯†åˆ«å¤„ç†\n  * å°†äº¤æ˜“è®°å½•ä»¥CSVæ ¼å¼è¾“å‡ºå¹¶å­˜å‚¨è‡³å¦ä¸€ä¸ªGoogle Driveæ–‡ä»¶å¤¹\n\n# é…ç½®æ­¥éª¤\n\n  1. å»ºç«‹ä¸¤ä¸ªGoogle Driveæ–‡ä»¶å¤¹ï¼šä¸€ä¸ªç”¨äºä¸Šä¼ ï¼Œä¸€ä¸ªç”¨äºè¾“å‡º\n  2. è¾“å…¥æ‚¨çš„Google Driveå‡­è¯\n  3. è¾“å…¥æ‚¨çš„Vertex Geminiå‡­è¯\n\n# ä¸ªæ€§åŒ–è°ƒæ•´å»ºè®®\n\n  * å¯æ‰©å±•è‡³å…¶ä»–ç±»å‹æ–‡æ¡£çš„ä¿¡æ¯æå–\n  * æ”¯æŒä»ä»»æ„å›¾ç‰‡æˆ–PDFä¸­æå–æ–‡æœ¬æ•°æ®\n  * å¯ä¿®æ”¹AIæŒ‡ä»¤å®ç°ä¸åŒåŠŸèƒ½",
  "title_zh": "ä½¿ç”¨Vertex AIï¼ˆGeminiï¼‰ä»PDFå’Œå›¾åƒä¸­æå–æ–‡æœ¬è‡³CSV",
  "publish_date_zh": "æœ€åæ›´æ–°äº5ä¸ªæœˆå‰",
  "workflow_json_zh": "{\n  \"id\": \"sUIPemKdKqmUQFt6\",\n  \"meta\": {\n    \"instanceId\": \"558d88703fb65b2d0e44613bc35916258b0f0bf983c5d4730c00c424b77ca36a\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"name\": \"Extract text from PDF and image using Vertex AI (Gemini) into CSV\",\n  \"tags\": [],\n  \"nodes\": [\n    {\n      \"id\": \"f60ef5f9-bc08-4cc9-804e-697ae6f88b9b\",\n      \"name\": \"Google Gemini Chat Model\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatGoogleGemini\",\n      \"position\": [\n        980,\n        920\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"modelName\": \"models/gemini-1.5-pro-latest\"\n      },\n      \"credentials\": {\n        \"googlePalmApi\": {\n          \"id\": \"hmNTKSKfppgtDbM5\",\n          \"name\": \"Google Gemini(PaLM) Api account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"81d3f7b8-20cb-4aac-82a9-d4e8e6581105\",\n      \"name\": \"Get PDF or Images\",\n      \"type\": \"n8n-nodes-base.googleDriveTrigger\",\n      \"position\": [\n        220,\n        420\n      ],\n      \"parameters\": {\n        \"event\": \"fileCreated\",\n        \"options\": {},\n        \"pollTimes\": {\n          \"item\": [\n            {\n              \"mode\": \"everyMinute\"\n            }\n          ]\n        },\n        \"triggerOn\": \"specificFolder\",\n        \"folderToWatch\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"1HOeRP5iwccg93UPUYmWYD7DyDmRREkhj\",\n          \"cachedResultUrl\": \"https://drive.google.com/drive/folders/1HOeRP5iwccg93UPUYmWYD7DyDmRREkhj\",\n          \"cachedResultName\": \"Actual Budget\"\n        },\n        \"authentication\": \"serviceAccount\"\n      },\n      \"credentials\": {\n        \"googleApi\": {\n          \"id\": \"axkK6IN61bEAT6GM\",\n          \"name\": \"Google Service Account account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"fe9a8228-7950-4e2c-8982-328e03725782\",\n      \"name\": \"Route based on PDF or Image\",\n      \"type\": \"n8n-nodes-base.switch\",\n      \"position\": [\n        480,\n        420\n      ],\n      \"parameters\": {\n        \"rules\": {\n          \"rules\": [\n            {\n              \"value2\": \"application/pdf\",\n              \"outputKey\": \"pdf\"\n            },\n            {\n              \"value2\": \"image/\",\n              \"operation\": \"contains\",\n              \"outputKey\": \"image\"\n            }\n          ]\n        },\n        \"value1\": \"={{$json.mimeType}}\",\n        \"dataType\": \"string\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"f62b71e5-af17-4f85-abff-7cee5100affc\",\n      \"name\": \"Download PDF\",\n      \"type\": \"n8n-nodes-base.googleDrive\",\n      \"position\": [\n        740,\n        320\n      ],\n      \"parameters\": {\n        \"fileId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $('Get PDF or Images').item.json.id }}\"\n        },\n        \"options\": {},\n        \"operation\": \"download\",\n        \"authentication\": \"serviceAccount\"\n      },\n      \"credentials\": {\n        \"googleApi\": {\n          \"id\": \"axkK6IN61bEAT6GM\",\n          \"name\": \"Google Service Account account\"\n        }\n      },\n      \"executeOnce\": true,\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"fa99fbcf-1353-410d-a0db-48cea1178a76\",\n      \"name\": \"Download Image\",\n      \"type\": \"n8n-nodes-base.googleDrive\",\n      \"position\": [\n        740,\n        740\n      ],\n      \"parameters\": {\n        \"fileId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $('Get PDF or Images').item.json.id }}\"\n        },\n        \"options\": {},\n        \"operation\": \"download\",\n        \"authentication\": \"serviceAccount\"\n      },\n      \"credentials\": {\n        \"googleApi\": {\n          \"id\": \"axkK6IN61bEAT6GM\",\n          \"name\": \"Google Service Account account\"\n        }\n      },\n      \"executeOnce\": true,\n      \"retryOnFail\": false,\n      \"typeVersion\": 3,\n      \"alwaysOutputData\": true\n    },\n    {\n      \"id\": \"e4979746-44bb-493e-b5eb-f9646b510888\",\n      \"name\": \"Extract data from PDF\",\n      \"type\": \"n8n-nodes-base.extractFromFile\",\n      \"position\": [\n        980,\n        320\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"operation\": \"pdf\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"6549c335-e749-4b95-b77d-096a5e77af5e\",\n      \"name\": \"Send data to A.I.\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1180,\n        320\n      ],\n      \"parameters\": {\n        \"url\": \"https://openrouter.ai/api/v1/chat/completions\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"jsonBody\": \"={\\n  \\\"model\\\": \\\"meta-llama/llama-3.1-70b-instruct:free\\\",\\n  \\\"messages\\\": [\\n    {\\n      \\\"role\\\": \\\"user\\\",\\n      \\\"content\\\": \\\"You are given a bank statement.{{encodeURIComponent($json.text)}}. Read the PDF and export all the transactions as CSV. Add a column called category and based on the information assign a category name. Return only the CSV data starting with the header row.\\\"\\n    }\\n  ]\\n}\",\n        \"sendBody\": true,\n        \"specifyBody\": \"json\",\n        \"authentication\": \"genericCredentialType\",\n        \"genericAuthType\": \"httpHeaderAuth\"\n      },\n      \"credentials\": {\n        \"httpHeaderAuth\": {\n          \"id\": \"WY7UkF14ksPKq3S8\",\n          \"name\": \"Header Auth account 2\"\n        }\n      },\n      \"typeVersion\": 4.2,\n      \"alwaysOutputData\": false\n    },\n    {\n      \"id\": \"42341f03-c9fc-4290-963e-1a723202a739\",\n      \"name\": \"Convert to CSV\",\n      \"type\": \"n8n-nodes-base.convertToFile\",\n      \"position\": [\n        1400,\n        320\n      ],\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"bb446447-3f46-47e7-96a2-3fc720715828\",\n      \"name\": \"Upload to Google Drive\",\n      \"type\": \"n8n-nodes-base.googleDrive\",\n      \"position\": [\n        1640,\n        320\n      ],\n      \"parameters\": {\n        \"name\": \"={{$today}}\",\n        \"driveId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"My Drive\",\n          \"cachedResultUrl\": \"https://drive.google.com/drive/my-drive\",\n          \"cachedResultName\": \"My Drive\"\n        },\n        \"options\": {},\n        \"folderId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"1Zo4OFCv1qWRX1jo0VL_iqUBf4v0fZEXe\",\n          \"cachedResultUrl\": \"https://drive.google.com/drive/folders/1Zo4OFCv1qWRX1jo0VL_iqUBf4v0fZEXe\",\n          \"cachedResultName\": \"CSV Exports\"\n        },\n        \"authentication\": \"serviceAccount\"\n      },\n      \"credentials\": {\n        \"googleApi\": {\n          \"id\": \"axkK6IN61bEAT6GM\",\n          \"name\": \"Google Service Account account\"\n        }\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"843bc9c1-79a6-4f42-b9ee-fbec5f30b18d\",\n      \"name\": \"Convert to CSV2\",\n      \"type\": \"n8n-nodes-base.convertToFile\",\n      \"position\": [\n        1360,\n        740\n      ],\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"6404bf65-3a7e-4be9-9b7f-98a23dca2ffd\",\n      \"name\": \"Upload to Google Drive1\",\n      \"type\": \"n8n-nodes-base.googleDrive\",\n      \"position\": [\n        1640,\n        740\n      ],\n      \"parameters\": {\n        \"name\": \"={{$today}}\",\n        \"driveId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"My Drive\",\n          \"cachedResultUrl\": \"https://drive.google.com/drive/my-drive\",\n          \"cachedResultName\": \"My Drive\"\n        },\n        \"options\": {},\n        \"folderId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"1Zo4OFCv1qWRX1jo0VL_iqUBf4v0fZEXe\",\n          \"cachedResultUrl\": \"https://drive.google.com/drive/folders/1Zo4OFCv1qWRX1jo0VL_iqUBf4v0fZEXe\",\n          \"cachedResultName\": \"CSV Exports\"\n        },\n        \"authentication\": \"serviceAccount\"\n      },\n      \"credentials\": {\n        \"googleApi\": {\n          \"id\": \"axkK6IN61bEAT6GM\",\n          \"name\": \"Google Service Account account\"\n        }\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"5dd5771f-6ccb-47ab-acbb-d6cbec60d22b\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        220,\n        -40\n      ],\n      \"parameters\": {\n        \"width\": 589.0376569037658,\n        \"height\": 163.2468619246862,\n        \"content\": \"## å¦‚ä½•ä½¿ç”¨n8nå°†PDFå’Œå›¾ç‰‡ä¸­çš„æ–‡æœ¬æå–ä¸ºCSVï¼ˆæ— éœ€æ‰‹åŠ¨è¾“å…¥ï¼‰\\n\\næ­¤å·¥ä½œæµå°†ä»PDFå’Œå›¾ç‰‡ä¸­æå–æ–‡æœ¬æ•°æ®ï¼Œå¹¶å°†å…¶å­˜å‚¨ä¸ºCSVæ ¼å¼ã€‚\\n\\n[ğŸ’¡ ç‚¹å‡»æ­¤å¤„äº†è§£æ›´å¤šå…³äºæ­¤å·¥ä½œæµçš„ä¿¡æ¯](https://rumjahn.com/how-to-create-an-a-i-agent-to-analyze-matomo-analytics-using-n8n-for-free/)\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"37416630-9b52-4ce6-98d0-1bdd39ff0d6b\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        160,\n        160\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 248.11715481171547,\n        \"height\": 432.7364016736402,\n        \"content\": \"## è·å–PDFæˆ–å›¾ç‰‡æ–‡ä»¶\\næ‚¨éœ€è¦åœ¨Googleäº‘ç«¯ç¡¬ç›˜ä¸­æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ç”¨äºä¸Šä¼ PDFå’Œå›¾ç‰‡æ–‡ä»¶ã€‚\\n\\nåˆ›å»ºæ–‡ä»¶å¤¹åï¼Œè¯·é€šè¿‡ç‚¹å‡»\\\"å…±äº«\\\"->\\\"æ·»åŠ ç”¨æˆ·\\\"æ¥æ·»åŠ æ‚¨çš„è°·æ­Œäº‘è´¦æˆ·ç”¨æˆ·ã€‚è¯¥ç”¨æˆ·é‚®ç®±æ ¼å¼åº”ä¸ºï¼šn8n-server@n8n-server-435232.iam.gserviceaccount.com\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"3ab10f17-de8f-4263-aef8-cc2fb090ffe5\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1120,\n        52.864368048917754\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"height\": 446.3929762816575,\n        \"content\": \"## å‘é€è‡³Openrouter\\nä½¿ç”¨æ­¤åŠŸèƒ½éœ€å…ˆæ³¨å†ŒOpenrouterè´¦æˆ·ã€‚æ•°æ®å°†è¢«å‘é€è‡³Openrouterè¿›è¡Œæ–‡æœ¬æå–ã€‚\\n\\nè¯·ä½¿ç”¨å¤´éƒ¨è®¤è¯ã€‚åç§°ä¸º\\\"Authorization\\\"ï¼Œå€¼ä¸º\\\"Bearer {APIä»¤ç‰Œ}\\\"ã€‚\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"e966f95c-c54e-4d11-895d-d5f75c53aca5\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        920,\n        540\n      ],\n      \"parameters\": {\n        \"color\": 6,\n        \"width\": 399.0962343096232,\n        \"height\": 517.154811715481,\n        \"content\": \"## ç”¨äºå›¾åƒè¯†åˆ«çš„Vertex AI\\næˆ‘ä»¬å°†å›¾ç‰‡å‘é€è‡³Vertex AIè¿›è¡Œæ–‡æœ¬æå–ã€‚æ‚¨éœ€è¦å¯ç”¨Vertex AIæœåŠ¡å¹¶ä¸ºè°·æ­Œäº‘å‡­è¯é…ç½®æ­£ç¡®æƒé™ã€‚\\n- å¯ç”¨Vertex AI API\\n- å‘ç”¨æˆ·è´¦å·æˆäºˆVertex AIæƒé™\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"daa3ab66-fa14-4792-96d0-3bcbeffd5d60\",\n      \"name\": \"Vertex A.I. extract text\",\n      \"type\": \"@n8n/n8n-nodes-langchain.chainLlm\",\n      \"position\": [\n        980,\n        740\n      ],\n      \"parameters\": {\n        \"text\": \"=Extract the transactions from the image\",\n        \"messages\": {\n          \"messageValues\": [\n            {\n              \"message\": \"=You are given a screenshot of payment transactions. Read the image and export all the transactions as CSV. Add a column called category and based on the information assign a category name. Return only the CSV data starting with the header row.\"\n            },\n            {\n              \"type\": \"HumanMessagePromptTemplate\",\n              \"messageType\": \"imageBinary\"\n            }\n          ]\n        },\n        \"promptType\": \"define\",\n        \"hasOutputParser\": true\n      },\n      \"typeVersion\": 1.4\n    }\n  ],\n  \"active\": false,\n  \"pinData\": {},\n  \"settings\": {\n    \"executionOrder\": \"v1\"\n  },\n  \"versionId\": \"80635382-3d1c-4e46-a753-84b033cfc3a7\",\n  \"connections\": {\n    \"Download PDF\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Extract data from PDF\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Convert to CSV\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Upload to Google Drive\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Download Image\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Vertex A.I. extract text\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Convert to CSV2\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Upload to Google Drive1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get PDF or Images\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Route based on PDF or Image\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Send data to A.I.\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Convert to CSV\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Extract data from PDF\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Send data to A.I.\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Google Gemini Chat Model\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"Vertex A.I. extract text\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Vertex A.I. extract text\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Convert to CSV2\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Route based on PDF or Image\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Download PDF\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Download Image\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}