{
  "url": "https://n8n.io/workflows/4379-website-downtime-alert-via-line-supabase-log/",
  "title": "Website Downtime Alert via LINE + Supabase Log",
  "author": "sayamol thiramonpaphakul",
  "publish_date": "Last update a day ago",
  "publish_date_absolute": "",
  "categories": [
    {
      "name": "DevOps"
    },
    {
      "name": "AI"
    }
  ],
  "workflow_json": "{\"nodes\":[{\"id\":\"6637ff1d-43ca-4545-b427-44568da387f9\",\"name\":\"Schedule Trigger\",\"type\":\"n8n-nodes-base.scheduleTrigger\",\"position\":[200,1100],\"parameters\":{\"rule\":{\"interval\":[{\"field\":\"minutes\"}]}},\"typeVersion\":1.2},{\"id\":\"f56c8d70-222d-436b-94c3-90f0018a3742\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-180,700],\"parameters\":{\"color\":3,\"width\":2500,\"height\":820,\"content\":\"## Monitor Website Check when Down ##\"},\"typeVersion\":1},{\"id\":\"675c17f6-f832-4a43-ac66-a5dea421bad8\",\"name\":\"Get Monitors\",\"type\":\"n8n-nodes-base.uptimeRobot\",\"position\":[420,1100],\"parameters\":{\"filters\":{},\"resource\":\"monitor\"},\"credentials\":{\"uptimeRobotApi\":{\"id\":\"km4n54HVtydW8mDc\",\"name\":\"Uptime Robot account - Synlora\"}},\"typeVersion\":1},{\"id\":\"2a73c7ca-0db5-4e1f-85f6-e9e18b7bde1b\",\"name\":\"LLM Message Format\",\"type\":\"@n8n/n8n-nodes-langchain.chainLlm\",\"position\":[1080,1100],\"parameters\":{\"text\":\"={{ $json.text }} List all affected sites and add a short funny wish for the IT team.\",\"promptType\":\"define\"},\"typeVersion\":1.6},{\"id\":\"332f202e-c87d-49d1-aa7a-942631547058\",\"name\":\"OpenAI GPT-4o Mini\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\"position\":[1180,1320],\"parameters\":{\"model\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"gpt-4o-mini\"},\"options\":{}},\"credentials\":{\"openAiApi\":{\"id\":\"aYpST6RW43n0s7kw\",\"name\":\"OpenAi account - websayamol\"}},\"typeVersion\":1.2},{\"id\":\"64a391a8-4bdf-43ce-887f-af7a17e93904\",\"name\":\"Escape Newlines\",\"type\":\"n8n-nodes-base.code\",\"position\":[1460,1200],\"parameters\":{\"jsCode\":\"const rawText = $input.first().json.text || '';\\nconst cleanedText = rawText.replace(/\\\\n/g, '\\\\\\\\n');\\nreturn [{ json: { text: cleanedText } }];\"},\"typeVersion\":2},{\"id\":\"171b91d8-b502-4a08-9056-ac075f215983\",\"name\":\"Send to LINE\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[1680,1200],\"parameters\":{\"url\":\"https://api.line.me/v2/bot/message/push\",\"method\":\"POST\",\"options\":{},\"jsonBody\":\"={\\n  \\\"to\\\": \\\"<YOUR_LINE_GROUP_ID>\\\",\\n  \\\"messages\\\": [\\n    {\\n      \\\"type\\\": \\\"text\\\",\\n      \\\"text\\\": \\\"{{ $json.text }}\\\"\\n    }\\n  ]\\n} \",\"sendBody\":true,\"jsonHeaders\":\"{\\n  \\\"Authorization\\\": \\\"Bearer <YOUR_LINE_CHANNEL_TOKEN>\\\",\\n  \\\"Content-Type\\\": \\\"application/json\\\"\\n}\",\"sendHeaders\":true,\"specifyBody\":\"json\",\"specifyHeaders\":\"json\"},\"typeVersion\":4.2},{\"id\":\"b8b4beb8-e2a9-45d7-88b1-9409519d070f\",\"name\":\"Filter Down Monitors\",\"type\":\"n8n-nodes-base.code\",\"position\":[640,1200],\"parameters\":{\"jsCode\":\"const statusMap = { 0: \\\"⏸️ Paused\\\", 1: \\\"🕐 Not Checked Yet\\\", 2: \\\"✅ Up\\\", 8: \\\"⚠️ May Be Down\\\", 9: \\\"🔴 Down\\\" };\\nconst now = new Date();\\nconst options = { timeZone: 'Asia/Bangkok' };\\nconst dateStr = now.toLocaleDateString('en-GB', options);\\nconst timeStr = now.toLocaleTimeString('en-GB', { hour: '2-digit', minute: '2-digit', hour12: false, timeZone: 'Asia/Bangkok' });\\nlet message = `Some websites seem to be 🔴 down or ⚠️ unstable.\\\\n📅 Date: ${dateStr} Time: ${timeStr} hrs\\\\n\\\\n`;\\nlet server_down = 0;\\nfor (const item of items) {\\n  const id = item.json.id;\\n  const name = item.json.friendly_name || item.json.name;\\n  const statusCode = item.json.status;\\n  const statusText = statusMap[statusCode] || statusCode;\\n  if ((statusCode === 8 || statusCode === 9) && id !== 798534759) {\\n    message += `• ${name} ➤ ${statusText}\\\\n`;\\n    server_down = 1;\\n  }\\n}\\nreturn [{ json: { server_down, text: message } }];\"},\"typeVersion\":2},{\"id\":\"2f2d9c4c-5d4e-483f-b800-f9cfe7c2e67c\",\"name\":\"If Down\",\"type\":\"n8n-nodes-base.if\",\"position\":[860,1200],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"operator\":{\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $json.server_down.toString() }}\",\"rightValue\":\"1\"}]}},\"typeVersion\":2.2},{\"id\":\"4498a432-f4b6-4beb-978a-58cc9fdbbd64\",\"name\":\"Wait 30 Min\",\"type\":\"n8n-nodes-base.wait\",\"position\":[1900,1200],\"parameters\":{\"unit\":\"minutes\",\"amount\":30},\"typeVersion\":1.1},{\"id\":\"c0b608e5-0da6-4e13-9334-35b0b6e9ab1a\",\"name\":\"Loop Over Monitors\",\"type\":\"n8n-nodes-base.splitInBatches\",\"position\":[640,960],\"parameters\":{\"options\":{},\"batchSize\":\"={{ $json.id }}\"},\"typeVersion\":3},{\"id\":\"002eaa11-a871-4387-9cee-77c389ca43b4\",\"name\":\"Filter Status 9\",\"type\":\"n8n-nodes-base.filter\",\"position\":[860,1000],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"loose\"},\"combinator\":\"and\",\"conditions\":[{\"operator\":{\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $json.status }}\",\"rightValue\":\"9\"}]}},\"typeVersion\":2.2},{\"id\":\"a6b467c6-6f0e-41ac-8d15-7d70863f6499\",\"name\":\"Save to Supabase\",\"type\":\"n8n-nodes-base.supabase\",\"position\":[860,800],\"parameters\":{\"tableId\":\"synlora_uptime_down\",\"fieldsUi\":{\"fieldValues\":[{\"fieldId\":\"website\",\"fieldValue\":\"={{ $json.friendly_name }}\"},{\"fieldId\":\"statue\",\"fieldValue\":\"={{ $json.status }}\"},{\"fieldId\":\"uptime_id\",\"fieldValue\":\"={{ $json.id }}\"}]}},\"credentials\":{\"supabaseApi\":{\"id\":\"SeVvA2bO6waWD6kW\",\"name\":\"Supabase account_DB-Synlora_n8n\"}},\"typeVersion\":1}],\"connections\":{\"If Down\":{\"main\":[[{\"node\":\"LLM Message Format\",\"type\":\"main\",\"index\":0}]]},\"Get Monitors\":{\"main\":[[{\"node\":\"Filter Down Monitors\",\"type\":\"main\",\"index\":0},{\"node\":\"Loop Over Monitors\",\"type\":\"main\",\"index\":0}]]},\"Send to LINE\":{\"main\":[[{\"node\":\"Wait 30 Min\",\"type\":\"main\",\"index\":0}]]},\"Escape Newlines\":{\"main\":[[{\"node\":\"Send to LINE\",\"type\":\"main\",\"index\":0}]]},\"Filter Status 9\":{\"main\":[[{\"node\":\"Loop Over Monitors\",\"type\":\"main\",\"index\":0}]]},\"Schedule Trigger\":{\"main\":[[{\"node\":\"Get Monitors\",\"type\":\"main\",\"index\":0}]]},\"LLM Message Format\":{\"main\":[[{\"node\":\"Escape Newlines\",\"type\":\"main\",\"index\":0}]]},\"Loop Over Monitors\":{\"main\":[[{\"node\":\"Save to Supabase\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Filter Status 9\",\"type\":\"main\",\"index\":0}]]},\"Filter Down Monitors\":{\"main\":[[{\"node\":\"If Down\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "This workflow automatically checks the status of your websites using UptimeRobot API. If any site is down or unstable, it will:\n\n  * Generate a natural-language alert message using GPT-4o\n  * Push the message to a LINE group (with funny IT-style encouragement)\n  * Log all DOWN status entries into your Supabase database\n  * Wait 30 minutes before repeating\n\n\n\n🔧 How It Works\n\n  1. Schedule Trigger – Runs on a fixed interval (every few minutes).\n  2. UptimeRobot Node – Fetches website monitor data.\n  3. Code Node (Filter) – Filters only websites with status 8 (may be down) or 9 (down).\n  4. IF Node – If any site is down, proceed.\n  5. LangChain LLM Node – Formats alert with a humorous message using GPT-4o.\n  6. Line Notify (HTTP Request) – Sends the alert to your LINE group.\n  7. Loop Over Items – Loops through all monitors.\n  8. Filter Down (Status = 9) – Selects only “fully down” sites.\n  9. Supabase Node – Logs these into synlora_uptime_down table.\n  10. Wait Node – Delays next alert by 30 minutes to avoid spamming.\n\n\n\n⚙️ Setup Steps\n\nRequired:\n\n  * 🔗 UptimeRobot API Key\n  * 📲 LINE Channel Access Token and Group ID\n  * 🧠 OpenAI Key (GPT-4o Mini)\n  * 🗃️ Supabase Project & Table\n\n\n\nStep-by-step:\n\n  1. Go to UptimeRobot → Get API key and ensure monitors are set up.\n  2. Create a Supabase table with fields: website, status, uptime_id.\n  3. Create a LINE Messaging API bot, join it to your group, and get: \n     1. Access Token\n     2. Group ID (userId or groupId)\n  4. Add your OpenAI API Key for GPT-4o Mini (or switch to your preferred LLM).\n  5. Import the workflow JSON into n8n.\n  6. Set credentials in all necessary nodes.\n  7. Activate the workflow.\n\n\n",
  "crawled_at": "2025-05-27T23:15:39.998415",
  "readme_zh": "该工作流通过UptimeRobot API自动监测网站状态，当发现站点异常时会：\n\n  * 调用GPT-4o生成自然语言告警信息\n  * 推送带幽默IT风格鼓励语的消息至LINE群组\n  * 将所有宕机记录存入Supabase数据库\n  * 间隔30分钟后重新检测",
  "title_zh": "通过LINE + Supabase日志发送网站停机警报",
  "publish_date_zh": "最近更新于一天前",
  "workflow_json_zh": "{\n  \"nodes\": [\n    {\n      \"id\": \"6637ff1d-43ca-4545-b427-44568da387f9\",\n      \"name\": \"Schedule Trigger\",\n      \"type\": \"n8n-nodes-base.scheduleTrigger\",\n      \"position\": [\n        200,\n        1100\n      ],\n      \"parameters\": {\n        \"rule\": {\n          \"interval\": [\n            {\n              \"field\": \"minutes\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"f56c8d70-222d-436b-94c3-90f0018a3742\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -180,\n        700\n      ],\n      \"parameters\": {\n        \"color\": 3,\n        \"width\": 2500,\n        \"height\": 820,\n        \"content\": \"## 网站监控检查宕机时 ##\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"675c17f6-f832-4a43-ac66-a5dea421bad8\",\n      \"name\": \"Get Monitors\",\n      \"type\": \"n8n-nodes-base.uptimeRobot\",\n      \"position\": [\n        420,\n        1100\n      ],\n      \"parameters\": {\n        \"filters\": {},\n        \"resource\": \"monitor\"\n      },\n      \"credentials\": {\n        \"uptimeRobotApi\": {\n          \"id\": \"km4n54HVtydW8mDc\",\n          \"name\": \"Uptime Robot account - Synlora\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"2a73c7ca-0db5-4e1f-85f6-e9e18b7bde1b\",\n      \"name\": \"LLM Message Format\",\n      \"type\": \"@n8n/n8n-nodes-langchain.chainLlm\",\n      \"position\": [\n        1080,\n        1100\n      ],\n      \"parameters\": {\n        \"text\": \"={{ $json.text }} List all affected sites and add a short funny wish for the IT team.\",\n        \"promptType\": \"define\"\n      },\n      \"typeVersion\": 1.6\n    },\n    {\n      \"id\": \"332f202e-c87d-49d1-aa7a-942631547058\",\n      \"name\": \"OpenAI GPT-4o Mini\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\n      \"position\": [\n        1180,\n        1320\n      ],\n      \"parameters\": {\n        \"model\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"gpt-4o-mini\"\n        },\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"aYpST6RW43n0s7kw\",\n          \"name\": \"OpenAi account - websayamol\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"64a391a8-4bdf-43ce-887f-af7a17e93904\",\n      \"name\": \"Escape Newlines\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        1460,\n        1200\n      ],\n      \"parameters\": {\n        \"jsCode\": \"const rawText = $input.first().json.text || '';\\nconst cleanedText = rawText.replace(/\\\\n/g, '\\\\\\\\n');\\nreturn [{ json: { text: cleanedText } }];\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"171b91d8-b502-4a08-9056-ac075f215983\",\n      \"name\": \"Send to LINE\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1680,\n        1200\n      ],\n      \"parameters\": {\n        \"url\": \"https://api.line.me/v2/bot/message/push\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"jsonBody\": \"={\\n  \\\"to\\\": \\\"<YOUR_LINE_GROUP_ID>\\\",\\n  \\\"messages\\\": [\\n    {\\n      \\\"type\\\": \\\"text\\\",\\n      \\\"text\\\": \\\"{{ $json.text }}\\\"\\n    }\\n  ]\\n} \",\n        \"sendBody\": true,\n        \"jsonHeaders\": \"{\\n  \\\"Authorization\\\": \\\"Bearer <YOUR_LINE_CHANNEL_TOKEN>\\\",\\n  \\\"Content-Type\\\": \\\"application/json\\\"\\n}\",\n        \"sendHeaders\": true,\n        \"specifyBody\": \"json\",\n        \"specifyHeaders\": \"json\"\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"b8b4beb8-e2a9-45d7-88b1-9409519d070f\",\n      \"name\": \"Filter Down Monitors\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        640,\n        1200\n      ],\n      \"parameters\": {\n        \"jsCode\": \"const statusMap = { 0: \\\"⏸️ Paused\\\", 1: \\\"🕐 Not Checked Yet\\\", 2: \\\"✅ Up\\\", 8: \\\"⚠️ May Be Down\\\", 9: \\\"🔴 Down\\\" };\\nconst now = new Date();\\nconst options = { timeZone: 'Asia/Bangkok' };\\nconst dateStr = now.toLocaleDateString('en-GB', options);\\nconst timeStr = now.toLocaleTimeString('en-GB', { hour: '2-digit', minute: '2-digit', hour12: false, timeZone: 'Asia/Bangkok' });\\nlet message = `Some websites seem to be 🔴 down or ⚠️ unstable.\\\\n📅 Date: ${dateStr} Time: ${timeStr} hrs\\\\n\\\\n`;\\nlet server_down = 0;\\nfor (const item of items) {\\n  const id = item.json.id;\\n  const name = item.json.friendly_name || item.json.name;\\n  const statusCode = item.json.status;\\n  const statusText = statusMap[statusCode] || statusCode;\\n  if ((statusCode === 8 || statusCode === 9) && id !== 798534759) {\\n    message += `• ${name} ➤ ${statusText}\\\\n`;\\n    server_down = 1;\\n  }\\n}\\nreturn [{ json: { server_down, text: message } }];\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"2f2d9c4c-5d4e-483f-b800-f9cfe7c2e67c\",\n      \"name\": \"If Down\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        860,\n        1200\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"operator\": {\n                \"type\": \"string\",\n                \"operation\": \"equals\"\n              },\n              \"leftValue\": \"={{ $json.server_down.toString() }}\",\n              \"rightValue\": \"1\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"4498a432-f4b6-4beb-978a-58cc9fdbbd64\",\n      \"name\": \"Wait 30 Min\",\n      \"type\": \"n8n-nodes-base.wait\",\n      \"position\": [\n        1900,\n        1200\n      ],\n      \"parameters\": {\n        \"unit\": \"minutes\",\n        \"amount\": 30\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"c0b608e5-0da6-4e13-9334-35b0b6e9ab1a\",\n      \"name\": \"Loop Over Monitors\",\n      \"type\": \"n8n-nodes-base.splitInBatches\",\n      \"position\": [\n        640,\n        960\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"batchSize\": \"={{ $json.id }}\"\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"002eaa11-a871-4387-9cee-77c389ca43b4\",\n      \"name\": \"Filter Status 9\",\n      \"type\": \"n8n-nodes-base.filter\",\n      \"position\": [\n        860,\n        1000\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"loose\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"operator\": {\n                \"type\": \"string\",\n                \"operation\": \"equals\"\n              },\n              \"leftValue\": \"={{ $json.status }}\",\n              \"rightValue\": \"9\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"a6b467c6-6f0e-41ac-8d15-7d70863f6499\",\n      \"name\": \"Save to Supabase\",\n      \"type\": \"n8n-nodes-base.supabase\",\n      \"position\": [\n        860,\n        800\n      ],\n      \"parameters\": {\n        \"tableId\": \"synlora_uptime_down\",\n        \"fieldsUi\": {\n          \"fieldValues\": [\n            {\n              \"fieldId\": \"website\",\n              \"fieldValue\": \"={{ $json.friendly_name }}\"\n            },\n            {\n              \"fieldId\": \"statue\",\n              \"fieldValue\": \"={{ $json.status }}\"\n            },\n            {\n              \"fieldId\": \"uptime_id\",\n              \"fieldValue\": \"={{ $json.id }}\"\n            }\n          ]\n        }\n      },\n      \"credentials\": {\n        \"supabaseApi\": {\n          \"id\": \"SeVvA2bO6waWD6kW\",\n          \"name\": \"Supabase account_DB-Synlora_n8n\"\n        }\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"connections\": {\n    \"If Down\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"LLM Message Format\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get Monitors\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Filter Down Monitors\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Loop Over Monitors\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Send to LINE\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Wait 30 Min\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Escape Newlines\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Send to LINE\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Filter Status 9\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Loop Over Monitors\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Schedule Trigger\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get Monitors\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"LLM Message Format\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Escape Newlines\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Loop Over Monitors\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Save to Supabase\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Filter Status 9\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Filter Down Monitors\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"If Down\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}