{
  "url": "https://n8n.io/workflows/3859-ai-customer-support-assistant-whatsapp-ready-works-for-any-business/",
  "title": "AI Customer Support Assistant · WhatsApp Ready · Works for Any Business",
  "author": "Mateo Fiorito Rocha",
  "publish_date": "Last update 16 days ago",
  "publish_date_absolute": "2025-05-10",
  "categories": [
    {
      "name": "Support"
    },
    {
      "name": "AI"
    }
  ],
  "workflow_json": "{\"id\":\"J2D0BssoDmn4BC6D\",\"meta\":{\"instanceId\":\"143d2ab55c8bffb06f8b9c7ad30335764fdc48bbbacecbe2218dadb998a32213\",\"templateCredsSetupCompleted\":true},\"name\":\"AI Customer-Support Assistant · WhatsApp Ready · Works for Any Business\",\"tags\":[],\"nodes\":[{\"id\":\"fe395033-e36e-42d4-a0ce-8362b172be31\",\"name\":\"AI Agent\",\"type\":\"@n8n/n8n-nodes-langchain.agent\",\"maxTries\":5,\"position\":[120,140],\"parameters\":{\"text\":\"={{ $json.messages[0].text.body }}\",\"options\":{\"maxIterations\":10,\"systemMessage\":\"=You are [Company Name]’s real-time website assistant for https://www.your-company-url.com.\\n\\nAVAILABLE TOOLS\\n• list_links(url) → { urls:[ … ] }  — returns up to 100 internal links from that page  \\n• get_page(url)   → { text:\\\"…\\\" }    — returns the visible, tag-free text of the page (JavaScript rendered if needed)\\n\\nSEARCH STRATEGY\\n1. Start with list_links on the root page.  \\n2. Pick ≤ 5 links whose URL or anchor text best match the user’s question (producto, pago, envío, servicio, política, etc.).  \\n3. For each chosen link call get_page once.  \\n4. Read the returned text and look for the answer.  \\n5. If the answer is still unknown, you may repeat steps 1-4 one level deeper.  \\n6. Stop after two list_links rounds **or** eight get_page calls (whichever comes first).\\n\\nANSWER RULES\\n• Reply in clear and friendly toon **as part of [Company Name]** (use “we”, “our”).  \\n• Keep answers concise but complete.  \\n• **No Markdown ni símbolos de formato. Nunca uses \\\\*, **, \\\\_, \\\\~, ni [texto](url).**  \\n  Write urls like: Descriptive Text ␣URL   Ej.: Combos https://…  \\n• Quote the exact wording for facts such as stock status, prices, envíos, métodos de pago, garantías o políticas.  \\n• If the information is not on the site, reply exactly:  \\n  “I can't find that information on our site right now. Do you want me to put you through to a human agent?”  \\n• Stay on-domain; ignore mailto:, tel:, javascript:, or off-site links.\\n• Finally, if any of the tools returns a status code 404, then reply:\\n\\\"Non-subscribed user.\\\"\",\"returnIntermediateSteps\":true},\"promptType\":\"define\",\"hasOutputParser\":true},\"retryOnFail\":false,\"typeVersion\":1.7,\"alwaysOutputData\":true,\"waitBetweenTries\":null},{\"id\":\"3953a213-6140-4603-a069-93718e4d8982\",\"name\":\"list_links\",\"type\":\"@n8n/n8n-nodes-langchain.toolHttpRequest\",\"position\":[260,420],\"parameters\":{\"url\":\"https://lemolex.app.n8n.cloud/webhook/list-links\",\"method\":\"POST\",\"sendBody\":true,\"parametersBody\":{\"values\":[{\"name\":\"url\",\"value\":\"https://www.your-company-url.com\",\"valueProvider\":\"fieldValue\"},{\"name\":\"auth-token\",\"value\":\"your-auth-token (read setup guide)\",\"valueProvider\":\"fieldValue\"}]},\"toolDescription\":\"Returns up to 100 unique, fully-qualified INTERNAL links for a given page.\\n\\nInput  (JSON body the model must supply)\\n  {\\n    \\\"url\\\": \\\"<absolute https://…>\\\"\\n  }\\n\\nBehaviour\\n  • Crawls only the domain of the input URL.\\n  • Converts relative <a href> values to absolute URLs.\\n  • Drops empty roots (\\\"/\\\"), mailto:, tel:, javascript:, and off-site links.\\n  • De-duplicates the list.\\n  • Responds with a JSON object:\\n\\n      {\\n        \\\"urls\\\": [ \\\"<link-1>\\\", \\\"<link-2>\\\", … ]\\n      }\\n\\nUse this tool when you need a navigation map of the current page.\\nPass one of the returned URLs back into other tools (e.g. get_text) to read its content.\\n\"},\"typeVersion\":1.1},{\"id\":\"21ceaf5e-d2d4-47c3-98cb-ee7c0ab0fcab\",\"name\":\"OpenAI Chat Model\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\"position\":[40,340],\"parameters\":{\"model\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"gpt-4o-mini\"},\"options\":{}},\"credentials\":{\"openAiApi\":{\"id\":\"jh4eAOIykIxQWUI9\",\"name\":\"OpenAi account\"}},\"typeVersion\":1.2},{\"id\":\"7e0e84c8-ad96-44d1-9de9-c639230418fd\",\"name\":\"WhatsApp Trigger\",\"type\":\"n8n-nodes-base.whatsAppTrigger\",\"position\":[-260,140],\"webhookId\":\"857366e8-7b6f-45a7-bbd1-f876002620d7\",\"parameters\":{\"updates\":[\"messages\"]},\"credentials\":{\"whatsAppTriggerApi\":{\"id\":\"EB6eAVg9ZBZGYsyX\",\"name\":\"WhatsApp OAuth account\"}},\"typeVersion\":1},{\"id\":\"c2a0ba34-4a23-4918-9be8-7b9d50279cde\",\"name\":\"cleanAnswer\",\"type\":\"n8n-nodes-base.code\",\"position\":[1040,120],\"parameters\":{\"jsCode\":\"// cleanAnswer – run once per item\\nlet txt = $('AI Agent').first().json.output || '';\\n\\n// 1. Remove bold / italic / strike markers\\ntxt = txt.replace(/[*_~]+/g, '');\\n\\n// 2. Convert [Texto](https://url) → Texto https://url\\ntxt = txt.replace(/\\\\[([^\\\\]]+)\\\\]\\\\((https?:\\\\/\\\\/[^\\\\s)]+)\\\\)/g, '$1 $2');\\n\\n// 3. Collapse 3+ blank lines\\ntxt = txt.replace(/\\\\n{3,}/g, '\\\\n\\\\n').trim();\\n\\nreturn [{ json: { answer: txt } }];\\n\"},\"typeVersion\":2},{\"id\":\"ef403af2-4543-4edb-80ae-afda1e98a2a9\",\"name\":\"get_page\",\"type\":\"@n8n/n8n-nodes-langchain.toolHttpRequest\",\"position\":[420,420],\"parameters\":{\"url\":\"https://lemolex.app.n8n.cloud/webhook/get_text\",\"method\":\"POST\",\"sendBody\":true,\"parametersBody\":{\"values\":[{\"name\":\"url\"},{\"name\":\"auth-token\",\"value\":\"your-auth-token (read setup guide)\",\"valueProvider\":\"fieldValue\"}]},\"toolDescription\":\"Fetches the fully-rendered **plain text** of a single web.  \\n• Input  : { \\\"url\\\": \\\"<absolute https://…>\\\" }  \\n• Auth   : token is sent as HTTP basic-auth.  \\n• Query  : url=<encoded url>  \\n• Output : { \\\"text\\\": \\\"<visible text of the body>\\\", \\\"url\\\": \\\"<same url>\\\" }  \\n• The \\\"text\\\" field already has **all HTML tags removed** .  \\n• Use this tool whenever you need the actual words that appear on the page—product details, prices, stock lines, shipping terms, payment options, company policies, etc.  \\n• Do **not** call it on off-site links or mailto:/tel:/javascript: pseudo-links.  \\n\"},\"typeVersion\":1.1},{\"id\":\"46c1fd08-9b61-4ea9-bee3-9ad8b7e7ce4d\",\"name\":\"24-hour window check\",\"type\":\"n8n-nodes-base.code\",\"position\":[520,140],\"parameters\":{\"jsCode\":\"// within24h?  – run once per item\\n// Meta (WhatsApp) timestamp arrives as seconds since epoch\\nconst lastTs = Number($('WhatsApp Trigger').first().json.messages[0].timestamp) * 1000;   // → ms\\nconst withinWindow = Date.now() - lastTs < 24 * 60 * 60 * 1000;\\n\\nreturn [{ json: { withinWindow, answer: $json.answer, userId: $json.userId } }];\"},\"typeVersion\":2},{\"id\":\"0309e9fb-745e-46cd-a360-a6a4a96ffa36\",\"name\":\"If\",\"type\":\"n8n-nodes-base.if\",\"position\":[740,140],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"d33e218e-a49a-49ed-9c6b-55b9ea0b0dbb\",\"operator\":{\"type\":\"boolean\",\"operation\":\"true\",\"singleValue\":true},\"leftValue\":\"={{ $json.withinWindow }}\",\"rightValue\":\"\"}]}},\"typeVersion\":2.2},{\"id\":\"e0f6e0b0-d2f8-4be5-85e4-74b351390369\",\"name\":\"Send Pre-approved Template Message to Reopen the Conversation\",\"type\":\"n8n-nodes-base.whatsApp\",\"position\":[1060,360],\"parameters\":{\"template\":\"hello_world|en_US\",\"phoneNumberId\":\"679436108574898\",\"requestOptions\":{},\"recipientPhoneNumber\":\"={{ $('WhatsApp Trigger').item.json.contacts[0].wa_id }}\"},\"credentials\":{\"whatsAppApi\":{\"id\":\"zNN8ICsFZI5A7frT\",\"name\":\"WhatsApp account\"}},\"typeVersion\":1},{\"id\":\"fd41fbf2-f471-4529-bb4d-358ace9cf639\",\"name\":\"Send AI Agent's Answer\",\"type\":\"n8n-nodes-base.whatsApp\",\"position\":[1260,120],\"parameters\":{\"textBody\":\"={{ $json.answer }}\",\"operation\":\"send\",\"phoneNumberId\":\"679436108574898\",\"requestOptions\":{},\"additionalFields\":{},\"recipientPhoneNumber\":\"={{ $('WhatsApp Trigger').item.json.contacts[0].wa_id }}\"},\"credentials\":{\"whatsAppApi\":{\"id\":\"zNN8ICsFZI5A7frT\",\"name\":\"WhatsApp account\"}},\"typeVersion\":1},{\"id\":\"35e6c77f-56c5-4b93-a69a-e048b593cf40\",\"name\":\"Postgres Users Memory\",\"type\":\"@n8n/n8n-nodes-langchain.memoryPostgresChat\",\"position\":[120,500],\"parameters\":{\"tableName\":\"message_history\",\"sessionKey\":\"={{ $json.contacts[0].wa_id }}\",\"sessionIdType\":\"customKey\"},\"credentials\":{\"postgres\":{\"id\":\"Bk7n11D1jU5zJ802\",\"name\":\"Postgres account\"}},\"typeVersion\":1.3},{\"id\":\"67c3296e-8915-4857-a294-03c5bc8257c0\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-920,-320],\"parameters\":{\"width\":460,\"height\":1460,\"content\":\"# Step by Step Setup Guide\\n\\n### **The technology that powers this AI Agent—continuously crawling, extracting, and generating answers—incurs real operating costs to stay online.**\\n### **That’s why the workflow requires an active membership, priced at only **\\\\$29 per month**. Comparable AI-support platforms charge **\\\\$150 – \\\\$500 each month**, so with this template you either save a large chunk of that expense for your own business or earn the same amount by reselling the chatbot to clients—while paying just \\\\$29 yourself. *And because the bot pulls fresh information from the site in real time, you never have to “re-train” a model, saving you even more time and money.***\\n\\n **Activate your membership here:** [https://lemolex.gumroad.com/l/ejsnx](https://lemolex.gumroad.com/l/ejsnx)\\n\\n### Let's start setting this up step by step:\\n*Total hands-on time: ≈ 15 minutes*\\n\\n1. Activate the tools with the membership generated key: \\n- Go to the membership link to get your key.\\n- Copy the key (e.g 6F0E4C97-B72A4E69-A11BF6C4-AF123456) and paste it in the body parameters of list_links and get_page (tools):\\n*Name: auth-token*\\n*Value:  6F0E4C97-B72A4E69-A11BF6C4-AF123456* **(example)**\\n\\n2. Customize for Your Company:\\n- Copy the Root URL of your company's website (Home Page).\\n- Open the AI Agent node and inside the `System Message`, change the following values:\\n[Company Name] with your company name (e.g [Company Name] -> Facebook)\\n[https://www.your-company-url.com] with your company Root URL that you copied before.\\nCheck for these 2 values along the entire text.\\n- Go back to the tools list_links and get_page and paste the Root URL inside the body parameters, specifically:\\n*Name: url*\\n*Value: https://www.your-company-url.com **(e.g https://www.facebook.com)**\\n\\n3. Connect your credentials:\\n- Go to the OpenAI Chat Model node and connect your OpenAI credentials.\\n- Go to the Postgres Users Memory node and connect your Supabase credentials. A tutorial for this: https://youtu.be/6w5f_jsPYSQ?si=MPdXYUjxv3fghQPj&t=105 (Minute 1:45 to 5:00)\\n- Go to the WhatsApp nodes \\\"WhatsApp Trigger\\\", \\\"Send Pre-approved Template Message to Reopen the Conversation\\\" and \\\"Send AI Agent's Answer\\\" to connect your credentials. A tutorial for this: https://youtu.be/ZrhTQle55LQ?si=MO_leooogO9KchCV\\n- Go to the \\\"Send Pre-approved Template Message to Reopen the Conversation\\\" and select the template message under the \\\"Template\\\" parameter.\\n***If you don't want to use this feature (not recommended) delete the nodes \\\"24-hour window check\\\", \\\"If\\\" and \\\"Send Pre-approved Template Message to Reopen the Conversation\\\". Then connect the AI Agent node to the \\\"cleanAnswer\\\" node.***\\n\\n\\n### **You are ready**\"},\"typeVersion\":1}],\"active\":false,\"pinData\":{},\"settings\":{\"executionOrder\":\"v1\"},\"versionId\":\"245c3695-7177-4a1d-a33d-7aedd0eccc44\",\"connections\":{\"If\":{\"main\":[[{\"node\":\"cleanAnswer\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Send Pre-approved Template Message to Reopen the Conversation\",\"type\":\"main\",\"index\":0}]]},\"AI Agent\":{\"main\":[[{\"node\":\"24-hour window check\",\"type\":\"main\",\"index\":0}]]},\"get_page\":{\"ai_tool\":[[{\"node\":\"AI Agent\",\"type\":\"ai_tool\",\"index\":0}]]},\"list_links\":{\"ai_tool\":[[{\"node\":\"AI Agent\",\"type\":\"ai_tool\",\"index\":0}]]},\"cleanAnswer\":{\"main\":[[{\"node\":\"Send AI Agent's Answer\",\"type\":\"main\",\"index\":0}]]},\"WhatsApp Trigger\":{\"main\":[[{\"node\":\"AI Agent\",\"type\":\"main\",\"index\":0}]]},\"OpenAI Chat Model\":{\"ai_languageModel\":[[{\"node\":\"AI Agent\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"24-hour window check\":{\"main\":[[{\"node\":\"If\",\"type\":\"main\",\"index\":0}]]},\"Postgres Users Memory\":{\"ai_memory\":[[{\"node\":\"AI Agent\",\"type\":\"ai_memory\",\"index\":0}]]}}}",
  "readme": "**AI Customer-Support Assistant that auto-maps any business site, answers WhatsApp in real time, and lets you earn or save thousands by replacing pricey SaaS chat tools.**\n\n* * *\n\n### ⚡ What the workflow does\n\n  * **Live “AI employee”** \\- the bot crawls pages on demand (products, policies, FAQs) so you **never** upload documents or fine-tune a model.\n  * **No-code setup** \\- Drop in API keys, paste your domain, publish the webhook—ready in ~15 min.\n  * **Chat memory** \\- each conversation turn is written to Supabase/Postgres and automatically replayed into the next prompt, letting the assistant remember context so follow-up questions feel natural and coherent even across long sessions.\n  * **WhatsApp ready** \\- Free-form replies inside the 24-hour service window, automatically switches to a template when required (recommended by Meta).\n\n\n\n* * *\n\n### 🚀 Why you’ll love it\n\nBenefit | Impact  \n---|---  \n**Zero content training** | Point the AI Agent at any domain → go live.  \n**Save or earn money** | Replace pricey SaaS chat tools _or_ sell white-label bots to clients.  \n**Channel-agnostic** | Ships with WhatsApp; swap one node for Telegram, Slack, or web chat.  \n**Flexible voice** | Adjust tone & language by editing one prompt line.  \n  \n* * *\n\n### 🧰 Prerequisites (all free-tier friendly)\n\n  * OpenAI key\n  * Meta WhatsApp Cloud API number + permanent token (easy setup)\n  * Supabase (or Postgres) URL for chat memory (easy setup)\n\n\n\n* * *\n\n### 🛠 5-step setup\n\n  1. Import the template into n8n.\n  2. Add credentials for OpenAI, WhatsApp, and Supabase.\n  3. Enter your root domain in the _root_url_ variable.\n  4. Point Meta’s Webhook to the n8n URL.\n  5. Hit **Execute Trigger** and send “Hi” from WhatsApp—watch the bot answer with live data.\n\n\n\n* * *\n\n### 🔄 Easy to extend\n\n  * **Voice & language** – change wording in the System Prompt.\n  * **Escalation** – add an “If fallback” branch → Zendesk, email, live agents.\n  * **Extra channels** – duplicate the reply node for Telegram or Slack.\n  * **Commerce API hooks** – plug in Shopify, Woo, Stripe for order status or payments.\n\n\n\n* * *\n\n### 💡 Monetization ideas\n\n  * **Replace costly SaaS seats.** Deploy the bot on your own server and _stop paying $300–$500 every month_ for third-party “AI support” platforms.\n  * **Sell it as a service.** Spin up a branded instance for local shops, clinics, or e-commerce stores and **charge each client $300–$500 per month** —setup time is under 15 minutes.\n  * Upsell premium coverage (24/7 human hand-off) once the bot handles routine questions.\n  * Embed product links in answers and earn affiliate or upsell revenue automatically.\n\n\n\n* * *\n\nSpin it up, connect a domain and a phone number, and you—or your customers—get enterprise-grade support without code, training, or ongoing licence fees.\n",
  "crawled_at": "2025-05-26T05:47:03.227961",
  "readme_zh": "**AI客服助手：自动抓取企业网站、实时回复WhatsApp消息，助您节省或赚取数千元，替代昂贵SaaS聊天工具**\n\n* * *\n\n### ⚡ 工作流程功能\n\n  * **实时“AI员工”**——机器人按需爬取网页（产品、政策、常见问题），**无需**上传文档或微调模型。\n  * **零代码配置**——填入API密钥、粘贴域名、发布Webhook，约15分钟即可上线。\n  * **对话记忆**——每轮对话均存入Supabase/Postgres数据库，并自动融入后续提示，使助手能记住上下文，让追问自然连贯，即使长时间对话也不脱节。\n  * **WhatsApp即用**——在24小时服务窗口内自由回复，必要时自动切换至模板消息（Meta推荐方案）。\n\n* * *\n\n### 🚀 核心优势\n\n优势 | 效果  \n---|---  \n**免内容训练** | 指定任意域名→AI代理即刻上岗。  \n**省钱或创收** | 替代高价SaaS聊天工具，或向客户转售白标机器人。  \n**全渠道兼容** | 默认支持WhatsApp；替换一个节点即可接入Telegram、Slack或网页聊天。  \n**灵活话术** | 修改一行提示词即可调整语气与语言风格。  \n\n* * *\n\n### 🧰 准备工作（均支持免费版）\n\n  * OpenAI密钥\n  * Meta WhatsApp Cloud API号码+永久令牌（配置简单）\n  * Supabase（或Postgres）数据库URL（用于对话记忆）\n\n* * *\n\n### 🛠 5步配置\n\n  1. 将模板导入n8n。\n  2. 添加OpenAI、WhatsApp和Supabase凭证。\n  3. 在_root_url_变量中填入您的根域名。\n  4. 将Meta的Webhook指向n8n URL。\n  5. 点击**执行触发器**，从WhatsApp发送“Hi”——见证机器人用实时数据应答。\n\n* * *\n\n### 🔄 轻松扩展\n\n  * **话术与语言**——修改系统提示词模板。\n  * **人工转接**——添加“兜底分支”→接入Zendesk、邮件或人工客服。\n  * **新增渠道**——复制回复节点适配Telegram或Slack。\n  * **电商API对接**——接入Shopify、WooCommerce或Stripe实现订单状态查询与支付。\n\n* * *\n\n### 💡 变现思路\n\n  * **替代昂贵SaaS订阅**：将机器人部署在自有服务器上，**每月省下300-500美元**第三方“AI客服”平台费用。\n  * **提供付费服务**：为本地商店、诊所或电商搭建品牌实例，**向每个客户每月收取300-500美元**——配置时间不足15分钟。\n  * 当机器人能处理常规问题后，可增售高级服务（7×24小时人工接管）。\n  * 在回复中嵌入产品链接，自动赚取联盟营销或加售佣金。\n\n* * *\n\n立即启动，连接域名和电话号码，您（或您的客户）即可获得企业级客服支持——无需编码、训练或持续支付授权费。",
  "title_zh": "AI客户支持助手 · 适配WhatsApp · 适用于各类企业",
  "publish_date_zh": "上次更新于9天前",
  "workflow_json_zh": "{\n  \"id\": \"J2D0BssoDmn4BC6D\",\n  \"meta\": {\n    \"instanceId\": \"143d2ab55c8bffb06f8b9c7ad30335764fdc48bbbacecbe2218dadb998a32213\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"name\": \"AI Customer-Support Assistant · WhatsApp Ready · Works for Any Business\",\n  \"tags\": [],\n  \"nodes\": [\n    {\n      \"id\": \"fe395033-e36e-42d4-a0ce-8362b172be31\",\n      \"name\": \"AI Agent\",\n      \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n      \"maxTries\": 5,\n      \"position\": [\n        120,\n        140\n      ],\n      \"parameters\": {\n        \"text\": \"={{ $json.messages[0].text.body }}\",\n        \"options\": {\n          \"maxIterations\": 10,\n          \"systemMessage\": \"=You are [Company Name]’s real-time website assistant for https://www.your-company-url.com.\\n\\nAVAILABLE TOOLS\\n• list_links(url) → { urls:[ … ] }  — returns up to 100 internal links from that page  \\n• get_page(url)   → { text:\\\"…\\\" }    — returns the visible, tag-free text of the page (JavaScript rendered if needed)\\n\\nSEARCH STRATEGY\\n1. Start with list_links on the root page.  \\n2. Pick ≤ 5 links whose URL or anchor text best match the user’s question (producto, pago, envío, servicio, política, etc.).  \\n3. For each chosen link call get_page once.  \\n4. Read the returned text and look for the answer.  \\n5. If the answer is still unknown, you may repeat steps 1-4 one level deeper.  \\n6. Stop after two list_links rounds **or** eight get_page calls (whichever comes first).\\n\\nANSWER RULES\\n• Reply in clear and friendly toon **as part of [Company Name]** (use “we”, “our”).  \\n• Keep answers concise but complete.  \\n• **No Markdown ni símbolos de formato. Nunca uses \\\\*, **, \\\\_, \\\\~, ni [texto](url).**  \\n  Write urls like: Descriptive Text ␣URL   Ej.: Combos https://…  \\n• Quote the exact wording for facts such as stock status, prices, envíos, métodos de pago, garantías o políticas.  \\n• If the information is not on the site, reply exactly:  \\n  “I can't find that information on our site right now. Do you want me to put you through to a human agent?”  \\n• Stay on-domain; ignore mailto:, tel:, javascript:, or off-site links.\\n• Finally, if any of the tools returns a status code 404, then reply:\\n\\\"Non-subscribed user.\\\"\",\n          \"returnIntermediateSteps\": true\n        },\n        \"promptType\": \"define\",\n        \"hasOutputParser\": true\n      },\n      \"retryOnFail\": false,\n      \"typeVersion\": 1.7,\n      \"alwaysOutputData\": true,\n      \"waitBetweenTries\": null\n    },\n    {\n      \"id\": \"3953a213-6140-4603-a069-93718e4d8982\",\n      \"name\": \"list_links\",\n      \"type\": \"@n8n/n8n-nodes-langchain.toolHttpRequest\",\n      \"position\": [\n        260,\n        420\n      ],\n      \"parameters\": {\n        \"url\": \"https://lemolex.app.n8n.cloud/webhook/list-links\",\n        \"method\": \"POST\",\n        \"sendBody\": true,\n        \"parametersBody\": {\n          \"values\": [\n            {\n              \"name\": \"url\",\n              \"value\": \"https://www.your-company-url.com\",\n              \"valueProvider\": \"fieldValue\"\n            },\n            {\n              \"name\": \"auth-token\",\n              \"value\": \"your-auth-token (read setup guide)\",\n              \"valueProvider\": \"fieldValue\"\n            }\n          ]\n        },\n        \"toolDescription\": \"Returns up to 100 unique, fully-qualified INTERNAL links for a given page.\\n\\nInput  (JSON body the model must supply)\\n  {\\n    \\\"url\\\": \\\"<absolute https://…>\\\"\\n  }\\n\\nBehaviour\\n  • Crawls only the domain of the input URL.\\n  • Converts relative <a href> values to absolute URLs.\\n  • Drops empty roots (\\\"/\\\"), mailto:, tel:, javascript:, and off-site links.\\n  • De-duplicates the list.\\n  • Responds with a JSON object:\\n\\n      {\\n        \\\"urls\\\": [ \\\"<link-1>\\\", \\\"<link-2>\\\", … ]\\n      }\\n\\nUse this tool when you need a navigation map of the current page.\\nPass one of the returned URLs back into other tools (e.g. get_text) to read its content.\\n\"\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"21ceaf5e-d2d4-47c3-98cb-ee7c0ab0fcab\",\n      \"name\": \"OpenAI Chat Model\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\n      \"position\": [\n        40,\n        340\n      ],\n      \"parameters\": {\n        \"model\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"gpt-4o-mini\"\n        },\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"jh4eAOIykIxQWUI9\",\n          \"name\": \"OpenAi account\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"7e0e84c8-ad96-44d1-9de9-c639230418fd\",\n      \"name\": \"WhatsApp Trigger\",\n      \"type\": \"n8n-nodes-base.whatsAppTrigger\",\n      \"position\": [\n        -260,\n        140\n      ],\n      \"webhookId\": \"857366e8-7b6f-45a7-bbd1-f876002620d7\",\n      \"parameters\": {\n        \"updates\": [\n          \"messages\"\n        ]\n      },\n      \"credentials\": {\n        \"whatsAppTriggerApi\": {\n          \"id\": \"EB6eAVg9ZBZGYsyX\",\n          \"name\": \"WhatsApp OAuth account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"c2a0ba34-4a23-4918-9be8-7b9d50279cde\",\n      \"name\": \"cleanAnswer\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        1040,\n        120\n      ],\n      \"parameters\": {\n        \"jsCode\": \"// cleanAnswer – run once per item\\nlet txt = $('AI Agent').first().json.output || '';\\n\\n// 1. Remove bold / italic / strike markers\\ntxt = txt.replace(/[*_~]+/g, '');\\n\\n// 2. Convert [Texto](https://url) → Texto https://url\\ntxt = txt.replace(/\\\\[([^\\\\]]+)\\\\]\\\\((https?:\\\\/\\\\/[^\\\\s)]+)\\\\)/g, '$1 $2');\\n\\n// 3. Collapse 3+ blank lines\\ntxt = txt.replace(/\\\\n{3,}/g, '\\\\n\\\\n').trim();\\n\\nreturn [{ json: { answer: txt } }];\\n\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"ef403af2-4543-4edb-80ae-afda1e98a2a9\",\n      \"name\": \"get_page\",\n      \"type\": \"@n8n/n8n-nodes-langchain.toolHttpRequest\",\n      \"position\": [\n        420,\n        420\n      ],\n      \"parameters\": {\n        \"url\": \"https://lemolex.app.n8n.cloud/webhook/get_text\",\n        \"method\": \"POST\",\n        \"sendBody\": true,\n        \"parametersBody\": {\n          \"values\": [\n            {\n              \"name\": \"url\"\n            },\n            {\n              \"name\": \"auth-token\",\n              \"value\": \"your-auth-token (read setup guide)\",\n              \"valueProvider\": \"fieldValue\"\n            }\n          ]\n        },\n        \"toolDescription\": \"Fetches the fully-rendered **plain text** of a single web.  \\n• Input  : { \\\"url\\\": \\\"<absolute https://…>\\\" }  \\n• Auth   : token is sent as HTTP basic-auth.  \\n• Query  : url=<encoded url>  \\n• Output : { \\\"text\\\": \\\"<visible text of the body>\\\", \\\"url\\\": \\\"<same url>\\\" }  \\n• The \\\"text\\\" field already has **all HTML tags removed** .  \\n• Use this tool whenever you need the actual words that appear on the page—product details, prices, stock lines, shipping terms, payment options, company policies, etc.  \\n• Do **not** call it on off-site links or mailto:/tel:/javascript: pseudo-links.  \\n\"\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"46c1fd08-9b61-4ea9-bee3-9ad8b7e7ce4d\",\n      \"name\": \"24-hour window check\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        520,\n        140\n      ],\n      \"parameters\": {\n        \"jsCode\": \"// within24h?  – run once per item\\n// Meta (WhatsApp) timestamp arrives as seconds since epoch\\nconst lastTs = Number($('WhatsApp Trigger').first().json.messages[0].timestamp) * 1000;   // → ms\\nconst withinWindow = Date.now() - lastTs < 24 * 60 * 60 * 1000;\\n\\nreturn [{ json: { withinWindow, answer: $json.answer, userId: $json.userId } }];\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"0309e9fb-745e-46cd-a360-a6a4a96ffa36\",\n      \"name\": \"If\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        740,\n        140\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"d33e218e-a49a-49ed-9c6b-55b9ea0b0dbb\",\n              \"operator\": {\n                \"type\": \"boolean\",\n                \"operation\": \"true\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json.withinWindow }}\",\n              \"rightValue\": \"\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"e0f6e0b0-d2f8-4be5-85e4-74b351390369\",\n      \"name\": \"Send Pre-approved Template Message to Reopen the Conversation\",\n      \"type\": \"n8n-nodes-base.whatsApp\",\n      \"position\": [\n        1060,\n        360\n      ],\n      \"parameters\": {\n        \"template\": \"hello_world|en_US\",\n        \"phoneNumberId\": \"679436108574898\",\n        \"requestOptions\": {},\n        \"recipientPhoneNumber\": \"={{ $('WhatsApp Trigger').item.json.contacts[0].wa_id }}\"\n      },\n      \"credentials\": {\n        \"whatsAppApi\": {\n          \"id\": \"zNN8ICsFZI5A7frT\",\n          \"name\": \"WhatsApp account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"fd41fbf2-f471-4529-bb4d-358ace9cf639\",\n      \"name\": \"Send AI Agent's Answer\",\n      \"type\": \"n8n-nodes-base.whatsApp\",\n      \"position\": [\n        1260,\n        120\n      ],\n      \"parameters\": {\n        \"textBody\": \"={{ $json.answer }}\",\n        \"operation\": \"send\",\n        \"phoneNumberId\": \"679436108574898\",\n        \"requestOptions\": {},\n        \"additionalFields\": {},\n        \"recipientPhoneNumber\": \"={{ $('WhatsApp Trigger').item.json.contacts[0].wa_id }}\"\n      },\n      \"credentials\": {\n        \"whatsAppApi\": {\n          \"id\": \"zNN8ICsFZI5A7frT\",\n          \"name\": \"WhatsApp account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"35e6c77f-56c5-4b93-a69a-e048b593cf40\",\n      \"name\": \"Postgres Users Memory\",\n      \"type\": \"@n8n/n8n-nodes-langchain.memoryPostgresChat\",\n      \"position\": [\n        120,\n        500\n      ],\n      \"parameters\": {\n        \"tableName\": \"message_history\",\n        \"sessionKey\": \"={{ $json.contacts[0].wa_id }}\",\n        \"sessionIdType\": \"customKey\"\n      },\n      \"credentials\": {\n        \"postgres\": {\n          \"id\": \"Bk7n11D1jU5zJ802\",\n          \"name\": \"Postgres account\"\n        }\n      },\n      \"typeVersion\": 1.3\n    },\n    {\n      \"id\": \"67c3296e-8915-4857-a294-03c5bc8257c0\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -920,\n        -320\n      ],\n      \"parameters\": {\n        \"width\": 460,\n        \"height\": 1460,\n        \"content\": \"# 逐步设置指南\\n\\n### **驱动此AI代理的技术——持续爬取、提取并生成答案——需要真实的运营成本以保持在线。**\\n### **因此，该工作流程需要有效的会员资格，每月仅需**29美元**。同类AI支持平台每月收费**150至500美元**，所以使用此模板，您要么为自己的业务节省大部分费用，要么通过向客户转售聊天机器人赚取相同金额——而您自己只需支付29美元。*由于机器人实时从网站获取最新信息，您无需“重新训练”模型，从而节省更多时间和金钱。***\\n\\n**在此激活您的会员资格：**[https://lemolex.gumroad.com/l/ejsnx](https://lemolex.gumroad.com/l/ejsnx)\\n\\n### 让我们逐步开始设置：\\n*总动手时间：约15分钟*\\n\\n1. 使用会员生成的密钥激活工具：\\n- 前往会员链接获取您的密钥。\\n- 复制密钥（例如6F0E4C97-B72A4E69-A11BF6C4-AF123456）并粘贴到list_links和get_page工具的body参数中：\\n*名称：auth-token*\\n*值：6F0E4C97-B72A4E69-A11BF6C4-AF123456* **（示例）**\\n\\n2. 为您的公司定制：\\n- 复制公司网站的根URL（主页）。\\n- 打开AI代理节点，在`系统消息`中更改以下值：\\n将[公司名称]替换为您的公司名称（例如[公司名称] -> Facebook）。\\n将[https://www.your-company-url.com]替换为您之前复制的公司根URL。\\n在整个文本中检查这两个值。\\n- 返回list_links和get_page工具，将根URL粘贴到body参数中，具体为：\\n*名称：url*\\n*值：https://www.your-company-url.com **（例如https://www.facebook.com）**\\n\\n3. 连接您的凭据：\\n- 前往OpenAI聊天模型节点并连接您的OpenAI凭据。\\n- 前往Postgres用户记忆节点并连接您的Supabase凭据。教程见此：[https://youtu.be/6w5f_jsPYSQ?si=MPdXYUjxv3fghQPj&t=105](https://youtu.be/6w5f_jsPYSQ?si=MPdXYUjxv3fghQPj&t=105)（1分45秒至5分钟）\\n- 前往WhatsApp节点“WhatsApp触发器”、“发送预批准模板消息以重新开启对话”和“发送AI代理的答案”以连接您的凭据。教程见此：[https://youtu.be/ZrhTQle55LQ?si=MO_leooogO9KchCV](https://youtu.be/ZrhTQle55LQ?si=MO_leooogO9KchCV)\\n- 前往“发送预批准模板消息以重新开启对话”并在“模板”参数下选择模板消息。\\n***如果您不想使用此功能（不推荐），请删除“24小时窗口检查”、“If”和“发送预批准模板消息以重新开启对话”节点。然后将AI代理节点连接到“cleanAnswer”节点。***\\n\\n### **您已准备就绪**\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"active\": false,\n  \"pinData\": {},\n  \"settings\": {\n    \"executionOrder\": \"v1\"\n  },\n  \"versionId\": \"245c3695-7177-4a1d-a33d-7aedd0eccc44\",\n  \"connections\": {\n    \"If\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"cleanAnswer\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Send Pre-approved Template Message to Reopen the Conversation\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"AI Agent\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"24-hour window check\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"get_page\": {\n      \"ai_tool\": [\n        [\n          {\n            \"node\": \"AI Agent\",\n            \"type\": \"ai_tool\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"list_links\": {\n      \"ai_tool\": [\n        [\n          {\n            \"node\": \"AI Agent\",\n            \"type\": \"ai_tool\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"cleanAnswer\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Send AI Agent's Answer\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"WhatsApp Trigger\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"AI Agent\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"OpenAI Chat Model\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"AI Agent\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"24-hour window check\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"If\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Postgres Users Memory\": {\n      \"ai_memory\": [\n        [\n          {\n            \"node\": \"AI Agent\",\n            \"type\": \"ai_memory\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}