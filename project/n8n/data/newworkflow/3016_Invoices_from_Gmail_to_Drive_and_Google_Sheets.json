{
  "url": "https://n8n.io/workflows/3016-invoices-from-gmail-to-drive-and-google-sheets/",
  "title": "Invoices from Gmail to Drive and Google Sheets",
  "author": "Juan Carlos Cavero Gracia",
  "publish_date": "Last update 3 months ago",
  "publish_date_absolute": "2025-02-26",
  "categories": [
    {
      "name": "Finance"
    },
    {
      "name": "AI"
    }
  ],
  "workflow_json": "{\"id\":\"XnGZZfT5u0Cw1X3p\",\"meta\":{\"instanceId\":\"3378b0d68c3b7ebfc71b79896d94e1a044dec38e99a1160aed4e9c323910fbe2\",\"templateCredsSetupCompleted\":true},\"name\":\"Attachments Gmail to drive and google sheets\",\"tags\":[],\"nodes\":[{\"id\":\"0404ef0a-9750-495a-8798-98d4b059a083\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-580,-420],\"parameters\":{\"height\":440,\"content\":\"## Setup\\n1. Setup your **Gmail** and **Google Drive** credentials\\n2. Setup your **Google Sheets** credentials\\n3. Setup your **Openai** api key\"},\"typeVersion\":1},{\"id\":\"8751a7f1-aae4-4746-aae7-3d8563845b8c\",\"name\":\"Gmail Trigger1\",\"type\":\"n8n-nodes-base.gmailTrigger\",\"position\":[-640,120],\"parameters\":{\"simple\":false,\"filters\":{\"readStatus\":\"unread\"},\"options\":{\"downloadAttachments\":true},\"pollTimes\":{\"item\":[{\"mode\":\"everyMinute\"}]}},\"credentials\":{\"gmailOAuth2\":{\"id\":\"v8YJP3VfeGtRk5la\",\"name\":\"Gmail account\"}},\"typeVersion\":1.1},{\"id\":\"40f62192-5acb-4915-aa07-e5a0dfeb7581\",\"name\":\"Setup1\",\"type\":\"n8n-nodes-base.set\",\"position\":[-300,120],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"4cca07a2-6a70-4011-a025-65246e652fb9\",\"name\":\"url_to_drive_folder\",\"type\":\"string\",\"value\":\"1fCWCdqrFP3WrjjLc-gJtxMaiaF5lh8Ko\"}]},\"includeOtherFields\":true},\"typeVersion\":3.4},{\"id\":\"d928e797-8851-4ab4-9199-cd555a40eae9\",\"name\":\"Upload PDF to Drive1\",\"type\":\"n8n-nodes-base.httpRequest\",\"maxTries\":5,\"position\":[220,0],\"parameters\":{\"url\":\"https://www.googleapis.com/upload/drive/v3/files\",\"method\":\"POST\",\"options\":{},\"sendBody\":true,\"sendQuery\":true,\"contentType\":\"binaryData\",\"authentication\":\"predefinedCredentialType\",\"queryParameters\":{\"parameters\":[{\"name\":\"uploadType\",\"value\":\"media\"}]},\"inputDataFieldName\":\"={{ $binary.attachment_0.mimeType === \\\"application/pdf\\\"\\n     ? \\\"attachment_0\\\"\\n     : \\\"attachment_1\\\" }}\",\"nodeCredentialType\":\"googleDriveOAuth2Api\"},\"credentials\":{\"googleDriveOAuth2Api\":{\"id\":\"p5I6S4YkJps1zvwz\",\"name\":\"Google Drive account 2\"}},\"retryOnFail\":true,\"typeVersion\":4.2},{\"id\":\"22df6933-a0c7-4cce-8114-5332038a14c3\",\"name\":\"Rename file1\",\"type\":\"n8n-nodes-base.googleDrive\",\"position\":[400,0],\"parameters\":{\"fileId\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"={{ $json.id }}\"},\"options\":{},\"operation\":\"update\",\"newUpdatedFileName\":\"={{ $('Setup1').item.json.subject }}_invoice_{{ $now.format('yyyy-MM-dd') }}.pdf\"},\"credentials\":{\"googleDriveOAuth2Api\":{\"id\":\"p5I6S4YkJps1zvwz\",\"name\":\"Google Drive account 2\"}},\"typeVersion\":3},{\"id\":\"ce6a6a4c-17ba-4cf7-b07a-97b9d8d80844\",\"name\":\"Move to the correct folder1\",\"type\":\"n8n-nodes-base.googleDrive\",\"position\":[580,0],\"parameters\":{\"fileId\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"={{ $json.id }}\"},\"driveId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"My Drive\",\"cachedResultUrl\":\"https://drive.google.com/drive/my-drive\",\"cachedResultName\":\"My Drive\"},\"folderId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"1fCWCdqrFP3WrjjLc-gJtxMaiaF5lh8Ko\",\"cachedResultUrl\":\"\",\"cachedResultName\":\"2025\"},\"operation\":\"move\"},\"credentials\":{\"googleDriveOAuth2Api\":{\"id\":\"p5I6S4YkJps1zvwz\",\"name\":\"Google Drive account 2\"}},\"typeVersion\":3},{\"id\":\"e64aac5c-a314-46b6-b7db-fc0d6f450e1f\",\"name\":\"Gmail\",\"type\":\"n8n-nodes-base.gmail\",\"position\":[1240,0],\"webhookId\":\"556cbee3-8de0-4645-9e91-e7c0c252f2ab\",\"parameters\":{\"messageId\":\"={{ $('Gmail Trigger1').item.json.id }}\",\"operation\":\"markAsRead\"},\"credentials\":{\"gmailOAuth2\":{\"id\":\"v8YJP3VfeGtRk5la\",\"name\":\"Gmail account\"}},\"typeVersion\":2.1},{\"id\":\"ea74cfc1-0305-418d-9f5f-bffcfb3bb2c7\",\"name\":\"Extract from File2\",\"type\":\"n8n-nodes-base.extractFromFile\",\"position\":[1200,-180],\"parameters\":{\"options\":{},\"operation\":\"pdf\"},\"typeVersion\":1},{\"id\":\"0398d982-78fd-4830-b5cf-271195af80fd\",\"name\":\"Google Drive\",\"type\":\"n8n-nodes-base.googleDrive\",\"position\":[800,0],\"parameters\":{\"fileId\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"={{ $json.id }}\"},\"options\":{},\"operation\":\"download\"},\"credentials\":{\"googleDriveOAuth2Api\":{\"id\":\"p5I6S4YkJps1zvwz\",\"name\":\"Google Drive account 2\"}},\"typeVersion\":3},{\"id\":\"3b4a96d4-a6ee-486a-a795-fe410ccc38b2\",\"name\":\"OpenAI Model\",\"type\":\"@n8n/n8n-nodes-langchain.lmOpenAi\",\"position\":[1740,20],\"parameters\":{\"model\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"gpt-4o\",\"cachedResultName\":\"gpt-4o\"},\"options\":{\"temperature\":0}},\"credentials\":{\"openAiApi\":{\"id\":\"XJdxgMSXFgwReSsh\",\"name\":\"n8n key\"}},\"typeVersion\":1},{\"id\":\"a7dd0d95-5e79-4bd2-a8a6-2178264d19fc\",\"name\":\"Structured Output Parser\",\"type\":\"@n8n/n8n-nodes-langchain.outputParserStructured\",\"position\":[1940,40],\"parameters\":{\"jsonSchema\":\"{\\n  \\\"Invoice date\\\": { \\\"type\\\": \\\"date\\\" },\\n  \\\"Invoice description\\\": { \\\"type\\\": \\\"string\\\" },\\n  \\\"Total price\\\": { \\\"type\\\": \\\"number\\\" },\\n  \\\"Fichero\\\": { \\\"type\\\": \\\"string\\\" }\\n}\"},\"typeVersion\":1.1},{\"id\":\"68d98f4c-e679-48e3-a1a1-529cda4e31a4\",\"name\":\"Append to Reconciliation Sheet\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[2280,-140],\"parameters\":{\"columns\":{\"value\":{},\"schema\":[{\"id\":\"Invoice date\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"Invoice date\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Invoice Description\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"Invoice Description\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Total price\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"Total price\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Fichero\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"Fichero\",\"defaultMatch\":false,\"canBeUsedToMatch\":true}],\"mappingMode\":\"autoMapInputData\",\"matchingColumns\":[],\"attemptToConvertTypes\":false,\"convertFieldsToString\":false},\"options\":{},\"operation\":\"append\",\"sheetName\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"gid=0\"},\"documentId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"1gIUnjSWUhsoTOVVd4ZoVjARCGQfGE8s7FWcju3lNajM\",\"cachedResultUrl\":\"\",\"cachedResultName\":\"facturas\"}},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"3IOU2VjBnR4hGohx\",\"name\":\"Google Sheets account\"}},\"typeVersion\":4.3},{\"id\":\"80e1c8f4-b593-4c5f-b9e2-f3b7996ee6d4\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1680,-400],\"parameters\":{\"color\":7,\"width\":805.0578351924228,\"height\":656.5014186128178,\"content\":\"## 3. Use LLMs to Extract Values from Data\\n[Read more about Basic LLM Chain](https://docs.n8n.io/integrations/builtin/cluster-nodes/root-nodes/n8n-nodes-langchain.chainllm/)\\n\\nLarge language models are perfect for data extraction tasks as they can work across a range of document layouts without human intervention. The extracted data can then be sent to a variety of datastores such as spreadsheets, accounting systems and/or CRMs.\\n\\n**Tip:** The \\\"Structured Output Parser\\\" ensures the AI output can be\\ninserted to our spreadsheet without additional clean up and/or formatting. \"},\"typeVersion\":1},{\"id\":\"3754e10e-a233-4ce0-bc79-bb5c01db9695\",\"name\":\"Map Output\",\"type\":\"n8n-nodes-base.set\",\"position\":[2080,-140],\"parameters\":{\"mode\":\"raw\",\"options\":{},\"jsonOutput\":\"={{ $json.output }}\"},\"typeVersion\":3.3},{\"id\":\"a42ff16f-d0df-4b6d-9a36-849f85d1facc\",\"name\":\"Apply Data Extraction Rules\",\"type\":\"@n8n/n8n-nodes-langchain.chainLlm\",\"position\":[1740,-140],\"parameters\":{\"text\":\"=Given the following invoice in the <invoice> xml tags, extract the following information as listed below.\\nIf you cannot the information for a specific item, then leave blank and skip to the next. \\n\\n* Invoice date\\n* Invoice Description: {{ $('Rename file1').item.json.name }}\\n* Total price\\n* Fichero: =HYPERLINK(\\\"https://drive.google.com/file/d/{{ $('Move to the correct folder1').item.json.id }}/view\\\", \\\"Ver Documento\\\")\\n\\n\\n<invoice>{{ $json.text }}</invoice>\",\"promptType\":\"define\",\"hasOutputParser\":true},\"typeVersion\":1.4},{\"id\":\"f6de5d5a-d2dc-4590-8f46-3f250b8fca9f\",\"name\":\"Sticky Note6\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1860,0],\"parameters\":{\"width\":192.26896179623753,\"height\":213.73043662572252,\"content\":\"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n**Need more attributes?**\\nChange it here!\"},\"typeVersion\":1},{\"id\":\"255fe8c1-5bd7-41cc-b1f9-c8956b5ad101\",\"name\":\"Only invoice mails with attachments\",\"type\":\"n8n-nodes-base.if\",\"position\":[0,120],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":1,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"or\",\"conditions\":[{\"id\":\"229200d1-ec13-4970-ae0e-2c8e17da0bdf\",\"operator\":{\"type\":\"string\",\"operation\":\"contains\"},\"leftValue\":\"={{ $('Gmail Trigger1').item.json.headers['content-type'] }}\",\"rightValue\":\"multipart/mixed\"},{\"id\":\"new-condition\",\"operator\":{\"type\":\"boolean\",\"operation\":\"isNotEmpty\"},\"leftValue\":\"={{ $json.attachments }}\"}]}},\"typeVersion\":2.1}],\"active\":true,\"pinData\":{},\"settings\":{\"executionOrder\":\"v1\"},\"versionId\":\"eb152808-e993-4e18-9dd8-10f21df57bf1\",\"connections\":{\"Gmail\":{\"main\":[[]]},\"Setup1\":{\"main\":[[{\"node\":\"Only invoice mails with attachments\",\"type\":\"main\",\"index\":0}]]},\"Map Output\":{\"main\":[[{\"node\":\"Append to Reconciliation Sheet\",\"type\":\"main\",\"index\":0}]]},\"Google Drive\":{\"main\":[[{\"node\":\"Extract from File2\",\"type\":\"main\",\"index\":0}]]},\"OpenAI Model\":{\"ai_languageModel\":[[{\"node\":\"Apply Data Extraction Rules\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"Rename file1\":{\"main\":[[{\"node\":\"Move to the correct folder1\",\"type\":\"main\",\"index\":0}]]},\"Gmail Trigger1\":{\"main\":[[{\"node\":\"Setup1\",\"type\":\"main\",\"index\":0}]]},\"Extract from File2\":{\"main\":[[{\"node\":\"Apply Data Extraction Rules\",\"type\":\"main\",\"index\":0}]]},\"Upload PDF to Drive1\":{\"main\":[[{\"node\":\"Rename file1\",\"type\":\"main\",\"index\":0}]]},\"Structured Output Parser\":{\"ai_outputParser\":[[{\"node\":\"Apply Data Extraction Rules\",\"type\":\"ai_outputParser\",\"index\":0}]]},\"Apply Data Extraction Rules\":{\"main\":[[{\"node\":\"Map Output\",\"type\":\"main\",\"index\":0}]]},\"Move to the correct folder1\":{\"main\":[[{\"node\":\"Gmail\",\"type\":\"main\",\"index\":0},{\"node\":\"Google Drive\",\"type\":\"main\",\"index\":0}]]},\"Only invoice mails with attachments\":{\"main\":[[{\"node\":\"Upload PDF to Drive1\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Gmail\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "# Attachments Gmail to Drive and Google Sheets\n\n## Description\n\nAutomatically process invoice emails by saving attachments to Google Drive and extracting key invoice data to Google Sheets using AI. This workflow monitors your Gmail for unread emails with attachments, saves PDFs to a specified Google Drive folder, and uses OpenAI's GPT-4o to extract invoice details (date, description, amount) into a structured spreadsheet.\n\n## Use cases\n\n  * **Invoice Management** : Automatically organize and track invoices received via email\n  * **Financial Record Keeping** : Maintain a structured database of all invoice information\n  * **Document Organization** : Keep digital copies of invoices organized in Google Drive\n  * **Automated Data Entry** : Eliminate manual data entry for invoice processing\n\n\n\n## Resources\n\n  * Gmail account\n  * Google Drive account\n  * Google Sheets account\n  * OpenAI API key\n\n\n\n## Setup instructions\n\n### Prerequisites\n\n  1. Active Gmail, Google Drive, and Google Sheets accounts\n  2. OpenAI API key (GPT-4o model access)\n  3. n8n instance with credentials manager\n\n\n\n### Steps\n\n  1. **Gmail and Google Drive Setup** :\n\n     * Connect your Gmail account in n8n credentials\n     * Connect your Google Drive account with appropriate permissions\n     * Create a destination folder in Google Drive for invoice storage\n  2. **Google Sheets Setup** :\n\n     * Connect your Google Sheets account\n     * Create a spreadsheet with columns: Invoice date, Invoice Description, Total price, and Fichero\n     * Copy your spreadsheet ID for configuration\n  3. **OpenAI Setup** :\n\n     * Add your OpenAI API key to n8n credentials\n  4. **Configure Email Filter** :\n\n     * Update the email filter node to match your specific sender requirements\n\n\n\n## Benefits\n\n  * **Time Saving** : Eliminates manual downloading, filing, and data entry\n  * **Accuracy** : AI-powered data extraction reduces human error\n  * **Organization** : Consistent file naming and storage structure\n  * **Searchability** : Creates a searchable database of all invoice information\n  * **Automation** : Runs every minute to process new emails as they arrive\n\n\n\n## Related templates\n\n  * Email Parser to CRM\n  * Document Processing Workflow\n  * Financial Data Automation\n\n\n",
  "crawled_at": "2025-05-26T03:29:42.862190",
  "readme_zh": "# Gmail附件转存至Drive与Google表格自动化处理\n\n## 功能说明\n\n通过AI技术自动处理含发票的邮件：将附件保存至Google Drive，并提取关键发票数据至Google表格。该工作流实时监控Gmail未读邮件中的附件，将PDF保存至指定Drive文件夹，并运用OpenAI的GPT-4o模型提取发票要素（日期、描述、金额）生成结构化电子表格。\n\n## 应用场景\n\n* **发票管理**：自动归类追踪邮件接收的发票\n* **财务归档**：建立结构化发票信息数据库\n* **文档整理**：在Drive中有序存储电子版发票\n* **数据录入自动化**：免除人工录入发票数据\n\n## 所需资源\n\n* Gmail账户\n* Google Drive账户\n* Google Sheets账户\n* OpenAI API密钥\n\n## 配置指南\n\n### 前期准备\n\n1. 有效的Gmail、Google Drive及Google Sheets账户\n2. OpenAI API密钥（需GPT-4o模型权限）\n3. 配置n8n凭证管理器\n\n### 操作步骤\n\n1. **Gmail与Drive配置**：\n   * 在n8n中添加Gmail账户凭证\n   * 授权Google Drive账户并设置适当权限\n   * 在Drive创建发票存储目标文件夹\n\n2. **Google表格配置**：\n   * 关联Google Sheets账户\n   * 创建包含列名的工作表：发票日期、发票描述、总金额、文件链接\n   * 复制电子表格ID用于配置\n\n3. **OpenAI配置**：\n   * 将API密钥添加至n8n凭证管理器\n\n4. **邮件过滤器设置**：\n   * 调整邮件过滤节点以匹配特定发件人要求\n\n## 核心优势\n\n* **高效省时**：免除手动下载、归档及数据录入\n* **精准识别**：AI数据提取降低人为错误\n* **结构规整**：统一文件命名与存储架构\n* **便捷检索**：建立可搜索的发票信息库\n* **智能响应**：每分钟自动检测处理新邮件\n\n## 关联模板\n\n* 邮件解析至CRM系统\n* 文档自动化处理流程\n* 财务数据自动化方案",
  "title_zh": "从Gmail到Drive及Google Sheets的发票",
  "publish_date_zh": "最后更新于2个月前",
  "workflow_json_zh": "{\n  \"id\": \"XnGZZfT5u0Cw1X3p\",\n  \"meta\": {\n    \"instanceId\": \"3378b0d68c3b7ebfc71b79896d94e1a044dec38e99a1160aed4e9c323910fbe2\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"name\": \"Attachments Gmail to drive and google sheets\",\n  \"tags\": [],\n  \"nodes\": [\n    {\n      \"id\": \"0404ef0a-9750-495a-8798-98d4b059a083\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -580,\n        -420\n      ],\n      \"parameters\": {\n        \"height\": 440,\n        \"content\": \"## 配置步骤\\n1. 设置您的**Gmail**和**Google Drive**访问凭证\\n2. 配置**Google Sheets**接口权限\\n3. 填入**OpenAI**应用程序接口密钥\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"8751a7f1-aae4-4746-aae7-3d8563845b8c\",\n      \"name\": \"Gmail Trigger1\",\n      \"type\": \"n8n-nodes-base.gmailTrigger\",\n      \"position\": [\n        -640,\n        120\n      ],\n      \"parameters\": {\n        \"simple\": false,\n        \"filters\": {\n          \"readStatus\": \"unread\"\n        },\n        \"options\": {\n          \"downloadAttachments\": true\n        },\n        \"pollTimes\": {\n          \"item\": [\n            {\n              \"mode\": \"everyMinute\"\n            }\n          ]\n        }\n      },\n      \"credentials\": {\n        \"gmailOAuth2\": {\n          \"id\": \"v8YJP3VfeGtRk5la\",\n          \"name\": \"Gmail account\"\n        }\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"40f62192-5acb-4915-aa07-e5a0dfeb7581\",\n      \"name\": \"Setup1\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        -300,\n        120\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"4cca07a2-6a70-4011-a025-65246e652fb9\",\n              \"name\": \"url_to_drive_folder\",\n              \"type\": \"string\",\n              \"value\": \"1fCWCdqrFP3WrjjLc-gJtxMaiaF5lh8Ko\"\n            }\n          ]\n        },\n        \"includeOtherFields\": true\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"d928e797-8851-4ab4-9199-cd555a40eae9\",\n      \"name\": \"Upload PDF to Drive1\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"maxTries\": 5,\n      \"position\": [\n        220,\n        0\n      ],\n      \"parameters\": {\n        \"url\": \"https://www.googleapis.com/upload/drive/v3/files\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"sendBody\": true,\n        \"sendQuery\": true,\n        \"contentType\": \"binaryData\",\n        \"authentication\": \"predefinedCredentialType\",\n        \"queryParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"uploadType\",\n              \"value\": \"media\"\n            }\n          ]\n        },\n        \"inputDataFieldName\": \"={{ $binary.attachment_0.mimeType === \\\"application/pdf\\\"\\n     ? \\\"attachment_0\\\"\\n     : \\\"attachment_1\\\" }}\",\n        \"nodeCredentialType\": \"googleDriveOAuth2Api\"\n      },\n      \"credentials\": {\n        \"googleDriveOAuth2Api\": {\n          \"id\": \"p5I6S4YkJps1zvwz\",\n          \"name\": \"Google Drive account 2\"\n        }\n      },\n      \"retryOnFail\": true,\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"22df6933-a0c7-4cce-8114-5332038a14c3\",\n      \"name\": \"Rename file1\",\n      \"type\": \"n8n-nodes-base.googleDrive\",\n      \"position\": [\n        400,\n        0\n      ],\n      \"parameters\": {\n        \"fileId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $json.id }}\"\n        },\n        \"options\": {},\n        \"operation\": \"update\",\n        \"newUpdatedFileName\": \"={{ $('Setup1').item.json.subject }}_invoice_{{ $now.format('yyyy-MM-dd') }}.pdf\"\n      },\n      \"credentials\": {\n        \"googleDriveOAuth2Api\": {\n          \"id\": \"p5I6S4YkJps1zvwz\",\n          \"name\": \"Google Drive account 2\"\n        }\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"ce6a6a4c-17ba-4cf7-b07a-97b9d8d80844\",\n      \"name\": \"Move to the correct folder1\",\n      \"type\": \"n8n-nodes-base.googleDrive\",\n      \"position\": [\n        580,\n        0\n      ],\n      \"parameters\": {\n        \"fileId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $json.id }}\"\n        },\n        \"driveId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"My Drive\",\n          \"cachedResultUrl\": \"https://drive.google.com/drive/my-drive\",\n          \"cachedResultName\": \"My Drive\"\n        },\n        \"folderId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"1fCWCdqrFP3WrjjLc-gJtxMaiaF5lh8Ko\",\n          \"cachedResultUrl\": \"\",\n          \"cachedResultName\": \"2025\"\n        },\n        \"operation\": \"move\"\n      },\n      \"credentials\": {\n        \"googleDriveOAuth2Api\": {\n          \"id\": \"p5I6S4YkJps1zvwz\",\n          \"name\": \"Google Drive account 2\"\n        }\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"e64aac5c-a314-46b6-b7db-fc0d6f450e1f\",\n      \"name\": \"Gmail\",\n      \"type\": \"n8n-nodes-base.gmail\",\n      \"position\": [\n        1240,\n        0\n      ],\n      \"webhookId\": \"556cbee3-8de0-4645-9e91-e7c0c252f2ab\",\n      \"parameters\": {\n        \"messageId\": \"={{ $('Gmail Trigger1').item.json.id }}\",\n        \"operation\": \"markAsRead\"\n      },\n      \"credentials\": {\n        \"gmailOAuth2\": {\n          \"id\": \"v8YJP3VfeGtRk5la\",\n          \"name\": \"Gmail account\"\n        }\n      },\n      \"typeVersion\": 2.1\n    },\n    {\n      \"id\": \"ea74cfc1-0305-418d-9f5f-bffcfb3bb2c7\",\n      \"name\": \"Extract from File2\",\n      \"type\": \"n8n-nodes-base.extractFromFile\",\n      \"position\": [\n        1200,\n        -180\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"operation\": \"pdf\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"0398d982-78fd-4830-b5cf-271195af80fd\",\n      \"name\": \"Google Drive\",\n      \"type\": \"n8n-nodes-base.googleDrive\",\n      \"position\": [\n        800,\n        0\n      ],\n      \"parameters\": {\n        \"fileId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $json.id }}\"\n        },\n        \"options\": {},\n        \"operation\": \"download\"\n      },\n      \"credentials\": {\n        \"googleDriveOAuth2Api\": {\n          \"id\": \"p5I6S4YkJps1zvwz\",\n          \"name\": \"Google Drive account 2\"\n        }\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"3b4a96d4-a6ee-486a-a795-fe410ccc38b2\",\n      \"name\": \"OpenAI Model\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmOpenAi\",\n      \"position\": [\n        1740,\n        20\n      ],\n      \"parameters\": {\n        \"model\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"gpt-4o\",\n          \"cachedResultName\": \"gpt-4o\"\n        },\n        \"options\": {\n          \"temperature\": 0\n        }\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"XJdxgMSXFgwReSsh\",\n          \"name\": \"n8n key\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"a7dd0d95-5e79-4bd2-a8a6-2178264d19fc\",\n      \"name\": \"Structured Output Parser\",\n      \"type\": \"@n8n/n8n-nodes-langchain.outputParserStructured\",\n      \"position\": [\n        1940,\n        40\n      ],\n      \"parameters\": {\n        \"jsonSchema\": \"{\\n  \\\"Invoice date\\\": { \\\"type\\\": \\\"date\\\" },\\n  \\\"Invoice description\\\": { \\\"type\\\": \\\"string\\\" },\\n  \\\"Total price\\\": { \\\"type\\\": \\\"number\\\" },\\n  \\\"Fichero\\\": { \\\"type\\\": \\\"string\\\" }\\n}\"\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"68d98f4c-e679-48e3-a1a1-529cda4e31a4\",\n      \"name\": \"Append to Reconciliation Sheet\",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"position\": [\n        2280,\n        -140\n      ],\n      \"parameters\": {\n        \"columns\": {\n          \"value\": {},\n          \"schema\": [\n            {\n              \"id\": \"Invoice date\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"Invoice date\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Invoice Description\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"Invoice Description\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Total price\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"Total price\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Fichero\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"Fichero\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            }\n          ],\n          \"mappingMode\": \"autoMapInputData\",\n          \"matchingColumns\": [],\n          \"attemptToConvertTypes\": false,\n          \"convertFieldsToString\": false\n        },\n        \"options\": {},\n        \"operation\": \"append\",\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"gid=0\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"1gIUnjSWUhsoTOVVd4ZoVjARCGQfGE8s7FWcju3lNajM\",\n          \"cachedResultUrl\": \"\",\n          \"cachedResultName\": \"facturas\"\n        }\n      },\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"3IOU2VjBnR4hGohx\",\n          \"name\": \"Google Sheets account\"\n        }\n      },\n      \"typeVersion\": 4.3\n    },\n    {\n      \"id\": \"80e1c8f4-b593-4c5f-b9e2-f3b7996ee6d4\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1680,\n        -400\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 805.0578351924228,\n        \"height\": 656.5014186128178,\n        \"content\": \"## 3. 利用大语言模型从数据中提取价值\\n[了解更多基础LLM链知识](https://docs.n8n.io/integrations/builtin/cluster-nodes/root-nodes/n8n-nodes-langchain.chainllm/)\\n\\n大语言模型是数据提取任务的理想选择，它们能自动适应各种文档版式，无需人工干预。提取后的数据可无缝对接电子表格、会计系统和客户关系管理等多种数据存储系统。\\n\\n**技巧：** \\\"结构化输出解析器\\\"能确保AI输出数据可直接导入电子表格，无需额外清洗或格式化处理。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"3754e10e-a233-4ce0-bc79-bb5c01db9695\",\n      \"name\": \"Map Output\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        2080,\n        -140\n      ],\n      \"parameters\": {\n        \"mode\": \"raw\",\n        \"options\": {},\n        \"jsonOutput\": \"={{ $json.output }}\"\n      },\n      \"typeVersion\": 3.3\n    },\n    {\n      \"id\": \"a42ff16f-d0df-4b6d-9a36-849f85d1facc\",\n      \"name\": \"Apply Data Extraction Rules\",\n      \"type\": \"@n8n/n8n-nodes-langchain.chainLlm\",\n      \"position\": [\n        1740,\n        -140\n      ],\n      \"parameters\": {\n        \"text\": \"=Given the following invoice in the <invoice> xml tags, extract the following information as listed below.\\nIf you cannot the information for a specific item, then leave blank and skip to the next. \\n\\n* Invoice date\\n* Invoice Description: {{ $('Rename file1').item.json.name }}\\n* Total price\\n* Fichero: =HYPERLINK(\\\"https://drive.google.com/file/d/{{ $('Move to the correct folder1').item.json.id }}/view\\\", \\\"Ver Documento\\\")\\n\\n\\n<invoice>{{ $json.text }}</invoice>\",\n        \"promptType\": \"define\",\n        \"hasOutputParser\": true\n      },\n      \"typeVersion\": 1.4\n    },\n    {\n      \"id\": \"f6de5d5a-d2dc-4590-8f46-3f250b8fca9f\",\n      \"name\": \"Sticky Note6\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1860,\n        0\n      ],\n      \"parameters\": {\n        \"width\": 192.26896179623753,\n        \"height\": 213.73043662572252,\n        \"content\": \"**需要更多属性吗？**\\n在这里更改！\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"255fe8c1-5bd7-41cc-b1f9-c8956b5ad101\",\n      \"name\": \"Only invoice mails with attachments\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        0,\n        120\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 1,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"or\",\n          \"conditions\": [\n            {\n              \"id\": \"229200d1-ec13-4970-ae0e-2c8e17da0bdf\",\n              \"operator\": {\n                \"type\": \"string\",\n                \"operation\": \"contains\"\n              },\n              \"leftValue\": \"={{ $('Gmail Trigger1').item.json.headers['content-type'] }}\",\n              \"rightValue\": \"multipart/mixed\"\n            },\n            {\n              \"id\": \"new-condition\",\n              \"operator\": {\n                \"type\": \"boolean\",\n                \"operation\": \"isNotEmpty\"\n              },\n              \"leftValue\": \"={{ $json.attachments }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.1\n    }\n  ],\n  \"active\": true,\n  \"pinData\": {},\n  \"settings\": {\n    \"executionOrder\": \"v1\"\n  },\n  \"versionId\": \"eb152808-e993-4e18-9dd8-10f21df57bf1\",\n  \"connections\": {\n    \"Gmail\": {\n      \"main\": [\n        []\n      ]\n    },\n    \"Setup1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Only invoice mails with attachments\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Map Output\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Append to Reconciliation Sheet\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Google Drive\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Extract from File2\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"OpenAI Model\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"Apply Data Extraction Rules\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Rename file1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Move to the correct folder1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Gmail Trigger1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Setup1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Extract from File2\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Apply Data Extraction Rules\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Upload PDF to Drive1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Rename file1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Structured Output Parser\": {\n      \"ai_outputParser\": [\n        [\n          {\n            \"node\": \"Apply Data Extraction Rules\",\n            \"type\": \"ai_outputParser\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Apply Data Extraction Rules\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Map Output\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Move to the correct folder1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Gmail\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Google Drive\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Only invoice mails with attachments\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Upload PDF to Drive1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Gmail\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}