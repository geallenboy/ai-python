{
  "url": "https://n8n.io/workflows/2861-ai-powered-email-processing-autoresponder-and-response-approval-yesno/",
  "title": "AI-powered email processing autoresponder and response approval (Yes/No)",
  "author": "Davide",
  "publish_date": "Last update 4 months ago",
  "publish_date_absolute": "2025-01-26",
  "categories": [
    {
      "name": "AI"
    }
  ],
  "workflow_json": "{\"id\":\"OuHrYOR3uWGmrhWQ\",\"meta\":{\"instanceId\":\"a4bfc93e975ca233ac45ed7c9227d84cf5a2329310525917adaf3312e10d5462\",\"templateCredsSetupCompleted\":true},\"name\":\"AI Email processing autoresponder with approval (Yes/No)\",\"tags\":[],\"nodes\":[{\"id\":\"06a098db-160b-45f7-aeac-a73ef868148e\",\"name\":\"Email Trigger (IMAP)\",\"type\":\"n8n-nodes-base.emailReadImap\",\"position\":[-180,-100],\"parameters\":{\"options\":{}},\"credentials\":{\"imap\":{\"id\":\"k31W9oGddl9pMDy4\",\"name\":\"IMAP info@n3witalia.com\"}},\"typeVersion\":2},{\"id\":\"9589443b-efb7-4e0d-bafc-0be9858a4755\",\"name\":\"Markdown\",\"type\":\"n8n-nodes-base.markdown\",\"position\":[40,-100],\"parameters\":{\"html\":\"={{ $json.textHtml }}\",\"options\":{}},\"typeVersion\":1},{\"id\":\"8de7b2f3-bf75-4f3c-a1ee-eec047a7b82e\",\"name\":\"DeepSeek R1\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\"position\":[240,80],\"parameters\":{\"model\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"deepseek/deepseek-r1:free\",\"cachedResultName\":\"deepseek/deepseek-r1:free\"},\"options\":{}},\"credentials\":{\"openAiApi\":{\"id\":\"XJTqRiKFJpFs5MuX\",\"name\":\"OpenRouter account\"}},\"typeVersion\":1.2},{\"id\":\"babf37dc-99ca-439a-b094-91c52799b8df\",\"name\":\"Send Email\",\"type\":\"n8n-nodes-base.emailSend\",\"position\":[1840,-120],\"webhookId\":\"f84fcde7-6aac-485a-9a08-96a35955af49\",\"parameters\":{\"html\":\"={{ $('Write email').item.json.output }}\",\"options\":{},\"subject\":\"=Re: {{ $('Email Trigger (IMAP)').item.json.subject }}\",\"toEmail\":\"={{ $('Email Trigger (IMAP)').item.json.from }}\",\"fromEmail\":\"={{ $('Email Trigger (IMAP)').item.json.to }}\"},\"credentials\":{\"smtp\":{\"id\":\"hRjP3XbDiIQqvi7x\",\"name\":\"SMTP info@n3witalia.com\"}},\"typeVersion\":2.1},{\"id\":\"ebeb986d-053a-420d-8482-ee00e75f2f10\",\"name\":\"Qdrant Vector Store\",\"type\":\"@n8n/n8n-nodes-langchain.vectorStoreQdrant\",\"position\":[1180,200],\"parameters\":{\"mode\":\"retrieve-as-tool\",\"options\":{},\"toolName\":\"company_knowladge_base\",\"toolDescription\":\"Extracts information regarding the request made.\",\"qdrantCollection\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"=COLLECTION\"},\"includeDocumentMetadata\":false},\"credentials\":{\"qdrantApi\":{\"id\":\"iyQ6MQiVaF3VMBmt\",\"name\":\"QdrantApi account\"}},\"typeVersion\":1},{\"id\":\"ccc3d026-bfa3-4fda-be0a-ef70bf831aa7\",\"name\":\"Embeddings OpenAI\",\"type\":\"@n8n/n8n-nodes-langchain.embeddingsOpenAi\",\"position\":[1180,380],\"parameters\":{\"options\":{}},\"credentials\":{\"openAiApi\":{\"id\":\"CDX6QM4gLYanh0P4\",\"name\":\"OpenAi account\"}},\"typeVersion\":1.2},{\"id\":\"1726aac9-a77d-4f19-8c07-70b032c3abeb\",\"name\":\"Email Summarization Chain\",\"type\":\"@n8n/n8n-nodes-langchain.chainSummarization\",\"position\":[260,-100],\"parameters\":{\"options\":{\"binaryDataKey\":\"={{ $json.data }}\",\"summarizationMethodAndPrompts\":{\"values\":{\"prompt\":\"=Write a concise summary of the following in max 100 words :\\n\\n\\\"{{ $json.data }}\\\"\\n\\nDo not enter the total number of words used.\",\"combineMapPrompt\":\"=Write a concise summary of the following in max 100 words:\\n\\n\\\"{{ $json.data }}\\\"\\n\\nDo not enter the total number of words used.\"}}},\"operationMode\":\"nodeInputBinary\"},\"typeVersion\":2},{\"id\":\"81b889d0-e724-4c1f-9ce3-7593c796aaaf\",\"name\":\"Write email\",\"type\":\"@n8n/n8n-nodes-langchain.agent\",\"position\":[980,-100],\"parameters\":{\"text\":\"=Write the text to reply to the following email:\\n\\n{{ $('Email Summarization Chain').item.json.response.text }}\",\"options\":{\"systemMessage\":\"You are an expert at answering emails. You need to answer them professionally based on the information you have. This is a business email. Be concise and never exceed 100 words. Only the body of the email, not create the subject.\\n\\nIt must be in HTML format and you can insert (if you think it is appropriate) only HTML characters such as <br>, <b>, <i>, <p> where necessary.\"},\"promptType\":\"define\",\"hasOutputParser\":true},\"typeVersion\":1.7},{\"id\":\"cf38e319-59b3-490e-b841-579afc9fbc02\",\"name\":\"OpenAI\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\"position\":[980,200],\"parameters\":{\"model\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"gpt-4o-mini\",\"cachedResultName\":\"gpt-4o-mini\"},\"options\":{}},\"credentials\":{\"openAiApi\":{\"id\":\"CDX6QM4gLYanh0P4\",\"name\":\"OpenAi account\"}},\"typeVersion\":1.2},{\"id\":\"19842e5f-c372-4dfd-b860-87dc5f00b1af\",\"name\":\"Set Email\",\"type\":\"n8n-nodes-base.set\",\"position\":[760,-100],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"759dc0f9-f582-492c-896c-6426f8410127\",\"name\":\"email\",\"type\":\"string\",\"value\":\"={{ $json.response.text }}\"}]}},\"typeVersion\":3.4},{\"id\":\"2cf7a9af-c5e8-45dd-bda5-01c562a0defb\",\"name\":\"Approve?\",\"type\":\"n8n-nodes-base.if\",\"position\":[1560,-100],\"parameters\":{\"options\":{\"ignoreCase\":false},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"5c377c1c-43c6-45e7-904e-dbbe6b682686\",\"operator\":{\"type\":\"boolean\",\"operation\":\"true\",\"singleValue\":true},\"leftValue\":\"={{ $json.data.approved }}\",\"rightValue\":\"true\"}]}},\"typeVersion\":2.2},{\"id\":\"08cabec6-9840-4214-8315-b877c86794bf\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-220,-680],\"parameters\":{\"color\":3,\"width\":580,\"height\":420,\"content\":\"# Main Flow\\n\\n## Preliminary step:\\nCreate a vector database on Qdrant and tokenize the documents useful for generating a response\\n\\n\\n## How it works\\nThis workflow is designed to automate the process of handling incoming emails, summarizing their content, generating appropriate responses with RAG, and obtaining approval (YES/NO button) before sending replies.\\n\\nThis workflow is designed to handle general inquiries that come in via corporate email via IMAP and generate responses using RAG. You can quickly integrate Gmail and Outlook via the appropriate trigger nodes\"},\"typeVersion\":1},{\"id\":\"80692c8f-e236-43ac-aad2-91bd90f40065\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-40,-180],\"parameters\":{\"height\":240,\"content\":\"Convert email to Markdown format for better understanding of LLM models\"},\"typeVersion\":1},{\"id\":\"e6957fde-bf05-4b67-aa0e-44c575fca04d\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[240,-180],\"parameters\":{\"width\":320,\"height\":240,\"content\":\"Chain that summarizes the received email\"},\"typeVersion\":1},{\"id\":\"7cfba59f-83ce-4f0b-b54a-b2c11d58fd82\",\"name\":\"Sticky Note3\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[940,-180],\"parameters\":{\"width\":340,\"height\":240,\"content\":\"Agent that retrieves business information from a vector database and processes the response\"},\"typeVersion\":1},{\"id\":\"28c4bd00-6a47-422f-a50a-935f3724ba01\",\"name\":\"Send Draft\",\"type\":\"n8n-nodes-base.gmail\",\"position\":[1340,-100],\"webhookId\":\"d6dd2e7c-90ea-4b65-9c64-523d2541a054\",\"parameters\":{\"sendTo\":\"YOUR GMAIL ADDRESS\",\"message\":\"=<h3>MESSAGE</h3>\\n{{ $('Email Trigger (IMAP)').item.json.textHtml }}\\n\\n<h3>AI RESPONSE</h3>\\n{{ $json.output }}\",\"options\":{},\"subject\":\"=[Approval Required]  {{ $('Email Trigger (IMAP)').item.json.subject }}\",\"operation\":\"sendAndWait\",\"approvalOptions\":{\"values\":{\"approvalType\":\"double\"}}},\"credentials\":{\"gmailOAuth2\":{\"id\":\"nyuHvSX5HuqfMPlW\",\"name\":\"Gmail account (n3w.it)\"}},\"typeVersion\":2.1},{\"id\":\"0aae1689-cee7-403a-8640-396db32eceed\",\"name\":\"Sticky Note4\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1300,-300],\"parameters\":{\"color\":4,\"height\":360,\"content\":\"## IMPORTANT\\n\\nFor the \\\"Send Draft\\\" node, you need to send the draft email to a Gmail address because it is the only one that allows the \\\"Send and wait for response\\\" function.\"},\"typeVersion\":1}],\"active\":false,\"pinData\":{},\"settings\":{\"executionOrder\":\"v1\"},\"versionId\":\"6f7b864e-1589-418c-960e-b832cf032d1b\",\"connections\":{\"OpenAI\":{\"ai_languageModel\":[[{\"node\":\"Write email\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"Approve?\":{\"main\":[[{\"node\":\"Send Email\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Set Email\",\"type\":\"main\",\"index\":0}]]},\"Markdown\":{\"main\":[[{\"node\":\"Email Summarization Chain\",\"type\":\"main\",\"index\":0}]]},\"Set Email\":{\"main\":[[{\"node\":\"Write email\",\"type\":\"main\",\"index\":0}]]},\"Send Draft\":{\"main\":[[{\"node\":\"Approve?\",\"type\":\"main\",\"index\":0}]]},\"DeepSeek R1\":{\"ai_languageModel\":[[{\"node\":\"Email Summarization Chain\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"Write email\":{\"main\":[[{\"node\":\"Send Draft\",\"type\":\"main\",\"index\":0}]]},\"Embeddings OpenAI\":{\"ai_embedding\":[[{\"node\":\"Qdrant Vector Store\",\"type\":\"ai_embedding\",\"index\":0}]]},\"Qdrant Vector Store\":{\"ai_tool\":[[{\"node\":\"Write email\",\"type\":\"ai_tool\",\"index\":0}]]},\"Email Trigger (IMAP)\":{\"main\":[[{\"node\":\"Markdown\",\"type\":\"main\",\"index\":0}]]},\"Email Summarization Chain\":{\"main\":[[{\"node\":\"Set Email\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "### How it Works\n\nThis workflow is designed to automate the process of handling incoming emails, summarizing their content, generating appropriate responses, and obtaining approval before sending replies. Below are the key operational steps:\n\n  1. **Email Reception and Summarization** :\n\n     * The workflow starts with an `Email Trigger (IMAP)` node that listens for new emails in a specified inbox.\n     * Once an email is received, its HTML content is processed by a `Markdown` node to convert it into plain text if necessary, followed by an `Email Summarization Chain` node which uses AI to create a concise summary of the email's content using prompts tailored for this purpose.\n  2. **Response Generation and Approval** :\n\n     * A `Write email` node generates a professional response based on the summarized content, utilizing predefined templates and guidelines such as keeping responses under 100 words and ensuring they're formatted correctly in HTML.\n     * Before sending out any automated replies, the system sends these drafts via Gmail for human review and approval through a `Gmail` node configured with double-approval settings. If approved (`Approve?`), the finalized email is sent back to the original sender using the `Send Email` node; otherwise, it loops back for further edits or manual intervention.\n\n\n\n### Set Up Steps\n\nTo replicate this workflow within your own n8n environment, follow these essential configuration steps:\n\n  1. **Configuration** :\n\n     * Begin by setting up an n8n instance either locally or via cloud services offered directly from their official site.\n     * Import the provided JSON configuration file into your workspace, making sure all required credentials like IMAP, SMTP, OpenAI API keys, etc., are properly set up under Credentials section since multiple nodes rely heavily on external integrations for functionalities like reading emails, generating summaries, crafting replies, and managing approvals.\n  2. **Customization** :\n\n     * Adjust parameters according to specific business needs, including but not limited to adjusting the conditions used during conditional checks performed by nodes like `Approve?`.\n     * Modify the template messages given to AI models so they align closely with organizational tone & style preferences while maintaining professionalism expected in business communications. Ensure correct mappings between fields when appending data to external systems like Google Sheets or similar platforms where records might need tracking post-interaction completion.\n\n\n",
  "crawled_at": "2025-05-26T02:13:22.672765",
  "readme_zh": "### How it Works\n\nThis workflow is designed to automate the process of handling incoming emails, summarizing their content, generating appropriate responses, and obtaining approval before sending replies. Below are the key operational steps:\n\n  1. **Email Reception and Summarization** :\n\n     * The workflow starts with an `Email Trigger (IMAP)` node that listens for new emails in a specified inbox.\n     * Once an email is received, its HTML content is processed by a `Markdown` node to convert it into plain text if necessary, followed by an `Email Summarization Chain` node which uses AI to create a concise summary of the email's content using prompts tailored for this purpose.\n  2. **Response Generation and Approval** :\n\n     * A `Write email` node generates a professional response based on the summarized content, utilizing predefined templates and guidelines such as keeping responses under 100 words and ensuring they're formatted correctly in HTML.\n     * Before sending out any automated replies, the system sends these drafts via Gmail for human review and approval through a `Gmail` node configured with double-approval settings. If approved (`Approve?`), the finalized email is sent back to the original sender using the `Send Email` node; otherwise, it loops back for further edits or manual intervention.\n\n\n\n### Set Up Steps\n\nTo replicate this workflow within your own n8n environment, follow these essential configuration steps:\n\n  1. **Configuration** :\n\n     * Begin by setting up an n8n instance either locally or via cloud services offered directly from their official site.\n     * Import the provided JSON configuration file into your workspace, making sure all required credentials like IMAP, SMTP, OpenAI API keys, etc., are properly set up under Credentials section since multiple nodes rely heavily on external integrations for functionalities like reading emails, generating summaries, crafting replies, and managing approvals.\n  2. **Customization** :\n\n     * Adjust parameters according to specific business needs, including but not limited to adjusting the conditions used during conditional checks performed by nodes like `Approve?`.\n     * Modify the template messages given to AI models so they align closely with organizational tone & style preferences while maintaining professionalism expected in business communications. Ensure correct mappings between fields when appending data to external systems like Google Sheets or similar platforms where records might need tracking post-interaction completion.\n\n\n",
  "title_zh": "AI驱动的电子邮件处理自动回复及回复审批（是/否）",
  "publish_date_zh": "最后更新于3个月前",
  "workflow_json_zh": "{\n  \"id\": \"OuHrYOR3uWGmrhWQ\",\n  \"meta\": {\n    \"instanceId\": \"a4bfc93e975ca233ac45ed7c9227d84cf5a2329310525917adaf3312e10d5462\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"name\": \"AI Email processing autoresponder with approval (Yes/No)\",\n  \"tags\": [],\n  \"nodes\": [\n    {\n      \"id\": \"06a098db-160b-45f7-aeac-a73ef868148e\",\n      \"name\": \"Email Trigger (IMAP)\",\n      \"type\": \"n8n-nodes-base.emailReadImap\",\n      \"position\": [\n        -180,\n        -100\n      ],\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"imap\": {\n          \"id\": \"k31W9oGddl9pMDy4\",\n          \"name\": \"IMAP info@n3witalia.com\"\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"9589443b-efb7-4e0d-bafc-0be9858a4755\",\n      \"name\": \"Markdown\",\n      \"type\": \"n8n-nodes-base.markdown\",\n      \"position\": [\n        40,\n        -100\n      ],\n      \"parameters\": {\n        \"html\": \"={{ $json.textHtml }}\",\n        \"options\": {}\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"8de7b2f3-bf75-4f3c-a1ee-eec047a7b82e\",\n      \"name\": \"DeepSeek R1\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\n      \"position\": [\n        240,\n        80\n      ],\n      \"parameters\": {\n        \"model\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"deepseek/deepseek-r1:free\",\n          \"cachedResultName\": \"deepseek/deepseek-r1:free\"\n        },\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"XJTqRiKFJpFs5MuX\",\n          \"name\": \"OpenRouter account\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"babf37dc-99ca-439a-b094-91c52799b8df\",\n      \"name\": \"Send Email\",\n      \"type\": \"n8n-nodes-base.emailSend\",\n      \"position\": [\n        1840,\n        -120\n      ],\n      \"webhookId\": \"f84fcde7-6aac-485a-9a08-96a35955af49\",\n      \"parameters\": {\n        \"html\": \"={{ $('Write email').item.json.output }}\",\n        \"options\": {},\n        \"subject\": \"=Re: {{ $('Email Trigger (IMAP)').item.json.subject }}\",\n        \"toEmail\": \"={{ $('Email Trigger (IMAP)').item.json.from }}\",\n        \"fromEmail\": \"={{ $('Email Trigger (IMAP)').item.json.to }}\"\n      },\n      \"credentials\": {\n        \"smtp\": {\n          \"id\": \"hRjP3XbDiIQqvi7x\",\n          \"name\": \"SMTP info@n3witalia.com\"\n        }\n      },\n      \"typeVersion\": 2.1\n    },\n    {\n      \"id\": \"ebeb986d-053a-420d-8482-ee00e75f2f10\",\n      \"name\": \"Qdrant Vector Store\",\n      \"type\": \"@n8n/n8n-nodes-langchain.vectorStoreQdrant\",\n      \"position\": [\n        1180,\n        200\n      ],\n      \"parameters\": {\n        \"mode\": \"retrieve-as-tool\",\n        \"options\": {},\n        \"toolName\": \"company_knowladge_base\",\n        \"toolDescription\": \"Extracts information regarding the request made.\",\n        \"qdrantCollection\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"=COLLECTION\"\n        },\n        \"includeDocumentMetadata\": false\n      },\n      \"credentials\": {\n        \"qdrantApi\": {\n          \"id\": \"iyQ6MQiVaF3VMBmt\",\n          \"name\": \"QdrantApi account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"ccc3d026-bfa3-4fda-be0a-ef70bf831aa7\",\n      \"name\": \"Embeddings OpenAI\",\n      \"type\": \"@n8n/n8n-nodes-langchain.embeddingsOpenAi\",\n      \"position\": [\n        1180,\n        380\n      ],\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"CDX6QM4gLYanh0P4\",\n          \"name\": \"OpenAi account\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"1726aac9-a77d-4f19-8c07-70b032c3abeb\",\n      \"name\": \"Email Summarization Chain\",\n      \"type\": \"@n8n/n8n-nodes-langchain.chainSummarization\",\n      \"position\": [\n        260,\n        -100\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"binaryDataKey\": \"={{ $json.data }}\",\n          \"summarizationMethodAndPrompts\": {\n            \"values\": {\n              \"prompt\": \"=Write a concise summary of the following in max 100 words :\\n\\n\\\"{{ $json.data }}\\\"\\n\\nDo not enter the total number of words used.\",\n              \"combineMapPrompt\": \"=Write a concise summary of the following in max 100 words:\\n\\n\\\"{{ $json.data }}\\\"\\n\\nDo not enter the total number of words used.\"\n            }\n          }\n        },\n        \"operationMode\": \"nodeInputBinary\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"81b889d0-e724-4c1f-9ce3-7593c796aaaf\",\n      \"name\": \"Write email\",\n      \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n      \"position\": [\n        980,\n        -100\n      ],\n      \"parameters\": {\n        \"text\": \"=Write the text to reply to the following email:\\n\\n{{ $('Email Summarization Chain').item.json.response.text }}\",\n        \"options\": {\n          \"systemMessage\": \"You are an expert at answering emails. You need to answer them professionally based on the information you have. This is a business email. Be concise and never exceed 100 words. Only the body of the email, not create the subject.\\n\\nIt must be in HTML format and you can insert (if you think it is appropriate) only HTML characters such as <br>, <b>, <i>, <p> where necessary.\"\n        },\n        \"promptType\": \"define\",\n        \"hasOutputParser\": true\n      },\n      \"typeVersion\": 1.7\n    },\n    {\n      \"id\": \"cf38e319-59b3-490e-b841-579afc9fbc02\",\n      \"name\": \"OpenAI\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\n      \"position\": [\n        980,\n        200\n      ],\n      \"parameters\": {\n        \"model\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"gpt-4o-mini\",\n          \"cachedResultName\": \"gpt-4o-mini\"\n        },\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"CDX6QM4gLYanh0P4\",\n          \"name\": \"OpenAi account\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"19842e5f-c372-4dfd-b860-87dc5f00b1af\",\n      \"name\": \"Set Email\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        760,\n        -100\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"759dc0f9-f582-492c-896c-6426f8410127\",\n              \"name\": \"email\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.response.text }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"2cf7a9af-c5e8-45dd-bda5-01c562a0defb\",\n      \"name\": \"Approve?\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        1560,\n        -100\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"ignoreCase\": false\n        },\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"5c377c1c-43c6-45e7-904e-dbbe6b682686\",\n              \"operator\": {\n                \"type\": \"boolean\",\n                \"operation\": \"true\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json.data.approved }}\",\n              \"rightValue\": \"true\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"08cabec6-9840-4214-8315-b877c86794bf\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -220,\n        -680\n      ],\n      \"parameters\": {\n        \"color\": 3,\n        \"width\": 580,\n        \"height\": 420,\n        \"content\": \"# Main Flow\\n\\n## Preliminary step:\\nCreate a vector database on Qdrant and tokenize the documents useful for generating a response\\n\\n\\n## How it works\\nThis workflow is designed to automate the process of handling incoming emails, summarizing their content, generating appropriate responses with RAG, and obtaining approval (YES/NO button) before sending replies.\\n\\nThis workflow is designed to handle general inquiries that come in via corporate email via IMAP and generate responses using RAG. You can quickly integrate Gmail and Outlook via the appropriate trigger nodes\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"80692c8f-e236-43ac-aad2-91bd90f40065\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -40,\n        -180\n      ],\n      \"parameters\": {\n        \"height\": 240,\n        \"content\": \"将电子邮件转换为Markdown格式以便更好地理解LLM模型\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"e6957fde-bf05-4b67-aa0e-44c575fca04d\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        240,\n        -180\n      ],\n      \"parameters\": {\n        \"width\": 320,\n        \"height\": 240,\n        \"content\": \"总结所收邮件内容的链条\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"7cfba59f-83ce-4f0b-b54a-b2c11d58fd82\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        940,\n        -180\n      ],\n      \"parameters\": {\n        \"width\": 340,\n        \"height\": 240,\n        \"content\": \"从向量数据库中检索业务信息并处理响应的代理\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"28c4bd00-6a47-422f-a50a-935f3724ba01\",\n      \"name\": \"Send Draft\",\n      \"type\": \"n8n-nodes-base.gmail\",\n      \"position\": [\n        1340,\n        -100\n      ],\n      \"webhookId\": \"d6dd2e7c-90ea-4b65-9c64-523d2541a054\",\n      \"parameters\": {\n        \"sendTo\": \"YOUR GMAIL ADDRESS\",\n        \"message\": \"=<h3>MESSAGE</h3>\\n{{ $('Email Trigger (IMAP)').item.json.textHtml }}\\n\\n<h3>AI RESPONSE</h3>\\n{{ $json.output }}\",\n        \"options\": {},\n        \"subject\": \"=[Approval Required]  {{ $('Email Trigger (IMAP)').item.json.subject }}\",\n        \"operation\": \"sendAndWait\",\n        \"approvalOptions\": {\n          \"values\": {\n            \"approvalType\": \"double\"\n          }\n        }\n      },\n      \"credentials\": {\n        \"gmailOAuth2\": {\n          \"id\": \"nyuHvSX5HuqfMPlW\",\n          \"name\": \"Gmail account (n3w.it)\"\n        }\n      },\n      \"typeVersion\": 2.1\n    },\n    {\n      \"id\": \"0aae1689-cee7-403a-8640-396db32eceed\",\n      \"name\": \"Sticky Note4\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1300,\n        -300\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"height\": 360,\n        \"content\": \"## 重要提示\\n\\n对于\\\"发送草稿\\\"节点，您需要将草稿邮件发送至Gmail邮箱地址，因为这是唯一支持\\\"发送并等待回复\\\"功能的邮箱服务。\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"active\": false,\n  \"pinData\": {},\n  \"settings\": {\n    \"executionOrder\": \"v1\"\n  },\n  \"versionId\": \"6f7b864e-1589-418c-960e-b832cf032d1b\",\n  \"connections\": {\n    \"OpenAI\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"Write email\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Approve?\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Send Email\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Set Email\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Markdown\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Email Summarization Chain\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Set Email\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Write email\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Send Draft\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Approve?\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"DeepSeek R1\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"Email Summarization Chain\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Write email\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Send Draft\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Embeddings OpenAI\": {\n      \"ai_embedding\": [\n        [\n          {\n            \"node\": \"Qdrant Vector Store\",\n            \"type\": \"ai_embedding\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Qdrant Vector Store\": {\n      \"ai_tool\": [\n        [\n          {\n            \"node\": \"Write email\",\n            \"type\": \"ai_tool\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Email Trigger (IMAP)\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Markdown\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Email Summarization Chain\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Set Email\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}