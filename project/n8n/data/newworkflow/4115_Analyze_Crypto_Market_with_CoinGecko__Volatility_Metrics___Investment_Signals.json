{
  "url": "https://n8n.io/workflows/4115-analyze-crypto-market-with-coingecko-volatility-metrics-and-investment-signals/",
  "title": "Analyze Crypto Market with CoinGecko: Volatility Metrics & Investment Signals",
  "author": "ist00dent",
  "publish_date": "Last update 6 days ago",
  "publish_date_absolute": "2025-05-20",
  "categories": [
    {
      "name": "Finance"
    }
  ],
  "workflow_json": "{\"id\":\"Uw1r9yGqgPRykfUs\",\"meta\":{\"instanceId\":\"3fed23de697c60307f3b4f5caeafbeffabaf7bbd62c1b20ae70d5faf5a9806b4\"},\"name\":\"day9_getting_updated_in_crypto\",\"tags\":[{\"id\":\"4zX1mtizlZxTekJP\",\"name\":\"training-tasks-n8n\",\"createdAt\":\"2025-04-29T10:41:14.716Z\",\"updatedAt\":\"2025-04-29T10:41:14.716Z\"},{\"id\":\"F1KjxL3SjfvVqZqo\",\"name\":\"training-n8n\",\"createdAt\":\"2025-04-29T10:40:13.332Z\",\"updatedAt\":\"2025-04-29T10:40:13.332Z\"}],\"nodes\":[{\"id\":\"745e4849-8c61-4b29-9980-24de93821adb\",\"name\":\"Fetch Crypto Data\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[220,385],\"parameters\":{\"url\":\"https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&order=market_cap_desc&per_page=10&page=1&sparkline=false&price_change_percentage=24h,7d,30d\",\"options\":{}},\"typeVersion\":3},{\"id\":\"f4e6c40d-ab60-473b-9961-961eb1fa3505\",\"name\":\"Calculate Market Metrics\",\"type\":\"n8n-nodes-base.function\",\"position\":[660,385],\"parameters\":{\"functionCode\":\"// Calculate a volatility score based on price changes\\nconst item = $input.item.json;\\n\\n// Extract price change percentages\\nconst priceChange24h = item.price_change_percentage_24h || 0;\\nconst priceChange7d = item.price_change_percentage_7d_in_currency || 0;\\nconst priceChange30d = item.price_change_percentage_30d_in_currency || 0;\\n\\n// Calculate absolute values to measure volatility regardless of direction\\nconst absChange24h = Math.abs(priceChange24h);\\nconst absChange7d = Math.abs(priceChange7d);\\nconst absChange30d = Math.abs(priceChange30d);\\n\\n// Calculate a weighted volatility score (more weight to recent changes)\\nconst volatilityScore = (absChange24h * 0.5) + (absChange7d * 0.3) + (absChange30d * 0.2);\\n\\n// Calculate market cap to volume ratio (higher means less liquid/more volatile)\\nconst marketCapToVolumeRatio = item.market_cap / (item.total_volume || 1);\\n\\n// Calculate price to ATH ratio (close to 1 means near all-time high)\\nconst priceToAthRatio = item.current_price / (item.ath || item.current_price);\\n\\n// Calculate a composite market score\\nconst marketScore = (\\n  (volatilityScore * 0.4) + \\n  (Math.min(marketCapToVolumeRatio, 10) * 0.3) + \\n  ((1 - priceToAthRatio) * 30) // Invert so coins further from ATH get higher scores\\n);\\n\\n// Add calculated metrics to the item\\nitem.volatilityScore = parseFloat(volatilityScore.toFixed(2));\\nitem.marketCapToVolumeRatio = parseFloat(marketCapToVolumeRatio.toFixed(2));\\nitem.priceToAthRatio = parseFloat(priceToAthRatio.toFixed(4));\\nitem.marketScore = parseFloat(marketScore.toFixed(2));\\n\\n// Add a timestamp for the analysis\\nitem.analyzedAt = new Date().toISOString();\\n\\nreturn {json: item};\"},\"typeVersion\":1},{\"id\":\"5d760f94-ca2f-44cc-aef0-83eb2cf438ee\",\"name\":\"IF 24h Price Up >5%\",\"type\":\"n8n-nodes-base.if\",\"position\":[880,60],\"parameters\":{\"conditions\":{\"number\":[{\"value1\":\"={{ $json.price_change_percentage_24h }}\",\"value2\":5,\"operation\":\"larger\"}]}},\"typeVersion\":1},{\"id\":\"19ca8650-b642-4910-ac7c-50b1ceb41ffc\",\"name\":\"IF 24h Price Down >5%\",\"type\":\"n8n-nodes-base.if\",\"position\":[1100,260],\"parameters\":{\"conditions\":{\"number\":[{\"value1\":\"={{ $json.price_change_percentage_24h }}\",\"value2\":-5}]}},\"typeVersion\":1},{\"id\":\"c5d69bbb-df7e-4089-b0c8-50653cd936f0\",\"name\":\"IF High Volatility\",\"type\":\"n8n-nodes-base.if\",\"position\":[1320,560],\"parameters\":{\"conditions\":{\"number\":[{\"value1\":\"={{ $json.volatilityScore }}\",\"value2\":10,\"operation\":\"larger\"}]}},\"typeVersion\":1},{\"id\":\"77902b9a-2cf8-4b6f-95e9-590b51278c59\",\"name\":\"Set Uptrend Data\",\"type\":\"n8n-nodes-base.set\",\"position\":[1540,60],\"parameters\":{\"values\":{\"string\":[{\"name\":\"priceAction\",\"value\":\"Strong upward momentum in the past 24 hours\"},{\"name\":\"signal\",\"value\":\"BUY\"},{\"name\":\"recommendation\",\"value\":\"Consider buying on continued strength above resistance levels. Set stop loss at recent support.\"},{\"name\":\"investmentStrategy\",\"value\":\"Momentum strategy with trailing stop loss. Consider dollar-cost averaging to manage volatility risk.\"}]},\"options\":{\"dotNotation\":true}},\"typeVersion\":2},{\"id\":\"4706270b-3bdc-4806-a302-830a88c9a982\",\"name\":\"Set Downtrend Data\",\"type\":\"n8n-nodes-base.set\",\"position\":[1540,260],\"parameters\":{\"values\":{\"string\":[{\"name\":\"priceAction\",\"value\":\"Rapid price decline in the past 24 hours\"},{\"name\":\"signal\",\"value\":\"SELL\"},{\"name\":\"recommendation\",\"value\":\"Consider reducing exposure or implementing hedging strategies. Watch for oversold conditions.\"},{\"name\":\"investmentStrategy\",\"value\":\"Capital preservation is priority. Consider re-evaluation after price stabilization.\"}]},\"options\":{\"dotNotation\":true}},\"typeVersion\":2},{\"id\":\"608729c4-23a5-4c5b-b9a0-d77f12166aa3\",\"name\":\"Set Volatility Data\",\"type\":\"n8n-nodes-base.set\",\"position\":[1540,460],\"parameters\":{\"values\":{\"string\":[{\"name\":\"priceAction\",\"value\":\"High volatility with significant price swings\"},{\"name\":\"signal\",\"value\":\"HOLD\"},{\"name\":\"recommendation\",\"value\":\"High volatility indicates market uncertainty. Consider waiting for clearer signals before making major positions.\"},{\"name\":\"investmentStrategy\",\"value\":\"Range-trading strategy may be effective. Set both upper and lower limit orders.\"}]},\"options\":{\"dotNotation\":true}},\"typeVersion\":2},{\"id\":\"f8134b51-4b41-4684-97a9-008e5f0260df\",\"name\":\"Set Stable Data\",\"type\":\"n8n-nodes-base.set\",\"position\":[1540,660],\"parameters\":{\"values\":{\"string\":[{\"name\":\"priceAction\",\"value\":\"Relatively stable price action with minimal volatility\"},{\"name\":\"signal\",\"value\":\"NEUTRAL\"},{\"name\":\"recommendation\",\"value\":\"Market is consolidating. Watch for breakout signals in either direction.\"},{\"name\":\"investmentStrategy\",\"value\":\"Consider accumulating small positions or implementing a neutral options strategy.\"}]},\"options\":{\"dotNotation\":true}},\"typeVersion\":2},{\"id\":\"5f43178c-7bb5-405d-a988-b3b0ae0a0405\",\"name\":\"Merge Results\",\"type\":\"n8n-nodes-base.noOp\",\"position\":[1760,360],\"parameters\":{},\"typeVersion\":1},{\"id\":\"e422a9e1-9016-4db9-912b-58be44604eb2\",\"name\":\"Set High Risk Rating\",\"type\":\"n8n-nodes-base.set\",\"position\":[2200,-40],\"parameters\":{\"values\":{\"string\":[{\"name\":\"riskRating\",\"value\":\"High Risk\"},{\"name\":\"investmentStrategy\",\"value\":\"={{ $json.investmentStrategy }} Due to high risk profile, use strict position sizing (max 2-5% of portfolio).\"}]},\"options\":{\"dotNotation\":true}},\"typeVersion\":2},{\"id\":\"383a55c7-f42f-4a32-b6ba-742049406f67\",\"name\":\"Set Medium Risk Rating\",\"type\":\"n8n-nodes-base.set\",\"position\":[2200,160],\"parameters\":{\"values\":{\"string\":[{\"name\":\"riskRating\",\"value\":\"Medium Risk\"},{\"name\":\"investmentStrategy\",\"value\":\"={{ $json.investmentStrategy }} Moderate risk profile suggests balanced position sizing (5-10% of portfolio).\"}]},\"options\":{\"dotNotation\":true}},\"typeVersion\":2},{\"id\":\"2f50e6cd-dd62-4fb2-8ee2-28096c758e23\",\"name\":\"Set Low Risk Rating\",\"type\":\"n8n-nodes-base.set\",\"position\":[2200,460],\"parameters\":{\"values\":{\"string\":[{\"name\":\"riskRating\",\"value\":\"Low Risk\"},{\"name\":\"investmentStrategy\",\"value\":\"={{ $json.investmentStrategy }} Lower risk profile allows for larger position sizing (10-15% of portfolio).\"}]},\"options\":{\"dotNotation\":true}},\"typeVersion\":2},{\"id\":\"5a820de9-11f8-4aa7-8811-afb6153a7b54\",\"name\":\"Set Default Risk Rating\",\"type\":\"n8n-nodes-base.set\",\"position\":[2200,660],\"parameters\":{\"values\":{\"string\":[{\"name\":\"riskRating\",\"value\":\"Unknown Risk\"},{\"name\":\"investmentStrategy\",\"value\":\"={{ $json.investmentStrategy }} Risk profile is unclear - use conservative position sizing until more data is available.\"}]},\"options\":{\"dotNotation\":true}},\"typeVersion\":2},{\"id\":\"9b39eb90-f0c8-44df-9721-ef1d60a8a0fc\",\"name\":\"Final Merge\",\"type\":\"n8n-nodes-base.noOp\",\"position\":[2420,360],\"parameters\":{},\"typeVersion\":1},{\"id\":\"f84bd02a-92d1-49c7-9ba3-36e860a31636\",\"name\":\"Format Final Analysis\",\"type\":\"n8n-nodes-base.function\",\"position\":[2640,635],\"parameters\":{\"functionCode\":\"// Create a formatted summary for each coin\\nconst item = $input.item.json;\\n\\n// Format dollar amounts nicely\\nconst formatCurrency = (value) => {\\n  return new Intl.NumberFormat('en-US', {\\n    style: 'currency',\\n    currency: 'USD',\\n    minimumFractionDigits: 2,\\n    maximumFractionDigits: 2\\n  }).format(value);\\n};\\n\\n// Format percentages nicely\\nconst formatPercent = (value) => {\\n  return `${value > 0 ? '+' : ''}${value.toFixed(2)}%`;\\n};\\n\\n// Create a detailed analysis report\\nconst analysisReport = {\\n  coin: item.name,\\n  symbol: item.symbol.toUpperCase(),\\n  currentPrice: formatCurrency(item.current_price),\\n  marketCap: formatCurrency(item.market_cap),\\n  volume24h: formatCurrency(item.total_volume),\\n  priceChanges: {\\n    \\\"24h\\\": formatPercent(item.price_change_percentage_24h),\\n    \\\"7d\\\": formatPercent(item.price_change_percentage_7d_in_currency),\\n    \\\"30d\\\": formatPercent(item.price_change_percentage_30d_in_currency)\\n  },\\n  marketMetrics: {\\n    volatilityScore: item.volatilityScore,\\n    marketCapToVolumeRatio: item.marketCapToVolumeRatio,\\n    priceToAthRatio: item.priceToAthRatio,\\n    marketScore: item.marketScore\\n  },\\n  analysis: {\\n    priceAction: item.priceAction,\\n    signal: item.signal,\\n    riskRating: item.riskRating,\\n    recommendation: item.recommendation,\\n    investmentStrategy: item.investmentStrategy\\n  },\\n  timestamp: item.analyzedAt\\n};\\n\\n// Generate a natural language summary\\nconst summary = `\\n## ${item.name} (${item.symbol.toUpperCase()}) Analysis\\n\\nCurrent Price: ${formatCurrency(item.current_price)} (${formatPercent(item.price_change_percentage_24h)} 24h)\\\\n\\\\n\\n\\nMarket Signal: **${item.signal}** - *${item.priceAction}*\\nRisk Rating: **${item.riskRating}**\\\\n\\\\n\\n\\n**Recommendation:**\\n${item.recommendation}\\n\\n**Investment Strategy:**\\n${item.investmentStrategy}\\n\\n---\\n*Analysis based on volatility score of ${item.volatilityScore} and market score of ${item.marketScore}*\\n`;\\n\\n// Return both structured data and a human-readable summary\\nreturn {\\n  json: {\\n    ...item,\\n    analysisReport,\\n    summary\\n  }\\n};\"},\"typeVersion\":1},{\"id\":\"911280f8-82cb-42ee-bd8a-6de15c58f188\",\"name\":\"Collect All Analyses\",\"type\":\"n8n-nodes-base.noOp\",\"position\":[660,-140],\"parameters\":{},\"typeVersion\":1},{\"id\":\"a4de8078-7f49-4b22-a11a-a2efabfa16b1\",\"name\":\"Generate Portfolio Summary\",\"type\":\"n8n-nodes-base.function\",\"position\":[880,-140],\"parameters\":{\"functionCode\":\"// Create a portfolio summary based on all coin analyses\\nconst allCoins = $input.all();\\n\\n// Extract all analyzed coins\\nconst analyzedCoins = allCoins.map(coin => coin.json);\\n\\n// Count signals by type\\nconst signalCounts = {\\n  BUY: 0,\\n  SELL: 0,\\n  HOLD: 0,\\n  NEUTRAL: 0\\n};\\n\\n// Count risk ratings\\nconst riskCounts = {\\n  \\\"High Risk\\\": 0,\\n  \\\"Medium Risk\\\": 0,\\n  \\\"Low Risk\\\": 0,\\n  \\\"Unknown Risk\\\": 0\\n};\\n\\n// Calculate portfolio metrics\\nanalyzedCoins.forEach(coin => {\\n  // Count signals\\n  if (coin.signal) {\\n    signalCounts[coin.signal] = (signalCounts[coin.signal] || 0) + 1;\\n  }\\n\\n  // Count risk ratings\\n  if (coin.riskRating) {\\n    riskCounts[coin.riskRating] = (riskCounts[coin.riskRating] || 0) + 1;\\n  }\\n});\\n\\n// Sort coins by market score (highest first)\\nconst sortedCoins = [...analyzedCoins].sort((a, b) => b.marketScore - a.marketScore);\\n\\n// Get top recommendation\\nconst topOpportunity = sortedCoins[0];\\n\\n// Generate portfolio summary markdown\\nconst portfolioSummary = `# Cryptocurrency Market Analysis\\n\\n## Market Overview\\n**Analyzed Coins:** ${analyzedCoins.length}  \\n**Buy Signals:** ${signalCounts.BUY}  \\n**Sell Signals:** ${signalCounts.SELL}  \\n**Hold Signals:** ${signalCounts.HOLD}  \\n**Neutral Signals:** ${signalCounts.NEUTRAL}  \\n\\n## Risk Distribution\\n**High Risk Assets:** ${riskCounts[\\\"High Risk\\\"]}  \\n**Medium Risk Assets:** ${riskCounts[\\\"Medium Risk\\\"]}  \\n**Low Risk Assets:** ${riskCounts[\\\"Low Risk\\\"]}  \\n\\n## Top Opportunity  \\n${topOpportunity ? `**${topOpportunity.name} (${topOpportunity.symbol.toUpperCase()})**  \\n${topOpportunity.summary}` : \\\"No opportunities found\\\"}\\n\\n## Detailed Coin Analyses  \\n${sortedCoins.map(coin => `**${coin.name} (${coin.symbol})**  \\n${coin.summary}`).join('\\\\n\\\\n')}\\n\\n*Analysis generated on ${new Date().toLocaleString()}*`;\\n\\nreturn [\\n  {\\n    json: {\\n      portfolioSummary,\\n      individualAnalyses: analyzedCoins.map(coin => coin.analysisReport),\\n      marketSignals: signalCounts,\\n      riskDistribution: riskCounts,\\n      timestamp: new Date().toISOString()\\n    }\\n  }\\n];\\n\"},\"typeVersion\":1},{\"id\":\"3277b96e-ab2c-4561-a29c-958998f45686\",\"name\":\"Loop Over Items\",\"type\":\"n8n-nodes-base.splitInBatches\",\"position\":[440,385],\"parameters\":{\"options\":{}},\"typeVersion\":3},{\"id\":\"8256a60a-ddb8-4d72-b443-8fba819815bb\",\"name\":\"Switch by Market Score\",\"type\":\"n8n-nodes-base.switch\",\"position\":[1980,339],\"parameters\":{\"rules\":{\"rules\":[{\"value2\":20,\"operation\":\"larger\"},{\"value2\":10,\"operation\":\"larger\"},{\"operation\":\"larger\"}]},\"value1\":\"={{ $json.marketScore }}\",\"fallbackOutput\":3},\"typeVersion\":1},{\"id\":\"b8cb4f7d-3818-48df-89ea-9db22797375a\",\"name\":\"Split Out\",\"type\":\"n8n-nodes-base.splitOut\",\"position\":[1100,-140],\"parameters\":{\"options\":{},\"fieldToSplitOut\":\"individualAnalyses\"},\"typeVersion\":1},{\"id\":\"936e9ada-4b6b-4cab-90e1-0bea30eaaa0c\",\"name\":\"Respond to Webhook\",\"type\":\"n8n-nodes-base.respondToWebhook\",\"position\":[1320,-140],\"parameters\":{\"options\":{},\"respondWith\":\"allIncomingItems\"},\"typeVersion\":1.1},{\"id\":\"7791cebf-4733-4cf6-8341-96771733b507\",\"name\":\"Webhook\",\"type\":\"n8n-nodes-base.webhook\",\"position\":[0,380],\"webhookId\":\"31941fd9-9fd5-4fab-a1b9-9c347e26f5c9\",\"parameters\":{\"path\":\"31941fd9-9fd5-4fab-a1b9-9c347e26f5c9\",\"options\":{},\"responseMode\":\"responseNode\"},\"typeVersion\":2},{\"id\":\"d25b2427-9fc7-4042-92f2-673de5019206\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[2120,-140],\"parameters\":{\"width\":260,\"height\":960,\"content\":\"## Categorize and set the rating of coin\"},\"typeVersion\":1},{\"id\":\"ac3a6503-5ce7-406d-9efb-122928239337\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[680,40],\"parameters\":{},\"typeVersion\":1},{\"id\":\"c4e4e17d-bf13-44a2-9a9e-1d22104f1062\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[140,-20],\"parameters\":{\"content\":\"## This workflow aims to\"},\"typeVersion\":1}],\"active\":false,\"pinData\":{},\"settings\":{\"executionOrder\":\"v1\"},\"versionId\":\"be12f8a1-3c44-4a1c-8f74-d1df269de92c\",\"connections\":{\"Webhook\":{\"main\":[[{\"node\":\"Fetch Crypto Data\",\"type\":\"main\",\"index\":0}]]},\"Split Out\":{\"main\":[[{\"node\":\"Respond to Webhook\",\"type\":\"main\",\"index\":0}]]},\"Final Merge\":{\"main\":[[{\"node\":\"Format Final Analysis\",\"type\":\"main\",\"index\":0}]]},\"Merge Results\":{\"main\":[[{\"node\":\"Switch by Market Score\",\"type\":\"main\",\"index\":0}]]},\"Loop Over Items\":{\"main\":[[{\"node\":\"Collect All Analyses\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Calculate Market Metrics\",\"type\":\"main\",\"index\":0}]]},\"Set Stable Data\":{\"main\":[[{\"node\":\"Merge Results\",\"type\":\"main\",\"index\":0}]]},\"Set Uptrend Data\":{\"main\":[[{\"node\":\"Merge Results\",\"type\":\"main\",\"index\":0}]]},\"Fetch Crypto Data\":{\"main\":[[{\"node\":\"Loop Over Items\",\"type\":\"main\",\"index\":0}]]},\"IF High Volatility\":{\"main\":[[{\"node\":\"Set Volatility Data\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Set Stable Data\",\"type\":\"main\",\"index\":0}]]},\"Set Downtrend Data\":{\"main\":[[{\"node\":\"Merge Results\",\"type\":\"main\",\"index\":0}]]},\"IF 24h Price Up >5%\":{\"main\":[[{\"node\":\"Set Uptrend Data\",\"type\":\"main\",\"index\":0}],[{\"node\":\"IF 24h Price Down >5%\",\"type\":\"main\",\"index\":0}]]},\"Set Low Risk Rating\":{\"main\":[[{\"node\":\"Final Merge\",\"type\":\"main\",\"index\":0}]]},\"Set Volatility Data\":{\"main\":[[{\"node\":\"Merge Results\",\"type\":\"main\",\"index\":0}]]},\"Collect All Analyses\":{\"main\":[[{\"node\":\"Generate Portfolio Summary\",\"type\":\"main\",\"index\":0}]]},\"Set High Risk Rating\":{\"main\":[[{\"node\":\"Final Merge\",\"type\":\"main\",\"index\":0}]]},\"Format Final Analysis\":{\"main\":[[{\"node\":\"Loop Over Items\",\"type\":\"main\",\"index\":0}]]},\"IF 24h Price Down >5%\":{\"main\":[[{\"node\":\"Set Downtrend Data\",\"type\":\"main\",\"index\":0}],[{\"node\":\"IF High Volatility\",\"type\":\"main\",\"index\":0}]]},\"Set Medium Risk Rating\":{\"main\":[[{\"node\":\"Final Merge\",\"type\":\"main\",\"index\":0}]]},\"Switch by Market Score\":{\"main\":[[{\"node\":\"Set High Risk Rating\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Set Medium Risk Rating\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Set Low Risk Rating\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Set Default Risk Rating\",\"type\":\"main\",\"index\":0}]]},\"Set Default Risk Rating\":{\"main\":[[{\"node\":\"Final Merge\",\"type\":\"main\",\"index\":0}]]},\"Calculate Market Metrics\":{\"main\":[[{\"node\":\"IF 24h Price Up >5%\",\"type\":\"main\",\"index\":0},{\"node\":\"IF 24h Price Down >5%\",\"type\":\"main\",\"index\":0},{\"node\":\"IF High Volatility\",\"type\":\"main\",\"index\":0}]]},\"Generate Portfolio Summary\":{\"main\":[[{\"node\":\"Split Out\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "This n8n template lets you automatically pull market data for the cryptocurrencies from CoinGecko every hour, calculate custom volatility and market-health metrics, classify each coin’s price action into buy/sell/hold/neutral signals with risk ratings, and expose both individual analyses and a portfolio summary via a webhook. It’s perfect for crypto analysts, DeFi builders, or portfolio managers who want on-demand insights without writing a single line of backend code.\n\n* * *\n\n# 🔧 How it works\n\n  * Schedule Trigger fires every hour (or interval you choose).\n\n  * HTTP Request (CoinGecko) fetches the top 10 coins by market cap, including 24 h, 7 d, and 30 d price change percentages.\n\n  * Split In Batches ensures each coin is processed sequentially.\n\n  * Function (Calculate Market Metrics) computes:\n\n    * A weighted volatility score\n    * Market-cap-to-volume ratio\n    * Price-to-ATH ratio\n    * Composite market score\n  * IF & Switch nodes categorize each coin’s 24 h price action (up >5%, down >5%, high volatility, or stable) and append:\n\n    * signal (BUY/SELL/HOLD/NEUTRAL)\n    * riskRating (High/Medium/Low/Unknown)\n    * recommendation & investmentStrategy guidance\n  * NoOp & Merge nodes consolidate each branch back into a single data stream.\n\n  * Function (Generate Portfolio Summary) aggregates all analyses into:\n\n    * A Markdown portfolioSummary\n    * Counts of buy/sell/hold/neutral signals\n    * Risk distribution\n  * Webhook Response returns the full JSON payload with individual analyses and the summary for downstream consumers.\n\n\n\n\n* * *\n\n# 👤 Who is it for?\n\n### This workflow is ideal for:\n\n  * Crypto researchers and analysts who need scheduled market insights\n\n  * DeFi and trading bot developers looking to automate signal generation\n\n  * Portfolio managers seeking a no-code overview of top assets\n\n  * Automation engineers exploring API integration and data enrichment\n\n\n\n\n* * *\n\n# 📑 Data Structure\n\n### When you trigger the webhook, you’ll receive a JSON object containing:\n\n  * individualAnalyses: Array of { coin, symbol, currentPrice, priceChanges, marketMetrics, signal, riskRating, recommendation }\n\n  * portfolioSummary: Markdown report summarizing signals, risk distribution, and top opportunity\n\n  * marketSignals: Counts of each signal type\n\n  * riskDistribution: Counts of each risk rating\n\n  * timestamp: ISO string of analysis time\n\n\n\n\n* * *\n\n# ⚙️ Setup Instructions\n\n  * Import: In n8n Editor → click “Import from JSON” → paste this workflow JSON.\n\n  * Configure Schedule: Double-click the Schedule Trigger → set your desired interval (default: every hour).\n\n  * Webhook Path: Open the Webhook node → choose a unique path (e.g., /crypto‐analysis) and “POST”.\n\n  * Activate: Save and activate the workflow.\n\n  * Test:\n\n    * Open the webhook url to other tab or use cURL\n\n\n    \n    \n    curl -X POST https://&lt;your-n8n-host&gt;/webhook/&lt;path&gt;\n    \n\nYou’ll get back a JSON payload with both portfolioSummary and individualAnalyses.\n\n* * *\n\n# 📝 Tips\n\n  * Rate-Limit Handling: If CoinGecko returns 429, insert a Delay node (e.g., 500 ms) after the HTTP Request.\n  * Batch Size: Default is 1 coin at a time; you can bump it to parallelize.\n  * Customization: Tweak volatility weightings or add new metrics directly in the “Calculate Market Metrics” Function node.\n  * Extension: Swap CoinGecko for another API by updating the HTTP Request URL and field mappings.\n\n\n",
  "crawled_at": "2025-05-26T06:44:13.426802",
  "readme_zh": "此n8n模板可每小时自动从CoinGecko获取加密货币市场数据，计算自定义波动率和市场健康指标，根据风险评级将各币种价格走势分类为买入/卖出/持有/中性信号，并通过Webhook提供单个币种分析和投资组合概览。特别适合需要即时洞察却不愿编写后端代码的加密分析师、DeFi开发者或投资组合经理。\n\n* * *\n\n# 🔧 工作原理\n\n  * 定时触发器按小时（或自定间隔）启动\n  * HTTP请求从CoinGecko获取市值前十币种数据（含24小时/7天/30天价格变化率）\n  * 分批处理确保各币种顺序分析\n  * 函数节点计算：\n    * 加权波动率评分\n    * 市值-交易量比率\n    * 当前价与历史最高价比率\n    * 综合市场评分\n  * IF/Switch节点根据24小时价格走势分类（涨幅>5%/跌幅>5%/高波动/稳定）并追加：\n    * 交易信号（买入/卖出/持有/中性）\n    * 风险评级（高/中/低/未知）\n    * 投资建议与策略指引\n  * NoOp与Merge节点合并各分支数据流\n  * 函数节点生成：\n    * Markdown格式组合概览\n    * 各类信号计数\n    * 风险分布\n  * Webhook响应返回含个体分析与汇总报告的JSON数据\n\n* * *\n\n# 👤 适用人群\n\n### 本工作流最适合：\n\n  * 需要定时市场分析的加密研究员\n  * 开发自动化交易信号的DeFi/量化机器人开发者\n  * 追求零代码资产监控的投资组合经理\n  * 探索API集成与数据增强的自动化工程师\n\n* * *\n\n# 📑 数据结构\n\n### Webhook触发后将收到包含以下内容的JSON对象：\n\n  * individualAnalyses: 各币种分析数组（含代币名称/符号/当前价/价格变化/市场指标/信号/风险评级/建议）\n  * portfolioSummary: 含信号统计/风险分布/最佳机会的Markdown报告\n  * marketSignals: 各类信号数量统计\n  * riskDistribution: 各风险等级计数\n  * timestamp: 分析时间戳（ISO格式）\n\n* * *\n\n# ⚙️ 配置指南\n\n  * 导入：在n8n编辑器中点击\"从JSON导入\" → 粘贴工作流JSON\n  * 定时设置：双击定时触发器 → 调整间隔（默认每小时）\n  * Webhook路径：配置Webhook节点 → 设置唯一路径（如/crypto-analysis）并选择\"POST\"\n  * 激活：保存并启用工作流\n  * 测试：\n    * 浏览器访问Webhook地址或使用cURL命令\n    \n```bash\ncurl -X POST https://<你的n8n地址>/webhook/<路径>\n```\n响应将包含投资组合概览与个体分析数据\n\n* * *\n\n# 📝 优化建议\n\n  * 限流处理：若CoinGecko返回429错误，可在HTTP请求后添加延迟节点（如500毫秒）\n  * 批量处理：默认逐币分析，可调整批量值实现并行处理\n  * 自定义指标：直接在\"计算市场指标\"函数节点修改波动率权重或新增指标\n  * 扩展应用：更换HTTP请求URL即可对接其他数据API",
  "title_zh": "利用CoinGecko分析加密货币市场：波动率指标与投资信号",
  "publish_date_zh": "上次更新于6天前",
  "workflow_json_zh": "{\n  \"id\": \"Uw1r9yGqgPRykfUs\",\n  \"meta\": {\n    \"instanceId\": \"3fed23de697c60307f3b4f5caeafbeffabaf7bbd62c1b20ae70d5faf5a9806b4\"\n  },\n  \"name\": \"day9_getting_updated_in_crypto\",\n  \"tags\": [\n    {\n      \"id\": \"4zX1mtizlZxTekJP\",\n      \"name\": \"training-tasks-n8n\",\n      \"createdAt\": \"2025-04-29T10:41:14.716Z\",\n      \"updatedAt\": \"2025-04-29T10:41:14.716Z\"\n    },\n    {\n      \"id\": \"F1KjxL3SjfvVqZqo\",\n      \"name\": \"training-n8n\",\n      \"createdAt\": \"2025-04-29T10:40:13.332Z\",\n      \"updatedAt\": \"2025-04-29T10:40:13.332Z\"\n    }\n  ],\n  \"nodes\": [\n    {\n      \"id\": \"745e4849-8c61-4b29-9980-24de93821adb\",\n      \"name\": \"Fetch Crypto Data\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        220,\n        385\n      ],\n      \"parameters\": {\n        \"url\": \"https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&order=market_cap_desc&per_page=10&page=1&sparkline=false&price_change_percentage=24h,7d,30d\",\n        \"options\": {}\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"f4e6c40d-ab60-473b-9961-961eb1fa3505\",\n      \"name\": \"Calculate Market Metrics\",\n      \"type\": \"n8n-nodes-base.function\",\n      \"position\": [\n        660,\n        385\n      ],\n      \"parameters\": {\n        \"functionCode\": \"// Calculate a volatility score based on price changes\\nconst item = $input.item.json;\\n\\n// Extract price change percentages\\nconst priceChange24h = item.price_change_percentage_24h || 0;\\nconst priceChange7d = item.price_change_percentage_7d_in_currency || 0;\\nconst priceChange30d = item.price_change_percentage_30d_in_currency || 0;\\n\\n// Calculate absolute values to measure volatility regardless of direction\\nconst absChange24h = Math.abs(priceChange24h);\\nconst absChange7d = Math.abs(priceChange7d);\\nconst absChange30d = Math.abs(priceChange30d);\\n\\n// Calculate a weighted volatility score (more weight to recent changes)\\nconst volatilityScore = (absChange24h * 0.5) + (absChange7d * 0.3) + (absChange30d * 0.2);\\n\\n// Calculate market cap to volume ratio (higher means less liquid/more volatile)\\nconst marketCapToVolumeRatio = item.market_cap / (item.total_volume || 1);\\n\\n// Calculate price to ATH ratio (close to 1 means near all-time high)\\nconst priceToAthRatio = item.current_price / (item.ath || item.current_price);\\n\\n// Calculate a composite market score\\nconst marketScore = (\\n  (volatilityScore * 0.4) + \\n  (Math.min(marketCapToVolumeRatio, 10) * 0.3) + \\n  ((1 - priceToAthRatio) * 30) // Invert so coins further from ATH get higher scores\\n);\\n\\n// Add calculated metrics to the item\\nitem.volatilityScore = parseFloat(volatilityScore.toFixed(2));\\nitem.marketCapToVolumeRatio = parseFloat(marketCapToVolumeRatio.toFixed(2));\\nitem.priceToAthRatio = parseFloat(priceToAthRatio.toFixed(4));\\nitem.marketScore = parseFloat(marketScore.toFixed(2));\\n\\n// Add a timestamp for the analysis\\nitem.analyzedAt = new Date().toISOString();\\n\\nreturn {json: item};\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"5d760f94-ca2f-44cc-aef0-83eb2cf438ee\",\n      \"name\": \"IF 24h Price Up >5%\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        880,\n        60\n      ],\n      \"parameters\": {\n        \"conditions\": {\n          \"number\": [\n            {\n              \"value1\": \"={{ $json.price_change_percentage_24h }}\",\n              \"value2\": 5,\n              \"operation\": \"larger\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"19ca8650-b642-4910-ac7c-50b1ceb41ffc\",\n      \"name\": \"IF 24h Price Down >5%\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        1100,\n        260\n      ],\n      \"parameters\": {\n        \"conditions\": {\n          \"number\": [\n            {\n              \"value1\": \"={{ $json.price_change_percentage_24h }}\",\n              \"value2\": -5\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"c5d69bbb-df7e-4089-b0c8-50653cd936f0\",\n      \"name\": \"IF High Volatility\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        1320,\n        560\n      ],\n      \"parameters\": {\n        \"conditions\": {\n          \"number\": [\n            {\n              \"value1\": \"={{ $json.volatilityScore }}\",\n              \"value2\": 10,\n              \"operation\": \"larger\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"77902b9a-2cf8-4b6f-95e9-590b51278c59\",\n      \"name\": \"Set Uptrend Data\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1540,\n        60\n      ],\n      \"parameters\": {\n        \"values\": {\n          \"string\": [\n            {\n              \"name\": \"priceAction\",\n              \"value\": \"Strong upward momentum in the past 24 hours\"\n            },\n            {\n              \"name\": \"signal\",\n              \"value\": \"BUY\"\n            },\n            {\n              \"name\": \"recommendation\",\n              \"value\": \"Consider buying on continued strength above resistance levels. Set stop loss at recent support.\"\n            },\n            {\n              \"name\": \"investmentStrategy\",\n              \"value\": \"Momentum strategy with trailing stop loss. Consider dollar-cost averaging to manage volatility risk.\"\n            }\n          ]\n        },\n        \"options\": {\n          \"dotNotation\": true\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"4706270b-3bdc-4806-a302-830a88c9a982\",\n      \"name\": \"Set Downtrend Data\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1540,\n        260\n      ],\n      \"parameters\": {\n        \"values\": {\n          \"string\": [\n            {\n              \"name\": \"priceAction\",\n              \"value\": \"Rapid price decline in the past 24 hours\"\n            },\n            {\n              \"name\": \"signal\",\n              \"value\": \"SELL\"\n            },\n            {\n              \"name\": \"recommendation\",\n              \"value\": \"Consider reducing exposure or implementing hedging strategies. Watch for oversold conditions.\"\n            },\n            {\n              \"name\": \"investmentStrategy\",\n              \"value\": \"Capital preservation is priority. Consider re-evaluation after price stabilization.\"\n            }\n          ]\n        },\n        \"options\": {\n          \"dotNotation\": true\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"608729c4-23a5-4c5b-b9a0-d77f12166aa3\",\n      \"name\": \"Set Volatility Data\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1540,\n        460\n      ],\n      \"parameters\": {\n        \"values\": {\n          \"string\": [\n            {\n              \"name\": \"priceAction\",\n              \"value\": \"High volatility with significant price swings\"\n            },\n            {\n              \"name\": \"signal\",\n              \"value\": \"HOLD\"\n            },\n            {\n              \"name\": \"recommendation\",\n              \"value\": \"High volatility indicates market uncertainty. Consider waiting for clearer signals before making major positions.\"\n            },\n            {\n              \"name\": \"investmentStrategy\",\n              \"value\": \"Range-trading strategy may be effective. Set both upper and lower limit orders.\"\n            }\n          ]\n        },\n        \"options\": {\n          \"dotNotation\": true\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"f8134b51-4b41-4684-97a9-008e5f0260df\",\n      \"name\": \"Set Stable Data\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1540,\n        660\n      ],\n      \"parameters\": {\n        \"values\": {\n          \"string\": [\n            {\n              \"name\": \"priceAction\",\n              \"value\": \"Relatively stable price action with minimal volatility\"\n            },\n            {\n              \"name\": \"signal\",\n              \"value\": \"NEUTRAL\"\n            },\n            {\n              \"name\": \"recommendation\",\n              \"value\": \"Market is consolidating. Watch for breakout signals in either direction.\"\n            },\n            {\n              \"name\": \"investmentStrategy\",\n              \"value\": \"Consider accumulating small positions or implementing a neutral options strategy.\"\n            }\n          ]\n        },\n        \"options\": {\n          \"dotNotation\": true\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"5f43178c-7bb5-405d-a988-b3b0ae0a0405\",\n      \"name\": \"Merge Results\",\n      \"type\": \"n8n-nodes-base.noOp\",\n      \"position\": [\n        1760,\n        360\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"e422a9e1-9016-4db9-912b-58be44604eb2\",\n      \"name\": \"Set High Risk Rating\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        2200,\n        -40\n      ],\n      \"parameters\": {\n        \"values\": {\n          \"string\": [\n            {\n              \"name\": \"riskRating\",\n              \"value\": \"High Risk\"\n            },\n            {\n              \"name\": \"investmentStrategy\",\n              \"value\": \"={{ $json.investmentStrategy }} Due to high risk profile, use strict position sizing (max 2-5% of portfolio).\"\n            }\n          ]\n        },\n        \"options\": {\n          \"dotNotation\": true\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"383a55c7-f42f-4a32-b6ba-742049406f67\",\n      \"name\": \"Set Medium Risk Rating\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        2200,\n        160\n      ],\n      \"parameters\": {\n        \"values\": {\n          \"string\": [\n            {\n              \"name\": \"riskRating\",\n              \"value\": \"Medium Risk\"\n            },\n            {\n              \"name\": \"investmentStrategy\",\n              \"value\": \"={{ $json.investmentStrategy }} Moderate risk profile suggests balanced position sizing (5-10% of portfolio).\"\n            }\n          ]\n        },\n        \"options\": {\n          \"dotNotation\": true\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"2f50e6cd-dd62-4fb2-8ee2-28096c758e23\",\n      \"name\": \"Set Low Risk Rating\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        2200,\n        460\n      ],\n      \"parameters\": {\n        \"values\": {\n          \"string\": [\n            {\n              \"name\": \"riskRating\",\n              \"value\": \"Low Risk\"\n            },\n            {\n              \"name\": \"investmentStrategy\",\n              \"value\": \"={{ $json.investmentStrategy }} Lower risk profile allows for larger position sizing (10-15% of portfolio).\"\n            }\n          ]\n        },\n        \"options\": {\n          \"dotNotation\": true\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"5a820de9-11f8-4aa7-8811-afb6153a7b54\",\n      \"name\": \"Set Default Risk Rating\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        2200,\n        660\n      ],\n      \"parameters\": {\n        \"values\": {\n          \"string\": [\n            {\n              \"name\": \"riskRating\",\n              \"value\": \"Unknown Risk\"\n            },\n            {\n              \"name\": \"investmentStrategy\",\n              \"value\": \"={{ $json.investmentStrategy }} Risk profile is unclear - use conservative position sizing until more data is available.\"\n            }\n          ]\n        },\n        \"options\": {\n          \"dotNotation\": true\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"9b39eb90-f0c8-44df-9721-ef1d60a8a0fc\",\n      \"name\": \"Final Merge\",\n      \"type\": \"n8n-nodes-base.noOp\",\n      \"position\": [\n        2420,\n        360\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"f84bd02a-92d1-49c7-9ba3-36e860a31636\",\n      \"name\": \"Format Final Analysis\",\n      \"type\": \"n8n-nodes-base.function\",\n      \"position\": [\n        2640,\n        635\n      ],\n      \"parameters\": {\n        \"functionCode\": \"// Create a formatted summary for each coin\\nconst item = $input.item.json;\\n\\n// Format dollar amounts nicely\\nconst formatCurrency = (value) => {\\n  return new Intl.NumberFormat('en-US', {\\n    style: 'currency',\\n    currency: 'USD',\\n    minimumFractionDigits: 2,\\n    maximumFractionDigits: 2\\n  }).format(value);\\n};\\n\\n// Format percentages nicely\\nconst formatPercent = (value) => {\\n  return `${value > 0 ? '+' : ''}${value.toFixed(2)}%`;\\n};\\n\\n// Create a detailed analysis report\\nconst analysisReport = {\\n  coin: item.name,\\n  symbol: item.symbol.toUpperCase(),\\n  currentPrice: formatCurrency(item.current_price),\\n  marketCap: formatCurrency(item.market_cap),\\n  volume24h: formatCurrency(item.total_volume),\\n  priceChanges: {\\n    \\\"24h\\\": formatPercent(item.price_change_percentage_24h),\\n    \\\"7d\\\": formatPercent(item.price_change_percentage_7d_in_currency),\\n    \\\"30d\\\": formatPercent(item.price_change_percentage_30d_in_currency)\\n  },\\n  marketMetrics: {\\n    volatilityScore: item.volatilityScore,\\n    marketCapToVolumeRatio: item.marketCapToVolumeRatio,\\n    priceToAthRatio: item.priceToAthRatio,\\n    marketScore: item.marketScore\\n  },\\n  analysis: {\\n    priceAction: item.priceAction,\\n    signal: item.signal,\\n    riskRating: item.riskRating,\\n    recommendation: item.recommendation,\\n    investmentStrategy: item.investmentStrategy\\n  },\\n  timestamp: item.analyzedAt\\n};\\n\\n// Generate a natural language summary\\nconst summary = `\\n## ${item.name} (${item.symbol.toUpperCase()}) Analysis\\n\\nCurrent Price: ${formatCurrency(item.current_price)} (${formatPercent(item.price_change_percentage_24h)} 24h)\\\\n\\\\n\\n\\nMarket Signal: **${item.signal}** - *${item.priceAction}*\\nRisk Rating: **${item.riskRating}**\\\\n\\\\n\\n\\n**Recommendation:**\\n${item.recommendation}\\n\\n**Investment Strategy:**\\n${item.investmentStrategy}\\n\\n---\\n*Analysis based on volatility score of ${item.volatilityScore} and market score of ${item.marketScore}*\\n`;\\n\\n// Return both structured data and a human-readable summary\\nreturn {\\n  json: {\\n    ...item,\\n    analysisReport,\\n    summary\\n  }\\n};\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"911280f8-82cb-42ee-bd8a-6de15c58f188\",\n      \"name\": \"Collect All Analyses\",\n      \"type\": \"n8n-nodes-base.noOp\",\n      \"position\": [\n        660,\n        -140\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"a4de8078-7f49-4b22-a11a-a2efabfa16b1\",\n      \"name\": \"Generate Portfolio Summary\",\n      \"type\": \"n8n-nodes-base.function\",\n      \"position\": [\n        880,\n        -140\n      ],\n      \"parameters\": {\n        \"functionCode\": \"// Create a portfolio summary based on all coin analyses\\nconst allCoins = $input.all();\\n\\n// Extract all analyzed coins\\nconst analyzedCoins = allCoins.map(coin => coin.json);\\n\\n// Count signals by type\\nconst signalCounts = {\\n  BUY: 0,\\n  SELL: 0,\\n  HOLD: 0,\\n  NEUTRAL: 0\\n};\\n\\n// Count risk ratings\\nconst riskCounts = {\\n  \\\"High Risk\\\": 0,\\n  \\\"Medium Risk\\\": 0,\\n  \\\"Low Risk\\\": 0,\\n  \\\"Unknown Risk\\\": 0\\n};\\n\\n// Calculate portfolio metrics\\nanalyzedCoins.forEach(coin => {\\n  // Count signals\\n  if (coin.signal) {\\n    signalCounts[coin.signal] = (signalCounts[coin.signal] || 0) + 1;\\n  }\\n\\n  // Count risk ratings\\n  if (coin.riskRating) {\\n    riskCounts[coin.riskRating] = (riskCounts[coin.riskRating] || 0) + 1;\\n  }\\n});\\n\\n// Sort coins by market score (highest first)\\nconst sortedCoins = [...analyzedCoins].sort((a, b) => b.marketScore - a.marketScore);\\n\\n// Get top recommendation\\nconst topOpportunity = sortedCoins[0];\\n\\n// Generate portfolio summary markdown\\nconst portfolioSummary = `# Cryptocurrency Market Analysis\\n\\n## Market Overview\\n**Analyzed Coins:** ${analyzedCoins.length}  \\n**Buy Signals:** ${signalCounts.BUY}  \\n**Sell Signals:** ${signalCounts.SELL}  \\n**Hold Signals:** ${signalCounts.HOLD}  \\n**Neutral Signals:** ${signalCounts.NEUTRAL}  \\n\\n## Risk Distribution\\n**High Risk Assets:** ${riskCounts[\\\"High Risk\\\"]}  \\n**Medium Risk Assets:** ${riskCounts[\\\"Medium Risk\\\"]}  \\n**Low Risk Assets:** ${riskCounts[\\\"Low Risk\\\"]}  \\n\\n## Top Opportunity  \\n${topOpportunity ? `**${topOpportunity.name} (${topOpportunity.symbol.toUpperCase()})**  \\n${topOpportunity.summary}` : \\\"No opportunities found\\\"}\\n\\n## Detailed Coin Analyses  \\n${sortedCoins.map(coin => `**${coin.name} (${coin.symbol})**  \\n${coin.summary}`).join('\\\\n\\\\n')}\\n\\n*Analysis generated on ${new Date().toLocaleString()}*`;\\n\\nreturn [\\n  {\\n    json: {\\n      portfolioSummary,\\n      individualAnalyses: analyzedCoins.map(coin => coin.analysisReport),\\n      marketSignals: signalCounts,\\n      riskDistribution: riskCounts,\\n      timestamp: new Date().toISOString()\\n    }\\n  }\\n];\\n\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"3277b96e-ab2c-4561-a29c-958998f45686\",\n      \"name\": \"Loop Over Items\",\n      \"type\": \"n8n-nodes-base.splitInBatches\",\n      \"position\": [\n        440,\n        385\n      ],\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"8256a60a-ddb8-4d72-b443-8fba819815bb\",\n      \"name\": \"Switch by Market Score\",\n      \"type\": \"n8n-nodes-base.switch\",\n      \"position\": [\n        1980,\n        339\n      ],\n      \"parameters\": {\n        \"rules\": {\n          \"rules\": [\n            {\n              \"value2\": 20,\n              \"operation\": \"larger\"\n            },\n            {\n              \"value2\": 10,\n              \"operation\": \"larger\"\n            },\n            {\n              \"operation\": \"larger\"\n            }\n          ]\n        },\n        \"value1\": \"={{ $json.marketScore }}\",\n        \"fallbackOutput\": 3\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"b8cb4f7d-3818-48df-89ea-9db22797375a\",\n      \"name\": \"Split Out\",\n      \"type\": \"n8n-nodes-base.splitOut\",\n      \"position\": [\n        1100,\n        -140\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"fieldToSplitOut\": \"individualAnalyses\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"936e9ada-4b6b-4cab-90e1-0bea30eaaa0c\",\n      \"name\": \"Respond to Webhook\",\n      \"type\": \"n8n-nodes-base.respondToWebhook\",\n      \"position\": [\n        1320,\n        -140\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"respondWith\": \"allIncomingItems\"\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"7791cebf-4733-4cf6-8341-96771733b507\",\n      \"name\": \"Webhook\",\n      \"type\": \"n8n-nodes-base.webhook\",\n      \"position\": [\n        0,\n        380\n      ],\n      \"webhookId\": \"31941fd9-9fd5-4fab-a1b9-9c347e26f5c9\",\n      \"parameters\": {\n        \"path\": \"31941fd9-9fd5-4fab-a1b9-9c347e26f5c9\",\n        \"options\": {},\n        \"responseMode\": \"responseNode\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"d25b2427-9fc7-4042-92f2-673de5019206\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        2120,\n        -140\n      ],\n      \"parameters\": {\n        \"width\": 260,\n        \"height\": 960,\n        \"content\": \"## 分类并设定硬币的评级\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"ac3a6503-5ce7-406d-9efb-122928239337\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        680,\n        40\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"c4e4e17d-bf13-44a2-9a9e-1d22104f1062\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        140,\n        -20\n      ],\n      \"parameters\": {\n        \"content\": \"## 该工作流程旨在\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"active\": false,\n  \"pinData\": {},\n  \"settings\": {\n    \"executionOrder\": \"v1\"\n  },\n  \"versionId\": \"be12f8a1-3c44-4a1c-8f74-d1df269de92c\",\n  \"connections\": {\n    \"Webhook\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Fetch Crypto Data\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Split Out\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Respond to Webhook\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Final Merge\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Format Final Analysis\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Merge Results\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Switch by Market Score\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Loop Over Items\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Collect All Analyses\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Calculate Market Metrics\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Set Stable Data\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge Results\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Set Uptrend Data\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge Results\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Fetch Crypto Data\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Loop Over Items\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"IF High Volatility\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Set Volatility Data\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Set Stable Data\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Set Downtrend Data\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge Results\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"IF 24h Price Up >5%\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Set Uptrend Data\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"IF 24h Price Down >5%\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Set Low Risk Rating\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Final Merge\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Set Volatility Data\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge Results\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Collect All Analyses\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Generate Portfolio Summary\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Set High Risk Rating\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Final Merge\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Format Final Analysis\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Loop Over Items\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"IF 24h Price Down >5%\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Set Downtrend Data\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"IF High Volatility\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Set Medium Risk Rating\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Final Merge\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Switch by Market Score\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Set High Risk Rating\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Set Medium Risk Rating\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Set Low Risk Rating\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Set Default Risk Rating\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Set Default Risk Rating\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Final Merge\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Calculate Market Metrics\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"IF 24h Price Up >5%\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"IF 24h Price Down >5%\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"IF High Volatility\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Generate Portfolio Summary\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Split Out\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}