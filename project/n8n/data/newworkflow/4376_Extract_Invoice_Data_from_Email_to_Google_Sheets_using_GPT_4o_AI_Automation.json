{
  "url": "https://n8n.io/workflows/4376-extract-invoice-data-from-email-to-google-sheets-using-gpt-4o-ai-automation/",
  "title": "Extract Invoice Data from Email to Google Sheets using GPT-4o AI Automation",
  "author": "Yaron Been",
  "publish_date": "Last update a day ago",
  "publish_date_absolute": "",
  "categories": [
    {
      "name": "Finance"
    },
    {
      "name": "AI"
    }
  ],
  "workflow_json": "{\"meta\":{\"instanceId\":\"5aaf4236c70e34e423fbdb2c7b754d19253a933bb1476d548f75848a01e473cf\",\"templateCredsSetupCompleted\":true},\"nodes\":[{\"id\":\"70ca3a90-55c8-4e46-9278-6a8fd3d107cd\",\"name\":\"Gmail Trigger\",\"type\":\"n8n-nodes-base.gmailTrigger\",\"position\":[-1820,220],\"parameters\":{\"simple\":false,\"filters\":{\"labelIds\":[\"Label_1393502052621954450\"]},\"options\":{\"downloadAttachments\":true},\"pollTimes\":{\"item\":[{\"mode\":\"everyMinute\"}]}},\"typeVersion\":1.2},{\"id\":\"f7dcff0f-7e98-4042-a33e-2fc32d876908\",\"name\":\"Create blank spreadsheet\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[-780,220],\"parameters\":{\"title\":\"=invoice_{{ $now }}\",\"options\":{},\"resource\":\"spreadsheet\",\"sheetsUi\":{\"sheetValues\":[{\"title\":\"=invoice_details\"}]}},\"executeOnce\":false,\"typeVersion\":4.5},{\"id\":\"9769ad04-a41c-4d55-806a-042b7d00e131\",\"name\":\"Move spreadsheet in invoice folder\",\"type\":\"n8n-nodes-base.googleDrive\",\"position\":[-560,220],\"parameters\":{\"fileId\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"={{ $json.spreadsheetId }}\"},\"driveId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"My Drive\",\"cachedResultUrl\":\"https://drive.google.com/drive/my-drive\",\"cachedResultName\":\"My Drive\"},\"folderId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"1JIdajTJvK6gj4bRjniBJvHEJbQ1pn3AM\",\"cachedResultUrl\":\"https://drive.google.com/drive/folders/1JIdajTJvK6gj4bRjniBJvHEJbQ1pn3AM\",\"cachedResultName\":\"invoices\"},\"operation\":\"move\"},\"typeVersion\":3},{\"id\":\"f9dbfe55-70b0-4abc-9745-9f4a65d5d1c2\",\"name\":\"OpenAI Chat Model\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\"position\":[-1180,480],\"parameters\":{\"model\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"gpt-4o-mini\"},\"options\":{\"responseFormat\":\"json_object\"}},\"credentials\":{\"openAiApi\":{\"id\":\"7dME1fmMlkFyzFjq\",\"name\":\"OpenAi account 2\"}},\"typeVersion\":1.2},{\"id\":\"00c59142-6079-4e9c-9374-ad487e48f072\",\"name\":\"Attachment Verification\",\"type\":\"n8n-nodes-base.filter\",\"position\":[-1600,220],\"parameters\":{\"options\":{\"ignoreCase\":false},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"efd974d9-aa20-461a-86ae-6e0a16d1527d\",\"operator\":{\"type\":\"object\",\"operation\":\"exists\",\"singleValue\":true},\"leftValue\":\"={{ $('Gmail Trigger').item.binary }}\",\"rightValue\":\"\"}]}},\"typeVersion\":2.2},{\"id\":\"8a29ac14-be2b-468a-97fa-540d28e80006\",\"name\":\"Extract Invoice data\",\"type\":\"n8n-nodes-base.extractFromFile\",\"position\":[-1380,220],\"parameters\":{\"options\":{},\"operation\":\"pdf\",\"binaryPropertyName\":\"={{ $('Attachment Verification').item.binary.keys() }}\"},\"typeVersion\":1},{\"id\":\"ae08cdc8-fcf9-4891-be86-b2dcf6f35278\",\"name\":\"Preparing Final data\",\"type\":\"n8n-nodes-base.code\",\"position\":[-340,220],\"parameters\":{\"mode\":\"runOnceForEachItem\",\"jsCode\":\"// Loop over input items and add a new field called 'myNewField' to the JSON of $input$json.output.first().json.outputeach one\\n\\nlet invoice_details = $('Invoice AI Agent').item.json.output\\n\\nreturn JSON.parse(invoice_details)\"},\"typeVersion\":2},{\"id\":\"7615a5b0-8761-43e2-82b0-32ac5c772f44\",\"name\":\"Final Spreadsheet with Invoice data\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[-140,220],\"parameters\":{\"columns\":{\"value\":{},\"schema\":[{\"id\":\"billed_to\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"billed_to\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"invoice_number\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"invoice_number\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"date_of_issue\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"date_of_issue\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"due_date\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"due_date\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"item_0_description\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"item_0_description\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"item_0_quantity\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"item_0_quantity\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"item_0_rate\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"item_0_rate\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"item_0_amount\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"item_0_amount\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"tax_0_cgst_rate\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"tax_0_cgst_rate\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"tax_0_cgst_amount\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"tax_0_cgst_amount\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"tax_0_sgst_rate\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"tax_0_sgst_rate\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"tax_0_sgst_amount\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"tax_0_sgst_amount\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"item_0_total_amount\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"item_0_total_amount\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"subtotal\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"subtotal\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"total\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"total\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"terms\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"terms\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"conditions_instructions\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"conditions_instructions\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"company_name\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"company_name\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"company_mobile\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"company_mobile\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"company_email\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"company_email\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"company_website\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"company_website\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"payment_transaction_ids\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"payment_transaction_ids\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"mode_of_payment\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"mode_of_payment\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"billing_address\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"billing_address\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"shipping_address\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"shipping_address\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"place_of_supply\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"place_of_supply\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"place_of_delivery\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"place_of_delivery\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"gst_registration_no\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"gst_registration_no\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"pan_no\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"pan_no\",\"defaultMatch\":false,\"canBeUsedToMatch\":true}],\"mappingMode\":\"autoMapInputData\",\"matchingColumns\":[],\"attemptToConvertTypes\":false,\"convertFieldsToString\":false},\"options\":{},\"operation\":\"append\",\"sheetName\":{\"__rl\":true,\"mode\":\"name\",\"value\":\"invoice_details\"},\"documentId\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"={{ $('Create blank spreadsheet').item.json.spreadsheetId }}\"}},\"typeVersion\":4.5},{\"id\":\"e68aa386-7150-4070-a5d7-1dcb963b620d\",\"name\":\"Invoice AI Agent\",\"type\":\"@n8n/n8n-nodes-langchain.agent\",\"position\":[-1160,220],\"parameters\":{\"text\":\"={{ $json.text }}\",\"options\":{\"systemMessage\":\"you are an financial advisor , who reads the array of data to identify certain elements of an Invoice, from the input data and provide a json response. use only following specified keys \\nfor example:\\n{\\n\\\"billed_to\\\": \\\"John\\\",\\n\\\"invoice_number\\\": \\\"569871234\\\",\\n\\\"date_of_issue\\\": \\\"2025-05-21\\\",\\n\\\"due_date\\\": \\\"2025-05-25\\\",\\n\\\"item_0_description\\\": \\\"Computer CPU\\\",\\n\\\"item_0_quantity\\\": 6,\\n\\\"item_0_rate\\\": 15,\\n\\\"item_0_amount\\\": 90,\\n\\\"item_1_description\\\": \\\"Chair Wooden\\\",\\n\\\"item_1_quantity\\\": 8,\\n\\\"item_1_rate\\\": 10,\\n\\\"item_1_amount\\\": 80,\\n\\\"subtotal\\\": 170.00,\\n\\\"discount\\\": 20.00,\\n\\\"total\\\": 150.00,\\n\\\"terms\\\": \\\"Sold items not be acceptable\\\",\\n\\\"conditions_instructions\\\": \\\"xyaABC\\\",\\n\\\"company_name\\\": \\\"Digital Electronics\\\",\\n\\\"company_mobile\\\": \\\"987654321\\\",\\n\\\"company_email\\\": \\\"ayz@gmail.com\\\",\\n\\\"company_website\\\": \\\"www.abc.com\\\"\\n}\"},\"promptType\":\"define\",\"hasOutputParser\":true},\"typeVersion\":1.9,\"alwaysOutputData\":false},{\"id\":\"335a80c5-ad86-4379-b1a6-9a2ef7285f3c\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-2860,100],\"parameters\":{\"width\":880,\"height\":1520,\"content\":\"AI Invoice Processor Agent: Email to Structured Data\\nAutomatically extract, analyze, and organize invoice data from Gmail attachments into structured Google Sheets. Perfect for:\\n✅ Accountants & bookkeepers — eliminate manual data entry from invoices\\n✅ Small businesses — streamline invoice processing and tracking\\n✅ Finance teams — automate accounts payable workflows\\n\\n⚙️ What's Used\\nn8n Nodes:\\nGmail Trigger → File Extraction → AI Agent → OpenAI Chat Model → Google Sheets → Google Drive\\nExternal Tools:\\n\\nGmail API – Monitor specific labeled emails with attachments\\nPDF Extraction – Convert invoice PDFs to readable text\\nOpenAI GPT-4 – Intelligent invoice data extraction and structuring\\nGoogle Sheets – Create organized spreadsheets with invoice details\\nGoogle Drive – Automatically organize files in invoice folders\\n\\n\\n🔑 Setup – Credentials Needed\\n\\nGmail OAuth2 → Access emails and download attachments\\nOpenAI API Key → For AI-powered invoice data extraction\\nGoogle Sheets OAuth2 → Create and populate spreadsheets\\nGoogle Drive OAuth2 → Organize files in designated folders\\n\\n\\n📧 Gmail Setup Required\\nCreate a Gmail label (e.g., \\\"Invoice Processing\\\") and apply it to emails containing invoice attachments. The workflow will monitor this label for new emails every minute.\\n\\n🚀 Workflow Steps\\n\\nEmail Monitoring\\nContinuously watches Gmail for new emails with specific labels and attachments\\nAttachment Verification\\nFilters emails to ensure they contain PDF attachments before processing\\nData Extraction\\nConverts PDF invoices to text and extracts readable content\\nAI-Powered Analysis\\nGPT processes invoice text and extracts structured data including:\\n\\nCompany details and contact information\\nInvoice numbers, dates, and due dates\\nLine items with quantities, rates, and amounts\\nTax calculations (CGST, SGST, VAT)\\nPayment terms and billing addresses\\n\\n\\nSpreadsheet Creation\\nCreates timestamped Google Sheets with organized invoice data\\nFile Organization\\nMoves processed spreadsheets to designated Drive folders for easy access\\n\\n\\n📊 Extracted Data Fields\\nThe AI identifies and organizes 25+ invoice elements:\\n\\nHeader Info: Billed to, invoice number, dates\\nLine Items: Description, quantity, rate, amount\\nTax Details: CGST/SGST rates and amounts\\nCompany Info: Name, contact details, GST numbers\\nPayment Info: Transaction IDs, payment methods\\nAddresses: Billing, shipping, delivery locations\\n\\n\\n💡 Pro Tips\\n\\nUse clear Gmail labels for different invoice types (vendors, clients, etc.)\\nEnsure invoice PDFs are text-based (not scanned images) for best results\\nCreate separate Drive folders for different accounting periods\\nReview AI extraction accuracy and refine prompts as needed\\nSet up email filters to automatically apply labels to vendor emails\\n\\n\\n🛠️ Customize It\\n\\nAdd invoice approval workflows with email notifications\\nConnect to accounting software (QuickBooks, Xero, SAP)\\nInclude OCR processing for scanned invoice images\\nAdd duplicate invoice detection and alerts\\nCreate automated payment reminders based on due dates\"},\"typeVersion\":1}],\"pinData\":{},\"connections\":{\"Gmail Trigger\":{\"main\":[[{\"node\":\"Attachment Verification\",\"type\":\"main\",\"index\":0}]]},\"Invoice AI Agent\":{\"main\":[[{\"node\":\"Create blank spreadsheet\",\"type\":\"main\",\"index\":0}]]},\"OpenAI Chat Model\":{\"ai_languageModel\":[[{\"node\":\"Invoice AI Agent\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"Extract Invoice data\":{\"main\":[[{\"node\":\"Invoice AI Agent\",\"type\":\"main\",\"index\":0}]]},\"Preparing Final data\":{\"main\":[[{\"node\":\"Final Spreadsheet with Invoice data\",\"type\":\"main\",\"index\":0}]]},\"Attachment Verification\":{\"main\":[[{\"node\":\"Extract Invoice data\",\"type\":\"main\",\"index\":0}]]},\"Create blank spreadsheet\":{\"main\":[[{\"node\":\"Move spreadsheet in invoice folder\",\"type\":\"main\",\"index\":0}]]},\"Move spreadsheet in invoice folder\":{\"main\":[[{\"node\":\"Preparing Final data\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "Transform your invoice processing from manual data entry into an intelligent automation system. This powerful n8n workflow monitors Gmail for invoice attachments, extracts data using AI-powered analysis, and creates organized Google Sheets with all relevant financial information automatically structured and ready for your accounting workflows.\n\n## 🔄 How It Works\n\nThis sophisticated 8-step automation eliminates manual invoice processing:\n\n**Step 1: Intelligent Email Monitoring**  \nThe workflow continuously monitors your Gmail account for emails with specific labels, checking every minute for new invoice attachments that need processing.\n\n**Step 2: Attachment Verification**  \nSmart filtering ensures only emails with PDF attachments are processed, preventing unnecessary workflow triggers from text-only emails.\n\n**Step 3: Advanced PDF Extraction**  \nThe system automatically downloads and converts PDF invoices into readable text, handling various invoice formats and layouts with high accuracy.\n\n**Step 4: AI-Powered Data Analysis**  \nGPT-4 processes the extracted text using specialized prompts designed for financial document analysis, identifying and extracting:\n\n  * Company information and contact details\n  * Invoice numbers, dates, and payment terms\n  * Detailed line items with quantities and pricing\n  * Tax calculations including CGST, SGST, and VAT\n  * Billing and shipping addresses\n  * Payment methods and transaction references\n\n\n\n**Step 5: Structured Data Formatting**  \nThe AI output is automatically formatted into clean, consistent JSON structure with 25+ standardized fields for comprehensive invoice tracking.\n\n**Step 6: Dynamic Spreadsheet Creation**  \nEach processed invoice generates a new Google Sheets document with timestamp naming and organized data layout, ready for accounting review.\n\n**Step 7: Automated File Organization**  \nProcessed spreadsheets are automatically moved to designated Google Drive folders, maintaining organized file structure for easy retrieval and audit trails.\n\n**Step 8: Data Population**  \nAll extracted invoice data is populated into the spreadsheet with proper formatting, formulas, and structure for immediate use in accounting workflows.\n\n## ⚙️ Setup Steps\n\n### Prerequisites\n\n  * Gmail account with invoice-receiving capability\n  * Google Workspace access for Sheets and Drive\n  * OpenAI API account for data extraction\n  * n8n instance (cloud or self-hosted)\n  * PDF invoices (text-based, not scanned images)\n\n\n\n### Gmail Configuration Requirements\n\n**Label Setup:**  \nCreate specific Gmail labels for invoice processing:\n    \n    \n    📧 Labels to Create:\n    - \"Invoice-Processing\" (main processing label)\n    - \"Invoice-Vendors\" (supplier invoices)\n    - \"Invoice-Clients\" (customer invoices)  \n    - \"Invoice-Processed\" (completed items)\n    \n\n**Email Filter Configuration:**  \nSet up automatic labeling rules:\n\n  * Emails from known vendors → Auto-apply \"Invoice-Processing\"\n  * Emails with \"Invoice\" in subject → Auto-apply \"Invoice-Processing\"\n  * Attachments with PDF extension → Auto-apply \"Invoice-Processing\"\n\n\n\n### Configuration Steps\n\n**1\\. Credential Setup**\n\n  * **Gmail OAuth2** : Full email access including attachments\n  * **OpenAI API Key** : GPT-4 access for intelligent data extraction\n  * **Google Sheets OAuth2** : Spreadsheet creation and editing permissions\n  * **Google Drive OAuth2** : File organization and folder management\n\n\n\n**2\\. Google Drive Folder Structure**  \nCreate organized folder hierarchy:\n    \n    \n    📁 Invoice Management/\n    ├── 📁 Incoming Invoices/\n    ├── 📁 Processed Invoices/\n    │   ├── 📁 2024/\n    │   │   ├── 📁 Q1/\n    │   │   ├── 📁 Q2/\n    │   │   └── 📁 Q3/\n    ├── 📁 Vendor Invoices/\n    └── 📁 Client Invoices/\n    \n\n**3\\. AI Extraction Customization**  \nThe default AI prompt extracts standard invoice fields but can be customized for:\n\n  * **Regional Tax Systems** : GST (India), VAT (EU), Sales Tax (US)\n  * **Industry-Specific Fields** : Purchase orders, project codes, cost centers\n  * **Company Standards** : Custom fields, approval workflows, coding requirements\n  * **Multi-Currency** : Exchange rates, currency conversion, international invoices\n\n\n\n**4\\. Data Validation Rules**  \nImplement quality control measures:\n\n  * **Required Field Validation** : Ensure critical data is always extracted\n  * **Format Standardization** : Consistent date formats, number formatting\n  * **Duplicate Detection** : Identify potentially duplicate invoices\n  * **Accuracy Scoring** : Confidence levels for extracted data\n\n\n\n**5\\. Workflow Activation**\n\n  * Import the workflow JSON into your n8n instance\n  * Configure all credential connections and test each step\n  * Process test invoices to verify accuracy\n  * Activate Gmail trigger for continuous monitoring\n\n\n\n## 🚀 Use Cases\n\n### **Accounting Firms & Bookkeepers**\n\n  * **Client Service Automation** : Process invoices for multiple clients efficiently\n  * **Data Entry Elimination** : Convert hours of manual work into automated processing\n  * **Accuracy Improvement** : Reduce human errors in financial data transcription\n  * **Scalable Operations** : Handle increased client volume without proportional staff increase\n\n\n\n### **Small & Medium Businesses**\n\n  * **Accounts Payable Automation** : Streamline vendor invoice processing\n  * **Cash Flow Management** : Quick access to payment due dates and amounts\n  * **Expense Tracking** : Organized categorization of business expenses\n  * **Audit Preparation** : Maintain organized, searchable invoice records\n\n\n\n### **Corporate Finance Teams**\n\n  * **Procurement Processing** : Handle purchase orders and vendor invoices at scale\n  * **Multi-Location Operations** : Centralize invoice processing across offices\n  * **Compliance Management** : Ensure consistent data capture for regulatory requirements\n  * **Integration Readiness** : Prepare data for ERP and accounting system import\n\n\n\n### **Freelancers & Consultants**\n\n  * **Client Invoice Tracking** : Organize incoming payments and project billing\n  * **Expense Management** : Categorize business expenses for tax preparation\n  * **Cash Flow Monitoring** : Track outstanding invoices and payment schedules\n  * **Professional Organization** : Maintain clean financial records for business growth\n\n\n\n### **E-commerce & Retail**\n\n  * **Supplier Invoice Processing** : Manage inventory purchasing and cost tracking\n  * **Multi-Vendor Operations** : Handle invoices from numerous suppliers efficiently\n  * **Cost Analysis** : Track product costs and supplier performance\n  * **Inventory Reconciliation** : Match invoice data with purchase orders and receipts\n\n\n\n## 🔧 Advanced Customization Options\n\n### **Multi-Format Invoice Handling**\n\nExtend processing capabilities:\n    \n    \n    - PDF Text-Based: Standard invoice PDFs with selectable text\n    - Scanned Documents: Add OCR processing for image-based invoices\n    - Email Body Invoices: Extract data from invoice details in email content  \n    - Excel Attachments: Process invoices sent as spreadsheet files\n    - Multi-Page Documents: Handle complex invoices with multiple pages\n    \n\n### **Intelligent Data Validation**\n\nImplement quality assurance features:\n\n  * **Cross-Reference Validation** : Compare extracted data against purchase orders\n  * **Vendor Database Matching** : Verify company details against known vendor lists\n  * **Tax Calculation Verification** : Validate tax amounts and rates for accuracy\n  * **Currency Conversion** : Handle multi-currency invoices with real-time exchange rates\n\n\n\n### **Workflow Integration Extensions**\n\nConnect to existing business systems:\n\n  * **ERP Integration** : Direct data export to SAP, Oracle, or Microsoft Dynamics\n  * **Accounting Software** : Push data to QuickBooks, Xero, or FreshBooks\n  * **Approval Workflows** : Add review and approval steps before final processing\n  * **Payment Processing** : Connect to banking systems for automated payment scheduling\n\n\n\n### **Advanced Analytics & Reporting**\n\nGenerate business insights:\n\n  * **Vendor Performance Analysis** : Track pricing trends and payment terms\n  * **Expense Category Reporting** : Automated expense categorization and analysis\n  * **Cash Flow Forecasting** : Predict payment obligations based on due dates\n  * **Audit Trail Management** : Maintain comprehensive processing logs for compliance\n\n\n\n## 📊 Extracted Data Structure\n\n### **Standard Invoice Fields (25+ Data Points)**\n\nThe AI extraction captures comprehensive invoice information:\n\n**Header Information:**\n\n  * Billed To (Customer/Company Name)\n  * Invoice Number (Unique Identifier)\n  * Date of Issue (Invoice Creation Date)\n  * Due Date (Payment Deadline)\n\n\n\n**Line Item Details:**\n\n  * Item Description (Product/Service Details)\n  * Quantity (Number of Items/Hours)\n  * Rate (Unit Price)\n  * Amount (Line Total)\n\n\n\n**Tax and Financial Calculations:**\n\n  * CGST/SGST Rates and Amounts (Indian GST System)\n  * VAT Calculations (European Tax System)\n  * Subtotal (Pre-tax Amount)\n  * Total Amount (Final Invoice Value)\n\n\n\n**Company and Contact Information:**\n\n  * Vendor Company Name\n  * Contact Phone/Mobile\n  * Email Address\n  * Website URL\n  * GST Registration Number\n  * PAN Number (Indian Tax ID)\n\n\n\n**Address Information:**\n\n  * Billing Address\n  * Shipping Address\n  * Place of Supply\n  * Place of Delivery\n\n\n\n**Payment Details:**\n\n  * Transaction IDs\n  * Payment Mode (Check, Bank Transfer, Card)\n  * Terms and Conditions\n  * Special Instructions\n\n\n\n### **Sample Extracted Data:**\n    \n    \n    {\n      \"billed_to\": \"Tech Solutions Inc.\",\n      \"invoice_number\": \"INV-2024-0156\",\n      \"date_of_issue\": \"2024-03-15\",\n      \"due_date\": \"2024-04-15\",\n      \"item_0_description\": \"Web Development Services\",\n      \"item_0_quantity\": 40,\n      \"item_0_rate\": 75.00,\n      \"item_0_amount\": 3000.00,\n      \"tax_0_cgst_rate\": 9,\n      \"tax_0_cgst_amount\": 270.00,\n      \"tax_0_sgst_rate\": 9,\n      \"tax_0_sgst_amount\": 270.00,\n      \"subtotal\": 3000.00,\n      \"total\": 3540.00,\n      \"company_name\": \"Digital Services LLC\",\n      \"company_email\": \"billing@digitalservices.com\",\n      \"payment_transaction_ids\": \"TXN123456789\",\n      \"mode_of_payment\": \"Bank Transfer\"\n    }\n    \n\n## 🛠️ Troubleshooting & Best Practices\n\n### **Common Issues & Solutions**\n\n**PDF Extraction Challenges**\n\n  * **Scanned Documents** : Original workflow handles text-based PDFs only\n  * **Complex Layouts** : Some invoice formats may require prompt refinement\n  * **Multi-Page Invoices** : Large invoices might need pagination handling\n  * **Password Protection** : Encrypted PDFs require manual processing\n\n\n\n**AI Extraction Accuracy**\n\n  * **Field Recognition** : Some custom invoice formats may need prompt tuning\n  * **Currency Handling** : Multi-currency invoices may require specific configuration\n  * **Date Formats** : International date formats might need standardization\n  * **Vendor Variations** : Different vendor invoice styles may affect accuracy\n\n\n\n**Gmail Integration Limitations**\n\n  * **Label Management** : Ensure consistent labeling for proper processing\n  * **Attachment Size** : Large PDFs may hit Gmail API limits\n  * **Email Volume** : High-volume processing may require rate limiting\n  * **Security Settings** : Corporate Gmail may have additional restrictions\n\n\n\n### **Optimization Strategies**\n\n**Processing Efficiency**\n\n  * **Batch Processing** : Group similar invoices for more efficient processing\n  * **Template Recognition** : Create vendor-specific extraction templates\n  * **Quality Scoring** : Implement confidence ratings for extracted data\n  * **Error Handling** : Add fallback processes for failed extractions\n\n\n\n**Data Quality Assurance**\n\n  * **Validation Rules** : Implement business logic for data verification\n  * **Duplicate Detection** : Prevent duplicate invoice processing\n  * **Manual Review Queues** : Flag uncertain extractions for human review\n  * **Audit Logging** : Maintain detailed processing logs for troubleshooting\n\n\n\n**Business Process Integration**\n\n  * **Approval Workflows** : Add management approval steps for high-value invoices\n  * **Exception Handling** : Create special processes for unusual invoice types\n  * **Reporting Automation** : Generate regular summaries of processed invoices\n  * **Archive Management** : Implement retention policies for processed documents\n\n\n\n## 📈 Success Metrics\n\n### **Efficiency Improvements**\n\n  * **Processing Time** : Reduce manual data entry from hours to minutes\n  * **Accuracy Rates** : Achieve 95%+ data extraction accuracy\n  * **Volume Capacity** : Process 10-50x more invoices with same resources\n  * **Error Reduction** : Eliminate manual transcription errors\n\n\n\n### **Business Impact Measurements**\n\n  * **Cost Savings** : Calculate labor cost reduction from automation\n  * **Cash Flow Management** : Faster invoice processing enables better payment scheduling\n  * **Compliance** : Improved audit trails and data consistency\n  * **Scalability** : Ability to handle business growth without proportional staff increase\n\n\n\n## 📞 Questions & Support\n\nNeed help implementing or optimizing your AI Invoice Processor Agent?\n\n**📧 Expert Technical Support**\n\n  * **Email** : Yaron@nofluff.online\n  * **Response Time** : Within 24 hours on business days\n  * **Specialization** : Invoice processing automation, AI data extraction, accounting workflow integration\n\n\n\n**🎥 Comprehensive Training Resources**\n\n  * **YouTube Channel** : <https://www.youtube.com/@YaronBeen/videos>\n    * Complete setup and configuration walkthroughs\n    * Advanced customization for different invoice types\n    * Integration tutorials for popular accounting software\n    * Troubleshooting common extraction and processing issues\n    * Best practices for financial document automation\n\n\n\n**🤝 Professional Community & Updates**\n\n  * **LinkedIn** : <https://www.linkedin.com/in/yaronbeen/>\n    * Connect for ongoing automation consulting and support\n    * Share your invoice processing success stories and ROI results\n    * Access exclusive workflow templates and advanced configurations\n    * Join discussions about financial automation trends and innovations\n\n\n\n**💬 Support Request Guidelines**  \nInclude in your support message:\n\n  * Your current invoice processing volume and types\n  * Specific vendor formats or invoice layouts you handle\n  * Target accounting software or systems for integration\n  * Any technical errors or extraction accuracy issues\n  * Current manual processing workflow and pain points\n\n\n\n* * *\n\n_Ready to eliminate manual invoice processing forever? Deploy this AI Invoice Processor Agent and transform your accounting workflow from tedious data entry into intelligent, automated financial management!_\n",
  "crawled_at": "2025-05-27T23:15:05.185958",
  "readme_zh": "将您的发票处理从手工录入升级为智能自动化系统。这套强大的n8n工作流能实时监控Gmail中的发票附件，通过AI技术提取数据，并自动生成结构化的Google表格——所有财务信息都已规范整理，随时可对接会计流程。\n\n## 🔄 运作原理\n\n这套8步自动化方案彻底告别手工发票处理：\n\n**第一步：智能邮件监控**  \n工作流持续扫描指定标签的Gmail邮件，每分钟检测待处理的新发票附件。\n\n**第二步：附件验证**  \n智能过滤器确保仅处理含PDF附件的邮件，避免纯文本邮件误触发。\n\n**第三步：高级PDF解析**  \n系统自动下载PDF发票并转换为可读文本，精准适配各类发票版式。\n\n**第四步：AI数据提取**  \nGPT-4通过定制化财务分析指令提取关键信息：\n  * 公司信息与联系方式\n  * 发票编号、日期与付款条款\n  * 含数量价格的明细条目\n  * 消费税（CGST/SGST）、增值税计算\n  * 账单与收货地址\n  * 支付方式与交易参考号\n\n**第五步：结构化数据整理**  \nAI输出自动转换为标准JSON格式，包含25+规范字段的完整发票追踪。\n\n**第六步：动态表格生成**  \n每张发票自动创建时间戳命名的Google表格，数据排版清晰便于财务审核。\n\n**第七步：智能文件归档**  \n处理完成的表格自动归入指定Google Drive文件夹，形成可追溯的审计线索。\n\n**第八步：数据填充**  \n所有提取信息按会计流程要求自动填入表格，含格式化数值与计算公式。\n\n## ⚙️ 配置指南\n\n### 基础准备\n  * 可接收发票的Gmail账户\n  * Google Workspace（表格与云端硬盘权限）\n  * OpenAI API账户（用于数据提取）\n  * n8n运行环境（云版或自托管）\n  * 文本型PDF发票（非扫描件）\n\n### Gmail配置要求\n\n**标签设置**  \n创建专用处理标签：\n    \n    \n    📧 需创建标签：\n    - \"待处理发票\"（主标签）\n    - \"供应商发票\" \n    - \"客户发票\"\n    - \"已处理发票\"（归档标签）\n\n**邮件过滤规则**  \n设置自动标签规则：\n  * 已知供应商邮件 → 自动标记\"待处理发票\"\n  * 主题含\"发票\"的邮件 → 自动标记\"待处理发票\"\n  * 含PDF附件的邮件 → 自动标记\"待处理发票\"\n\n### 详细配置步骤\n\n**1. 凭证配置**\n  * **Gmail OAuth2**：含附件访问权限\n  * **OpenAI API密钥**：GPT-4调用权限\n  * **Google表格OAuth2**：表格编辑权限\n  * **云端硬盘OAuth2**：文件夹管理权限\n\n**2. 云端硬盘目录结构**  \n建议层级：\n    \n    \n    📁 发票管理系统/\n    ├── 📁 待处理发票/\n    ├── 📁 已处理发票/\n    │   ├── 📁 2024年度/\n    │   │   ├── 📁 Q1季度/\n    │   │   ├── 📁 Q2季度/\n    │   │   └── 📁 Q3季度/\n    ├── 📁 供应商发票/\n    └── 📁 客户发票/\n\n**3. AI提取定制**  \n默认支持以下定制化需求：\n  * **地区税制**：印度GST、欧盟VAT、美国销售税\n  * **行业字段**：采购单号、项目编码、成本中心\n  * **企业标准**：自定义字段、审批流程\n  * **多币种**：汇率转换、国际发票\n\n**4. 数据验证规则**  \n质量控制措施：\n  * 必填字段验证\n  * 日期/数字格式标准化\n  * 重复发票检测\n  * 提取置信度评分\n\n**5. 工作流激活**  \n  * 将JSON工作流导入n8n\n  * 测试各环节连接\n  * 用测试发票验证准确性\n  * 启用Gmail触发器开启监控\n\n## � 应用场景\n\n### **会计师事务所**\n  * 多客户发票批量处理\n  * 减少90%数据录入时间\n  * 降低人工转录错误率\n  * 业务量增长无需增员\n\n### **中小企业**\n  * 应付账款自动化\n  * 实时掌握付款周期\n  * 业务支出智能分类\n  * 审计资料一键调取\n\n### **企业财务部**\n  * 规模化处理采购发票\n  * 跨地区发票集中管理\n  * 合规性数据自动捕获\n  * 无缝对接ERP系统\n\n### **自由职业者**\n  * 项目账单自动追踪\n  * 税务支出分类管理\n  * 应收款项可视化\n  * 专业财务档案建设\n\n### **电商零售**\n  * 供应商成本分析\n  * 多渠道发票统管\n  * 采购成本趋势追踪\n  * 入库单自动核验\n\n## 🛠️ 高阶定制\n\n### **多格式支持**\n扩展处理能力至：\n  * 扫描件（需OCR）\n  * 邮件正文发票\n  * Excel附件\n  * 多页复杂发票\n\n### **智能校验**\n  * 采购单交叉验证\n  * 供应商数据库匹配\n  * 税额计算公式校验\n  * 实时汇率换算\n\n### **系统集成**\n  * 对接SAP/Oracle等ERP\n  * 同步至QuickBooks/Xero\n  * 添加审批工作流\n  * 连接银行支付系统\n\n### **分析功能**\n  * 供应商绩效看板\n  * 自动化费用报表\n  * 现金流预测\n  * 完整审计日志\n\n## ⚠️ 注意事项\n\n### **常见问题处理**\n  * 扫描件需额外OCR配置\n  * 特殊版式需调整AI指令\n  * 大附件注意Gmail限制\n  * 企业邮箱需权限调整\n\n### **优化建议**\n  * 按供应商创建模板\n  * 设置数据置信度阈值\n  * 建立人工复核队列\n  * 定期归档历史数据\n\n## 📞 技术支持\n\n**联系专家**  \n📧 Yaron@nofluff.online  \n⏳ 24小时内响应  \n\n**视频教程**  \n🎥 <https://www.youtube.com/@YaronBeen/videos>  \n含完整配置演示与进阶技巧  \n\n**专业咨询**  \n💼 <https://www.linkedin.com/in/yaronbeen/>  \n获取定制化解决方案  \n\n---\n\n_立即部署AI发票处理系统，将繁琐的财务工作转化为智能化的高效流程！_",
  "title_zh": "使用GPT-4o AI自动化从邮件提取发票数据至Google表格",
  "publish_date_zh": "最后一次更新于一天前",
  "workflow_json_zh": "{\"meta\":{\"instanceId\":\"5aaf4236c70e34e423fbdb2c7b754d19253a933bb1476d548f75848a01e473cf\",\"templateCredsSetupCompleted\":true},\"nodes\":[{\"id\":\"70ca3a90-55c8-4e46-9278-6a8fd3d107cd\",\"name\":\"Gmail Trigger\",\"type\":\"n8n-nodes-base.gmailTrigger\",\"position\":[-1820,220],\"parameters\":{\"simple\":false,\"filters\":{\"labelIds\":[\"Label_1393502052621954450\"]},\"options\":{\"downloadAttachments\":true},\"pollTimes\":{\"item\":[{\"mode\":\"everyMinute\"}]}},\"typeVersion\":1.2},{\"id\":\"f7dcff0f-7e98-4042-a33e-2fc32d876908\",\"name\":\"Create blank spreadsheet\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[-780,220],\"parameters\":{\"title\":\"=invoice_{{ $now }}\",\"options\":{},\"resource\":\"spreadsheet\",\"sheetsUi\":{\"sheetValues\":[{\"title\":\"=invoice_details\"}]}},\"executeOnce\":false,\"typeVersion\":4.5},{\"id\":\"9769ad04-a41c-4d55-806a-042b7d00e131\",\"name\":\"Move spreadsheet in invoice folder\",\"type\":\"n8n-nodes-base.googleDrive\",\"position\":[-560,220],\"parameters\":{\"fileId\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"={{ $json.spreadsheetId }}\"},\"driveId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"My Drive\",\"cachedResultUrl\":\"https://drive.google.com/drive/my-drive\",\"cachedResultName\":\"My Drive\"},\"folderId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"1JIdajTJvK6gj4bRjniBJvHEJbQ1pn3AM\",\"cachedResultUrl\":\"https://drive.google.com/drive/folders/1JIdajTJvK6gj4bRjniBJvHEJbQ1pn3AM\",\"cachedResultName\":\"invoices\"},\"operation\":\"move\"},\"typeVersion\":3},{\"id\":\"f9dbfe55-70b0-4abc-9745-9f4a65d5d1c2\",\"name\":\"OpenAI Chat Model\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\"position\":[-1180,480],\"parameters\":{\"model\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"gpt-4o-mini\"},\"options\":{\"responseFormat\":\"json_object\"}},\"credentials\":{\"openAiApi\":{\"id\":\"7dME1fmMlkFyzFjq\",\"name\":\"OpenAi account 2\"}},\"typeVersion\":1.2},{\"id\":\"00c59142-6079-4e9c-9374-ad487e48f072\",\"name\":\"Attachment Verification\",\"type\":\"n8n-nodes-base.filter\",\"position\":[-1600,220],\"parameters\":{\"options\":{\"ignoreCase\":false},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"efd974d9-aa20-461a-86ae-6e0a16d1527d\",\"operator\":{\"type\":\"object\",\"operation\":\"exists\",\"singleValue\":true},\"leftValue\":\"={{ $('Gmail Trigger').item.binary }}\",\"rightValue\":\"\"}]}},\"typeVersion\":2.2},{\"id\":\"8a29ac14-be2b-468a-97fa-540d28e80006\",\"name\":\"Extract Invoice data\",\"type\":\"n8n-nodes-base.extractFromFile\",\"position\":[-1380,220],\"parameters\":{\"options\":{},\"operation\":\"pdf\",\"binaryPropertyName\":\"={{ $('Attachment Verification').item.binary.keys() }}\"},\"typeVersion\":1},{\"id\":\"ae08cdc8-fcf9-4891-be86-b2dcf6f35278\",\"name\":\"Preparing Final data\",\"type\":\"n8n-nodes-base.code\",\"position\":[-340,220],\"parameters\":{\"mode\":\"runOnceForEachItem\",\"jsCode\":\"// Loop over input items and add a new field called 'myNewField' to the JSON of $input$json.output.first().json.outputeach one\\n\\nlet invoice_details = $('Invoice AI Agent').item.json.output\\n\\nreturn JSON.parse(invoice_details)\"},\"typeVersion\":2},{\"id\":\"7615a5b0-8761-43e2-82b0-32ac5c772f44\",\"name\":\"Final Spreadsheet with Invoice data\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[-140,220],\"parameters\":{\"columns\":{\"value\":{},\"schema\":[{\"id\":\"billed_to\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"billed_to\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"invoice_number\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"invoice_number\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"date_of_issue\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"date_of_issue\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"due_date\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"due_date\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"item_0_description\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"item_0_description\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"item_0_quantity\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"item_0_quantity\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"item_0_rate\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"item_0_rate\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"item_0_amount\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"item_0_amount\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"tax_0_cgst_rate\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"tax_0_cgst_rate\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"tax_0_cgst_amount\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"tax_0_cgst_amount\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"tax_0_sgst_rate\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"tax_0_sgst_rate\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"tax_0_sgst_amount\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"tax_0_sgst_amount\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"item_0_total_amount\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"item_0_total_amount\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"subtotal\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"subtotal\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"total\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"total\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"terms\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"terms\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"conditions_instructions\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"conditions_instructions\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"company_name\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"company_name\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"company_mobile\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"company_mobile\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"company_email\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"company_email\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"company_website\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"company_website\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"payment_transaction_ids\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"payment_transaction_ids\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"mode_of_payment\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"mode_of_payment\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"billing_address\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"billing_address\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"shipping_address\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"shipping_address\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"place_of_supply\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"place_of_supply\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"place_of_delivery\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"place_of_delivery\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"gst_registration_no\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"gst_registration_no\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"pan_no\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"pan_no\",\"defaultMatch\":false,\"canBeUsedToMatch\":true}],\"mappingMode\":\"autoMapInputData\",\"matchingColumns\":[],\"attemptToConvertTypes\":false,\"convertFieldsToString\":false},\"options\":{},\"operation\":\"append\",\"sheetName\":{\"__rl\":true,\"mode\":\"name\",\"value\":\"invoice_details\"},\"documentId\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"={{ $('Create blank spreadsheet').item.json.spreadsheetId }}\"}},\"typeVersion\":4.5},{\"id\":\"e68aa386-7150-4070-a5d7-1dcb963b620d\",\"name\":\"Invoice AI Agent\",\"type\":\"@n8n/n8n-nodes-langchain.agent\",\"position\":[-1160,220],\"parameters\":{\"text\":\"={{ $json.text }}\",\"options\":{\"systemMessage\":\"you are an financial advisor , who reads the array of data to identify certain elements of an Invoice, from the input data and provide a json response. use only following specified keys \\nfor example:\\n{\\n\\\"billed_to\\\": \\\"John\\\",\\n\\\"invoice_number\\\": \\\"569871234\\\",\\n\\\"date_of_issue\\\": \\\"2025-05-21\\\",\\n\\\"due_date\\\": \\\"2025-05-25\\\",\\n\\\"item_0_description\\\": \\\"Computer CPU\\\",\\n\\\"item_0_quantity\\\": 6,\\n\\\"item_0_rate\\\": 15,\\n\\\"item_0_amount\\\": 90,\\n\\\"item_1_description\\\": \\\"Chair Wooden\\\",\\n\\\"item_1_quantity\\\": 8,\\n\\\"item_1_rate\\\": 10,\\n\\\"item_1_amount\\\": 80,\\n\\\"subtotal\\\": 170.00,\\n\\\"discount\\\": 20.00,\\n\\\"total\\\": 150.00,\\n\\\"terms\\\": \\\"Sold items not be acceptable\\\",\\n\\\"conditions_instructions\\\": \\\"xyaABC\\\",\\n\\\"company_name\\\": \\\"Digital Electronics\\\",\\n\\\"company_mobile\\\": \\\"987654321\\\",\\n\\\"company_email\\\": \\\"ayz@gmail.com\\\",\\n\\\"company_website\\\": \\\"www.abc.com\\\"\\n}\"},\"promptType\":\"define\",\"hasOutputParser\":true},\"typeVersion\":1.9,\"alwaysOutputData\":false},{\"id\":\"335a80c5-ad86-4379-b1a6-9a2ef7285f3c\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-2860,100],\"parameters\":{\"width\":880,\"height\":1520,\"content\":\"AI发票处理助手：从邮件到结构化数据  \\n自动从Gmail附件提取、分析并整理发票数据至结构化Google表格，适用于：  \\n✅ 会计与簿记人员——告别发票手工录入  \\n✅ 中小企业——简化发票处理与追踪流程  \\n✅ 财务团队——应付账款流程自动化  \\n\\n⚙️ 技术栈  \\nn8n节点：  \\nGmail触发器 → 文件提取 → AI助手 → OpenAI聊天模型 → Google表格 → Google云端硬盘  \\n外部工具：  \\n• Gmail API——监控带附件的特定标签邮件  \\n• PDF提取——将发票PDF转为可读文本  \\n• OpenAI GPT-4——智能提取并结构化发票数据  \\n• Google表格——创建带发票详情的结构化表格  \\n• Google云端硬盘——自动归档至发票文件夹  \\n\\n🔑 设置所需凭证  \\n• Gmail OAuth2——访问邮件及下载附件  \\n• OpenAI API密钥——AI发票数据提取  \\n• Google表格 OAuth2——创建并填充表格  \\n• Google云端硬盘 OAuth2——文件分类存储  \\n\\n📧 Gmail设置要求  \\n创建标签（如\\\"发票处理\\\"）并应用于含发票附件的邮件，工作流将每分钟监控该标签的新邮件。  \\n\\n🚀 工作流步骤  \\n1. 邮件监控  \\n持续扫描带特定标签和附件的Gmail新邮件  \\n2. 附件验证  \\n确保邮件包含PDF附件后再处理  \\n3. 数据提取  \\n将PDF发票转为文本并提取内容  \\n4. AI智能分析  \\nGPT处理文本并提取结构化数据，包括：  \\n• 公司详情与联系方式  \\n• 发票编号、日期与到期日  \\n• 明细项目（数量、单价、金额）  \\n• 税费计算（CGST/SGST/VAT）  \\n• 付款条款与账单地址  \\n5. 表格生成  \\n创建带时间戳的Google表格并整理数据  \\n6. 文件归档  \\n将处理后的表格移至指定云端硬盘文件夹  \\n\\n📊 提取字段  \\nAI可识别25+项发票要素：  \\n• 头部信息：收款方、发票号、日期  \\n• 明细项目：描述、数量、单价、金额  \\n• 税费详情：CGST/SGST税率与金额  \\n• 公司信息：名称、联系方式、GST号  \\n• 付款信息：交易ID、支付方式  \\n• 地址信息：账单、发货、交付地址  \\n\\n💡 专业建议  \\n• 为不同发票类型（供应商/客户）设置清晰Gmail标签  \\n• 确保PDF为文本格式（非扫描件）以获得最佳效果  \\n• 按会计周期创建独立云端硬盘文件夹  \\n• 定期检查AI提取准确率并优化指令  \\n• 设置邮件过滤器自动标记供应商邮件  \\n\\n🛠️ 定制扩展  \\n• 添加带邮件通知的发票审批流程  \\n• 对接财务软件（QuickBooks/Xero/SAP）  \\n• 增加扫描件OCR处理功能  \\n• 设置重复发票检测与提醒  \\n• 基于到期日创建自动付款提醒\"},\"typeVersion\":1}],\"pinData\":{},\"connections\":{\"Gmail Trigger\":{\"main\":[[{\"node\":\"Attachment Verification\",\"type\":\"main\",\"index\":0}]]},\"Invoice AI Agent\":{\"main\":[[{\"node\":\"Create blank spreadsheet\",\"type\":\"main\",\"index\":0}]]},\"OpenAI Chat Model\":{\"ai_languageModel\":[[{\"node\":\"Invoice AI Agent\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"Extract Invoice data\":{\"main\":[[{\"node\":\"Invoice AI Agent\",\"type\":\"main\",\"index\":0}]]},\"Preparing Final data\":{\"main\":[[{\"node\":\"Final Spreadsheet with Invoice data\",\"type\":\"main\",\"index\":0}]]},\"Attachment Verification\":{\"main\":[[{\"node\":\"Extract Invoice data\",\"type\":\"main\",\"index\":0}]]},\"Create blank spreadsheet\":{\"main\":[[{\"node\":\"Move spreadsheet in invoice folder\",\"type\":\"main\",\"index\":0}]]},\"Move spreadsheet in invoice folder\":{\"main\":[[{\"node\":\"Preparing Final data\",\"type\":\"main\",\"index\":0}]]}}}"
}