{
  "url": "https://n8n.io/workflows/1794-create-salesforce-accounts-based-on-excel-file-data/",
  "title": "Create Salesforce accounts based on Excel File data",
  "author": "Tom",
  "publish_date": "Last update 10 months ago",
  "publish_date_absolute": "2024-07-25",
  "categories": [
    {
      "name": "Sales"
    },
    {
      "name": "Building Blocks"
    }
  ],
  "workflow_json": "{\"nodes\":[{\"id\":\"76f6b074-32a5-4419-aa0f-80505b3a31ad\",\"name\":\"On clicking 'execute'\",\"type\":\"n8n-nodes-base.manualTrigger\",\"position\":[20,240],\"parameters\":{},\"typeVersion\":1},{\"id\":\"42289f01-3af9-4bc3-babb-54b983de7e77\",\"name\":\"Search Salesforce accounts\",\"type\":\"n8n-nodes-base.salesforce\",\"position\":[680,240],\"parameters\":{\"query\":\"=SELECT id, Name FROM Account WHERE Name = '{{$json[\\\"Company Name\\\"].replace(/'/g, '\\\\\\\\\\\\'')}}'\",\"resource\":\"search\"},\"credentials\":{\"salesforceOAuth2Api\":{\"id\":\"40\",\"name\":\"Salesforce account\"}},\"typeVersion\":1,\"alwaysOutputData\":false},{\"id\":\"954ef43f-4dc1-4955-9c56-c5d11bcd5d6e\",\"name\":\"Keep new companies\",\"type\":\"n8n-nodes-base.merge\",\"position\":[900,40],\"parameters\":{\"mode\":\"removeKeyMatches\",\"propertyName1\":\"Company Name\",\"propertyName2\":\"Name\"},\"typeVersion\":1},{\"id\":\"ec23bd4f-c6ee-4c2a-a352-8ff521a5ddf6\",\"name\":\"Merge existing account data\",\"type\":\"n8n-nodes-base.merge\",\"position\":[900,440],\"parameters\":{\"mode\":\"mergeByKey\",\"propertyName1\":\"Company Name\",\"propertyName2\":\"Name\"},\"typeVersion\":1},{\"id\":\"85b460ee-e6b4-48c8-8315-ccf7875ec345\",\"name\":\"Account found?\",\"type\":\"n8n-nodes-base.if\",\"position\":[1120,440],\"parameters\":{\"conditions\":{\"string\":[{\"value1\":\"={{ $json[\\\"Id\\\"] }}\",\"operation\":\"isNotEmpty\"}]}},\"typeVersion\":1},{\"id\":\"1c926f04-b218-4460-8a56-c39a0854d50e\",\"name\":\"Remove duplicate companies\",\"type\":\"n8n-nodes-base.itemLists\",\"position\":[1120,140],\"parameters\":{\"compare\":\"selectedFields\",\"options\":{},\"operation\":\"removeDuplicates\",\"fieldsToCompare\":{\"fields\":[{\"fieldName\":\"Company Name\"}]}},\"typeVersion\":1},{\"id\":\"d35c3b0b-d7a8-4182-9277-17080655436b\",\"name\":\"Set Account ID for existing accounts\",\"type\":\"n8n-nodes-base.renameKeys\",\"position\":[1340,440],\"parameters\":{\"keys\":{\"key\":[{\"newKey\":\"Account ID\",\"currentKey\":\"Id\"}]},\"additionalOptions\":{}},\"typeVersion\":1},{\"id\":\"3747fdfa-f5f8-41b0-8393-1ac2ae29bab5\",\"name\":\"Retrieve new company contacts\",\"type\":\"n8n-nodes-base.merge\",\"position\":[1780,40],\"parameters\":{\"mode\":\"mergeByKey\",\"propertyName1\":\"Company Name\",\"propertyName2\":\"Name\"},\"typeVersion\":1},{\"id\":\"0879e6a0-d782-4a0a-98f3-eeccbea760f6\",\"name\":\"Set new account name\",\"type\":\"n8n-nodes-base.set\",\"position\":[1560,140],\"parameters\":{\"values\":{\"string\":[{\"name\":\"id\",\"value\":\"={{ $json[\\\"id\\\"] }}\"},{\"name\":\"Name\",\"value\":\"={{ $node[\\\"Remove duplicate companies\\\"].json[\\\"Company Name\\\"] }}\"}]},\"options\":{},\"keepOnlySet\":true},\"typeVersion\":1},{\"id\":\"7263c4dd-64eb-44c4-9839-fe3e5aa7ddbc\",\"name\":\"Create Salesforce account\",\"type\":\"n8n-nodes-base.salesforce\",\"position\":[1340,140],\"parameters\":{\"name\":\"={{ $json[\\\"Company Name\\\"] }}\",\"resource\":\"account\",\"additionalFields\":{}},\"credentials\":{\"salesforceOAuth2Api\":{\"id\":\"40\",\"name\":\"Salesforce account\"}},\"typeVersion\":1},{\"id\":\"40d168af-346a-46ea-9fa0-641edd0f4937\",\"name\":\"Create Salesforce contact\",\"type\":\"n8n-nodes-base.salesforce\",\"position\":[2000,240],\"parameters\":{\"lastname\":\"={{ $json[\\\"Last Name\\\"] }}\",\"resource\":\"contact\",\"operation\":\"upsert\",\"externalId\":\"Email\",\"externalIdValue\":\"={{ $json[\\\"Email\\\"] }}\",\"additionalFields\":{\"email\":\"={{ $json[\\\"Email\\\"] }}\",\"firstName\":\"={{ $json[\\\"First Name\\\"] }}\",\"acconuntId\":\"={{ $json[\\\"Account ID\\\"] }}\"}},\"credentials\":{\"salesforceOAuth2Api\":{\"id\":\"40\",\"name\":\"Salesforce account\"}},\"typeVersion\":1},{\"id\":\"dcd40640-c1d6-407c-95c9-84759ecaafab\",\"name\":\"Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-20,0],\"parameters\":{\"width\":400,\"height\":400,\"content\":\"## Downloading a file\\nIn this example workflow, the spreadsheet file is downloaded from an HTTP location.\\n\\nDepending on your scenario you might want to swap the HTTP Request node downloading the file with another node fetching the file from another source (such as an FTP service, cloud storage, your local filesystem or an email for example).\"},\"typeVersion\":1},{\"id\":\"2fc38a06-11ec-4aa5-83f9-624f5a5ef47a\",\"name\":\"Download file\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[240,240],\"parameters\":{\"url\":\"https://static.thomasmartens.eu/n8n/Excel-File-to-Salesforce.xlsx\",\"options\":{},\"responseFormat\":\"file\"},\"typeVersion\":2},{\"id\":\"43d5ba55-d150-4c7e-b44a-531733418c68\",\"name\":\"Spreadsheet File\",\"type\":\"n8n-nodes-base.spreadsheetFile\",\"position\":[460,240],\"parameters\":{\"options\":{}},\"typeVersion\":1}],\"connections\":{\"Download file\":{\"main\":[[{\"node\":\"Spreadsheet File\",\"type\":\"main\",\"index\":0}]]},\"Account found?\":{\"main\":[[{\"node\":\"Set Account ID for existing accounts\",\"type\":\"main\",\"index\":0}]]},\"Spreadsheet File\":{\"main\":[[{\"node\":\"Search Salesforce accounts\",\"type\":\"main\",\"index\":0},{\"node\":\"Keep new companies\",\"type\":\"main\",\"index\":0},{\"node\":\"Merge existing account data\",\"type\":\"main\",\"index\":0}]]},\"Keep new companies\":{\"main\":[[{\"node\":\"Remove duplicate companies\",\"type\":\"main\",\"index\":0},{\"node\":\"Retrieve new company contacts\",\"type\":\"main\",\"index\":0}]]},\"Set new account name\":{\"main\":[[{\"node\":\"Retrieve new company contacts\",\"type\":\"main\",\"index\":1}]]},\"On clicking 'execute'\":{\"main\":[[{\"node\":\"Download file\",\"type\":\"main\",\"index\":0}]]},\"Create Salesforce account\":{\"main\":[[{\"node\":\"Set new account name\",\"type\":\"main\",\"index\":0}]]},\"Remove duplicate companies\":{\"main\":[[{\"node\":\"Create Salesforce account\",\"type\":\"main\",\"index\":0}]]},\"Search Salesforce accounts\":{\"main\":[[{\"node\":\"Keep new companies\",\"type\":\"main\",\"index\":1},{\"node\":\"Merge existing account data\",\"type\":\"main\",\"index\":1}]]},\"Merge existing account data\":{\"main\":[[{\"node\":\"Account found?\",\"type\":\"main\",\"index\":0}]]},\"Retrieve new company contacts\":{\"main\":[[{\"node\":\"Create Salesforce contact\",\"type\":\"main\",\"index\":0}]]},\"Set Account ID for existing accounts\":{\"main\":[[{\"node\":\"Create Salesforce contact\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "This workflow shows a no code approach to creating Salesforce accounts and contacts based on data coming from an Excel file. For Excel 365 (the online version of Microsoft Excel) check out [this workflow](https://n8n.io/workflows/1793-create-salesforce-accounts-based-on-excel-365-data/) instead.\n\n![image.png](https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/image_1099bea771.png)\n\nTo run the workflow:\n\n  1. Make sure your Salesforce account is authenticated with n8n.\n  2. Have a Microsoft Excel workbook with contacts and their account names ready. The workflow uses [this example file](https://static.thomasmartens.eu/n8n/Excel-File-to-Salesforce.xlsx), but you probably want to use your own data instead.  \n![image.png](https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/image_c9bbbf976f.png)\n  3. Hit the Execute Workflow button at the bottom of the n8n canvas.\n\n\n\nHere is how it works:\n\nThe workflow first searches for existing Salesforce accounts by name. It then branches out depending on whether the account already exists in Salesforce or not. If an account does not exist yet, it will be created. The data is then normalised before both branches converge again. Finally the contacts are created or updated as needed in Salesforce.\n",
  "crawled_at": "2025-05-25T20:07:01.241213",
  "readme_zh": "此工作流展示了一种无需编写代码的方法，用于根据Excel文件中的数据创建Salesforce客户和联系人。若使用Excel 365（微软Excel在线版），请参考[此工作流](https://n8n.io/workflows/1793-create-salesforce-accounts-based-on-excel-365-data/)。\n\n![image.png](https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/image_1099bea771.png)\n\n运行工作流步骤：\n\n1. 确保您的Salesforce账户已在n8n完成认证  \n2. 准备包含联系人及其对应客户名称的Excel工作簿（推荐使用[示例文件](https://static.thomasmartens.eu/n8n/Excel-File-to-Salesforce.xlsx)结构，但应替换为您自有数据）  \n![image.png](https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/image_c9bbbf976f.png)  \n3. 点击n8n画布底部的\"执行工作流\"按钮  \n\n实现原理：  \n工作流首先按名称检索现有Salesforce客户，随后根据客户是否存在进行分支处理。对于新客户将执行创建操作，数据标准化处理后两条分支重新合并，最终按需在Salesforce中创建或更新联系人记录。",
  "title_zh": "根据Excel文件数据创建Salesforce账户",
  "publish_date_zh": "最后更新于10个月前",
  "workflow_json_zh": "{\"nodes\":[{\"id\":\"76f6b074-32a5-4419-aa0f-80505b3a31ad\",\"name\":\"On clicking 'execute'\",\"type\":\"n8n-nodes-base.manualTrigger\",\"position\":[20,240],\"parameters\":{},\"typeVersion\":1},{\"id\":\"42289f01-3af9-4bc3-babb-54b983de7e77\",\"name\":\"Search Salesforce accounts\",\"type\":\"n8n-nodes-base.salesforce\",\"position\":[680,240],\"parameters\":{\"query\":\"=SELECT id, Name FROM Account WHERE Name = '{{$json[\\\"Company Name\\\"].replace(/'/g, '\\\\\\\\\\\\'')}}'\",\"resource\":\"search\"},\"credentials\":{\"salesforceOAuth2Api\":{\"id\":\"40\",\"name\":\"Salesforce account\"}},\"typeVersion\":1,\"alwaysOutputData\":false},{\"id\":\"954ef43f-4dc1-4955-9c56-c5d11bcd5d6e\",\"name\":\"Keep new companies\",\"type\":\"n8n-nodes-base.merge\",\"position\":[900,40],\"parameters\":{\"mode\":\"removeKeyMatches\",\"propertyName1\":\"Company Name\",\"propertyName2\":\"Name\"},\"typeVersion\":1},{\"id\":\"ec23bd4f-c6ee-4c2a-a352-8ff521a5ddf6\",\"name\":\"Merge existing account data\",\"type\":\"n8n-nodes-base.merge\",\"position\":[900,440],\"parameters\":{\"mode\":\"mergeByKey\",\"propertyName1\":\"Company Name\",\"propertyName2\":\"Name\"},\"typeVersion\":1},{\"id\":\"85b460ee-e6b4-48c8-8315-ccf7875ec345\",\"name\":\"Account found?\",\"type\":\"n8n-nodes-base.if\",\"position\":[1120,440],\"parameters\":{\"conditions\":{\"string\":[{\"value1\":\"={{ $json[\\\"Id\\\"] }}\",\"operation\":\"isNotEmpty\"}]}},\"typeVersion\":1},{\"id\":\"1c926f04-b218-4460-8a56-c39a0854d50e\",\"name\":\"Remove duplicate companies\",\"type\":\"n8n-nodes-base.itemLists\",\"position\":[1120,140],\"parameters\":{\"compare\":\"selectedFields\",\"options\":{},\"operation\":\"removeDuplicates\",\"fieldsToCompare\":{\"fields\":[{\"fieldName\":\"Company Name\"}]}},\"typeVersion\":1},{\"id\":\"d35c3b0b-d7a8-4182-9277-17080655436b\",\"name\":\"Set Account ID for existing accounts\",\"type\":\"n8n-nodes-base.renameKeys\",\"position\":[1340,440],\"parameters\":{\"keys\":{\"key\":[{\"newKey\":\"Account ID\",\"currentKey\":\"Id\"}]},\"additionalOptions\":{}},\"typeVersion\":1},{\"id\":\"3747fdfa-f5f8-41b0-8393-1ac2ae29bab5\",\"name\":\"Retrieve new company contacts\",\"type\":\"n8n-nodes-base.merge\",\"position\":[1780,40],\"parameters\":{\"mode\":\"mergeByKey\",\"propertyName1\":\"Company Name\",\"propertyName2\":\"Name\"},\"typeVersion\":1},{\"id\":\"0879e6a0-d782-4a0a-98f3-eeccbea760f6\",\"name\":\"Set new account name\",\"type\":\"n8n-nodes-base.set\",\"position\":[1560,140],\"parameters\":{\"values\":{\"string\":[{\"name\":\"id\",\"value\":\"={{ $json[\\\"id\\\"] }}\"},{\"name\":\"Name\",\"value\":\"={{ $node[\\\"Remove duplicate companies\\\"].json[\\\"Company Name\\\"] }}\"}]},\"options\":{},\"keepOnlySet\":true},\"typeVersion\":1},{\"id\":\"7263c4dd-64eb-44c4-9839-fe3e5aa7ddbc\",\"name\":\"Create Salesforce account\",\"type\":\"n8n-nodes-base.salesforce\",\"position\":[1340,140],\"parameters\":{\"name\":\"={{ $json[\\\"Company Name\\\"] }}\",\"resource\":\"account\",\"additionalFields\":{}},\"credentials\":{\"salesforceOAuth2Api\":{\"id\":\"40\",\"name\":\"Salesforce account\"}},\"typeVersion\":1},{\"id\":\"40d168af-346a-46ea-9fa0-641edd0f4937\",\"name\":\"Create Salesforce contact\",\"type\":\"n8n-nodes-base.salesforce\",\"position\":[2000,240],\"parameters\":{\"lastname\":\"={{ $json[\\\"Last Name\\\"] }}\",\"resource\":\"contact\",\"operation\":\"upsert\",\"externalId\":\"Email\",\"externalIdValue\":\"={{ $json[\\\"Email\\\"] }}\",\"additionalFields\":{\"email\":\"={{ $json[\\\"Email\\\"] }}\",\"firstName\":\"={{ $json[\\\"First Name\\\"] }}\",\"acconuntId\":\"={{ $json[\\\"Account ID\\\"] }}\"}},\"credentials\":{\"salesforceOAuth2Api\":{\"id\":\"40\",\"name\":\"Salesforce account\"}},\"typeVersion\":1},{\"id\":\"dcd40640-c1d6-407c-95c9-84759ecaafab\",\"name\":\"Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-20,0],\"parameters\":{\"width\":400,\"height\":400,\"content\":\"## 下载文件\\n在此示例工作流中，电子表格文件通过HTTP协议从网络位置下载完成。\\n\\n根据实际应用场景，您可将当前下载文件的HTTP请求节点替换为其他适配节点，用于从不同来源获取文件（例如FTP服务、云存储、本地文件系统或电子邮件等渠道）。\"},\"typeVersion\":1},{\"id\":\"2fc38a06-11ec-4aa5-83f9-624f5a5ef47a\",\"name\":\"Download file\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[240,240],\"parameters\":{\"url\":\"https://static.thomasmartens.eu/n8n/Excel-File-to-Salesforce.xlsx\",\"options\":{},\"responseFormat\":\"file\"},\"typeVersion\":2},{\"id\":\"43d5ba55-d150-4c7e-b44a-531733418c68\",\"name\":\"Spreadsheet File\",\"type\":\"n8n-nodes-base.spreadsheetFile\",\"position\":[460,240],\"parameters\":{\"options\":{}},\"typeVersion\":1}],\"connections\":{\"Download file\":{\"main\":[[{\"node\":\"Spreadsheet File\",\"type\":\"main\",\"index\":0}]]},\"Account found?\":{\"main\":[[{\"node\":\"Set Account ID for existing accounts\",\"type\":\"main\",\"index\":0}]]},\"Spreadsheet File\":{\"main\":[[{\"node\":\"Search Salesforce accounts\",\"type\":\"main\",\"index\":0},{\"node\":\"Keep new companies\",\"type\":\"main\",\"index\":0},{\"node\":\"Merge existing account data\",\"type\":\"main\",\"index\":0}]]},\"Keep new companies\":{\"main\":[[{\"node\":\"Remove duplicate companies\",\"type\":\"main\",\"index\":0},{\"node\":\"Retrieve new company contacts\",\"type\":\"main\",\"index\":0}]]},\"Set new account name\":{\"main\":[[{\"node\":\"Retrieve new company contacts\",\"type\":\"main\",\"index\":1}]]},\"On clicking 'execute'\":{\"main\":[[{\"node\":\"Download file\",\"type\":\"main\",\"index\":0}]]},\"Create Salesforce account\":{\"main\":[[{\"node\":\"Set new account name\",\"type\":\"main\",\"index\":0}]]},\"Remove duplicate companies\":{\"main\":[[{\"node\":\"Create Salesforce account\",\"type\":\"main\",\"index\":0}]]},\"Search Salesforce accounts\":{\"main\":[[{\"node\":\"Keep new companies\",\"type\":\"main\",\"index\":1},{\"node\":\"Merge existing account data\",\"type\":\"main\",\"index\":1}]]},\"Merge existing account data\":{\"main\":[[{\"node\":\"Account found?\",\"type\":\"main\",\"index\":0}]]},\"Retrieve new company contacts\":{\"main\":[[{\"node\":\"Create Salesforce contact\",\"type\":\"main\",\"index\":0}]]},\"Set Account ID for existing accounts\":{\"main\":[[{\"node\":\"Create Salesforce contact\",\"type\":\"main\",\"index\":0}]]}}}"
}