{
  "url": "https://n8n.io/workflows/4350-check-dependencies-before-completing-awork-tasks-workaround/",
  "title": "Check dependencies before completing Awork tasks (Workaround)",
  "author": "Gregor",
  "publish_date": "Last update a day ago",
  "publish_date_absolute": "",
  "categories": [
    {
      "name": "IT Ops"
    }
  ],
  "workflow_json": "{\"meta\":{\"instanceId\":\"93fb8727a95622f4aa18b433e7f50b3d9eefa47fbe8901532956ded5db485301\"},\"nodes\":[{\"id\":\"8743a397-a6ca-4325-b0f8-33a34e15b63a\",\"name\":\"Load dependencies for task\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[1600,-400],\"parameters\":{\"url\":\"=https://api.awork.com/api/v1/tasks/{{ $('Webhook call by Awork').item.json.body.entity.id }}/taskdependencies\",\"options\":{},\"authentication\":\"genericCredentialType\",\"genericAuthType\":\"httpHeaderAuth\"},\"credentials\":{\"httpHeaderAuth\":{\"id\":\"9d0FyCu0IlwrdNkM\",\"name\":\"Awork Api\"}},\"retryOnFail\":true,\"typeVersion\":4.2,\"alwaysOutputData\":true,\"waitBetweenTries\":2000},{\"id\":\"d3ac4527-eb09-49f5-9bff-7d83e494022d\",\"name\":\"Aggregate task dependencies\",\"type\":\"n8n-nodes-base.aggregate\",\"position\":[1800,-400],\"parameters\":{\"options\":{\"mergeLists\":true},\"fieldsToAggregate\":{\"fieldToAggregate\":[{\"renameField\":true,\"outputFieldName\":\"taskDependencies\",\"fieldToAggregate\":\"predecessorId\"}]}},\"typeVersion\":1},{\"id\":\"1b05f8f7-9451-481d-b2cb-b74c4048f9e0\",\"name\":\"Workflow config\",\"type\":\"n8n-nodes-base.set\",\"position\":[-640,0],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"20b87314-585f-4b03-a87d-cc1b9ff1f9c2\",\"name\":\"finishedStateLabels\",\"type\":\"array\",\"value\":\"=[\\\"Fertig\\\",\\\"Total fertig\\\"]\"},{\"id\":\"16f603e2-3703-4f47-a1b9-92503eb1ea43\",\"name\":\"useDependencies\",\"type\":\"boolean\",\"value\":false},{\"id\":\"ffd4703d-be65-4c35-b28c-6cafb1050d13\",\"name\":\"useTreeStructure\",\"type\":\"boolean\",\"value\":true},{\"id\":\"6adacba5-463e-4d5e-9571-54f1a026cb4d\",\"name\":\"addComments\",\"type\":\"boolean\",\"value\":true},{\"id\":\"a06d3f03-8c2d-4788-b986-4bfc2b2a37c5\",\"name\":\"commentTextDependencies\",\"type\":\"string\",\"value\":\"Some dependencies not yet finished! Status rolled back!\"},{\"id\":\"68e0a3f8-5b43-4b1c-b7c8-174abd4c3754\",\"name\":\"commentTextTreeStructure\",\"type\":\"string\",\"value\":\"Some child tasks not yet finished! Status rolled back!\"}]}},\"typeVersion\":3.4},{\"id\":\"a610af8c-a4eb-4fa0-987f-8c001f78de20\",\"name\":\"Fetch task changes\",\"type\":\"n8n-nodes-base.set\",\"position\":[-220,0],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"d1e893cd-bdeb-4c9b-8fe0-82dc11c047a7\",\"name\":\"=changes\",\"type\":\"array\",\"value\":\"={{ $('Webhook call by Awork').item.json.body.changes }}\"}]}},\"typeVersion\":3.4},{\"id\":\"72b495ae-fd9c-4347-ae17-8ba93a3afeb9\",\"name\":\"Split out task changes\",\"type\":\"n8n-nodes-base.splitOut\",\"position\":[0,0],\"parameters\":{\"options\":{},\"fieldToSplitOut\":\"changes\"},\"typeVersion\":1},{\"id\":\"a4ec9460-d622-4d4b-a31b-ba3705faa88f\",\"name\":\"Filter task status change\",\"type\":\"n8n-nodes-base.filter\",\"position\":[220,0],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"82923633-648e-4ef0-82dc-cbe35de925b3\",\"operator\":{\"name\":\"filter.operator.equals\",\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $json.property }}\",\"rightValue\":\"TaskStatusId\"}]}},\"typeVersion\":2.2},{\"id\":\"cc8d6540-122e-48e0-bcf7-91331eea11d4\",\"name\":\"Check if task done\",\"type\":\"n8n-nodes-base.if\",\"position\":[620,0],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"e4e5890b-588e-41f1-95c1-02e313fda09a\",\"operator\":{\"type\":\"array\",\"operation\":\"contains\",\"rightType\":\"any\"},\"leftValue\":\"={{ $('Workflow config').item.json.finishedStateLabels }}\",\"rightValue\":\"={{ $('Webhook call by Awork').item.json.body.entity.taskStatus.name }}\"},{\"id\":\"97e159ef-21df-4d1c-bef0-fc7a64ffa0fe\",\"operator\":{\"name\":\"filter.operator.equals\",\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $('Webhook call by Awork').item.json.body.entity.taskStatus.type }}\",\"rightValue\":\"done\"}]}},\"typeVersion\":2.2},{\"id\":\"0b19f6d1-2821-49ff-8291-933c26165e93\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-1940,-660],\"parameters\":{\"width\":880,\"height\":1440,\"content\":\"## Awork workaround for done tasks with subtasks or dependencies\\n\\n\\nCurrently, [Awork](https://www.awork.com/) does **not** offer direct support for the following functions:\\n\\n* If a task has subtasks, then it should not be able to be marked as completed while subtasks are still open\\n* If a task is dependent on other tasks, then it should not be able to be marked as completed as long as these linked tasks are still open\\n\\n### This n8n workflow offers the following functions:\\n\\n* Checking whether all subtasks of a task have been completed before it can be completed \\n* Check whether tasks marked as prerequisites have been completed before the task can be marked as completed\\n* If the condition for completing a task is not fulfilled, the workflow rolls back the status to the previous status\\n* A comment is added to the task as to why this roll back occurred\\n* This workflow **does not use** the Awork community nodes package, as this package does not support all API calls and is therefore not used by me. If you would like to use that package, you can find more information at [https://support.awork.com/en/articles/9826591-n8n-integration](https://support.awork.com/en/articles/9826591-n8n-integration) and replace the http nodes with matching community nodes if applicable\\n\\n\\n### The following configuration settings are possible or required in the “Workflow config” node (following the webhook call):\\n\\n* **finishedStateLabels** (required): Label text of the task status entities that have the “Done” state. Must be stored as an array. Allows you to control whether the workflow is skipped for certain status changes, even if the task has been marked as completed.\\n\\n* **useDependencies** (optional): Boolean setting as to whether dependencies should be taken into account or not. If true, a task can only be marked as completed if the linked tasks have been marked as completed.\\n\\n* **useTreeStructure** (optional): Boolean setting whether parent and child tasks are taken into account. If true, then parent tasks can only be marked as completed if all child tasks have been marked as completed.\\n\\n* **addComments** (optional): Boolean setting as to whether a comment is added to a task if a status change has been undone by the workflow\\n\\n* **commentTextDependencies** (optional, required if addComments is true): Comment text that is added to a task when the status change is undone for uncompleted tasks on which the current task is dependent. Serves as a hint for the user.\\n\\n* **commentTextTreeStructure** (optional, required if addComments is true): Comment text that is added to a task when the status change is undone for uncompleted subtasks. Serves as a hint for the user.\\n\\n## How to use\\n\\n**Awork configuration**\\n\\n* Copy this workflow to your n8n installation\\n* Add authentication credentials to webhook call node at the start\\n\\n* Add a new webhook call to Awork (see [https://support.awork.com/en/articles/5415462-webhooks](https://support.awork.com/en/articles/5415462-webhooks)) and configure as required (name, authentication etc.)\\n* Configure the webhook to be called on task status changes\\n* Enable \\\"Only events from first level properties\\\" to reduce the number of webhook calls\\n* Test and save webhook\\n\\n* Generate a new API client (or use existing) (see [https://support.awork.com/en/articles/5415664-client-applications-and-api-keys](https://support.awork.com/en/articles/5415664-client-applications-and-api-keys))\\n\\n* Add new credentials for Awork to your n8n installation (see [https://docs.n8n.io/credentials/add-edit-credentials/](https://docs.n8n.io/credentials/add-edit-credentials/))\\n++ Choose \\\"Header auth\\\" from the list and name as you like, e.g. \\\"Awork API Access\\\"\\n++ Set \\\"name\\\" to \\\"Authorization\\\" and \\\"value\\\" to \\\"Bearer XXX\\\" with XXX being replaced by the API key created in Awork\\n++ Apply credentials to all HTTP Request nodes (blue globe)\\n\\n\\n## Enjoy\\n\\n\"},\"typeVersion\":1},{\"id\":\"521684a2-f6d7-483a-aa73-bc6243d6bc33\",\"name\":\"Webhook call by Awork\",\"type\":\"n8n-nodes-base.webhook\",\"position\":[-940,0],\"webhookId\":\"57b88b94-6228-4e49-897d-64bf8c7d32db\",\"parameters\":{\"path\":\"57b88b94-6228-4e49-897d-64bf8c7d32db\",\"options\":{},\"httpMethod\":\"POST\"},\"typeVersion\":2},{\"id\":\"00e9ea34-8110-43a4-a0a3-6d95272b7f22\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-740,-100],\"parameters\":{\"color\":4,\"width\":360,\"height\":280,\"content\":\"### Workflow config\\n* Configure basic settings\"},\"typeVersion\":1},{\"id\":\"ae4ad465-18d5-4a8b-b3ea-05aa9b8d81e3\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-260,-100],\"parameters\":{\"color\":4,\"width\":660,\"height\":280,\"content\":\"### Extract status changes from webhook call payload\\n\"},\"typeVersion\":1},{\"id\":\"124b4dc0-cc8b-4b10-89c0-fc3db5aa18bf\",\"name\":\"Sticky Note3\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[500,-100],\"parameters\":{\"color\":3,\"width\":380,\"height\":280,\"content\":\"### Check if task status is currently \\\"done\\\"\\n* If yes, proceed\\n* If no, exit workflow\"},\"typeVersion\":1},{\"id\":\"901b5649-3e43-4b03-9c2a-6281ec14cd3d\",\"name\":\"Sticky Note4\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1000,-100],\"parameters\":{\"color\":3,\"width\":380,\"height\":280,\"content\":\"### Check if dependencies are enabled\\n* If yes, process dependencies\\n* If no, check if tree structure is enabled\"},\"typeVersion\":1},{\"id\":\"72cf9e1b-26f4-4132-b760-1b46f5348948\",\"name\":\"Check if dependencies enabled\",\"type\":\"n8n-nodes-base.if\",\"position\":[1140,0],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"53d5f2be-2830-4977-a69f-a0d135ea76c4\",\"operator\":{\"type\":\"boolean\",\"operation\":\"true\",\"singleValue\":true},\"leftValue\":\"={{ $('Workflow config').item.json.useDependencies }}\",\"rightValue\":\"true\"}]}},\"typeVersion\":2.2},{\"id\":\"1475c9e1-d99b-434c-b1e3-8160d25bd834\",\"name\":\"Load all linked tasks\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[2260,-400],\"parameters\":{\"url\":\"=https://api.awork.com/api/v1/me/projecttasks\",\"options\":{},\"sendQuery\":true,\"authentication\":\"genericCredentialType\",\"genericAuthType\":\"httpHeaderAuth\",\"queryParameters\":{\"parameters\":[{\"name\":\"filterby\",\"value\":\"={{ $json.taskDependencies.join(' or ') }}\"}]}},\"credentials\":{\"httpHeaderAuth\":{\"id\":\"9d0FyCu0IlwrdNkM\",\"name\":\"Awork Api\"}},\"retryOnFail\":true,\"typeVersion\":4.2,\"alwaysOutputData\":true,\"waitBetweenTries\":2000},{\"id\":\"4d41c9a6-edae-4a0f-8a06-64c647d4da1a\",\"name\":\"Build filter params\",\"type\":\"n8n-nodes-base.code\",\"position\":[2020,-400],\"parameters\":{\"jsCode\":\"// Loop over input items and add a new field called 'myNewField' to the JSON of each one\\nfor (const item of $input.all()) {\\n  for( var key in item.json.taskDependencies ) {\\n  item.json.taskDependencies[key] = \\\"id eq guid'\\\" + item.json.taskDependencies[key] +\\\"'\\\";\\n}\\n}\\n\\nreturn $input.all();\"},\"typeVersion\":2},{\"id\":\"763b71ac-c78b-4020-9fe1-cc80028edfa7\",\"name\":\"Filter only open tasks\",\"type\":\"n8n-nodes-base.filter\",\"position\":[2480,-400],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"8f2bbc21-ad7c-47e2-95b1-f92cb482ea8e\",\"operator\":{\"type\":\"string\",\"operation\":\"notEquals\"},\"leftValue\":\"={{ $json.taskStatus.type }}\",\"rightValue\":\"done\"}]}},\"typeVersion\":2.2},{\"id\":\"7d90188e-859e-450f-922a-e74c9f69646d\",\"name\":\"Aggregate open task IDs\",\"type\":\"n8n-nodes-base.aggregate\",\"position\":[2700,-400],\"parameters\":{\"options\":{},\"fieldsToAggregate\":{\"fieldToAggregate\":[{\"fieldToAggregate\":\"id\"}]}},\"typeVersion\":1},{\"id\":\"1aca54ca-3369-456e-942d-ab929879c2a4\",\"name\":\"Sticky Note5\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1560,-500],\"parameters\":{\"color\":4,\"width\":1320,\"height\":340,\"content\":\"### Load task dependencies and filter open tasks\\n\"},\"typeVersion\":1},{\"id\":\"d1475f48-a06a-4b67-8374-b1f4c6713eb8\",\"name\":\"Sticky Note6\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[2980,-500],\"parameters\":{\"color\":3,\"width\":420,\"height\":340,\"content\":\"### Check if tasks marked as dependencies are open\\n* If yes, roll back status.\\n* If not, proceed to tree structure check\"},\"typeVersion\":1},{\"id\":\"86436ab7-7a4d-47c9-ab9f-9d414205baf3\",\"name\":\"Check if open tasks exist\",\"type\":\"n8n-nodes-base.if\",\"position\":[3140,-400],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"c30d2bf0-f6ca-46a6-be1e-2f24425fffed\",\"operator\":{\"type\":\"array\",\"operation\":\"notEmpty\",\"singleValue\":true},\"leftValue\":\"={{ $json.id }}\",\"rightValue\":\"\"}]}},\"typeVersion\":2.2},{\"id\":\"3c8971c0-9ad5-4265-add8-9dde8baef83a\",\"name\":\"Sticky Note7\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[3500,-500],\"parameters\":{\"color\":4,\"width\":360,\"height\":340,\"content\":\"### Roll back task status\"},\"typeVersion\":1},{\"id\":\"f5062a59-4067-49f5-9a3a-3087b09a9629\",\"name\":\"Sticky Note8\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[3960,-500],\"parameters\":{\"color\":3,\"width\":400,\"height\":340,\"content\":\"### Check if comment should be added to task\\n* Exit workflow if no comment should be added\"},\"typeVersion\":1},{\"id\":\"6b84e668-7dd8-4ff5-ae98-c2dc6a435c07\",\"name\":\"Check if comments are enabled\",\"type\":\"n8n-nodes-base.if\",\"position\":[4120,-400],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"6505de62-2d0a-4a3a-8f33-f0add4364b7e\",\"operator\":{\"type\":\"boolean\",\"operation\":\"true\",\"singleValue\":true},\"leftValue\":\"={{ $('Workflow config').item.json.addComments }}\",\"rightValue\":\"\"}]}},\"typeVersion\":2.2},{\"id\":\"81f39f77-eacb-4882-9a75-5e01dce04e5c\",\"name\":\"Sticky Note9\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[4460,-500],\"parameters\":{\"color\":4,\"width\":460,\"height\":340,\"content\":\"### Add comment to task regarding roll back of task state\\n* Add comment and exit workflow\"},\"typeVersion\":1},{\"id\":\"cad1126c-4a60-47e2-8b75-0c2b35464497\",\"name\":\"Add comment to tasks\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[4640,-400],\"parameters\":{\"url\":\"=https://api.awork.com/api/v1/tasks/{{ $('Webhook call by Awork').item.json.body.entity.id }}/comments\",\"method\":\"POST\",\"options\":{},\"jsonBody\":\"={\\n  \\\"message\\\": {{ JSON.stringify($('Workflow config').item.json.commentTextDependencies) }}\\n} \",\"sendBody\":true,\"specifyBody\":\"json\",\"authentication\":\"genericCredentialType\",\"genericAuthType\":\"httpHeaderAuth\"},\"credentials\":{\"httpCustomAuth\":{\"id\":\"CmNSbB7CCq63XJLe\",\"name\":\"Zammad API - TICKET\"},\"httpHeaderAuth\":{\"id\":\"9d0FyCu0IlwrdNkM\",\"name\":\"Awork Api\"}},\"retryOnFail\":true,\"typeVersion\":4.2,\"waitBetweenTries\":2000},{\"id\":\"a98ba8ae-05d4-4175-beed-fd9f40c772d3\",\"name\":\"Check if tree structure enabled\",\"type\":\"n8n-nodes-base.if\",\"position\":[3600,120],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"53d5f2be-2830-4977-a69f-a0d135ea76c4\",\"operator\":{\"type\":\"boolean\",\"operation\":\"true\",\"singleValue\":true},\"leftValue\":\"={{ $('Workflow config').item.json.useTreeStructure }}\",\"rightValue\":\"true\"}]}},\"typeVersion\":2.2},{\"id\":\"3464568d-3863-4063-8097-526b60260818\",\"name\":\"Sticky Note11\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[3500,20],\"parameters\":{\"color\":3,\"width\":360,\"height\":340,\"content\":\"### Check if tree structure check is enabled\\n* Exit workflow if not enabled\"},\"typeVersion\":1},{\"id\":\"1e2f8502-fc35-4e6f-bb9a-83acb04d57af\",\"name\":\"Sticky Note12\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[3960,20],\"parameters\":{\"color\":3,\"width\":400,\"height\":340,\"content\":\"### Check if task has subtasks\\n* Exit workflow if no subtasks found\"},\"typeVersion\":1},{\"id\":\"d25eeac9-c485-4624-8b9f-b7068a4eb0b5\",\"name\":\"Check subtasks\",\"type\":\"n8n-nodes-base.if\",\"position\":[4080,100],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"965e2460-236b-4628-b6e9-e4082b656b0f\",\"operator\":{\"type\":\"number\",\"operation\":\"gt\"},\"leftValue\":\"={{ $('Webhook call by Awork').item.json.body.entity.numberOfSubtasks }}\",\"rightValue\":0}]}},\"typeVersion\":2.2},{\"id\":\"6bcac41a-3f06-4a35-9703-fdfba98d1ac4\",\"name\":\"Roll back task status from done to previous state\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[3620,-400],\"parameters\":{\"url\":\"https://api.awork.com/api/v1/tasks/changestatuses\",\"method\":\"POST\",\"options\":{},\"jsonBody\":\"=[\\n  {\\n    \\\"taskId\\\": \\\"{{ $('Webhook call by Awork').item.json.body.entity.id }}\\\",\\n    \\\"statusId\\\": \\\"{{ $('Filter task status change').item.json.old }}\\\" \\n}\\n] \",\"sendBody\":true,\"specifyBody\":\"json\",\"authentication\":\"genericCredentialType\",\"genericAuthType\":\"httpHeaderAuth\"},\"credentials\":{\"httpHeaderAuth\":{\"id\":\"9d0FyCu0IlwrdNkM\",\"name\":\"Awork Api\"}},\"retryOnFail\":true,\"typeVersion\":4.2,\"waitBetweenTries\":2000},{\"id\":\"38782806-11a3-4976-8ba6-17da89d7a859\",\"name\":\"Load all open sub tasks\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[4560,100],\"parameters\":{\"url\":\"=https://api.awork.com/api/v1/me/projecttasks\",\"options\":{},\"sendQuery\":true,\"authentication\":\"genericCredentialType\",\"genericAuthType\":\"httpHeaderAuth\",\"queryParameters\":{\"parameters\":[{\"name\":\"filterby\",\"value\":\"=parentid eq guid'{{ $('Webhook call by Awork').item.json.body.entity.id }}' and taskstatus/type ne 'done'\"}]}},\"credentials\":{\"httpHeaderAuth\":{\"id\":\"9d0FyCu0IlwrdNkM\",\"name\":\"Awork Api\"}},\"typeVersion\":4.2,\"alwaysOutputData\":true},{\"id\":\"ad23f9c2-bdb4-48b7-ad6b-776424c0275d\",\"name\":\"Aggregate task IDs\",\"type\":\"n8n-nodes-base.aggregate\",\"position\":[4780,100],\"parameters\":{\"options\":{},\"fieldsToAggregate\":{\"fieldToAggregate\":[{\"fieldToAggregate\":\"id\"}]}},\"typeVersion\":1},{\"id\":\"711fd327-892a-48e2-95ea-24a21cba1765\",\"name\":\"Sticky Note10\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[4460,20],\"parameters\":{\"color\":4,\"width\":500,\"height\":340,\"content\":\"### Load subtasks not marked as done\"},\"typeVersion\":1},{\"id\":\"fe844b55-800d-426c-9842-ccb8cc0d33f3\",\"name\":\"Sticky Note14\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[5060,20],\"parameters\":{\"color\":3,\"width\":400,\"height\":340,\"content\":\"### Check if open subtasks exist\\n* Exit workflow if no open subtasks found\"},\"typeVersion\":1},{\"id\":\"946243b8-ceaa-4ce3-a4d1-97bc3ee9f9ed\",\"name\":\"Check open subtasks\",\"type\":\"n8n-nodes-base.if\",\"position\":[5180,100],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"f1c49c95-5272-4414-99f6-55e146a33ae2\",\"operator\":{\"type\":\"array\",\"operation\":\"lengthGt\",\"rightType\":\"number\"},\"leftValue\":\"={{ $json.id }}\",\"rightValue\":0}]}},\"typeVersion\":2.2},{\"id\":\"e4e43d31-a7c1-404c-a67a-21236314f46c\",\"name\":\"Sticky Note15\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[5580,20],\"parameters\":{\"color\":4,\"width\":360,\"height\":340,\"content\":\"### Roll back task status\"},\"typeVersion\":1},{\"id\":\"7065d3b2-f120-4636-b30e-d919d4ca47c8\",\"name\":\"Sticky Note16\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[6040,20],\"parameters\":{\"color\":3,\"width\":400,\"height\":340,\"content\":\"### Check if comment should be added to task\\n* Exit workflow if no comment should be added\"},\"typeVersion\":1},{\"id\":\"e4b9348e-de14-425a-b9ed-64891681c49a\",\"name\":\"Check if comments are enabled1\",\"type\":\"n8n-nodes-base.if\",\"position\":[6200,120],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"6505de62-2d0a-4a3a-8f33-f0add4364b7e\",\"operator\":{\"type\":\"boolean\",\"operation\":\"true\",\"singleValue\":true},\"leftValue\":\"={{ $('Workflow config').item.json.addComments }}\",\"rightValue\":\"\"}]}},\"typeVersion\":2.2},{\"id\":\"e01f0f8a-d844-4f51-8c38-044d1be4c3b3\",\"name\":\"Sticky Note17\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[6540,20],\"parameters\":{\"color\":4,\"width\":460,\"height\":340,\"content\":\"### Add comment to task regarding roll back of task state\\n* Add comment and exit workflow\"},\"typeVersion\":1},{\"id\":\"65c7656e-f03e-4082-8226-34a052fbdc38\",\"name\":\"Add comment to tasks1\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[6720,120],\"parameters\":{\"url\":\"=https://api.awork.com/api/v1/tasks/{{ $('Webhook call by Awork').item.json.body.entity.id }}/comments\",\"method\":\"POST\",\"options\":{},\"jsonBody\":\"={\\n  \\\"message\\\": {{ JSON.stringify($('Workflow config').item.json.commentTextTreeStructure) }}\\n} \",\"sendBody\":true,\"specifyBody\":\"json\",\"authentication\":\"genericCredentialType\",\"genericAuthType\":\"httpHeaderAuth\"},\"credentials\":{\"httpCustomAuth\":{\"id\":\"CmNSbB7CCq63XJLe\",\"name\":\"Zammad API - TICKET\"},\"httpHeaderAuth\":{\"id\":\"9d0FyCu0IlwrdNkM\",\"name\":\"Awork Api\"}},\"retryOnFail\":true,\"typeVersion\":4.2,\"waitBetweenTries\":2000},{\"id\":\"0521eaf8-0719-4691-be1d-82a6defa87ca\",\"name\":\"Roll back task status from done to previous state1\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[5700,120],\"parameters\":{\"url\":\"https://api.awork.com/api/v1/tasks/changestatuses\",\"method\":\"POST\",\"options\":{},\"jsonBody\":\"=[\\n  {\\n    \\\"taskId\\\": \\\"{{ $('Webhook call by Awork').item.json.body.entity.id }}\\\",\\n    \\\"statusId\\\": \\\"{{ $('Filter task status change').item.json.old }}\\\" \\n}\\n] \",\"sendBody\":true,\"specifyBody\":\"json\",\"authentication\":\"genericCredentialType\",\"genericAuthType\":\"httpHeaderAuth\"},\"credentials\":{\"httpHeaderAuth\":{\"id\":\"9d0FyCu0IlwrdNkM\",\"name\":\"Awork Api\"}},\"retryOnFail\":true,\"typeVersion\":4.2,\"waitBetweenTries\":2000},{\"id\":\"0a266961-2e39-4508-a37e-9a5ec6811466\",\"name\":\"Sticky Note13\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-740,-660],\"parameters\":{\"color\":4,\"width\":280,\"content\":\"## Green sticky notes: Logical group of nodes\"},\"typeVersion\":1},{\"id\":\"a2014e67-29c9-49fb-86eb-0e5fe0969455\",\"name\":\"Sticky Note18\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-380,-660],\"parameters\":{\"color\":3,\"width\":280,\"content\":\"## Red sticky notes: Routing and possible workflow exit\"},\"typeVersion\":1}],\"pinData\":{},\"connections\":{\"Check subtasks\":{\"main\":[[{\"node\":\"Load all open sub tasks\",\"type\":\"main\",\"index\":0}]]},\"Workflow config\":{\"main\":[[{\"node\":\"Fetch task changes\",\"type\":\"main\",\"index\":0}]]},\"Aggregate task IDs\":{\"main\":[[{\"node\":\"Check open subtasks\",\"type\":\"main\",\"index\":0}]]},\"Check if task done\":{\"main\":[[{\"node\":\"Check if dependencies enabled\",\"type\":\"main\",\"index\":0}]]},\"Fetch task changes\":{\"main\":[[{\"node\":\"Split out task changes\",\"type\":\"main\",\"index\":0}]]},\"Build filter params\":{\"main\":[[{\"node\":\"Load all linked tasks\",\"type\":\"main\",\"index\":0}]]},\"Check open subtasks\":{\"main\":[[{\"node\":\"Roll back task status from done to previous state1\",\"type\":\"main\",\"index\":0}]]},\"Add comment to tasks\":{\"main\":[[]]},\"Load all linked tasks\":{\"main\":[[{\"node\":\"Filter only open tasks\",\"type\":\"main\",\"index\":0}]]},\"Webhook call by Awork\":{\"main\":[[{\"node\":\"Workflow config\",\"type\":\"main\",\"index\":0}]]},\"Filter only open tasks\":{\"main\":[[{\"node\":\"Aggregate open task IDs\",\"type\":\"main\",\"index\":0}]]},\"Split out task changes\":{\"main\":[[{\"node\":\"Filter task status change\",\"type\":\"main\",\"index\":0}]]},\"Aggregate open task IDs\":{\"main\":[[{\"node\":\"Check if open tasks exist\",\"type\":\"main\",\"index\":0}]]},\"Load all open sub tasks\":{\"main\":[[{\"node\":\"Aggregate task IDs\",\"type\":\"main\",\"index\":0}]]},\"Check if open tasks exist\":{\"main\":[[{\"node\":\"Roll back task status from done to previous state\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Check if tree structure enabled\",\"type\":\"main\",\"index\":0}]]},\"Filter task status change\":{\"main\":[[{\"node\":\"Check if task done\",\"type\":\"main\",\"index\":0}]]},\"Load dependencies for task\":{\"main\":[[{\"node\":\"Aggregate task dependencies\",\"type\":\"main\",\"index\":0}]]},\"Aggregate task dependencies\":{\"main\":[[{\"node\":\"Build filter params\",\"type\":\"main\",\"index\":0}]]},\"Check if comments are enabled\":{\"main\":[[{\"node\":\"Add comment to tasks\",\"type\":\"main\",\"index\":0}],[]]},\"Check if dependencies enabled\":{\"main\":[[{\"node\":\"Load dependencies for task\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Check if tree structure enabled\",\"type\":\"main\",\"index\":0}]]},\"Check if comments are enabled1\":{\"main\":[[{\"node\":\"Add comment to tasks1\",\"type\":\"main\",\"index\":0}]]},\"Check if tree structure enabled\":{\"main\":[[{\"node\":\"Check subtasks\",\"type\":\"main\",\"index\":0}]]},\"Roll back task status from done to previous state\":{\"main\":[[{\"node\":\"Check if comments are enabled\",\"type\":\"main\",\"index\":0}]]},\"Roll back task status from done to previous state1\":{\"main\":[[{\"node\":\"Check if comments are enabled1\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "Awork currently does not support a check for open subtasks or open dependencies when setting a task status to done. This workflow offers you a simple workaround to add this functionality to Awork and notifies users when triggered. Multiple configuration options available.\n\n**How it works**\n\n  * Triggered via Awork Webhook call on status change of tasks\n  * If task is marked as done, subtasks and/or dependent tasks are checked for their status\n  * If unfinished tasks are found, a status rollback to previous status is performed and user gets notified\n\n\n\n**Set up steps**\n\n  * Add webhook call to Awork\n  * Configure Awork API credentials\n  * Set up workflow configuration via setup node, e.g. user notification text, restrict to subtasks/dependency checks etc.\n\n\n",
  "crawled_at": "2025-05-27T23:10:32.400139",
  "readme_zh": "Awork目前不支持在将任务状态设为完成时检查未完成的子任务或依赖项。本工作流为您提供了一种简单的解决方案，可将此功能添加到Awork中，并在触发时通知用户。提供多种配置选项。\n\n**工作原理**\n\n  * 通过Awork的Webhook调用触发，响应任务状态变更\n  * 若任务被标记为完成，则检查其子任务和/或依赖任务的状态\n  * 若发现未完成任务，则自动回滚至先前状态并通知相关用户\n\n**设置步骤**\n\n  * 在Awork中添加Webhook调用\n  * 配置Awork API凭证\n  * 通过设置节点配置工作流，例如用户通知文本、限定检查范围（仅子任务/依赖项）等",
  "title_zh": "在完成Awork任务前检查依赖项（临时解决方案）",
  "publish_date_zh": "最近更新于一天前",
  "workflow_json_zh": "{\n  \"meta\": {\n    \"instanceId\": \"93fb8727a95622f4aa18b433e7f50b3d9eefa47fbe8901532956ded5db485301\"\n  },\n  \"nodes\": [\n    {\n      \"id\": \"8743a397-a6ca-4325-b0f8-33a34e15b63a\",\n      \"name\": \"Load dependencies for task\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1600,\n        -400\n      ],\n      \"parameters\": {\n        \"url\": \"=https://api.awork.com/api/v1/tasks/{{ $('Webhook call by Awork').item.json.body.entity.id }}/taskdependencies\",\n        \"options\": {},\n        \"authentication\": \"genericCredentialType\",\n        \"genericAuthType\": \"httpHeaderAuth\"\n      },\n      \"credentials\": {\n        \"httpHeaderAuth\": {\n          \"id\": \"9d0FyCu0IlwrdNkM\",\n          \"name\": \"Awork Api\"\n        }\n      },\n      \"retryOnFail\": true,\n      \"typeVersion\": 4.2,\n      \"alwaysOutputData\": true,\n      \"waitBetweenTries\": 2000\n    },\n    {\n      \"id\": \"d3ac4527-eb09-49f5-9bff-7d83e494022d\",\n      \"name\": \"Aggregate task dependencies\",\n      \"type\": \"n8n-nodes-base.aggregate\",\n      \"position\": [\n        1800,\n        -400\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"mergeLists\": true\n        },\n        \"fieldsToAggregate\": {\n          \"fieldToAggregate\": [\n            {\n              \"renameField\": true,\n              \"outputFieldName\": \"taskDependencies\",\n              \"fieldToAggregate\": \"predecessorId\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"1b05f8f7-9451-481d-b2cb-b74c4048f9e0\",\n      \"name\": \"Workflow config\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        -640,\n        0\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"20b87314-585f-4b03-a87d-cc1b9ff1f9c2\",\n              \"name\": \"finishedStateLabels\",\n              \"type\": \"array\",\n              \"value\": \"=[\\\"Fertig\\\",\\\"Total fertig\\\"]\"\n            },\n            {\n              \"id\": \"16f603e2-3703-4f47-a1b9-92503eb1ea43\",\n              \"name\": \"useDependencies\",\n              \"type\": \"boolean\",\n              \"value\": false\n            },\n            {\n              \"id\": \"ffd4703d-be65-4c35-b28c-6cafb1050d13\",\n              \"name\": \"useTreeStructure\",\n              \"type\": \"boolean\",\n              \"value\": true\n            },\n            {\n              \"id\": \"6adacba5-463e-4d5e-9571-54f1a026cb4d\",\n              \"name\": \"addComments\",\n              \"type\": \"boolean\",\n              \"value\": true\n            },\n            {\n              \"id\": \"a06d3f03-8c2d-4788-b986-4bfc2b2a37c5\",\n              \"name\": \"commentTextDependencies\",\n              \"type\": \"string\",\n              \"value\": \"Some dependencies not yet finished! Status rolled back!\"\n            },\n            {\n              \"id\": \"68e0a3f8-5b43-4b1c-b7c8-174abd4c3754\",\n              \"name\": \"commentTextTreeStructure\",\n              \"type\": \"string\",\n              \"value\": \"Some child tasks not yet finished! Status rolled back!\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"a610af8c-a4eb-4fa0-987f-8c001f78de20\",\n      \"name\": \"Fetch task changes\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        -220,\n        0\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"d1e893cd-bdeb-4c9b-8fe0-82dc11c047a7\",\n              \"name\": \"=changes\",\n              \"type\": \"array\",\n              \"value\": \"={{ $('Webhook call by Awork').item.json.body.changes }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"72b495ae-fd9c-4347-ae17-8ba93a3afeb9\",\n      \"name\": \"Split out task changes\",\n      \"type\": \"n8n-nodes-base.splitOut\",\n      \"position\": [\n        0,\n        0\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"fieldToSplitOut\": \"changes\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"a4ec9460-d622-4d4b-a31b-ba3705faa88f\",\n      \"name\": \"Filter task status change\",\n      \"type\": \"n8n-nodes-base.filter\",\n      \"position\": [\n        220,\n        0\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"82923633-648e-4ef0-82dc-cbe35de925b3\",\n              \"operator\": {\n                \"name\": \"filter.operator.equals\",\n                \"type\": \"string\",\n                \"operation\": \"equals\"\n              },\n              \"leftValue\": \"={{ $json.property }}\",\n              \"rightValue\": \"TaskStatusId\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"cc8d6540-122e-48e0-bcf7-91331eea11d4\",\n      \"name\": \"Check if task done\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        620,\n        0\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"e4e5890b-588e-41f1-95c1-02e313fda09a\",\n              \"operator\": {\n                \"type\": \"array\",\n                \"operation\": \"contains\",\n                \"rightType\": \"any\"\n              },\n              \"leftValue\": \"={{ $('Workflow config').item.json.finishedStateLabels }}\",\n              \"rightValue\": \"={{ $('Webhook call by Awork').item.json.body.entity.taskStatus.name }}\"\n            },\n            {\n              \"id\": \"97e159ef-21df-4d1c-bef0-fc7a64ffa0fe\",\n              \"operator\": {\n                \"name\": \"filter.operator.equals\",\n                \"type\": \"string\",\n                \"operation\": \"equals\"\n              },\n              \"leftValue\": \"={{ $('Webhook call by Awork').item.json.body.entity.taskStatus.type }}\",\n              \"rightValue\": \"done\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"0b19f6d1-2821-49ff-8291-933c26165e93\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -1940,\n        -660\n      ],\n      \"parameters\": {\n        \"width\": 880,\n        \"height\": 1440,\n        \"content\": \"## Awork 针对含子任务或依赖项的已完成任务的变通方案\\n\\n目前 [Awork](https://www.awork.com/) **不** 直接支持以下功能：\\n\\n* 若任务包含未完成的子任务，则该任务不应被标记为完成状态\\n* 若任务存在未完成的关联依赖项，则该任务不应被标记为完成状态\\n\\n### 本n8n工作流提供以下功能：\\n\\n* 检查任务所有子任务是否已完成，否则阻止其标记为完成\\n* 检查前置任务是否已完成，否则阻止当前任务标记为完成\\n* 若任务完成条件未满足，工作流将状态回滚至先前状态\\n* 在任务中添加注释说明回滚原因\\n* 本工作流 **不使用** Awork社区节点包（因该包未支持全部API调用）。如需使用该包，可参考 [https://support.awork.com/en/articles/9826591-n8n-integration](https://support.awork.com/en/articles/9826591-n8n-integration) 并替换HTTP节点\\n\\n### \\\"Workflow config\\\"节点（位于webhook调用后）可配置以下参数：\\n\\n* **finishedStateLabels**（必填）：标记为\\\"完成\\\"状态的任务状态标签文本。需以数组形式存储。用于控制特定状态变更时是否跳过工作流。\\n\\n* **useDependencies**（可选）：布尔值，决定是否检查依赖项。若为true，则仅当关联任务完成时当前任务才可标记完成。\\n\\n* **useTreeStructure**（可选）：布尔值，决定是否检查父子任务结构。若为true，则仅当所有子任务完成时父任务才可标记完成。\\n\\n* **addComments**（可选）：布尔值，决定是否在状态回滚时添加注释。\\n\\n* **commentTextDependencies**（addComments为true时必填）：当前任务因未完成依赖项被回滚时添加的提示文本。\\n\\n* **commentTextTreeStructure**（addComments为true时必填）：当前任务因未完成子任务被回滚时添加的提示文本。\\n\\n## 使用指南\\n\\n**Awork配置**\\n\\n* 复制本工作流至n8n环境\\n* 在起始webhook调用节点添加认证凭证\\n\\n* 在Awork添加新webhook（参见 [https://support.awork.com/en/articles/5415462-webhooks](https://support.awork.com/en/articles/5415462-webhooks)）并配置名称/认证等\\n* 设置webhook在任务状态变更时触发\\n* 启用\\\"仅第一层级属性事件\\\"以减少调用次数\\n* 测试并保存webhook\\n\\n* 生成新API客户端（或使用现有）（参见 [https://support.awork.com/en/articles/5415664-client-applications-and-api-keys](https://support.awork.com/en/articles/5415664-client-applications-and-api-keys)）\\n\\n* 在n8n添加Awork凭证（参见 [https://docs.n8n.io/credentials/add-edit-credentials/](https://docs.n8n.io/credentials/add-edit-credentials/)）\\n++ 选择\\\"Header auth\\\"并命名（如\\\"Awork API Access\\\"）\\n++ 设置\\\"name\\\"为\\\"Authorization\\\"，\\\"value\\\"为\\\"Bearer XXX\\\"（XXX替换为Awork生成的API密钥）\\n++ 为所有HTTP请求节点应用凭证（蓝色地球图标）\\n\\n## 开始使用\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"521684a2-f6d7-483a-aa73-bc6243d6bc33\",\n      \"name\": \"Webhook call by Awork\",\n      \"type\": \"n8n-nodes-base.webhook\",\n      \"position\": [\n        -940,\n        0\n      ],\n      \"webhookId\": \"57b88b94-6228-4e49-897d-64bf8c7d32db\",\n      \"parameters\": {\n        \"path\": \"57b88b94-6228-4e49-897d-64bf8c7d32db\",\n        \"options\": {},\n        \"httpMethod\": \"POST\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"00e9ea34-8110-43a4-a0a3-6d95272b7f22\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -740,\n        -100\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 360,\n        \"height\": 280,\n        \"content\": \"### 工作流配置\\n* 配置基本设置\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"ae4ad465-18d5-4a8b-b3ea-05aa9b8d81e3\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -260,\n        -100\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 660,\n        \"height\": 280,\n        \"content\": \"### 从Webhook调用负载中提取状态变更\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"124b4dc0-cc8b-4b10-89c0-fc3db5aa18bf\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        500,\n        -100\n      ],\n      \"parameters\": {\n        \"color\": 3,\n        \"width\": 380,\n        \"height\": 280,\n        \"content\": \"### 检查任务状态是否为“已完成”\\n* 若是，继续执行\\n* 若否，退出工作流程\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"901b5649-3e43-4b03-9c2a-6281ec14cd3d\",\n      \"name\": \"Sticky Note4\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1000,\n        -100\n      ],\n      \"parameters\": {\n        \"color\": 3,\n        \"width\": 380,\n        \"height\": 280,\n        \"content\": \"### 检查是否启用了依赖项\\n* 如果是，处理依赖项\\n* 如果否，检查是否启用了树状结构\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"72cf9e1b-26f4-4132-b760-1b46f5348948\",\n      \"name\": \"Check if dependencies enabled\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        1140,\n        0\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"53d5f2be-2830-4977-a69f-a0d135ea76c4\",\n              \"operator\": {\n                \"type\": \"boolean\",\n                \"operation\": \"true\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $('Workflow config').item.json.useDependencies }}\",\n              \"rightValue\": \"true\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"1475c9e1-d99b-434c-b1e3-8160d25bd834\",\n      \"name\": \"Load all linked tasks\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        2260,\n        -400\n      ],\n      \"parameters\": {\n        \"url\": \"=https://api.awork.com/api/v1/me/projecttasks\",\n        \"options\": {},\n        \"sendQuery\": true,\n        \"authentication\": \"genericCredentialType\",\n        \"genericAuthType\": \"httpHeaderAuth\",\n        \"queryParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"filterby\",\n              \"value\": \"={{ $json.taskDependencies.join(' or ') }}\"\n            }\n          ]\n        }\n      },\n      \"credentials\": {\n        \"httpHeaderAuth\": {\n          \"id\": \"9d0FyCu0IlwrdNkM\",\n          \"name\": \"Awork Api\"\n        }\n      },\n      \"retryOnFail\": true,\n      \"typeVersion\": 4.2,\n      \"alwaysOutputData\": true,\n      \"waitBetweenTries\": 2000\n    },\n    {\n      \"id\": \"4d41c9a6-edae-4a0f-8a06-64c647d4da1a\",\n      \"name\": \"Build filter params\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        2020,\n        -400\n      ],\n      \"parameters\": {\n        \"jsCode\": \"// Loop over input items and add a new field called 'myNewField' to the JSON of each one\\nfor (const item of $input.all()) {\\n  for( var key in item.json.taskDependencies ) {\\n  item.json.taskDependencies[key] = \\\"id eq guid'\\\" + item.json.taskDependencies[key] +\\\"'\\\";\\n}\\n}\\n\\nreturn $input.all();\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"763b71ac-c78b-4020-9fe1-cc80028edfa7\",\n      \"name\": \"Filter only open tasks\",\n      \"type\": \"n8n-nodes-base.filter\",\n      \"position\": [\n        2480,\n        -400\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"8f2bbc21-ad7c-47e2-95b1-f92cb482ea8e\",\n              \"operator\": {\n                \"type\": \"string\",\n                \"operation\": \"notEquals\"\n              },\n              \"leftValue\": \"={{ $json.taskStatus.type }}\",\n              \"rightValue\": \"done\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"7d90188e-859e-450f-922a-e74c9f69646d\",\n      \"name\": \"Aggregate open task IDs\",\n      \"type\": \"n8n-nodes-base.aggregate\",\n      \"position\": [\n        2700,\n        -400\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"fieldsToAggregate\": {\n          \"fieldToAggregate\": [\n            {\n              \"fieldToAggregate\": \"id\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"1aca54ca-3369-456e-942d-ab929879c2a4\",\n      \"name\": \"Sticky Note5\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1560,\n        -500\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 1320,\n        \"height\": 340,\n        \"content\": \"### 加载任务依赖项并筛选未完成任务\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"d1475f48-a06a-4b67-8374-b1f4c6713eb8\",\n      \"name\": \"Sticky Note6\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        2980,\n        -500\n      ],\n      \"parameters\": {\n        \"color\": 3,\n        \"width\": 420,\n        \"height\": 340,\n        \"content\": \"### 检查标记为依赖项的任务是否处于开启状态\\n* 若是，回滚状态。\\n* 若否，则进行树形结构检查。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"86436ab7-7a4d-47c9-ab9f-9d414205baf3\",\n      \"name\": \"Check if open tasks exist\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        3140,\n        -400\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"c30d2bf0-f6ca-46a6-be1e-2f24425fffed\",\n              \"operator\": {\n                \"type\": \"array\",\n                \"operation\": \"notEmpty\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json.id }}\",\n              \"rightValue\": \"\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"3c8971c0-9ad5-4265-add8-9dde8baef83a\",\n      \"name\": \"Sticky Note7\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        3500,\n        -500\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 360,\n        \"height\": 340,\n        \"content\": \"回滚任务状态\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"f5062a59-4067-49f5-9a3a-3087b09a9629\",\n      \"name\": \"Sticky Note8\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        3960,\n        -500\n      ],\n      \"parameters\": {\n        \"color\": 3,\n        \"width\": 400,\n        \"height\": 340,\n        \"content\": \"### 检查是否应向任务添加评论\\n* 若无需添加评论，则退出工作流程\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"6b84e668-7dd8-4ff5-ae98-c2dc6a435c07\",\n      \"name\": \"Check if comments are enabled\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        4120,\n        -400\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"6505de62-2d0a-4a3a-8f33-f0add4364b7e\",\n              \"operator\": {\n                \"type\": \"boolean\",\n                \"operation\": \"true\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $('Workflow config').item.json.addComments }}\",\n              \"rightValue\": \"\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"81f39f77-eacb-4882-9a75-5e01dce04e5c\",\n      \"name\": \"Sticky Note9\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        4460,\n        -500\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 460,\n        \"height\": 340,\n        \"content\": \"### 添加关于任务状态回退的评论\\n* 添加评论并退出工作流程\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"cad1126c-4a60-47e2-8b75-0c2b35464497\",\n      \"name\": \"Add comment to tasks\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        4640,\n        -400\n      ],\n      \"parameters\": {\n        \"url\": \"=https://api.awork.com/api/v1/tasks/{{ $('Webhook call by Awork').item.json.body.entity.id }}/comments\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"jsonBody\": \"={\\n  \\\"message\\\": {{ JSON.stringify($('Workflow config').item.json.commentTextDependencies) }}\\n} \",\n        \"sendBody\": true,\n        \"specifyBody\": \"json\",\n        \"authentication\": \"genericCredentialType\",\n        \"genericAuthType\": \"httpHeaderAuth\"\n      },\n      \"credentials\": {\n        \"httpCustomAuth\": {\n          \"id\": \"CmNSbB7CCq63XJLe\",\n          \"name\": \"Zammad API - TICKET\"\n        },\n        \"httpHeaderAuth\": {\n          \"id\": \"9d0FyCu0IlwrdNkM\",\n          \"name\": \"Awork Api\"\n        }\n      },\n      \"retryOnFail\": true,\n      \"typeVersion\": 4.2,\n      \"waitBetweenTries\": 2000\n    },\n    {\n      \"id\": \"a98ba8ae-05d4-4175-beed-fd9f40c772d3\",\n      \"name\": \"Check if tree structure enabled\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        3600,\n        120\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"53d5f2be-2830-4977-a69f-a0d135ea76c4\",\n              \"operator\": {\n                \"type\": \"boolean\",\n                \"operation\": \"true\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $('Workflow config').item.json.useTreeStructure }}\",\n              \"rightValue\": \"true\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"3464568d-3863-4063-8097-526b60260818\",\n      \"name\": \"Sticky Note11\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        3500,\n        20\n      ],\n      \"parameters\": {\n        \"color\": 3,\n        \"width\": 360,\n        \"height\": 340,\n        \"content\": \"### 检查树形结构检查是否启用\\n* 若未启用则退出工作流程\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"1e2f8502-fc35-4e6f-bb9a-83acb04d57af\",\n      \"name\": \"Sticky Note12\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        3960,\n        20\n      ],\n      \"parameters\": {\n        \"color\": 3,\n        \"width\": 400,\n        \"height\": 340,\n        \"content\": \"### 检查任务是否包含子任务\\n* 若未找到子任务则退出工作流程\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"d25eeac9-c485-4624-8b9f-b7068a4eb0b5\",\n      \"name\": \"Check subtasks\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        4080,\n        100\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"965e2460-236b-4628-b6e9-e4082b656b0f\",\n              \"operator\": {\n                \"type\": \"number\",\n                \"operation\": \"gt\"\n              },\n              \"leftValue\": \"={{ $('Webhook call by Awork').item.json.body.entity.numberOfSubtasks }}\",\n              \"rightValue\": 0\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"6bcac41a-3f06-4a35-9703-fdfba98d1ac4\",\n      \"name\": \"Roll back task status from done to previous state\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        3620,\n        -400\n      ],\n      \"parameters\": {\n        \"url\": \"https://api.awork.com/api/v1/tasks/changestatuses\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"jsonBody\": \"=[\\n  {\\n    \\\"taskId\\\": \\\"{{ $('Webhook call by Awork').item.json.body.entity.id }}\\\",\\n    \\\"statusId\\\": \\\"{{ $('Filter task status change').item.json.old }}\\\" \\n}\\n] \",\n        \"sendBody\": true,\n        \"specifyBody\": \"json\",\n        \"authentication\": \"genericCredentialType\",\n        \"genericAuthType\": \"httpHeaderAuth\"\n      },\n      \"credentials\": {\n        \"httpHeaderAuth\": {\n          \"id\": \"9d0FyCu0IlwrdNkM\",\n          \"name\": \"Awork Api\"\n        }\n      },\n      \"retryOnFail\": true,\n      \"typeVersion\": 4.2,\n      \"waitBetweenTries\": 2000\n    },\n    {\n      \"id\": \"38782806-11a3-4976-8ba6-17da89d7a859\",\n      \"name\": \"Load all open sub tasks\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        4560,\n        100\n      ],\n      \"parameters\": {\n        \"url\": \"=https://api.awork.com/api/v1/me/projecttasks\",\n        \"options\": {},\n        \"sendQuery\": true,\n        \"authentication\": \"genericCredentialType\",\n        \"genericAuthType\": \"httpHeaderAuth\",\n        \"queryParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"filterby\",\n              \"value\": \"=parentid eq guid'{{ $('Webhook call by Awork').item.json.body.entity.id }}' and taskstatus/type ne 'done'\"\n            }\n          ]\n        }\n      },\n      \"credentials\": {\n        \"httpHeaderAuth\": {\n          \"id\": \"9d0FyCu0IlwrdNkM\",\n          \"name\": \"Awork Api\"\n        }\n      },\n      \"typeVersion\": 4.2,\n      \"alwaysOutputData\": true\n    },\n    {\n      \"id\": \"ad23f9c2-bdb4-48b7-ad6b-776424c0275d\",\n      \"name\": \"Aggregate task IDs\",\n      \"type\": \"n8n-nodes-base.aggregate\",\n      \"position\": [\n        4780,\n        100\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"fieldsToAggregate\": {\n          \"fieldToAggregate\": [\n            {\n              \"fieldToAggregate\": \"id\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"711fd327-892a-48e2-95ea-24a21cba1765\",\n      \"name\": \"Sticky Note10\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        4460,\n        20\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 500,\n        \"height\": 340,\n        \"content\": \"### 加载未标记为完成的任务\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"fe844b55-800d-426c-9842-ccb8cc0d33f3\",\n      \"name\": \"Sticky Note14\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        5060,\n        20\n      ],\n      \"parameters\": {\n        \"color\": 3,\n        \"width\": 400,\n        \"height\": 340,\n        \"content\": \"### 检查是否存在未完成的子任务\\n* 若未找到未完成的子任务，则退出工作流程\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"946243b8-ceaa-4ce3-a4d1-97bc3ee9f9ed\",\n      \"name\": \"Check open subtasks\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        5180,\n        100\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"f1c49c95-5272-4414-99f6-55e146a33ae2\",\n              \"operator\": {\n                \"type\": \"array\",\n                \"operation\": \"lengthGt\",\n                \"rightType\": \"number\"\n              },\n              \"leftValue\": \"={{ $json.id }}\",\n              \"rightValue\": 0\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"e4e43d31-a7c1-404c-a67a-21236314f46c\",\n      \"name\": \"Sticky Note15\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        5580,\n        20\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 360,\n        \"height\": 340,\n        \"content\": \"### 回滚任务状态\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"7065d3b2-f120-4636-b30e-d919d4ca47c8\",\n      \"name\": \"Sticky Note16\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        6040,\n        20\n      ],\n      \"parameters\": {\n        \"color\": 3,\n        \"width\": 400,\n        \"height\": 340,\n        \"content\": \"### 检查是否应向任务添加评论\\n* 若无需添加评论，则退出工作流程\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"e4b9348e-de14-425a-b9ed-64891681c49a\",\n      \"name\": \"Check if comments are enabled1\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        6200,\n        120\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"6505de62-2d0a-4a3a-8f33-f0add4364b7e\",\n              \"operator\": {\n                \"type\": \"boolean\",\n                \"operation\": \"true\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $('Workflow config').item.json.addComments }}\",\n              \"rightValue\": \"\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"e01f0f8a-d844-4f51-8c38-044d1be4c3b3\",\n      \"name\": \"Sticky Note17\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        6540,\n        20\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 460,\n        \"height\": 340,\n        \"content\": \"### 添加关于任务状态回退的评论\\n* 添加评论并退出工作流程\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"65c7656e-f03e-4082-8226-34a052fbdc38\",\n      \"name\": \"Add comment to tasks1\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        6720,\n        120\n      ],\n      \"parameters\": {\n        \"url\": \"=https://api.awork.com/api/v1/tasks/{{ $('Webhook call by Awork').item.json.body.entity.id }}/comments\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"jsonBody\": \"={\\n  \\\"message\\\": {{ JSON.stringify($('Workflow config').item.json.commentTextTreeStructure) }}\\n} \",\n        \"sendBody\": true,\n        \"specifyBody\": \"json\",\n        \"authentication\": \"genericCredentialType\",\n        \"genericAuthType\": \"httpHeaderAuth\"\n      },\n      \"credentials\": {\n        \"httpCustomAuth\": {\n          \"id\": \"CmNSbB7CCq63XJLe\",\n          \"name\": \"Zammad API - TICKET\"\n        },\n        \"httpHeaderAuth\": {\n          \"id\": \"9d0FyCu0IlwrdNkM\",\n          \"name\": \"Awork Api\"\n        }\n      },\n      \"retryOnFail\": true,\n      \"typeVersion\": 4.2,\n      \"waitBetweenTries\": 2000\n    },\n    {\n      \"id\": \"0521eaf8-0719-4691-be1d-82a6defa87ca\",\n      \"name\": \"Roll back task status from done to previous state1\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        5700,\n        120\n      ],\n      \"parameters\": {\n        \"url\": \"https://api.awork.com/api/v1/tasks/changestatuses\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"jsonBody\": \"=[\\n  {\\n    \\\"taskId\\\": \\\"{{ $('Webhook call by Awork').item.json.body.entity.id }}\\\",\\n    \\\"statusId\\\": \\\"{{ $('Filter task status change').item.json.old }}\\\" \\n}\\n] \",\n        \"sendBody\": true,\n        \"specifyBody\": \"json\",\n        \"authentication\": \"genericCredentialType\",\n        \"genericAuthType\": \"httpHeaderAuth\"\n      },\n      \"credentials\": {\n        \"httpHeaderAuth\": {\n          \"id\": \"9d0FyCu0IlwrdNkM\",\n          \"name\": \"Awork Api\"\n        }\n      },\n      \"retryOnFail\": true,\n      \"typeVersion\": 4.2,\n      \"waitBetweenTries\": 2000\n    },\n    {\n      \"id\": \"0a266961-2e39-4508-a37e-9a5ec6811466\",\n      \"name\": \"Sticky Note13\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -740,\n        -660\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 280,\n        \"content\": \"## 绿色便利贴：节点的逻辑分组\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"a2014e67-29c9-49fb-86eb-0e5fe0969455\",\n      \"name\": \"Sticky Note18\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -380,\n        -660\n      ],\n      \"parameters\": {\n        \"color\": 3,\n        \"width\": 280,\n        \"content\": \"## 红色便签：路由及可能的工作流退出\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"pinData\": {},\n  \"connections\": {\n    \"Check subtasks\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Load all open sub tasks\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Workflow config\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Fetch task changes\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Aggregate task IDs\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Check open subtasks\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Check if task done\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Check if dependencies enabled\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Fetch task changes\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Split out task changes\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Build filter params\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Load all linked tasks\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Check open subtasks\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Roll back task status from done to previous state1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Add comment to tasks\": {\n      \"main\": [\n        []\n      ]\n    },\n    \"Load all linked tasks\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Filter only open tasks\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Webhook call by Awork\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Workflow config\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Filter only open tasks\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Aggregate open task IDs\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Split out task changes\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Filter task status change\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Aggregate open task IDs\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Check if open tasks exist\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Load all open sub tasks\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Aggregate task IDs\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Check if open tasks exist\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Roll back task status from done to previous state\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Check if tree structure enabled\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Filter task status change\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Check if task done\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Load dependencies for task\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Aggregate task dependencies\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Aggregate task dependencies\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Build filter params\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Check if comments are enabled\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Add comment to tasks\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        []\n      ]\n    },\n    \"Check if dependencies enabled\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Load dependencies for task\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Check if tree structure enabled\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Check if comments are enabled1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Add comment to tasks1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Check if tree structure enabled\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Check subtasks\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Roll back task status from done to previous state\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Check if comments are enabled\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Roll back task status from done to previous state1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Check if comments are enabled1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}