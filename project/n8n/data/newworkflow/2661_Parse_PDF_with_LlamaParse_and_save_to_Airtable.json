{
  "url": "https://n8n.io/workflows/2661-parse-pdf-with-llamaparse-and-save-to-airtable/",
  "title": "Parse PDF with LlamaParse and save to Airtable",
  "author": "Mark Shcherbakov",
  "publish_date": "Last update 5 months ago",
  "publish_date_absolute": "2024-12-26",
  "categories": [
    {
      "name": "AI"
    }
  ],
  "workflow_json": "{\"nodes\":[{\"id\":\"9df72ef9-3b9d-40e4-9cb5-a5ada153c0bb\",\"name\":\"Google Drive\",\"type\":\"n8n-nodes-base.googleDrive\",\"position\":[120,-180],\"parameters\":{\"fileId\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"={{ $json.id }}\"},\"options\":{},\"operation\":\"download\"},\"credentials\":{\"googleDriveOAuth2Api\":{\"id\":\"wpiZXesxk9S8fkVG\",\"name\":\"Google Drive account 2\"}},\"typeVersion\":3},{\"id\":\"e21bb906-658c-4a52-9c7b-b77d6e0e7ea5\",\"name\":\"Upload File\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[360,-180],\"parameters\":{\"url\":\"https://api.cloud.llamaindex.ai/api/parsing/upload\",\"method\":\"POST\",\"options\":{},\"sendBody\":true,\"contentType\":\"multipart-form-data\",\"sendHeaders\":true,\"bodyParameters\":{\"parameters\":[{\"name\":\"webhook_url\",\"value\":\"https://n8n.lowcoding.dev/webhook/0f7f5ebb-8b66-453b-a818-20cc3647c783\"},{\"name\":\"file\",\"parameterType\":\"formBinaryData\",\"inputDataFieldName\":\"data\"},{\"name\":\"disable_ocr\",\"value\":\"true\"},{\"name\":\"disable_image_extraction\",\"value\":\"True\"}]},\"headerParameters\":{\"parameters\":[{\"name\":\"accept\",\"value\":\"application/json\"},{\"name\":\"Authorization\",\"value\":\"Bearer \"},{\"name\":\"parsing_instruction\",\"value\":\"Please extract invoice line items: Name, Quantity, Unit Price, Amount \"}]}},\"typeVersion\":4.2},{\"id\":\"2a0c2331-4612-4b92-a0cc-b316bc663907\",\"name\":\"Google Drive Trigger\",\"type\":\"n8n-nodes-base.googleDriveTrigger\",\"position\":[-80,-180],\"parameters\":{\"event\":\"fileCreated\",\"options\":{},\"pollTimes\":{\"item\":[{\"mode\":\"everyMinute\"}]},\"triggerOn\":\"specificFolder\",\"folderToWatch\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"1IC39VXU8rewBU85offxYlBd9QlYzf8S7\",\"cachedResultUrl\":\"https://drive.google.com/drive/folders/1IC39VXU8rewBU85offxYlBd9QlYzf8S7\",\"cachedResultName\":\"Invoices\"}},\"credentials\":{\"googleDriveOAuth2Api\":{\"id\":\"wpiZXesxk9S8fkVG\",\"name\":\"Google Drive account 2\"}},\"typeVersion\":1},{\"id\":\"4ad70b03-54f1-4715-9848-56fa6ba18278\",\"name\":\"Create Invoice\",\"type\":\"n8n-nodes-base.airtable\",\"position\":[400,340],\"parameters\":{\"base\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"appndgSF4faN4jPXi\",\"cachedResultUrl\":\"https://airtable.com/appndgSF4faN4jPXi\",\"cachedResultName\":\"Philipp's Base\"},\"table\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"tbloPc7Eay4Cvwysq\",\"cachedResultUrl\":\"https://airtable.com/appndgSF4faN4jPXi/tbloPc7Eay4Cvwysq\",\"cachedResultName\":\"Invoices\"},\"columns\":{\"value\":{},\"schema\":[{\"id\":\"Name\",\"type\":\"string\",\"display\":true,\"removed\":true,\"readOnly\":false,\"required\":false,\"displayName\":\"Name\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Line Items\",\"type\":\"array\",\"display\":true,\"removed\":true,\"readOnly\":false,\"required\":false,\"displayName\":\"Line Items\",\"defaultMatch\":false,\"canBeUsedToMatch\":true}],\"mappingMode\":\"defineBelow\",\"matchingColumns\":[]},\"options\":{},\"operation\":\"create\"},\"credentials\":{\"airtableTokenApi\":{\"id\":\"XT7hvl1w201jtBhx\",\"name\":\"Airtable Personal Access Token account\"}},\"typeVersion\":2.1},{\"id\":\"a408eeb4-2dc2-45ff-a989-92676356f596\",\"name\":\"Create Line Item\",\"type\":\"n8n-nodes-base.airtable\",\"position\":[800,340],\"parameters\":{\"base\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"appndgSF4faN4jPXi\",\"cachedResultUrl\":\"https://airtable.com/appndgSF4faN4jPXi\",\"cachedResultName\":\"Philipp's Base\"},\"table\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"tblIuVR9ocAomznzK\",\"cachedResultUrl\":\"https://airtable.com/appndgSF4faN4jPXi/tblIuVR9ocAomznzK\",\"cachedResultName\":\"Line Items\"},\"columns\":{\"value\":{\"Qty\":\"={{ $json.qty }}\",\"Amount\":\"={{ parseFloat($json.amount.replace('$', '').trim()) }}\",\"Invoices\":\"=[\\\"{{ $('Create Invoice').item.json.id }}\\\"]\",\"Unit price\":\"={{ parseFloat($json.unit_price.replace('$', '').trim()) }}\",\"Description\":\"={{ $json.description }}\"},\"schema\":[{\"id\":\"Name\",\"type\":\"string\",\"display\":true,\"removed\":true,\"readOnly\":false,\"required\":false,\"displayName\":\"Name\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Description\",\"type\":\"string\",\"display\":true,\"removed\":false,\"readOnly\":false,\"required\":false,\"displayName\":\"Description\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Qty\",\"type\":\"number\",\"display\":true,\"removed\":false,\"readOnly\":false,\"required\":false,\"displayName\":\"Qty\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Unit price\",\"type\":\"number\",\"display\":true,\"removed\":false,\"readOnly\":false,\"required\":false,\"displayName\":\"Unit price\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Amount\",\"type\":\"number\",\"display\":true,\"removed\":false,\"readOnly\":false,\"required\":false,\"displayName\":\"Amount\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Invoices\",\"type\":\"array\",\"display\":true,\"removed\":false,\"readOnly\":false,\"required\":false,\"displayName\":\"Invoices\",\"defaultMatch\":false,\"canBeUsedToMatch\":true}],\"mappingMode\":\"defineBelow\",\"matchingColumns\":[]},\"options\":{},\"operation\":\"create\"},\"credentials\":{\"airtableTokenApi\":{\"id\":\"XT7hvl1w201jtBhx\",\"name\":\"Airtable Personal Access Token account\"}},\"typeVersion\":2.1},{\"id\":\"7ee324e8-6df3-48d6-b1b8-6fdb610b1ec7\",\"name\":\"OpenAI - Extract Line Items\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[180,340],\"parameters\":{\"url\":\"=https://api.openai.com/v1/chat/completions\",\"method\":\"POST\",\"options\":{},\"jsonBody\":\"={\\n    \\\"model\\\": \\\"gpt-4o-mini\\\",\\n    \\\"messages\\\": [\\n      {\\n        \\\"role\\\": \\\"system\\\",\\n        \\\"content\\\": {{ JSON.stringify($('Set Fields').item.json.prompt) }}\\n      },\\n      {\\n        \\\"role\\\": \\\"user\\\",\\n        \\\"content\\\": {{ JSON.stringify( JSON.stringify($('Webhook').item.json.body.json[0].items) ) }}\\n      }\\n    ],\\n  \\\"response_format\\\":{ \\\"type\\\": \\\"json_schema\\\", \\\"json_schema\\\":  {{ $('Set Fields').item.json.schema }}\\n\\n }\\n  }\",\"sendBody\":true,\"specifyBody\":\"json\",\"authentication\":\"predefinedCredentialType\",\"nodeCredentialType\":\"openAiApi\"},\"credentials\":{\"openAiApi\":{\"id\":\"9RivS2BmSh1DDBFm\",\"name\":\"OpenAi account 3\"}},\"typeVersion\":4.2},{\"id\":\"eda31919-9091-4d45-bd73-4609b71f93a9\",\"name\":\"Set Fields\",\"type\":\"n8n-nodes-base.set\",\"position\":[-40,340],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"dc09a5b4-ff6a-4cee-b87e-35de7336ac05\",\"name\":\"prompt\",\"type\":\"string\",\"value\":\"Please, process parsed data and return only needed.\"},{\"id\":\"4e0f9af6-517f-42af-9ced-df0e8a7118b0\",\"name\":\"schema\",\"type\":\"string\",\"value\":\"={\\n  \\\"name\\\": \\\"generate_schema\\\",\\n  \\\"description\\\": \\\"Generate schema for an array of objects representing items with their descriptions, quantities, unit prices, and amounts.\\\",\\n  \\\"strict\\\": true,\\n  \\\"schema\\\": {\\n    \\\"type\\\": \\\"object\\\",\\n    \\\"required\\\": [\\n      \\\"items\\\"\\n    ],\\n    \\\"properties\\\": {\\n      \\\"items\\\": {\\n        \\\"type\\\": \\\"array\\\",\\n        \\\"description\\\": \\\"Array of item objects\\\",\\n        \\\"items\\\": {\\n          \\\"type\\\": \\\"object\\\",\\n          \\\"required\\\": [\\n            \\\"description\\\",\\n            \\\"qty\\\",\\n            \\\"unit_price\\\",\\n            \\\"amount\\\"\\n          ],\\n          \\\"properties\\\": {\\n            \\\"description\\\": {\\n              \\\"type\\\": \\\"string\\\",\\n              \\\"description\\\": \\\"Description of the item\\\"\\n            },\\n            \\\"qty\\\": {\\n              \\\"type\\\": \\\"string\\\",\\n              \\\"description\\\": \\\"Quantity of the item\\\"\\n            },\\n            \\\"unit_price\\\": {\\n              \\\"type\\\": \\\"string\\\",\\n              \\\"description\\\": \\\"Unit price of the item formatted as a string\\\"\\n            },\\n            \\\"amount\\\": {\\n              \\\"type\\\": \\\"string\\\",\\n              \\\"description\\\": \\\"Total amount for the item formatted as a string\\\"\\n            }\\n          },\\n          \\\"additionalProperties\\\": false\\n        }\\n      }\\n    },\\n    \\\"additionalProperties\\\": false\\n  }\\n}\"}]}},\"typeVersion\":3.4},{\"id\":\"cc0d97d8-fb62-43eb-b484-4dd39f8db4b4\",\"name\":\"Process Line Items\",\"type\":\"n8n-nodes-base.code\",\"position\":[600,340],\"parameters\":{\"jsCode\":\"// Get the input from the \\\"OpenAI - Extract Line Items\\\" node\\nconst input = $(\\\"OpenAI - Extract Line Items\\\").first().json;\\n\\n// Initialize an array for the output\\nconst outputItems = [];\\n\\n// Navigate to the 'content' field in the choices array\\nconst content = input.choices[0]?.message?.content;\\n\\nif (content) {\\n  try {\\n    // Parse the stringified JSON in the 'content' field\\n    const parsedContent = JSON.parse(content);\\n\\n    // Extract 'items' and add them to the output array\\n    if (Array.isArray(parsedContent.items)) {\\n      outputItems.push(...parsedContent.items.map(i => ({ json: i })));\\n    }\\n  } catch (error) {\\n    // Handle any parsing errors\\n    console.error('Error parsing content:', error);\\n  }\\n}\\n\\n// Return the extracted items\\nreturn outputItems;\\n\"},\"typeVersion\":2},{\"id\":\"741dc44e-6d47-4a77-80c2-5e18b291da33\",\"name\":\"Webhook\",\"type\":\"n8n-nodes-base.webhook\",\"position\":[-220,340],\"webhookId\":\"0f7f5ebb-8b66-453b-a818-20cc3647c783\",\"parameters\":{\"path\":\"0f7f5ebb-8b66-453b-a818-20cc3647c783\",\"options\":{},\"httpMethod\":\"POST\"},\"typeVersion\":2},{\"id\":\"fbc196c8-7518-4deb-ac47-f37f1b8150eb\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-260,-300],\"parameters\":{\"width\":920,\"height\":400,\"content\":\"## Scenario 1\\n\\n\"},\"typeVersion\":1},{\"id\":\"96368d41-7886-487f-a8a7-e4dac3b01f45\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-280,240],\"parameters\":{\"width\":1340,\"height\":460,\"content\":\"## Scenario 2\\n\\n\"},\"typeVersion\":1},{\"id\":\"6b7c94d7-c844-4246-ba1a-cea5937792db\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-60,0],\"parameters\":{\"color\":3,\"width\":270,\"height\":80,\"content\":\"### Replace Google Drive connection\"},\"typeVersion\":1},{\"id\":\"9c8141d0-428a-44e5-b900-b07fa64db4f5\",\"name\":\"Sticky Note3\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[320,0],\"parameters\":{\"color\":3,\"width\":170,\"height\":80,\"content\":\"### Replace API key in header\"},\"typeVersion\":1},{\"id\":\"48243fe4-4ed1-43dc-b508-8b3f9472bb67\",\"name\":\"Sticky Note4\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[140,540],\"parameters\":{\"color\":3,\"width\":170,\"height\":80,\"content\":\"### Replace OpenAI connection\"},\"typeVersion\":1},{\"id\":\"ffc6b530-69ab-4ccb-945d-94f8fdc1e3ab\",\"name\":\"Sticky Note5\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[400,540],\"parameters\":{\"color\":3,\"width\":530,\"height\":80,\"content\":\"### Replace Airtable connection\"},\"typeVersion\":1},{\"id\":\"15047f43-5f7e-4c70-a754-fffb41c04611\",\"name\":\"Sticky Note9\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-760,380],\"parameters\":{\"color\":7,\"width\":330.5152611046425,\"height\":239.5888196628349,\"content\":\"### ... or watch set up video [7 min]\\n[![Youtube Thumbnail](https://cflobdhpqwnoisuctsoc.supabase.co/storage/v1/object/public/my_storage/Video%2010%20-%20Parser%20invoices%20Blur.png)](https://youtu.be/E4I0nru-fa8)\\n\"},\"typeVersion\":1},{\"id\":\"812f6cc7-a093-41d0-9750-48253d9f04a8\",\"name\":\"Sticky Note7\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-1060,-300],\"parameters\":{\"color\":7,\"width\":636,\"height\":657,\"content\":\"![5min Logo](https://cflobdhpqwnoisuctsoc.supabase.co/storage/v1/object/public/my_storage/banner.png)\\n## AI Agent for realtime insights on meetings\\n**Made by [Mark Shcherbakov](https://www.linkedin.com/in/marklowcoding/) from community [5minAI](https://www.skool.com/5minai)**\\n\\nTranscribing meetings manually can be tedious and prone to error. This workflow automates the transcription process in real-time, ensuring that key discussions and decisions are accurately captured and easily accessible for later review, thus enhancing productivity and clarity in communications.\\n\\nThe workflow leverages n8n and LlamaParse to automatically detect new invoices in a designated Google Drive folder, parse essential billing details, and store the extracted data in a structured format. The key functionalities include:\\n- Real-time detection of new invoices via Google Drive triggers.\\n- Automated HTTP requests to initiate parsing through Lama Cloud.\\n- Structured storage of invoice details and line items in a database for future reference.\\n\\n1. **Google Drive Integration**: Monitors a specific folder in Google Drive for new invoice uploads.\\n2. **Parsing with LlamaParse**: Automatically sends invoices for parsing and processes results through webhooks.\\n3. **Data Storage in Airtable**: Creates records for invoices and their associated line items, allowing for detailed tracking.\"},\"typeVersion\":1},{\"id\":\"a80e6528-cf79-4229-8c58-6856fd86b6e7\",\"name\":\"Sticky Note6\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-1060,380],\"parameters\":{\"color\":7,\"width\":280,\"height\":626,\"content\":\"### Set up steps\\n\\n1. **Google Drive Trigger**: \\n   - Set up a trigger to detect new files in a specified folder dedicated to invoices.\\n\\n2. **File Upload to LlamaParse**: \\n   - Create an HTTP request that sends the invoice file to LlamaParse for parsing, including relevant header settings and webhook URL.\\n\\n3. **Webhook Processing**: \\n   - Establish a webhook node to handle parsed results from LlamaParse, extracting needed invoice details effectively.\\n\\n4. **Invoice Record Creation**: \\n   - Create initial records for invoices in your database using the parsed details received from the webhook.\\n\\n5. **Line Item Processing**: \\n   - Transform string data into structured line item arrays and create individual records for each item linked to the main invoice.\"},\"typeVersion\":1}],\"pinData\":{},\"connections\":{\"Webhook\":{\"main\":[[{\"node\":\"Set Fields\",\"type\":\"main\",\"index\":0}]]},\"Set Fields\":{\"main\":[[{\"node\":\"OpenAI - Extract Line Items\",\"type\":\"main\",\"index\":0}]]},\"Google Drive\":{\"main\":[[{\"node\":\"Upload File\",\"type\":\"main\",\"index\":0}]]},\"Create Invoice\":{\"main\":[[{\"node\":\"Process Line Items\",\"type\":\"main\",\"index\":0}]]},\"Process Line Items\":{\"main\":[[{\"node\":\"Create Line Item\",\"type\":\"main\",\"index\":0}]]},\"Google Drive Trigger\":{\"main\":[[{\"node\":\"Google Drive\",\"type\":\"main\",\"index\":0}]]},\"OpenAI - Extract Line Items\":{\"main\":[[{\"node\":\"Create Invoice\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "### Video Guide\n\nI prepared a comprehensive guide detailing how to automate the parsing of invoices using n8n and LlamaParse, seamlessly capturing and storing vital billing information.\n\n[![Youtube Thumbnail](https://cflobdhpqwnoisuctsoc.supabase.co/storage/v1/object/public/my_storage/Video%2010%20-%20Parser%20invoices%20Blur.png)](https://youtu.be/E4I0nru-fa8)\n\n[Youtube Link](https://youtu.be/E4I0nru-fa8)\n\n### Who is this for?\n\nThis workflow is ideal for finance teams, accountants, and business operations managers who need to streamline invoice processing. It is particularly helpful for organizations seeking to reduce manual entry errors and improve efficiency in managing billing information.\n\n### What problem does this workflow solve?\n\nManually processing invoices can be time-consuming and error-prone. This automation eliminates the need for manual data entry by capturing invoice details directly from uploaded documents and storing structured data efficiently. This enhances productivity and accuracy across financial operations.\n\n### What this workflow does\n\nThe workflow leverages n8n and LlamaParse to automatically detect new invoices in a designated Google Drive folder, parse essential billing details, and store the extracted data in a structured format. The key functionalities include:\n\n  * Real-time detection of new invoices via Google Drive triggers.\n  * Automated HTTP requests to initiate parsing through Lama Cloud.\n  * Structured storage of invoice details and line items in a database for future reference.\n\n\n  1. **Google Drive Integration** : Monitors a specific folder in Google Drive for new invoice uploads.\n  2. **Parsing with LlamaParse** : Automatically sends invoices for parsing and processes results through webhooks.\n  3. **Data Storage in Airtable** : Creates records for invoices and their associated line items, allowing for detailed tracking.\n\n\n\n### Setup\n\n#### N8N Workflow\n\n  1. **Google Drive Trigger** :\n\n     * Set up a trigger to detect new files in a specified folder dedicated to invoices.\n  2. **File Upload to LlamaParse** :\n\n     * Create an HTTP request that sends the invoice file to LlamaParse for parsing, including relevant header settings and webhook URL.\n  3. **Webhook Processing** :\n\n     * Establish a webhook node to handle parsed results from LlamaParse, extracting needed invoice details effectively.\n  4. **Invoice Record Creation** :\n\n     * Create initial records for invoices in your database using the parsed details received from the webhook.\n  5. **Line Item Processing** :\n\n     * Transform string data into structured line item arrays and create individual records for each item linked to the main invoice.\n\n\n",
  "crawled_at": "2025-05-26T01:38:06.647183",
  "readme_zh": "### 视频教程\n\n我制作了一份详细指南，介绍如何利用n8n和LlamaParse实现发票自动解析，无缝捕获并存储关键账单信息。\n\n[![YouTube缩略图](https://cflobdhpqwnoisuctsoc.supabase.co/storage/v1/object/public/my_storage/Video%2010%20-%20Parser%20invoices%20Blur.png)](https://youtu.be/E4I0nru-fa8)\n\n[YouTube视频链接](https://youtu.be/E4I0nru-fa8)\n\n### 适用人群\n\n本流程特别适合财务团队、会计人员和业务运营经理，他们需要简化发票处理流程。对于希望减少人工录入错误、提升账单信息管理效率的组织尤为实用。\n\n### 解决什么问题？\n\n人工处理发票耗时且易错。该自动化方案通过直接从上传文档捕获发票信息并高效存储结构化数据，消除了手动录入需求，从而提升财务工作的生产力和准确性。\n\n### 流程功能\n\n该工作流结合n8n与LlamaParse实现以下功能：\n- 实时监测Google Drive指定文件夹中的新发票\n- 通过Lama Cloud自动发起解析请求\n- 将发票详情及明细条目结构化存储\n\n核心模块：\n1. **Google Drive集成**：监控指定文件夹的新发票上传\n2. **LlamaParse解析**：自动发送发票解析并通过webhook处理结果\n3. **Airtable数据存储**：创建发票主记录及关联明细条目，支持详细追踪\n\n### 配置说明\n\n#### n8n工作流设置\n1. **Google Drive触发器**：\n   - 设置监测指定发票文件夹的文件新增\n2. **文件上传至LlamaParse**：\n   - 配置HTTP请求节点，包含请求头与webhook地址\n3. **Webhook数据处理**：\n   - 建立webhook节点处理解析结果\n4. **发票记录创建**：\n   - 根据解析结果在数据库创建主记录\n5. **明细条目处理**：\n   - 转换字符串为结构化数组，创建与主发票关联的明细记录",
  "title_zh": "使用LlamaParse解析PDF并保存至Airtable",
  "publish_date_zh": "最后更新于4个月前",
  "workflow_json_zh": "{\n  \"nodes\": [\n    {\n      \"id\": \"9df72ef9-3b9d-40e4-9cb5-a5ada153c0bb\",\n      \"name\": \"Google Drive\",\n      \"type\": \"n8n-nodes-base.googleDrive\",\n      \"position\": [\n        120,\n        -180\n      ],\n      \"parameters\": {\n        \"fileId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $json.id }}\"\n        },\n        \"options\": {},\n        \"operation\": \"download\"\n      },\n      \"credentials\": {\n        \"googleDriveOAuth2Api\": {\n          \"id\": \"wpiZXesxk9S8fkVG\",\n          \"name\": \"Google Drive account 2\"\n        }\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"e21bb906-658c-4a52-9c7b-b77d6e0e7ea5\",\n      \"name\": \"Upload File\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        360,\n        -180\n      ],\n      \"parameters\": {\n        \"url\": \"https://api.cloud.llamaindex.ai/api/parsing/upload\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"sendBody\": true,\n        \"contentType\": \"multipart-form-data\",\n        \"sendHeaders\": true,\n        \"bodyParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"webhook_url\",\n              \"value\": \"https://n8n.lowcoding.dev/webhook/0f7f5ebb-8b66-453b-a818-20cc3647c783\"\n            },\n            {\n              \"name\": \"file\",\n              \"parameterType\": \"formBinaryData\",\n              \"inputDataFieldName\": \"data\"\n            },\n            {\n              \"name\": \"disable_ocr\",\n              \"value\": \"true\"\n            },\n            {\n              \"name\": \"disable_image_extraction\",\n              \"value\": \"True\"\n            }\n          ]\n        },\n        \"headerParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"accept\",\n              \"value\": \"application/json\"\n            },\n            {\n              \"name\": \"Authorization\",\n              \"value\": \"Bearer \"\n            },\n            {\n              \"name\": \"parsing_instruction\",\n              \"value\": \"Please extract invoice line items: Name, Quantity, Unit Price, Amount \"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"2a0c2331-4612-4b92-a0cc-b316bc663907\",\n      \"name\": \"Google Drive Trigger\",\n      \"type\": \"n8n-nodes-base.googleDriveTrigger\",\n      \"position\": [\n        -80,\n        -180\n      ],\n      \"parameters\": {\n        \"event\": \"fileCreated\",\n        \"options\": {},\n        \"pollTimes\": {\n          \"item\": [\n            {\n              \"mode\": \"everyMinute\"\n            }\n          ]\n        },\n        \"triggerOn\": \"specificFolder\",\n        \"folderToWatch\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"1IC39VXU8rewBU85offxYlBd9QlYzf8S7\",\n          \"cachedResultUrl\": \"https://drive.google.com/drive/folders/1IC39VXU8rewBU85offxYlBd9QlYzf8S7\",\n          \"cachedResultName\": \"Invoices\"\n        }\n      },\n      \"credentials\": {\n        \"googleDriveOAuth2Api\": {\n          \"id\": \"wpiZXesxk9S8fkVG\",\n          \"name\": \"Google Drive account 2\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"4ad70b03-54f1-4715-9848-56fa6ba18278\",\n      \"name\": \"Create Invoice\",\n      \"type\": \"n8n-nodes-base.airtable\",\n      \"position\": [\n        400,\n        340\n      ],\n      \"parameters\": {\n        \"base\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"appndgSF4faN4jPXi\",\n          \"cachedResultUrl\": \"https://airtable.com/appndgSF4faN4jPXi\",\n          \"cachedResultName\": \"Philipp's Base\"\n        },\n        \"table\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"tbloPc7Eay4Cvwysq\",\n          \"cachedResultUrl\": \"https://airtable.com/appndgSF4faN4jPXi/tbloPc7Eay4Cvwysq\",\n          \"cachedResultName\": \"Invoices\"\n        },\n        \"columns\": {\n          \"value\": {},\n          \"schema\": [\n            {\n              \"id\": \"Name\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": true,\n              \"readOnly\": false,\n              \"required\": false,\n              \"displayName\": \"Name\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Line Items\",\n              \"type\": \"array\",\n              \"display\": true,\n              \"removed\": true,\n              \"readOnly\": false,\n              \"required\": false,\n              \"displayName\": \"Line Items\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            }\n          ],\n          \"mappingMode\": \"defineBelow\",\n          \"matchingColumns\": []\n        },\n        \"options\": {},\n        \"operation\": \"create\"\n      },\n      \"credentials\": {\n        \"airtableTokenApi\": {\n          \"id\": \"XT7hvl1w201jtBhx\",\n          \"name\": \"Airtable Personal Access Token account\"\n        }\n      },\n      \"typeVersion\": 2.1\n    },\n    {\n      \"id\": \"a408eeb4-2dc2-45ff-a989-92676356f596\",\n      \"name\": \"Create Line Item\",\n      \"type\": \"n8n-nodes-base.airtable\",\n      \"position\": [\n        800,\n        340\n      ],\n      \"parameters\": {\n        \"base\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"appndgSF4faN4jPXi\",\n          \"cachedResultUrl\": \"https://airtable.com/appndgSF4faN4jPXi\",\n          \"cachedResultName\": \"Philipp's Base\"\n        },\n        \"table\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"tblIuVR9ocAomznzK\",\n          \"cachedResultUrl\": \"https://airtable.com/appndgSF4faN4jPXi/tblIuVR9ocAomznzK\",\n          \"cachedResultName\": \"Line Items\"\n        },\n        \"columns\": {\n          \"value\": {\n            \"Qty\": \"={{ $json.qty }}\",\n            \"Amount\": \"={{ parseFloat($json.amount.replace('$', '').trim()) }}\",\n            \"Invoices\": \"=[\\\"{{ $('Create Invoice').item.json.id }}\\\"]\",\n            \"Unit price\": \"={{ parseFloat($json.unit_price.replace('$', '').trim()) }}\",\n            \"Description\": \"={{ $json.description }}\"\n          },\n          \"schema\": [\n            {\n              \"id\": \"Name\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": true,\n              \"readOnly\": false,\n              \"required\": false,\n              \"displayName\": \"Name\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Description\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"readOnly\": false,\n              \"required\": false,\n              \"displayName\": \"Description\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Qty\",\n              \"type\": \"number\",\n              \"display\": true,\n              \"removed\": false,\n              \"readOnly\": false,\n              \"required\": false,\n              \"displayName\": \"Qty\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Unit price\",\n              \"type\": \"number\",\n              \"display\": true,\n              \"removed\": false,\n              \"readOnly\": false,\n              \"required\": false,\n              \"displayName\": \"Unit price\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Amount\",\n              \"type\": \"number\",\n              \"display\": true,\n              \"removed\": false,\n              \"readOnly\": false,\n              \"required\": false,\n              \"displayName\": \"Amount\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Invoices\",\n              \"type\": \"array\",\n              \"display\": true,\n              \"removed\": false,\n              \"readOnly\": false,\n              \"required\": false,\n              \"displayName\": \"Invoices\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            }\n          ],\n          \"mappingMode\": \"defineBelow\",\n          \"matchingColumns\": []\n        },\n        \"options\": {},\n        \"operation\": \"create\"\n      },\n      \"credentials\": {\n        \"airtableTokenApi\": {\n          \"id\": \"XT7hvl1w201jtBhx\",\n          \"name\": \"Airtable Personal Access Token account\"\n        }\n      },\n      \"typeVersion\": 2.1\n    },\n    {\n      \"id\": \"7ee324e8-6df3-48d6-b1b8-6fdb610b1ec7\",\n      \"name\": \"OpenAI - Extract Line Items\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        180,\n        340\n      ],\n      \"parameters\": {\n        \"url\": \"=https://api.openai.com/v1/chat/completions\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"jsonBody\": \"={\\n    \\\"model\\\": \\\"gpt-4o-mini\\\",\\n    \\\"messages\\\": [\\n      {\\n        \\\"role\\\": \\\"system\\\",\\n        \\\"content\\\": {{ JSON.stringify($('Set Fields').item.json.prompt) }}\\n      },\\n      {\\n        \\\"role\\\": \\\"user\\\",\\n        \\\"content\\\": {{ JSON.stringify( JSON.stringify($('Webhook').item.json.body.json[0].items) ) }}\\n      }\\n    ],\\n  \\\"response_format\\\":{ \\\"type\\\": \\\"json_schema\\\", \\\"json_schema\\\":  {{ $('Set Fields').item.json.schema }}\\n\\n }\\n  }\",\n        \"sendBody\": true,\n        \"specifyBody\": \"json\",\n        \"authentication\": \"predefinedCredentialType\",\n        \"nodeCredentialType\": \"openAiApi\"\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"9RivS2BmSh1DDBFm\",\n          \"name\": \"OpenAi account 3\"\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"eda31919-9091-4d45-bd73-4609b71f93a9\",\n      \"name\": \"Set Fields\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        -40,\n        340\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"dc09a5b4-ff6a-4cee-b87e-35de7336ac05\",\n              \"name\": \"prompt\",\n              \"type\": \"string\",\n              \"value\": \"Please, process parsed data and return only needed.\"\n            },\n            {\n              \"id\": \"4e0f9af6-517f-42af-9ced-df0e8a7118b0\",\n              \"name\": \"schema\",\n              \"type\": \"string\",\n              \"value\": \"={\\n  \\\"name\\\": \\\"generate_schema\\\",\\n  \\\"description\\\": \\\"Generate schema for an array of objects representing items with their descriptions, quantities, unit prices, and amounts.\\\",\\n  \\\"strict\\\": true,\\n  \\\"schema\\\": {\\n    \\\"type\\\": \\\"object\\\",\\n    \\\"required\\\": [\\n      \\\"items\\\"\\n    ],\\n    \\\"properties\\\": {\\n      \\\"items\\\": {\\n        \\\"type\\\": \\\"array\\\",\\n        \\\"description\\\": \\\"Array of item objects\\\",\\n        \\\"items\\\": {\\n          \\\"type\\\": \\\"object\\\",\\n          \\\"required\\\": [\\n            \\\"description\\\",\\n            \\\"qty\\\",\\n            \\\"unit_price\\\",\\n            \\\"amount\\\"\\n          ],\\n          \\\"properties\\\": {\\n            \\\"description\\\": {\\n              \\\"type\\\": \\\"string\\\",\\n              \\\"description\\\": \\\"Description of the item\\\"\\n            },\\n            \\\"qty\\\": {\\n              \\\"type\\\": \\\"string\\\",\\n              \\\"description\\\": \\\"Quantity of the item\\\"\\n            },\\n            \\\"unit_price\\\": {\\n              \\\"type\\\": \\\"string\\\",\\n              \\\"description\\\": \\\"Unit price of the item formatted as a string\\\"\\n            },\\n            \\\"amount\\\": {\\n              \\\"type\\\": \\\"string\\\",\\n              \\\"description\\\": \\\"Total amount for the item formatted as a string\\\"\\n            }\\n          },\\n          \\\"additionalProperties\\\": false\\n        }\\n      }\\n    },\\n    \\\"additionalProperties\\\": false\\n  }\\n}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"cc0d97d8-fb62-43eb-b484-4dd39f8db4b4\",\n      \"name\": \"Process Line Items\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        600,\n        340\n      ],\n      \"parameters\": {\n        \"jsCode\": \"// Get the input from the \\\"OpenAI - Extract Line Items\\\" node\\nconst input = $(\\\"OpenAI - Extract Line Items\\\").first().json;\\n\\n// Initialize an array for the output\\nconst outputItems = [];\\n\\n// Navigate to the 'content' field in the choices array\\nconst content = input.choices[0]?.message?.content;\\n\\nif (content) {\\n  try {\\n    // Parse the stringified JSON in the 'content' field\\n    const parsedContent = JSON.parse(content);\\n\\n    // Extract 'items' and add them to the output array\\n    if (Array.isArray(parsedContent.items)) {\\n      outputItems.push(...parsedContent.items.map(i => ({ json: i })));\\n    }\\n  } catch (error) {\\n    // Handle any parsing errors\\n    console.error('Error parsing content:', error);\\n  }\\n}\\n\\n// Return the extracted items\\nreturn outputItems;\\n\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"741dc44e-6d47-4a77-80c2-5e18b291da33\",\n      \"name\": \"Webhook\",\n      \"type\": \"n8n-nodes-base.webhook\",\n      \"position\": [\n        -220,\n        340\n      ],\n      \"webhookId\": \"0f7f5ebb-8b66-453b-a818-20cc3647c783\",\n      \"parameters\": {\n        \"path\": \"0f7f5ebb-8b66-453b-a818-20cc3647c783\",\n        \"options\": {},\n        \"httpMethod\": \"POST\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"fbc196c8-7518-4deb-ac47-f37f1b8150eb\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -260,\n        -300\n      ],\n      \"parameters\": {\n        \"width\": 920,\n        \"height\": 400,\n        \"content\": \"## 情景一\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"96368d41-7886-487f-a8a7-e4dac3b01f45\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -280,\n        240\n      ],\n      \"parameters\": {\n        \"width\": 1340,\n        \"height\": 460,\n        \"content\": \"## 场景二\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"6b7c94d7-c844-4246-ba1a-cea5937792db\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -60,\n        0\n      ],\n      \"parameters\": {\n        \"color\": 3,\n        \"width\": 270,\n        \"height\": 80,\n        \"content\": \"### 替换Google Drive连接\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"9c8141d0-428a-44e5-b900-b07fa64db4f5\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        320,\n        0\n      ],\n      \"parameters\": {\n        \"color\": 3,\n        \"width\": 170,\n        \"height\": 80,\n        \"content\": \"### 替换请求头中的API密钥\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"48243fe4-4ed1-43dc-b508-8b3f9472bb67\",\n      \"name\": \"Sticky Note4\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        140,\n        540\n      ],\n      \"parameters\": {\n        \"color\": 3,\n        \"width\": 170,\n        \"height\": 80,\n        \"content\": \"### 替换OpenAI连接\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"ffc6b530-69ab-4ccb-945d-94f8fdc1e3ab\",\n      \"name\": \"Sticky Note5\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        400,\n        540\n      ],\n      \"parameters\": {\n        \"color\": 3,\n        \"width\": 530,\n        \"height\": 80,\n        \"content\": \"### 替换Airtable连接\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"15047f43-5f7e-4c70-a754-fffb41c04611\",\n      \"name\": \"Sticky Note9\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -760,\n        380\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 330.5152611046425,\n        \"height\": 239.5888196628349,\n        \"content\": \"### ... 或观看安装视频 [7分钟]\\n[![YouTube缩略图](https://cflobdhpqwnoisuctsoc.supabase.co/storage/v1/object/public/my_storage/Video%2010%20-%20Parser%20invoices%20Blur.png)](https://youtu.be/E4I0nru-fa8)\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"812f6cc7-a093-41d0-9750-48253d9f04a8\",\n      \"name\": \"Sticky Note7\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -1060,\n        -300\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 636,\n        \"height\": 657,\n        \"content\": \"![5分钟AI标志](https://cflobdhpqwnoisuctsoc.supabase.co/storage/v1/object/public/my_storage/banner.png)\\n## 会议实时洞察AI助手\\n**由[5minAI社区](https://www.skool.com/5minai)的[Mark Shcherbakov](https://www.linkedin.com/in/marklowcoding/)开发**\\n\\n人工转录会议既繁琐又容易出错。本工作流实现了实时自动转录，确保关键讨论和决策被准确记录并便于后续查阅，从而提升沟通效率与清晰度。\\n\\n该工作流运用n8n和LlamaParse技术，自动检测指定Google Drive文件夹中的新发票，解析关键账单信息，并将提取的数据结构化存储。核心功能包括：\\n- 通过Google Drive触发器实时监测新发票\\n- 自动发送HTTP请求至Lama Cloud启动解析\\n- 将发票明细及条目结构化存储至数据库\\n\\n1. **Google Drive集成**：监控指定文件夹中的新发票上传\\n2. **LlamaParse解析**：自动发送发票至解析引擎并通过webhook处理结果\\n3. **Airtable数据存储**：为发票及其关联条目创建记录，实现精细化追踪\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"a80e6528-cf79-4229-8c58-6856fd86b6e7\",\n      \"name\": \"Sticky Note6\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -1060,\n        380\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 280,\n        \"height\": 626,\n        \"content\": \"### 设置步骤\\n\\n1. **Google Drive触发器**：\\n   - 设置触发器，用于检测指定发票文件夹中的新文件。\\n\\n2. **文件上传至LlamaParse**：\\n   - 创建HTTP请求，将发票文件发送至LlamaParse进行解析，包括相关头部设置和Webhook URL。\\n\\n3. **Webhook处理**：\\n   - 建立Webhook节点，处理从LlamaParse返回的解析结果，有效提取所需的发票详细信息。\\n\\n4. **发票记录创建**：\\n   - 使用从Webhook接收的解析数据，在数据库中为发票创建初始记录。\\n\\n5. **行项目处理**：\\n   - 将字符串数据转换为结构化的行项目数组，并为每个与主发票关联的项目创建单独记录。\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"pinData\": {},\n  \"connections\": {\n    \"Webhook\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Set Fields\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Set Fields\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"OpenAI - Extract Line Items\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Google Drive\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Upload File\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Create Invoice\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Process Line Items\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Process Line Items\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Create Line Item\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Google Drive Trigger\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Google Drive\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"OpenAI - Extract Line Items\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Create Invoice\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}