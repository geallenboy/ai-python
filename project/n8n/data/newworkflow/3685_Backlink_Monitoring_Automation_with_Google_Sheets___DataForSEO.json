{
  "url": "https://n8n.io/workflows/3685-backlink-monitoring-automation-with-google-sheets-dataforseo/",
  "title": "Backlink Monitoring Automation with Google Sheets + DataForSEO",
  "author": "Mykolas Bartkus",
  "publish_date": "Last update a month ago",
  "publish_date_absolute": "",
  "categories": [
    {
      "name": "AI"
    },
    {
      "name": "Marketing"
    }
  ],
  "workflow_json": "{\"id\":\"WGUpujme8ctIkBF8\",\"meta\":{\"instanceId\":\"431560c610ab26f4776059ff809760704293c90767af32183943d4c54ac57441\",\"templateCredsSetupCompleted\":true},\"name\":\"Live link checker\",\"tags\":[],\"nodes\":[{\"id\":\"40009961-9c97-49ee-b9ce-440e65b41e47\",\"name\":\"Loop Over Items\",\"type\":\"n8n-nodes-base.splitInBatches\",\"position\":[-280,200],\"parameters\":{\"options\":{}},\"typeVersion\":3},{\"id\":\"85a73ac8-a8c6-4b5e-a870-3b1a58336037\",\"name\":\"When clicking ‘Test workflow’\",\"type\":\"n8n-nodes-base.manualTrigger\",\"position\":[-1060,200],\"parameters\":{},\"typeVersion\":1},{\"id\":\"a1495fc5-d39d-4cf5-b8d3-a804d82ba1a5\",\"name\":\"Reads Google Sheets\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[-780,200],\"parameters\":{\"options\":{\"dataLocationOnSheet\":{\"values\":{\"range\":\"D1:E\",\"rangeDefinition\":\"specifyRangeA1\"}}},\"sheetName\":{\"__rl\":true,\"mode\":\"list\",\"value\":1573787772,\"cachedResultUrl\":\"\",\"cachedResultName\":\"Lost links\"},\"documentId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"10CYntk8OmYemJBpcfs1dH_7p_PJxiBMpsfATtLYw7jI\",\"cachedResultUrl\":\"\",\"cachedResultName\":\"Sheet with lost links\"}},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"shxBIVyk68LlqTnb\",\"name\":\"Google Sheets account 3\"}},\"typeVersion\":4.5},{\"id\":\"bd055fee-f66b-4b1d-9ee2-3581021d8b1f\",\"name\":\"Cleans backlink url\",\"type\":\"n8n-nodes-base.code\",\"position\":[-560,200],\"parameters\":{\"jsCode\":\"return items.map(item => {\\n  let url = item.json['Backlink URL'];  // Get the URL from the current item's JSON\\n  let domain = url.match(/https?:\\\\/\\\\/(?:www\\\\.)?([^/]+)/)[1]; \\n  return { json: { domain, url } };\\n});\\n$input.first().json['Backlink URL']\"},\"typeVersion\":2},{\"id\":\"030b04e9-da35-4448-b2f4-c1543eafabf5\",\"name\":\"Sends HTTP POST Request to DataForSEO\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[-20,220],\"parameters\":{\"url\":\"https://api.dataforseo.com/v3/on_page/task_post\",\"method\":\"POST\",\"options\":{},\"jsonBody\":\"=[{\\n\\\"target\\\": \\\"{{ $json.domain }}\\\",\\n\\\"start_url\\\": \\\"{{ $json.url }}\\\",\\n\\\"max_crawl_pages\\\": 1\\n}]\",\"sendBody\":true,\"specifyBody\":\"json\",\"authentication\":\"genericCredentialType\",\"genericAuthType\":\"httpBasicAuth\"},\"credentials\":{\"httpBasicAuth\":{\"id\":\"MeuonUXyXYX6lg4R\",\"name\":\"Unnamed credential\"}},\"typeVersion\":4.2},{\"id\":\"6ac33fbd-2daf-4b5f-a7a2-fe742294765b\",\"name\":\"Waits 20 seconds\",\"type\":\"n8n-nodes-base.wait\",\"position\":[200,220],\"webhookId\":\"f1cc4df1-6443-4ecd-8708-fd40858f3762\",\"parameters\":{\"amount\":20},\"typeVersion\":1.1},{\"id\":\"2213992d-d782-4357-8f59-87a8afb3f7f1\",\"name\":\"Sends HTTP links request to DataforSeo\",\"type\":\"n8n-nodes-base.httpRequest\",\"onError\":\"continueRegularOutput\",\"position\":[440,220],\"parameters\":{\"url\":\"https://api.dataforseo.com/v3/on_page/links\",\"method\":\"POST\",\"options\":{\"batching\":{\"batch\":{\"batchSize\":1}}},\"jsonBody\":\"=[\\n  {\\n    \\\"id\\\": \\\"{{ $json.tasks[0].id }}\\\"\\n  }\\n]\\n\",\"sendBody\":true,\"specifyBody\":\"json\",\"authentication\":\"genericCredentialType\",\"genericAuthType\":\"httpBasicAuth\"},\"credentials\":{\"httpBasicAuth\":{\"id\":\"MeuonUXyXYX6lg4R\",\"name\":\"Unnamed credential\"}},\"typeVersion\":4.2,\"alwaysOutputData\":false},{\"id\":\"ab3b47d7-381a-48e9-aad3-8555d6c36145\",\"name\":\"Checks which backlinks exists on the landing page\",\"type\":\"n8n-nodes-base.code\",\"position\":[680,220],\"parameters\":{\"mode\":\"runOnceForEachItem\",\"jsCode\":\"const result = $json.tasks?.[0]?.result?.[0];\\nconst links = result?.items || []; // Safe fallback to an empty array\\n\\nlet backlink = $('Reads Google Sheets').item.json['Landing page']; // Expected backlink\\n\\n// Find the backlink in the scraped data\\nlet foundLink = links.find(link => link.link_to === backlink);\\n\\n// Check if the backlink exists and if it's dofollow\\nlet status = \\\"Lost\\\"; // Default to lost\\nif (foundLink) {\\n  status = foundLink.dofollow ? \\\"Live\\\" : \\\"Lost (Nofollow)\\\";\\n}\\n\\nreturn {\\n  json: {\\n    backlink: backlink,\\n    status: status\\n  }\\n};\\n\"},\"typeVersion\":2},{\"id\":\"d07a8791-74d9-4f86-b9d8-e0847406a96e\",\"name\":\"Sends data to Google sheets\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[900,220],\"parameters\":{\"columns\":{\"value\":{\"Status\":\"={{ $json.status }}\",\"Backlink URL\":\"={{ $('Loop Over Items').item.json.url }}\"},\"schema\":[{\"id\":\"Company\",\"type\":\"string\",\"display\":true,\"removed\":true,\"required\":false,\"displayName\":\"Company\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Contact A\",\"type\":\"string\",\"display\":true,\"removed\":true,\"required\":false,\"displayName\":\"Contact A\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Channel\",\"type\":\"string\",\"display\":true,\"removed\":true,\"required\":false,\"displayName\":\"Channel\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Backlink URL\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"Backlink URL\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Landing page\",\"type\":\"string\",\"display\":true,\"removed\":true,\"required\":false,\"displayName\":\"Landing page\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Anchor\",\"type\":\"string\",\"display\":true,\"removed\":true,\"required\":false,\"displayName\":\"Anchor\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Money out\",\"type\":\"string\",\"display\":true,\"removed\":true,\"required\":false,\"displayName\":\"Money out\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Money in\",\"type\":\"string\",\"display\":true,\"removed\":true,\"required\":false,\"displayName\":\"Money in\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Invoice OUT\",\"type\":\"string\",\"display\":true,\"removed\":true,\"required\":false,\"displayName\":\"Invoice OUT\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Invoice IN\",\"type\":\"string\",\"display\":true,\"removed\":true,\"required\":false,\"displayName\":\"Invoice IN\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Invoice out status\",\"type\":\"string\",\"display\":true,\"removed\":true,\"required\":false,\"displayName\":\"Invoice out status\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Invoice in status\",\"type\":\"string\",\"display\":true,\"removed\":true,\"required\":false,\"displayName\":\"Invoice in status\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Status\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"Status\",\"defaultMatch\":false,\"canBeUsedToMatch\":true}],\"mappingMode\":\"defineBelow\",\"matchingColumns\":[\"Backlink URL\"],\"attemptToConvertTypes\":false,\"convertFieldsToString\":false},\"options\":{},\"operation\":\"appendOrUpdate\",\"sheetName\":{\"__rl\":true,\"mode\":\"list\",\"value\":1573787772,\"cachedResultUrl\":\"\",\"cachedResultName\":\"Lost links\"},\"documentId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"10CYntk8OmYemJBpcfs1dH_7p_PJxiBMpsfATtLYw7jI\",\"cachedResultUrl\":\"\",\"cachedResultName\":\"Sheet with lost links\"}},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"shxBIVyk68LlqTnb\",\"name\":\"Google Sheets account 3\"}},\"typeVersion\":4.5},{\"id\":\"f241c2f2-6a0b-4709-92ff-c6c11f9477f5\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-880,-200],\"parameters\":{\"color\":4,\"width\":300,\"height\":340,\"content\":\"Connect your Google Sheets account.\\nEnsure your Google Sheet has clearly defined columns:\\n\\n\\\"Backlink URL\\\": URL of the page containing the backlink.\\n\\n\\\"Landing page\\\": The exact URL of your website page you're checking the backlink for.\\n\\nDefine your data range explicitly (e.g., D1:E) to accurately fetch these columns. The columns must be named exactly as specified to ensure the workflow functions correctly.\"},\"typeVersion\":1},{\"id\":\"42390706-6877-4f67-92d5-fcc13903bb6c\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-140,-320],\"parameters\":{\"color\":4,\"width\":380,\"height\":480,\"content\":\"## Configure your DataForSEO TASK POST NODE\\n(Basic Authentication). Insert your API key and password into n8n's Credentials settings. This node sends each URL/domain pair to the DataForSEO On-Page API for analysis.\\n\\n\\nSettings:\\n\\nMethod:POST\\n\\nURL:https://api.dataforseo.com/v3/on_page/task_post\\n\\nJSON body:\\n\\n[{\\n  \\\"target\\\": \\\"{{ $json.domain }}\\\",\\n  \\\"start_url\\\": \\\"{{ $json.url }}\\\",\\n  \\\"max_crawl_pages\\\": 1\\n}]\\n\"},\"typeVersion\":1},{\"id\":\"60d54c3d-a2be-4961-9932-4075d769896e\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[300,-320],\"parameters\":{\"color\":4,\"width\":400,\"height\":480,\"content\":\"## Configure your DataForSEO ON-PAGE LINKS NODE\\n\\nFetches the results from DataForSEO. Ensure your credentials are properly set (same as the previous DataForSEO node). This node retrieves link data, checking if the backlink exists and its status (dofollow/nofollow).\\n\\nSettings: \\nMethod: Post\\n\\nURL:https://api.dataforseo.com/v3/on_page/links\\n\\nJSON body example:\\n\\n[\\n  {\\n    \\\"id\\\": \\\"{{ $json.tasks[0].id }}\\\"\\n  }\\n]\\n\"},\"typeVersion\":1},{\"id\":\"1d800e2a-4385-4f98-b891-c40c7706bdee\",\"name\":\"Sticky Note3\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[760,-260],\"parameters\":{\"color\":4,\"width\":440,\"height\":400,\"content\":\"## Send data to Google Sheets\\n\\nThis node updates your Google Sheet with backlink check results.\\n\\nMap each column manually as follows:\\n\\nMatching Column (used to find the correct row): Backlink URL\\n\\nBacklink URL: {{ $('Loop Over Items').item.json.url }}\\n\\nStatus: {{ $json.status }}\\n\\nMake sure these columns (Backlink URL and Status) already exist in your Google Sheet and have these exact names.\\n\\nThis will correctly update the backlink status (e.g., Live, Lost, or Lost (Nofollow)) based on each URL processed.\"},\"typeVersion\":1}],\"active\":false,\"pinData\":{\"When clicking ‘Test workflow’\":[{\"json\":{}}]},\"settings\":{\"executionOrder\":\"v1\"},\"versionId\":\"f74ca31f-8b7c-48d9-9b5f-d8295c642497\",\"connections\":{\"Loop Over Items\":{\"main\":[[],[{\"node\":\"Sends HTTP POST Request to DataForSEO\",\"type\":\"main\",\"index\":0}]]},\"Waits 20 seconds\":{\"main\":[[{\"node\":\"Sends HTTP links request to DataforSeo\",\"type\":\"main\",\"index\":0}]]},\"Cleans backlink url\":{\"main\":[[{\"node\":\"Loop Over Items\",\"type\":\"main\",\"index\":0}]]},\"Reads Google Sheets\":{\"main\":[[{\"node\":\"Cleans backlink url\",\"type\":\"main\",\"index\":0}]]},\"Sends data to Google sheets\":{\"main\":[[{\"node\":\"Loop Over Items\",\"type\":\"main\",\"index\":0}]]},\"When clicking ‘Test workflow’\":{\"main\":[[{\"node\":\"Reads Google Sheets\",\"type\":\"main\",\"index\":0}]]},\"Sends HTTP POST Request to DataForSEO\":{\"main\":[[{\"node\":\"Waits 20 seconds\",\"type\":\"main\",\"index\":0}]]},\"Sends HTTP links request to DataforSeo\":{\"main\":[[{\"node\":\"Checks which backlinks exists on the landing page\",\"type\":\"main\",\"index\":0}]]},\"Checks which backlinks exists on the landing page\":{\"main\":[[{\"node\":\"Sends data to Google sheets\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "## What This Workflow Does\n\nThis n8n workflow reads backlinks from a Google Sheet, sends each one to the DataForSEO On-Page API, and checks:\n\n  * Whether the backlink is still live on the target page\n  * Whether it's dofollow or nofollow\n  * Whether it's missing (i.e., lost)\n\n\n\nThe result is then written back to the same Google Sheet under a Status column.\n\n## Your result will look like this:\n\n![Screenshot 20250424 at 08.32.51.png](https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/Screenshot_2025_04_24_at_08_32_51_b7f53f9a57.png)\n\n## Step-by-Step Setup Instructions\n\n  1. Add your DataForSEO and Google Sheets credentials in n8n\n  2. Make sure your Google Sheet has these columns: Backlink URL, Landing page, and Status\n  3. Click the Test Workflow button to check a batch of backlinks\n\n\n\n## Workflow Breakdown\n\n  1. Trigger: Manual test start\n  2. Read Data: Pulls backlink URLs and target pages from Google Sheets\n  3. Format URLs: Extracts domain from URL\n  4. Send POST Request to DataForSEO: Triggers a crawl on the backlink URL\n  5. Wait 20 seconds: Allows crawl to finish\n  6. Fetch Link Results: Retrieves backlink data from DataForSEO\n  7. Validate Backlink: Checks if the backlink is live, and whether it’s dofollow\n  8. Update Google Sheets: Logs the status as Live, Lost, or Lost (Nofollow)\n\n\n",
  "crawled_at": "2025-05-26T05:17:01.291379",
  "readme_zh": "## 工作流功能说明\n\n本n8n工作流执行以下操作：\n1. 从Google表格读取外链数据\n2. 将每条外链提交至DataForSEO页面SEO分析API进行检测\n3. 验证以下关键指标：\n   * 外链是否仍存在于目标页面\n   * 链接属性为dofollow或nofollow\n   * 是否已失效（丢失外链）\n\n检测结果将自动回写到原Google表格的\"状态\"列中。\n\n## 效果展示：\n\n![外链检测结果截图](https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/Screenshot_2025_04_24_at_08_32_51_b7f53f9a57.png)\n\n## 配置指南\n\n1. 在n8n中配置DataForSEO和Google Sheets的API凭证\n2. 确保Google表格包含三列：外链URL、着陆页、状态\n3. 点击\"测试工作流\"按钮进行批量外链检测\n\n## 工作流执行步骤\n\n1. 触发器：手动启动测试\n2. 数据读取：从Google表格获取外链URL及目标页面\n3. URL格式化：提取域名信息\n4. 向DataForSEO发送POST请求：触发外链爬取\n5. 等待20秒：确保爬取完成\n6. 获取链接结果：从DataForSEO检索外链数据\n7. 外链验证：检测外链存活状态及follow属性\n8. 更新Google表格：标注状态为\"有效\"/\"失效\"/\"失效(nofollow)\"",
  "title_zh": "使用Google表格+DataForSEO实现反向链接监控自动化",
  "publish_date_zh": "上次更新于7天前",
  "workflow_json_zh": "{\n  \"id\": \"WGUpujme8ctIkBF8\",\n  \"meta\": {\n    \"instanceId\": \"431560c610ab26f4776059ff809760704293c90767af32183943d4c54ac57441\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"name\": \"Live link checker\",\n  \"tags\": [],\n  \"nodes\": [\n    {\n      \"id\": \"40009961-9c97-49ee-b9ce-440e65b41e47\",\n      \"name\": \"Loop Over Items\",\n      \"type\": \"n8n-nodes-base.splitInBatches\",\n      \"position\": [\n        -280,\n        200\n      ],\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"85a73ac8-a8c6-4b5e-a870-3b1a58336037\",\n      \"name\": \"When clicking ‘Test workflow’\",\n      \"type\": \"n8n-nodes-base.manualTrigger\",\n      \"position\": [\n        -1060,\n        200\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"a1495fc5-d39d-4cf5-b8d3-a804d82ba1a5\",\n      \"name\": \"Reads Google Sheets\",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"position\": [\n        -780,\n        200\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"dataLocationOnSheet\": {\n            \"values\": {\n              \"range\": \"D1:E\",\n              \"rangeDefinition\": \"specifyRangeA1\"\n            }\n          }\n        },\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": 1573787772,\n          \"cachedResultUrl\": \"\",\n          \"cachedResultName\": \"Lost links\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"10CYntk8OmYemJBpcfs1dH_7p_PJxiBMpsfATtLYw7jI\",\n          \"cachedResultUrl\": \"\",\n          \"cachedResultName\": \"Sheet with lost links\"\n        }\n      },\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"shxBIVyk68LlqTnb\",\n          \"name\": \"Google Sheets account 3\"\n        }\n      },\n      \"typeVersion\": 4.5\n    },\n    {\n      \"id\": \"bd055fee-f66b-4b1d-9ee2-3581021d8b1f\",\n      \"name\": \"Cleans backlink url\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        -560,\n        200\n      ],\n      \"parameters\": {\n        \"jsCode\": \"return items.map(item => {\\n  let url = item.json['Backlink URL'];  // Get the URL from the current item's JSON\\n  let domain = url.match(/https?:\\\\/\\\\/(?:www\\\\.)?([^/]+)/)[1]; \\n  return { json: { domain, url } };\\n});\\n$input.first().json['Backlink URL']\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"030b04e9-da35-4448-b2f4-c1543eafabf5\",\n      \"name\": \"Sends HTTP POST Request to DataForSEO\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        -20,\n        220\n      ],\n      \"parameters\": {\n        \"url\": \"https://api.dataforseo.com/v3/on_page/task_post\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"jsonBody\": \"=[{\\n\\\"target\\\": \\\"{{ $json.domain }}\\\",\\n\\\"start_url\\\": \\\"{{ $json.url }}\\\",\\n\\\"max_crawl_pages\\\": 1\\n}]\",\n        \"sendBody\": true,\n        \"specifyBody\": \"json\",\n        \"authentication\": \"genericCredentialType\",\n        \"genericAuthType\": \"httpBasicAuth\"\n      },\n      \"credentials\": {\n        \"httpBasicAuth\": {\n          \"id\": \"MeuonUXyXYX6lg4R\",\n          \"name\": \"Unnamed credential\"\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"6ac33fbd-2daf-4b5f-a7a2-fe742294765b\",\n      \"name\": \"Waits 20 seconds\",\n      \"type\": \"n8n-nodes-base.wait\",\n      \"position\": [\n        200,\n        220\n      ],\n      \"webhookId\": \"f1cc4df1-6443-4ecd-8708-fd40858f3762\",\n      \"parameters\": {\n        \"amount\": 20\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"2213992d-d782-4357-8f59-87a8afb3f7f1\",\n      \"name\": \"Sends HTTP links request to DataforSeo\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"onError\": \"continueRegularOutput\",\n      \"position\": [\n        440,\n        220\n      ],\n      \"parameters\": {\n        \"url\": \"https://api.dataforseo.com/v3/on_page/links\",\n        \"method\": \"POST\",\n        \"options\": {\n          \"batching\": {\n            \"batch\": {\n              \"batchSize\": 1\n            }\n          }\n        },\n        \"jsonBody\": \"=[\\n  {\\n    \\\"id\\\": \\\"{{ $json.tasks[0].id }}\\\"\\n  }\\n]\\n\",\n        \"sendBody\": true,\n        \"specifyBody\": \"json\",\n        \"authentication\": \"genericCredentialType\",\n        \"genericAuthType\": \"httpBasicAuth\"\n      },\n      \"credentials\": {\n        \"httpBasicAuth\": {\n          \"id\": \"MeuonUXyXYX6lg4R\",\n          \"name\": \"Unnamed credential\"\n        }\n      },\n      \"typeVersion\": 4.2,\n      \"alwaysOutputData\": false\n    },\n    {\n      \"id\": \"ab3b47d7-381a-48e9-aad3-8555d6c36145\",\n      \"name\": \"Checks which backlinks exists on the landing page\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        680,\n        220\n      ],\n      \"parameters\": {\n        \"mode\": \"runOnceForEachItem\",\n        \"jsCode\": \"const result = $json.tasks?.[0]?.result?.[0];\\nconst links = result?.items || []; // Safe fallback to an empty array\\n\\nlet backlink = $('Reads Google Sheets').item.json['Landing page']; // Expected backlink\\n\\n// Find the backlink in the scraped data\\nlet foundLink = links.find(link => link.link_to === backlink);\\n\\n// Check if the backlink exists and if it's dofollow\\nlet status = \\\"Lost\\\"; // Default to lost\\nif (foundLink) {\\n  status = foundLink.dofollow ? \\\"Live\\\" : \\\"Lost (Nofollow)\\\";\\n}\\n\\nreturn {\\n  json: {\\n    backlink: backlink,\\n    status: status\\n  }\\n};\\n\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"d07a8791-74d9-4f86-b9d8-e0847406a96e\",\n      \"name\": \"Sends data to Google sheets\",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"position\": [\n        900,\n        220\n      ],\n      \"parameters\": {\n        \"columns\": {\n          \"value\": {\n            \"Status\": \"={{ $json.status }}\",\n            \"Backlink URL\": \"={{ $('Loop Over Items').item.json.url }}\"\n          },\n          \"schema\": [\n            {\n              \"id\": \"Company\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": true,\n              \"required\": false,\n              \"displayName\": \"Company\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Contact A\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": true,\n              \"required\": false,\n              \"displayName\": \"Contact A\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Channel\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": true,\n              \"required\": false,\n              \"displayName\": \"Channel\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Backlink URL\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"Backlink URL\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Landing page\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": true,\n              \"required\": false,\n              \"displayName\": \"Landing page\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Anchor\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": true,\n              \"required\": false,\n              \"displayName\": \"Anchor\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Money out\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": true,\n              \"required\": false,\n              \"displayName\": \"Money out\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Money in\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": true,\n              \"required\": false,\n              \"displayName\": \"Money in\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Invoice OUT\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": true,\n              \"required\": false,\n              \"displayName\": \"Invoice OUT\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Invoice IN\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": true,\n              \"required\": false,\n              \"displayName\": \"Invoice IN\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Invoice out status\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": true,\n              \"required\": false,\n              \"displayName\": \"Invoice out status\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Invoice in status\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": true,\n              \"required\": false,\n              \"displayName\": \"Invoice in status\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Status\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"Status\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            }\n          ],\n          \"mappingMode\": \"defineBelow\",\n          \"matchingColumns\": [\n            \"Backlink URL\"\n          ],\n          \"attemptToConvertTypes\": false,\n          \"convertFieldsToString\": false\n        },\n        \"options\": {},\n        \"operation\": \"appendOrUpdate\",\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": 1573787772,\n          \"cachedResultUrl\": \"\",\n          \"cachedResultName\": \"Lost links\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"10CYntk8OmYemJBpcfs1dH_7p_PJxiBMpsfATtLYw7jI\",\n          \"cachedResultUrl\": \"\",\n          \"cachedResultName\": \"Sheet with lost links\"\n        }\n      },\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"shxBIVyk68LlqTnb\",\n          \"name\": \"Google Sheets account 3\"\n        }\n      },\n      \"typeVersion\": 4.5\n    },\n    {\n      \"id\": \"f241c2f2-6a0b-4709-92ff-c6c11f9477f5\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -880,\n        -200\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 300,\n        \"height\": 340,\n        \"content\": \"连接您的Google Sheets账户。  \\n请确保您的Google表格中已明确定义以下列：  \\n\\n- \\\"Backlink URL\\\"：包含反向链接的页面URL。  \\n- \\\"Landing page\\\"：您要检查反向链接所对应的网站页面具体URL。  \\n\\n明确指定数据范围（例如D1:E），以准确获取这些列。列名必须与上述命名完全一致，以确保工作流程正常运行。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"42390706-6877-4f67-92d5-fcc13903bb6c\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -140,\n        -320\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 380,\n        \"height\": 480,\n        \"content\": \"## 配置您的DataForSEO任务提交节点\\n（基础认证）。将您的API密钥和密码填入n8n的凭证设置中。该节点会将每个URL/域名对发送至DataForSEO页面分析API进行处理。\\n\\n设置项：\\n\\n请求方法：POST\\n\\n请求地址：https://api.dataforseo.com/v3/on_page/task_post\\n\\nJSON请求体：\\n\\n[{\\n  \\\"分析目标\\\": \\\"{{ $json.domain }}\\\",\\n  \\\"起始网址\\\": \\\"{{ $json.url }}\\\",\\n  \\\"最大爬取页数\\\": 1\\n}]\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"60d54c3d-a2be-4961-9932-4075d769896e\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        300,\n        -320\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 400,\n        \"height\": 480,\n        \"content\": \"## 配置您的DataForSEO页面链接节点\\n\\n此节点用于从DataForSEO获取结果。请确保您的凭证已正确设置（与之前的DataForSEO节点相同）。该节点将检索链接数据，检查反向链接是否存在及其状态（dofollow/nofollow）。\\n\\n设置：\\n方法：Post\\n\\nURL：https://api.dataforseo.com/v3/on_page/links\\n\\nJSON请求体示例：\\n\\n[\\n  {\\n    \\\"id\\\": \\\"{{ $json.tasks[0].id }}\\\"\\n  }\\n]\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"1d800e2a-4385-4f98-b891-c40c7706bdee\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        760,\n        -260\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 440,\n        \"height\": 400,\n        \"content\": \"## 发送数据到Google表格\\n\\n此节点会将反向链接检查结果更新至您的Google表格中。\\n\\n请按以下方式手动映射每一列：\\n\\n匹配列（用于定位正确行）：反向链接URL\\n\\n反向链接URL：{{ $('Loop Over Items').item.json.url }}\\n\\n状态：{{ $json.status }}\\n\\n请确保这些列（反向链接URL和状态）已存在于您的Google表格中，且名称完全一致。\\n\\n这将根据每个已处理的URL正确更新反向链接状态（例如：活跃、丢失或丢失（Nofollow））。\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"active\": false,\n  \"pinData\": {\n    \"When clicking ‘Test workflow’\": [\n      {\n        \"json\": {}\n      }\n    ]\n  },\n  \"settings\": {\n    \"executionOrder\": \"v1\"\n  },\n  \"versionId\": \"f74ca31f-8b7c-48d9-9b5f-d8295c642497\",\n  \"connections\": {\n    \"Loop Over Items\": {\n      \"main\": [\n        [],\n        [\n          {\n            \"node\": \"Sends HTTP POST Request to DataForSEO\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Waits 20 seconds\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Sends HTTP links request to DataforSeo\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Cleans backlink url\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Loop Over Items\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Reads Google Sheets\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Cleans backlink url\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Sends data to Google sheets\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Loop Over Items\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"When clicking ‘Test workflow’\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Reads Google Sheets\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Sends HTTP POST Request to DataForSEO\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Waits 20 seconds\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Sends HTTP links request to DataforSeo\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Checks which backlinks exists on the landing page\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Checks which backlinks exists on the landing page\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Sends data to Google sheets\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}