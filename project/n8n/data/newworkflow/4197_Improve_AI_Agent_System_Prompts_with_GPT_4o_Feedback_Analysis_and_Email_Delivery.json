{
  "url": "https://n8n.io/workflows/4197-improve-ai-agent-system-prompts-with-gpt-4o-feedback-analysis-and-email-delivery/",
  "title": "Improve AI Agent System Prompts with GPT-4o Feedback Analysis and Email Delivery",
  "author": "Daniel Rosehill",
  "publish_date": "Last update 6 days ago",
  "publish_date_absolute": "2025-05-20",
  "categories": [
    {
      "name": "Engineering"
    },
    {
      "name": "AI"
    }
  ],
  "workflow_json": "{\"id\":\"rx7v6helgDYENRs2\",\"meta\":{\"instanceId\":\"25cd9c9e1e996c71452f1ab7a15c1f1aa174615661f703590b37f8d95476bb1b\",\"templateCredsSetupCompleted\":true},\"name\":\"System Prompt Tuner\",\"tags\":[],\"nodes\":[{\"id\":\"62a0e2bc-7c17-4546-b627-bbedc863a3a0\",\"name\":\"User inputs\",\"type\":\"n8n-nodes-base.formTrigger\",\"position\":[-460,-80],\"webhookId\":\"cb20401c-ade4-45ce-912e-15956449ca3d\",\"parameters\":{\"options\":{\"buttonLabel\":\"Send For Evaluation\"},\"formTitle\":\"Agent Prompt Tuner\",\"formFields\":{\"values\":[{\"fieldLabel\":\"Agent Name\",\"requiredField\":true},{\"fieldType\":\"textarea\",\"fieldLabel\":\"Agent Purpose\",\"requiredField\":true},{\"fieldType\":\"textarea\",\"fieldLabel\":\"What's Working?\",\"requiredField\":true},{\"fieldType\":\"textarea\",\"fieldLabel\":\"What's Not Working?\",\"requiredField\":true},{\"fieldType\":\"textarea\",\"fieldLabel\":\"Current System Prompt\",\"requiredField\":true},{\"fieldType\":\"textarea\",\"fieldLabel\":\"Sample Input (Prompt)\"},{\"fieldType\":\"textarea\",\"fieldLabel\":\"Example Output\"}]},\"formDescription\":\"Enhances autonomous agent system prompts based on user provided descriptions of behavior and examples \"},\"typeVersion\":2.2},{\"id\":\"355883e9-05c4-47a1-a9f1-37aec5e3a550\",\"name\":\"AI Agent\",\"type\":\"@n8n/n8n-nodes-langchain.agent\",\"position\":[-240,-80],\"parameters\":{\"text\":\"=Here is the information for your analysis:\\n\\nAgent Name: {{ $json['Agent Name'] }}\\n\\nAgent Purpose: {{ $json['Agent Purpose'] }}\\n\\nCurrent System Prompt: {{ $json['Current System Prompt'] }}\\n\\nHere is how I would evaluate its current performance.\\n\\nThis is working well: {{ $json['What\\\\'s Working?'] }}\\n\\nThis is what's going wrong: {{ $json['What\\\\'s Not Working?'] }}\\n\\nHere's an examlple of a prompt I wrote and the output I received. If the following section is blank, please disregard it. Otherwise, consider it in your evaluation:\\n\\nSample prompt: {{ $json['Sample Input (Prompt)'] }}\\n\\nThe prompt generated the following output:\\n\\n{{ $json['Example Output'] }}\\n\\n\\nPlease generate the improved system prompt ensuring that your response adheres to the JSON formatting instruction.\",\"options\":{\"systemMessage\":\"You are an expert AI prompt engineer. \\n\\nYour task is to receive a set of observations about how a specific AI agent is performing. These observations include:\\n\\n* The name of the AI agent\\n* A short description of the agent's intended purpose\\n* A description of what *is* working well\\n* A description of what *is not* working as expected\\n* (Optionally) An example output from the current version of the agent\\n\\nUsing this information, your task is to analyze the shortcomings or gaps in the agent's behavior and generate a revised, full **system prompt** intended to improve its performance and address the identified issues.\\n\\nYour response should be in **JSON** format with the following fields:\\n\\n```json\\n{\\n  \\\"updated_system_prompt\\\": \\\"The full improved system prompt, rewritten from scratch or as a modification of the implied original\\\",\\n  \\\"summary_of_improvements\\\": \\\"A short explanation of what was changed or improved and why\\\"\\n}\\n```\\n\\nYou must:\\n\\n* Use clear and specific instructions in the new system prompt.\\n* Preserve functionality that is working well.\\n* Directly address behaviors that need correction.\\n* Avoid vague language and ensure the new prompt is actionable and well-structured.\\n\\nDo not include any commentary outside the JSON response.\"},\"promptType\":\"define\",\"hasOutputParser\":true},\"typeVersion\":1.9},{\"id\":\"b869ffde-2392-4465-8092-9fbbbc9853b0\",\"name\":\"OpenAI Chat Model\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\"position\":[-380,120],\"parameters\":{\"model\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"gpt-4o\",\"cachedResultName\":\"gpt-4o\"},\"options\":{}},\"credentials\":{\"openAiApi\":{\"id\":\"***\",\"name\":\"OpenAI Chat\"}},\"typeVersion\":1.2},{\"id\":\"315ef666-e3cc-4b75-9ec3-4a0c8f4938a0\",\"name\":\"Structured Output Parser\",\"type\":\"@n8n/n8n-nodes-langchain.outputParserStructured\",\"position\":[-80,140],\"parameters\":{\"jsonSchemaExample\":\"{\\n  \\\"updated_system_prompt\\\": \\\"The full improved system prompt, rewritten from scratch or as a modification of the implied original\\\",\\n  \\\"summary_of_improvements\\\": \\\"A short explanation of what was changed or improved and why\\\"\\n}\"},\"typeVersion\":1.2},{\"id\":\"9143224c-c6ab-4e58-8b0c-e95b1f2f00a7\",\"name\":\"Gmail\",\"type\":\"n8n-nodes-base.gmail\",\"position\":[120,-100],\"webhookId\":\"aa0e272c-96f6-465d-9f3c-555851974937\",\"parameters\":{\"sendTo\":\"user@example.com\",\"message\":\"=<!DOCTYPE html>\\n<html lang=\\\"en\\\">\\n<head>\\n  <meta charset=\\\"UTF-8\\\">\\n  <title>AI System Prompt Improvement Notification</title>\\n  <style>\\n    body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; background-color: #f9f9f9; padding: 20px; }\\n    .container { background-color: #ffffff; border-radius: 8px; padding: 24px; max-width: 700px; margin: auto; box-shadow: 0 0 10px rgba(0,0,0,0.05); }\\n    h2 { color: #2c3e50; border-bottom: 1px solid #ddd; padding-bottom: 4px; }\\n    pre { background-color: #f4f4f4; padding: 12px; border-radius: 4px; overflow-x: auto; font-family: monospace; }\\n    .footer { margin-top: 30px; font-size: 0.9em; color: #777; }\\n  </style>\\n</head>\\n<body>\\n  <div class=\\\"container\\\">\\n    <p>Hi there!</p>\\n    <p>You asked the <strong>AI System Prompt Improvement Agent</strong> to review the system prompt for <strong>{{ $('User inputs').item.json['Agent Name'] }}</strong>.</p>\\n    <h2>✅ Recommended Updated System Prompt</h2>\\n    <pre>{{ $json.output.updated_system_prompt }}</pre>\\n    <h2>📄 Original System Prompt</h2>\\n    <pre>{{ $('User inputs').item.json['Current System Prompt'] }}</pre>\\n    <h2>✏️ Summary of Improvements</h2>\\n    <p>{{ $json.output.summary_of_improvements }}</p>\\n    <div class=\\\"footer\\\">\\n      Regards,<br>\\n      <strong>AI Improvement Agent</strong>\\n    </div>\\n  </div>\\n</body>\\n</html>\",\"subject\":\"=Improved prompt for: {{ $('User inputs').item.json['Agent Name'] }}\"},\"credentials\":{\"gmailOAuth2\":{\"id\":\"***\",\"name\":\"Redacted Gmail OAuth\"}},\"typeVersion\":2.1}],\"active\":false,\"pinData\":{},\"settings\":{\"executionOrder\":\"v1\"},\"versionId\":\"447d5b7f-6409-4470-aac7-be8e36c9e34d\",\"connections\":{\"AI Agent\":{\"main\":[[{\"node\":\"Gmail\",\"type\":\"main\",\"index\":0}]]},\"User inputs\":{\"main\":[[{\"node\":\"AI Agent\",\"type\":\"main\",\"index\":0}]]},\"OpenAI Chat Model\":{\"ai_languageModel\":[[{\"node\":\"AI Agent\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"Structured Output Parser\":{\"ai_outputParser\":[[{\"node\":\"AI Agent\",\"type\":\"ai_outputParser\",\"index\":0}]]}}}",
  "readme": "# AI Agent System Prompt 'Auto-Tuner'\n\nThis workflow configures an AI agent which provides an edited system prompt for an autonomous AI agent Based on the following pieces of information provided by the user in an input form:\n\n  * Agent name\n  * Agent purpose\n  * What's working\n  * What's not working\n  * Current system prompt\n\n\n\nThere are two additional form elements that I've marked as non-required but if you want to force more detail from the user you can mark these as required:\n\n  * Example prompt\n  * Example output\n\n\n\nThis information gets sent to the AI agent which is configured with a system prompt of its own and the form elements are concatenated into a user prompt prompting the agent to evaluate the system prompt, deliver an improved version, and provide some notes for logging. The output structure is constrained with JSON. OpenAI 4o is recommended for its overall strong adherence to structured outputs.\n\nOnce the agent delivers its improved system prompt, this gets passed to the user via email notification. The final delivery stage can be alternated according to user preference\n\n## When This Is Useful\n\nAnyone working on AI agent configurations will likely be familiar with the pivotal importance of the system prompt in directing the desired behavior of the agent.\n\nFrequently this requires long hours of iteration before a consistent desired behaviour is achieved.\n\nSometimes we can figure out what's working and not based on our own intuition and experience, but at other times soliciting the outside perspective of another AI tool can be a helpful way to consider alternative explanations or improve our own prompt engineering.\n\nThis configuration is intended to speed up this iterative process and reduce the amount of time we spend working on system prompts to configure effective agent workflows\n",
  "crawled_at": "2025-05-26T06:49:29.275166",
  "readme_zh": "# AI代理系统提示词'自动调优器'\n\n此工作流程配置了一个AI代理，用于为自主AI代理提供经过编辑的系统提示词。基于用户通过输入表单提供的以下信息：\n\n* 代理名称\n* 代理用途\n* 当前有效部分\n* 当前失效部分\n* 现有系统提示词\n\n另有两个非必填表单字段（若需强制用户提供更多细节可设为必填项）：\n* 示例提示词\n* 示例输出\n\n这些信息将发送至配置有专属系统提示词的AI代理，表单内容会被整合成用户提示词，要求该代理评估现有系统提示词、交付改进版本并提供日志备注。输出结构采用JSON格式约束。推荐使用OpenAI 4o模型以确保对结构化输出的高度遵循。\n\n当代理生成改进版系统提示词后，将通过电子邮件通知用户。最终交付阶段可根据用户偏好进行调整。\n\n## 适用场景\n\n从事AI代理配置的人员都深知系统提示词对引导代理预期行为的关键作用。通常需要经过长时间迭代才能实现稳定的理想行为。\n\n虽然我们有时可以凭直觉和经验判断问题所在，但借助外部AI工具的第三方视角往往能提供新的解决思路，提升提示词工程水平。本配置旨在加速这种迭代过程，减少系统提示词的调试时间，从而快速建立高效的代理工作流程。",
  "title_zh": "利用GPT-4o反馈分析与邮件递送优化AI代理系统提示",
  "publish_date_zh": "最后更新于6天前",
  "workflow_json_zh": "{\n  \"id\": \"rx7v6helgDYENRs2\",\n  \"meta\": {\n    \"instanceId\": \"25cd9c9e1e996c71452f1ab7a15c1f1aa174615661f703590b37f8d95476bb1b\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"name\": \"System Prompt Tuner\",\n  \"tags\": [],\n  \"nodes\": [\n    {\n      \"id\": \"62a0e2bc-7c17-4546-b627-bbedc863a3a0\",\n      \"name\": \"User inputs\",\n      \"type\": \"n8n-nodes-base.formTrigger\",\n      \"position\": [\n        -460,\n        -80\n      ],\n      \"webhookId\": \"cb20401c-ade4-45ce-912e-15956449ca3d\",\n      \"parameters\": {\n        \"options\": {\n          \"buttonLabel\": \"Send For Evaluation\"\n        },\n        \"formTitle\": \"Agent Prompt Tuner\",\n        \"formFields\": {\n          \"values\": [\n            {\n              \"fieldLabel\": \"Agent Name\",\n              \"requiredField\": true\n            },\n            {\n              \"fieldType\": \"textarea\",\n              \"fieldLabel\": \"Agent Purpose\",\n              \"requiredField\": true\n            },\n            {\n              \"fieldType\": \"textarea\",\n              \"fieldLabel\": \"What's Working?\",\n              \"requiredField\": true\n            },\n            {\n              \"fieldType\": \"textarea\",\n              \"fieldLabel\": \"What's Not Working?\",\n              \"requiredField\": true\n            },\n            {\n              \"fieldType\": \"textarea\",\n              \"fieldLabel\": \"Current System Prompt\",\n              \"requiredField\": true\n            },\n            {\n              \"fieldType\": \"textarea\",\n              \"fieldLabel\": \"Sample Input (Prompt)\"\n            },\n            {\n              \"fieldType\": \"textarea\",\n              \"fieldLabel\": \"Example Output\"\n            }\n          ]\n        },\n        \"formDescription\": \"Enhances autonomous agent system prompts based on user provided descriptions of behavior and examples \"\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"355883e9-05c4-47a1-a9f1-37aec5e3a550\",\n      \"name\": \"AI Agent\",\n      \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n      \"position\": [\n        -240,\n        -80\n      ],\n      \"parameters\": {\n        \"text\": \"=Here is the information for your analysis:\\n\\nAgent Name: {{ $json['Agent Name'] }}\\n\\nAgent Purpose: {{ $json['Agent Purpose'] }}\\n\\nCurrent System Prompt: {{ $json['Current System Prompt'] }}\\n\\nHere is how I would evaluate its current performance.\\n\\nThis is working well: {{ $json['What\\\\'s Working?'] }}\\n\\nThis is what's going wrong: {{ $json['What\\\\'s Not Working?'] }}\\n\\nHere's an examlple of a prompt I wrote and the output I received. If the following section is blank, please disregard it. Otherwise, consider it in your evaluation:\\n\\nSample prompt: {{ $json['Sample Input (Prompt)'] }}\\n\\nThe prompt generated the following output:\\n\\n{{ $json['Example Output'] }}\\n\\n\\nPlease generate the improved system prompt ensuring that your response adheres to the JSON formatting instruction.\",\n        \"options\": {\n          \"systemMessage\": \"You are an expert AI prompt engineer. \\n\\nYour task is to receive a set of observations about how a specific AI agent is performing. These observations include:\\n\\n* The name of the AI agent\\n* A short description of the agent's intended purpose\\n* A description of what *is* working well\\n* A description of what *is not* working as expected\\n* (Optionally) An example output from the current version of the agent\\n\\nUsing this information, your task is to analyze the shortcomings or gaps in the agent's behavior and generate a revised, full **system prompt** intended to improve its performance and address the identified issues.\\n\\nYour response should be in **JSON** format with the following fields:\\n\\n```json\\n{\\n  \\\"updated_system_prompt\\\": \\\"The full improved system prompt, rewritten from scratch or as a modification of the implied original\\\",\\n  \\\"summary_of_improvements\\\": \\\"A short explanation of what was changed or improved and why\\\"\\n}\\n```\\n\\nYou must:\\n\\n* Use clear and specific instructions in the new system prompt.\\n* Preserve functionality that is working well.\\n* Directly address behaviors that need correction.\\n* Avoid vague language and ensure the new prompt is actionable and well-structured.\\n\\nDo not include any commentary outside the JSON response.\"\n        },\n        \"promptType\": \"define\",\n        \"hasOutputParser\": true\n      },\n      \"typeVersion\": 1.9\n    },\n    {\n      \"id\": \"b869ffde-2392-4465-8092-9fbbbc9853b0\",\n      \"name\": \"OpenAI Chat Model\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\n      \"position\": [\n        -380,\n        120\n      ],\n      \"parameters\": {\n        \"model\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"gpt-4o\",\n          \"cachedResultName\": \"gpt-4o\"\n        },\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"***\",\n          \"name\": \"OpenAI Chat\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"315ef666-e3cc-4b75-9ec3-4a0c8f4938a0\",\n      \"name\": \"Structured Output Parser\",\n      \"type\": \"@n8n/n8n-nodes-langchain.outputParserStructured\",\n      \"position\": [\n        -80,\n        140\n      ],\n      \"parameters\": {\n        \"jsonSchemaExample\": \"{\\n  \\\"updated_system_prompt\\\": \\\"The full improved system prompt, rewritten from scratch or as a modification of the implied original\\\",\\n  \\\"summary_of_improvements\\\": \\\"A short explanation of what was changed or improved and why\\\"\\n}\"\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"9143224c-c6ab-4e58-8b0c-e95b1f2f00a7\",\n      \"name\": \"Gmail\",\n      \"type\": \"n8n-nodes-base.gmail\",\n      \"position\": [\n        120,\n        -100\n      ],\n      \"webhookId\": \"aa0e272c-96f6-465d-9f3c-555851974937\",\n      \"parameters\": {\n        \"sendTo\": \"user@example.com\",\n        \"message\": \"=<!DOCTYPE html>\\n<html lang=\\\"en\\\">\\n<head>\\n  <meta charset=\\\"UTF-8\\\">\\n  <title>AI System Prompt Improvement Notification</title>\\n  <style>\\n    body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; background-color: #f9f9f9; padding: 20px; }\\n    .container { background-color: #ffffff; border-radius: 8px; padding: 24px; max-width: 700px; margin: auto; box-shadow: 0 0 10px rgba(0,0,0,0.05); }\\n    h2 { color: #2c3e50; border-bottom: 1px solid #ddd; padding-bottom: 4px; }\\n    pre { background-color: #f4f4f4; padding: 12px; border-radius: 4px; overflow-x: auto; font-family: monospace; }\\n    .footer { margin-top: 30px; font-size: 0.9em; color: #777; }\\n  </style>\\n</head>\\n<body>\\n  <div class=\\\"container\\\">\\n    <p>Hi there!</p>\\n    <p>You asked the <strong>AI System Prompt Improvement Agent</strong> to review the system prompt for <strong>{{ $('User inputs').item.json['Agent Name'] }}</strong>.</p>\\n    <h2>✅ Recommended Updated System Prompt</h2>\\n    <pre>{{ $json.output.updated_system_prompt }}</pre>\\n    <h2>📄 Original System Prompt</h2>\\n    <pre>{{ $('User inputs').item.json['Current System Prompt'] }}</pre>\\n    <h2>✏️ Summary of Improvements</h2>\\n    <p>{{ $json.output.summary_of_improvements }}</p>\\n    <div class=\\\"footer\\\">\\n      Regards,<br>\\n      <strong>AI Improvement Agent</strong>\\n    </div>\\n  </div>\\n</body>\\n</html>\",\n        \"subject\": \"=Improved prompt for: {{ $('User inputs').item.json['Agent Name'] }}\"\n      },\n      \"credentials\": {\n        \"gmailOAuth2\": {\n          \"id\": \"***\",\n          \"name\": \"Redacted Gmail OAuth\"\n        }\n      },\n      \"typeVersion\": 2.1\n    }\n  ],\n  \"active\": false,\n  \"pinData\": {},\n  \"settings\": {\n    \"executionOrder\": \"v1\"\n  },\n  \"versionId\": \"447d5b7f-6409-4470-aac7-be8e36c9e34d\",\n  \"connections\": {\n    \"AI Agent\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Gmail\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"User inputs\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"AI Agent\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"OpenAI Chat Model\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"AI Agent\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Structured Output Parser\": {\n      \"ai_outputParser\": [\n        [\n          {\n            \"node\": \"AI Agent\",\n            \"type\": \"ai_outputParser\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}