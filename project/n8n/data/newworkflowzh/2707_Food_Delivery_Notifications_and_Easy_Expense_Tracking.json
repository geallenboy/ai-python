{
  "url": "https://n8n.io/workflows/2707-food-delivery-notifications-and-easy-expense-tracking/",
  "title": "Food Delivery Notifications and Easy Expense Tracking",
  "author": "darrell_tw",
  "publish_date": "Last update 5 months ago",
  "publish_date_absolute": "2024-12-26",
  "categories": [
    {
      "name": "Other"
    }
  ],
  "workflow_json": "{\"id\":\"dDInVHNAfSedBUCb\",\"meta\":{\"instanceId\":\"fddb3e91967f1012c95dd02bf5ad21f279fc44715f47a7a96a33433621caa253\"},\"name\":\"外送記帳\",\"tags\":[],\"nodes\":[{\"id\":\"09c19ba1-45f2-43af-9985-3508d801c1b7\",\"name\":\"Loop Over Items\",\"type\":\"n8n-nodes-base.splitInBatches\",\"position\":[440,0],\"parameters\":{\"options\":{}},\"typeVersion\":3},{\"id\":\"18625b1d-f8ff-4e48-8b64-a9d42d24eccc\",\"name\":\"Click to Test Flow\",\"type\":\"n8n-nodes-base.manualTrigger\",\"position\":[40,0],\"parameters\":{},\"typeVersion\":1},{\"id\":\"649933c4-b16b-46de-9038-7d8c0b3d8e88\",\"name\":\"Get emails from Gmail with certain subject\",\"type\":\"n8n-nodes-base.gmail\",\"position\":[220,0],\"webhookId\":\"99c4deca-17c7-47ae-a38c-50344938e792\",\"parameters\":{\"simple\":false,\"filters\":{\"q\":\"subject:透過 Uber Eats 系統送出的訂單\"},\"options\":{},\"operation\":\"getAll\",\"returnAll\":true},\"credentials\":{\"gmailOAuth2\":{\"id\":\"34rX9kxKlJadOY6u\",\"name\":\"Gmail account\"}},\"typeVersion\":2.1},{\"id\":\"b2118a34-52ad-4464-b7ea-7f3105536fad\",\"name\":\"Receive certain keyword Gmail Trigger\",\"type\":\"n8n-nodes-base.gmailTrigger\",\"position\":[120,-180],\"parameters\":{\"simple\":false,\"filters\":{\"q\":\"subject:透過 Uber Eats 系統送出的訂單\"},\"options\":{},\"pollTimes\":{\"item\":[{\"mode\":\"everyHour\",\"minute\":30}]}},\"credentials\":{\"gmailOAuth2\":{\"id\":\"34rX9kxKlJadOY6u\",\"name\":\"Gmail account\"}},\"typeVersion\":1.2},{\"id\":\"00986543-d01a-4b11-bbaa-60c73a1dae02\",\"name\":\"Extract Price, Shop, Date, TIme\",\"type\":\"n8n-nodes-base.set\",\"position\":[620,60],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"c24405f8-267f-4933-a178-1b51145d62bf\",\"name\":\"price\",\"type\":\"string\",\"value\":\"={{ $json[\\\"text\\\"].match(/\\\\$(\\\\d+(\\\\.\\\\d{2})?)/)[1] }}\"},{\"id\":\"968cf7cd-6e28-4328-a829-3fe2cb327643\",\"name\":\"shop\",\"type\":\"string\",\"value\":\"={{ $json[\\\"text\\\"].match(/以下是您在([\\\\u4e00-\\\\u9fa5a-zA-Z0-9\\\\s]+)訂購/)[1] }}\"},{\"id\":\"53642bcb-f3a6-4086-bdc1-2f8d27927462\",\"name\":\"date\",\"type\":\"string\",\"value\":\"={{ $json[\\\"text\\\"].match(/Date: (\\\\d{4}年\\\\d{1,2}月\\\\d{1,2}日)/)[1].replace(\\\"年\\\", \\\".\\\").replace(\\\"月\\\", \\\".\\\").replace(\\\"日\\\", \\\"\\\") }}\"},{\"id\":\"cd227132-971b-4970-8b5d-724463efe036\",\"name\":\"time\",\"type\":\"string\",\"value\":\"={{ \\n  $json[\\\"text\\\"].match(/(上午|下午) (\\\\d{1,2}):(\\\\d{2})/) ? \\n  ($json[\\\"text\\\"].match(/(上午|下午) (\\\\d{1,2}):(\\\\d{2})/)[1] === '下午' && $json[\\\"text\\\"].match(/(上午|下午) (\\\\d{1,2}):(\\\\d{2})/)[2] !== '12' \\n    ? (parseInt($json[\\\"text\\\"].match(/(上午|下午) (\\\\d{1,2}):(\\\\d{2})/)[2]) + 12) + ':' + $json[\\\"text\\\"].match(/(上午|下午) (\\\\d{1,2}):(\\\\d{2})/)[3] \\n    : $json[\\\"text\\\"].match(/(上午|下午) (\\\\d{1,2}):(\\\\d{2})/)[2] + ':' + $json[\\\"text\\\"].match(/(上午|下午) (\\\\d{1,2}):(\\\\d{2})/)[3]\\n  )\\n  : null \\n}}\"}]}},\"typeVersion\":3.4},{\"id\":\"3d8f97ea-4a0d-4939-898f-8a0ca9415e7d\",\"name\":\"Send to Slack with Block\",\"type\":\"n8n-nodes-base.slack\",\"position\":[800,60],\"webhookId\":\"0e812732-74d2-4924-8db3-6b9234965937\",\"parameters\":{\"text\":\"=Ubereat 訂餐資訊: \\n商家:  {{ $json.shop }}\\n金額: {{ $json.price }}\\n日期: {{ $json.date }}\\n\\n記帳網址:\\nmoze3://expense?amount={{ $json.price }}&account=信用卡&subcategory=外送&store={{ $json.shop }}&date={{ $json.date }}\",\"select\":\"channel\",\"blocksUi\":\"={\\n\\t\\\"blocks\\\": [\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"section\\\",\\n\\t\\t\\t\\\"text\\\": {\\n\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\\"text\\\": \\\"Ubereat 訂餐資訊:\\\\n\\\\n*商家:* {{ $json.shop }}\\\\n*金額:* {{ $json.price }}\\\\n*日期:* {{ $json.date }}\\\"\\n\\t\\t\\t}\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"divider\\\"\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"section\\\",\\n\\t\\t\\t\\\"text\\\": {\\n\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\\"text\\\": \\\"Moze 記帳請點我\\\"\\n\\t\\t\\t},\\n\\t\\t\\t\\\"accessory\\\": {\\n\\t\\t\\t\\t\\\"type\\\": \\\"button\\\",\\n\\t\\t\\t\\t\\\"text\\\": {\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"plain_text\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"記帳\\\",\\n\\t\\t\\t\\t\\t\\\"emoji\\\": true\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\\"value\\\": \\\"click\\\",\\n\\t\\t\\t\\t\\\"url\\\": \\\"moze3://expense?amount={{ $json.price }}&account=信用卡&subcategory=外送&store={{ $json.shop }}&date={{ $json.date }}&&project=生活開銷&&time={{ $json.time }}\\\",\\n\\t\\t\\t\\t\\\"action_id\\\": \\\"button-action\\\"\\n\\t\\t\\t}\\n\\t\\t}\\n\\t]\\n}\",\"channelId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"C0883CJM1UH\",\"cachedResultName\":\"外送記帳自動化\"},\"messageType\":\"block\",\"otherOptions\":{},\"authentication\":\"oAuth2\"},\"credentials\":{\"slackOAuth2Api\":{\"id\":\"sD1J9ZLyEhcglrRa\",\"name\":\"Slack account\"}},\"typeVersion\":2.3}],\"active\":true,\"pinData\":{},\"settings\":{\"executionOrder\":\"v1\"},\"versionId\":\"0840254c-0058-47fe-9b22-7fbb93144788\",\"connections\":{\"Loop Over Items\":{\"main\":[[],[{\"node\":\"Extract Price, Shop, Date, TIme\",\"type\":\"main\",\"index\":0}]]},\"Click to Test Flow\":{\"main\":[[{\"node\":\"Get emails from Gmail with certain subject\",\"type\":\"main\",\"index\":0}]]},\"Send to Slack with Block\":{\"main\":[[{\"node\":\"Loop Over Items\",\"type\":\"main\",\"index\":0}]]},\"Extract Price, Shop, Date, TIme\":{\"main\":[[{\"node\":\"Send to Slack with Block\",\"type\":\"main\",\"index\":0}]]},\"Receive certain keyword Gmail Trigger\":{\"main\":[[{\"node\":\"Loop Over Items\",\"type\":\"main\",\"index\":0}]]},\"Get emails from Gmail with certain subject\":{\"main\":[[{\"node\":\"Loop Over Items\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "# Workflow Description\n\nThis workflow automates the process of retrieving emails from a food delivery platform, extracting key order details, and sending notifications to a Slack channel. Additionally, the Slack message includes a **Moze accounting app URL scheme** link for quick expense tracking.\n\n* * *\n\n## Key Features\n\n  1. **Manual Trigger** : Allows the workflow to be executed manually for immediate testing.\n  2. **Gmail Integration** : Retrieves emails containing specific keywords in the subject line (e.g., \"透過 Uber Eats 系統送出的訂單\"). (You can adjust the keywords to fit your language.)\n  3. **Data Extraction** : Parses the email content to extract key details such as: \n     * Order price\n     * Shop name\n     * Order date and time\n  4. **Slack Notification** : Sends a notification to a specified Slack channel using a structured block format, including a link to record the expense in the **Moze accounting app**.\n\n\n\n* * *\n\n## Node Configurations\n\n### 1\\. Manual Trigger\n\n  * **Purpose** : Starts the workflow manually for testing or immediate execution.\n  * **Configuration** : No setup needed.\n\n\n\n* * *\n\n### 2\\. Gmail Trigger\n\n  * **Purpose** : Automatically polls Gmail for new emails matching specific subject keywords.\n  * **Configuration** : \n    * **Filters** : \n      * `q`: `subject:透過 Uber Eats 系統送出的訂單` (You can adjust the keywords to fit your language.)\n    * **Polling Frequency** : Every hour at 30 minutes past the hour.\n    * **Credentials** : Linked Gmail account.\n\n\n\n* * *\n\n### 3\\. Extract Price, Shop, Date, Time\n\n  * **Purpose** : Extracts key information from the email content using regular expressions.\n  * **Extracted Data** : \n    * `price`: Order price (e.g., `$200`).\n    * `shop`: Shop name (e.g., \"店名\").\n    * `date`: Order date (e.g., `2024.01.01`).\n    * `time`: Order time converted to 24-hour format (e.g., `14:30`).\n\n\n\n* * *\n\n### 4\\. Slack Notification\n\n  * **Purpose** : Sends a formatted message to a Slack channel with extracted order details.\n  * **Message Content** : \n    * **Text** :\n          \n          Ubereat 訂餐資訊:\n          商家: {{ shop }}\n          金額: {{ price }}\n          日期: {{ date }}\n          \n\n    * **Moze App Link** : Includes a clickable button in the Slack message with a pre-filled Moze app URL scheme:\n          \n          moze3://expense?amount={{ price }}&account=信用卡&subcategory=外送&store={{ shop }}&date={{ date }}&time={{ time }}&project=生活開銷\n          \n\n    * **Channel** : Slack channel ID associated with food delivery notifications.\n\n\n\n* * *\n\n## Additional Notes\n\n  * **Customization** : Adjust the email subject filter (`subject`) to match other types of food delivery platforms or services.\n  * **Error Handling** : Ensure regular expressions for data extraction match the email format. Test with sample emails before deployment.\n  * **Moze URL Scheme Reference** : Learn more about Moze app URL schemes for customization by visiting the [Moze Documentation](https://moze.app/).\n\n\n\nThis workflow is ideal for automating expense tracking and centralizing notifications for food delivery orders, streamlining personal or team expense management.\n\n* * *\n\nImage:  \nUberEat Gmail with order information  \n![n8n_delievery_slack_moze_step1.PNG](https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/n8n_delievery_slack_moze_step1_bd59d73e86.PNG)\n\nSlack text with button  \n![n8n_delievery_slack_moze_step2.jpg](https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/n8n_delievery_slack_moze_step2_5352662b67.jpg)\n\nClick the button will call moze url scheme  \n![n8n_delievery_slack_moze_step3.jpg](https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/n8n_delievery_slack_moze_step3_029e4eafe8.jpg)\n\n* * *\n\n# 工作流程描述\n\n此工作流程自動化從外送平台獲取郵件，提取關鍵訂單詳細資訊，並將通知發送到指定的 Slack 頻道。此外，Slack 消息中包含一個 **Moze 記帳 App URL Scheme** 的連結，方便快速記帳。\n\n* * *\n\n## 主要功能\n\n  1. **Manual Trigger** ：允許手動執行工作流程，方便測試。\n  2. **Gmail Integration** ：從 Gmail 中提取包含特定關鍵字（例如：「透過 Uber Eats 系統送出的訂單」）的郵件。\n  3. **資料提取** ：解析郵件內容，提取以下關鍵資訊： \n     * 訂單金額\n     * 商家名稱\n     * 訂單日期與時間\n  4. **Slack 通知** ：將結構化的通知發送到指定的 Slack 頻道，並包含一個連結供用戶快速記帳。\n\n\n\n* * *\n\n## 節點設定\n\n### 1\\. Manual Trigger\n\n  * **用途** ：手動啟動工作流程以進行測試或即時執行。\n  * **設定** ：無需額外設定。\n\n\n\n* * *\n\n### 2\\. Gmail Trigger\n\n  * **用途** ：自動檢查 Gmail 中是否有符合特定主題關鍵字的新郵件。\n  * **設定** ： \n    * **篩選條件** ： \n      * `q`: `subject:透過 Uber Eats 系統送出的訂單`\n    * **檢查頻率** ：每小時的 30 分。\n    * **憑證** ：已連結的 Gmail 帳號。\n\n\n\n* * *\n\n### 3\\. Extract Price, Shop, Date, Time\n\n  * **用途** ：使用正則表達式從郵件內容中提取關鍵資訊。\n  * **提取的資料** ： \n    * `price`：訂單金額（例如：`$200`）。\n    * `shop`：商家名稱（例如：「店名」）。\n    * `date`：訂單日期（例如：`2024.01.01`）。\n    * `time`：訂單時間（24 小時制，例如：`14:30`）。\n\n\n\n* * *\n\n### 4\\. Slack 通知\n\n  * **用途** ：將訂單詳細資訊以格式化消息發送到 Slack。\n  * **消息內容** ： \n    * **文字** ：\n          \n          Ubereat 訂餐資訊:\n          商家: {{ shop }}\n          金額: {{ price }}\n          日期: {{ date }}\n          \n\n    * **Moze App 連結** ：Slack 消息中包含一個可點擊按鈕，預填 Moze App URL Scheme：\n          \n          moze3://expense?amount={{ price }}&account=信用卡&subcategory=外送&store={{ shop }}&date={{ date }}&time={{ time }}&project=生活開銷\n          \n\n    * **頻道** ：與外送通知相關的 Slack 頻道。\n\n\n\n* * *\n\n## 補充說明\n\n  * **自訂化** ：可調整郵件主題篩選條件（`subject`），以匹配其他外送平台或服務。\n  * **錯誤處理** ：確保正則表達式匹配郵件格式。在部署前使用樣本郵件進行測試。\n  * **Moze URL Scheme 參考** ：了解更多關於 Moze App URL Scheme 的客製化資訊，請參閱 [Moze 官方文件](https://moze.app/)。\n\n\n\n此工作流程適合自動化費用記帳以及集中管理外送訂單通知，提升個人或團隊的費用管理效率。\n",
  "crawled_at": "2025-05-26T01:46:34.667302"
}