{
  "title": "Automate Solar Lead Qualification & Follow-ups with Google Sheets and Gmail",
  "url": "https://n8n.io/workflows/3794-automate-solar-lead-qualification-and-follow-ups-with-google-sheets-and-gmail/",
  "category": "Marketing",
  "category_url": "https://n8n.io/workflows/categories/marketing/?sort=createdAt:desc",
  "author": "David Olusola",
  "publish_date": "Last update 9 days ago",
  "publish_date_absolute": "2025-05-09",
  "content": "",
  "workflow_json": "{\"id\":\"EX68bhobBio3sE02\",\"meta\":{\"instanceId\":\"2000c64071c20843606b95c63795bb0797c41036047055a6586498e855b96efc\",\"templateCredsSetupCompleted\":true},\"name\":\"Solar lead Qualification\",\"tags\":[],\"nodes\":[{\"id\":\"a679a0ec-7ebb-4f43-992b-dc34cb1c99fe\",\"name\":\"[STEP 1] Receive Form Submission\",\"type\":\"n8n-nodes-base.webhook\",\"position\":[-360,-200],\"webhookId\":\"4e2eb4af-b7da-4f36-bc72-17f0067586ae\",\"parameters\":{},\"typeVersion\":1},{\"id\":\"f1feb012-1930-474a-a9ae-5cf1fb583d17\",\"name\":\"[STEP 2] Upload Utility Bill\",\"type\":\"n8n-nodes-base.googleDrive\",\"position\":[-20,-200],\"parameters\":{},\"typeVersion\":2},{\"id\":\"7bc5a89d-8a75-4b1a-9d26-d4509ed23fa8\",\"name\":\"[STEP 3] Make Bill Viewable\",\"type\":\"n8n-nodes-base.googleDrive\",\"position\":[180,-200],\"parameters\":{},\"typeVersion\":2},{\"id\":\"a99f535d-a07c-432b-981d-2b80a2a831f2\",\"name\":\"[STEP 4] Create Bill Link\",\"type\":\"n8n-nodes-base.function\",\"position\":[360,-200],\"parameters\":{},\"typeVersion\":1},{\"id\":\"c9601137-70f9-407c-99c3-9f9ff3c0d41c\",\"name\":\"[STEP 5] Save Lead to Spreadsheet\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[640,-200],\"parameters\":{},\"typeVersion\":4},{\"id\":\"b933374a-bea5-491c-bb36-5b9565d8130b\",\"name\":\"[STEP 6] Detect New Leads\",\"type\":\"n8n-nodes-base.googleSheetsTrigger\",\"position\":[-400,280],\"parameters\":{},\"typeVersion\":1},{\"id\":\"cb932608-6ba4-4ad3-aa22-bcc2e990d127\",\"name\":\"[STEP 7] Check Qualification Criteria\",\"type\":\"n8n-nodes-base.code\",\"position\":[-200,280],\"parameters\":{},\"typeVersion\":2},{\"id\":\"4f7cbf23-19dd-4bee-b60a-c8a57eefaca2\",\"name\":\"[STEP 8] Update Qualification Status\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[0,280],\"parameters\":{},\"typeVersion\":4.5},{\"id\":\"959b8504-3f7a-4589-9f55-ffc4604e8e11\",\"name\":\"Check Qualification Status\",\"type\":\"n8n-nodes-base.if\",\"position\":[240,280],\"parameters\":{},\"typeVersion\":2.2},{\"id\":\"fad59be0-0b32-4e7f-9ffb-2782e5676d92\",\"name\":\"[STEP 10A] Send Acceptance Email\",\"type\":\"n8n-nodes-base.gmail\",\"position\":[520,140],\"webhookId\":\"7b729e3a-7507-46f6-83ea-05d597281c0f\",\"parameters\":{},\"typeVersion\":2.1},{\"id\":\"e1250129-d863-48ef-b852-3dff4b33f3aa\",\"name\":\"[STEP 10B] Send Rejection Email\",\"type\":\"n8n-nodes-base.gmail\",\"position\":[520,340],\"webhookId\":\"32d2375e-618e-437a-ad41-4fa3092a21d0\",\"parameters\":{},\"typeVersion\":2.1},{\"id\":\"1544ee40-e6fb-4916-82e5-37484cd6871a\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-440,-300],\"parameters\":{\"content\":\"\"},\"typeVersion\":1},{\"id\":\"bab7bc8e-81ea-4b82-bba7-cd371ba1d76c\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-100,-260],\"parameters\":{\"content\":\"\"},\"typeVersion\":1},{\"id\":\"7a85ded0-2506-4a8a-93ff-e48c6a13d1a0\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[560,-280],\"parameters\":{\"content\":\"\"},\"typeVersion\":1},{\"id\":\"c7d3374f-0fba-4b1f-b16c-1247741f25dd\",\"name\":\"Sticky Note3\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-440,100],\"parameters\":{\"content\":\"\"},\"typeVersion\":1},{\"id\":\"bdc653b2-b026-4fcb-822a-0e8778bb34e3\",\"name\":\"Sticky Note4\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[460,40],\"parameters\":{\"content\":\"\"},\"typeVersion\":1},{\"id\":\"1650d1eb-5b94-4b6f-82e9-7bf0501a1dab\",\"name\":\"Sticky Note5\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[880,-400],\"parameters\":{\"content\":\"\"},\"typeVersion\":1}],\"active\":true,\"pinData\":{},\"settings\":{\"executionOrder\":\"v1\"},\"versionId\":\"fade6d0f-ab45-437d-aca2-f1b70a16c0b6\",\"connections\":{\"[STEP 4] Create Bill Link\":{\"main\":[[{\"node\":\"[STEP 5] Save Lead to Spreadsheet\",\"type\":\"main\",\"index\":0}]]},\"[STEP 6] Detect New Leads\":{\"main\":[[{\"node\":\"[STEP 7] Check Qualification Criteria\",\"type\":\"main\",\"index\":0}]]},\"Check Qualification Status\":{\"main\":[[{\"node\":\"[STEP 10A] Send Acceptance Email\",\"type\":\"main\",\"index\":0}],[{\"node\":\"[STEP 10B] Send Rejection Email\",\"type\":\"main\",\"index\":0}]]},\"[STEP 3] Make Bill Viewable\":{\"main\":[[{\"node\":\"[STEP 4] Create Bill Link\",\"type\":\"main\",\"index\":0}]]},\"[STEP 2] Upload Utility Bill\":{\"main\":[[{\"node\":\"[STEP 3] Make Bill Viewable\",\"type\":\"main\",\"index\":0}]]},\"[STEP 1] Receive Form Submission\":{\"main\":[[{\"node\":\"[STEP 2] Upload Utility Bill\",\"type\":\"main\",\"index\":0}]]},\"[STEP 5] Save Lead to Spreadsheet\":{\"main\":[[]]},\"[STEP 8] Update Qualification Status\":{\"main\":[[{\"node\":\"Check Qualification Status\",\"type\":\"main\",\"index\":0}]]},\"[STEP 7] Check Qualification Criteria\":{\"main\":[[{\"node\":\"[STEP 8] Update Qualification Status\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "# Automate Solar Lead Qualification & Follow-ups with Google Sheets and Gmail\n\nNote: This template is designed for self-hosted n8n instances. The workflow image above shows the complete automation flow.\n\nThis n8n workflow automates the entire solar lead qualification process - from capturing lead information through a webhook, storing data in Google Sheets, evaluating qualification criteria, and sending personalized email follow-ups based on qualification status.\n\n## Who is this for?\n\nThis workflow is designed for:\n\n  * Solar installation companies\n  * Solar sales teams\n  * Renewable energy consultants\n  * Lead generation specialists in the solar industry\n\n\n\n## What problem does this workflow solve?\n\nManaging solar leads efficiently can be challenging. This workflow solves several key pain points:\n\n  * Time-consuming manual lead qualification: Automatically evaluates leads against predefined criteria\n  * Inconsistent follow-up: Ensures every lead receives a timely, personalized response\n  * Document management: Securely stores and shares utility bill documents\n  * Lead tracking inefficiency: Centralizes lead data in Google Sheets with qualification status\n\n\n\n## What this workflow does\n\nThis workflow creates a complete solar lead management system that:\n\n  1. Captures lead information through a webhook endpoint\n  2. Securely stores utility bill uploads in Google Drive\n  3. Records all lead data in Google Sheets\n  4. Automatically evaluates leads based on three qualification criteria: \n    * Homeownership status\n    * Credit score (must be 650+)\n    * Absence of trees on roof\n  5. Updates qualification status in the Google Sheet\n  6. Sends personalized email follow-ups based on qualification status: \n    * Qualified leads receive a congratulatory email with next steps\n    * Disqualified leads receive helpful information about why they didn't qualify and suggestions for remediation\n\n\n\n## Setup\n\n### Prerequisites\n\nBefore setting up this workflow, you'll need:\n\n  1. A self-hosted n8n instance\n  2. Google account with access to: \n    * Google Sheets\n    * Google Drive\n    * Gmail\n  3. A form on your website that can make POST requests to a webhook\n\n\n\n### Step 1: Google Sheets Setup\n\n  1. Create a new Google Sheet for storing leads\n  2. Add the following columns in the first row (exact naming is important): \n    * Name\n    * Address\n    * Has Trees on Roof\n    * credit score\n    * phone\n    * Zip code\n    * Email\n    * Homeowner\n    * utility bill\n    * Qualification status\n    * Disqualification reason\n\n\n\n### Step 2: Google Drive Setup\n\n  1. Sign in to your Google Drive account\n  2. Create a folder named \"Solar Lead Utility Bills\" (or your preferred name)\n  3. Right-click on the folder and select \"Share\"\n  4. Set permissions to \"Anyone with the link can view\"\n  5. Note the folder ID from the URL for configuration (the long string after /folders/ in the URL)\n\n\n\n### Step 3: Configure Google Credentials in n8n\n\n  1. In your n8n instance, go to Settings → Credentials\n  2. Add credentials for: \n    * Google Sheets: Create new credentials, follow OAuth2 authentication\n    * Google Drive: Create new credentials, follow OAuth2 authentication\n    * Gmail: Create new credentials, follow OAuth2 authentication\n  3. Ensure all credentials have the necessary scopes: \n    * Google Sheets: .../auth/spreadsheets\n    * Google Drive: .../auth/drive\n    * Gmail: .../auth/gmail.send\n\n\n\n### Step 4: Import and Configure the Workflow\n\n  1. In n8n, go to Workflows → Import from File\n  2. Upload the workflow JSON file\n  3. Update all Google Sheets nodes with your Google Sheet document ID: \n    * Open your Google Sheet\n    * Copy the ID from the URL (long string between /d/ and /edit)\n    * Update the document ID field in the Google Sheets nodes\n  4. In the \"[STEP 2] Upload Utility Bill\" node, set the folder destination to your created folder\n\n\n\n### Step 5: Configure the Webhook\n\n  1. Activate the \"[STEP 1] Receive Form Submission\" webhook node\n  2. Copy the generated webhook URL\n  3. Configure your website form to send data to this URL\n  4. Ensure your form submits the following fields with exact naming: \n    * firstName\n    * lastName\n    * address\n    * hasTreesOnRoof\n    * creditScore\n    * phone\n    * zipCode\n    * email\n    * homeOwnership\n    * utilityBill (file upload)\n\n\n\n### Step 6: Customize Email Templates\n\n  1. Open the \"[STEP 10A] Send Acceptance Email\" node\n  2. Customize the email subject and message to match your company's branding\n  3. Open the \"[STEP 10B] Send Rejection Email\" node\n  4. Customize the rejection email to reflect your company's voice\n\n\n\n### Step 7: Activate and Test\n\n  1. Click \"Save\" on the workflow\n  2. Toggle the \"Active\" switch to activate the workflow\n  3. Submit a test lead through your form\n  4. Check that: \n    * The data appears in your Google Sheet\n    * The qualification status is updated correctly\n    * The appropriate email is sent\n\n\n\n## How to customize this workflow to your needs\n\n### Adjusting Qualification Criteria\n\nYou can modify the qualification logic in the \"[STEP 7] Check Qualification Criteria\" node:\n\n  1. Open the node and click the \"Edit Code\" button\n  2. Locate the criteria sections (homeowner, credit score, trees on roof)\n  3. Modify the conditions as needed:\n\n\n    \n    \n    // Example: Change credit score threshold\n    if (creditScoreRaw.includes(\"600 - 649\") ||\n        creditScoreRaw.includes(\"650 - 689\") ||\n        creditScoreRaw.includes(\"690 - 719\") ||\n        creditScoreRaw.includes(\"720+\")) {\n        creditQualified = true;\n    }\n    \n\n  1. Add additional criteria if needed\n\n\n\n### Customizing Email Templates\n\nPersonalize your emails further:\n\n  1. Open the email nodes\n  2. Use variable references to include more customer data:\n\n\n    \n    \n    Dear {{ $json.Name }},\n    \n    We noticed your utility bill shows an average of {{ $json.monthlyBill }} per month.\n    With solar, you could save approximately {{ $json.monthlySavings }}.\n    \n\n### Adding Integration with CRM Systems\n\nExtend this workflow by connecting it to your CRM:\n\n  1. Add a Hubspot/Salesforce/etc. node after the \"[STEP 8] Update Qualification Status\" node\n  2. Configure the node to create or update contacts in your CRM\n  3. Map the lead data fields to your CRM fields\n\n\n\n## Troubleshooting\n\n### Common Issues\n\n  1. Webhook not receiving data\n\n    * Verify your form is correctly configured to send POST requests\n    * Check CORS settings on your website\n    * Ensure all required fields are being sent\n  2. Google Drive upload failing\n\n    * Check Google Drive permissions\n    * Verify your OAuth scopes include drive.file\n    * Ensure your Drive has sufficient storage space\n  3. Email not sending\n\n    * Verify Gmail credentials\n    * Check if Gmail API is enabled in your Google Cloud Console\n    * Look for Send Rate Exceeded errors in execution logs\n\n\n\n### Google Sheets Column Format\n\nIf you're having issues with data not appearing correctly:\n\n  1. Make sure the column names exactly match those in the code\n  2. Check that the Google Sheet permissions allow editing\n  3. Verify the sheet name is correctly referenced in the nodes\n\n\n\n## Getting Help\n\nIf you encounter issues with this template, you can:\n\n  * Check the n8n documentation on webhooks\n  * Review Google Sheets integration documentation\n  * Post in the n8n community forum\n\n\n\nThis template was created by David Olusola. If you find it helpful, please consider giving it a star in the n8n template library!\n",
  "readme_html": "<!--[--><div data-v-859c7806=\"\"><h1>Automate Solar Lead Qualification &amp; Follow-ups with Google Sheets and Gmail</h1>\n<p>Note: This template is designed for self-hosted n8n instances. The workflow image above shows the complete automation flow.</p>\n<p>This n8n workflow automates the entire solar lead qualification process - from capturing lead information through a webhook, storing data in Google Sheets, evaluating qualification criteria, and sending personalized email follow-ups based on qualification status.</p>\n<h2>Who is this for?</h2>\n<p>This workflow is designed for:</p>\n<ul>\n<li>Solar installation companies</li>\n<li>Solar sales teams</li>\n<li>Renewable energy consultants</li>\n<li>Lead generation specialists in the solar industry</li>\n</ul>\n<h2>What problem does this workflow solve?</h2>\n<p>Managing solar leads efficiently can be challenging. This workflow solves several key pain points:</p>\n<ul>\n<li>Time-consuming manual lead qualification: Automatically evaluates leads against predefined criteria</li>\n<li>Inconsistent follow-up: Ensures every lead receives a timely, personalized response</li>\n<li>Document management: Securely stores and shares utility bill documents</li>\n<li>Lead tracking inefficiency: Centralizes lead data in Google Sheets with qualification status</li>\n</ul>\n<h2>What this workflow does</h2>\n<p>This workflow creates a complete solar lead management system that:</p>\n<ol>\n<li>Captures lead information through a webhook endpoint</li>\n<li>Securely stores utility bill uploads in Google Drive</li>\n<li>Records all lead data in Google Sheets</li>\n<li>Automatically evaluates leads based on three qualification criteria:\n<ul>\n<li>Homeownership status</li>\n<li>Credit score (must be 650+)</li>\n<li>Absence of trees on roof</li>\n</ul>\n</li>\n<li>Updates qualification status in the Google Sheet</li>\n<li>Sends personalized email follow-ups based on qualification status:\n<ul>\n<li>Qualified leads receive a congratulatory email with next steps</li>\n<li>Disqualified leads receive helpful information about why they didn't qualify and suggestions for remediation</li>\n</ul>\n</li>\n</ol>\n<h2>Setup</h2>\n<h3>Prerequisites</h3>\n<p>Before setting up this workflow, you'll need:</p>\n<ol>\n<li>A self-hosted n8n instance</li>\n<li>Google account with access to:\n<ul>\n<li>Google Sheets</li>\n<li>Google Drive</li>\n<li>Gmail</li>\n</ul>\n</li>\n<li>A form on your website that can make POST requests to a webhook</li>\n</ol>\n<h3>Step 1: Google Sheets Setup</h3>\n<ol>\n<li>Create a new Google Sheet for storing leads</li>\n<li>Add the following columns in the first row (exact naming is important):\n<ul>\n<li>Name</li>\n<li>Address</li>\n<li>Has Trees on Roof</li>\n<li>credit score</li>\n<li>phone</li>\n<li>Zip code</li>\n<li>Email</li>\n<li>Homeowner</li>\n<li>utility bill</li>\n<li>Qualification status</li>\n<li>Disqualification reason</li>\n</ul>\n</li>\n</ol>\n<h3>Step 2: Google Drive Setup</h3>\n<ol>\n<li>Sign in to your Google Drive account</li>\n<li>Create a folder named \"Solar Lead Utility Bills\" (or your preferred name)</li>\n<li>Right-click on the folder and select \"Share\"</li>\n<li>Set permissions to \"Anyone with the link can view\"</li>\n<li>Note the folder ID from the URL for configuration (the long string after /folders/ in the URL)</li>\n</ol>\n<h3>Step 3: Configure Google Credentials in n8n</h3>\n<ol>\n<li>In your n8n instance, go to Settings → Credentials</li>\n<li>Add credentials for:\n<ul>\n<li>Google Sheets: Create new credentials, follow OAuth2 authentication</li>\n<li>Google Drive: Create new credentials, follow OAuth2 authentication</li>\n<li>Gmail: Create new credentials, follow OAuth2 authentication</li>\n</ul>\n</li>\n<li>Ensure all credentials have the necessary scopes:\n<ul>\n<li>Google Sheets: .../auth/spreadsheets</li>\n<li>Google Drive: .../auth/drive</li>\n<li>Gmail: .../auth/gmail.send</li>\n</ul>\n</li>\n</ol>\n<h3>Step 4: Import and Configure the Workflow</h3>\n<ol>\n<li>In n8n, go to Workflows → Import from File</li>\n<li>Upload the workflow JSON file</li>\n<li>Update all Google Sheets nodes with your Google Sheet document ID:\n<ul>\n<li>Open your Google Sheet</li>\n<li>Copy the ID from the URL (long string between /d/ and /edit)</li>\n<li>Update the document ID field in the Google Sheets nodes</li>\n</ul>\n</li>\n<li>In the \"[STEP 2] Upload Utility Bill\" node, set the folder destination to your created folder</li>\n</ol>\n<h3>Step 5: Configure the Webhook</h3>\n<ol>\n<li>Activate the \"[STEP 1] Receive Form Submission\" webhook node</li>\n<li>Copy the generated webhook URL</li>\n<li>Configure your website form to send data to this URL</li>\n<li>Ensure your form submits the following fields with exact naming:\n<ul>\n<li>firstName</li>\n<li>lastName</li>\n<li>address</li>\n<li>hasTreesOnRoof</li>\n<li>creditScore</li>\n<li>phone</li>\n<li>zipCode</li>\n<li>email</li>\n<li>homeOwnership</li>\n<li>utilityBill (file upload)</li>\n</ul>\n</li>\n</ol>\n<h3>Step 6: Customize Email Templates</h3>\n<ol>\n<li>Open the \"[STEP 10A] Send Acceptance Email\" node</li>\n<li>Customize the email subject and message to match your company's branding</li>\n<li>Open the \"[STEP 10B] Send Rejection Email\" node</li>\n<li>Customize the rejection email to reflect your company's voice</li>\n</ol>\n<h3>Step 7: Activate and Test</h3>\n<ol>\n<li>Click \"Save\" on the workflow</li>\n<li>Toggle the \"Active\" switch to activate the workflow</li>\n<li>Submit a test lead through your form</li>\n<li>Check that:\n<ul>\n<li>The data appears in your Google Sheet</li>\n<li>The qualification status is updated correctly</li>\n<li>The appropriate email is sent</li>\n</ul>\n</li>\n</ol>\n<h2>How to customize this workflow to your needs</h2>\n<h3>Adjusting Qualification Criteria</h3>\n<p>You can modify the qualification logic in the \"[STEP 7] Check Qualification Criteria\" node:</p>\n<ol>\n<li>Open the node and click the \"Edit Code\" button</li>\n<li>Locate the criteria sections (homeowner, credit score, trees on roof)</li>\n<li>Modify the conditions as needed:</li>\n</ol>\n<pre><code>// Example: Change credit score threshold\nif (creditScoreRaw.includes(\"600 - 649\") ||\n    creditScoreRaw.includes(\"650 - 689\") ||\n    creditScoreRaw.includes(\"690 - 719\") ||\n    creditScoreRaw.includes(\"720+\")) {\n    creditQualified = true;\n}\n</code></pre>\n<ol>\n<li>Add additional criteria if needed</li>\n</ol>\n<h3>Customizing Email Templates</h3>\n<p>Personalize your emails further:</p>\n<ol>\n<li>Open the email nodes</li>\n<li>Use variable references to include more customer data:</li>\n</ol>\n<pre><code>Dear {{ $json.Name }},\n\nWe noticed your utility bill shows an average of {{ $json.monthlyBill }} per month.\nWith solar, you could save approximately {{ $json.monthlySavings }}.\n</code></pre>\n<h3>Adding Integration with CRM Systems</h3>\n<p>Extend this workflow by connecting it to your CRM:</p>\n<ol>\n<li>Add a Hubspot/Salesforce/etc. node after the \"[STEP 8] Update Qualification Status\" node</li>\n<li>Configure the node to create or update contacts in your CRM</li>\n<li>Map the lead data fields to your CRM fields</li>\n</ol>\n<h2>Troubleshooting</h2>\n<h3>Common Issues</h3>\n<ol>\n<li>\n<p>Webhook not receiving data</p>\n<ul>\n<li>Verify your form is correctly configured to send POST requests</li>\n<li>Check CORS settings on your website</li>\n<li>Ensure all required fields are being sent</li>\n</ul>\n</li>\n<li>\n<p>Google Drive upload failing</p>\n<ul>\n<li>Check Google Drive permissions</li>\n<li>Verify your OAuth scopes include drive.file</li>\n<li>Ensure your Drive has sufficient storage space</li>\n</ul>\n</li>\n<li>\n<p>Email not sending</p>\n<ul>\n<li>Verify Gmail credentials</li>\n<li>Check if Gmail API is enabled in your Google Cloud Console</li>\n<li>Look for Send Rate Exceeded errors in execution logs</li>\n</ul>\n</li>\n</ol>\n<h3>Google Sheets Column Format</h3>\n<p>If you're having issues with data not appearing correctly:</p>\n<ol>\n<li>Make sure the column names exactly match those in the code</li>\n<li>Check that the Google Sheet permissions allow editing</li>\n<li>Verify the sheet name is correctly referenced in the nodes</li>\n</ol>\n<h2>Getting Help</h2>\n<p>If you encounter issues with this template, you can:</p>\n<ul>\n<li>Check the n8n documentation on webhooks</li>\n<li>Review Google Sheets integration documentation</li>\n<li>Post in the n8n community forum</li>\n</ul>\n<p>This template was created by David Olusola. If you find it helpful, please consider giving it a star in the n8n template library!</p>\n</div><!--]-->",
  "readme_zh": "# 使用Google Sheets和Gmail实现太阳能潜在客户自动筛选与跟进\n\n注意：本模板专为自托管n8n实例设计。上方工作流图示展示了完整的自动化流程。\n\n该n8n工作流实现了太阳能潜在客户筛选全流程自动化——从通过Webhook捕获客户信息、将数据存储至Google Sheets、评估筛选标准，到根据筛选状态发送个性化跟进邮件。\n\n## 适用对象\n\n本工作流适用于：\n* 太阳能安装公司\n* 太阳能销售团队\n* 可再生能源顾问\n* 太阳能行业潜在客户开发专家\n\n## 解决痛点\n\n高效管理太阳能潜在客户存在诸多挑战，本工作流解决了以下关键问题：\n* 耗时的人工筛选流程：根据预设标准自动评估潜在客户\n* 跟进不一致性：确保每位客户都能获得及时、个性化的回复\n* 文件管理难题：安全存储并共享公用事业账单文件\n* 潜在客户追踪低效：在Google Sheets中集中管理客户数据及筛选状态\n\n## 功能概述\n\n本工作流构建了完整的太阳能潜在客户管理系统，能够：\n1. 通过Webhook端点捕获客户信息\n2. 将公用事业账单安全存储至Google Drive\n3. 在Google Sheets中记录所有客户数据\n4. 基于三项标准自动评估客户资质：\n   * 房屋所有权状态\n   * 信用评分（需650分以上）\n   * 屋顶无树木遮挡\n5. 在Google Sheets中更新筛选状态\n6. 根据筛选状态发送个性化跟进邮件：\n   * 合格客户将收到包含后续步骤的祝贺邮件\n   * 未达标客户将获知未通过原因及改进建议\n\n## 配置指南\n\n### 先决条件\n使用前需准备：\n1. 自托管n8n实例\n2. 具备以下服务访问权限的Google账号：\n   * Google Sheets\n   * Google Drive\n   * Gmail\n3. 支持向Webhook发送POST请求的网站表单\n\n### 第一步：Google Sheets设置\n1. 新建用于存储客户的Google Sheet\n2. 在第一行添加以下列（名称需严格一致）：\n   * 姓名\n   * 地址\n   * 屋顶是否有树\n   * 信用评分\n   * 电话\n   * 邮编\n   * 邮箱\n   * 房主身份\n   * 公用事业账单\n   * 筛选状态\n   * 未达标原因\n\n### 第二步：Google Drive设置\n1. 登录Google Drive\n2. 创建名为\"太阳能客户公用事业账单\"的文件夹\n3. 右键文件夹选择\"共享\"\n4. 设置权限为\"任何拥有链接者均可查看\"\n5. 记录URL中的文件夹ID（/folders/后的长字符串）\n\n### 第三步：n8n中的Google凭证配置\n1. 在n8n实例中进入设置→凭证\n2. 添加以下凭证：\n   * Google Sheets：新建凭证，使用OAuth2验证\n   * Google Drive：新建凭证，使用OAuth2验证\n   * Gmail：新建凭证，使用OAuth2验证\n3. 确保所有凭证具备必要权限范围：\n   * Google Sheets：.../auth/spreadsheets\n   * Google Drive：.../auth/drive\n   * Gmail：.../auth/gmail.send\n\n### 第四步：导入并配置工作流\n1. 在n8n中选择工作流→从文件导入\n2. 上传工作流JSON文件\n3. 在所有Google Sheets节点中更新文档ID：\n   * 打开您的Google Sheet\n   * 从URL复制ID（/d/与/edit间的字符串）\n   * 更新Google Sheets节点中的文档ID字段\n4. 在\"[STEP 2]上传公用事业账单\"节点中设置目标文件夹\n\n### 第五步：配置Webhook\n1. 激活\"[STEP 1]接收表单提交\"Webhook节点\n2. 复制生成的Webhook URL\n3. 配置网站表单向该URL发送数据\n4. 确保表单提交以下字段（名称需严格一致）：\n   * 名\n   * 姓\n   * 地址\n   * 屋顶是否有树\n   * 信用评分\n   * 电话\n   * 邮编\n   * 邮箱\n   * 房产所有权\n   * 公用事业账单（文件上传）\n\n### 第六步：自定义邮件模板\n1. 打开\"[STEP 10A]发送接受邮件\"节点\n2. 根据公司品牌定制邮件主题和内容\n3. 打开\"[STEP 10B]发送拒绝邮件\"节点\n4. 调整拒绝邮件内容以符合公司风格\n\n### 第七步：激活测试\n1. 点击工作流\"保存\"\n2. 切换\"激活\"开关启用工作流\n3. 通过表单提交测试客户\n4. 验证：\n   * 数据是否出现在Google Sheet中\n   * 筛选状态是否正确更新\n   * 是否发送了相应邮件\n\n## 自定义指南\n\n### 调整筛选标准\n可在\"[STEP 7]检查筛选标准\"节点修改逻辑：\n1. 打开节点点击\"编辑代码\"\n2. 定位标准部分（房主身份、信用评分、屋顶树木）\n3. 按需修改条件：\n```javascript\n// 示例：调整信用评分阈值\nif (creditScoreRaw.includes(\"600 - 649\") ||\n    creditScoreRaw.includes(\"650 - 689\") ||\n    creditScoreRaw.includes(\"690 - 719\") ||\n    creditScoreRaw.includes(\"720+\")) {\n    creditQualified = true;\n}\n```\n4. 如需可添加额外标准\n\n### 定制邮件模板\n深度个性化邮件：\n1. 打开邮件节点\n2. 使用变量引用更多客户数据：\n```\n尊敬的{{ $json.姓名 }}，\n\n我们注意到您的公用事业账单显示月均消费{{ $json.月账单金额 }}。\n使用太阳能后，预计每月可节省{{ $json.月节省金额 }}。\n```\n\n### 集成CRM系统\n扩展工作流连接至CRM：\n1. 在\"[STEP 8]更新筛选状态\"节点后添加Hubspot/Salesforce等节点\n2. 配置节点在CRM中创建/更新联系人\n3. 映射客户数据字段至CRM字段\n\n## 故障排除\n\n### 常见问题\n1. Webhook未接收数据\n   * 确认表单正确配置POST请求\n   * 检查网站CORS设置\n   * 确保发送了所有必填字段\n2. Google Drive上传失败\n   * 检查Google Drive权限\n   * 确认OAuth范围包含drive.file\n   * 确保Drive有足够存储空间\n3. 邮件未发送\n   * 验证Gmail凭证\n   * 检查Google云控制台是否启用Gmail API\n   * 查看执行日志中的发送频率超限错误\n\n### Google Sheets列格式\n如遇数据显示异常：\n1. 确保列名与代码完全匹配\n2. 检查Google Sheet是否允许编辑\n3. 确认节点中正确引用了工作表名称\n\n## 获取帮助\n如遇问题可通过以下方式解决：\n* 查阅n8n关于Webhook的文档\n* 查看Google Sheets集成文档\n* 在n8n社区论坛发帖\n\n本模板由David Olusola创建。如果您觉得有用，请在n8n模板库为其点赞！",
  "title_zh": "利用Google Sheets和Gmail实现太阳能潜在客户自动筛选与跟进",
  "publish_date_zh": "上次更新于9天前",
  "workflow_json_zh": "{\"id\":\"EX68bhobBio3sE02\",\"meta\":{\"instanceId\":\"2000c64071c20843606b95c63795bb0797c41036047055a6586498e855b96efc\",\"templateCredsSetupCompleted\":true},\"name\":\"Solar lead Qualification\",\"tags\":[],\"nodes\":[{\"id\":\"a679a0ec-7ebb-4f43-992b-dc34cb1c99fe\",\"name\":\"[STEP 1] Receive Form Submission\",\"type\":\"n8n-nodes-base.webhook\",\"position\":[-360,-200],\"webhookId\":\"4e2eb4af-b7da-4f36-bc72-17f0067586ae\",\"parameters\":{},\"typeVersion\":1},{\"id\":\"f1feb012-1930-474a-a9ae-5cf1fb583d17\",\"name\":\"[STEP 2] Upload Utility Bill\",\"type\":\"n8n-nodes-base.googleDrive\",\"position\":[-20,-200],\"parameters\":{},\"typeVersion\":2},{\"id\":\"7bc5a89d-8a75-4b1a-9d26-d4509ed23fa8\",\"name\":\"[STEP 3] Make Bill Viewable\",\"type\":\"n8n-nodes-base.googleDrive\",\"position\":[180,-200],\"parameters\":{},\"typeVersion\":2},{\"id\":\"a99f535d-a07c-432b-981d-2b80a2a831f2\",\"name\":\"[STEP 4] Create Bill Link\",\"type\":\"n8n-nodes-base.function\",\"position\":[360,-200],\"parameters\":{},\"typeVersion\":1},{\"id\":\"c9601137-70f9-407c-99c3-9f9ff3c0d41c\",\"name\":\"[STEP 5] Save Lead to Spreadsheet\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[640,-200],\"parameters\":{},\"typeVersion\":4},{\"id\":\"b933374a-bea5-491c-bb36-5b9565d8130b\",\"name\":\"[STEP 6] Detect New Leads\",\"type\":\"n8n-nodes-base.googleSheetsTrigger\",\"position\":[-400,280],\"parameters\":{},\"typeVersion\":1},{\"id\":\"cb932608-6ba4-4ad3-aa22-bcc2e990d127\",\"name\":\"[STEP 7] Check Qualification Criteria\",\"type\":\"n8n-nodes-base.code\",\"position\":[-200,280],\"parameters\":{},\"typeVersion\":2},{\"id\":\"4f7cbf23-19dd-4bee-b60a-c8a57eefaca2\",\"name\":\"[STEP 8] Update Qualification Status\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[0,280],\"parameters\":{},\"typeVersion\":4.5},{\"id\":\"959b8504-3f7a-4589-9f55-ffc4604e8e11\",\"name\":\"Check Qualification Status\",\"type\":\"n8n-nodes-base.if\",\"position\":[240,280],\"parameters\":{},\"typeVersion\":2.2},{\"id\":\"fad59be0-0b32-4e7f-9ffb-2782e5676d92\",\"name\":\"[STEP 10A] Send Acceptance Email\",\"type\":\"n8n-nodes-base.gmail\",\"position\":[520,140],\"webhookId\":\"7b729e3a-7507-46f6-83ea-05d597281c0f\",\"parameters\":{},\"typeVersion\":2.1},{\"id\":\"e1250129-d863-48ef-b852-3dff4b33f3aa\",\"name\":\"[STEP 10B] Send Rejection Email\",\"type\":\"n8n-nodes-base.gmail\",\"position\":[520,340],\"webhookId\":\"32d2375e-618e-437a-ad41-4fa3092a21d0\",\"parameters\":{},\"typeVersion\":2.1},{\"id\":\"1544ee40-e6fb-4916-82e5-37484cd6871a\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-440,-300],\"parameters\":{\"content\":\"\"},\"typeVersion\":1},{\"id\":\"bab7bc8e-81ea-4b82-bba7-cd371ba1d76c\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-100,-260],\"parameters\":{\"content\":\"\"},\"typeVersion\":1},{\"id\":\"7a85ded0-2506-4a8a-93ff-e48c6a13d1a0\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[560,-280],\"parameters\":{\"content\":\"\"},\"typeVersion\":1},{\"id\":\"c7d3374f-0fba-4b1f-b16c-1247741f25dd\",\"name\":\"Sticky Note3\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-440,100],\"parameters\":{\"content\":\"\"},\"typeVersion\":1},{\"id\":\"bdc653b2-b026-4fcb-822a-0e8778bb34e3\",\"name\":\"Sticky Note4\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[460,40],\"parameters\":{\"content\":\"\"},\"typeVersion\":1},{\"id\":\"1650d1eb-5b94-4b6f-82e9-7bf0501a1dab\",\"name\":\"Sticky Note5\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[880,-400],\"parameters\":{\"content\":\"\"},\"typeVersion\":1}],\"active\":true,\"pinData\":{},\"settings\":{\"executionOrder\":\"v1\"},\"versionId\":\"fade6d0f-ab45-437d-aca2-f1b70a16c0b6\",\"connections\":{\"[STEP 4] Create Bill Link\":{\"main\":[[{\"node\":\"[STEP 5] Save Lead to Spreadsheet\",\"type\":\"main\",\"index\":0}]]},\"[STEP 6] Detect New Leads\":{\"main\":[[{\"node\":\"[STEP 7] Check Qualification Criteria\",\"type\":\"main\",\"index\":0}]]},\"Check Qualification Status\":{\"main\":[[{\"node\":\"[STEP 10A] Send Acceptance Email\",\"type\":\"main\",\"index\":0}],[{\"node\":\"[STEP 10B] Send Rejection Email\",\"type\":\"main\",\"index\":0}]]},\"[STEP 3] Make Bill Viewable\":{\"main\":[[{\"node\":\"[STEP 4] Create Bill Link\",\"type\":\"main\",\"index\":0}]]},\"[STEP 2] Upload Utility Bill\":{\"main\":[[{\"node\":\"[STEP 3] Make Bill Viewable\",\"type\":\"main\",\"index\":0}]]},\"[STEP 1] Receive Form Submission\":{\"main\":[[{\"node\":\"[STEP 2] Upload Utility Bill\",\"type\":\"main\",\"index\":0}]]},\"[STEP 5] Save Lead to Spreadsheet\":{\"main\":[[]]},\"[STEP 8] Update Qualification Status\":{\"main\":[[{\"node\":\"Check Qualification Status\",\"type\":\"main\",\"index\":0}]]},\"[STEP 7] Check Qualification Criteria\":{\"main\":[[{\"node\":\"[STEP 8] Update Qualification Status\",\"type\":\"main\",\"index\":0}]]}}}"
}