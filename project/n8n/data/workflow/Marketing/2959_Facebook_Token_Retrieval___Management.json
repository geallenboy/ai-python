{
  "title": "Facebook Token Retrieval & Management",
  "url": "https://n8n.io/workflows/2959-facebook-token-retrieval-and-management/",
  "category": "Marketing",
  "category_url": "https://n8n.io/workflows/categories/marketing/?sort=createdAt:desc",
  "author": "L Hùng",
  "publish_date": "Last update 2 months ago",
  "publish_date_absolute": "2025-03-19",
  "content": "",
  "workflow_json": "{\"id\":\"MVhWWLZv7PhhLSq2\",\"meta\":{\"instanceId\":\"2c69a61055797162319204105e5a124e409f0c7fbfaba08ee106324374f4ae73\",\"templateCredsSetupCompleted\":true},\"name\":\"Facebook Token Mew\",\"tags\":[],\"nodes\":[{\"id\":\"ecd428ff-673c-435c-a6b3-723ae6f3f88d\",\"name\":\"Webhook\",\"type\":\"n8n-nodes-base.webhook\",\"position\":[1680,280],\"webhookId\":\"9e37ff8f-66fd-417b-97af-570e52622d7b\",\"parameters\":{\"path\":\"facebook-login\",\"options\":{},\"responseMode\":\"responseNode\"},\"typeVersion\":2},{\"id\":\"7fe9fcb7-49f3-4628-8a9f-2027f9dffd61\",\"name\":\"If\",\"type\":\"n8n-nodes-base.if\",\"position\":[2360,280],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"loose\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"ce391d94-03af-42d1-ae73-91bdb2e93c00\",\"operator\":{\"type\":\"string\",\"operation\":\"notEmpty\",\"singleValue\":true},\"leftValue\":\"={{ $('Webhook').first().json.query.code }}\",\"rightValue\":\"login\"}]},\"looseTypeValidation\":true},\"typeVersion\":2.2},{\"id\":\"ded6d8fa-3add-4084-a9f2-172a5d51158b\",\"name\":\"Short-Lived Token\",\"type\":\"n8n-nodes-base.httpRequest\",\"onError\":\"continueErrorOutput\",\"position\":[2720,140],\"parameters\":{\"url\":\"https://graph.facebook.com/v21.0/oauth/access_token\",\"options\":{},\"sendQuery\":true,\"queryParameters\":{\"parameters\":[{\"name\":\"client_id\",\"value\":\"={{ $('Config').first().json.app_id }}\"},{\"name\":\"redirect_uri\",\"value\":\"={{ $('Config').first().json.fb_redirect_uri }}\"},{\"name\":\"client_secret\",\"value\":\"={{ $('Config').first().json.app_secret }}\"},{\"name\":\"code\",\"value\":\"={{ $('Webhook').first().json.query.code }}\"}]}},\"retryOnFail\":true,\"typeVersion\":4.2,\"alwaysOutputData\":false,\"waitBetweenTries\":5000},{\"id\":\"27fed69c-e476-4e19-870e-f26ed707e36a\",\"name\":\"Long-Lived Token\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[3000,-100],\"parameters\":{\"url\":\"https://graph.facebook.com/v21.0/oauth/access_token\",\"options\":{},\"sendQuery\":true,\"queryParameters\":{\"parameters\":[{\"name\":\"grant_type\",\"value\":\"fb_exchange_token\"},{\"name\":\"client_id\",\"value\":\"={{ $('Config').first().json.app_id }}\"},{\"name\":\"client_secret\",\"value\":\"={{ $('Config').first().json.app_secret }}\"},{\"name\":\"fb_exchange_token\",\"value\":\"={{ $('Short-Lived Token').first().json.access_token }}\"}]}},\"retryOnFail\":true,\"typeVersion\":4.2,\"waitBetweenTries\":5000},{\"id\":\"94e38177-b72f-4e99-9e2f-e43bd679589b\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1660,-800],\"parameters\":{\"width\":920,\"height\":900,\"content\":\"### Instructions to Get a 2-Month Facebook Token\\nRun n8n with tunnel model - Or user: Ngrok, Cloudflare Tunnel\\n\\n1. **Activate the App**:\\n   - Launch the app. In the top-right corner near the **Save** button, you will see a status button labeled **Inactive**.\\n   - Switch this button to **Active** (it will turn green) to activate the app.\\n\\n2. **Access the Webhook URL**:\\n   - Visit the following URL (fb_redirect_uri):  \\n      https://localhost:5678/webhook/facebook-login?type=login\\n\\n3. **Follow the Steps**:\\n   - Complete the on-screen instructions to finish the process.\\n   - Once done, you will receive a **Facebook Token** valid for **2 months (60 days)**.\\n\\n\\n### Instructions to Check Token Status and Get Page Token\\n1. **Check Token Status**:\\n   - Go to [Facebook Access Token Debugger](https://developers.facebook.com/tools/debug/accesstoken/).\\n   - Paste your **User Token** into the debugger to view details such as expiration date, permissions, and token status.\\n\\n2. **Get Page Token for Posting**:\\n   - A **User Token** only grants access to personal information. To post on a Page, you need a **Page Token**.\\n   - Send a GET request to the following endpoint (replace `{user-access-token}` with your User Token):\\n     ```\\n     GET https://graph.facebook.com/v21.0/me/accounts?access_token={user-access-token}\\n     ```\\n   - The response will include a list of Pages you manage along with their corresponding **Page Tokens**.\\n\\n3. **Use the Page Token**:\\n   - Use the **Page Token** to perform actions such as posting, managing comments, or other tasks on the Page.\\n\\n**Note**:\\n- Ensure the User Token has the necessary permissions like `pages_manage_posts`, `pages_read_engagement`, etc., to retrieve the Page Token.\\n- The Page Token will have the same expiration as the User Token (approximately 60 days) and can be renewed.\\n\\n\\n`https://github.com/luuhung93/n8n-json`\"},\"typeVersion\":1},{\"id\":\"4af7f1f6-9479-4489-9282-7083cd29649c\",\"name\":\"Redirect URL\",\"type\":\"n8n-nodes-base.code\",\"position\":[2980,480],\"parameters\":{\"jsCode\":\"const config = $('Config').first().json;\\n\\n\\nconst generateRandomState = () => {\\n\\treturn Math.random().toString(36).substring(2, 15) +\\n\\t\\tMath.random().toString(36).substring(2, 15);\\n}\\nconst state = generateRandomState();\\n\\nconst correctScopes = [\\n        'publish_video',\\n\\t\\t'pages_show_list',\\n\\t\\t'business_management',\\n        'pages_read_engagement',\\n        'pages_read_user_content',\\n        'pages_manage_metadata',\\n        'pages_manage_posts',\\n        'pages_manage_engagement',\\n\\t];\\n\\nconst authUrl = `https://www.facebook.com/v22.0/dialog/oauth?client_id=${config.app_id}&redirect_uri=${config.fb_redirect_uri}&scope=${correctScopes.join(',')}&response_type=code&state=${state}`;\\n\\nreturn [{\\n  authUrl\\n}];\"},\"typeVersion\":2},{\"id\":\"b415e387-17ed-4451-ae7d-b8d1fdf8ee06\",\"name\":\"Redirect\",\"type\":\"n8n-nodes-base.respondToWebhook\",\"position\":[3740,480],\"parameters\":{\"options\":{},\"redirectURL\":\"={{ $json.authUrl }}\",\"respondWith\":\"redirect\"},\"typeVersion\":1.1},{\"id\":\"d59290d9-79b5-4212-a8ad-a1a9e074bbf2\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1840,140],\"parameters\":{\"width\":420,\"height\":480,\"content\":\"Edit:\\n - fb_redirect_uri\\n - app_id\\n - app_secret\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nGo to the [Facebook App](https://developers.facebook.com/apps/).\\n    - Select **Facebook Login** from the left-hand menu.\\n    - Click on **Settings**.\\n    - In the **Valid OAuth Redirect URIs** section, add the URL (fb_redirect_uri): `https://localhost:5678/webhook/facebook-login`\"},\"typeVersion\":1},{\"id\":\"952f17fa-efdf-4523-9d9b-ff071670e425\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[2460,460],\"parameters\":{\"width\":640,\"height\":760,\"content\":\"\\n\\n\\n\\n### Guide to Editing `correctScopes`\\n\\n1. **Add a Permission**:\\n   - Add the permission to the `correctScopes` array. For example:\\n     ```javascript\\n     const correctScopes = [\\n       'pages_manage_posts', // Existing permission\\n       'pages_messaging',    // New permission added\\n     ];\\n     ```\\n\\n2. **Edit a Permission**:\\n   - Replace a permission in the `correctScopes` array. For example:\\n     ```javascript\\n     const correctScopes = [\\n       'pages_manage_posts', // Existing permission\\n       'pages_messaging',    // New permission replacing the old one\\n     ];\\n     ```\\n\\n3. **Remove a Permission**:\\n   - Remove a permission from the `correctScopes` array. For example:\\n     ```javascript\\n     const correctScopes = [\\n       'pages_manage_posts', // Keep this permission\\n       // 'pages_messaging',  // Remove this permission\\n     ];\\n     ```\\n\\n4. **View Available Permissions**:\\n   - Refer to the full list of permissions at [Facebook Permissions](https://developers.facebook.com/docs/permissions/).\\n\\nSimply edit the `correctScopes` array; no need to worry about other parts.\\n\"},\"typeVersion\":1},{\"id\":\"dbc712ba-1a95-4041-ac27-824d804726bc\",\"name\":\"Token\",\"type\":\"n8n-nodes-base.respondToWebhook\",\"position\":[3700,-100],\"parameters\":{\"options\":{},\"respondWith\":\"text\",\"responseBody\":\"={{ $json.access_token }}\"},\"typeVersion\":1.1},{\"id\":\"560d3c3f-a0e8-432e-904f-71cd7525fd0d\",\"name\":\"Sticky Note3\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[3280,-180],\"parameters\":{\"width\":280,\"content\":\"By default, the token will be displayed on the screen. However, you can add a `node` to save the token into your database.\"},\"typeVersion\":1},{\"id\":\"99e67d66-5179-4186-b78f-ced80ab5dd82\",\"name\":\"Config\",\"type\":\"n8n-nodes-base.set\",\"position\":[1980,280],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"c210cd1e-ff2d-47cb-b9c4-af1e9a91ec71\",\"name\":\"fb_redirect_uri\",\"type\":\"string\",\"value\":\"https://localhost:5678/webhook/facebook-login\"},{\"id\":\"3f24bd07-905f-4c3c-bd07-2661e0a95d7a\",\"name\":\"app_id\",\"type\":\"string\",\"value\":\"12345678900000\"},{\"id\":\"51de3a11-3e7f-4c8e-9c2c-63ae28a14eb8\",\"name\":\"app_secret\",\"type\":\"string\",\"value\":\"aaabbbcccceedb6f9c91993c871\"}]}},\"typeVersion\":3.4}],\"active\":false,\"pinData\":{},\"settings\":{\"timezone\":\"Asia/Ho_Chi_Minh\",\"callerPolicy\":\"workflowsFromSameOwner\",\"executionOrder\":\"v1\"},\"versionId\":\"c2d0b26b-3366-424a-a741-20649907f008\",\"connections\":{\"If\":{\"main\":[[{\"node\":\"Short-Lived Token\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Redirect URL\",\"type\":\"main\",\"index\":0}]]},\"Config\":{\"main\":[[{\"node\":\"If\",\"type\":\"main\",\"index\":0}]]},\"Webhook\":{\"main\":[[{\"node\":\"Config\",\"type\":\"main\",\"index\":0}]]},\"Redirect URL\":{\"main\":[[{\"node\":\"Redirect\",\"type\":\"main\",\"index\":0}]]},\"Long-Lived Token\":{\"main\":[[{\"node\":\"Token\",\"type\":\"main\",\"index\":0}]]},\"Short-Lived Token\":{\"main\":[[{\"node\":\"Long-Lived Token\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Redirect URL\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "## Pre-Conditions\n\n  1. A Facebook Developer account with an active app.\n  2. Basic understanding of n8n workflows.\n  3. Access to a database (optional, for storing tokens).\n\n\n\n## Setup\n\n  1. **Webhook Activation** :\n\n     * Configure the Webhook to receive user requests and process input data.\n     * Ensure the Webhook URL is correctly set in your Facebook App settings.\n  2. **Short-Lived Token Retrieval** :\n\n     * Use **Facebook OAuth** to fetch a short-lived token from the authorization code.\n  3. **Long-Lived Token Conversion** :\n\n     * Convert the short-lived token into a long-lived token (valid for ~60 days).\n  4. **Page Token Retrieval** :\n\n     * Follow the provided instructions to retrieve **Page Tokens** for posting on managed Facebook Pages.\n  5. **Customizable Scopes** :\n\n     * Edit the `correctScopes` array to include or exclude permissions as needed.\n  6. **Optional Database Storage** :\n\n     * Extend the workflow to save tokens to a database instead of displaying them on-screen.\n  7. **Step-by-Step Instructions** :\n\n     * Detailed guidance is provided via sticky notes for activating the app, configuring Webhook, and editing parameters like `fb_redirect_uri`, `app_id`, and `app_secret`.\n\n\n\n## Who the Template is For\n\n  * **Developers** : Integrating Facebook APIs into their applications.\n  * **Social Media Managers** : Automating posting and engagement on Facebook Pages.\n  * **n8n Users** : Looking for a ready-to-use workflow for Facebook Token management.\n\n\n\n## Primary Use\n\n  * Automates Facebook Token retrieval and management.\n  * Supports posting to Facebook Pages via **Page Tokens**.\n  * Easily customizable and extendable for specific requirements.\n\n\n",
  "readme_html": "<!--[--><div data-v-50766329=\"\"><h2>Pre-Conditions</h2>\n<ol>\n<li>A Facebook Developer account with an active app.</li>\n<li>Basic understanding of n8n workflows.</li>\n<li>Access to a database (optional, for storing tokens).</li>\n</ol>\n<h2>Setup</h2>\n<ol>\n<li>\n<p><strong>Webhook Activation</strong>:</p>\n<ul>\n<li>Configure the Webhook to receive user requests and process input data.</li>\n<li>Ensure the Webhook URL is correctly set in your Facebook App settings.</li>\n</ul>\n</li>\n<li>\n<p><strong>Short-Lived Token Retrieval</strong>:</p>\n<ul>\n<li>Use <strong>Facebook OAuth</strong> to fetch a short-lived token from the authorization code.</li>\n</ul>\n</li>\n<li>\n<p><strong>Long-Lived Token Conversion</strong>:</p>\n<ul>\n<li>Convert the short-lived token into a long-lived token (valid for ~60 days).</li>\n</ul>\n</li>\n<li>\n<p><strong>Page Token Retrieval</strong>:</p>\n<ul>\n<li>Follow the provided instructions to retrieve <strong>Page Tokens</strong> for posting on managed Facebook Pages.</li>\n</ul>\n</li>\n<li>\n<p><strong>Customizable Scopes</strong>:</p>\n<ul>\n<li>Edit the <code>correctScopes</code> array to include or exclude permissions as needed.</li>\n</ul>\n</li>\n<li>\n<p><strong>Optional Database Storage</strong>:</p>\n<ul>\n<li>Extend the workflow to save tokens to a database instead of displaying them on-screen.</li>\n</ul>\n</li>\n<li>\n<p><strong>Step-by-Step Instructions</strong>:</p>\n<ul>\n<li>Detailed guidance is provided via sticky notes for activating the app, configuring Webhook, and editing parameters like <code>fb_redirect_uri</code>, <code>app_id</code>, and <code>app_secret</code>.</li>\n</ul>\n</li>\n</ol>\n<h2>Who the Template is For</h2>\n<ul>\n<li><strong>Developers</strong>: Integrating Facebook APIs into their applications.</li>\n<li><strong>Social Media Managers</strong>: Automating posting and engagement on Facebook Pages.</li>\n<li><strong>n8n Users</strong>: Looking for a ready-to-use workflow for Facebook Token management.</li>\n</ul>\n<h2>Primary Use</h2>\n<ul>\n<li>Automates Facebook Token retrieval and management.</li>\n<li>Supports posting to Facebook Pages via <strong>Page Tokens</strong>.</li>\n<li>Easily customizable and extendable for specific requirements.</li>\n</ul>\n</div><!--]-->",
  "readme_zh": "## 前置条件\n\n  1. 拥有活跃应用的Facebook开发者账号\n  2. 具备n8n工作流基础知识\n  3. 可访问数据库（可选，用于存储令牌）\n\n## 配置步骤\n\n  1. **Webhook激活**：\n     * 配置Webhook以接收用户请求并处理输入数据\n     * 确保Facebook应用设置中Webhook URL配置正确\n\n  2. **短期令牌获取**：\n     * 使用**Facebook OAuth**从授权码获取短期令牌\n\n  3. **长期令牌转换**：\n     * 将短期令牌转换为有效期约60天的长期令牌\n\n  4. **页面令牌获取**：\n     * 按照指引获取用于在托管Facebook页面发帖的**页面令牌**\n\n  5. **自定义权限范围**：\n     * 根据需要编辑`correctScopes`数组增减权限\n\n  6. **可选数据库存储**：\n     * 可扩展工作流将令牌存储至数据库而非屏幕显示\n\n  7. **分步操作指南**：\n     * 通过便签提供详细指引，包括应用激活、Webhook配置及`fb_redirect_uri`、`app_id`、`app_secret`等参数编辑\n\n## 适用对象\n\n  * **开发者**：需要将Facebook API集成到应用程序中\n  * **社交媒体经理**：实现Facebook页面自动发帖与互动\n  * **n8n用户**：寻求即用型Facebook令牌管理工作流\n\n## 核心功能\n\n  * 自动化Facebook令牌获取与管理\n  * 支持通过**页面令牌**在Facebook页面发帖\n  * 可根据特定需求灵活定制扩展",
  "title_zh": "Facebook令牌获取与管理",
  "publish_date_zh": "最后更新于2个月前",
  "workflow_json_zh": "{\n  \"id\": \"MVhWWLZv7PhhLSq2\",\n  \"meta\": {\n    \"instanceId\": \"2c69a61055797162319204105e5a124e409f0c7fbfaba08ee106324374f4ae73\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"name\": \"Facebook Token Mew\",\n  \"tags\": [],\n  \"nodes\": [\n    {\n      \"id\": \"ecd428ff-673c-435c-a6b3-723ae6f3f88d\",\n      \"name\": \"Webhook\",\n      \"type\": \"n8n-nodes-base.webhook\",\n      \"position\": [\n        1680,\n        280\n      ],\n      \"webhookId\": \"9e37ff8f-66fd-417b-97af-570e52622d7b\",\n      \"parameters\": {\n        \"path\": \"facebook-login\",\n        \"options\": {},\n        \"responseMode\": \"responseNode\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"7fe9fcb7-49f3-4628-8a9f-2027f9dffd61\",\n      \"name\": \"If\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        2360,\n        280\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"loose\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"ce391d94-03af-42d1-ae73-91bdb2e93c00\",\n              \"operator\": {\n                \"type\": \"string\",\n                \"operation\": \"notEmpty\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $('Webhook').first().json.query.code }}\",\n              \"rightValue\": \"login\"\n            }\n          ]\n        },\n        \"looseTypeValidation\": true\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"ded6d8fa-3add-4084-a9f2-172a5d51158b\",\n      \"name\": \"Short-Lived Token\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"onError\": \"continueErrorOutput\",\n      \"position\": [\n        2720,\n        140\n      ],\n      \"parameters\": {\n        \"url\": \"https://graph.facebook.com/v21.0/oauth/access_token\",\n        \"options\": {},\n        \"sendQuery\": true,\n        \"queryParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"client_id\",\n              \"value\": \"={{ $('Config').first().json.app_id }}\"\n            },\n            {\n              \"name\": \"redirect_uri\",\n              \"value\": \"={{ $('Config').first().json.fb_redirect_uri }}\"\n            },\n            {\n              \"name\": \"client_secret\",\n              \"value\": \"={{ $('Config').first().json.app_secret }}\"\n            },\n            {\n              \"name\": \"code\",\n              \"value\": \"={{ $('Webhook').first().json.query.code }}\"\n            }\n          ]\n        }\n      },\n      \"retryOnFail\": true,\n      \"typeVersion\": 4.2,\n      \"alwaysOutputData\": false,\n      \"waitBetweenTries\": 5000\n    },\n    {\n      \"id\": \"27fed69c-e476-4e19-870e-f26ed707e36a\",\n      \"name\": \"Long-Lived Token\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        3000,\n        -100\n      ],\n      \"parameters\": {\n        \"url\": \"https://graph.facebook.com/v21.0/oauth/access_token\",\n        \"options\": {},\n        \"sendQuery\": true,\n        \"queryParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"grant_type\",\n              \"value\": \"fb_exchange_token\"\n            },\n            {\n              \"name\": \"client_id\",\n              \"value\": \"={{ $('Config').first().json.app_id }}\"\n            },\n            {\n              \"name\": \"client_secret\",\n              \"value\": \"={{ $('Config').first().json.app_secret }}\"\n            },\n            {\n              \"name\": \"fb_exchange_token\",\n              \"value\": \"={{ $('Short-Lived Token').first().json.access_token }}\"\n            }\n          ]\n        }\n      },\n      \"retryOnFail\": true,\n      \"typeVersion\": 4.2,\n      \"waitBetweenTries\": 5000\n    },\n    {\n      \"id\": \"94e38177-b72f-4e99-9e2f-e43bd679589b\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1660,\n        -800\n      ],\n      \"parameters\": {\n        \"width\": 920,\n        \"height\": 900,\n        \"content\": \"### 获取2个月有效期Facebook令牌的操作指南  \\n运行n8n时启用隧道模式（或使用Ngrok/Cloudflare Tunnel等工具）\\n\\n1. **激活应用**  \\n   - 打开应用，在右上角**保存**按钮旁可见状态按钮显示为**未激活**  \\n   - 切换按钮至**激活**状态（变为绿色）以启用应用功能  \\n\\n2. **访问Webhook链接**  \\n   - 在浏览器打开以下地址（fb_redirect_uri）：  \\n     https://localhost:5678/webhook/facebook-login?type=login  \\n\\n3. **完成流程**  \\n   - 根据界面指引完成操作  \\n   - 成功后将获得有效期**60天（2个月）的Facebook令牌**  \\n\\n---\\n\\n### 令牌状态检查及页面令牌获取指南  \\n1. **验证令牌状态**  \\n   - 访问[Facebook令牌调试工具](https://developers.facebook.com/tools/debug/accesstoken/)  \\n   - 粘贴**用户令牌**即可查看过期时间、权限范围等详细信息  \\n\\n2. **获取发帖用页面令牌**  \\n   - 用户令牌仅限访问个人数据，管理专页需使用**页面令牌**  \\n   - 向以下接口发送GET请求（将`{user-access-token}`替换为你的用户令牌）：  \\n     ```\\n     GET https://graph.facebook.com/v21.0/me/accounts?access_token={user-access-token}\\n     ```  \\n   - 响应中将包含你管理的所有专页及其对应的**页面令牌**  \\n\\n3. **使用页面令牌**  \\n   - 该令牌可用于发布贴文、管理评论等专页操作  \\n\\n**注意事项**  \\n- 用户令牌需具备`pages_manage_posts`、`pages_read_engagement`等权限才能获取页面令牌  \\n- 页面令牌有效期与用户令牌同步（约60天），到期需续期  \\n\\n`https://github.com/luuhung93/n8n-json`\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"4af7f1f6-9479-4489-9282-7083cd29649c\",\n      \"name\": \"Redirect URL\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        2980,\n        480\n      ],\n      \"parameters\": {\n        \"jsCode\": \"const config = $('Config').first().json;\\n\\n\\nconst generateRandomState = () => {\\n\\treturn Math.random().toString(36).substring(2, 15) +\\n\\t\\tMath.random().toString(36).substring(2, 15);\\n}\\nconst state = generateRandomState();\\n\\nconst correctScopes = [\\n        'publish_video',\\n\\t\\t'pages_show_list',\\n\\t\\t'business_management',\\n        'pages_read_engagement',\\n        'pages_read_user_content',\\n        'pages_manage_metadata',\\n        'pages_manage_posts',\\n        'pages_manage_engagement',\\n\\t];\\n\\nconst authUrl = `https://www.facebook.com/v22.0/dialog/oauth?client_id=${config.app_id}&redirect_uri=${config.fb_redirect_uri}&scope=${correctScopes.join(',')}&response_type=code&state=${state}`;\\n\\nreturn [{\\n  authUrl\\n}];\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"b415e387-17ed-4451-ae7d-b8d1fdf8ee06\",\n      \"name\": \"Redirect\",\n      \"type\": \"n8n-nodes-base.respondToWebhook\",\n      \"position\": [\n        3740,\n        480\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"redirectURL\": \"={{ $json.authUrl }}\",\n        \"respondWith\": \"redirect\"\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"d59290d9-79b5-4212-a8ad-a1a9e074bbf2\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1840,\n        140\n      ],\n      \"parameters\": {\n        \"width\": 420,\n        \"height\": 480,\n        \"content\": \"编辑：\\n- fb_redirect_uri\\n- app_id\\n- app_secret\\n\\n前往[Facebook应用](https://developers.facebook.com/apps/)。\\n- 从左侧菜单中选择**Facebook登录**。\\n- 点击**设置**。\\n- 在**有效的OAuth重定向URI**部分，添加URL（fb_redirect_uri）：`https://localhost:5678/webhook/facebook-login`\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"952f17fa-efdf-4523-9d9b-ff071670e425\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        2460,\n        460\n      ],\n      \"parameters\": {\n        \"width\": 640,\n        \"height\": 760,\n        \"content\": \"### 编辑 `correctScopes` 指南\\n\\n1. **添加权限**：\\n   - 将权限添加到 `correctScopes` 数组中。例如：\\n     ```javascript\\n     const correctScopes = [\\n       'pages_manage_posts', // 已有权限\\n       'pages_messaging',    // 新增权限\\n     ];\\n     ```\\n\\n2. **编辑权限**：\\n   - 替换 `correctScopes` 数组中的某个权限。例如：\\n     ```javascript\\n     const correctScopes = [\\n       'pages_manage_posts', // 已有权限\\n       'pages_messaging',    // 新权限替换旧权限\\n     ];\\n     ```\\n\\n3. **删除权限**：\\n   - 从 `correctScopes` 数组中移除某个权限。例如：\\n     ```javascript\\n     const correctScopes = [\\n       'pages_manage_posts', // 保留此权限\\n       // 'pages_messaging',  // 移除此权限\\n     ];\\n     ```\\n\\n4. **查看可用权限**：\\n   - 参考完整权限列表：[Facebook 权限](https://developers.facebook.com/docs/permissions/)。\\n\\n只需编辑 `correctScopes` 数组，无需担心其他部分。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"dbc712ba-1a95-4041-ac27-824d804726bc\",\n      \"name\": \"Token\",\n      \"type\": \"n8n-nodes-base.respondToWebhook\",\n      \"position\": [\n        3700,\n        -100\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"respondWith\": \"text\",\n        \"responseBody\": \"={{ $json.access_token }}\"\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"560d3c3f-a0e8-432e-904f-71cd7525fd0d\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        3280,\n        -180\n      ],\n      \"parameters\": {\n        \"width\": 280,\n        \"content\": \"默认情况下，令牌会显示在屏幕上。不过，您可以添加一个`node`将令牌保存到数据库中。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"99e67d66-5179-4186-b78f-ced80ab5dd82\",\n      \"name\": \"Config\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1980,\n        280\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"c210cd1e-ff2d-47cb-b9c4-af1e9a91ec71\",\n              \"name\": \"fb_redirect_uri\",\n              \"type\": \"string\",\n              \"value\": \"https://localhost:5678/webhook/facebook-login\"\n            },\n            {\n              \"id\": \"3f24bd07-905f-4c3c-bd07-2661e0a95d7a\",\n              \"name\": \"app_id\",\n              \"type\": \"string\",\n              \"value\": \"12345678900000\"\n            },\n            {\n              \"id\": \"51de3a11-3e7f-4c8e-9c2c-63ae28a14eb8\",\n              \"name\": \"app_secret\",\n              \"type\": \"string\",\n              \"value\": \"aaabbbcccceedb6f9c91993c871\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    }\n  ],\n  \"active\": false,\n  \"pinData\": {},\n  \"settings\": {\n    \"timezone\": \"Asia/Ho_Chi_Minh\",\n    \"callerPolicy\": \"workflowsFromSameOwner\",\n    \"executionOrder\": \"v1\"\n  },\n  \"versionId\": \"c2d0b26b-3366-424a-a741-20649907f008\",\n  \"connections\": {\n    \"If\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Short-Lived Token\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Redirect URL\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Config\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"If\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Webhook\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Config\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Redirect URL\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Redirect\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Long-Lived Token\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Token\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Short-Lived Token\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Long-Lived Token\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Redirect URL\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}