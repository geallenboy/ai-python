{
  "title": "Facebook Token Retrieval & Management",
  "url": "https://n8n.io/workflows/2959-facebook-token-retrieval-and-management/",
  "category": "Marketing",
  "category_url": "https://n8n.io/workflows/categories/marketing/?sort=createdAt:desc",
  "author": "L HÃ¹ng",
  "publish_date": "Last update 2 months ago",
  "publish_date_absolute": "2025-03-19",
  "content": "",
  "workflow_json": "{\"id\":\"MVhWWLZv7PhhLSq2\",\"meta\":{\"instanceId\":\"2c69a61055797162319204105e5a124e409f0c7fbfaba08ee106324374f4ae73\",\"templateCredsSetupCompleted\":true},\"name\":\"Facebook Token Mew\",\"tags\":[],\"nodes\":[{\"id\":\"ecd428ff-673c-435c-a6b3-723ae6f3f88d\",\"name\":\"Webhook\",\"type\":\"n8n-nodes-base.webhook\",\"position\":[1680,280],\"webhookId\":\"9e37ff8f-66fd-417b-97af-570e52622d7b\",\"parameters\":{\"path\":\"facebook-login\",\"options\":{},\"responseMode\":\"responseNode\"},\"typeVersion\":2},{\"id\":\"7fe9fcb7-49f3-4628-8a9f-2027f9dffd61\",\"name\":\"If\",\"type\":\"n8n-nodes-base.if\",\"position\":[2360,280],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"loose\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"ce391d94-03af-42d1-ae73-91bdb2e93c00\",\"operator\":{\"type\":\"string\",\"operation\":\"notEmpty\",\"singleValue\":true},\"leftValue\":\"={{ $('Webhook').first().json.query.code }}\",\"rightValue\":\"login\"}]},\"looseTypeValidation\":true},\"typeVersion\":2.2},{\"id\":\"ded6d8fa-3add-4084-a9f2-172a5d51158b\",\"name\":\"Short-Lived Token\",\"type\":\"n8n-nodes-base.httpRequest\",\"onError\":\"continueErrorOutput\",\"position\":[2720,140],\"parameters\":{\"url\":\"https://graph.facebook.com/v21.0/oauth/access_token\",\"options\":{},\"sendQuery\":true,\"queryParameters\":{\"parameters\":[{\"name\":\"client_id\",\"value\":\"={{ $('Config').first().json.app_id }}\"},{\"name\":\"redirect_uri\",\"value\":\"={{ $('Config').first().json.fb_redirect_uri }}\"},{\"name\":\"client_secret\",\"value\":\"={{ $('Config').first().json.app_secret }}\"},{\"name\":\"code\",\"value\":\"={{ $('Webhook').first().json.query.code }}\"}]}},\"retryOnFail\":true,\"typeVersion\":4.2,\"alwaysOutputData\":false,\"waitBetweenTries\":5000},{\"id\":\"27fed69c-e476-4e19-870e-f26ed707e36a\",\"name\":\"Long-Lived Token\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[3000,-100],\"parameters\":{\"url\":\"https://graph.facebook.com/v21.0/oauth/access_token\",\"options\":{},\"sendQuery\":true,\"queryParameters\":{\"parameters\":[{\"name\":\"grant_type\",\"value\":\"fb_exchange_token\"},{\"name\":\"client_id\",\"value\":\"={{ $('Config').first().json.app_id }}\"},{\"name\":\"client_secret\",\"value\":\"={{ $('Config').first().json.app_secret }}\"},{\"name\":\"fb_exchange_token\",\"value\":\"={{ $('Short-Lived Token').first().json.access_token }}\"}]}},\"retryOnFail\":true,\"typeVersion\":4.2,\"waitBetweenTries\":5000},{\"id\":\"94e38177-b72f-4e99-9e2f-e43bd679589b\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1660,-800],\"parameters\":{\"width\":920,\"height\":900,\"content\":\"### Instructions to Get a 2-Month Facebook Token\\nRun n8n with tunnel model - Or user: Ngrok, Cloudflare Tunnel\\n\\n1. **Activate the App**:\\n   - Launch the app. In the top-right corner near the **Save** button, you will see a status button labeled **Inactive**.\\n   - Switch this button to **Active** (it will turn green) to activate the app.\\n\\n2. **Access the Webhook URL**:\\n   - Visit the following URL (fb_redirect_uri):  \\n      https://localhost:5678/webhook/facebook-login?type=login\\n\\n3. **Follow the Steps**:\\n   - Complete the on-screen instructions to finish the process.\\n   - Once done, you will receive a **Facebook Token** valid for **2 months (60 days)**.\\n\\n\\n### Instructions to Check Token Status and Get Page Token\\n1. **Check Token Status**:\\n   - Go to [Facebook Access Token Debugger](https://developers.facebook.com/tools/debug/accesstoken/).\\n   - Paste your **User Token** into the debugger to view details such as expiration date, permissions, and token status.\\n\\n2. **Get Page Token for Posting**:\\n   - A **User Token** only grants access to personal information. To post on a Page, you need a **Page Token**.\\n   - Send a GET request to the following endpoint (replace `{user-access-token}` with your User Token):\\n     ```\\n     GET https://graph.facebook.com/v21.0/me/accounts?access_token={user-access-token}\\n     ```\\n   - The response will include a list of Pages you manage along with their corresponding **Page Tokens**.\\n\\n3. **Use the Page Token**:\\n   - Use the **Page Token** to perform actions such as posting, managing comments, or other tasks on the Page.\\n\\n**Note**:\\n- Ensure the User Token has the necessary permissions like `pages_manage_posts`, `pages_read_engagement`, etc., to retrieve the Page Token.\\n- The Page Token will have the same expiration as the User Token (approximately 60 days) and can be renewed.\\n\\n\\n`https://github.com/luuhung93/n8n-json`\"},\"typeVersion\":1},{\"id\":\"4af7f1f6-9479-4489-9282-7083cd29649c\",\"name\":\"Redirect URL\",\"type\":\"n8n-nodes-base.code\",\"position\":[2980,480],\"parameters\":{\"jsCode\":\"const config = $('Config').first().json;\\n\\n\\nconst generateRandomState = () => {\\n\\treturn Math.random().toString(36).substring(2, 15) +\\n\\t\\tMath.random().toString(36).substring(2, 15);\\n}\\nconst state = generateRandomState();\\n\\nconst correctScopes = [\\n        'publish_video',\\n\\t\\t'pages_show_list',\\n\\t\\t'business_management',\\n        'pages_read_engagement',\\n        'pages_read_user_content',\\n        'pages_manage_metadata',\\n        'pages_manage_posts',\\n        'pages_manage_engagement',\\n\\t];\\n\\nconst authUrl = `https://www.facebook.com/v22.0/dialog/oauth?client_id=${config.app_id}&redirect_uri=${config.fb_redirect_uri}&scope=${correctScopes.join(',')}&response_type=code&state=${state}`;\\n\\nreturn [{\\n  authUrl\\n}];\"},\"typeVersion\":2},{\"id\":\"b415e387-17ed-4451-ae7d-b8d1fdf8ee06\",\"name\":\"Redirect\",\"type\":\"n8n-nodes-base.respondToWebhook\",\"position\":[3740,480],\"parameters\":{\"options\":{},\"redirectURL\":\"={{ $json.authUrl }}\",\"respondWith\":\"redirect\"},\"typeVersion\":1.1},{\"id\":\"d59290d9-79b5-4212-a8ad-a1a9e074bbf2\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1840,140],\"parameters\":{\"width\":420,\"height\":480,\"content\":\"Edit:\\n - fb_redirect_uri\\n - app_id\\n - app_secret\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nGo to the [Facebook App](https://developers.facebook.com/apps/).\\n    - Select **Facebook Login** from the left-hand menu.\\n    - Click on **Settings**.\\n    - In the **Valid OAuth Redirect URIs** section, add the URL (fb_redirect_uri): `https://localhost:5678/webhook/facebook-login`\"},\"typeVersion\":1},{\"id\":\"952f17fa-efdf-4523-9d9b-ff071670e425\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[2460,460],\"parameters\":{\"width\":640,\"height\":760,\"content\":\"\\n\\n\\n\\n### Guide to Editing `correctScopes`\\n\\n1. **Add a Permission**:\\n   - Add the permission to the `correctScopes` array. For example:\\n     ```javascript\\n     const correctScopes = [\\n       'pages_manage_posts', // Existing permission\\n       'pages_messaging',    // New permission added\\n     ];\\n     ```\\n\\n2. **Edit a Permission**:\\n   - Replace a permission in the `correctScopes` array. For example:\\n     ```javascript\\n     const correctScopes = [\\n       'pages_manage_posts', // Existing permission\\n       'pages_messaging',    // New permission replacing the old one\\n     ];\\n     ```\\n\\n3. **Remove a Permission**:\\n   - Remove a permission from the `correctScopes` array. For example:\\n     ```javascript\\n     const correctScopes = [\\n       'pages_manage_posts', // Keep this permission\\n       // 'pages_messaging',  // Remove this permission\\n     ];\\n     ```\\n\\n4. **View Available Permissions**:\\n   - Refer to the full list of permissions at [Facebook Permissions](https://developers.facebook.com/docs/permissions/).\\n\\nSimply edit the `correctScopes` array; no need to worry about other parts.\\n\"},\"typeVersion\":1},{\"id\":\"dbc712ba-1a95-4041-ac27-824d804726bc\",\"name\":\"Token\",\"type\":\"n8n-nodes-base.respondToWebhook\",\"position\":[3700,-100],\"parameters\":{\"options\":{},\"respondWith\":\"text\",\"responseBody\":\"={{ $json.access_token }}\"},\"typeVersion\":1.1},{\"id\":\"560d3c3f-a0e8-432e-904f-71cd7525fd0d\",\"name\":\"Sticky Note3\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[3280,-180],\"parameters\":{\"width\":280,\"content\":\"By default, the token will be displayed on the screen. However, you can add a `node` to save the token into your database.\"},\"typeVersion\":1},{\"id\":\"99e67d66-5179-4186-b78f-ced80ab5dd82\",\"name\":\"Config\",\"type\":\"n8n-nodes-base.set\",\"position\":[1980,280],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"c210cd1e-ff2d-47cb-b9c4-af1e9a91ec71\",\"name\":\"fb_redirect_uri\",\"type\":\"string\",\"value\":\"https://localhost:5678/webhook/facebook-login\"},{\"id\":\"3f24bd07-905f-4c3c-bd07-2661e0a95d7a\",\"name\":\"app_id\",\"type\":\"string\",\"value\":\"12345678900000\"},{\"id\":\"51de3a11-3e7f-4c8e-9c2c-63ae28a14eb8\",\"name\":\"app_secret\",\"type\":\"string\",\"value\":\"aaabbbcccceedb6f9c91993c871\"}]}},\"typeVersion\":3.4}],\"active\":false,\"pinData\":{},\"settings\":{\"timezone\":\"Asia/Ho_Chi_Minh\",\"callerPolicy\":\"workflowsFromSameOwner\",\"executionOrder\":\"v1\"},\"versionId\":\"c2d0b26b-3366-424a-a741-20649907f008\",\"connections\":{\"If\":{\"main\":[[{\"node\":\"Short-Lived Token\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Redirect URL\",\"type\":\"main\",\"index\":0}]]},\"Config\":{\"main\":[[{\"node\":\"If\",\"type\":\"main\",\"index\":0}]]},\"Webhook\":{\"main\":[[{\"node\":\"Config\",\"type\":\"main\",\"index\":0}]]},\"Redirect URL\":{\"main\":[[{\"node\":\"Redirect\",\"type\":\"main\",\"index\":0}]]},\"Long-Lived Token\":{\"main\":[[{\"node\":\"Token\",\"type\":\"main\",\"index\":0}]]},\"Short-Lived Token\":{\"main\":[[{\"node\":\"Long-Lived Token\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Redirect URL\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "## Pre-Conditions\n\n  1. A Facebook Developer account with an active app.\n  2. Basic understanding of n8n workflows.\n  3. Access to a database (optional, for storing tokens).\n\n\n\n## Setup\n\n  1. **Webhook Activation** :\n\n     * Configure the Webhook to receive user requests and process input data.\n     * Ensure the Webhook URL is correctly set in your Facebook App settings.\n  2. **Short-Lived Token Retrieval** :\n\n     * Use **Facebook OAuth** to fetch a short-lived token from the authorization code.\n  3. **Long-Lived Token Conversion** :\n\n     * Convert the short-lived token into a long-lived token (valid for ~60 days).\n  4. **Page Token Retrieval** :\n\n     * Follow the provided instructions to retrieve **Page Tokens** for posting on managed Facebook Pages.\n  5. **Customizable Scopes** :\n\n     * Edit the `correctScopes` array to include or exclude permissions as needed.\n  6. **Optional Database Storage** :\n\n     * Extend the workflow to save tokens to a database instead of displaying them on-screen.\n  7. **Step-by-Step Instructions** :\n\n     * Detailed guidance is provided via sticky notes for activating the app, configuring Webhook, and editing parameters like `fb_redirect_uri`, `app_id`, and `app_secret`.\n\n\n\n## Who the Template is For\n\n  * **Developers** : Integrating Facebook APIs into their applications.\n  * **Social Media Managers** : Automating posting and engagement on Facebook Pages.\n  * **n8n Users** : Looking for a ready-to-use workflow for Facebook Token management.\n\n\n\n## Primary Use\n\n  * Automates Facebook Token retrieval and management.\n  * Supports posting to Facebook Pages via **Page Tokens**.\n  * Easily customizable and extendable for specific requirements.\n\n\n",
  "readme_html": "<!--[--><div data-v-50766329=\"\"><h2>Pre-Conditions</h2>\n<ol>\n<li>A Facebook Developer account with an active app.</li>\n<li>Basic understanding of n8n workflows.</li>\n<li>Access to a database (optional, for storing tokens).</li>\n</ol>\n<h2>Setup</h2>\n<ol>\n<li>\n<p><strong>Webhook Activation</strong>:</p>\n<ul>\n<li>Configure the Webhook to receive user requests and process input data.</li>\n<li>Ensure the Webhook URL is correctly set in your Facebook App settings.</li>\n</ul>\n</li>\n<li>\n<p><strong>Short-Lived Token Retrieval</strong>:</p>\n<ul>\n<li>Use <strong>Facebook OAuth</strong> to fetch a short-lived token from the authorization code.</li>\n</ul>\n</li>\n<li>\n<p><strong>Long-Lived Token Conversion</strong>:</p>\n<ul>\n<li>Convert the short-lived token into a long-lived token (valid for ~60 days).</li>\n</ul>\n</li>\n<li>\n<p><strong>Page Token Retrieval</strong>:</p>\n<ul>\n<li>Follow the provided instructions to retrieve <strong>Page Tokens</strong> for posting on managed Facebook Pages.</li>\n</ul>\n</li>\n<li>\n<p><strong>Customizable Scopes</strong>:</p>\n<ul>\n<li>Edit the <code>correctScopes</code> array to include or exclude permissions as needed.</li>\n</ul>\n</li>\n<li>\n<p><strong>Optional Database Storage</strong>:</p>\n<ul>\n<li>Extend the workflow to save tokens to a database instead of displaying them on-screen.</li>\n</ul>\n</li>\n<li>\n<p><strong>Step-by-Step Instructions</strong>:</p>\n<ul>\n<li>Detailed guidance is provided via sticky notes for activating the app, configuring Webhook, and editing parameters like <code>fb_redirect_uri</code>, <code>app_id</code>, and <code>app_secret</code>.</li>\n</ul>\n</li>\n</ol>\n<h2>Who the Template is For</h2>\n<ul>\n<li><strong>Developers</strong>: Integrating Facebook APIs into their applications.</li>\n<li><strong>Social Media Managers</strong>: Automating posting and engagement on Facebook Pages.</li>\n<li><strong>n8n Users</strong>: Looking for a ready-to-use workflow for Facebook Token management.</li>\n</ul>\n<h2>Primary Use</h2>\n<ul>\n<li>Automates Facebook Token retrieval and management.</li>\n<li>Supports posting to Facebook Pages via <strong>Page Tokens</strong>.</li>\n<li>Easily customizable and extendable for specific requirements.</li>\n</ul>\n</div><!--]-->",
  "readme_zh": "## åç½®æ¡ä»¶\n\n  1. æ¥ææ´»è·åºç¨çFacebookå¼åèè´¦å·\n  2. å·å¤n8nå·¥ä½æµåºç¡ç¥è¯\n  3. å¯è®¿é®æ°æ®åºï¼å¯éï¼ç¨äºå­å¨ä»¤çï¼\n\n## éç½®æ­¥éª¤\n\n  1. **Webhookæ¿æ´»**ï¼\n     * éç½®Webhookä»¥æ¥æ¶ç¨æ·è¯·æ±å¹¶å¤çè¾å¥æ°æ®\n     * ç¡®ä¿Facebookåºç¨è®¾ç½®ä¸­Webhook URLéç½®æ­£ç¡®\n\n  2. **ç­æä»¤çè·å**ï¼\n     * ä½¿ç¨**Facebook OAuth**ä»ææç è·åç­æä»¤ç\n\n  3. **é¿æä»¤çè½¬æ¢**ï¼\n     * å°ç­æä»¤çè½¬æ¢ä¸ºæææçº¦60å¤©çé¿æä»¤ç\n\n  4. **é¡µé¢ä»¤çè·å**ï¼\n     * æç§æå¼è·åç¨äºå¨æç®¡Facebooké¡µé¢åå¸ç**é¡µé¢ä»¤ç**\n\n  5. **èªå®ä¹æéèå´**ï¼\n     * æ ¹æ®éè¦ç¼è¾`correctScopes`æ°ç»å¢åæé\n\n  6. **å¯éæ°æ®åºå­å¨**ï¼\n     * å¯æ©å±å·¥ä½æµå°ä»¤çå­å¨è³æ°æ®åºèéå±å¹æ¾ç¤º\n\n  7. **åæ­¥æä½æå**ï¼\n     * éè¿ä¾¿ç­¾æä¾è¯¦ç»æå¼ï¼åæ¬åºç¨æ¿æ´»ãWebhookéç½®å`fb_redirect_uri`ã`app_id`ã`app_secret`ç­åæ°ç¼è¾\n\n## éç¨å¯¹è±¡\n\n  * **å¼åè**ï¼éè¦å°Facebook APIéæå°åºç¨ç¨åºä¸­\n  * **ç¤¾äº¤åªä½ç»ç**ï¼å®ç°Facebooké¡µé¢èªå¨åå¸ä¸äºå¨\n  * **n8nç¨æ·**ï¼å¯»æ±å³ç¨åFacebookä»¤çç®¡çå·¥ä½æµ\n\n## æ ¸å¿åè½\n\n  * èªå¨åFacebookä»¤çè·åä¸ç®¡ç\n  * æ¯æéè¿**é¡µé¢ä»¤ç**å¨Facebooké¡µé¢åå¸\n  * å¯æ ¹æ®ç¹å®éæ±çµæ´»å®å¶æ©å±",
  "title_zh": "Facebookä»¤çè·åä¸ç®¡ç",
  "publish_date_zh": "æåæ´æ°äº2ä¸ªæå",
  "workflow_json_zh": "{\n  \"id\": \"MVhWWLZv7PhhLSq2\",\n  \"meta\": {\n    \"instanceId\": \"2c69a61055797162319204105e5a124e409f0c7fbfaba08ee106324374f4ae73\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"name\": \"Facebook Token Mew\",\n  \"tags\": [],\n  \"nodes\": [\n    {\n      \"id\": \"ecd428ff-673c-435c-a6b3-723ae6f3f88d\",\n      \"name\": \"Webhook\",\n      \"type\": \"n8n-nodes-base.webhook\",\n      \"position\": [\n        1680,\n        280\n      ],\n      \"webhookId\": \"9e37ff8f-66fd-417b-97af-570e52622d7b\",\n      \"parameters\": {\n        \"path\": \"facebook-login\",\n        \"options\": {},\n        \"responseMode\": \"responseNode\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"7fe9fcb7-49f3-4628-8a9f-2027f9dffd61\",\n      \"name\": \"If\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        2360,\n        280\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"loose\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"ce391d94-03af-42d1-ae73-91bdb2e93c00\",\n              \"operator\": {\n                \"type\": \"string\",\n                \"operation\": \"notEmpty\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $('Webhook').first().json.query.code }}\",\n              \"rightValue\": \"login\"\n            }\n          ]\n        },\n        \"looseTypeValidation\": true\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"ded6d8fa-3add-4084-a9f2-172a5d51158b\",\n      \"name\": \"Short-Lived Token\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"onError\": \"continueErrorOutput\",\n      \"position\": [\n        2720,\n        140\n      ],\n      \"parameters\": {\n        \"url\": \"https://graph.facebook.com/v21.0/oauth/access_token\",\n        \"options\": {},\n        \"sendQuery\": true,\n        \"queryParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"client_id\",\n              \"value\": \"={{ $('Config').first().json.app_id }}\"\n            },\n            {\n              \"name\": \"redirect_uri\",\n              \"value\": \"={{ $('Config').first().json.fb_redirect_uri }}\"\n            },\n            {\n              \"name\": \"client_secret\",\n              \"value\": \"={{ $('Config').first().json.app_secret }}\"\n            },\n            {\n              \"name\": \"code\",\n              \"value\": \"={{ $('Webhook').first().json.query.code }}\"\n            }\n          ]\n        }\n      },\n      \"retryOnFail\": true,\n      \"typeVersion\": 4.2,\n      \"alwaysOutputData\": false,\n      \"waitBetweenTries\": 5000\n    },\n    {\n      \"id\": \"27fed69c-e476-4e19-870e-f26ed707e36a\",\n      \"name\": \"Long-Lived Token\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        3000,\n        -100\n      ],\n      \"parameters\": {\n        \"url\": \"https://graph.facebook.com/v21.0/oauth/access_token\",\n        \"options\": {},\n        \"sendQuery\": true,\n        \"queryParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"grant_type\",\n              \"value\": \"fb_exchange_token\"\n            },\n            {\n              \"name\": \"client_id\",\n              \"value\": \"={{ $('Config').first().json.app_id }}\"\n            },\n            {\n              \"name\": \"client_secret\",\n              \"value\": \"={{ $('Config').first().json.app_secret }}\"\n            },\n            {\n              \"name\": \"fb_exchange_token\",\n              \"value\": \"={{ $('Short-Lived Token').first().json.access_token }}\"\n            }\n          ]\n        }\n      },\n      \"retryOnFail\": true,\n      \"typeVersion\": 4.2,\n      \"waitBetweenTries\": 5000\n    },\n    {\n      \"id\": \"94e38177-b72f-4e99-9e2f-e43bd679589b\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1660,\n        -800\n      ],\n      \"parameters\": {\n        \"width\": 920,\n        \"height\": 900,\n        \"content\": \"### è·å2ä¸ªææææFacebookä»¤ççæä½æå  \\nè¿è¡n8næ¶å¯ç¨é§éæ¨¡å¼ï¼æä½¿ç¨Ngrok/Cloudflare Tunnelç­å·¥å·ï¼\\n\\n1. **æ¿æ´»åºç¨**  \\n   - æå¼åºç¨ï¼å¨å³ä¸è§**ä¿å­**æé®æå¯è§ç¶ææé®æ¾ç¤ºä¸º**æªæ¿æ´»**  \\n   - åæ¢æé®è³**æ¿æ´»**ç¶æï¼åä¸ºç»¿è²ï¼ä»¥å¯ç¨åºç¨åè½  \\n\\n2. **è®¿é®Webhooké¾æ¥**  \\n   - å¨æµè§å¨æå¼ä»¥ä¸å°åï¼fb_redirect_uriï¼ï¼  \\n     https://localhost:5678/webhook/facebook-login?type=login  \\n\\n3. **å®ææµç¨**  \\n   - æ ¹æ®çé¢æå¼å®ææä½  \\n   - æååå°è·å¾æææ**60å¤©ï¼2ä¸ªæï¼çFacebookä»¤ç**  \\n\\n---\\n\\n### ä»¤çç¶ææ£æ¥åé¡µé¢ä»¤çè·åæå  \\n1. **éªè¯ä»¤çç¶æ**  \\n   - è®¿é®[Facebookä»¤çè°è¯å·¥å·](https://developers.facebook.com/tools/debug/accesstoken/)  \\n   - ç²è´´**ç¨æ·ä»¤ç**å³å¯æ¥çè¿ææ¶é´ãæéèå´ç­è¯¦ç»ä¿¡æ¯  \\n\\n2. **è·ååå¸ç¨é¡µé¢ä»¤ç**  \\n   - ç¨æ·ä»¤çä»éè®¿é®ä¸ªäººæ°æ®ï¼ç®¡çä¸é¡µéä½¿ç¨**é¡µé¢ä»¤ç**  \\n   - åä»¥ä¸æ¥å£åéGETè¯·æ±ï¼å°`{user-access-token}`æ¿æ¢ä¸ºä½ çç¨æ·ä»¤çï¼ï¼  \\n     ```\\n     GET https://graph.facebook.com/v21.0/me/accounts?access_token={user-access-token}\\n     ```  \\n   - ååºä¸­å°åå«ä½ ç®¡ççææä¸é¡µåå¶å¯¹åºç**é¡µé¢ä»¤ç**  \\n\\n3. **ä½¿ç¨é¡µé¢ä»¤ç**  \\n   - è¯¥ä»¤çå¯ç¨äºåå¸è´´æãç®¡çè¯è®ºç­ä¸é¡µæä½  \\n\\n**æ³¨æäºé¡¹**  \\n- ç¨æ·ä»¤çéå·å¤`pages_manage_posts`ã`pages_read_engagement`ç­æéæè½è·åé¡µé¢ä»¤ç  \\n- é¡µé¢ä»¤çæææä¸ç¨æ·ä»¤çåæ­¥ï¼çº¦60å¤©ï¼ï¼å°æéç»­æ  \\n\\n`https://github.com/luuhung93/n8n-json`\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"4af7f1f6-9479-4489-9282-7083cd29649c\",\n      \"name\": \"Redirect URL\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        2980,\n        480\n      ],\n      \"parameters\": {\n        \"jsCode\": \"const config = $('Config').first().json;\\n\\n\\nconst generateRandomState = () => {\\n\\treturn Math.random().toString(36).substring(2, 15) +\\n\\t\\tMath.random().toString(36).substring(2, 15);\\n}\\nconst state = generateRandomState();\\n\\nconst correctScopes = [\\n        'publish_video',\\n\\t\\t'pages_show_list',\\n\\t\\t'business_management',\\n        'pages_read_engagement',\\n        'pages_read_user_content',\\n        'pages_manage_metadata',\\n        'pages_manage_posts',\\n        'pages_manage_engagement',\\n\\t];\\n\\nconst authUrl = `https://www.facebook.com/v22.0/dialog/oauth?client_id=${config.app_id}&redirect_uri=${config.fb_redirect_uri}&scope=${correctScopes.join(',')}&response_type=code&state=${state}`;\\n\\nreturn [{\\n  authUrl\\n}];\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"b415e387-17ed-4451-ae7d-b8d1fdf8ee06\",\n      \"name\": \"Redirect\",\n      \"type\": \"n8n-nodes-base.respondToWebhook\",\n      \"position\": [\n        3740,\n        480\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"redirectURL\": \"={{ $json.authUrl }}\",\n        \"respondWith\": \"redirect\"\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"d59290d9-79b5-4212-a8ad-a1a9e074bbf2\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1840,\n        140\n      ],\n      \"parameters\": {\n        \"width\": 420,\n        \"height\": 480,\n        \"content\": \"ç¼è¾ï¼\\n- fb_redirect_uri\\n- app_id\\n- app_secret\\n\\nåå¾[Facebookåºç¨](https://developers.facebook.com/apps/)ã\\n- ä»å·¦ä¾§èåä¸­éæ©**Facebookç»å½**ã\\n- ç¹å»**è®¾ç½®**ã\\n- å¨**ææçOAuthéå®åURI**é¨åï¼æ·»å URLï¼fb_redirect_uriï¼ï¼`https://localhost:5678/webhook/facebook-login`\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"952f17fa-efdf-4523-9d9b-ff071670e425\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        2460,\n        460\n      ],\n      \"parameters\": {\n        \"width\": 640,\n        \"height\": 760,\n        \"content\": \"### ç¼è¾ `correctScopes` æå\\n\\n1. **æ·»å æé**ï¼\\n   - å°æéæ·»å å° `correctScopes` æ°ç»ä¸­ãä¾å¦ï¼\\n     ```javascript\\n     const correctScopes = [\\n       'pages_manage_posts', // å·²ææé\\n       'pages_messaging',    // æ°å¢æé\\n     ];\\n     ```\\n\\n2. **ç¼è¾æé**ï¼\\n   - æ¿æ¢ `correctScopes` æ°ç»ä¸­çæä¸ªæéãä¾å¦ï¼\\n     ```javascript\\n     const correctScopes = [\\n       'pages_manage_posts', // å·²ææé\\n       'pages_messaging',    // æ°æéæ¿æ¢æ§æé\\n     ];\\n     ```\\n\\n3. **å é¤æé**ï¼\\n   - ä» `correctScopes` æ°ç»ä¸­ç§»é¤æä¸ªæéãä¾å¦ï¼\\n     ```javascript\\n     const correctScopes = [\\n       'pages_manage_posts', // ä¿çæ­¤æé\\n       // 'pages_messaging',  // ç§»é¤æ­¤æé\\n     ];\\n     ```\\n\\n4. **æ¥çå¯ç¨æé**ï¼\\n   - åèå®æ´æéåè¡¨ï¼[Facebook æé](https://developers.facebook.com/docs/permissions/)ã\\n\\nåªéç¼è¾ `correctScopes` æ°ç»ï¼æ éæå¿å¶ä»é¨åã\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"dbc712ba-1a95-4041-ac27-824d804726bc\",\n      \"name\": \"Token\",\n      \"type\": \"n8n-nodes-base.respondToWebhook\",\n      \"position\": [\n        3700,\n        -100\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"respondWith\": \"text\",\n        \"responseBody\": \"={{ $json.access_token }}\"\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"560d3c3f-a0e8-432e-904f-71cd7525fd0d\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        3280,\n        -180\n      ],\n      \"parameters\": {\n        \"width\": 280,\n        \"content\": \"é»è®¤æåµä¸ï¼ä»¤çä¼æ¾ç¤ºå¨å±å¹ä¸ãä¸è¿ï¼æ¨å¯ä»¥æ·»å ä¸ä¸ª`node`å°ä»¤çä¿å­å°æ°æ®åºä¸­ã\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"99e67d66-5179-4186-b78f-ced80ab5dd82\",\n      \"name\": \"Config\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1980,\n        280\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"c210cd1e-ff2d-47cb-b9c4-af1e9a91ec71\",\n              \"name\": \"fb_redirect_uri\",\n              \"type\": \"string\",\n              \"value\": \"https://localhost:5678/webhook/facebook-login\"\n            },\n            {\n              \"id\": \"3f24bd07-905f-4c3c-bd07-2661e0a95d7a\",\n              \"name\": \"app_id\",\n              \"type\": \"string\",\n              \"value\": \"12345678900000\"\n            },\n            {\n              \"id\": \"51de3a11-3e7f-4c8e-9c2c-63ae28a14eb8\",\n              \"name\": \"app_secret\",\n              \"type\": \"string\",\n              \"value\": \"aaabbbcccceedb6f9c91993c871\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    }\n  ],\n  \"active\": false,\n  \"pinData\": {},\n  \"settings\": {\n    \"timezone\": \"Asia/Ho_Chi_Minh\",\n    \"callerPolicy\": \"workflowsFromSameOwner\",\n    \"executionOrder\": \"v1\"\n  },\n  \"versionId\": \"c2d0b26b-3366-424a-a741-20649907f008\",\n  \"connections\": {\n    \"If\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Short-Lived Token\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Redirect URL\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Config\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"If\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Webhook\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Config\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Redirect URL\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Redirect\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Long-Lived Token\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Token\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Short-Lived Token\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Long-Lived Token\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Redirect URL\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}