{
  "title": "Perform SEO Keyword Research & Insights with Ahrefs API and Gemini 1.5 Flash",
  "url": "https://n8n.io/workflows/3769-perform-seo-keyword-research-and-insights-with-ahrefs-api-and-gemini-15-flash/",
  "category": "Marketing",
  "category_url": "https://n8n.io/workflows/categories/marketing/?sort=createdAt:desc",
  "author": "Joseph",
  "publish_date": "Last update 6 days ago",
  "publish_date_absolute": "2025-05-13",
  "content": "",
  "workflow_json": "{\"id\":\"OO4izN00xPfIPGaB\",\"meta\":{\"instanceId\":\"b3c467df4053d13fe31cc98f3c66fa1d16300ba750506bfd019a0913cec71ea3\",\"templateCredsSetupCompleted\":true},\"name\":\"Ahrefs Keyword Research Workflow\",\"tags\":[],\"nodes\":[{\"id\":\"4e420798-7523-4d47-af27-10f85d09f01d\",\"name\":\"When chat message received\",\"type\":\"@n8n/n8n-nodes-langchain.chatTrigger\",\"position\":[-300,-60],\"webhookId\":\"f40acbbc-ac03-43d1-9341-6c9e8c674293\",\"parameters\":{\"options\":{}},\"typeVersion\":1.1},{\"id\":\"0f71c28e-a11b-4aed-a342-e15d2714ab47\",\"name\":\"Google Gemini Chat Model\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatGoogleGemini\",\"position\":[-160,140],\"parameters\":{\"options\":{},\"modelName\":\"models/gemini-1.5-flash\"},\"credentials\":{\"googlePalmApi\":{\"id\":\"zT4YaNflEp2E6S3m\",\"name\":\"Google Gemini(PaLM) Api account\"}},\"typeVersion\":1},{\"id\":\"9b24fc9d-ac8d-4a9b-a7a5-00d1665f47af\",\"name\":\"Google Gemini Chat Model1\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatGoogleGemini\",\"position\":[980,160],\"parameters\":{\"options\":{},\"modelName\":\"models/gemini-1.5-flash\"},\"credentials\":{\"googlePalmApi\":{\"id\":\"zT4YaNflEp2E6S3m\",\"name\":\"Google Gemini(PaLM) Api account\"}},\"typeVersion\":1},{\"id\":\"d0cbe978-040d-4663-895e-85844e203773\",\"name\":\"Keyword Data Response Formatter\",\"type\":\"@n8n/n8n-nodes-langchain.agent\",\"position\":[980,-60],\"parameters\":{\"text\":\"Provide reponse according to the system message. \",\"options\":{\"systemMessage\":\"=system_message:\\n  description: |\\n    Your role is to format and output the keyword data into a clean, readable text format. The input data consists of two main parts: **Main Keyword Data** and **Related Keywords Data**. Your task is to process and output this data in a way that is easy to read for the user. Each keyword and its associated details should be displayed clearly.\\n\\n  Data:\\n    - **Main Keyword Data✨**:\\n        - **Keyword**: \\\"{{ $json.data[0].keyword }}\\\"\\n        - **Average Monthly Searches**: \\\"{{ $json.data[0].avg_monthly_searches }}\\\"\\n          - **Competition Index**: \\\"{{ $json.data[0].competition_index }}\\\"\\n          - **Competition Value**: \\\"{{ $json.data[0].competition_value }}\\\"\\n          - **High CPC**: \\\"{{ $json.data[0].high_cpc }}\\\"\\n          - **Low CPC**: \\\"{{ $json.data[0].low_cpc }}\\\"\\n\\n    - **Related Keywords🧰**:\\n              \\n    \\n        - **1. Keyword**: \\\"{{ $json.data[1].keyword }}\\\"\\n          - **Average Monthly Searches**: \\\"{{ $json.data[1].avg_monthly_searches }}\\\"\\n          - **Competition Index**: \\\"{{ $json.data[1].competition_index }}\\\"\\n          - **Competition Value**: \\\"{{ $json.data[1].competition_value }}\\\"\\n          - **High CPC**: \\\"{{ $json.data[1].high_cpc }}\\\"\\n          - **Low CPC**: \\\"{{ $json.data[1].low_cpc }}\\\"\\n        \\n        - **2. Keyword**: \\\"{{ $json.data[2].keyword }}\\\"\\n          - **Average Monthly Searches**: \\\"{{ $json.data[2].avg_monthly_searches }}\\\"\\n          - **Competition Index**: \\\"{{ $json.data[2].competition_index }}\\\"\\n          - **Competition Value**: \\\"{{ $json.data[2].competition_value }}\\\"\\n          - **High CPC**: \\\"{{ $json.data[2].high_cpc }}\\\"\\n          - **Low CPC**: \\\"{{ $json.data[2].low_cpc }}\\\"\\n        \\n        - **3. Keyword**: \\\"{{ $json.data[3].keyword }}\\\"\\n          - **Average Monthly Searches**: \\\"{{ $json.data[3].avg_monthly_searches }}\\\"\\n          - **Competition Index**: \\\"{{ $json.data[3].competition_index }}\\\"\\n          - **Competition Value**: \\\"{{ $json.data[3].competition_value }}\\\"\\n          - **High CPC**: \\\"{{ $json.data[3].high_cpc }}\\\"\\n          - **Low CPC**: \\\"{{ $json.data[3].low_cpc }}\\\"\\n        \\n        - **4. Keyword**: \\\"{{ $json.data[4].keyword }}\\\"\\n          - **Average Monthly Searches**: \\\"{{ $json.data[4].avg_monthly_searches }}\\\"\\n          - **Competition Index**: \\\"{{ $json.data[4].competition_index }}\\\"\\n          - **Competition Value**: \\\"{{ $json.data[4].competition_value }}\\\"\\n          - **High CPC**: \\\"{{ $json.data[4].high_cpc }}\\\"\\n          - **Low CPC**: \\\"{{ $json.data[4].low_cpc }}\\\"\\n        \\n        - **5. Keyword**: \\\"{{ $json.data[5].keyword }}\\\"\\n          - **Average Monthly Searches**: \\\"{{ $json.data[5].avg_monthly_searches }}\\\"\\n          - **Competition Index**: \\\"{{ $json.data[5].competition_index }}\\\"\\n          - **Competition Value**: \\\"{{ $json.data[5].competition_value }}\\\"\\n          - **High CPC**: \\\"{{ $json.data[5].high_cpc }}\\\"\\n          - **Low CPC**: \\\"{{ $json.data[5].low_cpc }}\\\"\\n        \\n        - **6. Keyword**: \\\"{{ $json.data[6].keyword }}\\\"\\n          - **Average Monthly Searches**: \\\"{{ $json.data[6].avg_monthly_searches }}\\\"\\n          - **Competition Index**: \\\"{{ $json.data[6].competition_index }}\\\"\\n          - **Competition Value**: \\\"{{ $json.data[6].competition_value }}\\\"\\n          - **High CPC**: \\\"{{ $json.data[6].high_cpc }}\\\"\\n          - **Low CPC**: \\\"{{ $json.data[6].low_cpc }}\\\"\\n        \\n        - **7. Keyword**: \\\"{{ $json.data[7].keyword }}\\\"\\n          - **Average Monthly Searches**: \\\"{{ $json.data[7].avg_monthly_searches }}\\\"\\n          - **Competition Index**: \\\"{{ $json.data[7].competition_index }}\\\"\\n          - **Competition Value**: \\\"{{ $json.data[7].competition_value }}\\\"\\n          - **High CPC**: \\\"{{ $json.data[7].high_cpc }}\\\"\\n          - **Low CPC**: \\\"{{ $json.data[7].low_cpc }}\\\"\\n        \\n        - **8. Keyword**: \\\"{{ $json.data[8].keyword }}\\\"\\n          - **Average Monthly Searches**: \\\"{{ $json.data[8].avg_monthly_searches }}\\\"\\n          - **Competition Index**: \\\"{{ $json.data[8].competition_index }}\\\"\\n          - **Competition Value**: \\\"{{ $json.data[8].competition_value }}\\\"\\n          - **High CPC**: \\\"{{ $json.data[8].high_cpc }}\\\"\\n          - **Low CPC**: \\\"{{ $json.data[8].low_cpc }}\\\"\\n        \\n        - **9. Keyword**: \\\"{{ $json.data[9].keyword }}\\\"\\n          - **Average Monthly Searches**: \\\"{{ $json.data[9].avg_monthly_searches }}\\\"\\n          - **Competition Index**: \\\"{{ $json.data[9].competition_index }}\\\"\\n          - **Competition Value**: \\\"{{ $json.data[9].competition_value }}\\\"\\n          - **High CPC**: \\\"{{ $json.data[9].high_cpc }}\\\"\\n          - **Low CPC**: \\\"{{ $json.data[9].low_cpc }}\\\"\\n\\n        - **10. Keyword**: \\\"{{ $json.data[10].keyword }}\\\"\\n          - **Average Monthly Searches**: \\\"{{ $json.data[10].avg_monthly_searches }}\\\"\\n          - **Competition Index**: \\\"{{ $json.data[10].competition_index }}\\\"\\n          - **Competition Value**: \\\"{{ $json.data[10].competition_value }}\\\"\\n          - **High CPC**: \\\"{{ $json.data[10].high_cpc }}\\\"\\n          - **Low CPC**: \\\"{{ $json.data[10].low_cpc }}\\\"\\n\"},\"promptType\":\"define\"},\"typeVersion\":1.8},{\"id\":\"9cb26cde-dbff-4118-a141-ebd1fd7df1b1\",\"name\":\"Keyword Query Extraction & Cleaning Agent\",\"type\":\"@n8n/n8n-nodes-langchain.agent\",\"position\":[-80,-60],\"parameters\":{\"options\":{\"systemMessage\":\"You are a helpful assistant. You job is to check the user message and pick out the SEO keyword they have provided and output it. Make sure you output just one SEO keyword. No commentary. Do not rephrase, just correct grammar if it has been misspelt.\"}},\"typeVersion\":1.8},{\"id\":\"6a59bf1f-68a3-433c-9cf7-47cadc1a77eb\",\"name\":\"Extract Main Keyword & 10 related Keyword data\",\"type\":\"n8n-nodes-base.code\",\"position\":[540,-60],\"parameters\":{\"jsCode\":\"// Get the main keyword data (Global Keyword Data)\\nconst mainKeywordData = $input.first().json['Global Keyword Data']?.[0] || {};\\n\\n// Get the related keywords array\\nconst relatedKeywords = $input.first().json['Related Keyword Data (Global)'] || [];\\n\\n// Create an output array that includes the main keyword data first\\nconst output = [\\n  {\\n    keyword: mainKeywordData.keyword || 'N/A',\\n    avg_monthly_searches: mainKeywordData.avg_monthly_searches || 'N/A',\\n    competition_index: mainKeywordData.competition_index || 'N/A',\\n    competition_value: mainKeywordData.competition_value || 'N/A',\\n    high_cpc: mainKeywordData['High CPC'] || 'N/A',\\n    low_cpc: mainKeywordData['Low CPC'] || 'N/A'\\n  },\\n  // Map up to 10 related keywords with selected fields\\n  ...relatedKeywords.slice(0, 10).map(item => ({\\n    keyword: item.keyword,\\n    avg_monthly_searches: item.avg_monthly_searches,\\n    competition_index: item.competition_index,\\n    competition_value: item.competition_value,\\n    high_cpc: item['High CPC'],\\n    low_cpc: item['Low CPC']\\n  }))\\n];\\n\\nreturn output;\\n\"},\"typeVersion\":2},{\"id\":\"a2b1b9ff-a425-4c99-bd36-a4bb0e0cd84e\",\"name\":\"Aggregate Keyword Data\",\"type\":\"n8n-nodes-base.aggregate\",\"position\":[800,-60],\"parameters\":{\"options\":{},\"aggregate\":\"aggregateAllItemData\"},\"typeVersion\":1},{\"id\":\"36d4c962-71f2-473a-841c-053c6c36bcda\",\"name\":\"Ahrefs Keyword API Request\",\"type\":\"n8n-nodes-base.httpRequest\",\"maxTries\":2,\"position\":[280,-60],\"parameters\":{\"url\":\"https://ahrefs-keyword-tool.p.rapidapi.com/global-volume\",\"options\":{},\"sendQuery\":true,\"sendHeaders\":true,\"queryParameters\":{\"parameters\":[{\"name\":\"keyword\",\"value\":\"={{ $json.output }}\"}]},\"headerParameters\":{\"parameters\":[{\"name\":\"x-rapidapi-host\",\"value\":\"ahrefs-keyword-tool.p.rapidapi.com\"},{\"name\":\"x-rapidapi-key\",\"value\":\"\\\"your_rapid_api_key_here\\\"\"}]}},\"retryOnFail\":true,\"typeVersion\":4.2},{\"id\":\"47898c8e-37e7-4abc-beb2-64fc546a7c03\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-80,-260],\"parameters\":{\"color\":6,\"width\":260,\"content\":\"## Keyword Query Extraction\\nThis ai agent is important so that you always make sure for all queries you send, only the keyword phrase will be passed over to the API request node, and if you misspell any word, it will be corrected.\"},\"typeVersion\":1},{\"id\":\"c83f2813-d57c-48d6-8c66-6a057ca9cfc9\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[280,-260],\"parameters\":{\"color\":4,\"content\":\"## The API Request\\nYou can tweak this to either get \\\"answer the public kwywords\\\" or \\\"keyword overviews\\\", just visit the api   [docs page](https://rapidapi.com/environmentn1t21r5/api/ahrefs-keyword-tool/playground/apiendpoint_d2790246-c8ef-437f-b928-c0eb6f6ffff4)\"},\"typeVersion\":1},{\"id\":\"98ad64ea-d023-49c0-ab05-21bd87c322b9\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[600,-260],\"parameters\":{\"content\":\"## Extract Keyword Data\\nThe data from the API query will be so so big and I have written this javascript function to extract the most important bits. You can modify it if you want to also get monthly data, or just download the response as pdf and probably pass it for analysis.\"},\"typeVersion\":1},{\"id\":\"1f1d15f3-36f7-4bad-be63-ce74c70580f1\",\"name\":\"Sticky Note3\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-420,-260],\"parameters\":{\"width\":260,\"content\":\"## Trigger Node\\nThis is just a sample trigger node to get started. You can use a telegram, whatsapp, webhook node etc, to get the keyword queried. \"},\"typeVersion\":1},{\"id\":\"a5e0b305-ebc7-44e2-ada2-8d5cf60a1fe2\",\"name\":\"Sticky Note4\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[980,-260],\"parameters\":{\"content\":\"## Respose Formatter\\nThe ai agent node to format responses will give you more room to decide how you want your summaries to be sent back to you. You can modify the system message to get your desired outcome. Otherwise, good luck building on top of this. I will give a detailed docs guide on the main n8n workflow page\"},\"typeVersion\":1},{\"id\":\"00ce5fc5-aff8-4cde-871e-ffea5aa5ffb3\",\"name\":\"Simple Memory\",\"type\":\"@n8n/n8n-nodes-langchain.memoryBufferWindow\",\"position\":[40,140],\"parameters\":{},\"typeVersion\":1.3}],\"active\":false,\"pinData\":{},\"settings\":{\"executionOrder\":\"v1\"},\"versionId\":\"e2857a0c-4473-4d3d-9c63-6b02337bccf0\",\"connections\":{\"Simple Memory\":{\"ai_memory\":[[]]},\"Aggregate Keyword Data\":{\"main\":[[{\"node\":\"Keyword Data Response Formatter\",\"type\":\"main\",\"index\":0}]]},\"Google Gemini Chat Model\":{\"ai_languageModel\":[[{\"node\":\"Keyword Query Extraction & Cleaning Agent\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"Google Gemini Chat Model1\":{\"ai_languageModel\":[[{\"node\":\"Keyword Data Response Formatter\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"Ahrefs Keyword API Request\":{\"main\":[[{\"node\":\"Extract Main Keyword & 10 related Keyword data\",\"type\":\"main\",\"index\":0}]]},\"When chat message received\":{\"main\":[[{\"node\":\"Keyword Query Extraction & Cleaning Agent\",\"type\":\"main\",\"index\":0}]]},\"Keyword Query Extraction & Cleaning Agent\":{\"main\":[[{\"node\":\"Ahrefs Keyword API Request\",\"type\":\"main\",\"index\":0}]]},\"Extract Main Keyword & 10 related Keyword data\":{\"main\":[[{\"node\":\"Aggregate Keyword Data\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "This n8n workflow automates **SEO keyword research** by querying the **Ahrefs API** for keyword data and related keyword insights. The enriched data is then processed by an AI agent to format a response and provide valuable SEO recommendations.\n\nPerfect for **SEO specialists, content marketers, digital agencies** , and anyone looking to gain valuable insights into keyword opportunities to boost their rankings.\n\n* * *\n\n## ⚙️ How This Workflow Works\n\nThis workflow guides you through the entire SEO keyword research process, from entering the initial keyword to receiving detailed insights and related keyword suggestions.\n\n### 1\\. 🗣️ User Input (Keyword Query)\n\n  * The user enters a **keyword** they want to research.\n  * This input is captured by the **Chat Input Node** , ready for analysis.\n\n\n\n### 2\\. 🤖 AI Agent (Input Verification)\n\n  * The AI Agent reviews the keyword input for any **grammatical errors** or extra commentary.\n  * If necessary, it cleans the input to ensure a seamless query to the API.\n\n\n\n### 3\\. 🔑 Ahrefs API (Keyword Data Retrieval)\n\n  * The cleaned **keyword** is sent to the **Ahrefs Keyword Tool API**.\n  * This retrieves a detailed report including metrics like **search volume** , **keyword difficulty** , and **CPC**.\n\n\n\n### 4\\. 💡 Related Keywords Extraction (Using JavaScript Function)\n\n  * The workflow uses a **JavaScript function** to extract main keyword data and **10 related keywords data** from the Ahrefs response.\n  * You can tweak the script to adjust the number of related keywords or the level of detail you want.\n\n\n\n### 5\\. 🧠 AI Agent (Text Formatting)\n\n  * The aggregated data, including both the main keyword and related keywords, is sent to an **AI agent**.\n  * The AI agent formats the data into a concise, readable format that can be shared with the user.\n\n\n\n### 6\\. 📨 Final Response\n\n  * The formatted text is delivered to the user with keyword insights, recommendations, and related keyword suggestions.\n\n\n\n* * *\n\n## ✅ Smart Retry & Error Handling\n\nEach subworkflow includes a **fail-safe mechanism** to ensure:\n\n  * ✅ Proper error handling for any issues with the API request.\n  * 🕒 Failed API requests are retried after a **customizable period** (e.g., 2 hours or 1 day).\n  * 💬 **User input validation** prevents any incorrect or malformed queries from being processed.\n\n\n\n* * *\n\n## 📋 Ahrefs API Setup\n\nTo use this workflow, you’ll need to set up your Ahrefs API credentials:\n\n### 🔑 Ahrefs API\n\n  * Sign up for an Ahrefs account and get your key here: [Ahrefs Keyword Tool API](https://rapidapi.com/environmentn1t21r5/api/ahrefs-keyword-tool)\n  * Once signed up, you'll receive an API key, which you’ll use in the `x-rapidapi-key` header in n8n.\n  * Ensure you check the **Ahrefs Keyword Tool API documentation** for more details on available parameters.\n\n\n\n* * *\n\n## 📥 How to Import This Workflow\n\n  1. Copy the json code.\n  2. Open your n8n instance.\n  3. Open a new workflow.\n  4. Paste anywhere inside the workflow.\n  5. Voila.\n\n\n\n* * *\n\n## 🛠️ Customization Options\n\n  * Adjust the **number of related keywords** extracted (default is 10).\n  * Customize the **AI agent response** formatting or add specific recommendations for users.\n  * Modify the JavaScript function to **extract different metrics** from the Ahrefs API.\n\n\n\n* * *\n\n## 🧪 Use Case Example\n\nTrying to optimize your blog post around a specific keyword?\n\n  1. Query a broad keyword, like **“SEO tips”**.\n  2. Get related keyword data and **search volume insights**.\n  3. Use the AI agent to provide **keyword recommendations** and additional topics to target.\n  4. 💥 Boost your content strategy with fresh keywords and relevant search data!\n\n\n",
  "readme_html": "<!--[--><div data-v-50766329=\"\"><p>This n8n workflow automates <strong>SEO keyword research</strong> by querying the <strong>Ahrefs API</strong> for keyword data and related keyword insights. The enriched data is then processed by an AI agent to format a response and provide valuable SEO recommendations.</p>\n<p>Perfect for <strong>SEO specialists, content marketers, digital agencies</strong>, and anyone looking to gain valuable insights into keyword opportunities to boost their rankings.</p>\n<hr>\n<h2>⚙️ How This Workflow Works</h2>\n<p>This workflow guides you through the entire SEO keyword research process, from entering the initial keyword to receiving detailed insights and related keyword suggestions.</p>\n<h3>1. 🗣️ User Input (Keyword Query)</h3>\n<ul>\n<li>The user enters a <strong>keyword</strong> they want to research.</li>\n<li>This input is captured by the <strong>Chat Input Node</strong>, ready for analysis.</li>\n</ul>\n<h3>2. 🤖 AI Agent (Input Verification)</h3>\n<ul>\n<li>The AI Agent reviews the keyword input for any <strong>grammatical errors</strong> or extra commentary.</li>\n<li>If necessary, it cleans the input to ensure a seamless query to the API.</li>\n</ul>\n<h3>3. 🔑 Ahrefs API (Keyword Data Retrieval)</h3>\n<ul>\n<li>The cleaned <strong>keyword</strong> is sent to the <strong>Ahrefs Keyword Tool API</strong>.</li>\n<li>This retrieves a detailed report including metrics like <strong>search volume</strong>, <strong>keyword difficulty</strong>, and <strong>CPC</strong>.</li>\n</ul>\n<h3>4. 💡 Related Keywords Extraction (Using JavaScript Function)</h3>\n<ul>\n<li>The workflow uses a <strong>JavaScript function</strong> to extract main keyword data and <strong>10 related keywords data</strong> from the Ahrefs response.</li>\n<li>You can tweak the script to adjust the number of related keywords or the level of detail you want.</li>\n</ul>\n<h3>5. 🧠 AI Agent (Text Formatting)</h3>\n<ul>\n<li>The aggregated data, including both the main keyword and related keywords, is sent to an <strong>AI agent</strong>.</li>\n<li>The AI agent formats the data into a concise, readable format that can be shared with the user.</li>\n</ul>\n<h3>6. 📨 Final Response</h3>\n<ul>\n<li>The formatted text is delivered to the user with keyword insights, recommendations, and related keyword suggestions.</li>\n</ul>\n<hr>\n<h2>✅ Smart Retry &amp; Error Handling</h2>\n<p>Each subworkflow includes a <strong>fail-safe mechanism</strong> to ensure:</p>\n<ul>\n<li>✅ Proper error handling for any issues with the API request.</li>\n<li>🕒 Failed API requests are retried after a <strong>customizable period</strong> (e.g., 2 hours or 1 day).</li>\n<li>💬 <strong>User input validation</strong> prevents any incorrect or malformed queries from being processed.</li>\n</ul>\n<hr>\n<h2>📋 Ahrefs API Setup</h2>\n<p>To use this workflow, you’ll need to set up your Ahrefs API credentials:</p>\n<h3>🔑 Ahrefs API</h3>\n<ul>\n<li>Sign up for an Ahrefs account and get your key here: <a href=\"https://rapidapi.com/environmentn1t21r5/api/ahrefs-keyword-tool\" rel=\"ugc nofollow\" target=\"_blank\">Ahrefs Keyword Tool API</a></li>\n<li>Once signed up, you'll receive an API key, which you’ll use in the <code>x-rapidapi-key</code> header in n8n.</li>\n<li>Ensure you check the <strong>Ahrefs Keyword Tool API documentation</strong> for more details on available parameters.</li>\n</ul>\n<hr>\n<h2>📥 How to Import This Workflow</h2>\n<ol>\n<li>Copy the json code.</li>\n<li>Open your n8n instance.</li>\n<li>Open a new workflow.</li>\n<li>Paste anywhere inside the workflow.</li>\n<li>Voila.</li>\n</ol>\n<hr>\n<h2>🛠️ Customization Options</h2>\n<ul>\n<li>Adjust the <strong>number of related keywords</strong> extracted (default is 10).</li>\n<li>Customize the <strong>AI agent response</strong> formatting or add specific recommendations for users.</li>\n<li>Modify the JavaScript function to <strong>extract different metrics</strong> from the Ahrefs API.</li>\n</ul>\n<hr>\n<h2>🧪 Use Case Example</h2>\n<p>Trying to optimize your blog post around a specific keyword?</p>\n<ol>\n<li>Query a broad keyword, like <strong>“SEO tips”</strong>.</li>\n<li>Get related keyword data and <strong>search volume insights</strong>.</li>\n<li>Use the AI agent to provide <strong>keyword recommendations</strong> and additional topics to target.</li>\n<li>💥 Boost your content strategy with fresh keywords and relevant search data!</li>\n</ol>\n</div><!--]-->",
  "readme_zh": "该n8n工作流通过调用**Ahrefs API**获取关键词数据及相关洞察，实现**SEO关键词研究**自动化。AI智能体将对增强数据进行处理，生成格式化响应并提供有价值的SEO建议。\n\n特别适合**SEO专家、内容营销人员、数字营销机构**以及任何希望通过关键词机会提升搜索排名的用户。\n\n* * *\n\n## ⚙️ 工作流运行原理\n\n本工作流完整覆盖SEO关键词研究全流程，从初始关键词输入到获取详细洞察及相关关键词建议。\n\n### 1\\. 🗣️ 用户输入（关键词查询）\n\n  * 用户输入待研究**关键词**\n  * **聊天输入节点**捕获该输入内容以待分析",
  "title_zh": "使用Ahrefs API和Gemini 1.5 Flash进行SEO关键词研究与洞察",
  "publish_date_zh": "最后更新于6天前",
  "workflow_json_zh": "{\n  \"id\": \"OO4izN00xPfIPGaB\",\n  \"meta\": {\n    \"instanceId\": \"b3c467df4053d13fe31cc98f3c66fa1d16300ba750506bfd019a0913cec71ea3\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"name\": \"Ahrefs Keyword Research Workflow\",\n  \"tags\": [],\n  \"nodes\": [\n    {\n      \"id\": \"4e420798-7523-4d47-af27-10f85d09f01d\",\n      \"name\": \"When chat message received\",\n      \"type\": \"@n8n/n8n-nodes-langchain.chatTrigger\",\n      \"position\": [\n        -300,\n        -60\n      ],\n      \"webhookId\": \"f40acbbc-ac03-43d1-9341-6c9e8c674293\",\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"0f71c28e-a11b-4aed-a342-e15d2714ab47\",\n      \"name\": \"Google Gemini Chat Model\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatGoogleGemini\",\n      \"position\": [\n        -160,\n        140\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"modelName\": \"models/gemini-1.5-flash\"\n      },\n      \"credentials\": {\n        \"googlePalmApi\": {\n          \"id\": \"zT4YaNflEp2E6S3m\",\n          \"name\": \"Google Gemini(PaLM) Api account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"9b24fc9d-ac8d-4a9b-a7a5-00d1665f47af\",\n      \"name\": \"Google Gemini Chat Model1\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatGoogleGemini\",\n      \"position\": [\n        980,\n        160\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"modelName\": \"models/gemini-1.5-flash\"\n      },\n      \"credentials\": {\n        \"googlePalmApi\": {\n          \"id\": \"zT4YaNflEp2E6S3m\",\n          \"name\": \"Google Gemini(PaLM) Api account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"d0cbe978-040d-4663-895e-85844e203773\",\n      \"name\": \"Keyword Data Response Formatter\",\n      \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n      \"position\": [\n        980,\n        -60\n      ],\n      \"parameters\": {\n        \"text\": \"Provide reponse according to the system message. \",\n        \"options\": {\n          \"systemMessage\": \"=system_message:\\n  description: |\\n    Your role is to format and output the keyword data into a clean, readable text format. The input data consists of two main parts: **Main Keyword Data** and **Related Keywords Data**. Your task is to process and output this data in a way that is easy to read for the user. Each keyword and its associated details should be displayed clearly.\\n\\n  Data:\\n    - **Main Keyword Data✨**:\\n        - **Keyword**: \\\"{{ $json.data[0].keyword }}\\\"\\n        - **Average Monthly Searches**: \\\"{{ $json.data[0].avg_monthly_searches }}\\\"\\n          - **Competition Index**: \\\"{{ $json.data[0].competition_index }}\\\"\\n          - **Competition Value**: \\\"{{ $json.data[0].competition_value }}\\\"\\n          - **High CPC**: \\\"{{ $json.data[0].high_cpc }}\\\"\\n          - **Low CPC**: \\\"{{ $json.data[0].low_cpc }}\\\"\\n\\n    - **Related Keywords🧰**:\\n              \\n    \\n        - **1. Keyword**: \\\"{{ $json.data[1].keyword }}\\\"\\n          - **Average Monthly Searches**: \\\"{{ $json.data[1].avg_monthly_searches }}\\\"\\n          - **Competition Index**: \\\"{{ $json.data[1].competition_index }}\\\"\\n          - **Competition Value**: \\\"{{ $json.data[1].competition_value }}\\\"\\n          - **High CPC**: \\\"{{ $json.data[1].high_cpc }}\\\"\\n          - **Low CPC**: \\\"{{ $json.data[1].low_cpc }}\\\"\\n        \\n        - **2. Keyword**: \\\"{{ $json.data[2].keyword }}\\\"\\n          - **Average Monthly Searches**: \\\"{{ $json.data[2].avg_monthly_searches }}\\\"\\n          - **Competition Index**: \\\"{{ $json.data[2].competition_index }}\\\"\\n          - **Competition Value**: \\\"{{ $json.data[2].competition_value }}\\\"\\n          - **High CPC**: \\\"{{ $json.data[2].high_cpc }}\\\"\\n          - **Low CPC**: \\\"{{ $json.data[2].low_cpc }}\\\"\\n        \\n        - **3. Keyword**: \\\"{{ $json.data[3].keyword }}\\\"\\n          - **Average Monthly Searches**: \\\"{{ $json.data[3].avg_monthly_searches }}\\\"\\n          - **Competition Index**: \\\"{{ $json.data[3].competition_index }}\\\"\\n          - **Competition Value**: \\\"{{ $json.data[3].competition_value }}\\\"\\n          - **High CPC**: \\\"{{ $json.data[3].high_cpc }}\\\"\\n          - **Low CPC**: \\\"{{ $json.data[3].low_cpc }}\\\"\\n        \\n        - **4. Keyword**: \\\"{{ $json.data[4].keyword }}\\\"\\n          - **Average Monthly Searches**: \\\"{{ $json.data[4].avg_monthly_searches }}\\\"\\n          - **Competition Index**: \\\"{{ $json.data[4].competition_index }}\\\"\\n          - **Competition Value**: \\\"{{ $json.data[4].competition_value }}\\\"\\n          - **High CPC**: \\\"{{ $json.data[4].high_cpc }}\\\"\\n          - **Low CPC**: \\\"{{ $json.data[4].low_cpc }}\\\"\\n        \\n        - **5. Keyword**: \\\"{{ $json.data[5].keyword }}\\\"\\n          - **Average Monthly Searches**: \\\"{{ $json.data[5].avg_monthly_searches }}\\\"\\n          - **Competition Index**: \\\"{{ $json.data[5].competition_index }}\\\"\\n          - **Competition Value**: \\\"{{ $json.data[5].competition_value }}\\\"\\n          - **High CPC**: \\\"{{ $json.data[5].high_cpc }}\\\"\\n          - **Low CPC**: \\\"{{ $json.data[5].low_cpc }}\\\"\\n        \\n        - **6. Keyword**: \\\"{{ $json.data[6].keyword }}\\\"\\n          - **Average Monthly Searches**: \\\"{{ $json.data[6].avg_monthly_searches }}\\\"\\n          - **Competition Index**: \\\"{{ $json.data[6].competition_index }}\\\"\\n          - **Competition Value**: \\\"{{ $json.data[6].competition_value }}\\\"\\n          - **High CPC**: \\\"{{ $json.data[6].high_cpc }}\\\"\\n          - **Low CPC**: \\\"{{ $json.data[6].low_cpc }}\\\"\\n        \\n        - **7. Keyword**: \\\"{{ $json.data[7].keyword }}\\\"\\n          - **Average Monthly Searches**: \\\"{{ $json.data[7].avg_monthly_searches }}\\\"\\n          - **Competition Index**: \\\"{{ $json.data[7].competition_index }}\\\"\\n          - **Competition Value**: \\\"{{ $json.data[7].competition_value }}\\\"\\n          - **High CPC**: \\\"{{ $json.data[7].high_cpc }}\\\"\\n          - **Low CPC**: \\\"{{ $json.data[7].low_cpc }}\\\"\\n        \\n        - **8. Keyword**: \\\"{{ $json.data[8].keyword }}\\\"\\n          - **Average Monthly Searches**: \\\"{{ $json.data[8].avg_monthly_searches }}\\\"\\n          - **Competition Index**: \\\"{{ $json.data[8].competition_index }}\\\"\\n          - **Competition Value**: \\\"{{ $json.data[8].competition_value }}\\\"\\n          - **High CPC**: \\\"{{ $json.data[8].high_cpc }}\\\"\\n          - **Low CPC**: \\\"{{ $json.data[8].low_cpc }}\\\"\\n        \\n        - **9. Keyword**: \\\"{{ $json.data[9].keyword }}\\\"\\n          - **Average Monthly Searches**: \\\"{{ $json.data[9].avg_monthly_searches }}\\\"\\n          - **Competition Index**: \\\"{{ $json.data[9].competition_index }}\\\"\\n          - **Competition Value**: \\\"{{ $json.data[9].competition_value }}\\\"\\n          - **High CPC**: \\\"{{ $json.data[9].high_cpc }}\\\"\\n          - **Low CPC**: \\\"{{ $json.data[9].low_cpc }}\\\"\\n\\n        - **10. Keyword**: \\\"{{ $json.data[10].keyword }}\\\"\\n          - **Average Monthly Searches**: \\\"{{ $json.data[10].avg_monthly_searches }}\\\"\\n          - **Competition Index**: \\\"{{ $json.data[10].competition_index }}\\\"\\n          - **Competition Value**: \\\"{{ $json.data[10].competition_value }}\\\"\\n          - **High CPC**: \\\"{{ $json.data[10].high_cpc }}\\\"\\n          - **Low CPC**: \\\"{{ $json.data[10].low_cpc }}\\\"\\n\"\n        },\n        \"promptType\": \"define\"\n      },\n      \"typeVersion\": 1.8\n    },\n    {\n      \"id\": \"9cb26cde-dbff-4118-a141-ebd1fd7df1b1\",\n      \"name\": \"Keyword Query Extraction & Cleaning Agent\",\n      \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n      \"position\": [\n        -80,\n        -60\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"systemMessage\": \"You are a helpful assistant. You job is to check the user message and pick out the SEO keyword they have provided and output it. Make sure you output just one SEO keyword. No commentary. Do not rephrase, just correct grammar if it has been misspelt.\"\n        }\n      },\n      \"typeVersion\": 1.8\n    },\n    {\n      \"id\": \"6a59bf1f-68a3-433c-9cf7-47cadc1a77eb\",\n      \"name\": \"Extract Main Keyword & 10 related Keyword data\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        540,\n        -60\n      ],\n      \"parameters\": {\n        \"jsCode\": \"// Get the main keyword data (Global Keyword Data)\\nconst mainKeywordData = $input.first().json['Global Keyword Data']?.[0] || {};\\n\\n// Get the related keywords array\\nconst relatedKeywords = $input.first().json['Related Keyword Data (Global)'] || [];\\n\\n// Create an output array that includes the main keyword data first\\nconst output = [\\n  {\\n    keyword: mainKeywordData.keyword || 'N/A',\\n    avg_monthly_searches: mainKeywordData.avg_monthly_searches || 'N/A',\\n    competition_index: mainKeywordData.competition_index || 'N/A',\\n    competition_value: mainKeywordData.competition_value || 'N/A',\\n    high_cpc: mainKeywordData['High CPC'] || 'N/A',\\n    low_cpc: mainKeywordData['Low CPC'] || 'N/A'\\n  },\\n  // Map up to 10 related keywords with selected fields\\n  ...relatedKeywords.slice(0, 10).map(item => ({\\n    keyword: item.keyword,\\n    avg_monthly_searches: item.avg_monthly_searches,\\n    competition_index: item.competition_index,\\n    competition_value: item.competition_value,\\n    high_cpc: item['High CPC'],\\n    low_cpc: item['Low CPC']\\n  }))\\n];\\n\\nreturn output;\\n\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"a2b1b9ff-a425-4c99-bd36-a4bb0e0cd84e\",\n      \"name\": \"Aggregate Keyword Data\",\n      \"type\": \"n8n-nodes-base.aggregate\",\n      \"position\": [\n        800,\n        -60\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"aggregate\": \"aggregateAllItemData\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"36d4c962-71f2-473a-841c-053c6c36bcda\",\n      \"name\": \"Ahrefs Keyword API Request\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"maxTries\": 2,\n      \"position\": [\n        280,\n        -60\n      ],\n      \"parameters\": {\n        \"url\": \"https://ahrefs-keyword-tool.p.rapidapi.com/global-volume\",\n        \"options\": {},\n        \"sendQuery\": true,\n        \"sendHeaders\": true,\n        \"queryParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"keyword\",\n              \"value\": \"={{ $json.output }}\"\n            }\n          ]\n        },\n        \"headerParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"x-rapidapi-host\",\n              \"value\": \"ahrefs-keyword-tool.p.rapidapi.com\"\n            },\n            {\n              \"name\": \"x-rapidapi-key\",\n              \"value\": \"\\\"your_rapid_api_key_here\\\"\"\n            }\n          ]\n        }\n      },\n      \"retryOnFail\": true,\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"47898c8e-37e7-4abc-beb2-64fc546a7c03\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -80,\n        -260\n      ],\n      \"parameters\": {\n        \"color\": 6,\n        \"width\": 260,\n        \"content\": \"## 关键词查询提取\\n该AI代理至关重要，它能确保所有发送的查询中仅有关键词短语会被传递至API请求节点，且任何拼写错误都将被自动纠正。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"c83f2813-d57c-48d6-8c66-6a057ca9cfc9\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        280,\n        -260\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"content\": \"## API请求\\n您可以通过调整参数获取“Answer The Public关键词”或“关键词概览”数据，只需访问API [文档页面](https://rapidapi.com/environmentn1t21r5/api/ahrefs-keyword-tool/playground/apiendpoint_d2790246-c8ef-437f-b928-c0eb6f6ffff4)即可\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"98ad64ea-d023-49c0-ab05-21bd87c322b9\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        600,\n        -260\n      ],\n      \"parameters\": {\n        \"content\": \"## 提取关键词数据\\n从API查询获取的数据量会非常庞大，为此我编写了这个JavaScript函数来提取最关键的部分。如需同时获取月度数据，你可以自行修改该函数；或者直接下载响应内容为PDF文件，再将其传递进行后续分析。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"1f1d15f3-36f7-4bad-be63-ce74c70580f1\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -420,\n        -260\n      ],\n      \"parameters\": {\n        \"width\": 260,\n        \"content\": \"## 触发节点\\n这只是一个用于入门的示例触发节点。您可以使用电报、WhatsApp、Webhook等节点来获取查询的关键词。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"a5e0b305-ebc7-44e2-ada2-8d5cf60a1fe2\",\n      \"name\": \"Sticky Note4\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        980,\n        -260\n      ],\n      \"parameters\": {\n        \"content\": \"## 响应格式化器\\n这个用于格式化响应的AI代理节点将为您提供更多空间来决定如何将摘要返回给您。您可以通过修改系统消息来获得期望的输出结果。除此之外，祝您在此基础上顺利开发。我将在主n8n工作流页面上提供详细的文档指南。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"00ce5fc5-aff8-4cde-871e-ffea5aa5ffb3\",\n      \"name\": \"Simple Memory\",\n      \"type\": \"@n8n/n8n-nodes-langchain.memoryBufferWindow\",\n      \"position\": [\n        40,\n        140\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1.3\n    }\n  ],\n  \"active\": false,\n  \"pinData\": {},\n  \"settings\": {\n    \"executionOrder\": \"v1\"\n  },\n  \"versionId\": \"e2857a0c-4473-4d3d-9c63-6b02337bccf0\",\n  \"connections\": {\n    \"Simple Memory\": {\n      \"ai_memory\": [\n        []\n      ]\n    },\n    \"Aggregate Keyword Data\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Keyword Data Response Formatter\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Google Gemini Chat Model\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"Keyword Query Extraction & Cleaning Agent\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Google Gemini Chat Model1\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"Keyword Data Response Formatter\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Ahrefs Keyword API Request\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Extract Main Keyword & 10 related Keyword data\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"When chat message received\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Keyword Query Extraction & Cleaning Agent\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Keyword Query Extraction & Cleaning Agent\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Ahrefs Keyword API Request\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Extract Main Keyword & 10 related Keyword data\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Aggregate Keyword Data\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}