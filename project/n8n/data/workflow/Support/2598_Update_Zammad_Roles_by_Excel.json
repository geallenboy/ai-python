{
  "title": "Update Zammad Roles by Excel",
  "url": "https://n8n.io/workflows/2598-update-zammad-roles-by-excel/",
  "category": "Support",
  "category_url": "https://n8n.io/workflows/categories/support/?count=20",
  "author": "Sirhexalot",
  "publish_date": "Last update 5 months ago",
  "publish_date_absolute": "2024-12-06",
  "content": "",
  "workflow_json": "{\"id\":\"xzKlhjcc6QEzA98Z\",\"meta\":{\"instanceId\":\"494d0146a0f47676ad70a44a32086b466621f62da855e3eaf0ee51dee1f76753\",\"templateId\":\"2041\",\"templateCredsSetupCompleted\":true},\"name\":\"Update Roles by Excel\",\"tags\":[],\"nodes\":[{\"id\":\"580d8a47-32cc-4976-a464-793523ae3d1e\",\"name\":\"When clicking \\\"Execute Workflow\\\"\",\"type\":\"n8n-nodes-base.manualTrigger\",\"position\":[80,140],\"parameters\":{},\"typeVersion\":1},{\"id\":\"f37ea772-a953-4b5b-8e54-c76e42938544\",\"name\":\"Extract from File\",\"type\":\"n8n-nodes-base.extractFromFile\",\"position\":[760,140],\"parameters\":{\"options\":{},\"operation\":\"xlsx\"},\"typeVersion\":1},{\"id\":\"60ab7913-d421-41cd-af04-ccec2ed6838e\",\"name\":\"Merge\",\"type\":\"n8n-nodes-base.merge\",\"position\":[1700,120],\"parameters\":{\"mode\":\"combine\",\"options\":{},\"fieldsToMatchString\":\"email\"},\"typeVersion\":3},{\"id\":\"ad6719b4-95dc-419e-94cb-97039014be62\",\"name\":\"Basic Variables\",\"type\":\"n8n-nodes-base.set\",\"position\":[320,140],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"68b32087-5e23-4590-8042-0061234ce479\",\"name\":\"zammad_base_url\",\"type\":\"string\",\"value\":\"https://zammad.sirhexalot.de/\"},{\"id\":\"240f4dc5-a070-4623-96e7-1e0750dbeba5\",\"name\":\"excel_source_url\",\"type\":\"string\",\"value\":\"http://zammad.sirhexalot.de/Users.txt\"}]}},\"typeVersion\":3.4},{\"id\":\"8f18e493-5dbe-4447-a422-450c610e9585\",\"name\":\"Zammad Univeral User Object\",\"type\":\"n8n-nodes-base.set\",\"position\":[1020,140],\"parameters\":{\"values\":{\"string\":[{\"name\":\"email\",\"value\":\"={{ $json.email }}\"},{\"name\":\"role_ids\",\"value\":\"={{ $json.role_ids }}\\n\"}]},\"options\":{},\"keepOnlySet\":true},\"typeVersion\":1},{\"id\":\"5bc0a423-91bc-4b52-af05-2869223bbbff\",\"name\":\"Download Excel\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[540,140],\"parameters\":{\"url\":\"={{ $json.excel_source_url }}\",\"options\":{\"response\":{\"response\":{\"responseFormat\":\"file\"}}}},\"typeVersion\":4.1},{\"id\":\"b5962a7b-27d3-45f1-adc4-1abff5d1c990\",\"name\":\"Find Zammad User by email\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[1360,-60],\"parameters\":{\"url\":\"={{ $('Basic Variables').item.json.zammad_base_url }}api/v1/users/search?query=email:{{ $json.email }}\",\"options\":{},\"authentication\":\"genericCredentialType\",\"genericAuthType\":\"httpHeaderAuth\"},\"credentials\":{\"httpHeaderAuth\":{\"id\":\"GJ7tG0KxDpEUv3DS\",\"name\":\"zammad.sirhexalot.de\"}},\"executeOnce\":false,\"typeVersion\":4.2,\"alwaysOutputData\":false},{\"id\":\"0b8f5007-d28d-4406-a7ec-aa69d2b865d5\",\"name\":\"Update User Roles\",\"type\":\"n8n-nodes-base.httpRequest\",\"onError\":\"continueErrorOutput\",\"position\":[2020,120],\"parameters\":{\"url\":\"={{ $('Basic Variables').item.json.zammad_base_url }}/api/v1/users/{{ $json.id }}\",\"method\":\"PUT\",\"options\":{},\"jsonBody\":\"={\\n  \\\"role_ids\\\": [\\n  {{ $json.role_ids }}\\n  ]\\n} \",\"sendBody\":true,\"specifyBody\":\"json\",\"authentication\":\"genericCredentialType\",\"genericAuthType\":\"httpHeaderAuth\"},\"credentials\":{\"httpHeaderAuth\":{\"id\":\"GJ7tG0KxDpEUv3DS\",\"name\":\"zammad.sirhexalot.de\"}},\"typeVersion\":4.2},{\"id\":\"7724e271-0beb-4fc3-a9dd-4e55bcf033a1\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[60,-500],\"parameters\":{\"width\":577.5890410958907,\"height\":253.58904109589045,\"content\":\"## Authentication for Zammad\\n\\nCreate in the Node Find Zammad User by email a Header Auth Authentication\\n\\nUse:\\n\\nName: Authorization\\nValue: Bearer - put here your zammad api token - \\n\"},\"typeVersion\":1}],\"active\":false,\"pinData\":{},\"settings\":{\"executionOrder\":\"v1\"},\"versionId\":\"2e34f31f-cb00-43e1-8709-6405ea8521ac\",\"connections\":{\"Merge\":{\"main\":[[{\"node\":\"Update User Roles\",\"type\":\"main\",\"index\":0}]]},\"Download Excel\":{\"main\":[[{\"node\":\"Extract from File\",\"type\":\"main\",\"index\":0}]]},\"Basic Variables\":{\"main\":[[{\"node\":\"Download Excel\",\"type\":\"main\",\"index\":0}]]},\"Extract from File\":{\"main\":[[{\"node\":\"Zammad Univeral User Object\",\"type\":\"main\",\"index\":0}]]},\"Find Zammad User by email\":{\"main\":[[{\"node\":\"Merge\",\"type\":\"main\",\"index\":0}]]},\"Zammad Univeral User Object\":{\"main\":[[{\"node\":\"Merge\",\"type\":\"main\",\"index\":1},{\"node\":\"Find Zammad User by email\",\"type\":\"main\",\"index\":0}]]},\"When clicking \\\"Execute Workflow\\\"\":{\"main\":[[{\"node\":\"Basic Variables\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "This n8n workflow allows you to update user roles in Zammad based on data from an Excel file. The workflow automates role assignments, ensuring efficient and consistent updates.\n\n## Features\n\n  * **Excel Integration** : Import user data from an Excel file containing emails and role assignments.\n  * **Dynamic Updates** : Match Zammad users by email and update their roles.\n  * **Error Handling** : Continue workflow execution even if some updates fail.\n  * **Customizable Variables** : Configure Zammad API URL, API key, and Excel file URL.\n\n\n\n## Usage\n\n  1. **Import the Workflow** : Upload the provided `.json` file into your n8n instance.\n  2. **Set Variables** : \n     * `zammad_base_url`: Your Zammad instance URL.\n     * `excel_source_url`: URL of the Excel file containing user data.\n  3. **Authentication for Zammad**\n\n\n  * Create in the Node \"Find Zammad User by email\" and \"Update User Roles\" a Header Auth Authentication\n  * **Name** : Authorization\n  * **Value** : Bearer <put here your zammad api token>\n\n\n  1. **Run the Workflow** : Execute the workflow to update user roles based on the Excel data.\n\n\n\n## Issues and Suggestions\n\nFor issues or suggestions, visit the [GitHub Repository](https://github.com/Sirhexalot/Update-n8n-Zammad-Roles-by-Excel).\n",
  "readme_html": "<!--[--><div data-v-006f9244=\"\"><p>This n8n workflow allows you to update user roles in Zammad based on data from an Excel file. The workflow automates role assignments, ensuring efficient and consistent updates.</p>\n<h2>Features</h2>\n<ul>\n<li><strong>Excel Integration</strong>: Import user data from an Excel file containing emails and role assignments.</li>\n<li><strong>Dynamic Updates</strong>: Match Zammad users by email and update their roles.</li>\n<li><strong>Error Handling</strong>: Continue workflow execution even if some updates fail.</li>\n<li><strong>Customizable Variables</strong>: Configure Zammad API URL, API key, and Excel file URL.</li>\n</ul>\n<h2>Usage</h2>\n<ol>\n<li><strong>Import the Workflow</strong>: Upload the provided <code>.json</code> file into your n8n instance.</li>\n<li><strong>Set Variables</strong>:\n<ul>\n<li><code>zammad_base_url</code>: Your Zammad instance URL.</li>\n<li><code>excel_source_url</code>: URL of the Excel file containing user data.</li>\n</ul>\n</li>\n<li><strong>Authentication for Zammad</strong></li>\n</ol>\n<ul>\n<li>Create in the Node \"Find Zammad User by email\" and \"Update User Roles\" a Header Auth Authentication</li>\n<li><strong>Name</strong>: Authorization</li>\n<li><strong>Value</strong>: Bearer &lt;put here your zammad api token&gt;</li>\n</ul>\n<ol>\n<li><strong>Run the Workflow</strong>: Execute the workflow to update user roles based on the Excel data.</li>\n</ol>\n<h2>Issues and Suggestions</h2>\n<p>For issues or suggestions, visit the <a href=\"https://github.com/Sirhexalot/Update-n8n-Zammad-Roles-by-Excel\" rel=\"ugc nofollow\" target=\"_blank\">GitHub Repository</a>.</p>\n</div><!--]-->",
  "readme_zh": "该n8n工作流支持通过Excel文件数据批量更新Zammad用户角色，实现自动化权限分配，确保高效一致的权限管理。\n\n## 功能特性\n\n  * **Excel集成**：从包含邮箱和角色信息的Excel文件导入用户数据\n  * **动态更新**：通过邮箱匹配Zammad用户并更新其角色\n  * **容错机制**：即使部分更新失败仍可继续执行流程\n  * **可配置变量**：支持自定义Zammad API地址、密钥及Excel文件路径\n\n## 使用指南\n\n  1. **导入工作流**：将提供的`.json`文件上传至n8n实例\n  2. **配置变量**：\n     * `zammad_base_url`：Zammad系统地址\n     * `excel_source_url`：用户数据Excel文件地址\n  3. **Zammad认证设置**\n\n\n  * 在\"Find Zammad User by email\"和\"Update User Roles\"节点中添加Header Auth认证\n  * **参数名**：Authorization\n  * **参数值**：Bearer <此处填写Zammad API密钥>\n\n\n  1. **执行工作流**：运行流程即可根据Excel数据更新用户角色\n\n## 问题反馈\n\n如有问题或建议，请访问[GitHub项目仓库](https://github.com/Sirhexalot/Update-n8n-Zammad-Roles-by-Excel)。",
  "title_zh": "通过Excel更新Zammad角色",
  "publish_date_zh": "最后更新于5个月前",
  "workflow_json_zh": "{\n  \"id\": \"xzKlhjcc6QEzA98Z\",\n  \"meta\": {\n    \"instanceId\": \"494d0146a0f47676ad70a44a32086b466621f62da855e3eaf0ee51dee1f76753\",\n    \"templateId\": \"2041\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"name\": \"Update Roles by Excel\",\n  \"tags\": [],\n  \"nodes\": [\n    {\n      \"id\": \"580d8a47-32cc-4976-a464-793523ae3d1e\",\n      \"name\": \"When clicking \\\"Execute Workflow\\\"\",\n      \"type\": \"n8n-nodes-base.manualTrigger\",\n      \"position\": [\n        80,\n        140\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"f37ea772-a953-4b5b-8e54-c76e42938544\",\n      \"name\": \"Extract from File\",\n      \"type\": \"n8n-nodes-base.extractFromFile\",\n      \"position\": [\n        760,\n        140\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"operation\": \"xlsx\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"60ab7913-d421-41cd-af04-ccec2ed6838e\",\n      \"name\": \"Merge\",\n      \"type\": \"n8n-nodes-base.merge\",\n      \"position\": [\n        1700,\n        120\n      ],\n      \"parameters\": {\n        \"mode\": \"combine\",\n        \"options\": {},\n        \"fieldsToMatchString\": \"email\"\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"ad6719b4-95dc-419e-94cb-97039014be62\",\n      \"name\": \"Basic Variables\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        320,\n        140\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"68b32087-5e23-4590-8042-0061234ce479\",\n              \"name\": \"zammad_base_url\",\n              \"type\": \"string\",\n              \"value\": \"https://zammad.sirhexalot.de/\"\n            },\n            {\n              \"id\": \"240f4dc5-a070-4623-96e7-1e0750dbeba5\",\n              \"name\": \"excel_source_url\",\n              \"type\": \"string\",\n              \"value\": \"http://zammad.sirhexalot.de/Users.txt\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"8f18e493-5dbe-4447-a422-450c610e9585\",\n      \"name\": \"Zammad Univeral User Object\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1020,\n        140\n      ],\n      \"parameters\": {\n        \"values\": {\n          \"string\": [\n            {\n              \"name\": \"email\",\n              \"value\": \"={{ $json.email }}\"\n            },\n            {\n              \"name\": \"role_ids\",\n              \"value\": \"={{ $json.role_ids }}\\n\"\n            }\n          ]\n        },\n        \"options\": {},\n        \"keepOnlySet\": true\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"5bc0a423-91bc-4b52-af05-2869223bbbff\",\n      \"name\": \"Download Excel\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        540,\n        140\n      ],\n      \"parameters\": {\n        \"url\": \"={{ $json.excel_source_url }}\",\n        \"options\": {\n          \"response\": {\n            \"response\": {\n              \"responseFormat\": \"file\"\n            }\n          }\n        }\n      },\n      \"typeVersion\": 4.1\n    },\n    {\n      \"id\": \"b5962a7b-27d3-45f1-adc4-1abff5d1c990\",\n      \"name\": \"Find Zammad User by email\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1360,\n        -60\n      ],\n      \"parameters\": {\n        \"url\": \"={{ $('Basic Variables').item.json.zammad_base_url }}api/v1/users/search?query=email:{{ $json.email }}\",\n        \"options\": {},\n        \"authentication\": \"genericCredentialType\",\n        \"genericAuthType\": \"httpHeaderAuth\"\n      },\n      \"credentials\": {\n        \"httpHeaderAuth\": {\n          \"id\": \"GJ7tG0KxDpEUv3DS\",\n          \"name\": \"zammad.sirhexalot.de\"\n        }\n      },\n      \"executeOnce\": false,\n      \"typeVersion\": 4.2,\n      \"alwaysOutputData\": false\n    },\n    {\n      \"id\": \"0b8f5007-d28d-4406-a7ec-aa69d2b865d5\",\n      \"name\": \"Update User Roles\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"onError\": \"continueErrorOutput\",\n      \"position\": [\n        2020,\n        120\n      ],\n      \"parameters\": {\n        \"url\": \"={{ $('Basic Variables').item.json.zammad_base_url }}/api/v1/users/{{ $json.id }}\",\n        \"method\": \"PUT\",\n        \"options\": {},\n        \"jsonBody\": \"={\\n  \\\"role_ids\\\": [\\n  {{ $json.role_ids }}\\n  ]\\n} \",\n        \"sendBody\": true,\n        \"specifyBody\": \"json\",\n        \"authentication\": \"genericCredentialType\",\n        \"genericAuthType\": \"httpHeaderAuth\"\n      },\n      \"credentials\": {\n        \"httpHeaderAuth\": {\n          \"id\": \"GJ7tG0KxDpEUv3DS\",\n          \"name\": \"zammad.sirhexalot.de\"\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"7724e271-0beb-4fc3-a9dd-4e55bcf033a1\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        60,\n        -500\n      ],\n      \"parameters\": {\n        \"width\": 577.5890410958907,\n        \"height\": 253.58904109589045,\n        \"content\": \"## Zammad 认证\\n\\n在通过邮箱查找Zammad用户的节点中，创建头部授权认证\\n\\n使用方式：\\n\\n名称：Authorization  \\n值：Bearer - 在此处填入您的zammad api令牌 -\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"active\": false,\n  \"pinData\": {},\n  \"settings\": {\n    \"executionOrder\": \"v1\"\n  },\n  \"versionId\": \"2e34f31f-cb00-43e1-8709-6405ea8521ac\",\n  \"connections\": {\n    \"Merge\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Update User Roles\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Download Excel\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Extract from File\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Basic Variables\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Download Excel\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Extract from File\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Zammad Univeral User Object\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Find Zammad User by email\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Zammad Univeral User Object\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge\",\n            \"type\": \"main\",\n            \"index\": 1\n          },\n          {\n            \"node\": \"Find Zammad User by email\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"When clicking \\\"Execute Workflow\\\"\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Basic Variables\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}