{
  "title": "Smart Sales Support Chatbot with GPT-4o and Google Sheets",
  "url": "https://n8n.io/workflows/3433-smart-sales-support-chatbot-with-gpt-4o-and-google-sheets/",
  "category": "Sales",
  "category_url": "https://n8n.io/workflows/categories/sales/?sort=createdAt:desc",
  "author": "Babish Shrestha",
  "publish_date": "Last update 7 days ago",
  "publish_date_absolute": "2025-04-30",
  "content": "",
  "workflow_json": "{\"id\":\"7Pw91QNT4UGeNmL5\",\"meta\":{\"instanceId\":\"95959af22bc98ea4ce12f3aa06514276ddf020a37e9465025051938d10308902\",\"templateCredsSetupCompleted\":true},\"name\":\"Customer and Sales Support\",\"tags\":[],\"nodes\":[{\"id\":\"99d711a1-2341-493b-ba56-e40e76e07d97\",\"name\":\"When chat message received\",\"type\":\"@n8n/n8n-nodes-langchain.chatTrigger\",\"position\":[-360,-120],\"webhookId\":\"1de1a4dd-cea5-4c95-b489-6004601ff727\",\"parameters\":{\"public\":true,\"options\":{\"responseMode\":\"lastNode\",\"loadPreviousSession\":\"memory\"},\"initialMessages\":\"Hi! I’m Babish from Apple Case. How can I help?”\"},\"typeVersion\":1.1},{\"id\":\"ab809cbb-0456-4a6f-b078-8a6f7bdbd4d0\",\"name\":\"OpenAI Chat Model\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\"position\":[60,260],\"parameters\":{\"model\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"gpt-4.1\",\"cachedResultName\":\"gpt-4.1\"},\"options\":{\"maxTokens\":1024,\"temperature\":0.3}},\"credentials\":{\"openAiApi\":{\"id\":\"zqONgMf7CM0LERga\",\"name\":\"OpenAi DPL 2\"}},\"typeVersion\":1.2},{\"id\":\"e74bc18b-3058-4658-83fd-85f9a45d3537\",\"name\":\"Simple Memory\",\"type\":\"@n8n/n8n-nodes-langchain.memoryBufferWindow\",\"position\":[-220,240],\"parameters\":{},\"typeVersion\":1.3},{\"id\":\"008d806b-e56d-4c37-b64d-2eb6792eefb5\",\"name\":\"Place order\",\"type\":\"n8n-nodes-base.googleSheetsTool\",\"position\":[540,240],\"parameters\":{\"columns\":{\"value\":{\"Address\":\"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Address', ``, 'string') }}\",\"Case ID\":\"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Case_ID', ``, 'string') }}\",\"Quantity\":\"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Quantity', ``, 'string') }}\",\"Case Name\":\"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Case_Name', ``, 'string') }}\",\"Timestamp\":\"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Timestamp', ``, 'string') }}\",\"Phone Model\":\"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Phone_Model', ``, 'string') }}\",\"Phone Number\":\"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Phone_Number', ``, 'string') }}\",\"Customer Name\":\"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Customer_Name', ``, 'string') }}\"},\"schema\":[{\"id\":\"Timestamp\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"Timestamp\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Case ID\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"Case ID\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Case Name\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"Case Name\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Phone Model\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"Phone Model\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Customer Name\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"Customer Name\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Phone Number\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"Phone Number\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Address\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"Address\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Quantity\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"Quantity\",\"defaultMatch\":false,\"canBeUsedToMatch\":true}],\"mappingMode\":\"defineBelow\",\"matchingColumns\":[],\"attemptToConvertTypes\":false,\"convertFieldsToString\":false},\"options\":{},\"operation\":\"append\",\"sheetName\":{\"__rl\":true,\"mode\":\"list\",\"value\":622166849,\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1btXGPudVDrG64coe5mIlw0Nd8r6YzOnNQ3wp7OVUffc/edit#gid=622166849\",\"cachedResultName\":\"Order placed\"},\"documentId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"1btXGPudVDrG64coe5mIlw0Nd8r6YzOnNQ3wp7OVUffc\",\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1btXGPudVDrG64coe5mIlw0Nd8r6YzOnNQ3wp7OVUffc/edit?usp=drivesdk\",\"cachedResultName\":\"Apple Case Stock\"}},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"r16nFPNT77oA4BPq\",\"name\":\"Google Sheets account\"}},\"typeVersion\":4.5},{\"id\":\"9f1d892a-ad76-47ce-815f-1a7cc7a46cf8\",\"name\":\"Update Stock\",\"type\":\"n8n-nodes-base.googleSheetsTool\",\"position\":[660,240],\"parameters\":{\"columns\":{\"value\":{\"Sold\":\"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Sold', ``, 'string') }}\",\"Case ID\":\"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Case_ID__using_to_match_', ``, 'string') }}\",\"Updated ISO\":\"={{ $now.toISO() }}\",\"Quantity Available\":\"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Quantity_Available', ``, 'string') }}\"},\"schema\":[{\"id\":\"Case ID\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"Case ID\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Phone Model\",\"type\":\"string\",\"display\":true,\"removed\":true,\"required\":false,\"displayName\":\"Phone Model\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Case Name\",\"type\":\"string\",\"display\":true,\"removed\":true,\"required\":false,\"displayName\":\"Case Name\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Case Type\",\"type\":\"string\",\"display\":true,\"removed\":true,\"required\":false,\"displayName\":\"Case Type\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Quantity Available\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"Quantity Available\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Initial Inventory,\",\"type\":\"string\",\"display\":true,\"removed\":true,\"required\":false,\"displayName\":\"Initial Inventory,\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Sold\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"Sold\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Updated ISO\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"Updated ISO\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"row_number\",\"type\":\"string\",\"display\":true,\"removed\":true,\"readOnly\":true,\"required\":false,\"displayName\":\"row_number\",\"defaultMatch\":false,\"canBeUsedToMatch\":true}],\"mappingMode\":\"defineBelow\",\"matchingColumns\":[\"Case ID\"],\"attemptToConvertTypes\":false,\"convertFieldsToString\":false},\"options\":{},\"operation\":\"update\",\"sheetName\":{\"__rl\":true,\"mode\":\"list\",\"value\":2019723207,\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1btXGPudVDrG64coe5mIlw0Nd8r6YzOnNQ3wp7OVUffc/edit#gid=2019723207\",\"cachedResultName\":\"Inventory\"},\"documentId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"1btXGPudVDrG64coe5mIlw0Nd8r6YzOnNQ3wp7OVUffc\",\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1btXGPudVDrG64coe5mIlw0Nd8r6YzOnNQ3wp7OVUffc/edit?usp=drivesdk\",\"cachedResultName\":\"Apple Case Stock\"}},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"r16nFPNT77oA4BPq\",\"name\":\"Google Sheets account\"}},\"typeVersion\":4.5},{\"id\":\"7f0e6e31-6bdb-4901-9c07-4fb6fa4734f0\",\"name\":\"Support Agent\",\"type\":\"@n8n/n8n-nodes-langchain.agent\",\"position\":[120,-120],\"parameters\":{\"options\":{\"systemMessage\":\"=SYSTEM\\nYou are the customer-support agent for “My Apple Case”.\\n\\nTOOLS\\n• GetStock      { \\\"phone_model\\\": string }\\n  • Returns: [{ \\\"case_id\\\": int, \\\"case_name\\\": string,\\n                \\\"quantity_available\\\": int, \\\"sold\\\": int,\\n                \\\"image_url\\\": string, ... }]\\n• PlaceOrder    { \\\"case_id\\\": int,\\n                  \\\"case_name\\\": string,\\n                  \\\"phone_model\\\": string,\\n                  \\\"customer_name\\\": string,\\n                  \\\"phone_number\\\": string,\\n                  \\\"address\\\": string,\\n                  \\\"quantity\\\": int }\\n• UpdateStock   { \\\"case_id\\\": int,\\n                  \\\"quantity_sold\\\": int,\\n                  \\\"quantity_available\\\": int,\\n                  \\\"sold\\\": int }\\n•  The \\\"case_id\\\" you send to PlaceOrder or UpdateStock must be the one that\\n   appears **in the same row as the chosen case_name** from the latest\\n   GetStock response. Do not invent or modify it.\\nRULES\\n1. Begin every user-visible reply with:  **Welcome to My Apple Case.**\\n2. Speak English or Roman-Nepali, matching the customer.\\n3. ONE tool call per turn. \\n4. If GetStock returns an **image_url**, embed it after the text line using\\n   Markdown:  \\n   `![<case_name>](<image_url>)`\\n5. Legal case_ids set\\n   • The only valid case_id values are the ones you just received from\\n     GetStock in this conversation turn.\\n6. Guard clause\\n   • If you do not have a valid case_id for the customer’s chosen case,\\n     ask follow-up questions or run GetStock again.  DO NOT guess.\\n7.Picking the correct case_id\\n   a. After GetStock returns, keep its rows in memory.\\n   b. When the customer names a case_name you just showed, locate the row\\n      whose case_name matches **exactly** (case-insensitive) and copy that\\n      row’s case_id.\\n   c. If more than one row shares the same case_name, ask which “Option #”\\n      or show a numbered list so they can pick.  Never guess.\\n\\nWORKFLOW\\na. If you don’t yet know stock data, call **GetStock** with the phone model.  \\nb. From GetStock output read:\\n      qa = quantity_available\\n      sold = sold\\n      img  = image_url  \\n  • Show the case_id, case_name, qa and (if img exists) the image. \\nc. If qa < requested quantity → apologize, no PlaceOrder. \\nd. Determine the correct case_id:\\n     • EXACT match: one row → use that row’s case_id.\\n     • Multiple matches: show a numbered list and ask the customer to\\n       choose (e.g. “Type 1 or 2”).  Run no tools until they choose.\\n   Then call PlaceOrder using that exact case_id.\\ne. Else collect missing customer fields → call **PlaceOrder**.  \\nf. After PlaceOrder succeeds, compute:\\n      qa_new   = qa   - quantity\\n      sold_new = sold + quantity\\n   then call **UpdateStock** with:\\n      { \\\"case_id\\\": ..., \\\"quantity_sold\\\": quantity,\\n        \\\"quantity_available\\\": qa_new, \\\"sold\\\": sold_new }\\ng. After UpdateStock returns, thank the customer and show qa_new.\\n\\nEXAMPLES\\n### Check stock with image\\nUser: iPhone 12 ko cover cha?  \\nAssistant → tool:  \\n{ \\\"tool\\\": \\\"GetStock\\\", \\\"args\\\": { \\\"phone_model\\\": \\\"iPhone 12\\\" } }\\n\\n(GetStock output example)  \\n[\\n  {\\n    \\\"case_id\\\": 312,\\n    \\\"case_name\\\": \\\"Clear MagSafe Case\\\",\\n    \\\"quantity_available\\\": 25,\\n    \\\"sold\\\": 75,\\n    \\\"image_url\\\": \\\"https://example.com/clear-case.png\\\"\\n  }\\n]\\n\\n### Two rows same name\\n(GetStock output)\\n1. case_id 101  \\\"Leather Flip\\\"  qty 3\\n2. case_id 202  \\\"Leather Flip\\\"  qty 10\\n\\nUser: I want the Leather Flip case.\\nAssistant: Welcome to My Apple Case. I have two “Leather Flip” options:\\n(1) case_id 101 – 3 in stock\\n(2) case_id 202 – 10 in stock\\nWhich one would you like? Please reply 1 or 2.\\n\\nMy Apple Case ma swagatam. **Clear MagSafe Case** – 25 stock cha.  \\n![Clear MagSafe Case](https://example.com/clear-case.png)\\n\",\"returnIntermediateSteps\":true}},\"retryOnFail\":true,\"typeVersion\":1.8},{\"id\":\"03153a59-4971-49db-86c2-5fd245b36d28\",\"name\":\"GetStock\",\"type\":\"n8n-nodes-base.googleSheetsTool\",\"position\":[400,240],\"parameters\":{\"options\":{},\"filtersUI\":{\"values\":[{\"lookupValue\":\"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Value', ``, 'string') }}\",\"lookupColumn\":\"Phone Model\"}]},\"sheetName\":{\"__rl\":true,\"mode\":\"list\",\"value\":2019723207,\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1btXGPudVDrG64coe5mIlw0Nd8r6YzOnNQ3wp7OVUffc/edit#gid=2019723207\",\"cachedResultName\":\"Inventory\"},\"documentId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"1btXGPudVDrG64coe5mIlw0Nd8r6YzOnNQ3wp7OVUffc\",\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1btXGPudVDrG64coe5mIlw0Nd8r6YzOnNQ3wp7OVUffc/edit?usp=drivesdk\",\"cachedResultName\":\"Apple Case Stock\"},\"combineFilters\":\"OR\"},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"r16nFPNT77oA4BPq\",\"name\":\"Google Sheets account\"}},\"typeVersion\":4.5}],\"active\":false,\"pinData\":{},\"settings\":{\"executionOrder\":\"v1\"},\"versionId\":\"6f49665c-583f-456e-9ea9-bb95b172cac1\",\"connections\":{\"GetStock\":{\"ai_tool\":[[{\"node\":\"Support Agent\",\"type\":\"ai_tool\",\"index\":0}]]},\"Place order\":{\"ai_tool\":[[{\"node\":\"Support Agent\",\"type\":\"ai_tool\",\"index\":0}]]},\"Update Stock\":{\"ai_tool\":[[{\"node\":\"Support Agent\",\"type\":\"ai_tool\",\"index\":0}]]},\"Simple Memory\":{\"ai_memory\":[[{\"node\":\"Support Agent\",\"type\":\"ai_memory\",\"index\":0},{\"node\":\"When chat message received\",\"type\":\"ai_memory\",\"index\":0}]]},\"Support Agent\":{\"main\":[[]]},\"OpenAI Chat Model\":{\"ai_languageModel\":[[{\"node\":\"Support Agent\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"When chat message received\":{\"main\":[[{\"node\":\"Support Agent\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "## Who is this tempate for?\n\nThis workflow powers a **simple yet effective customer and sales support chatbot** for your webshop. It's perfect for solopreneurs who want to **automate customer interactions without relying on expensive or complex support tools**.\n\n## How it works?\n\nThe chatbot listens to user requests—such as checking product availability—and automatically handles the following\n\n  * Fetches product information from a Google Sheet\n  * Answers customer queries\n  * Places an order\n  * Updates the stock after a successful purchase\n\n\n\n_Everything runs through a single Google Sheet used for both stock tracking and order management._\n\n## **Setup Instructions**\n\nBefore you begin, connect your Google Sheets credentials by following this guide: This will be used to connect all the tools to Google Sheets  \n👉 [Setup Google sheets credentials](https://docs.n8n.io/integrations/builtin/credentials/google/oauth-generic/#finish-your-n8n-credential)\n\n  * ### Get Stock\n\n    * Open \"Get Stock\" tool node and select the Google sheet credentials you created.\n    * Choose the correct google sheet document and sheet name and you are done.\n  * ### Place order\n\n    * Go to your \"Place Order\" tool node and select the Google sheet credentials you have created.\n    * Choose the correct google sheet document and sheet name.\n  * ### Update Stock\n\n    *       * Open your \"Update Stock\" tool node and select the Google sheet credentials you have created.\n    * Choose the correct google sheet document and sheet name.\n    * In \"Mapping Column Mode\" section select map each column manually.\n    * In \"Column to match on\" select the column with a unique identifier (e.g., Product ID) to match stock items.\n    * In values to update section, add only the column(s) that need to be updated—usually the stock count.\n  * ### AI Agent node\n\n    * Adjust the prompt according to your use case and customize what you need.\n\n\n\n## Google Sheet Template\n\n**Stock sheet**\n\nCase ID | Phone Model | Case Name | Case Type | Image URL | Quantity Avaialble | Initital Inventory | Sold  \n---|---|---|---|---|---|---|---  \n1023 | Iphone 14 pro | Black Leather | Magsafe | <https://example.com/url> | 90 | 100 | 10  \n  \n**Order sheet**\n\nCase ID | Phone Model | Case Name | Name | Phone Number | Address  \n---|---|---|---|---|---  \n1023 | Black Leather | Iphone 14 pro | Fernando Torres | 9998898888 | Paris, France\n",
  "readme_html": "<!--[--><div data-v-50766329=\"\"><h2>Who is this tempate for?</h2>\n<p>This workflow powers a <strong>simple yet effective customer and sales support chatbot</strong> for your webshop. It's perfect for solopreneurs who want to <strong>automate customer interactions without relying on expensive or complex support tools</strong>.</p>\n<h2>How it works?</h2>\n<p>The chatbot listens to user requests—such as checking product availability—and automatically handles the following</p>\n<ul>\n<li>Fetches product information from a Google Sheet</li>\n<li>Answers customer queries</li>\n<li>Places an order</li>\n<li>Updates the stock after a successful purchase</li>\n</ul>\n<p><em>Everything runs through a single Google Sheet used for both stock tracking and order management.</em></p>\n<h2><strong>Setup Instructions</strong></h2>\n<p>Before you begin, connect your Google Sheets credentials by following this guide: This will be used to connect all the tools to Google Sheets<br>\n👉 <a href=\"https://docs.n8n.io/integrations/builtin/credentials/google/oauth-generic/#finish-your-n8n-credential\" rel=\"ugc nofollow\" target=\"_blank\">Setup Google sheets credentials</a></p>\n<ul>\n<li>\n<h3>Get Stock</h3>\n<ul>\n<li>Open \"Get Stock\" tool node and select the Google sheet credentials you created.</li>\n<li>Choose the correct google sheet document and sheet name and you are done.</li>\n</ul>\n</li>\n<li>\n<h3>Place order</h3>\n<ul>\n<li>Go to your \"Place Order\" tool node and select the Google sheet credentials you have created.</li>\n<li>Choose the correct google sheet document and sheet name.</li>\n</ul>\n</li>\n<li>\n<h3>Update Stock</h3>\n<ul>\n<li>\n<ul>\n<li>Open your \"Update Stock\" tool node and select the Google sheet credentials you have created.</li>\n</ul>\n</li>\n<li>Choose the correct google sheet document and sheet name.</li>\n<li>In \"Mapping Column Mode\" section select map each column manually.</li>\n<li>In \"Column to match on\" select the column with a unique identifier (e.g., Product ID) to match stock items.</li>\n<li>In values to update section, add only the column(s) that need to be updated—usually the stock count.</li>\n</ul>\n</li>\n<li>\n<h3>AI Agent node</h3>\n<ul>\n<li>Adjust the prompt according to your use case and customize what you need.</li>\n</ul>\n</li>\n</ul>\n<h2>Google Sheet Template</h2>\n<p><strong>Stock sheet</strong></p>\n<table>\n<thead>\n<tr>\n<th>Case ID</th>\n<th>Phone Model</th>\n<th>Case Name</th>\n<th>Case Type</th>\n<th>Image URL</th>\n<th>Quantity Avaialble</th>\n<th>Initital Inventory</th>\n<th>Sold</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1023</td>\n<td>Iphone 14 pro</td>\n<td>Black Leather</td>\n<td>Magsafe</td>\n<td><a href=\"https://example.com/url\" rel=\"ugc nofollow\" target=\"_blank\">https://example.com/url</a></td>\n<td>90</td>\n<td>100</td>\n<td>10</td>\n</tr>\n</tbody>\n</table>\n<p><strong>Order sheet</strong></p>\n<table>\n<thead>\n<tr>\n<th>Case ID</th>\n<th>Phone Model</th>\n<th>Case Name</th>\n<th>Name</th>\n<th>Phone Number</th>\n<th>Address</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1023</td>\n<td>Black Leather</td>\n<td>Iphone 14 pro</td>\n<td>Fernando Torres</td>\n<td>9998898888</td>\n<td>Paris, France</td>\n</tr>\n</tbody>\n</table>\n</div><!--]-->",
  "readme_zh": "## 适用对象\n\n本工作流专为网店打造**简洁高效的客户与销售支持聊天机器人**，特别适合**希望自动化客户互动**的个体创业者，无需依赖昂贵或复杂的客服工具。\n\n## 运作原理\n\n聊天机器人实时响应用户请求（例如查询商品库存），自动完成以下操作：\n* 从Google表格获取商品信息\n* 解答客户咨询\n* 接收订单\n* 在成交后更新库存\n\n_所有流程均通过单一Google表格实现库存追踪与订单管理_\n\n## **配置指南**\n\n开始前请按以下指引设置Google表格凭证（用于连接所有工具）  \n👉 [设置Google表格凭证](https://docs.n8n.io/integrations/builtin/credentials/google/oauth-generic/#finish-your-n8n-credential)\n\n* ### 库存查询\n  * 打开\"Get Stock\"工具节点，选择已创建的Google表格凭证\n  * 指定正确的表格文档及工作表名称即可完成配置\n\n* ### 下单处理\n  * 进入\"Place Order\"工具节点，选择已创建的Google表格凭证\n  * 指定正确的表格文档及工作表名称\n\n* ### 库存更新\n  * 打开\"Update Stock\"工具节点，选择已创建的Google表格凭证\n  * 指定正确的表格文档及工作表名称\n  * 在\"Mapping Column Mode\"部分选择手动映射列\n  * 在\"Column to match on\"中选择唯一标识列（如商品ID）\n  * 在更新值区域仅添加需更新的列（通常为库存数量）\n\n* ### AI代理节点\n  * 根据实际需求调整提示词模板\n\n## Google表格模板\n\n**库存表**\n\n商品ID | 手机型号 | 保护壳名称 | 壳类型 | 图片链接 | 当前库存 | 初始库存 | 已售  \n---|---|---|---|---|---|---|---  \n1023 | iPhone 14 pro | 黑色皮革款 | MagSafe磁吸 | <https://example.com/url> | 90 | 100 | 10  \n\n**订单表**\n\n商品ID | 手机型号 | 保护壳名称 | 客户姓名 | 联系电话 | 收货地址  \n---|---|---|---|---|---  \n1023 | iPhone 14 pro | 黑色皮革款 | 费尔南多·托雷斯 | 9998898888 | 法国巴黎",
  "title_zh": "智能销售支持聊天机器人（基于GPT-4o与谷歌表格）",
  "publish_date_zh": "上次更新于7天前",
  "workflow_json_zh": "{\n  \"id\": \"7Pw91QNT4UGeNmL5\",\n  \"meta\": {\n    \"instanceId\": \"95959af22bc98ea4ce12f3aa06514276ddf020a37e9465025051938d10308902\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"name\": \"Customer and Sales Support\",\n  \"tags\": [],\n  \"nodes\": [\n    {\n      \"id\": \"99d711a1-2341-493b-ba56-e40e76e07d97\",\n      \"name\": \"When chat message received\",\n      \"type\": \"@n8n/n8n-nodes-langchain.chatTrigger\",\n      \"position\": [\n        -360,\n        -120\n      ],\n      \"webhookId\": \"1de1a4dd-cea5-4c95-b489-6004601ff727\",\n      \"parameters\": {\n        \"public\": true,\n        \"options\": {\n          \"responseMode\": \"lastNode\",\n          \"loadPreviousSession\": \"memory\"\n        },\n        \"initialMessages\": \"Hi! I’m Babish from Apple Case. How can I help?”\"\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"ab809cbb-0456-4a6f-b078-8a6f7bdbd4d0\",\n      \"name\": \"OpenAI Chat Model\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\n      \"position\": [\n        60,\n        260\n      ],\n      \"parameters\": {\n        \"model\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"gpt-4.1\",\n          \"cachedResultName\": \"gpt-4.1\"\n        },\n        \"options\": {\n          \"maxTokens\": 1024,\n          \"temperature\": 0.3\n        }\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"zqONgMf7CM0LERga\",\n          \"name\": \"OpenAi DPL 2\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"e74bc18b-3058-4658-83fd-85f9a45d3537\",\n      \"name\": \"Simple Memory\",\n      \"type\": \"@n8n/n8n-nodes-langchain.memoryBufferWindow\",\n      \"position\": [\n        -220,\n        240\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1.3\n    },\n    {\n      \"id\": \"008d806b-e56d-4c37-b64d-2eb6792eefb5\",\n      \"name\": \"Place order\",\n      \"type\": \"n8n-nodes-base.googleSheetsTool\",\n      \"position\": [\n        540,\n        240\n      ],\n      \"parameters\": {\n        \"columns\": {\n          \"value\": {\n            \"Address\": \"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Address', ``, 'string') }}\",\n            \"Case ID\": \"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Case_ID', ``, 'string') }}\",\n            \"Quantity\": \"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Quantity', ``, 'string') }}\",\n            \"Case Name\": \"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Case_Name', ``, 'string') }}\",\n            \"Timestamp\": \"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Timestamp', ``, 'string') }}\",\n            \"Phone Model\": \"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Phone_Model', ``, 'string') }}\",\n            \"Phone Number\": \"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Phone_Number', ``, 'string') }}\",\n            \"Customer Name\": \"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Customer_Name', ``, 'string') }}\"\n          },\n          \"schema\": [\n            {\n              \"id\": \"Timestamp\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"Timestamp\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Case ID\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"Case ID\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Case Name\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"Case Name\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Phone Model\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"Phone Model\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Customer Name\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"Customer Name\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Phone Number\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"Phone Number\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Address\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"Address\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Quantity\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"Quantity\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            }\n          ],\n          \"mappingMode\": \"defineBelow\",\n          \"matchingColumns\": [],\n          \"attemptToConvertTypes\": false,\n          \"convertFieldsToString\": false\n        },\n        \"options\": {},\n        \"operation\": \"append\",\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": 622166849,\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1btXGPudVDrG64coe5mIlw0Nd8r6YzOnNQ3wp7OVUffc/edit#gid=622166849\",\n          \"cachedResultName\": \"Order placed\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"1btXGPudVDrG64coe5mIlw0Nd8r6YzOnNQ3wp7OVUffc\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1btXGPudVDrG64coe5mIlw0Nd8r6YzOnNQ3wp7OVUffc/edit?usp=drivesdk\",\n          \"cachedResultName\": \"Apple Case Stock\"\n        }\n      },\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"r16nFPNT77oA4BPq\",\n          \"name\": \"Google Sheets account\"\n        }\n      },\n      \"typeVersion\": 4.5\n    },\n    {\n      \"id\": \"9f1d892a-ad76-47ce-815f-1a7cc7a46cf8\",\n      \"name\": \"Update Stock\",\n      \"type\": \"n8n-nodes-base.googleSheetsTool\",\n      \"position\": [\n        660,\n        240\n      ],\n      \"parameters\": {\n        \"columns\": {\n          \"value\": {\n            \"Sold\": \"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Sold', ``, 'string') }}\",\n            \"Case ID\": \"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Case_ID__using_to_match_', ``, 'string') }}\",\n            \"Updated ISO\": \"={{ $now.toISO() }}\",\n            \"Quantity Available\": \"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Quantity_Available', ``, 'string') }}\"\n          },\n          \"schema\": [\n            {\n              \"id\": \"Case ID\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"Case ID\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Phone Model\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": true,\n              \"required\": false,\n              \"displayName\": \"Phone Model\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Case Name\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": true,\n              \"required\": false,\n              \"displayName\": \"Case Name\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Case Type\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": true,\n              \"required\": false,\n              \"displayName\": \"Case Type\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Quantity Available\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"Quantity Available\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Initial Inventory,\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": true,\n              \"required\": false,\n              \"displayName\": \"Initial Inventory,\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Sold\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"Sold\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Updated ISO\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"Updated ISO\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"row_number\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": true,\n              \"readOnly\": true,\n              \"required\": false,\n              \"displayName\": \"row_number\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            }\n          ],\n          \"mappingMode\": \"defineBelow\",\n          \"matchingColumns\": [\n            \"Case ID\"\n          ],\n          \"attemptToConvertTypes\": false,\n          \"convertFieldsToString\": false\n        },\n        \"options\": {},\n        \"operation\": \"update\",\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": 2019723207,\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1btXGPudVDrG64coe5mIlw0Nd8r6YzOnNQ3wp7OVUffc/edit#gid=2019723207\",\n          \"cachedResultName\": \"Inventory\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"1btXGPudVDrG64coe5mIlw0Nd8r6YzOnNQ3wp7OVUffc\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1btXGPudVDrG64coe5mIlw0Nd8r6YzOnNQ3wp7OVUffc/edit?usp=drivesdk\",\n          \"cachedResultName\": \"Apple Case Stock\"\n        }\n      },\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"r16nFPNT77oA4BPq\",\n          \"name\": \"Google Sheets account\"\n        }\n      },\n      \"typeVersion\": 4.5\n    },\n    {\n      \"id\": \"7f0e6e31-6bdb-4901-9c07-4fb6fa4734f0\",\n      \"name\": \"Support Agent\",\n      \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n      \"position\": [\n        120,\n        -120\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"systemMessage\": \"=SYSTEM\\nYou are the customer-support agent for “My Apple Case”.\\n\\nTOOLS\\n• GetStock      { \\\"phone_model\\\": string }\\n  • Returns: [{ \\\"case_id\\\": int, \\\"case_name\\\": string,\\n                \\\"quantity_available\\\": int, \\\"sold\\\": int,\\n                \\\"image_url\\\": string, ... }]\\n• PlaceOrder    { \\\"case_id\\\": int,\\n                  \\\"case_name\\\": string,\\n                  \\\"phone_model\\\": string,\\n                  \\\"customer_name\\\": string,\\n                  \\\"phone_number\\\": string,\\n                  \\\"address\\\": string,\\n                  \\\"quantity\\\": int }\\n• UpdateStock   { \\\"case_id\\\": int,\\n                  \\\"quantity_sold\\\": int,\\n                  \\\"quantity_available\\\": int,\\n                  \\\"sold\\\": int }\\n•  The \\\"case_id\\\" you send to PlaceOrder or UpdateStock must be the one that\\n   appears **in the same row as the chosen case_name** from the latest\\n   GetStock response. Do not invent or modify it.\\nRULES\\n1. Begin every user-visible reply with:  **Welcome to My Apple Case.**\\n2. Speak English or Roman-Nepali, matching the customer.\\n3. ONE tool call per turn. \\n4. If GetStock returns an **image_url**, embed it after the text line using\\n   Markdown:  \\n   `![<case_name>](<image_url>)`\\n5. Legal case_ids set\\n   • The only valid case_id values are the ones you just received from\\n     GetStock in this conversation turn.\\n6. Guard clause\\n   • If you do not have a valid case_id for the customer’s chosen case,\\n     ask follow-up questions or run GetStock again.  DO NOT guess.\\n7.Picking the correct case_id\\n   a. After GetStock returns, keep its rows in memory.\\n   b. When the customer names a case_name you just showed, locate the row\\n      whose case_name matches **exactly** (case-insensitive) and copy that\\n      row’s case_id.\\n   c. If more than one row shares the same case_name, ask which “Option #”\\n      or show a numbered list so they can pick.  Never guess.\\n\\nWORKFLOW\\na. If you don’t yet know stock data, call **GetStock** with the phone model.  \\nb. From GetStock output read:\\n      qa = quantity_available\\n      sold = sold\\n      img  = image_url  \\n  • Show the case_id, case_name, qa and (if img exists) the image. \\nc. If qa < requested quantity → apologize, no PlaceOrder. \\nd. Determine the correct case_id:\\n     • EXACT match: one row → use that row’s case_id.\\n     • Multiple matches: show a numbered list and ask the customer to\\n       choose (e.g. “Type 1 or 2”).  Run no tools until they choose.\\n   Then call PlaceOrder using that exact case_id.\\ne. Else collect missing customer fields → call **PlaceOrder**.  \\nf. After PlaceOrder succeeds, compute:\\n      qa_new   = qa   - quantity\\n      sold_new = sold + quantity\\n   then call **UpdateStock** with:\\n      { \\\"case_id\\\": ..., \\\"quantity_sold\\\": quantity,\\n        \\\"quantity_available\\\": qa_new, \\\"sold\\\": sold_new }\\ng. After UpdateStock returns, thank the customer and show qa_new.\\n\\nEXAMPLES\\n### Check stock with image\\nUser: iPhone 12 ko cover cha?  \\nAssistant → tool:  \\n{ \\\"tool\\\": \\\"GetStock\\\", \\\"args\\\": { \\\"phone_model\\\": \\\"iPhone 12\\\" } }\\n\\n(GetStock output example)  \\n[\\n  {\\n    \\\"case_id\\\": 312,\\n    \\\"case_name\\\": \\\"Clear MagSafe Case\\\",\\n    \\\"quantity_available\\\": 25,\\n    \\\"sold\\\": 75,\\n    \\\"image_url\\\": \\\"https://example.com/clear-case.png\\\"\\n  }\\n]\\n\\n### Two rows same name\\n(GetStock output)\\n1. case_id 101  \\\"Leather Flip\\\"  qty 3\\n2. case_id 202  \\\"Leather Flip\\\"  qty 10\\n\\nUser: I want the Leather Flip case.\\nAssistant: Welcome to My Apple Case. I have two “Leather Flip” options:\\n(1) case_id 101 – 3 in stock\\n(2) case_id 202 – 10 in stock\\nWhich one would you like? Please reply 1 or 2.\\n\\nMy Apple Case ma swagatam. **Clear MagSafe Case** – 25 stock cha.  \\n![Clear MagSafe Case](https://example.com/clear-case.png)\\n\",\n          \"returnIntermediateSteps\": true\n        }\n      },\n      \"retryOnFail\": true,\n      \"typeVersion\": 1.8\n    },\n    {\n      \"id\": \"03153a59-4971-49db-86c2-5fd245b36d28\",\n      \"name\": \"GetStock\",\n      \"type\": \"n8n-nodes-base.googleSheetsTool\",\n      \"position\": [\n        400,\n        240\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"filtersUI\": {\n          \"values\": [\n            {\n              \"lookupValue\": \"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Value', ``, 'string') }}\",\n              \"lookupColumn\": \"Phone Model\"\n            }\n          ]\n        },\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": 2019723207,\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1btXGPudVDrG64coe5mIlw0Nd8r6YzOnNQ3wp7OVUffc/edit#gid=2019723207\",\n          \"cachedResultName\": \"Inventory\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"1btXGPudVDrG64coe5mIlw0Nd8r6YzOnNQ3wp7OVUffc\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1btXGPudVDrG64coe5mIlw0Nd8r6YzOnNQ3wp7OVUffc/edit?usp=drivesdk\",\n          \"cachedResultName\": \"Apple Case Stock\"\n        },\n        \"combineFilters\": \"OR\"\n      },\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"r16nFPNT77oA4BPq\",\n          \"name\": \"Google Sheets account\"\n        }\n      },\n      \"typeVersion\": 4.5\n    }\n  ],\n  \"active\": false,\n  \"pinData\": {},\n  \"settings\": {\n    \"executionOrder\": \"v1\"\n  },\n  \"versionId\": \"6f49665c-583f-456e-9ea9-bb95b172cac1\",\n  \"connections\": {\n    \"GetStock\": {\n      \"ai_tool\": [\n        [\n          {\n            \"node\": \"Support Agent\",\n            \"type\": \"ai_tool\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Place order\": {\n      \"ai_tool\": [\n        [\n          {\n            \"node\": \"Support Agent\",\n            \"type\": \"ai_tool\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Update Stock\": {\n      \"ai_tool\": [\n        [\n          {\n            \"node\": \"Support Agent\",\n            \"type\": \"ai_tool\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Simple Memory\": {\n      \"ai_memory\": [\n        [\n          {\n            \"node\": \"Support Agent\",\n            \"type\": \"ai_memory\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"When chat message received\",\n            \"type\": \"ai_memory\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Support Agent\": {\n      \"main\": [\n        []\n      ]\n    },\n    \"OpenAI Chat Model\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"Support Agent\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"When chat message received\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Support Agent\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}