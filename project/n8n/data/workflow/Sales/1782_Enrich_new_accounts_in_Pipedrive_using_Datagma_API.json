{
  "title": "Enrich new accounts in Pipedrive using Datagma API",
  "url": "https://n8n.io/workflows/1782-enrich-new-accounts-in-pipedrive-using-datagma-api/",
  "category": "Sales",
  "category_url": "https://n8n.io/workflows/categories/sales/?sort=createdAt:desc",
  "author": "Lucas Perret",
  "publish_date": "Last update 10 months ago",
  "publish_date_absolute": "",
  "content": "",
  "workflow_json": "{\"nodes\":[{\"name\":\"list people\",\"type\":\"n8n-nodes-base.itemLists\",\"position\":[820,240],\"parameters\":{\"options\":{},\"fieldToSplitOut\":\"company.employees\"},\"typeVersion\":1},{\"name\":\"Pipedrive - Enrich Organization\",\"type\":\"n8n-nodes-base.pipedrive\",\"position\":[1060,740],\"parameters\":{\"resource\":\"organization\",\"operation\":\"update\",\"updateFields\":{\"customProperties\":{\"property\":[{\"name\":\"Total Funding Amount\",\"value\":\"={{$json[\\\"company\\\"][\\\"full\\\"][\\\"cards\\\"][\\\"fundingRoundsSummary\\\"][\\\"fundingTotal\\\"][\\\"valueUsdRoundup\\\"]}}\"},{\"name\":\"Website Traffic\",\"value\":\"={{$json[\\\"company\\\"][\\\"full\\\"][\\\"cards\\\"][\\\"trafficRankHeadline\\\"][\\\"visitsLastestMonthPrettier\\\"]}}\"},{\"name\":\"Industry\",\"value\":\"={{$json[\\\"company\\\"][\\\"premium\\\"][\\\"industries\\\"]}}\"},{\"name\":\"Linkedin URL\",\"value\":\"={{$json[\\\"company\\\"][\\\"full\\\"][\\\"cards\\\"][\\\"overviewFields2\\\"][\\\"linkedin\\\"][\\\"value\\\"]}}\"},{\"name\":\"=Website\",\"value\":\"={{$json[\\\"company\\\"][\\\"premium\\\"][\\\"website\\\"]}}\"},{\"name\":\"Number of Employees\",\"value\":\"={{$json[\\\"company\\\"][\\\"premium\\\"][\\\"companySize\\\"]}}\"},{\"name\":\"Address\",\"value\":\"={{$json[\\\"company\\\"][\\\"premium\\\"][\\\"headquaterAddr\\\"]}}\"}]}},\"organizationId\":\"={{$node[\\\"Pipedrive Trigger - New Company Created\\\"].json[\\\"meta\\\"][\\\"id\\\"]}}\",\"encodeProperties\":true},\"credentials\":{\"pipedriveApi\":{\"id\":\"27\",\"name\":\"Free TRial Lucas\"}},\"typeVersion\":1},{\"name\":\"Pipedrive - Add Person\",\"type\":\"n8n-nodes-base.pipedrive\",\"position\":[1840,660],\"parameters\":{\"name\":\"={{$json[\\\"name\\\"]}}\",\"resource\":\"person\",\"additionalFields\":{\"email\":[\"={{$json[\\\"emailDatagma\\\"]}}\"],\"org_id\":\"={{$items(\\\"Pipedrive Trigger - New Company Created\\\")[0].json[\\\"meta\\\"][\\\"id\\\"]}}\",\"customProperties\":{\"property\":[{\"name\":\"aa8c534fc3ea812ffe8b155290873293b9950c3a\",\"value\":\"={{$json[\\\"jobTitle\\\"]}}\"},{\"name\":\"04215f535458ffd9092b4a337f217201087dae2b\",\"value\":\"={{$json[\\\"linkedInUrl\\\"]}}\"}]}}},\"credentials\":{\"pipedriveApi\":{\"id\":\"27\",\"name\":\"Free TRial Lucas\"}},\"typeVersion\":1},{\"name\":\"Datagma - Enrich Company\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[580,520],\"parameters\":{\"url\":\"https://gateway.datagma.net/api/ingress/v2/full\",\"options\":{\"batchSize\":10,\"fullResponse\":false,\"batchInterval\":2000},\"authentication\":\"queryAuth\",\"queryParametersUi\":{\"parameter\":[{\"name\":\"data\",\"value\":\"={{$json[\\\"current\\\"][\\\"name\\\"]}}\"},{\"name\":\"companyPremium\",\"value\":\"true\"},{\"name\":\"companyFull\",\"value\":\"true\"},{\"name\":\"companyEmployees\",\"value\":\"true\"},{\"name\":\"employeeTitle\",\"value\":\"(head of OR director) AND (sales OR business)\"},{\"name\":\"findEmailV2\",\"value\":\"true\"}]}},\"credentials\":{\"httpQueryAuth\":{\"id\":\"18\",\"name\":\"Datagma Auth\"}},\"typeVersion\":1,\"continueOnFail\":true},{\"name\":\"Merge\",\"type\":\"n8n-nodes-base.merge\",\"position\":[1640,660],\"parameters\":{\"mode\":\"mergeByKey\",\"propertyName1\":\"linkedInUrl\",\"propertyName2\":\"linkedInUrl\"},\"typeVersion\":1},{\"name\":\"If lead is Ideal Buyer\",\"type\":\"n8n-nodes-base.if\",\"position\":[1100,240],\"parameters\":{\"conditions\":{\"number\":[{\"value1\":\"={{$json[\\\"employeeCompanyScore\\\"]}}\",\"value2\":0.1,\"operation\":\"larger\"}],\"string\":[{\"value1\":\"={{$json[\\\"jobTitle\\\"].toLowerCase()\\t}}\",\"value2\":\"sales\",\"operation\":\"contains\"}]}},\"typeVersion\":1},{\"name\":\"Datagma - Find Emails\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[1320,220],\"parameters\":{\"url\":\"https://gateway.datagma.net/api/ingress/v4/findEmail?findEmailV2Step=3&findEmailV2Country=General\\n\",\"options\":{\"batchSize\":10,\"fullResponse\":false,\"batchInterval\":2000},\"authentication\":\"queryAuth\",\"queryParametersUi\":{\"parameter\":[{\"name\":\"fullName\",\"value\":\"={{$json[\\\"name\\\"]}}\"},{\"name\":\"company\",\"value\":\"={{$json[\\\"company\\\"]}}\"}]}},\"credentials\":{\"httpQueryAuth\":{\"id\":\"18\",\"name\":\"Datagma Auth\"}},\"typeVersion\":1,\"continueOnFail\":true},{\"name\":\"Prepare Data Before Merge\",\"type\":\"n8n-nodes-base.set\",\"position\":[1520,220],\"parameters\":{\"values\":{\"string\":[{\"name\":\"linkedInUrl\",\"value\":\"={{$node[\\\"If lead is Ideal Buyer\\\"].json[\\\"linkedInUrl\\\"]}}\"},{\"name\":\"emailDatagma\",\"value\":\"={{$json[\\\"email\\\"]}}\"}]},\"options\":{}},\"typeVersion\":1},{\"name\":\"Pipedrive Trigger - New Company Created\",\"type\":\"n8n-nodes-base.pipedriveTrigger\",\"position\":[320,520],\"webhookId\":\"90b68fad-3216-4dde-9afd-77f98cda0711\",\"parameters\":{\"action\":\"added\",\"object\":\"organization\"},\"credentials\":{\"pipedriveApi\":{\"id\":\"27\",\"name\":\"Free TRial Lucas\"}},\"typeVersion\":1},{\"name\":\"Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[500,340],\"parameters\":{\"height\":400,\"content\":\"### Find a different ideal buyer:\\nIn \\\"Datagma - Enrich Company\\\" node - change \\\"employeeTitle\\\" value with the keywords of your ideal buyer (-> Head of Marketing)\"},\"typeVersion\":1},{\"name\":\"Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1020,60],\"parameters\":{\"height\":380,\"content\":\"### Refine lead results\\nHere I am refining lead results to make sure they match my search.\\nIf you have a different ICP, make sure to change the first value.\"},\"typeVersion\":1}],\"connections\":{\"Merge\":{\"main\":[[{\"node\":\"Pipedrive - Add Person\",\"type\":\"main\",\"index\":0}]]},\"list people\":{\"main\":[[{\"node\":\"If lead is Ideal Buyer\",\"type\":\"main\",\"index\":0},{\"node\":\"Merge\",\"type\":\"main\",\"index\":1}]]},\"Datagma - Find Emails\":{\"main\":[[{\"node\":\"Prepare Data Before Merge\",\"type\":\"main\",\"index\":0}]]},\"If lead is Ideal Buyer\":{\"main\":[[{\"node\":\"Datagma - Find Emails\",\"type\":\"main\",\"index\":0}]]},\"Datagma - Enrich Company\":{\"main\":[[{\"node\":\"list people\",\"type\":\"main\",\"index\":0},{\"node\":\"Pipedrive - Enrich Organization\",\"type\":\"main\",\"index\":0}]]},\"Prepare Data Before Merge\":{\"main\":[[{\"node\":\"Merge\",\"type\":\"main\",\"index\":0}]]},\"Pipedrive Trigger - New Company Created\":{\"main\":[[{\"node\":\"Datagma - Enrich Company\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "This workflow enriches new accounts in Pipedrive using Datagma API by adding data about ICP (ideal customer profile). Instead of Pipedrive, you can use any other CRM. In this example, ideal buyers are heads of sales/business development.\n\n## Prerequisites\n\n  * Pipedrive account and [Pipedrive credentials](https://docs.n8n.io/integrations/builtin/credentials/pipedrive/)\n\n\n\n## How it works\n\n  1. Pipedrive trigger node starts the workflow when a new company is created.\n  2. HTTP Request node queries data from Datagma.\n  3. Pipedrive node updates Pipedrive contact with new data from Datagma.\n  4. The Item Lists node simplifies returned data from Datagma that contain lists (arrays), enabling you to easily modify the structure for further processing without the need to use Function nodes and write custom JavaScript.\n  5. IF node identifies if the lead corresponds ICP.\n  6. HTTP Request node searches for emails in Datagma.\n  7. Set node prepares data for further merging.\n  8. Merge node combines data from multiple streams.\n  9. Pipedrive node adds a new person in Pipedrive.\n\n\n",
  "readme_html": "<!--[--><div data-v-50766329=\"\"><p>This workflow enriches new accounts in Pipedrive using Datagma API by adding data about ICP (ideal customer profile). Instead of Pipedrive, you can use any other CRM. In this example, ideal buyers are heads of sales/business development.</p>\n<h2>Prerequisites</h2>\n<ul>\n<li>Pipedrive account and <a href=\"https://docs.n8n.io/integrations/builtin/credentials/pipedrive/\" rel=\"ugc nofollow\" target=\"_blank\">Pipedrive credentials</a></li>\n</ul>\n<h2>How it works</h2>\n<ol>\n<li>Pipedrive trigger node starts the workflow when a new company is created.</li>\n<li>HTTP Request node queries data from Datagma.</li>\n<li>Pipedrive node updates Pipedrive contact with new data from Datagma.</li>\n<li>The Item Lists node simplifies returned data from Datagma that contain lists (arrays), enabling you to easily modify the structure for further processing without the need to use Function nodes and write custom JavaScript.</li>\n<li>IF node identifies if the lead corresponds ICP.</li>\n<li>HTTP Request node searches for emails in Datagma.</li>\n<li>Set node prepares data for further merging.</li>\n<li>Merge node combines data from multiple streams.</li>\n<li>Pipedrive node adds a new person in Pipedrive.</li>\n</ol>\n</div><!--]-->"
}