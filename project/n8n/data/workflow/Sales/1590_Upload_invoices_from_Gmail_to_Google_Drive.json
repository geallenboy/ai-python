{
  "title": "Upload invoices from Gmail to Google Drive",
  "url": "https://n8n.io/workflows/1590-upload-invoices-from-gmail-to-google-drive/",
  "category": "Sales",
  "category_url": "https://n8n.io/workflows/categories/sales/?sort=createdAt:desc",
  "author": "Jason",
  "publish_date": "Last update 10 months ago",
  "publish_date_absolute": "2024-07-07",
  "content": "",
  "workflow_json": "{\"id\":3,\"name\":\"Orlen\",\"nodes\":[{\"name\":\"On clicking 'execute'\",\"type\":\"n8n-nodes-base.manualTrigger\",\"position\":[240,300],\"parameters\":{},\"typeVersion\":1},{\"name\":\"Current date\",\"type\":\"n8n-nodes-base.function\",\"position\":[1160,960],\"parameters\":{\"functionCode\":\"var today = new Date();\\nvar year = today.getFullYear();\\nvar month = today.getMonth() + 1;\\nvar day = today.getDate();\\n\\nif(month < 10) {\\n  month = \\\"0\\\" + month;\\n}\\n\\nitems[0].json.year = year;\\nitems[0].json.month = month;\\nitems[0].json.day = day;\\n\\nreturn items;\"},\"typeVersion\":1},{\"name\":\"Every 23:45\",\"type\":\"n8n-nodes-base.cron\",\"position\":[960,960],\"parameters\":{\"triggerTimes\":{\"item\":[{\"hour\":23,\"minute\":45}]}},\"typeVersion\":1},{\"name\":\"Get Year folder\",\"type\":\"n8n-nodes-base.googleDrive\",\"position\":[1360,960],\"parameters\":{\"options\":{\"fields\":[\"id\"]},\"operation\":\"list\",\"queryFilters\":{\"name\":[{\"value\":\"={{$json[\\\"year\\\"]}}\",\"operation\":\"is\"}],\"mimeType\":[{\"mimeType\":\"application/vnd.google-apps.folder\"}]},\"authentication\":\"oAuth2\"},\"credentials\":{\"googleDriveOAuth2Api\":{\"id\":\"7\",\"name\":\"Google Drive account\"}},\"typeVersion\":1},{\"name\":\"Get Month folder\",\"type\":\"n8n-nodes-base.googleDrive\",\"position\":[1560,960],\"parameters\":{\"options\":{\"fields\":[\"id\"]},\"operation\":\"list\",\"queryString\":\"='{{$json[\\\"id\\\"]}}' in parents and name = '{{$node[\\\"Current date\\\"].json[\\\"month\\\"]}}'\",\"authentication\":\"oAuth2\",\"useQueryString\":true},\"credentials\":{\"googleDriveOAuth2Api\":{\"id\":\"7\",\"name\":\"Google Drive account\"}},\"typeVersion\":1},{\"name\":\"Orlen Invoice\",\"type\":\"n8n-nodes-base.gmail\",\"position\":[1760,960],\"parameters\":{\"resource\":\"message\",\"operation\":\"getAll\",\"returnAll\":true,\"additionalFields\":{\"q\":\"from:(orlenpay@orlen.pl) has:attachment is:unread\",\"format\":\"resolved\"}},\"credentials\":{\"gmailOAuth2\":{\"id\":\"5\",\"name\":\"dbarwikowski Gmail account\"}},\"typeVersion\":1},{\"name\":\"Upload Invoice to Google Drive\",\"type\":\"n8n-nodes-base.googleDrive\",\"position\":[1960,960],\"parameters\":{\"name\":\"=Orlen {{$binary.attachment_0.directory}}.{{$binary.attachment_0.fileExtension}}\",\"options\":{},\"parents\":[\"={{$node[\\\"Get Month folder\\\"].json[\\\"id\\\"]}}\"],\"binaryData\":true,\"resolveData\":true,\"authentication\":\"oAuth2\",\"binaryPropertyName\":\"attachment_0\"},\"credentials\":{\"googleDriveOAuth2Api\":{\"id\":\"7\",\"name\":\"Google Drive account\"}},\"typeVersion\":1},{\"name\":\"Mark as Read\",\"type\":\"n8n-nodes-base.gmail\",\"position\":[2160,960],\"parameters\":{\"labelIds\":[\"UNREAD\"],\"resource\":\"messageLabel\",\"messageId\":\"={{$node[\\\"Orlen Invoice\\\"].json[\\\"id\\\"]}}\",\"operation\":\"remove\"},\"credentials\":{\"gmailOAuth2\":{\"id\":\"5\",\"name\":\"dbarwikowski Gmail account\"}},\"typeVersion\":1},{\"name\":\"Merge\",\"type\":\"n8n-nodes-base.merge\",\"position\":[2280,960],\"parameters\":{\"mode\":\"mergeByIndex\"},\"typeVersion\":1},{\"name\":\"Slack\",\"type\":\"n8n-nodes-base.slack\",\"position\":[860,540],\"parameters\":{\"text\":\"=Kapitanie!\\nDodano fakturę {{$node[\\\"Orlen Invoice\\\"].binary.attachment_0.directory}} do Firma/{{$node[\\\"Current date\\\"].json[\\\"year\\\"]}}/{{$node[\\\"Current date\\\"].json[\\\"month\\\"]}}\",\"channel\":\"n8n\",\"attachments\":[],\"otherOptions\":{},\"authentication\":\"oAuth2\"},\"credentials\":{\"slackOAuth2Api\":{\"id\":\"6\",\"name\":\"Slack account\"}},\"typeVersion\":1}],\"active\":true,\"settings\":{\"timezone\":\"Europe/Warsaw\",\"saveExecutionProgress\":\"DEFAULT\"},\"createdAt\":\"2022-04-11T17:11:34.040Z\",\"updatedAt\":\"2022-04-11T21:59:45.898Z\",\"staticData\":null,\"connections\":{\"Merge\":{\"main\":[[{\"node\":\"Upload Invoice to Google Drive\",\"type\":\"main\",\"index\":0}]]},\"Every 23:45\":{\"main\":[[{\"node\":\"Orlen Invoice\",\"type\":\"main\",\"index\":0}]]},\"Current date\":{\"main\":[[{\"node\":\"Get Year folder\",\"type\":\"main\",\"index\":0}]]},\"Mark as Read\":{\"main\":[[{\"node\":\"Slack\",\"type\":\"main\",\"index\":0}]]},\"Orlen Invoice\":{\"main\":[[{\"node\":\"Merge\",\"type\":\"main\",\"index\":1}]]},\"Get Year folder\":{\"main\":[[{\"node\":\"Get Month folder\",\"type\":\"main\",\"index\":0}]]},\"Get Month folder\":{\"main\":[[{\"node\":\"Merge\",\"type\":\"main\",\"index\":0}]]},\"On clicking 'execute'\":{\"main\":[[{\"node\":\"Orlen Invoice\",\"type\":\"main\",\"index\":0}]]},\"Upload Invoice to Google Drive\":{\"main\":[[{\"node\":\"Mark as Read\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "Upload invoices from Gmail to Google Drive daily\n",
  "readme_html": "<!--[--><div data-v-50766329=\"\"><p>Upload invoices from Gmail to Google Drive daily</p>\n</div><!--]-->",
  "readme_zh": "每日将发票从Gmail上传至Google Drive",
  "title_zh": "将发票从Gmail上传至Google Drive",
  "publish_date_zh": "最后更新于10个月前",
  "workflow_json_zh": "{\n  \"id\": 3,\n  \"name\": \"Orlen\",\n  \"nodes\": [\n    {\n      \"name\": \"On clicking 'execute'\",\n      \"type\": \"n8n-nodes-base.manualTrigger\",\n      \"position\": [\n        240,\n        300\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Current date\",\n      \"type\": \"n8n-nodes-base.function\",\n      \"position\": [\n        1160,\n        960\n      ],\n      \"parameters\": {\n        \"functionCode\": \"var today = new Date();\\nvar year = today.getFullYear();\\nvar month = today.getMonth() + 1;\\nvar day = today.getDate();\\n\\nif(month < 10) {\\n  month = \\\"0\\\" + month;\\n}\\n\\nitems[0].json.year = year;\\nitems[0].json.month = month;\\nitems[0].json.day = day;\\n\\nreturn items;\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Every 23:45\",\n      \"type\": \"n8n-nodes-base.cron\",\n      \"position\": [\n        960,\n        960\n      ],\n      \"parameters\": {\n        \"triggerTimes\": {\n          \"item\": [\n            {\n              \"hour\": 23,\n              \"minute\": 45\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Get Year folder\",\n      \"type\": \"n8n-nodes-base.googleDrive\",\n      \"position\": [\n        1360,\n        960\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"fields\": [\n            \"id\"\n          ]\n        },\n        \"operation\": \"list\",\n        \"queryFilters\": {\n          \"name\": [\n            {\n              \"value\": \"={{$json[\\\"year\\\"]}}\",\n              \"operation\": \"is\"\n            }\n          ],\n          \"mimeType\": [\n            {\n              \"mimeType\": \"application/vnd.google-apps.folder\"\n            }\n          ]\n        },\n        \"authentication\": \"oAuth2\"\n      },\n      \"credentials\": {\n        \"googleDriveOAuth2Api\": {\n          \"id\": \"7\",\n          \"name\": \"Google Drive account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Get Month folder\",\n      \"type\": \"n8n-nodes-base.googleDrive\",\n      \"position\": [\n        1560,\n        960\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"fields\": [\n            \"id\"\n          ]\n        },\n        \"operation\": \"list\",\n        \"queryString\": \"='{{$json[\\\"id\\\"]}}' in parents and name = '{{$node[\\\"Current date\\\"].json[\\\"month\\\"]}}'\",\n        \"authentication\": \"oAuth2\",\n        \"useQueryString\": true\n      },\n      \"credentials\": {\n        \"googleDriveOAuth2Api\": {\n          \"id\": \"7\",\n          \"name\": \"Google Drive account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Orlen Invoice\",\n      \"type\": \"n8n-nodes-base.gmail\",\n      \"position\": [\n        1760,\n        960\n      ],\n      \"parameters\": {\n        \"resource\": \"message\",\n        \"operation\": \"getAll\",\n        \"returnAll\": true,\n        \"additionalFields\": {\n          \"q\": \"from:(orlenpay@orlen.pl) has:attachment is:unread\",\n          \"format\": \"resolved\"\n        }\n      },\n      \"credentials\": {\n        \"gmailOAuth2\": {\n          \"id\": \"5\",\n          \"name\": \"dbarwikowski Gmail account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Upload Invoice to Google Drive\",\n      \"type\": \"n8n-nodes-base.googleDrive\",\n      \"position\": [\n        1960,\n        960\n      ],\n      \"parameters\": {\n        \"name\": \"=Orlen {{$binary.attachment_0.directory}}.{{$binary.attachment_0.fileExtension}}\",\n        \"options\": {},\n        \"parents\": [\n          \"={{$node[\\\"Get Month folder\\\"].json[\\\"id\\\"]}}\"\n        ],\n        \"binaryData\": true,\n        \"resolveData\": true,\n        \"authentication\": \"oAuth2\",\n        \"binaryPropertyName\": \"attachment_0\"\n      },\n      \"credentials\": {\n        \"googleDriveOAuth2Api\": {\n          \"id\": \"7\",\n          \"name\": \"Google Drive account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Mark as Read\",\n      \"type\": \"n8n-nodes-base.gmail\",\n      \"position\": [\n        2160,\n        960\n      ],\n      \"parameters\": {\n        \"labelIds\": [\n          \"UNREAD\"\n        ],\n        \"resource\": \"messageLabel\",\n        \"messageId\": \"={{$node[\\\"Orlen Invoice\\\"].json[\\\"id\\\"]}}\",\n        \"operation\": \"remove\"\n      },\n      \"credentials\": {\n        \"gmailOAuth2\": {\n          \"id\": \"5\",\n          \"name\": \"dbarwikowski Gmail account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Merge\",\n      \"type\": \"n8n-nodes-base.merge\",\n      \"position\": [\n        2280,\n        960\n      ],\n      \"parameters\": {\n        \"mode\": \"mergeByIndex\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Slack\",\n      \"type\": \"n8n-nodes-base.slack\",\n      \"position\": [\n        860,\n        540\n      ],\n      \"parameters\": {\n        \"text\": \"=Kapitanie!\\nDodano fakturę {{$node[\\\"Orlen Invoice\\\"].binary.attachment_0.directory}} do Firma/{{$node[\\\"Current date\\\"].json[\\\"year\\\"]}}/{{$node[\\\"Current date\\\"].json[\\\"month\\\"]}}\",\n        \"channel\": \"n8n\",\n        \"attachments\": [],\n        \"otherOptions\": {},\n        \"authentication\": \"oAuth2\"\n      },\n      \"credentials\": {\n        \"slackOAuth2Api\": {\n          \"id\": \"6\",\n          \"name\": \"Slack account\"\n        }\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"active\": true,\n  \"settings\": {\n    \"timezone\": \"Europe/Warsaw\",\n    \"saveExecutionProgress\": \"DEFAULT\"\n  },\n  \"createdAt\": \"2022-04-11T17:11:34.040Z\",\n  \"updatedAt\": \"2022-04-11T21:59:45.898Z\",\n  \"staticData\": null,\n  \"connections\": {\n    \"Merge\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Upload Invoice to Google Drive\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Every 23:45\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Orlen Invoice\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Current date\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get Year folder\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Mark as Read\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Slack\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Orlen Invoice\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge\",\n            \"type\": \"main\",\n            \"index\": 1\n          }\n        ]\n      ]\n    },\n    \"Get Year folder\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get Month folder\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get Month folder\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"On clicking 'execute'\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Orlen Invoice\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Upload Invoice to Google Drive\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Mark as Read\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}