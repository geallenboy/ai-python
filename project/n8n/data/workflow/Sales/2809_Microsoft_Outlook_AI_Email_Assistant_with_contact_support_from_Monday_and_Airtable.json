{
  "title": "Microsoft Outlook AI Email Assistant with contact support from Monday and Airtable",
  "url": "https://n8n.io/workflows/2809-microsoft-outlook-ai-email-assistant-with-contact-support-from-monday-and-airtable/",
  "category": "Sales",
  "category_url": "https://n8n.io/workflows/categories/sales/?sort=createdAt:desc",
  "author": "Cognitive Creators",
  "publish_date": "Last update 3 months ago",
  "publish_date_absolute": "",
  "content": "",
  "workflow_json": "{\"id\":\"reQhibpNwU63Y8sn\",\"meta\":{\"instanceId\":\"2128095e13afd30151f0fb53632960213a789cd45ed0afd3a7fb96a985bb4bcf\",\"templateId\":\"2454\",\"templateCredsSetupCompleted\":true},\"name\":\"Microsoft Outlook AI Email Assistant\",\"tags\":[],\"nodes\":[{\"id\":\"a923cfb0-64fe-499a-8f0e-13fc848731df\",\"name\":\"When clicking â€˜Test workflowâ€™\",\"type\":\"n8n-nodes-base.manualTrigger\",\"position\":[980,540],\"parameters\":{},\"typeVersion\":1},{\"id\":\"ea865c8e-5c73-4d37-97d1-0349a265b9a4\",\"name\":\"Sticky Note8\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[2880,-600],\"parameters\":{\"color\":5,\"width\":675,\"height\":107,\"content\":\"# Microsoft Outlook AI Email Assistant\"},\"typeVersion\":1},{\"id\":\"c835042f-421b-44a0-8dc4-686ac638b358\",\"name\":\"Sticky Note10\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1300,60],\"parameters\":{\"width\":612,\"height\":401,\"content\":\"## Outlook Business with filters\\nFilters:\\n```\\nflag/flagStatus eq 'notFlagged' and not categories/any()\\n```\\n\\nThese filters ensure we do not process flagged emails or email that already have a category set.\"},\"typeVersion\":1},{\"id\":\"51ae8a4e-2d37-4118-a538-cd0fd4f427f7\",\"name\":\"Microsoft Outlook23\",\"type\":\"n8n-nodes-base.microsoftOutlook\",\"position\":[1540,240],\"parameters\":{\"limit\":10,\"fields\":[\"flag\",\"from\",\"importance\",\"replyTo\",\"sender\",\"subject\",\"toRecipients\",\"body\",\"categories\",\"isRead\"],\"output\":\"fields\",\"options\":{},\"filtersUI\":{\"values\":{\"filters\":{\"custom\":\"flag/flagStatus eq 'notFlagged' and not categories/any()\",\"foldersToInclude\":[\"AAMkADYyNmQ0YWE1LWQxYjEtNDBhYS1hODI3LTg3MTkyNDAwMzE5NwAuAAAAAAA44w-ZZoU7QLO9GQAyv8UcAQAkfR2JHrRET4CmwDGznLN6AAAAAAEMAAA=\"]}}},\"operation\":\"getAll\"},\"credentials\":{\"microsoftOutlookOAuth2Api\":{\"id\":\"nv0cz3C6VZDzEgtR\",\"name\":\"Microsoft365 Email Account\"}},\"typeVersion\":2},{\"id\":\"a144adad-6fef-4f76-a06e-c889e8f16080\",\"name\":\"Sticky Note11\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[2020,60],\"parameters\":{\"color\":6,\"width\":459,\"height\":401,\"content\":\"## Sanitise Email \\nRemoves HTML and useless information in preparation for the AI Agent\"},\"typeVersion\":1},{\"id\":\"92ccac8f-9ce3-4f81-a499-e55835be3fc7\",\"name\":\"Sticky Note12\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[2020,580],\"parameters\":{\"color\":4,\"width\":736,\"height\":558,\"content\":\"## Get Rules & Categories\\nEdit the airtables to set your own categories, rules, contacts and/or delete rules. \"},\"typeVersion\":1},{\"id\":\"5b304e0f-002c-42c6-82a0-9ab1dc858861\",\"name\":\"OpenAI Chat Model\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\"position\":[3860,460],\"parameters\":{\"model\":\"gpt-4o\",\"options\":{\"temperature\":0.2}},\"credentials\":{\"openAiApi\":{\"id\":\"l2JgpErNc5namHVH\",\"name\":\"OpenAI account\"}},\"typeVersion\":1},{\"id\":\"210816e8-6a1f-4e63-a90e-d953e0e87ccd\",\"name\":\"Set Category\",\"type\":\"n8n-nodes-base.microsoftOutlook\",\"position\":[4500,240],\"parameters\":{\"messageId\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"={{ $json.output.id }}\"},\"operation\":\"update\",\"updateFields\":{\"categories\":\"={{ [$json.output.category] }}\"}},\"credentials\":{\"microsoftOutlookOAuth2Api\":{\"id\":\"nv0cz3C6VZDzEgtR\",\"name\":\"Microsoft365 Email Account\"}},\"typeVersion\":2},{\"id\":\"fe4f8e8f-6a5c-4b7b-b5f7-10f1f374397c\",\"name\":\"Structured Output Parser\",\"type\":\"@n8n/n8n-nodes-langchain.outputParserStructured\",\"position\":[4040,460],\"parameters\":{\"schemaType\":\"manual\",\"inputSchema\":\"{\\n  \\\"type\\\": \\\"object\\\",\\n  \\\"properties\\\": {\\n    \\\"id\\\": {\\n      \\\"type\\\": \\\"string\\\",\\n      \\\"description\\\": \\\"The email id\\\"\\n    },\\n    \\\"subject\\\": {\\n      \\\"type\\\": \\\"string\\\",\\n      \\\"description\\\": \\\"The email subject line\\\"\\n    },\\n    \\\"category\\\": {\\n      \\\"type\\\": \\\"string\\\",\\n      \\\"description\\\": \\\"Primary classification of the email\\\"\\n    },\\n    \\\"subCategory\\\": {\\n      \\\"type\\\": \\\"string\\\",\\n      \\\"description\\\": \\\"Optional sub-classification if applicable\\\"\\n    },\\n    \\\"analysis\\\": {\\n      \\\"type\\\": \\\"string\\\",\\n      \\\"description\\\": \\\"Reasoning behind the categorization\\\"\\n    }\\n  },\\n  \\\"required\\\": [\\\"id\\\",\\\"subject\\\", \\\"category\\\", \\\"analysis\\\"]\\n}\"},\"typeVersion\":1.2},{\"id\":\"489028ca-f265-4ea2-b8dd-64dd6b06c8f6\",\"name\":\"If\",\"type\":\"n8n-nodes-base.if\",\"position\":[4740,240],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"6e4ecd0c-d151-4e5b-8d66-558f9f9ec3b0\",\"operator\":{\"name\":\"filter.operator.equals\",\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $('AI: Analyse Email').item.json.output.subCategory }}\",\"rightValue\":\"Action\"}]}},\"typeVersion\":2.2},{\"id\":\"e2a27071-bac6-4a67-94fb-93e7ac218c89\",\"name\":\"Set Importance\",\"type\":\"n8n-nodes-base.microsoftOutlook\",\"position\":[5000,220],\"parameters\":{\"messageId\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"={{ $('AI: Analyse Email').item.json.output.id }}\"},\"operation\":\"update\",\"updateFields\":{\"importance\":\"High\"}},\"credentials\":{\"microsoftOutlookOAuth2Api\":{\"id\":\"nv0cz3C6VZDzEgtR\",\"name\":\"Microsoft365 Email Account\"}},\"typeVersion\":2},{\"id\":\"61cecccf-589f-4514-b126-cfbfc7d94981\",\"name\":\"AI: Analyse Email\",\"type\":\"@n8n/n8n-nodes-langchain.agent\",\"position\":[3860,240],\"parameters\":{\"text\":\"=Categorise the following email:\\n<email>\\n{{ $('Loop Over Items').item.json.toJsonString() }}\\n</email>\\n\\n<Contact>\\n{{ $('Contact').all().toJsonString() }}\\n</Contact>\\n\\n<DeleteRules>\\n{{ $('Delete Rules').all().toJsonString() }}\\n</DeleteRules>\\n\\n<Categories>\\n{{ $('Categories').all().toJsonString() }}\\n</Categories>\\n\\nEnsure your final output is valid JSON with no additional text or token in the following format:\\n\\n{\\n  \\\"subject\\\": \\\"SUBJECT_LINE\\\",1\\n  \\\"category\\\": \\\"CATEGORY\\\",\\n  \\\"subCategory\\\": \\\"SUBCATEGORY\\\", //use sparingly\\n  \\\"analysis\\\": \\\"ANALYSIS_REASONING\\\"\\n}\\n\\nRemember you can only use ONE of the following category 'Name' values from the 'Categories' defined above. No other categories can be used. Use the subcategory for additional context, for example, if a client email requires action or if a supplier email requires action. Do not create any additional subcategories; you can only use ONE of the category 'Name' values from the 'Categories' defined above.\",\"options\":{\"systemMessage\":\"=Categories: \\\"\\\"\\\"{{ $('Categories').all().toJsonString() }}\\\"\\\"\\\"\\n\\nYou are an AI email assistant for the *insert role & title*. Your task is to categorize incoming emails using one of the category 'Name' values defined in 'Categories' above.\\n\\nYou may also use the subcategory:\\n- Action\\n\\nInstructions:\\nAnalyse the email subject, body, and sender's email address to determine the appropriate category by referring to the 'Usage', 'Sender Indicators' and 'Subject Indicators' defined in the 'Categories' above.\\n\\n\\nOutput Format:\\nProduce output in valid JSON format:\\n{\\n  \\\"id\\\": \\\"{{ $('Loop Over Items').item.json.id }}\\\",\\n  \\\"subject\\\": \\\"SUBJECT_LINE\\\",\\n  \\\"category\\\": \\\"PRIMARY CATEGORY\\\",\\n  \\\"subCategory\\\": \\\"SUBCATEGORY\\\", // use sparingly\\n  \\\"analysis\\\": \\\"Brief 1-2 sentence explanation of category choice\\\"\\n}\\n- Replace \\\"SUBJECT_LINE\\\" with the actual subject of the email.\\n- \\\"PRIMARY CATEGORY\\\" should be one of the categories listed above.\\n- \\\"SUBCATEGORY\\\" should be \\\"Action\\\" if applicable; otherwise, omit or leave blank.\\n- The \\\"analysis\\\" should be a brief 1-2 sentence explanation of why the category was chosen. Also, indicate if there was a match for the 'Contact' email and the email sender.\\n\\nImportant:\\nYou may only use the categories and the subcategory listed above; do not create any additional categories or subcategories.\\n\\nNo additional text or tokens should be included outside the JSON output.\\n\"},\"promptType\":\"define\",\"hasOutputParser\":true},\"typeVersion\":1.6},{\"id\":\"947eb4d7-9067-4144-819b-f53947ca77f8\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1420,-620],\"parameters\":{\"color\":6,\"width\":760,\"height\":400,\"content\":\"## CRM Contact List Integration \\nFor this workflow I am retrieving supplier & client contacts from Monday.com the email assistant has better context to categorise, prioritise and reply to emails.\\nThe list is updated daily or you can change the scheduler trigger to update more or less frequently.\\nYou could replace this with your own CRM.\"},\"typeVersion\":1},{\"id\":\"79815a8f-5650-4ec9-97b3-c0201469d048\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[3640,60],\"parameters\":{\"width\":700,\"height\":580,\"content\":\"## Categorise & Prioritise Emails Agent \\n\"},\"typeVersion\":1},{\"id\":\"2e9411a8-30da-4ee5-9597-cb08e34049a5\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[4400,120],\"parameters\":{\"color\":4,\"width\":740,\"height\":280,\"content\":\"## Set the category & importance using the output from the agent\\n\"},\"typeVersion\":1},{\"id\":\"138a734f-0ac5-4e50-a4af-b7255e11e862\",\"name\":\"Check Mail Schedule Trigger\",\"type\":\"n8n-nodes-base.scheduleTrigger\",\"disabled\":true,\"position\":[980,260],\"parameters\":{\"rule\":{\"interval\":[{\"field\":\"minutes\",\"minutesInterval\":15}]}},\"typeVersion\":1.2},{\"id\":\"709795fd-68ff-4881-9f30-6270dea83f7c\",\"name\":\"Update Contacts Schedule Trigger\",\"type\":\"n8n-nodes-base.scheduleTrigger\",\"position\":[1080,-420],\"parameters\":{\"rule\":{\"interval\":[{}]}},\"typeVersion\":1.2},{\"id\":\"552803ce-3dae-415d-b14d-a7b990450482\",\"name\":\"Monday.com - Get Contacts\",\"type\":\"n8n-nodes-base.mondayCom\",\"position\":[1520,-440],\"parameters\":{\"boardId\":\"1840712625\",\"groupId\":\"topics\",\"resource\":\"boardItem\",\"operation\":\"getAll\",\"returnAll\":true},\"credentials\":{\"mondayComApi\":{\"id\":\"wur9UFaP9YKCFZly\",\"name\":\"Monday.com - API User\"}},\"typeVersion\":1},{\"id\":\"cf41ebb0-f295-4f1a-a49c-05471a4d9220\",\"name\":\"Airtable - Contacts\",\"type\":\"n8n-nodes-base.airtable\",\"position\":[1920,-440],\"parameters\":{\"base\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"appNmgIGA4Fhculsn\",\"cachedResultUrl\":\"https://airtable.com/appNmgIGA4Fhculsn\",\"cachedResultName\":\"AI Email Assistant\"},\"table\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"tbl8gTTEn96uFRDHE\",\"cachedResultUrl\":\"https://airtable.com/appNmgIGA4Fhculsn/tbl8gTTEn96uFRDHE\",\"cachedResultName\":\"Contacts\"},\"columns\":{\"value\":{\"Type\":\"={{ $json.column_values[1].text }}\",\"Email\":\"={{ $json.column_values[6].text }}\",\"Last Name\":\"={{ $json.name.split(\\\" \\\",2).last() }}\",\"First Name\":\"={{ $json.name.split(\\\" \\\",2).first() }}\"},\"schema\":[{\"id\":\"id\",\"type\":\"string\",\"display\":true,\"removed\":false,\"readOnly\":true,\"required\":false,\"displayName\":\"id\",\"defaultMatch\":true},{\"id\":\"Email\",\"type\":\"string\",\"display\":true,\"removed\":false,\"readOnly\":false,\"required\":false,\"displayName\":\"Email\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"First Name\",\"type\":\"string\",\"display\":true,\"removed\":false,\"readOnly\":false,\"required\":false,\"displayName\":\"First Name\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Last Name\",\"type\":\"string\",\"display\":true,\"removed\":false,\"readOnly\":false,\"required\":false,\"displayName\":\"Last Name\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Type\",\"type\":\"string\",\"display\":true,\"removed\":false,\"readOnly\":false,\"required\":false,\"displayName\":\"Type\",\"defaultMatch\":false,\"canBeUsedToMatch\":true}],\"mappingMode\":\"defineBelow\",\"matchingColumns\":[\"Email\"]},\"options\":{},\"operation\":\"upsert\"},\"credentials\":{\"airtableTokenApi\":{\"id\":\"Bgr0Fi30Oek2jpXT\",\"name\":\"Airtable Personal Access Token account\"}},\"typeVersion\":2.1},{\"id\":\"6d698b4d-f18c-4e4a-9c83-8a39208aee8c\",\"name\":\"Convert to Markdown\",\"type\":\"n8n-nodes-base.markdown\",\"notes\":\"Converts the body of the email to markdown\",\"position\":[2120,240],\"parameters\":{\"html\":\"={{ $json.body.content }}\",\"options\":{}},\"notesInFlow\":true,\"typeVersion\":1},{\"id\":\"012109cc-dcba-464b-b3bc-17201b1ad436\",\"name\":\"Email Messages\",\"type\":\"n8n-nodes-base.set\",\"notes\":\"Set email fields\",\"position\":[2320,240],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"edb304e1-3e9f-4a77-918c-25646addbc53\",\"name\":\"subject\",\"type\":\"string\",\"value\":\"={{ $json.subject }}\"},{\"id\":\"57a3ef3a-2701-40d9-882f-f43a7219f148\",\"name\":\"importance\",\"type\":\"string\",\"value\":\"={{ $json.importance }}\"},{\"id\":\"d8317f4f-aa0e-4196-89af-cb016765490a\",\"name\":\"sender\",\"type\":\"object\",\"value\":\"={{ $json.sender.emailAddress }}\"},{\"id\":\"908716c8-9ff7-4bdc-a1a3-64227559635e\",\"name\":\"from\",\"type\":\"object\",\"value\":\"={{ $json.from.emailAddress }}\"},{\"id\":\"ce007329-e221-4c5a-8130-2f8e9130160f\",\"name\":\"body\",\"type\":\"string\",\"value\":\"={{ $json.data\\n    .replace(/<[^>]*>/g, '')                      // Remove HTML tags\\n    .replace(/\\\\[(.*?)\\\\]\\\\((.*?)\\\\)/g, '')            // Remove Markdown links like [text](link)\\n    .replace(/!\\\\[.*?\\\\]\\\\(.*?\\\\)/g, '')               // Remove Markdown images like ![alt](image-link)\\n    .replace(/\\\\|/g, '')                            // Remove table separators \\\"|\\\"\\n    .replace(/-{3,}/g, '')                         // Remove horizontal rule \\\"---\\\"\\n    .replace(/\\\\n+/g, ' ')                          // Remove multiple newlines\\n    .replace(/([^\\\\w\\\\s.,!?@])/g, '')                // Remove special characters except essential ones\\n    .replace(/\\\\s{2,}/g, ' ')                       // Replace multiple spaces with a single space\\n    .trim()                                        // Trim leading/trailing whitespace\\n}}\\n\"},{\"id\":\"6abfcc56-7b0a-469e-82fc-ce294ed5162b\",\"name\":\"id\",\"type\":\"string\",\"value\":\"={{ $json.id }}\"}]}},\"typeVersion\":3.4},{\"id\":\"6d3933f3-3f2e-4268-8979-d6c93c961916\",\"name\":\"Rules\",\"type\":\"n8n-nodes-base.airtable\",\"position\":[2400,720],\"parameters\":{\"base\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"appNmgIGA4Fhculsn\",\"cachedResultUrl\":\"https://airtable.com/appNmgIGA4Fhculsn\",\"cachedResultName\":\"AI Email Assistant\"},\"table\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"tblMSXbMFKETNToxV\",\"cachedResultUrl\":\"https://airtable.com/appNmgIGA4Fhculsn/tblMSXbMFKETNToxV\",\"cachedResultName\":\"Rules\"},\"options\":{},\"operation\":\"search\"},\"credentials\":{\"airtableTokenApi\":{\"id\":\"Bgr0Fi30Oek2jpXT\",\"name\":\"Airtable Personal Access Token account\"}},\"executeOnce\":true,\"typeVersion\":2.1},{\"id\":\"9166d63f-0c16-490f-afb8-e30ef25c49da\",\"name\":\"Categories\",\"type\":\"n8n-nodes-base.airtable\",\"position\":[2300,860],\"parameters\":{\"base\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"appNmgIGA4Fhculsn\",\"cachedResultUrl\":\"https://airtable.com/appNmgIGA4Fhculsn\",\"cachedResultName\":\"AI Email Assistant\"},\"table\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"tbliKDp5PoFNF7YI7\",\"cachedResultUrl\":\"https://airtable.com/appNmgIGA4Fhculsn/tbliKDp5PoFNF7YI7\",\"cachedResultName\":\"Categories\"},\"options\":{},\"operation\":\"search\"},\"credentials\":{\"airtableTokenApi\":{\"id\":\"Bgr0Fi30Oek2jpXT\",\"name\":\"Airtable Personal Access Token account\"}},\"executeOnce\":true,\"typeVersion\":2.1},{\"id\":\"f48e5a29-0eee-4420-80d9-2b9b016fba0d\",\"name\":\"Delete Rules\",\"type\":\"n8n-nodes-base.airtable\",\"position\":[2140,960],\"parameters\":{\"base\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"appNmgIGA4Fhculsn\",\"cachedResultUrl\":\"https://airtable.com/appNmgIGA4Fhculsn\",\"cachedResultName\":\"AI Email Assistant\"},\"table\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"tbl84EJr7y65ed4zh\",\"cachedResultUrl\":\"https://airtable.com/appNmgIGA4Fhculsn/tbl84EJr7y65ed4zh\",\"cachedResultName\":\"Delete Rules\"},\"options\":{},\"operation\":\"search\"},\"credentials\":{\"airtableTokenApi\":{\"id\":\"Bgr0Fi30Oek2jpXT\",\"name\":\"Airtable Personal Access Token account\"}},\"executeOnce\":true,\"typeVersion\":2.1},{\"id\":\"d6ad6091-2c7e-41b9-a9b3-b8715208cec0\",\"name\":\"Contact\",\"type\":\"n8n-nodes-base.airtable\",\"position\":[3080,240],\"parameters\":{\"base\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"appNmgIGA4Fhculsn\",\"cachedResultUrl\":\"https://airtable.com/appNmgIGA4Fhculsn\",\"cachedResultName\":\"AI Email Assistant\"},\"table\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"tbl8gTTEn96uFRDHE\",\"cachedResultUrl\":\"https://airtable.com/appNmgIGA4Fhculsn/tbl8gTTEn96uFRDHE\",\"cachedResultName\":\"Contacts\"},\"options\":{},\"operation\":\"search\",\"filterByFormula\":\"={Email}='{{ $('Loop Over Items').item.json.from.address }}'\"},\"credentials\":{\"airtableTokenApi\":{\"id\":\"Bgr0Fi30Oek2jpXT\",\"name\":\"Airtable Personal Access Token account\"}},\"executeOnce\":false,\"typeVersion\":2.1,\"alwaysOutputData\":true},{\"id\":\"bc1ede01-fa21-4446-a4e1-1a725a3a4887\",\"name\":\"Loop Over Items\",\"type\":\"n8n-nodes-base.splitInBatches\",\"position\":[2720,260],\"parameters\":{\"options\":{}},\"typeVersion\":3},{\"id\":\"fcdd837d-8852-4dcf-924c-aba4f2cddeba\",\"name\":\"Merge\",\"type\":\"n8n-nodes-base.merge\",\"position\":[3420,220],\"parameters\":{\"mode\":\"chooseBranch\",\"numberInputs\":4},\"typeVersion\":3},{\"id\":\"f790dd9b-19bb-4649-975e-00a511f2dd9f\",\"name\":\"Sticky Note3\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[3020,60],\"parameters\":{\"color\":4,\"height\":400,\"content\":\"## Match Contact\\nCheck if the sender is an existing contact. Note in this workflow the contacts are dynamically loaded from Monday.com\"},\"typeVersion\":1}],\"active\":false,\"pinData\":{},\"settings\":{},\"versionId\":\"e0fed20f-21be-4e21-bcc9-8af7062229dd\",\"connections\":{\"If\":{\"main\":[[{\"node\":\"Set Importance\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Loop Over Items\",\"type\":\"main\",\"index\":0}]]},\"Merge\":{\"main\":[[{\"node\":\"AI: Analyse Email\",\"type\":\"main\",\"index\":0}]]},\"Rules\":{\"main\":[[{\"node\":\"Merge\",\"type\":\"main\",\"index\":1}]]},\"Contact\":{\"main\":[[{\"node\":\"Merge\",\"type\":\"main\",\"index\":0}]]},\"Categories\":{\"main\":[[{\"node\":\"Merge\",\"type\":\"main\",\"index\":2}]]},\"Delete Rules\":{\"main\":[[{\"node\":\"Merge\",\"type\":\"main\",\"index\":3}]]},\"Set Category\":{\"main\":[[{\"node\":\"If\",\"type\":\"main\",\"index\":0}]]},\"Email Messages\":{\"main\":[[{\"node\":\"Loop Over Items\",\"type\":\"main\",\"index\":0}]]},\"Set Importance\":{\"main\":[[{\"node\":\"Loop Over Items\",\"type\":\"main\",\"index\":0}]]},\"Loop Over Items\":{\"main\":[[],[{\"node\":\"Contact\",\"type\":\"main\",\"index\":0}]]},\"AI: Analyse Email\":{\"main\":[[{\"node\":\"Set Category\",\"type\":\"main\",\"index\":0}]]},\"OpenAI Chat Model\":{\"ai_languageModel\":[[{\"node\":\"AI: Analyse Email\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"Convert to Markdown\":{\"main\":[[{\"node\":\"Email Messages\",\"type\":\"main\",\"index\":0}]]},\"Microsoft Outlook23\":{\"main\":[[{\"node\":\"Convert to Markdown\",\"type\":\"main\",\"index\":0}]]},\"Structured Output Parser\":{\"ai_outputParser\":[[{\"node\":\"AI: Analyse Email\",\"type\":\"ai_outputParser\",\"index\":0}]]},\"Monday.com - Get Contacts\":{\"main\":[[{\"node\":\"Airtable - Contacts\",\"type\":\"main\",\"index\":0}]]},\"Check Mail Schedule Trigger\":{\"main\":[[{\"node\":\"Microsoft Outlook23\",\"type\":\"main\",\"index\":0}]]},\"Update Contacts Schedule Trigger\":{\"main\":[[{\"node\":\"Monday.com - Get Contacts\",\"type\":\"main\",\"index\":0}]]},\"When clicking â€˜Test workflowâ€™\":{\"main\":[[{\"node\":\"Microsoft Outlook23\",\"type\":\"main\",\"index\":0},{\"node\":\"Rules\",\"type\":\"main\",\"index\":0},{\"node\":\"Categories\",\"type\":\"main\",\"index\":0},{\"node\":\"Delete Rules\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "# Microsoft Outlook AI Email Assistant\n\n## **Prerequisites**\n\n### **1\\. Microsoft 365 Login Credentials**\n\n  * Provide your Office 365 credentials to connect Outlook.\n\n\n\n### **2.[Monday.com](http://Monday.com)**\n\n  * Generate an API token and have a board with your contact details.\n\n\n\n### **3\\. Airtable**\n\n  * Obtain an API key (or personal access token) and set up a base to store: \n    * **Contacts** (populated by the [Monday.com](http://Monday.com) sync).\n    * **Rules & Categories** (used by the AI Email Assistant).\n  * Use this Airtable base as the template: [Airtable AI Email Assistant Template](https://airtable.com/appuffxqy5HlNYAXJ/shrhb2T92ZMF8FezS/tblP9SIola8yglSc0/viwxAIMM6TvWoahfM?blocks=hide). Define your own rules, categories, and delete rules.\n\n\n\n### **4\\. OpenAI API Key**\n\n  * Sign up for OpenAI if you donâ€™t already have an account.\n  * Generate a new API key at [OpenAI API Keys](https://platform.openai.com/api-keys).\n\n\n\n* * *\n\n## **What the System Does**\n\n### **1\\. Daily Contact Sync ([Monday.com](http://Monday.com) â†’ Airtable)**\n\n  * Runs **once a day** to pull the latest contacts from [Monday.com](http://Monday.com) and store or update them in Airtable.\n\n\n\n### **2\\. AI Email Categorisation & Prioritisation**\n\n  * Fetches **Outlook emails** with filters.\n  * Cleans and processes email content.\n  * Matches emails with known contacts from Airtable.\n  * Uses an **AI agent** to classify, categorise, and prioritise emails.\n  * Updates **Outlook categories and importance** based on AI results.\n  * Runs in parallel with **Airtable rules & categories retrieval** for real-time decision-making.\n\n\n\n* * *\n\n# **Workflow 1: Daily Contact Sync ([Monday.com](http://Monday.com) â†’ Airtable)**\n\n### **Purpose**\n\nKeep Airtableâ€™s **Contacts** table up to date by pulling new or updated contact data from [Monday.com](http://Monday.com) **daily**.\n\n### **Steps**\n\n  1. **Schedule Trigger**\n\n     * Runs at a set interval (daily) to initiate contact syncing.\n  2. **[Monday.com](http://Monday.com): Get Contacts**\n\n     * Reads the specified **board/columns** from [Monday.com](http://Monday.com) where you store contact details.\n  3. **Airtable - Contacts**\n\n     * **Upserts** (adds or updates) the fetched [Monday.com](http://Monday.com) data into Airtableâ€™s **Contacts** table.\n     * Ensures **daily updates** reflect changes from [Monday.com](http://Monday.com).\n\n\n\n### **Result**\n\nA **consolidated contact list** in Airtable, ready for AI email categorisation.\n\n* * *\n\n# **Workflow 2: Categorise & Prioritise Outlook Emails**\n\n### **Purpose**\n\nFetches **Outlook emails** , cleans and processes their content, **matches senders** with known contacts, and uses AI to categorise and prioritise them.\n\n### **Steps**\n\n#### **1\\. Get Outlook Emails with Filters**\n\n  * **Trigger** : Either scheduled (`Check Mail Schedule Trigger`) or manual (`Test Workflow`).\n  * **Outlook Filters** : \n    * **Not flagged** (`flag/flagStatus == 'notFlagged'`).\n    * **Not categorised** (`not categories/any()`).\n\n\n\n**ðŸ”¹ Result** : A batch of **fresh, unprocessed emails** ready for processing.\n\n* * *\n\n#### **2\\. Sanitise Email**\n\n  * **Convert to Markdown** : Strips **HTML tags** and normalises formatting.\n  * **Email Messages Processing** : Allows manual removal of **signatures, disclaimers, or extra content**.\n\n\n\n**ðŸ”¹ Result** : A **clean, AI-friendly email** for categorisation.\n\n* * *\n\n#### **3\\. Match Contact**\n\n  * **Loop Over Emails** : Iterates over each email.\n  * **Contact Lookup** : Checks Airtableâ€™s **Contacts** table (updated daily).\n  * **Merge Data** : Enriches emails with known **client, supplier, or internal team** info.\n\n\n\n**ðŸ”¹ Result** : Enhanced email context **for AI processing**.\n\n* * *\n\n#### **4\\. AI Agent to Categorise & Prioritise**\n\n  * **Retrieve Rules & Categories**\n    * Reads **Rules, Categories, and Delete Rules** from Airtable in parallel.\n  * **AI: Analyse Email (Tools Agent)**\n    * Uses **email text, sender info, and rules** to build a **structured AI prompt**.\n  * **OpenAI Chat Model**\n    * Processes the AI prompt and outputs: \n      * **Category**\n      * **Subcategory (optional)**\n      * **Priority level**\n      * **Short rationale**\n  * **Structured Output Parser**\n    * Ensures AI response is valid **JSON format**.\n\n\n\n**ðŸ”¹ Result** :  \nEach email is **labelled, categorised, and prioritised** with AI-driven logic.\n\n* * *\n\n#### **5\\. Set Outlook Category & Importance**\n\n  * **Set Category** : Updates Outlook with the assigned **category**.\n  * **Check Priority Conditions** (`If` Node): \n    * If **Action Required** or from a VIP, mark as **High Priority**.\n  * **Set Importance** : Updates the email's **importance flag** in Outlook.\n\n\n\n**ðŸ”¹ Result** :  \nOutlook is updated with **categories & importance** based on AI recommendations.\n\n* * *\n\n## **Parallel Processing: Retrieve Rules & Categories**\n\n  * Runs **alongside** the email categorisation workflow.\n  * Ensures **Airtable-based rules** are available before AI processing.\n\n\n\n### **Steps**\n\n  1. **Airtable: Get Rules & Categories**\n     * Fetches **Rules, Categories, and Delete Rules** from Airtable.\n  2. **Delete Rules (Optional)**\n     * If a delete rule matches, the email is removed.\n\n\n\n**ðŸ”¹ Result** :  \nA dynamic, **updatable rule system** ensuring emails are handled properly.\n\n* * *\n\n## **Final Outcome**\n\n  * **Daily Contact Sync** keeps contacts up to date.\n  * **AI-driven email workflow** ensures smart categorisation.\n  * **Outlook automatically updated** with AI-generated categories and importance.\n\n\n\n* * *\n\nThis **automated system** saves time, ensures **efficient inbox management** , and allows for **customisable rules** via Airtable.\n",
  "readme_html": "<!--[--><div data-v-50766329=\"\"><h1>Microsoft Outlook AI Email Assistant</h1>\n<h2><strong>Prerequisites</strong></h2>\n<h3><strong>1. Microsoft 365 Login Credentials</strong></h3>\n<ul>\n<li>Provide your Office 365 credentials to connect Outlook.</li>\n</ul>\n<h3><strong>2. <a href=\"http://Monday.com\" rel=\"ugc nofollow\" target=\"_blank\">Monday.com</a></strong></h3>\n<ul>\n<li>Generate an API token and have a board with your contact details.</li>\n</ul>\n<h3><strong>3. Airtable</strong></h3>\n<ul>\n<li>Obtain an API key (or personal access token) and set up a base to store:\n<ul>\n<li><strong>Contacts</strong> (populated by the <a href=\"http://Monday.com\" rel=\"ugc nofollow\" target=\"_blank\">Monday.com</a> sync).</li>\n<li><strong>Rules &amp; Categories</strong> (used by the AI Email Assistant).</li>\n</ul>\n</li>\n<li>Use this Airtable base as the template: <a href=\"https://airtable.com/appuffxqy5HlNYAXJ/shrhb2T92ZMF8FezS/tblP9SIola8yglSc0/viwxAIMM6TvWoahfM?blocks=hide\" rel=\"ugc nofollow\" target=\"_blank\">Airtable AI Email Assistant Template</a>. Define your own rules, categories, and delete rules.</li>\n</ul>\n<h3><strong>4. OpenAI API Key</strong></h3>\n<ul>\n<li>Sign up for OpenAI if you donâ€™t already have an account.</li>\n<li>Generate a new API key at <a href=\"https://platform.openai.com/api-keys\" rel=\"ugc nofollow\" target=\"_blank\">OpenAI API Keys</a>.</li>\n</ul>\n<hr>\n<h2><strong>What the System Does</strong></h2>\n<h3><strong>1. Daily Contact Sync (<a href=\"http://Monday.com\" rel=\"ugc nofollow\" target=\"_blank\">Monday.com</a> â†’ Airtable)</strong></h3>\n<ul>\n<li>Runs <strong>once a day</strong> to pull the latest contacts from <a href=\"http://Monday.com\" rel=\"ugc nofollow\" target=\"_blank\">Monday.com</a> and store or update them in Airtable.</li>\n</ul>\n<h3><strong>2. AI Email Categorisation &amp; Prioritisation</strong></h3>\n<ul>\n<li>Fetches <strong>Outlook emails</strong> with filters.</li>\n<li>Cleans and processes email content.</li>\n<li>Matches emails with known contacts from Airtable.</li>\n<li>Uses an <strong>AI agent</strong> to classify, categorise, and prioritise emails.</li>\n<li>Updates <strong>Outlook categories and importance</strong> based on AI results.</li>\n<li>Runs in parallel with <strong>Airtable rules &amp; categories retrieval</strong> for real-time decision-making.</li>\n</ul>\n<hr>\n<h1><strong>Workflow 1: Daily Contact Sync (<a href=\"http://Monday.com\" rel=\"ugc nofollow\" target=\"_blank\">Monday.com</a> â†’ Airtable)</strong></h1>\n<h3><strong>Purpose</strong></h3>\n<p>Keep Airtableâ€™s <strong>Contacts</strong> table up to date by pulling new or updated contact data from <a href=\"http://Monday.com\" rel=\"ugc nofollow\" target=\"_blank\">Monday.com</a> <strong>daily</strong>.</p>\n<h3><strong>Steps</strong></h3>\n<ol>\n<li>\n<p><strong>Schedule Trigger</strong></p>\n<ul>\n<li>Runs at a set interval (daily) to initiate contact syncing.</li>\n</ul>\n</li>\n<li>\n<p><strong><a href=\"http://Monday.com\" rel=\"ugc nofollow\" target=\"_blank\">Monday.com</a>: Get Contacts</strong></p>\n<ul>\n<li>Reads the specified <strong>board/columns</strong> from <a href=\"http://Monday.com\" rel=\"ugc nofollow\" target=\"_blank\">Monday.com</a> where you store contact details.</li>\n</ul>\n</li>\n<li>\n<p><strong>Airtable - Contacts</strong></p>\n<ul>\n<li><strong>Upserts</strong> (adds or updates) the fetched <a href=\"http://Monday.com\" rel=\"ugc nofollow\" target=\"_blank\">Monday.com</a> data into Airtableâ€™s <strong>Contacts</strong> table.</li>\n<li>Ensures <strong>daily updates</strong> reflect changes from <a href=\"http://Monday.com\" rel=\"ugc nofollow\" target=\"_blank\">Monday.com</a>.</li>\n</ul>\n</li>\n</ol>\n<h3><strong>Result</strong></h3>\n<p>A <strong>consolidated contact list</strong> in Airtable, ready for AI email categorisation.</p>\n<hr>\n<h1><strong>Workflow 2: Categorise &amp; Prioritise Outlook Emails</strong></h1>\n<h3><strong>Purpose</strong></h3>\n<p>Fetches <strong>Outlook emails</strong>, cleans and processes their content, <strong>matches senders</strong> with known contacts, and uses AI to categorise and prioritise them.</p>\n<h3><strong>Steps</strong></h3>\n<h4><strong>1. Get Outlook Emails with Filters</strong></h4>\n<ul>\n<li><strong>Trigger</strong>: Either scheduled (<code>Check Mail Schedule Trigger</code>) or manual (<code>Test Workflow</code>).</li>\n<li><strong>Outlook Filters</strong>:\n<ul>\n<li><strong>Not flagged</strong> (<code>flag/flagStatus == 'notFlagged'</code>).</li>\n<li><strong>Not categorised</strong> (<code>not categories/any()</code>).</li>\n</ul>\n</li>\n</ul>\n<p><strong>ðŸ”¹ Result</strong>: A batch of <strong>fresh, unprocessed emails</strong> ready for processing.</p>\n<hr>\n<h4><strong>2. Sanitise Email</strong></h4>\n<ul>\n<li><strong>Convert to Markdown</strong>: Strips <strong>HTML tags</strong> and normalises formatting.</li>\n<li><strong>Email Messages Processing</strong>: Allows manual removal of <strong>signatures, disclaimers, or extra content</strong>.</li>\n</ul>\n<p><strong>ðŸ”¹ Result</strong>: A <strong>clean, AI-friendly email</strong> for categorisation.</p>\n<hr>\n<h4><strong>3. Match Contact</strong></h4>\n<ul>\n<li><strong>Loop Over Emails</strong>: Iterates over each email.</li>\n<li><strong>Contact Lookup</strong>: Checks Airtableâ€™s <strong>Contacts</strong> table (updated daily).</li>\n<li><strong>Merge Data</strong>: Enriches emails with known <strong>client, supplier, or internal team</strong> info.</li>\n</ul>\n<p><strong>ðŸ”¹ Result</strong>: Enhanced email context <strong>for AI processing</strong>.</p>\n<hr>\n<h4><strong>4. AI Agent to Categorise &amp; Prioritise</strong></h4>\n<ul>\n<li><strong>Retrieve Rules &amp; Categories</strong>\n<ul>\n<li>Reads <strong>Rules, Categories, and Delete Rules</strong> from Airtable in parallel.</li>\n</ul>\n</li>\n<li><strong>AI: Analyse Email (Tools Agent)</strong>\n<ul>\n<li>Uses <strong>email text, sender info, and rules</strong> to build a <strong>structured AI prompt</strong>.</li>\n</ul>\n</li>\n<li><strong>OpenAI Chat Model</strong>\n<ul>\n<li>Processes the AI prompt and outputs:\n<ul>\n<li><strong>Category</strong></li>\n<li><strong>Subcategory (optional)</strong></li>\n<li><strong>Priority level</strong></li>\n<li><strong>Short rationale</strong></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><strong>Structured Output Parser</strong>\n<ul>\n<li>Ensures AI response is valid <strong>JSON format</strong>.</li>\n</ul>\n</li>\n</ul>\n<p><strong>ðŸ”¹ Result</strong>:<br>\nEach email is <strong>labelled, categorised, and prioritised</strong> with AI-driven logic.</p>\n<hr>\n<h4><strong>5. Set Outlook Category &amp; Importance</strong></h4>\n<ul>\n<li><strong>Set Category</strong>: Updates Outlook with the assigned <strong>category</strong>.</li>\n<li><strong>Check Priority Conditions</strong> (<code>If</code> Node):\n<ul>\n<li>If <strong>Action Required</strong> or from a VIP, mark as <strong>High Priority</strong>.</li>\n</ul>\n</li>\n<li><strong>Set Importance</strong>: Updates the email's <strong>importance flag</strong> in Outlook.</li>\n</ul>\n<p><strong>ðŸ”¹ Result</strong>:<br>\nOutlook is updated with <strong>categories &amp; importance</strong> based on AI recommendations.</p>\n<hr>\n<h2><strong>Parallel Processing: Retrieve Rules &amp; Categories</strong></h2>\n<ul>\n<li>Runs <strong>alongside</strong> the email categorisation workflow.</li>\n<li>Ensures <strong>Airtable-based rules</strong> are available before AI processing.</li>\n</ul>\n<h3><strong>Steps</strong></h3>\n<ol>\n<li><strong>Airtable: Get Rules &amp; Categories</strong>\n<ul>\n<li>Fetches <strong>Rules, Categories, and Delete Rules</strong> from Airtable.</li>\n</ul>\n</li>\n<li><strong>Delete Rules (Optional)</strong>\n<ul>\n<li>If a delete rule matches, the email is removed.</li>\n</ul>\n</li>\n</ol>\n<p><strong>ðŸ”¹ Result</strong>:<br>\nA dynamic, <strong>updatable rule system</strong> ensuring emails are handled properly.</p>\n<hr>\n<h2><strong>Final Outcome</strong></h2>\n<ul>\n<li><strong>Daily Contact Sync</strong> keeps contacts up to date.</li>\n<li><strong>AI-driven email workflow</strong> ensures smart categorisation.</li>\n<li><strong>Outlook automatically updated</strong> with AI-generated categories and importance.</li>\n</ul>\n<hr>\n<p>This <strong>automated system</strong> saves time, ensures <strong>efficient inbox management</strong>, and allows for <strong>customisable rules</strong> via Airtable.</p>\n</div><!--]-->"
}