{
  "title": "Create Salesforce accounts based on Excel 365 data",
  "url": "https://n8n.io/workflows/1793-create-salesforce-accounts-based-on-excel-365-data/",
  "category": "Sales",
  "category_url": "https://n8n.io/workflows/categories/sales/?sort=createdAt:desc",
  "author": "Tom",
  "publish_date": "Last update 10 months ago",
  "publish_date_absolute": "2024-07-07",
  "content": "",
  "workflow_json": "{\"nodes\":[{\"id\":\"e67d505c-20a3-4318-ba6b-d73db55e88e4\",\"name\":\"On clicking 'execute'\",\"type\":\"n8n-nodes-base.manualTrigger\",\"position\":[240,240],\"parameters\":{},\"typeVersion\":1},{\"id\":\"172d7c44-c488-4523-a0ad-1c903374c3e8\",\"name\":\"Search Salesforce accounts\",\"type\":\"n8n-nodes-base.salesforce\",\"position\":[680,240],\"parameters\":{\"query\":\"=SELECT id, Name FROM Account WHERE Name = '{{$json[\\\"Company Name\\\"].replace(/'/g, '\\\\\\\\\\\\'')}}'\",\"resource\":\"search\"},\"credentials\":{\"salesforceOAuth2Api\":{\"id\":\"40\",\"name\":\"Salesforce account\"}},\"typeVersion\":1,\"alwaysOutputData\":false},{\"id\":\"ae559728-f82e-44d6-8cfe-512151ee6867\",\"name\":\"Keep new companies\",\"type\":\"n8n-nodes-base.merge\",\"position\":[900,40],\"parameters\":{\"mode\":\"removeKeyMatches\",\"propertyName1\":\"Company Name\",\"propertyName2\":\"Name\"},\"typeVersion\":1},{\"id\":\"e01310a4-2b47-4deb-8058-ab878cf83fc1\",\"name\":\"Merge existing account data\",\"type\":\"n8n-nodes-base.merge\",\"position\":[900,440],\"parameters\":{\"mode\":\"mergeByKey\",\"propertyName1\":\"Company Name\",\"propertyName2\":\"Name\"},\"typeVersion\":1},{\"id\":\"1bc3a47f-ad77-4e2f-a777-6259017d8551\",\"name\":\"Account found?\",\"type\":\"n8n-nodes-base.if\",\"position\":[1120,440],\"parameters\":{\"conditions\":{\"string\":[{\"value1\":\"={{ $json[\\\"Id\\\"] }}\",\"operation\":\"isNotEmpty\"}]}},\"typeVersion\":1},{\"id\":\"a488fcfc-f67c-43db-8924-b8b341417aec\",\"name\":\"Remove duplicate companies\",\"type\":\"n8n-nodes-base.itemLists\",\"position\":[1120,140],\"parameters\":{\"compare\":\"selectedFields\",\"options\":{},\"operation\":\"removeDuplicates\",\"fieldsToCompare\":{\"fields\":[{\"fieldName\":\"Company Name\"}]}},\"typeVersion\":1},{\"id\":\"c175dfee-2294-4fa1-a33a-801b66857541\",\"name\":\"Set Account ID for existing accounts\",\"type\":\"n8n-nodes-base.renameKeys\",\"position\":[1340,440],\"parameters\":{\"keys\":{\"key\":[{\"newKey\":\"Account ID\",\"currentKey\":\"Id\"}]},\"additionalOptions\":{}},\"typeVersion\":1},{\"id\":\"9a393665-afba-4bc1-b590-19fab4b675c7\",\"name\":\"Retrieve new company contacts\",\"type\":\"n8n-nodes-base.merge\",\"position\":[1780,40],\"parameters\":{\"mode\":\"mergeByKey\",\"propertyName1\":\"Company Name\",\"propertyName2\":\"Name\"},\"typeVersion\":1},{\"id\":\"5be06058-5aa6-4160-b5e6-39677514dfcc\",\"name\":\"Set new account name\",\"type\":\"n8n-nodes-base.set\",\"position\":[1560,140],\"parameters\":{\"values\":{\"string\":[{\"name\":\"id\",\"value\":\"={{ $json[\\\"id\\\"] }}\"},{\"name\":\"Name\",\"value\":\"={{ $node[\\\"Remove duplicate companies\\\"].json[\\\"Company Name\\\"] }}\"}]},\"options\":{},\"keepOnlySet\":true},\"typeVersion\":1},{\"id\":\"5f535598-e50f-4ff6-a2db-687a7df3befe\",\"name\":\"Create Salesforce account\",\"type\":\"n8n-nodes-base.salesforce\",\"position\":[1340,140],\"parameters\":{\"name\":\"={{ $json[\\\"Company Name\\\"] }}\",\"resource\":\"account\",\"additionalFields\":{}},\"credentials\":{\"salesforceOAuth2Api\":{\"id\":\"40\",\"name\":\"Salesforce account\"}},\"typeVersion\":1},{\"id\":\"75c80602-7bfd-4662-b6bd-14384a03bc24\",\"name\":\"Create Salesforce contact\",\"type\":\"n8n-nodes-base.salesforce\",\"position\":[2000,240],\"parameters\":{\"lastname\":\"={{ $json[\\\"Last Name\\\"] }}\",\"resource\":\"contact\",\"operation\":\"upsert\",\"externalId\":\"Email\",\"externalIdValue\":\"={{ $json[\\\"Email\\\"] }}\",\"additionalFields\":{\"email\":\"={{ $json[\\\"Email\\\"] }}\",\"firstName\":\"={{ $json[\\\"First Name\\\"] }}\",\"acconuntId\":\"={{ $json[\\\"Account ID\\\"] }}\"}},\"credentials\":{\"salesforceOAuth2Api\":{\"id\":\"40\",\"name\":\"Salesforce account\"}},\"typeVersion\":1},{\"id\":\"f73ed50e-8fa6-4baf-90d2-4167d1823d27\",\"name\":\"Microsoft Excel\",\"type\":\"n8n-nodes-base.microsoftExcel\",\"position\":[460,240],\"parameters\":{\"range\":\"A1:E11\",\"resource\":\"worksheet\",\"workbook\":\"CA5C20CA5A0862D9!1122\",\"operation\":\"getContent\",\"worksheet\":\"{00000000-0001-0000-0000-000000000000}\"},\"credentials\":{\"microsoftExcelOAuth2Api\":{\"id\":\"44\",\"name\":\"Microsoft Excel account\"}},\"typeVersion\":1}],\"connections\":{\"Account found?\":{\"main\":[[{\"node\":\"Set Account ID for existing accounts\",\"type\":\"main\",\"index\":0}]]},\"Microsoft Excel\":{\"main\":[[{\"node\":\"Keep new companies\",\"type\":\"main\",\"index\":0},{\"node\":\"Search Salesforce accounts\",\"type\":\"main\",\"index\":0},{\"node\":\"Merge existing account data\",\"type\":\"main\",\"index\":0}]]},\"Keep new companies\":{\"main\":[[{\"node\":\"Remove duplicate companies\",\"type\":\"main\",\"index\":0},{\"node\":\"Retrieve new company contacts\",\"type\":\"main\",\"index\":0}]]},\"Set new account name\":{\"main\":[[{\"node\":\"Retrieve new company contacts\",\"type\":\"main\",\"index\":1}]]},\"On clicking 'execute'\":{\"main\":[[{\"node\":\"Microsoft Excel\",\"type\":\"main\",\"index\":0}]]},\"Create Salesforce account\":{\"main\":[[{\"node\":\"Set new account name\",\"type\":\"main\",\"index\":0}]]},\"Remove duplicate companies\":{\"main\":[[{\"node\":\"Create Salesforce account\",\"type\":\"main\",\"index\":0}]]},\"Search Salesforce accounts\":{\"main\":[[{\"node\":\"Keep new companies\",\"type\":\"main\",\"index\":1},{\"node\":\"Merge existing account data\",\"type\":\"main\",\"index\":1}]]},\"Merge existing account data\":{\"main\":[[{\"node\":\"Account found?\",\"type\":\"main\",\"index\":0}]]},\"Retrieve new company contacts\":{\"main\":[[{\"node\":\"Create Salesforce contact\",\"type\":\"main\",\"index\":0}]]},\"Set Account ID for existing accounts\":{\"main\":[[{\"node\":\"Create Salesforce contact\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "This workflow shows a no code approach to creating Salesforce accounts and contacts based on data coming from Excel 365 (the online version of Microsoft Excel). For a version working with regular Excel files check out [this workflow](https://n8n.io/workflows/1794-create-salesforce-accounts-based-on-excel-file-data/) instead.\n\n![image.png](https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/image_2d3e49822d.png)\n\nTo run the workflow:\n\n  1. Make sure you have both Excel 365 and Salesforce authenticated with n8n.\n  2. Have a Microsoft Excel workbook with contacts and their account names ready:  \n![image.png](https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/image_6ef5bc2056.png)\n  3. Select the workbook and sheet in the Microsoft Excel node of the workflow, then configure the range to read data from:  \n![image.png](https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/image_97ee88aa76.png)\n  4. Hit the **Execute Workflow** button at the bottom of the n8n canvas:  \n![image.png](https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/image_9e262ef126.png)\n\n\n\nHere is how it works:\n\nThe workflow first searches for existing Salesforce accounts by name. It then branches out depending on whether the account already exists in Salesforce or not. If an account does not exist yet, it will be created. The data is then normalised before both branches converge again. Finally the contacts are created or updated as needed in Salesforce.\n",
  "readme_html": "<!--[--><div data-v-50766329=\"\"><p>This workflow shows a no code approach to creating Salesforce accounts and contacts based on data coming from Excel 365 (the online version of Microsoft Excel). For a version working with regular Excel files check out <a href=\"https://n8n.io/workflows/1794-create-salesforce-accounts-based-on-excel-file-data/\" rel=\"ugc nofollow\" target=\"_blank\">this workflow</a> instead.</p>\n<p><img src=\"https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/image_2d3e49822d.png\" alt=\"image.png\"></p>\n<p>To run the workflow:</p>\n<ol>\n<li>Make sure you have both Excel 365 and Salesforce authenticated with n8n.</li>\n<li>Have a Microsoft Excel workbook with contacts and their account names ready:<br>\n<img src=\"https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/image_6ef5bc2056.png\" alt=\"image.png\"></li>\n<li>Select the workbook and sheet in the Microsoft Excel node of the workflow, then configure the range to read data from:<br>\n<img src=\"https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/image_97ee88aa76.png\" alt=\"image.png\"></li>\n<li>Hit the <strong>Execute Workflow</strong> button at the bottom of the n8n canvas:<br>\n<img src=\"https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/image_9e262ef126.png\" alt=\"image.png\"></li>\n</ol>\n<p>Here is how it works:</p>\n<p>The workflow first searches for existing Salesforce accounts by name. It then branches out depending on whether the account already exists in Salesforce or not. If an account does not exist yet, it will be created. The data is then normalised before both branches converge again. Finally the contacts are created or updated as needed in Salesforce.</p>\n</div><!--]-->",
  "readme_zh": "本工作流展示了一种无需编写代码的方法，用于基于Excel 365（微软Excel在线版）数据创建Salesforce客户和联系人。如需处理常规Excel文件的版本，请查看[此工作流](https://n8n.io/workflows/1794-create-salesforce-accounts-based-on-excel-file-data/)。\n\n![image.png](https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/image_2d3e49822d.png)\n\n运行工作流步骤：\n\n1. 确保Excel 365和Salesforce均已通过n8n完成认证  \n2. 准备包含联系人及其所属客户名称的Microsoft Excel工作簿：  \n![image.png](https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/image_6ef5bc2056.png)  \n3. 在工作流的Microsoft Excel节点中选择工作簿和工作表，配置数据读取范围：  \n![image.png](https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/image_97ee88aa76.png)  \n4. 点击n8n画布底部的**执行工作流**按钮：  \n![image.png](https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/image_9e262ef126.png)  \n\n实现原理：  \n工作流首先按名称搜索Salesforce中现有的客户，随后根据客户是否存在进行分支处理。若客户不存在则新建客户记录，数据标准化后两条分支重新汇合，最终按需在Salesforce中创建或更新联系人。",
  "title_zh": "根据Excel 365数据创建Salesforce账户",
  "publish_date_zh": "最后更新于10个月前",
  "workflow_json_zh": "{\"nodes\":[{\"id\":\"e67d505c-20a3-4318-ba6b-d73db55e88e4\",\"name\":\"On clicking 'execute'\",\"type\":\"n8n-nodes-base.manualTrigger\",\"position\":[240,240],\"parameters\":{},\"typeVersion\":1},{\"id\":\"172d7c44-c488-4523-a0ad-1c903374c3e8\",\"name\":\"Search Salesforce accounts\",\"type\":\"n8n-nodes-base.salesforce\",\"position\":[680,240],\"parameters\":{\"query\":\"=SELECT id, Name FROM Account WHERE Name = '{{$json[\\\"Company Name\\\"].replace(/'/g, '\\\\\\\\\\\\'')}}'\",\"resource\":\"search\"},\"credentials\":{\"salesforceOAuth2Api\":{\"id\":\"40\",\"name\":\"Salesforce account\"}},\"typeVersion\":1,\"alwaysOutputData\":false},{\"id\":\"ae559728-f82e-44d6-8cfe-512151ee6867\",\"name\":\"Keep new companies\",\"type\":\"n8n-nodes-base.merge\",\"position\":[900,40],\"parameters\":{\"mode\":\"removeKeyMatches\",\"propertyName1\":\"Company Name\",\"propertyName2\":\"Name\"},\"typeVersion\":1},{\"id\":\"e01310a4-2b47-4deb-8058-ab878cf83fc1\",\"name\":\"Merge existing account data\",\"type\":\"n8n-nodes-base.merge\",\"position\":[900,440],\"parameters\":{\"mode\":\"mergeByKey\",\"propertyName1\":\"Company Name\",\"propertyName2\":\"Name\"},\"typeVersion\":1},{\"id\":\"1bc3a47f-ad77-4e2f-a777-6259017d8551\",\"name\":\"Account found?\",\"type\":\"n8n-nodes-base.if\",\"position\":[1120,440],\"parameters\":{\"conditions\":{\"string\":[{\"value1\":\"={{ $json[\\\"Id\\\"] }}\",\"operation\":\"isNotEmpty\"}]}},\"typeVersion\":1},{\"id\":\"a488fcfc-f67c-43db-8924-b8b341417aec\",\"name\":\"Remove duplicate companies\",\"type\":\"n8n-nodes-base.itemLists\",\"position\":[1120,140],\"parameters\":{\"compare\":\"selectedFields\",\"options\":{},\"operation\":\"removeDuplicates\",\"fieldsToCompare\":{\"fields\":[{\"fieldName\":\"Company Name\"}]}},\"typeVersion\":1},{\"id\":\"c175dfee-2294-4fa1-a33a-801b66857541\",\"name\":\"Set Account ID for existing accounts\",\"type\":\"n8n-nodes-base.renameKeys\",\"position\":[1340,440],\"parameters\":{\"keys\":{\"key\":[{\"newKey\":\"Account ID\",\"currentKey\":\"Id\"}]},\"additionalOptions\":{}},\"typeVersion\":1},{\"id\":\"9a393665-afba-4bc1-b590-19fab4b675c7\",\"name\":\"Retrieve new company contacts\",\"type\":\"n8n-nodes-base.merge\",\"position\":[1780,40],\"parameters\":{\"mode\":\"mergeByKey\",\"propertyName1\":\"Company Name\",\"propertyName2\":\"Name\"},\"typeVersion\":1},{\"id\":\"5be06058-5aa6-4160-b5e6-39677514dfcc\",\"name\":\"Set new account name\",\"type\":\"n8n-nodes-base.set\",\"position\":[1560,140],\"parameters\":{\"values\":{\"string\":[{\"name\":\"id\",\"value\":\"={{ $json[\\\"id\\\"] }}\"},{\"name\":\"Name\",\"value\":\"={{ $node[\\\"Remove duplicate companies\\\"].json[\\\"Company Name\\\"] }}\"}]},\"options\":{},\"keepOnlySet\":true},\"typeVersion\":1},{\"id\":\"5f535598-e50f-4ff6-a2db-687a7df3befe\",\"name\":\"Create Salesforce account\",\"type\":\"n8n-nodes-base.salesforce\",\"position\":[1340,140],\"parameters\":{\"name\":\"={{ $json[\\\"Company Name\\\"] }}\",\"resource\":\"account\",\"additionalFields\":{}},\"credentials\":{\"salesforceOAuth2Api\":{\"id\":\"40\",\"name\":\"Salesforce account\"}},\"typeVersion\":1},{\"id\":\"75c80602-7bfd-4662-b6bd-14384a03bc24\",\"name\":\"Create Salesforce contact\",\"type\":\"n8n-nodes-base.salesforce\",\"position\":[2000,240],\"parameters\":{\"lastname\":\"={{ $json[\\\"Last Name\\\"] }}\",\"resource\":\"contact\",\"operation\":\"upsert\",\"externalId\":\"Email\",\"externalIdValue\":\"={{ $json[\\\"Email\\\"] }}\",\"additionalFields\":{\"email\":\"={{ $json[\\\"Email\\\"] }}\",\"firstName\":\"={{ $json[\\\"First Name\\\"] }}\",\"acconuntId\":\"={{ $json[\\\"Account ID\\\"] }}\"}},\"credentials\":{\"salesforceOAuth2Api\":{\"id\":\"40\",\"name\":\"Salesforce account\"}},\"typeVersion\":1},{\"id\":\"f73ed50e-8fa6-4baf-90d2-4167d1823d27\",\"name\":\"Microsoft Excel\",\"type\":\"n8n-nodes-base.microsoftExcel\",\"position\":[460,240],\"parameters\":{\"range\":\"A1:E11\",\"resource\":\"worksheet\",\"workbook\":\"CA5C20CA5A0862D9!1122\",\"operation\":\"getContent\",\"worksheet\":\"{00000000-0001-0000-0000-000000000000}\"},\"credentials\":{\"microsoftExcelOAuth2Api\":{\"id\":\"44\",\"name\":\"Microsoft Excel account\"}},\"typeVersion\":1}],\"connections\":{\"Account found?\":{\"main\":[[{\"node\":\"Set Account ID for existing accounts\",\"type\":\"main\",\"index\":0}]]},\"Microsoft Excel\":{\"main\":[[{\"node\":\"Keep new companies\",\"type\":\"main\",\"index\":0},{\"node\":\"Search Salesforce accounts\",\"type\":\"main\",\"index\":0},{\"node\":\"Merge existing account data\",\"type\":\"main\",\"index\":0}]]},\"Keep new companies\":{\"main\":[[{\"node\":\"Remove duplicate companies\",\"type\":\"main\",\"index\":0},{\"node\":\"Retrieve new company contacts\",\"type\":\"main\",\"index\":0}]]},\"Set new account name\":{\"main\":[[{\"node\":\"Retrieve new company contacts\",\"type\":\"main\",\"index\":1}]]},\"On clicking 'execute'\":{\"main\":[[{\"node\":\"Microsoft Excel\",\"type\":\"main\",\"index\":0}]]},\"Create Salesforce account\":{\"main\":[[{\"node\":\"Set new account name\",\"type\":\"main\",\"index\":0}]]},\"Remove duplicate companies\":{\"main\":[[{\"node\":\"Create Salesforce account\",\"type\":\"main\",\"index\":0}]]},\"Search Salesforce accounts\":{\"main\":[[{\"node\":\"Keep new companies\",\"type\":\"main\",\"index\":1},{\"node\":\"Merge existing account data\",\"type\":\"main\",\"index\":1}]]},\"Merge existing account data\":{\"main\":[[{\"node\":\"Account found?\",\"type\":\"main\",\"index\":0}]]},\"Retrieve new company contacts\":{\"main\":[[{\"node\":\"Create Salesforce contact\",\"type\":\"main\",\"index\":0}]]},\"Set Account ID for existing accounts\":{\"main\":[[{\"node\":\"Create Salesforce contact\",\"type\":\"main\",\"index\":0}]]}}}"
}