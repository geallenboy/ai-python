{
  "title": "Unique QRcode coupon assignment and validation for Lead Generation with SuiteCRM",
  "url": "https://n8n.io/workflows/2899-unique-qrcode-coupon-assignment-and-validation-for-lead-generation-with-suitecrm/",
  "category": "Sales",
  "category_url": "https://n8n.io/workflows/categories/sales/?sort=createdAt:desc",
  "author": "Davide",
  "publish_date": "Last update 3 months ago",
  "publish_date_absolute": "2025-02-07",
  "content": "",
  "workflow_json": "{\"id\":\"fW6PV9IaePKSMGbN\",\"meta\":{\"instanceId\":\"a4bfc93e975ca233ac45ed7c9227d84cf5a2329310525917adaf3312e10d5462\",\"templateCredsSetupCompleted\":true},\"name\":\"Unique QRcode coupon assignment and validation for Lead Generation system\",\"tags\":[],\"nodes\":[{\"id\":\"5ef4dd1d-39d6-487e-a48d-420b458ac1ee\",\"name\":\"Webhook\",\"type\":\"n8n-nodes-base.webhook\",\"position\":[-420,340],\"webhookId\":\"bb832325-8c58-4717-b866-41f8a9714cf2\",\"parameters\":{\"path\":\"bb832325-8c58-4717-b866-41f8a9714cf2\",\"options\":{},\"responseMode\":\"responseNode\"},\"typeVersion\":2},{\"id\":\"a7102d60-d4bd-450d-92b3-a32e2304b4a9\",\"name\":\"If\",\"type\":\"n8n-nodes-base.if\",\"position\":[40,340],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"430aee2d-a788-4d7c-ab64-880c900f0058\",\"operator\":{\"type\":\"string\",\"operation\":\"exists\",\"singleValue\":true},\"leftValue\":\"={{ $json.qr }}\",\"rightValue\":\"\"}]}},\"typeVersion\":2.2},{\"id\":\"f9dfd28e-42b5-488a-acde-dbbff95cf72f\",\"name\":\"Token SuiteCRM\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[700,-320],\"parameters\":{\"url\":\"=https://SUITECRMURL/Api/access_token\",\"options\":{},\"requestMethod\":\"POST\",\"bodyParametersUi\":{\"parameter\":[{\"name\":\"grant_type\",\"value\":\"client_credentials\"},{\"name\":\"client_id\",\"value\":\"CLIENTID\"},{\"name\":\"client_secret\",\"value\":\"CLIENTSECRET\"}]},\"allowUnauthorizedCerts\":true},\"notesInFlow\":true,\"typeVersion\":1},{\"id\":\"0e5c7208-a90a-4612-a5eb-f962546320dc\",\"name\":\"Create Lead SuiteCRM\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[940,-320],\"parameters\":{\"url\":\"https://SUITECRMURL/Api/V8/module\",\"method\":\"POST\",\"options\":{\"response\":{\"response\":{\"responseFormat\":\"json\"}}},\"jsonBody\":\"={\\\"data\\\": \\n  {\\n  \\\"type\\\": \\\"Leads\\\",\\n  \\\"attributes\\\": { \\n  \\\"first_name\\\": \\\"{{ $('Form Fields').item.json.Name }}\\\",\\n  \\\"last_name\\\": \\\"{{ $('Form Fields').item.json.Surname }}\\\",\\n  \\\"email1\\\": \\\"{{ $('Form Fields').item.json.Email }}\\\",\\n  \\\"phone_mobile\\\":\\\"{{ $('Form Fields').item.json.Phone }}\\\",\\n  \\\"coupon_c\\\": \\\"{{ $('Get Coupon').item.json.COUPON }}\\\"\\n  }\\n  }\\n}\",\"sendBody\":true,\"sendHeaders\":true,\"specifyBody\":\"json\",\"headerParameters\":{\"parameters\":[{\"name\":\"Authorization\",\"value\":\"=Bearer {{$node[\\\"Token SuiteCRM\\\"].json[\\\"access_token\\\"]}}\"},{\"name\":\"Content-Type\",\"value\":\"application/vnd.api+json\"}]}},\"notesInFlow\":true,\"typeVersion\":3},{\"id\":\"e9191ab8-4fb8-40bb-b676-89ac4e58b2dc\",\"name\":\"On form submission\",\"type\":\"n8n-nodes-base.formTrigger\",\"position\":[-420,-420],\"webhookId\":\"63d1d84b-c41e-4d3d-961a-0aa2af830ceb\",\"parameters\":{\"options\":{},\"formTitle\":\"Landing\",\"formFields\":{\"values\":[{\"fieldLabel\":\"Name\",\"placeholder\":\"Name\",\"requiredField\":true},{\"fieldLabel\":\"Surname\",\"placeholder\":\"Surname\",\"requiredField\":true},{\"fieldType\":\"email\",\"fieldLabel\":\"Email\",\"placeholder\":\"Email\",\"requiredField\":true},{\"fieldLabel\":\"Phone\",\"placeholder\":\"Phone\",\"requiredField\":true}]}},\"typeVersion\":2.2},{\"id\":\"4f61d7df-aeb3-4e8d-b30b-8396944e93a3\",\"name\":\"Duplicate Lead?\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[20,-420],\"parameters\":{\"options\":{},\"filtersUI\":{\"values\":[{\"lookupValue\":\"={{ $json.Email }}\",\"lookupColumn\":\"EMAIL\"}]},\"sheetName\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"gid=0\",\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1lnRZodxZSOA0QSuzkAb7ZJcfFfNXpX7NcxMdckMTN90/edit#gid=0\",\"cachedResultName\":\"Foglio1\"},\"documentId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"1lnRZodxZSOA0QSuzkAb7ZJcfFfNXpX7NcxMdckMTN90\",\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1lnRZodxZSOA0QSuzkAb7ZJcfFfNXpX7NcxMdckMTN90/edit?usp=drivesdk\",\"cachedResultName\":\"Coupon\"}},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"JYR6a64Qecd6t8Hb\",\"name\":\"Google Sheets account\"}},\"typeVersion\":4.5,\"alwaysOutputData\":true},{\"id\":\"393372b3-3aaf-4500-a795-0c0f47ea9625\",\"name\":\"Form Fields\",\"type\":\"n8n-nodes-base.set\",\"position\":[-180,-420],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"661d1475-f964-4a12-bfe7-88bf96851319\",\"name\":\"Name\",\"type\":\"string\",\"value\":\"={{ $json.Name }}\"},{\"id\":\"9991645d-c716-47db-80d6-850f3d64c782\",\"name\":\"Surname\",\"type\":\"string\",\"value\":\"={{ $json.Surname }}\"},{\"id\":\"c999afa6-2ec7-4f7f-bf3b-088a3597591c\",\"name\":\"Email\",\"type\":\"string\",\"value\":\"={{ $json.Email }}\"},{\"id\":\"f3faccdb-2412-4363-a0e3-f13b8f85b242\",\"name\":\"Phone\",\"type\":\"string\",\"value\":\"={{ $json.Phone }}\"}]}},\"typeVersion\":3.4},{\"id\":\"40d47841-6fb6-4339-b101-a8e917791229\",\"name\":\"Get Coupon\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[480,-320],\"parameters\":{\"options\":{\"returnFirstMatch\":true},\"filtersUI\":{\"values\":[{\"lookupColumn\":\"ID LEAD\"}]},\"sheetName\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"gid=0\",\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1lnRZodxZSOA0QSuzkAb7ZJcfFfNXpX7NcxMdckMTN90/edit#gid=0\",\"cachedResultName\":\"Foglio1\"},\"documentId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"1lnRZodxZSOA0QSuzkAb7ZJcfFfNXpX7NcxMdckMTN90\",\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1lnRZodxZSOA0QSuzkAb7ZJcfFfNXpX7NcxMdckMTN90/edit?usp=drivesdk\",\"cachedResultName\":\"Coupon\"}},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"JYR6a64Qecd6t8Hb\",\"name\":\"Google Sheets account\"}},\"executeOnce\":false,\"typeVersion\":4.5},{\"id\":\"16358f58-eb7c-4fe5-a0aa-960943a7bebd\",\"name\":\"Update Sheet\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[1180,-320],\"parameters\":{\"columns\":{\"value\":{\"DATE\":\"={{ $now.format('dd/LL/yyyy HH:mm:ss') }}\",\"NAME\":\"={{ $json.data.attributes.first_name }}\",\"EMAIL\":\"={{ $json.data.attributes.email1 }}\",\"PHONE\":\"={{ $json.data.attributes.phone_mobile }}\",\"COUPON\":\"={{ $('Get Coupon').item.json.COUPON }}\",\"ID LEAD\":\"={{ $json.data.id }}\",\"SURNAME\":\"={{ $json.data.attributes.last_name }}\"},\"schema\":[{\"id\":\"NAME\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"NAME\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"SURNAME\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"SURNAME\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"EMAIL\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"EMAIL\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"PHONE\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"PHONE\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"COUPON\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"COUPON\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"DATE\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"DATE\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"ID LEAD\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"ID LEAD\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"row_number\",\"type\":\"string\",\"display\":true,\"removed\":true,\"readOnly\":true,\"required\":false,\"displayName\":\"row_number\",\"defaultMatch\":false,\"canBeUsedToMatch\":true}],\"mappingMode\":\"defineBelow\",\"matchingColumns\":[\"COUPON\"],\"attemptToConvertTypes\":false,\"convertFieldsToString\":false},\"options\":{},\"operation\":\"update\",\"sheetName\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"gid=0\",\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1lnRZodxZSOA0QSuzkAb7ZJcfFfNXpX7NcxMdckMTN90/edit#gid=0\",\"cachedResultName\":\"Foglio1\"},\"documentId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"1lnRZodxZSOA0QSuzkAb7ZJcfFfNXpX7NcxMdckMTN90\",\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1lnRZodxZSOA0QSuzkAb7ZJcfFfNXpX7NcxMdckMTN90/edit?usp=drivesdk\",\"cachedResultName\":\"Coupon\"}},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"JYR6a64Qecd6t8Hb\",\"name\":\"Google Sheets account\"}},\"typeVersion\":4.5},{\"id\":\"36025b8c-41cb-4827-bf0e-ec6f692c13df\",\"name\":\"Is Duplicate?\",\"type\":\"n8n-nodes-base.if\",\"position\":[220,-420],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"9e3a8422-14f1-453e-bfed-4feecff34662\",\"operator\":{\"type\":\"string\",\"operation\":\"notEmpty\",\"singleValue\":true},\"leftValue\":\"={{ $json.EMAIL }}\",\"rightValue\":\"={{ $('Form Fields').item.json.email }}\"}]}},\"typeVersion\":2.2},{\"id\":\"e2267b93-9396-4ebf-8307-f8c98c1c3d65\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-200,-500],\"parameters\":{\"width\":340,\"height\":240,\"content\":\"Check if the lead has already received the coupon\"},\"typeVersion\":1},{\"id\":\"a8af825a-4e26-4660-8a9e-f7ce3ba33b3a\",\"name\":\"Sticky Note3\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[440,-380],\"parameters\":{\"width\":180,\"height\":220,\"content\":\"Find the first available unassigned coupon\"},\"typeVersion\":1},{\"id\":\"dd868852-5b0f-4b5b-922f-f70b8a6da01e\",\"name\":\"Sticky Note4\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[680,-380],\"parameters\":{\"width\":400,\"height\":220,\"content\":\"Enter the lead with the relative coupon on Suite CRM. Change SUITECRMURL, CLIENTSECRET and CLIENTID\"},\"typeVersion\":1},{\"id\":\"d2c26f3a-496e-47d6-b3f6-1aea5d0293fa\",\"name\":\"Get QR\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[1400,-320],\"parameters\":{\"url\":\"=https://quickchart.io/qr?text=https://n8n.n3witalia.com/webhook-test/bb832325-8c58-4717-b866-41f8a9714cf2?qr={{ $('Get Coupon').item.json.COUPON }}&size=250\",\"options\":{}},\"typeVersion\":4.2},{\"id\":\"371fa5e5-6f91-4236-83d4-81f579d7d2ab\",\"name\":\"Send Email\",\"type\":\"n8n-nodes-base.emailSend\",\"position\":[1620,-320],\"webhookId\":\"a84b051c-7d5f-4c17-bac6-68a9df9fa7c7\",\"parameters\":{\"html\":\"=<!DOCTYPE html>\\n<html>\\n<head>\\n    <meta charset=\\\"UTF-8\\\">\\n    <title>Exclusive Discount Coupon</title>\\n</head>\\n<body style=\\\"font-family: Arial, sans-serif; text-align: center;\\\">\\n    <h2>Get Your Exclusive Discount!</h2>\\n    <p>Hi {{ $('On form submission').item.json.Name }},<br>\\n    Scan the QR code below to claim your special discount.</p>\\n    \\n    <img src=\\\"https://quickchart.io/qr?text=https://n8n.n3witalia.com/webhook-test/bb832325-8c58-4717-b866-41f8a9714cf2?qr={{ $('Get Coupon').item.json.COUPON }}&size=250\\\" alt=\\\"Scan to get your discount\\\" style=\\\"margin: 20px;\\\">\\n    \\n    <p>Hurry, the offer is limited!</p>\\n</body>\\n</html>\\n\",\"options\":{},\"subject\":\"[n8n] Exclusive Discount Coupon\",\"toEmail\":\"={{ $('Form Fields').item.json.Email }}\",\"fromEmail\":\"=EMAILFROM\"},\"credentials\":{\"smtp\":{\"id\":\"hRjP3XbDiIQqvi7x\",\"name\":\"SMTP info@n3witalia.com\"}},\"typeVersion\":2.1},{\"id\":\"5893bd1d-762d-4337-8392-6d358002845a\",\"name\":\"Update Lead\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[1020,100],\"parameters\":{\"url\":\"=https://suitecrm.dev.n3witalia.com/Api/V8/module\",\"method\":\"PATCH\",\"options\":{\"response\":{\"response\":{\"responseFormat\":\"json\"}}},\"jsonBody\":\"={\\n  \\\"data\\\": {\\n    \\\"type\\\": \\\"Leads\\\",\\n    \\\"id\\\": \\\"{{ $('Not used?').item.json['ID LEAD'] }}\\\",\\n    \\\"attributes\\\": {\\n      \\\"coupon_used_c\\\": \\\"yes\\\"\\n    }\\n  }\\n}\",\"sendBody\":true,\"sendHeaders\":true,\"specifyBody\":\"json\",\"headerParameters\":{\"parameters\":[{\"name\":\"Authorization\",\"value\":\"=Bearer {{$node[\\\"Token SuiteCRM 1\\\"].json[\\\"access_token\\\"]}}\"},{\"name\":\"Content-Type\",\"value\":\"application/vnd.api+json\"}]}},\"notesInFlow\":true,\"typeVersion\":3},{\"id\":\"fd0a43f4-a3f1-4008-947c-f8208d2126f7\",\"name\":\"Not used?\",\"type\":\"n8n-nodes-base.if\",\"position\":[540,240],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"50546d87-ab37-4c8a-b835-e1a60f3aa0dc\",\"operator\":{\"type\":\"string\",\"operation\":\"empty\",\"singleValue\":true},\"leftValue\":\"={{ $json['USED COUPON?'] }}\",\"rightValue\":\"\"},{\"id\":\"025a42b8-fb90-44a8-951a-0e321b42c3b9\",\"operator\":{\"type\":\"number\",\"operation\":\"exists\",\"singleValue\":true},\"leftValue\":\"={{ $json.row_number }}\",\"rightValue\":\"\"}]}},\"typeVersion\":2.2},{\"id\":\"0029c366-aec1-4305-aab5-2ab6845e2828\",\"name\":\"Coupon OK\",\"type\":\"n8n-nodes-base.respondToWebhook\",\"position\":[1480,100],\"parameters\":{\"options\":{},\"respondWith\":\"text\",\"responseBody\":\"Qr valid!\"},\"typeVersion\":1.1},{\"id\":\"4c326412-0965-4f1c-9b77-2704d37a7151\",\"name\":\"No coupon\",\"type\":\"n8n-nodes-base.respondToWebhook\",\"position\":[320,460],\"parameters\":{\"options\":{\"responseCode\":200},\"respondWith\":\"text\",\"responseBody\":\"Coupon not valid\"},\"typeVersion\":1.1},{\"id\":\"e18cf9e7-584d-4f49-88b8-4c3a513ff613\",\"name\":\"Coupon KO\",\"type\":\"n8n-nodes-base.respondToWebhook\",\"position\":[800,320],\"parameters\":{\"options\":{\"responseCode\":200},\"respondWith\":\"text\",\"responseBody\":\"Coupon already used\"},\"typeVersion\":1.1},{\"id\":\"55a63a65-5472-4e50-8150-604c6bc9dd18\",\"name\":\"Token SuiteCRM 1\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[800,100],\"parameters\":{\"url\":\"=https://SUITECRMURL/Api/access_token\",\"options\":{},\"requestMethod\":\"POST\",\"bodyParametersUi\":{\"parameter\":[{\"name\":\"grant_type\",\"value\":\"client_credentials\"},{\"name\":\"client_id\",\"value\":\"CLIENTID\"},{\"name\":\"client_secret\",\"value\":\"CLIENTSECRET\"}]},\"allowUnauthorizedCerts\":true},\"notesInFlow\":true,\"typeVersion\":1},{\"id\":\"c843c9f2-9940-423c-bc9d-8530fb43f229\",\"name\":\"Set coupon\",\"type\":\"n8n-nodes-base.set\",\"position\":[-180,340],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"4e9a4330-d654-410f-9b99-aa57545c2c80\",\"name\":\"qr\",\"type\":\"string\",\"value\":\"={{ $json.query.qr }}\"}]}},\"typeVersion\":3.4},{\"id\":\"9a2d877d-9016-460e-b376-ea27c59a492a\",\"name\":\"Get Lead\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[320,240],\"parameters\":{\"options\":{\"returnFirstMatch\":true},\"filtersUI\":{\"values\":[{\"lookupValue\":\"={{ $json.qr }}\",\"lookupColumn\":\"COUPON\"}]},\"sheetName\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"gid=0\",\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1lnRZodxZSOA0QSuzkAb7ZJcfFfNXpX7NcxMdckMTN90/edit#gid=0\",\"cachedResultName\":\"Foglio1\"},\"documentId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"1lnRZodxZSOA0QSuzkAb7ZJcfFfNXpX7NcxMdckMTN90\",\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1lnRZodxZSOA0QSuzkAb7ZJcfFfNXpX7NcxMdckMTN90/edit?usp=drivesdk\",\"cachedResultName\":\"Coupon\"}},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"JYR6a64Qecd6t8Hb\",\"name\":\"Google Sheets account\"}},\"typeVersion\":4.5},{\"id\":\"da2e62e5-898c-4024-8d85-517b18dcefc3\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-200,280],\"parameters\":{\"width\":360,\"height\":220,\"content\":\"Check if the QR code scan is valid\"},\"typeVersion\":1},{\"id\":\"507dc2ab-a762-49b8-a13a-c9b20c7135d8\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[300,180],\"parameters\":{\"width\":360,\"height\":220,\"content\":\"Check if coupon is valid\"},\"typeVersion\":1},{\"id\":\"f44b5645-1611-4c16-83ac-ee8a4821970b\",\"name\":\"Sticky Note5\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[760,40],\"parameters\":{\"width\":420,\"height\":220,\"content\":\"Enter the lead with the relative coupon on Suite CRM. Change SUITECRMURL, CLIENTSECRET and CLIENTID\"},\"typeVersion\":1},{\"id\":\"ad0a5999-2616-4c7b-8108-6f13e573490b\",\"name\":\"Update coupon used\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[1240,100],\"parameters\":{\"columns\":{\"value\":{\"ID LEAD\":\"={{ $json.data.id }}\",\"USED COUPON?\":\"yes\"},\"schema\":[{\"id\":\"NAME\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"NAME\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"SURNAME\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"SURNAME\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"EMAIL\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"EMAIL\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"PHONE\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"PHONE\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"COUPON\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"COUPON\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"DATE\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"DATE\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"ID LEAD\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"ID LEAD\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"USED COUPON?\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"USED COUPON?\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"row_number\",\"type\":\"string\",\"display\":true,\"removed\":true,\"readOnly\":true,\"required\":false,\"displayName\":\"row_number\",\"defaultMatch\":false,\"canBeUsedToMatch\":true}],\"mappingMode\":\"defineBelow\",\"matchingColumns\":[\"ID LEAD\"],\"attemptToConvertTypes\":false,\"convertFieldsToString\":false},\"options\":{},\"operation\":\"update\",\"sheetName\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"gid=0\",\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1lnRZodxZSOA0QSuzkAb7ZJcfFfNXpX7NcxMdckMTN90/edit#gid=0\",\"cachedResultName\":\"Foglio1\"},\"documentId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"1lnRZodxZSOA0QSuzkAb7ZJcfFfNXpX7NcxMdckMTN90\",\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1lnRZodxZSOA0QSuzkAb7ZJcfFfNXpX7NcxMdckMTN90/edit?usp=drivesdk\",\"cachedResultName\":\"Coupon\"}},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"JYR6a64Qecd6t8Hb\",\"name\":\"Google Sheets account\"}},\"typeVersion\":4.5},{\"id\":\"acd6a7fb-aeae-4baf-8f60-af16715a6de6\",\"name\":\"Sticky Note6\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1560,-380],\"parameters\":{\"width\":220,\"height\":220,\"content\":\"Set the Webhook URL\"},\"typeVersion\":1},{\"id\":\"091a00b6-34bd-4221-b2f1-4d55719a273a\",\"name\":\"Sticky Note7\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-480,-900],\"parameters\":{\"color\":3,\"width\":680,\"height\":240,\"content\":\"## Coupon assignment and simple validation system\\n\\nThis workflow is designed to manage the assignment and validation of unique QR code coupons within a lead generation system. The process begins with a webhook that receives data from a user-filled form, containing information such as name, surname, email, and phone number. This data is then processed to check if the lead already exists in the system, preventing duplicates.\\n\\nDISCLAIMER: The system is very simple and basic but can be improved and made very efficient through specific controls and new implementations\"},\"typeVersion\":1}],\"active\":false,\"pinData\":{},\"settings\":{\"executionOrder\":\"v1\"},\"versionId\":\"00ea32a4-635c-41c0-a789-e7b45efdf193\",\"connections\":{\"If\":{\"main\":[[{\"node\":\"Get Lead\",\"type\":\"main\",\"index\":0}],[{\"node\":\"No coupon\",\"type\":\"main\",\"index\":0}]]},\"Get QR\":{\"main\":[[{\"node\":\"Send Email\",\"type\":\"main\",\"index\":0}]]},\"Webhook\":{\"main\":[[{\"node\":\"Set coupon\",\"type\":\"main\",\"index\":0}]]},\"Get Lead\":{\"main\":[[{\"node\":\"Not used?\",\"type\":\"main\",\"index\":0}]]},\"Not used?\":{\"main\":[[{\"node\":\"Token SuiteCRM 1\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Coupon KO\",\"type\":\"main\",\"index\":0}]]},\"Get Coupon\":{\"main\":[[{\"node\":\"Token SuiteCRM\",\"type\":\"main\",\"index\":0}]]},\"Set coupon\":{\"main\":[[{\"node\":\"If\",\"type\":\"main\",\"index\":0}]]},\"Form Fields\":{\"main\":[[{\"node\":\"Duplicate Lead?\",\"type\":\"main\",\"index\":0}]]},\"Update Lead\":{\"main\":[[{\"node\":\"Update coupon used\",\"type\":\"main\",\"index\":0}]]},\"Update Sheet\":{\"main\":[[{\"node\":\"Get QR\",\"type\":\"main\",\"index\":0}]]},\"Is Duplicate?\":{\"main\":[[],[{\"node\":\"Get Coupon\",\"type\":\"main\",\"index\":0}]]},\"Token SuiteCRM\":{\"main\":[[{\"node\":\"Create Lead SuiteCRM\",\"type\":\"main\",\"index\":0}]]},\"Duplicate Lead?\":{\"main\":[[{\"node\":\"Is Duplicate?\",\"type\":\"main\",\"index\":0}]]},\"Token SuiteCRM 1\":{\"main\":[[{\"node\":\"Update Lead\",\"type\":\"main\",\"index\":0}]]},\"On form submission\":{\"main\":[[{\"node\":\"Form Fields\",\"type\":\"main\",\"index\":0}]]},\"Update coupon used\":{\"main\":[[{\"node\":\"Coupon OK\",\"type\":\"main\",\"index\":0}]]},\"Create Lead SuiteCRM\":{\"main\":[[{\"node\":\"Update Sheet\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "This workflow is designed to manage the assignment and validation of unique QR code coupons within a lead generation system with SuiteCRM.\n\n* * *\n\n### **How it Works**\n\nThis workflow automates the process of assigning unique QR code coupons to leads generated through a form submission, ensuring no duplicates are created, and validating the usage of coupons. Here's how it operates:\n\n  1. **Webhook Trigger** :\n\n     * The workflow starts with a `Webhook` node that listens for incoming requests containing QR code data.\n     * A `Set coupon` node extracts the QR code value from the request parameters.\n  2. **Validation of QR Code** :\n\n     * An `If` node checks if the QR code exists in the incoming data. If it does, the process proceeds; otherwise, a \"No coupon\" response is sent back.\n  3. **Coupon Lookup** :\n\n     * The `Get Lead` node queries a Google Sheets document to check if the QR code corresponds to an existing lead.\n     * A subsequent `Not used?` node verifies whether the coupon has already been used by checking the \"USED COUPON?\" field in the sheet.\n  4. **Lead Duplication Check** :\n\n     * When a new lead submits the form (`On form submission`), the `Duplicate Lead?` node checks if the email already exists in the system to prevent duplicates.\n  5. **Coupon Assignment** :\n\n     * If the lead is not a duplicate, the `Get Coupon` node retrieves an available unassigned coupon from the Google Sheets document.\n     * The `Token SuiteCRM` node generates an access token for SuiteCRM, and the `Create Lead SuiteCRM` node creates a new lead entry in SuiteCRM, associating it with the assigned coupon.\n  6. **QR Code Generation and Email Notification** :\n\n     * The `Get QR` node generates a QR code image URL for the assigned coupon.\n     * The `Send Email` node sends an email to the lead with the QR code attached.\n  7. **Response Handling** :\n\n     * Depending on the validation results, the workflow responds with appropriate messages: \n       * \"Coupon OK\" if the coupon is valid and unused.\n       * \"Coupon KO\" if the coupon has already been used.\n       * \"Coupon not valid\" if the QR code does not exist.\n\n\n\n* * *\n\n### **Set Up Steps**\n\nTo replicate this workflow in your own n8n environment, follow these steps:\n\n  1. **Configuration** :\n\n     * Set up an n8n instance either locally or via cloud services.\n     * Import the provided JSON configuration file into your workspace.\n     * Configure all required credentials, such as: \n       * Google Sheets OAuth2 API for accessing the spreadsheet.\n       * SuiteCRM API credentials (e.g., `SUITECRMURL`, `CLIENTID`, `CLIENTSECRET`).\n       * SMTP credentials for sending emails.\n  2. **Customization** :\n\n     * Adjust the `Webhook` URL to match your deployment environment.\n     * Modify the Google Sheets document ID and sheet name in nodes like `Duplicate Lead?`, `Get Coupon`, `Update Sheet`, and `Update coupon used`.\n     * Update the SuiteCRM API endpoint and credentials in nodes like `Token SuiteCRM` and `Create Lead SuiteCRM`.\n     * Customize the email template in the `Send Email` node to match your branding and messaging requirements.\n     * Ensure the QR code generation URL in the `Get QR` node points to a valid QR code generator service.\n\n\n\nBy following these steps, you can effectively implement and customize this workflow to manage lead generation and coupon assignments in your organization.\n",
  "readme_html": "<!--[--><div data-v-50766329=\"\"><p>This workflow is designed to manage the assignment and validation of unique QR code coupons within a lead generation system with SuiteCRM.</p>\n<hr>\n<h3><strong>How it Works</strong></h3>\n<p>This workflow automates the process of assigning unique QR code coupons to leads generated through a form submission, ensuring no duplicates are created, and validating the usage of coupons. Here's how it operates:</p>\n<ol>\n<li>\n<p><strong>Webhook Trigger</strong>:</p>\n<ul>\n<li>The workflow starts with a <code>Webhook</code> node that listens for incoming requests containing QR code data.</li>\n<li>A <code>Set coupon</code> node extracts the QR code value from the request parameters.</li>\n</ul>\n</li>\n<li>\n<p><strong>Validation of QR Code</strong>:</p>\n<ul>\n<li>An <code>If</code> node checks if the QR code exists in the incoming data. If it does, the process proceeds; otherwise, a \"No coupon\" response is sent back.</li>\n</ul>\n</li>\n<li>\n<p><strong>Coupon Lookup</strong>:</p>\n<ul>\n<li>The <code>Get Lead</code> node queries a Google Sheets document to check if the QR code corresponds to an existing lead.</li>\n<li>A subsequent <code>Not used?</code> node verifies whether the coupon has already been used by checking the \"USED COUPON?\" field in the sheet.</li>\n</ul>\n</li>\n<li>\n<p><strong>Lead Duplication Check</strong>:</p>\n<ul>\n<li>When a new lead submits the form (<code>On form submission</code>), the <code>Duplicate Lead?</code> node checks if the email already exists in the system to prevent duplicates.</li>\n</ul>\n</li>\n<li>\n<p><strong>Coupon Assignment</strong>:</p>\n<ul>\n<li>If the lead is not a duplicate, the <code>Get Coupon</code> node retrieves an available unassigned coupon from the Google Sheets document.</li>\n<li>The <code>Token SuiteCRM</code> node generates an access token for SuiteCRM, and the <code>Create Lead SuiteCRM</code> node creates a new lead entry in SuiteCRM, associating it with the assigned coupon.</li>\n</ul>\n</li>\n<li>\n<p><strong>QR Code Generation and Email Notification</strong>:</p>\n<ul>\n<li>The <code>Get QR</code> node generates a QR code image URL for the assigned coupon.</li>\n<li>The <code>Send Email</code> node sends an email to the lead with the QR code attached.</li>\n</ul>\n</li>\n<li>\n<p><strong>Response Handling</strong>:</p>\n<ul>\n<li>Depending on the validation results, the workflow responds with appropriate messages:\n<ul>\n<li>\"Coupon OK\" if the coupon is valid and unused.</li>\n<li>\"Coupon KO\" if the coupon has already been used.</li>\n<li>\"Coupon not valid\" if the QR code does not exist.</li>\n</ul>\n</li>\n</ul>\n</li>\n</ol>\n<hr>\n<h3><strong>Set Up Steps</strong></h3>\n<p>To replicate this workflow in your own n8n environment, follow these steps:</p>\n<ol>\n<li>\n<p><strong>Configuration</strong>:</p>\n<ul>\n<li>Set up an n8n instance either locally or via cloud services.</li>\n<li>Import the provided JSON configuration file into your workspace.</li>\n<li>Configure all required credentials, such as:\n<ul>\n<li>Google Sheets OAuth2 API for accessing the spreadsheet.</li>\n<li>SuiteCRM API credentials (e.g., <code>SUITECRMURL</code>, <code>CLIENTID</code>, <code>CLIENTSECRET</code>).</li>\n<li>SMTP credentials for sending emails.</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><strong>Customization</strong>:</p>\n<ul>\n<li>Adjust the <code>Webhook</code> URL to match your deployment environment.</li>\n<li>Modify the Google Sheets document ID and sheet name in nodes like <code>Duplicate Lead?</code>, <code>Get Coupon</code>, <code>Update Sheet</code>, and <code>Update coupon used</code>.</li>\n<li>Update the SuiteCRM API endpoint and credentials in nodes like <code>Token SuiteCRM</code> and <code>Create Lead SuiteCRM</code>.</li>\n<li>Customize the email template in the <code>Send Email</code> node to match your branding and messaging requirements.</li>\n<li>Ensure the QR code generation URL in the <code>Get QR</code> node points to a valid QR code generator service.</li>\n</ul>\n</li>\n</ol>\n<p>By following these steps, you can effectively implement and customize this workflow to manage lead generation and coupon assignments in your organization.</p>\n</div><!--]-->",
  "readme_zh": "该工作流旨在通过SuiteCRM管理系统内唯一二维码优惠券的分配与核销流程。\n\n* * *\n\n### **运行原理**\n\n本工作流自动化执行以下流程：为表单提交生成的潜在客户分配唯一二维码优惠券、确保无重复创建、并验证优惠券使用状态。具体运作方式如下：\n\n1. **Webhook触发**  \n   * 工作流始于监听二维码数据请求的`Webhook`节点  \n   * `设置优惠券`节点从请求参数中提取二维码值  \n\n2. **二维码验证**  \n   * `条件判断`节点检查请求是否包含二维码数据。若存在则继续流程，否则返回\"无优惠券\"响应  \n\n3. **优惠券查询**  \n   * `获取潜在客户`节点查询Google表格文档，验证二维码是否关联现有客户  \n   * `未使用？`节点通过检查表格中\"已使用优惠券？\"字段确认优惠券状态  \n\n4. **客户查重机制**  \n   * 当新客户提交表单时（`表单提交时`），`重复客户？`节点校验系统是否已存在相同邮箱  \n\n5. **优惠券分配**  \n   * 若非重复客户，`获取优惠券`节点从Google表格提取可用未分配优惠券  \n   * `SuiteCRM令牌`节点生成访问凭证，`创建SuiteCRM客户`节点在系统中新建客户记录并关联优惠券  \n\n6. **二维码生成与邮件通知**  \n   * `获取二维码`节点生成优惠券对应的二维码图片URL  \n   * `发送邮件`节点向客户发送附带二维码的电子邮件  \n\n7. **响应处理**  \n   * 根据验证结果返回对应消息：  \n     - \"有效优惠券\"（验证通过且未使用）  \n     - \"优惠券已使用\"（已被核销）  \n     - \"无效优惠券\"（二维码不存在）  \n\n* * *\n\n### **配置步骤**\n\n在n8n环境中部署本工作流需执行以下操作：\n\n1. **基础配置**  \n   * 通过本地或云服务搭建n8n实例  \n   * 导入提供的JSON配置文件至工作区  \n   * 配置所有必要凭证，包括：  \n     - 访问电子表格的Google Sheets OAuth2 API  \n     - SuiteCRM API凭证（如`SUITECRMURL`/`CLIENTID`/`CLIENTSECRET`）  \n     - 邮件发送的SMTP凭证  \n\n2. **自定义调整**  \n   * 修改`Webhook`URL以匹配部署环境  \n   * 在`重复客户？`/`获取优惠券`/`更新表格`/`标记已用优惠券`等节点中调整Google表格文档ID和工作表名称  \n   * 在`SuiteCRM令牌`和`创建SuiteCRM客户`节点更新API端点及凭证  \n   * 于`发送邮件`节点定制符合品牌要求的邮件模板  \n   * 确保`获取二维码`节点指向有效的二维码生成服务  \n\n通过上述步骤，即可在机构内实现潜在客户管理与优惠券分配系统的部署与定制。",
  "title_zh": "为SuiteCRM设计的独特二维码优惠券分配与验证系统用于潜在客户开发",
  "publish_date_zh": "最后更新于3个月前",
  "workflow_json_zh": "{\n  \"id\": \"fW6PV9IaePKSMGbN\",\n  \"meta\": {\n    \"instanceId\": \"a4bfc93e975ca233ac45ed7c9227d84cf5a2329310525917adaf3312e10d5462\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"name\": \"Unique QRcode coupon assignment and validation for Lead Generation system\",\n  \"tags\": [],\n  \"nodes\": [\n    {\n      \"id\": \"5ef4dd1d-39d6-487e-a48d-420b458ac1ee\",\n      \"name\": \"Webhook\",\n      \"type\": \"n8n-nodes-base.webhook\",\n      \"position\": [\n        -420,\n        340\n      ],\n      \"webhookId\": \"bb832325-8c58-4717-b866-41f8a9714cf2\",\n      \"parameters\": {\n        \"path\": \"bb832325-8c58-4717-b866-41f8a9714cf2\",\n        \"options\": {},\n        \"responseMode\": \"responseNode\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"a7102d60-d4bd-450d-92b3-a32e2304b4a9\",\n      \"name\": \"If\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        40,\n        340\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"430aee2d-a788-4d7c-ab64-880c900f0058\",\n              \"operator\": {\n                \"type\": \"string\",\n                \"operation\": \"exists\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json.qr }}\",\n              \"rightValue\": \"\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"f9dfd28e-42b5-488a-acde-dbbff95cf72f\",\n      \"name\": \"Token SuiteCRM\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        700,\n        -320\n      ],\n      \"parameters\": {\n        \"url\": \"=https://SUITECRMURL/Api/access_token\",\n        \"options\": {},\n        \"requestMethod\": \"POST\",\n        \"bodyParametersUi\": {\n          \"parameter\": [\n            {\n              \"name\": \"grant_type\",\n              \"value\": \"client_credentials\"\n            },\n            {\n              \"name\": \"client_id\",\n              \"value\": \"CLIENTID\"\n            },\n            {\n              \"name\": \"client_secret\",\n              \"value\": \"CLIENTSECRET\"\n            }\n          ]\n        },\n        \"allowUnauthorizedCerts\": true\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"0e5c7208-a90a-4612-a5eb-f962546320dc\",\n      \"name\": \"Create Lead SuiteCRM\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        940,\n        -320\n      ],\n      \"parameters\": {\n        \"url\": \"https://SUITECRMURL/Api/V8/module\",\n        \"method\": \"POST\",\n        \"options\": {\n          \"response\": {\n            \"response\": {\n              \"responseFormat\": \"json\"\n            }\n          }\n        },\n        \"jsonBody\": \"={\\\"data\\\": \\n  {\\n  \\\"type\\\": \\\"Leads\\\",\\n  \\\"attributes\\\": { \\n  \\\"first_name\\\": \\\"{{ $('Form Fields').item.json.Name }}\\\",\\n  \\\"last_name\\\": \\\"{{ $('Form Fields').item.json.Surname }}\\\",\\n  \\\"email1\\\": \\\"{{ $('Form Fields').item.json.Email }}\\\",\\n  \\\"phone_mobile\\\":\\\"{{ $('Form Fields').item.json.Phone }}\\\",\\n  \\\"coupon_c\\\": \\\"{{ $('Get Coupon').item.json.COUPON }}\\\"\\n  }\\n  }\\n}\",\n        \"sendBody\": true,\n        \"sendHeaders\": true,\n        \"specifyBody\": \"json\",\n        \"headerParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"Authorization\",\n              \"value\": \"=Bearer {{$node[\\\"Token SuiteCRM\\\"].json[\\\"access_token\\\"]}}\"\n            },\n            {\n              \"name\": \"Content-Type\",\n              \"value\": \"application/vnd.api+json\"\n            }\n          ]\n        }\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"e9191ab8-4fb8-40bb-b676-89ac4e58b2dc\",\n      \"name\": \"On form submission\",\n      \"type\": \"n8n-nodes-base.formTrigger\",\n      \"position\": [\n        -420,\n        -420\n      ],\n      \"webhookId\": \"63d1d84b-c41e-4d3d-961a-0aa2af830ceb\",\n      \"parameters\": {\n        \"options\": {},\n        \"formTitle\": \"Landing\",\n        \"formFields\": {\n          \"values\": [\n            {\n              \"fieldLabel\": \"Name\",\n              \"placeholder\": \"Name\",\n              \"requiredField\": true\n            },\n            {\n              \"fieldLabel\": \"Surname\",\n              \"placeholder\": \"Surname\",\n              \"requiredField\": true\n            },\n            {\n              \"fieldType\": \"email\",\n              \"fieldLabel\": \"Email\",\n              \"placeholder\": \"Email\",\n              \"requiredField\": true\n            },\n            {\n              \"fieldLabel\": \"Phone\",\n              \"placeholder\": \"Phone\",\n              \"requiredField\": true\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"4f61d7df-aeb3-4e8d-b30b-8396944e93a3\",\n      \"name\": \"Duplicate Lead?\",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"position\": [\n        20,\n        -420\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"filtersUI\": {\n          \"values\": [\n            {\n              \"lookupValue\": \"={{ $json.Email }}\",\n              \"lookupColumn\": \"EMAIL\"\n            }\n          ]\n        },\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"gid=0\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1lnRZodxZSOA0QSuzkAb7ZJcfFfNXpX7NcxMdckMTN90/edit#gid=0\",\n          \"cachedResultName\": \"Foglio1\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"1lnRZodxZSOA0QSuzkAb7ZJcfFfNXpX7NcxMdckMTN90\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1lnRZodxZSOA0QSuzkAb7ZJcfFfNXpX7NcxMdckMTN90/edit?usp=drivesdk\",\n          \"cachedResultName\": \"Coupon\"\n        }\n      },\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"JYR6a64Qecd6t8Hb\",\n          \"name\": \"Google Sheets account\"\n        }\n      },\n      \"typeVersion\": 4.5,\n      \"alwaysOutputData\": true\n    },\n    {\n      \"id\": \"393372b3-3aaf-4500-a795-0c0f47ea9625\",\n      \"name\": \"Form Fields\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        -180,\n        -420\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"661d1475-f964-4a12-bfe7-88bf96851319\",\n              \"name\": \"Name\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.Name }}\"\n            },\n            {\n              \"id\": \"9991645d-c716-47db-80d6-850f3d64c782\",\n              \"name\": \"Surname\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.Surname }}\"\n            },\n            {\n              \"id\": \"c999afa6-2ec7-4f7f-bf3b-088a3597591c\",\n              \"name\": \"Email\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.Email }}\"\n            },\n            {\n              \"id\": \"f3faccdb-2412-4363-a0e3-f13b8f85b242\",\n              \"name\": \"Phone\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.Phone }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"40d47841-6fb6-4339-b101-a8e917791229\",\n      \"name\": \"Get Coupon\",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"position\": [\n        480,\n        -320\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"returnFirstMatch\": true\n        },\n        \"filtersUI\": {\n          \"values\": [\n            {\n              \"lookupColumn\": \"ID LEAD\"\n            }\n          ]\n        },\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"gid=0\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1lnRZodxZSOA0QSuzkAb7ZJcfFfNXpX7NcxMdckMTN90/edit#gid=0\",\n          \"cachedResultName\": \"Foglio1\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"1lnRZodxZSOA0QSuzkAb7ZJcfFfNXpX7NcxMdckMTN90\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1lnRZodxZSOA0QSuzkAb7ZJcfFfNXpX7NcxMdckMTN90/edit?usp=drivesdk\",\n          \"cachedResultName\": \"Coupon\"\n        }\n      },\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"JYR6a64Qecd6t8Hb\",\n          \"name\": \"Google Sheets account\"\n        }\n      },\n      \"executeOnce\": false,\n      \"typeVersion\": 4.5\n    },\n    {\n      \"id\": \"16358f58-eb7c-4fe5-a0aa-960943a7bebd\",\n      \"name\": \"Update Sheet\",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"position\": [\n        1180,\n        -320\n      ],\n      \"parameters\": {\n        \"columns\": {\n          \"value\": {\n            \"DATE\": \"={{ $now.format('dd/LL/yyyy HH:mm:ss') }}\",\n            \"NAME\": \"={{ $json.data.attributes.first_name }}\",\n            \"EMAIL\": \"={{ $json.data.attributes.email1 }}\",\n            \"PHONE\": \"={{ $json.data.attributes.phone_mobile }}\",\n            \"COUPON\": \"={{ $('Get Coupon').item.json.COUPON }}\",\n            \"ID LEAD\": \"={{ $json.data.id }}\",\n            \"SURNAME\": \"={{ $json.data.attributes.last_name }}\"\n          },\n          \"schema\": [\n            {\n              \"id\": \"NAME\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"NAME\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"SURNAME\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"SURNAME\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"EMAIL\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"EMAIL\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"PHONE\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"PHONE\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"COUPON\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"COUPON\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"DATE\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"DATE\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"ID LEAD\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"ID LEAD\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"row_number\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": true,\n              \"readOnly\": true,\n              \"required\": false,\n              \"displayName\": \"row_number\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            }\n          ],\n          \"mappingMode\": \"defineBelow\",\n          \"matchingColumns\": [\n            \"COUPON\"\n          ],\n          \"attemptToConvertTypes\": false,\n          \"convertFieldsToString\": false\n        },\n        \"options\": {},\n        \"operation\": \"update\",\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"gid=0\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1lnRZodxZSOA0QSuzkAb7ZJcfFfNXpX7NcxMdckMTN90/edit#gid=0\",\n          \"cachedResultName\": \"Foglio1\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"1lnRZodxZSOA0QSuzkAb7ZJcfFfNXpX7NcxMdckMTN90\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1lnRZodxZSOA0QSuzkAb7ZJcfFfNXpX7NcxMdckMTN90/edit?usp=drivesdk\",\n          \"cachedResultName\": \"Coupon\"\n        }\n      },\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"JYR6a64Qecd6t8Hb\",\n          \"name\": \"Google Sheets account\"\n        }\n      },\n      \"typeVersion\": 4.5\n    },\n    {\n      \"id\": \"36025b8c-41cb-4827-bf0e-ec6f692c13df\",\n      \"name\": \"Is Duplicate?\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        220,\n        -420\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"9e3a8422-14f1-453e-bfed-4feecff34662\",\n              \"operator\": {\n                \"type\": \"string\",\n                \"operation\": \"notEmpty\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json.EMAIL }}\",\n              \"rightValue\": \"={{ $('Form Fields').item.json.email }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"e2267b93-9396-4ebf-8307-f8c98c1c3d65\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -200,\n        -500\n      ],\n      \"parameters\": {\n        \"width\": 340,\n        \"height\": 240,\n        \"content\": \"检查该潜在客户是否已收到优惠券\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"a8af825a-4e26-4660-8a9e-f7ce3ba33b3a\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        440,\n        -380\n      ],\n      \"parameters\": {\n        \"width\": 180,\n        \"height\": 220,\n        \"content\": \"找到第一个可用的未分配优惠券\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"dd868852-5b0f-4b5b-922f-f70b8a6da01e\",\n      \"name\": \"Sticky Note4\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        680,\n        -380\n      ],\n      \"parameters\": {\n        \"width\": 400,\n        \"height\": 220,\n        \"content\": \"在Suite CRM中使用相关优惠券进入线索。替换SUITECRMURL、CLIENTSECRET和CLIENTID。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"d2c26f3a-496e-47d6-b3f6-1aea5d0293fa\",\n      \"name\": \"Get QR\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1400,\n        -320\n      ],\n      \"parameters\": {\n        \"url\": \"=https://quickchart.io/qr?text=https://n8n.n3witalia.com/webhook-test/bb832325-8c58-4717-b866-41f8a9714cf2?qr={{ $('Get Coupon').item.json.COUPON }}&size=250\",\n        \"options\": {}\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"371fa5e5-6f91-4236-83d4-81f579d7d2ab\",\n      \"name\": \"Send Email\",\n      \"type\": \"n8n-nodes-base.emailSend\",\n      \"position\": [\n        1620,\n        -320\n      ],\n      \"webhookId\": \"a84b051c-7d5f-4c17-bac6-68a9df9fa7c7\",\n      \"parameters\": {\n        \"html\": \"=<!DOCTYPE html>\\n<html>\\n<head>\\n    <meta charset=\\\"UTF-8\\\">\\n    <title>Exclusive Discount Coupon</title>\\n</head>\\n<body style=\\\"font-family: Arial, sans-serif; text-align: center;\\\">\\n    <h2>Get Your Exclusive Discount!</h2>\\n    <p>Hi {{ $('On form submission').item.json.Name }},<br>\\n    Scan the QR code below to claim your special discount.</p>\\n    \\n    <img src=\\\"https://quickchart.io/qr?text=https://n8n.n3witalia.com/webhook-test/bb832325-8c58-4717-b866-41f8a9714cf2?qr={{ $('Get Coupon').item.json.COUPON }}&size=250\\\" alt=\\\"Scan to get your discount\\\" style=\\\"margin: 20px;\\\">\\n    \\n    <p>Hurry, the offer is limited!</p>\\n</body>\\n</html>\\n\",\n        \"options\": {},\n        \"subject\": \"[n8n] Exclusive Discount Coupon\",\n        \"toEmail\": \"={{ $('Form Fields').item.json.Email }}\",\n        \"fromEmail\": \"=EMAILFROM\"\n      },\n      \"credentials\": {\n        \"smtp\": {\n          \"id\": \"hRjP3XbDiIQqvi7x\",\n          \"name\": \"SMTP info@n3witalia.com\"\n        }\n      },\n      \"typeVersion\": 2.1\n    },\n    {\n      \"id\": \"5893bd1d-762d-4337-8392-6d358002845a\",\n      \"name\": \"Update Lead\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1020,\n        100\n      ],\n      \"parameters\": {\n        \"url\": \"=https://suitecrm.dev.n3witalia.com/Api/V8/module\",\n        \"method\": \"PATCH\",\n        \"options\": {\n          \"response\": {\n            \"response\": {\n              \"responseFormat\": \"json\"\n            }\n          }\n        },\n        \"jsonBody\": \"={\\n  \\\"data\\\": {\\n    \\\"type\\\": \\\"Leads\\\",\\n    \\\"id\\\": \\\"{{ $('Not used?').item.json['ID LEAD'] }}\\\",\\n    \\\"attributes\\\": {\\n      \\\"coupon_used_c\\\": \\\"yes\\\"\\n    }\\n  }\\n}\",\n        \"sendBody\": true,\n        \"sendHeaders\": true,\n        \"specifyBody\": \"json\",\n        \"headerParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"Authorization\",\n              \"value\": \"=Bearer {{$node[\\\"Token SuiteCRM 1\\\"].json[\\\"access_token\\\"]}}\"\n            },\n            {\n              \"name\": \"Content-Type\",\n              \"value\": \"application/vnd.api+json\"\n            }\n          ]\n        }\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"fd0a43f4-a3f1-4008-947c-f8208d2126f7\",\n      \"name\": \"Not used?\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        540,\n        240\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"50546d87-ab37-4c8a-b835-e1a60f3aa0dc\",\n              \"operator\": {\n                \"type\": \"string\",\n                \"operation\": \"empty\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json['USED COUPON?'] }}\",\n              \"rightValue\": \"\"\n            },\n            {\n              \"id\": \"025a42b8-fb90-44a8-951a-0e321b42c3b9\",\n              \"operator\": {\n                \"type\": \"number\",\n                \"operation\": \"exists\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json.row_number }}\",\n              \"rightValue\": \"\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"0029c366-aec1-4305-aab5-2ab6845e2828\",\n      \"name\": \"Coupon OK\",\n      \"type\": \"n8n-nodes-base.respondToWebhook\",\n      \"position\": [\n        1480,\n        100\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"respondWith\": \"text\",\n        \"responseBody\": \"Qr valid!\"\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"4c326412-0965-4f1c-9b77-2704d37a7151\",\n      \"name\": \"No coupon\",\n      \"type\": \"n8n-nodes-base.respondToWebhook\",\n      \"position\": [\n        320,\n        460\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"responseCode\": 200\n        },\n        \"respondWith\": \"text\",\n        \"responseBody\": \"Coupon not valid\"\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"e18cf9e7-584d-4f49-88b8-4c3a513ff613\",\n      \"name\": \"Coupon KO\",\n      \"type\": \"n8n-nodes-base.respondToWebhook\",\n      \"position\": [\n        800,\n        320\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"responseCode\": 200\n        },\n        \"respondWith\": \"text\",\n        \"responseBody\": \"Coupon already used\"\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"55a63a65-5472-4e50-8150-604c6bc9dd18\",\n      \"name\": \"Token SuiteCRM 1\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        800,\n        100\n      ],\n      \"parameters\": {\n        \"url\": \"=https://SUITECRMURL/Api/access_token\",\n        \"options\": {},\n        \"requestMethod\": \"POST\",\n        \"bodyParametersUi\": {\n          \"parameter\": [\n            {\n              \"name\": \"grant_type\",\n              \"value\": \"client_credentials\"\n            },\n            {\n              \"name\": \"client_id\",\n              \"value\": \"CLIENTID\"\n            },\n            {\n              \"name\": \"client_secret\",\n              \"value\": \"CLIENTSECRET\"\n            }\n          ]\n        },\n        \"allowUnauthorizedCerts\": true\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"c843c9f2-9940-423c-bc9d-8530fb43f229\",\n      \"name\": \"Set coupon\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        -180,\n        340\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"4e9a4330-d654-410f-9b99-aa57545c2c80\",\n              \"name\": \"qr\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.query.qr }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"9a2d877d-9016-460e-b376-ea27c59a492a\",\n      \"name\": \"Get Lead\",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"position\": [\n        320,\n        240\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"returnFirstMatch\": true\n        },\n        \"filtersUI\": {\n          \"values\": [\n            {\n              \"lookupValue\": \"={{ $json.qr }}\",\n              \"lookupColumn\": \"COUPON\"\n            }\n          ]\n        },\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"gid=0\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1lnRZodxZSOA0QSuzkAb7ZJcfFfNXpX7NcxMdckMTN90/edit#gid=0\",\n          \"cachedResultName\": \"Foglio1\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"1lnRZodxZSOA0QSuzkAb7ZJcfFfNXpX7NcxMdckMTN90\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1lnRZodxZSOA0QSuzkAb7ZJcfFfNXpX7NcxMdckMTN90/edit?usp=drivesdk\",\n          \"cachedResultName\": \"Coupon\"\n        }\n      },\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"JYR6a64Qecd6t8Hb\",\n          \"name\": \"Google Sheets account\"\n        }\n      },\n      \"typeVersion\": 4.5\n    },\n    {\n      \"id\": \"da2e62e5-898c-4024-8d85-517b18dcefc3\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -200,\n        280\n      ],\n      \"parameters\": {\n        \"width\": 360,\n        \"height\": 220,\n        \"content\": \"检查二维码扫描是否有效\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"507dc2ab-a762-49b8-a13a-c9b20c7135d8\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        300,\n        180\n      ],\n      \"parameters\": {\n        \"width\": 360,\n        \"height\": 220,\n        \"content\": \"检查优惠券是否有效\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"f44b5645-1611-4c16-83ac-ee8a4821970b\",\n      \"name\": \"Sticky Note5\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        760,\n        40\n      ],\n      \"parameters\": {\n        \"width\": 420,\n        \"height\": 220,\n        \"content\": \"在Suite CRM中使用相关优惠券录入潜在客户。请替换SUITECRMURL、CLIENTSECRET和CLIENTID。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"ad0a5999-2616-4c7b-8108-6f13e573490b\",\n      \"name\": \"Update coupon used\",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"position\": [\n        1240,\n        100\n      ],\n      \"parameters\": {\n        \"columns\": {\n          \"value\": {\n            \"ID LEAD\": \"={{ $json.data.id }}\",\n            \"USED COUPON?\": \"yes\"\n          },\n          \"schema\": [\n            {\n              \"id\": \"NAME\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"NAME\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"SURNAME\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"SURNAME\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"EMAIL\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"EMAIL\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"PHONE\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"PHONE\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"COUPON\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"COUPON\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"DATE\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"DATE\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"ID LEAD\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"ID LEAD\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"USED COUPON?\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"USED COUPON?\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"row_number\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": true,\n              \"readOnly\": true,\n              \"required\": false,\n              \"displayName\": \"row_number\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            }\n          ],\n          \"mappingMode\": \"defineBelow\",\n          \"matchingColumns\": [\n            \"ID LEAD\"\n          ],\n          \"attemptToConvertTypes\": false,\n          \"convertFieldsToString\": false\n        },\n        \"options\": {},\n        \"operation\": \"update\",\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"gid=0\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1lnRZodxZSOA0QSuzkAb7ZJcfFfNXpX7NcxMdckMTN90/edit#gid=0\",\n          \"cachedResultName\": \"Foglio1\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"1lnRZodxZSOA0QSuzkAb7ZJcfFfNXpX7NcxMdckMTN90\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1lnRZodxZSOA0QSuzkAb7ZJcfFfNXpX7NcxMdckMTN90/edit?usp=drivesdk\",\n          \"cachedResultName\": \"Coupon\"\n        }\n      },\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"JYR6a64Qecd6t8Hb\",\n          \"name\": \"Google Sheets account\"\n        }\n      },\n      \"typeVersion\": 4.5\n    },\n    {\n      \"id\": \"acd6a7fb-aeae-4baf-8f60-af16715a6de6\",\n      \"name\": \"Sticky Note6\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1560,\n        -380\n      ],\n      \"parameters\": {\n        \"width\": 220,\n        \"height\": 220,\n        \"content\": \"设置Webhook网址\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"091a00b6-34bd-4221-b2f1-4d55719a273a\",\n      \"name\": \"Sticky Note7\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -480,\n        -900\n      ],\n      \"parameters\": {\n        \"color\": 3,\n        \"width\": 680,\n        \"height\": 240,\n        \"content\": \"## 优惠券分配与简易核销系统\\n\\n该工作流专为管理潜客开发系统中的唯一二维码优惠券分配与核销而设计。流程始于一个接收用户填写表单数据的网络钩子，所收集信息包括姓名、姓氏、电子邮箱及电话号码等。系统随后会处理这些数据以核查该潜客是否已存在于系统中，从而避免重复记录。\\n\\n免责声明：本系统虽设计简单基础，但可通过特定管控措施及新功能实现进行优化，从而显著提升运行效率\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"active\": false,\n  \"pinData\": {},\n  \"settings\": {\n    \"executionOrder\": \"v1\"\n  },\n  \"versionId\": \"00ea32a4-635c-41c0-a789-e7b45efdf193\",\n  \"connections\": {\n    \"If\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get Lead\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"No coupon\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get QR\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Send Email\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Webhook\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Set coupon\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get Lead\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Not used?\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Not used?\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Token SuiteCRM 1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Coupon KO\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get Coupon\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Token SuiteCRM\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Set coupon\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"If\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Form Fields\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Duplicate Lead?\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Update Lead\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Update coupon used\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Update Sheet\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get QR\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Is Duplicate?\": {\n      \"main\": [\n        [],\n        [\n          {\n            \"node\": \"Get Coupon\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Token SuiteCRM\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Create Lead SuiteCRM\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Duplicate Lead?\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Is Duplicate?\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Token SuiteCRM 1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Update Lead\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"On form submission\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Form Fields\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Update coupon used\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Coupon OK\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Create Lead SuiteCRM\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Update Sheet\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}