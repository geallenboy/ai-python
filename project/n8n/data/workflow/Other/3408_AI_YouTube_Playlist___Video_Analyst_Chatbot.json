{
  "title": "AI YouTube Playlist & Video Analyst Chatbot",
  "url": "https://n8n.io/workflows/3408-ai-youtube-playlist-and-video-analyst-chatbot/",
  "category": "Other",
  "category_url": "https://n8n.io/workflows/categories/other/?sort=createdAt:desc",
  "author": "dmr",
  "publish_date": "Last update a month ago",
  "publish_date_absolute": "",
  "content": "",
  "workflow_json": "{\"id\":\"4Tq5HZBdETVe7jEb\",\"meta\":{\"instanceId\":\"2cb7a61f866faf57392b91b31f47e08a2b3640258f0abd08dd71f087f3243a5a\",\"templateCredsSetupCompleted\":true},\"name\":\"⚡AI-Powered YouTube Playlist & Video Summarization and Analysis v2\",\"tags\":[],\"nodes\":[{\"id\":\"505077d1-a2e4-4b0d-99d6-756940022c3d\",\"name\":\"Google Gemini Chat Model1\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatGoogleGemini\",\"position\":[-440,-40],\"parameters\":{\"options\":{},\"modelName\":\"models/gemini-2.0-pro-exp\"},\"credentials\":{\"googlePalmApi\":{\"id\":\"2zwuT5znDglBrUCO\",\"name\":\"Google Gemini(PaLM) Api account\"}},\"typeVersion\":1},{\"id\":\"5da369db-b801-4653-888d-0e6042620298\",\"name\":\"Handle Queries\",\"type\":\"@n8n/n8n-nodes-langchain.agent\",\"position\":[-160,-280],\"parameters\":{\"text\":\"={{ $('Chat').item.json.chatInput }}\",\"options\":{\"systemMessage\":\"=You are an intelligent assistant that can respond to queries related to the content of a Youtube Playlist or a single Video.\\n\\n# YOUR TASK\\nDecide if the user has provided the info required and reply accordingly. If there is no url in context you have to suggest the user to provide one. \\n\\n\\n1. If the user provided a YouTube Playlist or Video URL: reply in structured markdown format to the user based on the formulated questions and context. Assume the user is here because they don't won't / have time to watch such videos so:\\n- Use the tool called `chat_playlist_data`, which can analyze YouTube videos. Use this tool effectively to process video content and generate structured summaries.\\n- Your answers needs to be exhaustive and minimise bullet points\\n- Be verbose in your response\\n\\n2. 1. If the user provided a YouTube Playlist or Video URL:\\n- Do not ask for more specific details - always try to summarize the videos with the data from the tool `chat_playlist_data`\\n- Never reply \\\"already provided a detailed summary\\\" - always try to summarize again the videos with more info from the tool `chat_playlist_data` - even if you have already provided the data before (so repeat yourself).\\n\\n3. If the user HAS NOT provided a YouTube Playlist URL or a invaid URL: gently invite the user to provide the URL so you can process it. \\n\\n# Rules\\n\\n## YouTube Playlist URL Definition\\n- A URL from www.youtube.com or youtube.com.\\n- Contains the query parameter `list=` followed by a playlist ID.\\n- Example: https://www.youtube.com/playlist?list=PLXXXXXX (where PLXXXXXX is the playlist ID).\\n\\n## YouTube Video URL Definition\\n- A URL from www.youtube.com, youtube.com, or youtu.be.\\n- For www.youtube.com or youtube.com, it contains the query parameter `v=` followed by a video ID.\\n- For youtu.be, it follows the format https://youtu.be/VIDEO_ID.\\n- Examples:\\n  - https://www.youtube.com/watch?v=VIDEO_ID (where VIDEO_ID is the video ID).\\n  - https://youtu.be/VIDEO_ID\\n- Does NOT have a query parameter `list=`\\n\\n# Context\\n{\\n  \\\"intent\\\": {{ $('Default Intent').item.json.output?.intent || \\\"NONE\\\" }},\\n  \\\"url\\\": {{ $('Default Intent').item.json.output?.url || \\\"\\\" }},\\n  \\\"id\\\": {{ $('Default Intent').item.json.output?.id || \\\"\\\" }},\\n  \\\"limit\\\": {{ $('Default Intent').item.json.output?.limit || 0 }},\\n  \\\"status\\\": {{ $('Default Intent').item.json.output?.status || 'PENDING' }}\\n}\"},\"promptType\":\"define\"},\"typeVersion\":1.7},{\"id\":\"866bf387-3482-4615-94d5-fd72d5db21da\",\"name\":\"Split Out\",\"type\":\"n8n-nodes-base.splitOut\",\"position\":[1380,-200],\"parameters\":{\"include\":\"selectedOtherFields\",\"options\":{},\"fieldToSplitOut\":\"transcript\",\"fieldsToInclude\":\"youtubeId\"},\"typeVersion\":1},{\"id\":\"359404ce-4bc9-4e4d-9a26-22b9f9b176c9\",\"name\":\"Summarize & Analyze Transcript\",\"type\":\"@n8n/n8n-nodes-langchain.chainLlm\",\"position\":[660,540],\"parameters\":{\"text\":\"=Please analyze the given text and create a structured summary following these guidelines:\\n\\n1. Break down the content into main topics using Level 2 headers (##)\\n2. Under each header:\\n   - List only the most essential concepts and key points\\n   - Use bullet points for clarity\\n   - Keep explanations concise\\n   - Preserve technical accuracy\\n   - Highlight key terms in bold\\n3. Format requirements:\\n   - Use markdown formatting\\n   - Keep bullet points simple (no nesting)\\n   - Bold important terms using **term**\\n   - Use tables for comparisons\\n   - Include relevant technical details\\n\\nPlease provide a clear, structured summary that captures the core concepts while maintaining technical accuracy.\\n\\n**Make sure the summary is 300-400 max characters long.**\\n\\nInclude metadata such as video number, id, and title in the summary.\\n\\n**Here is the text**\\n\\nVideo number: {{ $json.video_number }}\\nTitle: {{ $json.title }}\\nYoutube ID: {{ $json.youtubeId }}\\nTranscript:\\n{{ $json.transcript_text }}\",\"promptType\":\"define\"},\"typeVersion\":1.4},{\"id\":\"036765df-6da4-4430-bcea-af4066fb7c24\",\"name\":\"Concatenate\",\"type\":\"n8n-nodes-base.summarize\",\"position\":[1700,-200],\"parameters\":{\"options\":{},\"fieldsToSplitBy\":\"youtubeId\",\"fieldsToSummarize\":{\"values\":[{\"field\":\"transcript.text\",\"separateBy\":\" \",\"aggregation\":\"concatenate\"}]}},\"typeVersion\":1},{\"id\":\"9152725c-15ca-41a0-8f98-108834e0c8be\",\"name\":\"Split Out1\",\"type\":\"n8n-nodes-base.splitOut\",\"position\":[660,40],\"parameters\":{\"options\":{},\"fieldToSplitOut\":\"videos\"},\"typeVersion\":1},{\"id\":\"fee0e045-614a-41f0-ac75-051dff773e77\",\"name\":\"Limit\",\"type\":\"n8n-nodes-base.limit\",\"position\":[860,40],\"parameters\":{\"maxItems\":\"={{ $('Update Context Intent').item.json.output.limit }}\"},\"typeVersion\":1},{\"id\":\"a691c1c7-d8c4-4eab-861b-f7cfcbeb0fc8\",\"name\":\"Qdrant Vector Store\",\"type\":\"@n8n/n8n-nodes-langchain.vectorStoreQdrant\",\"position\":[1680,480],\"parameters\":{\"mode\":\"insert\",\"options\":{},\"qdrantCollection\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"={{ $('Update Context Intent').first().json.output.id }}\"}},\"credentials\":{\"qdrantApi\":{\"id\":\"mb8rw8tmUeP6aPJm\",\"name\":\"QdrantApi account\"}},\"typeVersion\":1},{\"id\":\"c3949e8f-0deb-4106-aaa5-e64403024243\",\"name\":\"Recursive Character Text Splitter\",\"type\":\"@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter\",\"position\":[1800,860],\"parameters\":{\"options\":{},\"chunkSize\":1200,\"chunkOverlap\":200},\"typeVersion\":1},{\"id\":\"a3b23c6b-14c0-4805-8220-7c6166268276\",\"name\":\"Embeddings Google Gemini\",\"type\":\"@n8n/n8n-nodes-langchain.embeddingsGoogleGemini\",\"position\":[1660,700],\"parameters\":{\"modelName\":\"models/text-embedding-004\"},\"credentials\":{\"googlePalmApi\":{\"id\":\"2zwuT5znDglBrUCO\",\"name\":\"Google Gemini(PaLM) Api account\"}},\"typeVersion\":1},{\"id\":\"6f4ee00d-dcdc-4468-9713-115912c1e571\",\"name\":\"Google Gemini Chat Model2\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatGoogleGemini\",\"position\":[640,740],\"parameters\":{\"options\":{},\"modelName\":\"models/gemini-2.0-flash\"},\"credentials\":{\"googlePalmApi\":{\"id\":\"2zwuT5znDglBrUCO\",\"name\":\"Google Gemini(PaLM) Api account\"}},\"typeVersion\":1},{\"id\":\"75442631-512e-4b0e-a5a8-ed3e3a3e1f94\",\"name\":\"Embeddings Google Gemini1\",\"type\":\"@n8n/n8n-nodes-langchain.embeddingsGoogleGemini\",\"position\":[-120,320],\"parameters\":{\"modelName\":\"models/text-embedding-004\"},\"credentials\":{\"googlePalmApi\":{\"id\":\"2zwuT5znDglBrUCO\",\"name\":\"Google Gemini(PaLM) Api account\"}},\"typeVersion\":1},{\"id\":\"c33ceeca-9bf0-4dd2-b8df-fc2a1ccdf512\",\"name\":\"Chat\",\"type\":\"@n8n/n8n-nodes-langchain.chatTrigger\",\"position\":[-2780,-460],\"webhookId\":\"e66183cc-1eed-4968-b34b-bcecf1bb55e8\",\"parameters\":{\"public\":true,\"options\":{\"loadPreviousSession\":\"notSupported\"},\"initialMessages\":\"Hi there! 👋\\nPlease provide a URL of a Youtube playlist you would like me to analise.\"},\"typeVersion\":1.1},{\"id\":\"06bb2dfd-027c-4902-9559-2de080f6c145\",\"name\":\"Video Titles\",\"type\":\"n8n-nodes-base.splitOut\",\"position\":[1160,40],\"parameters\":{\"options\":{},\"fieldToSplitOut\":\"id,title\"},\"typeVersion\":1},{\"id\":\"d9bbdda2-ef26-4b6c-94d0-7542f88f1530\",\"name\":\"Merge\",\"type\":\"n8n-nodes-base.merge\",\"position\":[1700,20],\"parameters\":{\"mode\":\"combineBySql\",\"query\":\"SELECT \\n  ROW_NUMBER() AS video_number,\\n  input1.youtubeId, input2.title, input1.concatenated_transcript_text as transcript_text FROM input1 LEFT JOIN input2 ON input1.youtubeId = input2.id\"},\"typeVersion\":3},{\"id\":\"e6febdb9-370b-478d-b470-d6c2d3314d7b\",\"name\":\"Edit Fields\",\"type\":\"n8n-nodes-base.set\",\"position\":[980,540],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"b5e935c5-4973-40a3-adb9-fa76904d2ed9\",\"name\":\"video_number\",\"type\":\"number\",\"value\":\"={{ $('Merge').item.json.video_number }}\"},{\"id\":\"e98f417d-123f-4a85-b2f7-64430e7b0250\",\"name\":\"youtubeId\",\"type\":\"string\",\"value\":\"={{ $('Merge').item.json.youtubeId }}\"},{\"id\":\"d0ced7fd-c9a3-4a09-bf09-e4b5e45dd03d\",\"name\":\"title\",\"type\":\"string\",\"value\":\"={{ $('Merge').item.json.title }}\"},{\"id\":\"31a80e6d-9b02-4d21-b888-1a00c036a04b\",\"name\":\"summary\",\"type\":\"string\",\"value\":\"={{ $json.text }}\"},{\"id\":\"ef12f3f2-3d63-4e78-835f-7da004393a07\",\"name\":\"transcript_text\",\"type\":\"string\",\"value\":\"={{ $('Merge').item.json.transcript_text }}\"},{\"id\":\"afa841e2-6f8b-4b27-9f28-10368ee32c2e\",\"name\":\"playlistId\",\"type\":\"string\",\"value\":\"={{ $('Update Context Intent').first().json.output.id }}\"}]}},\"typeVersion\":3.4},{\"id\":\"2736a1e6-a982-4f60-aa8d-658e9a3e9193\",\"name\":\"AI Agent\",\"type\":\"@n8n/n8n-nodes-langchain.agent\",\"position\":[2720,480],\"parameters\":{\"text\":\"=Please analyze the given \\\"Transcript summary\\\" and create a full summary overview, following the below guidelines.\\n\\n1. Provide a full descriptive break down of the content of each video. Assume the user does not won't or have time to watch such videos, so:\\n- Your summary needs to be exhaustive, descriptive, and minimise bullet points\\n- Your summary needs to captures all the core concepts while maintaining technical accuracy\\n- Your summary will be verbose\\n\\n2. Consider that the intent of the user is not to watch the videos but rather have all the content required and summaries from on the \\\"Transcript summary\\\".\\n\\n3. Use the tool called `chat_playlist_data`, which can analyze YouTube videos. Use this tool effectively to process video content and generate structured summaries.\\n\\nUser message:\\n{{ $('Chat').item.json.chatInput }}\\n\\nTranscript summary:\\n{{ $('Full Summary').item.json.concatenated_summary }}\",\"agent\":\"conversationalAgent\",\"options\":{},\"promptType\":\"define\"},\"executeOnce\":true,\"typeVersion\":1.7},{\"id\":\"cf1e5c50-9c89-465f-beca-482cbd9affba\",\"name\":\"Google Gemini Chat Model4\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatGoogleGemini\",\"position\":[2520,720],\"parameters\":{\"options\":{},\"modelName\":\"models/gemini-2.0-flash\"},\"credentials\":{\"googlePalmApi\":{\"id\":\"2zwuT5znDglBrUCO\",\"name\":\"Google Gemini(PaLM) Api account\"}},\"typeVersion\":1},{\"id\":\"1cbcec5e-b58c-4fce-b944-08c47a7385db\",\"name\":\"Delete Collection\",\"type\":\"n8n-nodes-base.httpRequest\",\"onError\":\"continueRegularOutput\",\"position\":[1340,480],\"parameters\":{\"url\":\"=https://3114dbb7-bd13-4807-8815-c3c8784f66d6.eu-west-1-0.aws.cloud.qdrant.io/collections/{{ $('Update Context Intent').first().json.playlistID }}/points/delete\",\"method\":\"POST\",\"options\":{},\"jsonBody\":\"{\\n  \\\"filter\\\": {}\\n}\",\"sendBody\":true,\"sendHeaders\":true,\"specifyBody\":\"json\",\"authentication\":\"predefinedCredentialType\",\"headerParameters\":{\"parameters\":[{\"name\":\"Content-Type\",\"value\":\"application/json\"}]},\"nodeCredentialType\":\"qdrantApi\"},\"credentials\":{\"qdrantApi\":{\"id\":\"mb8rw8tmUeP6aPJm\",\"name\":\"QdrantApi account\"}},\"executeOnce\":true,\"typeVersion\":4.2},{\"id\":\"16d7eaec-1d98-42dd-89aa-2681a9d1697d\",\"name\":\"Default Data Loader\",\"type\":\"@n8n/n8n-nodes-langchain.documentDefaultDataLoader\",\"position\":[1820,700],\"parameters\":{\"options\":{\"metadata\":{\"metadataValues\":[{\"name\":\"video_number\",\"value\":\"={{ $input.item.json.video_number }}\"},{\"name\":\"=youtubeId\",\"value\":\"={{ $input.item.json.youtubeId }}\"},{\"name\":\"summary\",\"value\":\"={{ $input.item.json.summary }}\"},{\"name\":\"title\",\"value\":\"={{ $input.item.json.title }}\"},{\"name\":\"playlistId\",\"value\":\"={{ $input.item.json.playlistId }}\"}]}}},\"typeVersion\":1},{\"id\":\"d3bc9db2-7618-46fd-b825-2cc0ad45fc22\",\"name\":\"Chat Buffer Memory\",\"type\":\"@n8n/n8n-nodes-langchain.memoryBufferWindow\",\"position\":[-260,-40],\"parameters\":{\"sessionKey\":\"={{ $('Chat').item.json.sessionId }}\",\"sessionIdType\":\"customKey\",\"contextWindowLength\":10},\"typeVersion\":1.3},{\"id\":\"fb55b13f-880f-404c-9446-9f8a238c8a5c\",\"name\":\"Full Summary\",\"type\":\"n8n-nodes-base.summarize\",\"position\":[2520,480],\"parameters\":{\"options\":{},\"fieldsToSummarize\":{\"values\":[{\"field\":\"summary\",\"separateBy\":\"\\n\",\"aggregation\":\"concatenate\"}]}},\"typeVersion\":1.1},{\"id\":\"efc2fc99-c738-425e-9ee1-669e378e197f\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-560,-400],\"parameters\":{\"color\":7,\"width\":1080,\"height\":900,\"content\":\"## RAG & Reply to User Query\\n- Retrieves and provides answers to user queries combining retrieval-augmented generation.\\n- Processes messages without specific routing rules.\\n     \"},\"typeVersion\":1},{\"id\":\"0040adf6-2cfc-4b79-ba81-b76740bfd158\",\"name\":\"Sticky Note3\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[560,-400],\"parameters\":{\"color\":7,\"width\":1380,\"height\":700,\"content\":\"## Fetch and prepare Playlist video transcripts data for processing \\n- Collects and organizes playlist video transcripts.\\n- Prepares data for analysis and summarization.\"},\"typeVersion\":1},{\"id\":\"59b29fc5-5d88-40c0-a273-9dc71d9f009e\",\"name\":\"Chat Buffer Memory1\",\"type\":\"@n8n/n8n-nodes-langchain.memoryBufferWindow\",\"position\":[2700,720],\"parameters\":{\"sessionKey\":\"={{ $('Chat').item.json.sessionId }}\",\"sessionIdType\":\"customKey\",\"contextWindowLength\":10},\"typeVersion\":1.3},{\"id\":\"afb6f6be-d299-402e-a9c6-2c60fbf4974e\",\"name\":\"YouTube Transcript\",\"type\":\"n8n-nodes-youtube-transcription-dmr.youtubeTranscripter\",\"position\":[1160,-200],\"parameters\":{\"videoId\":\"={{ $json.id }}\",\"continueOnFail\":true},\"typeVersion\":1},{\"id\":\"9a43eb4a-9d4c-4fce-b19c-94485aa8af76\",\"name\":\"Sticky Note4\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[560,340],\"parameters\":{\"color\":7,\"width\":640,\"height\":700,\"content\":\"## Summarize & Analyze Transcript\\n- Creates summarized data from transcripts.\"},\"typeVersion\":1},{\"id\":\"676677f0-3dae-4873-a449-92930ced534e\",\"name\":\"Sticky Note5\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1240,340],\"parameters\":{\"color\":7,\"width\":980,\"height\":700,\"content\":\"## Store Embeddings\\n- Saves embedded data for future use.\\n- Updates current context to maintain the flow of the conversation.     \"},\"typeVersion\":1},{\"id\":\"9ecd4d0d-b8bd-4a5d-981f-49fa515c17be\",\"name\":\"Sticky Note6\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[2260,340],\"parameters\":{\"color\":7,\"width\":940,\"height\":880,\"content\":\"## First Summary Analysis\\n- Conducts initial analysis of summarized data.\\n- Return to the user insights from processed transcripts.\"},\"typeVersion\":1},{\"id\":\"45ae8377-0848-45fb-a7a3-aba8d44e3d35\",\"name\":\"Message Intent\",\"type\":\"@n8n/n8n-nodes-langchain.agent\",\"onError\":\"continueRegularOutput\",\"position\":[-2260,-460],\"parameters\":{\"text\":\"= {{ $('Chat').item.json.chatInput }}\",\"options\":{\"systemMessage\":\"=**# YOUR TASK:**\\nPlease analyze the user's message and decide if the user has provided the info required - and ALWAYS reply using the **Output format** defined below.\\n\\n# Output format\\nYou use the following JSON structure to reply, don't include anything else, and alway inlude all the fields:\\n```\\n{\\n  \\\"intent\\\": PLAYLIST|VIDEO|NONE,\\n  \\\"url\\\": Youtube Playlist or Video URL or empty string,\\n  \\\"id\\\": Youtube Playlist or Video ID or empty string,\\n  \\\"limit\\\": number, default 0,\\n  \\\"status\\\": Previous context status `{{ $json.context_intent?.status }}` or \\\"PENDING\\\"\\n}\\n```\\n\\n## INTENT field GUIDELINES:\\n\\n**Respond with \\\"PLAYLIST\\\" if:**\\n- The messsage contains a valid Youtube Playlist URL\\n\\n**Respond with \\\"VIDEO\\\" if:**\\n- The messsage contains a valid Youtube Video URL\\n\\n**Respond with \\\"NONE\\\" if:**\\n- The messsage does not contains a valid Youtube Playlist or Video URL\\n\\n## LIMIT field GUIDELINE:\\nIf the \\\"Previous Context\\\" intent or the current intent is a Playlist: Based on current or most recent user message, check if there is an indication of how many videos to process, otherwise default to 0.\\n\\n## STATUS field GUIDELINE\\nIf intent is a Playlist or Video and _different_ from the the \\\"Previous Context\\\" then use \\\"PENDING\\\" since the user intent is to run a new process. Otherwise use the \\\"Previous Context\\\" status value.\\n\\n\\n# Rules for Playlist and Video\\n\\n## YouTube Playlist URL Definition\\n- A URL from www.youtube.com or youtube.com.\\n- Contains the query parameter `&list=` followed by a playlist ID.\\n- Example: https://www.youtube.com/...&list=PLXXXXXX (where PLXXXXXX is the playlist ID).\\n\\n## YouTube Video URL Definition\\n- A URL from www.youtube.com, youtube.com, or youtu.be.\\n- For www.youtube.com or youtube.com, it contains the query parameter `v=` followed by a video ID.\\n- For youtu.be, it follows the format https://youtu.be/VIDEO_ID.\\n- Examples:\\n  - https://www.youtube.com/watch?v=VIDEO_ID (where VIDEO_ID is the video ID).\\n  - https://youtu.be/VIDEO_ID\\n- IMPORTANT: YouTube Video URL **Does NOT have a query parameter `list=`**\\n\\n\\n# Previous Context\\n{{ JSON.stringify($json.context_intent) }}\\n\"},\"promptType\":\"define\",\"hasOutputParser\":true},\"retryOnFail\":true,\"typeVersion\":1.7,\"alwaysOutputData\":true},{\"id\":\"a29403f0-ed5c-465c-a43d-84e8dee69662\",\"name\":\"Structured Output Parser1\",\"type\":\"@n8n/n8n-nodes-langchain.outputParserStructured\",\"position\":[-2020,-220],\"parameters\":{\"jsonSchemaExample\":\"{\\n  \\\"intent\\\": \\\"PLAYLIST|VIDEO|NONE\\\",\\n  \\\"url\\\": \\\"Youtube Playlist or Video URL or empty string,\\\",\\n  \\\"id\\\": \\\"Youtube Playlist or Video ID or empty string,\\\",\\n  \\\"limit\\\": \\\"number of playlist videos to process or 0\\\",\\n  \\\"status\\\": \\\"PENDING|READY|DONE\\\"\\n}\"},\"typeVersion\":1.2},{\"id\":\"b3f43325-aa7b-47f3-8bbb-e27fa0c44a1e\",\"name\":\"Update Context Intent\",\"type\":\"n8n-nodes-base.redis\",\"position\":[-1160,-640],\"parameters\":{\"key\":\"=context_intent_{{ $('Chat').item.json.sessionId }}\",\"value\":\"=intent {{ $('Process Status').item.json.output?.intent || null }} url {{ $('Process Status').item.json.output?.url || \\\"\\\" }} id {{ $('Process Status').item.json.output?.id || \\\"\\\" }} limit {{ $('Process Status').item.json.output?.limit || 0 }} status {{ $('Process Status').item.json.output?.status || 'PENDING'  }}\",\"keyType\":\"hash\",\"operation\":\"set\",\"valueIsJSON\":false},\"credentials\":{\"redis\":{\"id\":\"mA0f9F1ROUThyrRW\",\"name\":\"Redis account\"}},\"typeVersion\":1},{\"id\":\"9c296501-049c-44b5-ae8d-8dda2c523278\",\"name\":\"Get Previous Context Intent\",\"type\":\"n8n-nodes-base.redis\",\"onError\":\"continueRegularOutput\",\"position\":[-2440,-460],\"parameters\":{\"key\":\"=context_intent_{{ $('Chat').item.json.sessionId }}\",\"keyType\":\"hash\",\"options\":{\"dotNotation\":false},\"operation\":\"get\",\"valueIsJSON\":false,\"propertyName\":\"context_intent\"},\"credentials\":{\"redis\":{\"id\":\"mA0f9F1ROUThyrRW\",\"name\":\"Redis account\"}},\"typeVersion\":1,\"alwaysOutputData\":true},{\"id\":\"9499d9f2-7d6d-432b-bdde-b4b98b90b224\",\"name\":\"Route Message Intent\",\"type\":\"n8n-nodes-base.switch\",\"position\":[-1700,-460],\"parameters\":{\"rules\":{\"values\":[{\"outputKey\":\"PROCESS\",\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"44e008af-4a1a-429d-adb6-039e74b643a6\",\"operator\":{\"type\":\"boolean\",\"operation\":\"true\",\"singleValue\":true},\"leftValue\":\"={{ \\n  ($json.output.intent == \\\"VIDEO\\\" || $json.output.intent == \\\"PLAYLIST\\\")\\n  && $json.output.status != \\\"DONE\\\" \\n}}\",\"rightValue\":\"/PLAYLIST|VIDEO/\"}]},\"renameOutput\":true},{\"outputKey\":\"QUERY\",\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"12641857-945d-4470-968e-f3f805bfe1cd\",\"operator\":{\"type\":\"boolean\",\"operation\":\"true\",\"singleValue\":true},\"leftValue\":\"={{ \\n  $json.output.intent == \\\"NONE\\\" || $json.output.status == \\\"DONE\\\"\\n}}\",\"rightValue\":\"NONE\"}]},\"renameOutput\":true}]},\"options\":{\"fallbackOutput\":\"extra\"}},\"typeVersion\":3.2},{\"id\":\"dfd329e8-98b1-4ae8-8cc1-a1a5215b1c09\",\"name\":\"Process Status\",\"type\":\"n8n-nodes-base.code\",\"position\":[-1340,-640],\"parameters\":{\"jsCode\":\"// Loop over input items and add a new field called 'myNewField' to the JSON of each one\\nif ($input.last().json.output.intent == 'VIDEO') {\\n  $input.last().json.output.status = 'READY'\\n}\\n\\nelse if ($input.last().json.output.intent == 'PLAYLIST' && parseInt($input.last().json.output.limit) > 0) {\\n  $input.last().json.output.status = 'READY'\\n}\\n\\nelse {\\n  $input.last().json.output = {\\n    intent: $('Default Intent').first().json.output.intent,\\n    url: $('Default Intent').first().json.output.url,\\n    id: $('Default Intent').first().json.output.id,\\n    limit: $('Default Intent').first().json.output.limit,\\n    status: 'PENDING',\\n  }\\n}\\n\\n\\nreturn $input.all();\"},\"typeVersion\":2},{\"id\":\"c84c21c6-0948-4628-b7a8-7cd2a5602cdc\",\"name\":\"Simple Memory\",\"type\":\"@n8n/n8n-nodes-langchain.memoryBufferWindow\",\"position\":[-2180,-220],\"parameters\":{\"sessionKey\":\"=intent_{{ $('Chat').item.json.sessionId }}\",\"sessionIdType\":\"customKey\"},\"typeVersion\":1.3},{\"id\":\"8ad2e1d1-b657-47cd-afa5-4fc49dc7e0e6\",\"name\":\"Simple Memory3\",\"type\":\"@n8n/n8n-nodes-langchain.memoryBufferWindow\",\"position\":[1040,-1180],\"parameters\":{\"sessionKey\":\"=pl_n_{{ $('Chat').item.json.sessionId }}\",\"sessionIdType\":\"customKey\"},\"typeVersion\":1.3},{\"id\":\"cf4d7c73-d9b1-42da-9ccc-6abccde4110c\",\"name\":\"Sticky Note7\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-2540,-620],\"parameters\":{\"color\":7,\"width\":1080,\"height\":580,\"content\":\"## Message intent routing\\n- Retrieves the previous context for continuity.\\n- Ensures data integrity before processing.\\n- Routes incoming messages based on intent.\\n     \"},\"typeVersion\":1},{\"id\":\"c0ecf826-b803-421a-aa2a-cb713131fbb7\",\"name\":\"Google Gemini Chat Model6\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatGoogleGemini\",\"position\":[-2340,-220],\"parameters\":{\"options\":{},\"modelName\":\"models/gemini-2.0-flash-lite\"},\"credentials\":{\"googlePalmApi\":{\"id\":\"2zwuT5znDglBrUCO\",\"name\":\"Google Gemini(PaLM) Api account\"}},\"typeVersion\":1},{\"id\":\"513a8c71-e982-47df-87bd-1e3d3ae9c613\",\"name\":\"Sticky Note9\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-1420,-1020],\"parameters\":{\"color\":7,\"width\":460,\"height\":580,\"content\":\"## Update Context\\n- Updates any issues detected in the context.\\n- Prepares data for workflow progression.\\n     \"},\"typeVersion\":1},{\"id\":\"d4a9d7aa-dfee-418f-900a-9649f0405861\",\"name\":\"Sticky Note10\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[800,-1480],\"parameters\":{\"color\":7,\"width\":480,\"height\":460,\"content\":\"## Ask number of Playlist videos to process\"},\"typeVersion\":1},{\"id\":\"f89481a4-64a2-4895-821f-effe48f7d331\",\"name\":\"Numb of Videos\",\"type\":\"@n8n/n8n-nodes-langchain.agent\",\"position\":[900,-1380],\"parameters\":{\"text\":\"={{ $('Chat').item.json.chatInput }}\",\"options\":{\"systemMessage\":\"=**Objective:**\\n\\nWe are here because the user wants to analyse a playlist in context, but we are missing how many videos he would like to process. Please reply to the user asking user to provide a number.\\n\\n## Context\\n{{ JSON.stringify($json.output) }}\"},\"promptType\":\"define\"},\"typeVersion\":1.7},{\"id\":\"bb8fa898-4953-4148-8339-2d205b86fc91\",\"name\":\"Default Intent\",\"type\":\"n8n-nodes-base.code\",\"position\":[-1920,-460],\"parameters\":{\"jsCode\":\"if(\\n  ($('Message Intent').first().json?.output?.intent == 'NONE' \\n     || Object.keys($('Message Intent').first().json?.output || {}).length == 0)\\n  && Object.keys($('Get Previous Context Intent').first().json.context_intent).length > 0\\n) {\\n  //use prev context intent\\n  if(!$input.first().json.output) {\\n    $input.first().json.output = {}\\n  }\\n  $input.first().json.output.intent = $('Get Previous Context Intent').first().json.context_intent?.intent || \\\"NONE\\\";\\n  $input.first().json.output.url = $('Get Previous Context Intent').first().json.context_intent?.url || \\\"\\\";\\n  $input.first().json.output.id = $('Get Previous Context Intent').first().json.context_intent?.id || \\\"\\\";\\n  $input.first().json.output.limit = $('Get Previous Context Intent').first().json.context_intent?.limit || 0;\\n  $input.first().json.output.status = $('Get Previous Context Intent').first().json.context_intent?.status || \\\"PENDING\\\";\\n} else {\\n  // $input.first().json.output.intent = $('Message Intent').first().json.context_intent?.intent || \\\"NONE\\\";\\n  // $input.first().json.output.url = $('Message Intent').first().json.context_intent?.url || \\\"\\\";\\n  // $input.first().json.output.id = $('Message Intent').first().json.context_intent?.id || \\\"\\\";\\n  // $input.first().json.output.limit = $('Message Intent').first().json.context_intent?.limit || 0;\\n  // $input.first().json.output.status = $('Message Intent').first().json.context_intent?.status || \\\"PENDING\\\";\\n}\\n\\n// else use message intent\\n\\nreturn $input.all();\"},\"typeVersion\":2},{\"id\":\"0f1d1bb6-22c0-4b65-beaf-eaf4401d7550\",\"name\":\"Playlist Limit\",\"type\":\"n8n-nodes-base.if\",\"position\":[160,-860],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"6ee01f0a-9533-4fb3-b023-cfcc422d9011\",\"operator\":{\"name\":\"filter.operator.equals\",\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $('Process Status').item.json.output.intent }}\",\"rightValue\":\"PLAYLIST\"},{\"id\":\"e9575bb2-3c60-498b-b2c7-436b62e5195c\",\"operator\":{\"type\":\"number\",\"operation\":\"lte\"},\"leftValue\":\"={{ parseInt($('Process Status').item.json.output.limit) }}\",\"rightValue\":0}]}},\"typeVersion\":2.2},{\"id\":\"083c17aa-de83-4f3c-8d71-f665903ce3d5\",\"name\":\"Playlist or Video\",\"type\":\"n8n-nodes-base.switch\",\"position\":[160,-640],\"parameters\":{\"rules\":{\"values\":[{\"outputKey\":\"VIDEO\",\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"cc3ec644-7c3d-4d9f-b7a7-89b85824e3e3\",\"operator\":{\"name\":\"filter.operator.equals\",\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $('Route Message Intent').item.json.output.intent }}\",\"rightValue\":\"VIDEO\"}]},\"renameOutput\":true},{\"outputKey\":\"PLAYLIST\",\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"33beac83-b96b-4e76-9d18-e22df163ea4d\",\"operator\":{\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $('Route Message Intent').item.json.output.intent }}\",\"rightValue\":\"PLAYLIST\"}]},\"renameOutput\":true}]},\"options\":{}},\"typeVersion\":3.2},{\"id\":\"0626bc2d-9e3a-4a4f-a331-62e8b6c69840\",\"name\":\"Get Fields for Summary\",\"type\":\"n8n-nodes-base.code\",\"position\":[2340,480],\"parameters\":{\"jsCode\":\"return $('Edit Fields').all();\"},\"typeVersion\":2},{\"id\":\"4aaaed18-ce90-4296-aba2-b5fa9492655d\",\"name\":\"Update Context Process Done1\",\"type\":\"n8n-nodes-base.redis\",\"position\":[2040,480],\"parameters\":{\"key\":\"=context_intent_{{ $('Chat').first().json.sessionId }}\",\"value\":\"=intent {{ $('Process Status').first().json.output?.intent || null }} url {{ $('Process Status').first().json.output?.url || \\\"\\\" }} id {{ $('Process Status').first().json.output?.id || \\\"\\\" }} limit {{ $('Process Status').first().json.output?.limit || 0 }} status DONE\",\"keyType\":\"hash\",\"operation\":\"set\",\"valueIsJSON\":false},\"credentials\":{\"redis\":{\"id\":\"mA0f9F1ROUThyrRW\",\"name\":\"Redis account\"}},\"executeOnce\":true,\"typeVersion\":1},{\"id\":\"d3f71d59-a158-43e2-bfbd-a3bec20dea5b\",\"name\":\"Google Gemini Chat Model8\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatGoogleGemini\",\"position\":[880,-1180],\"parameters\":{\"options\":{},\"modelName\":\"models/gemini-2.0-flash-thinking-exp\"},\"credentials\":{\"googlePalmApi\":{\"id\":\"2zwuT5znDglBrUCO\",\"name\":\"Google Gemini(PaLM) Api account\"}},\"typeVersion\":1},{\"id\":\"fa6b8a79-436e-4742-9732-cd5c1b2d3c88\",\"name\":\"Playlist HTTP Request\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[660,-200],\"parameters\":{\"url\":\"={{ $('Update Context Intent').item.json.output.url }}\",\"options\":{}},\"typeVersion\":4.2},{\"id\":\"99d6da96-8983-4e7d-8343-b9ac975f5d20\",\"name\":\"YouTube Transcript1\",\"type\":\"n8n-nodes-youtube-transcription-dmr.youtubeTranscripter\",\"position\":[1200,-860],\"parameters\":{\"videoId\":\"={{ $('Update Context Intent').item.json.output.id }}\",\"continueOnFail\":true},\"typeVersion\":1},{\"id\":\"41a07802-3fba-42fa-8482-f526a7e1b173\",\"name\":\"Video HTTP Request\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[900,-860],\"parameters\":{\"url\":\"={{ $('Update Context Intent').item.json.output.url }}\",\"options\":{}},\"typeVersion\":4.2},{\"id\":\"02103114-9c22-49b1-9dee-746b84cdef66\",\"name\":\"Get Title and Desc\",\"type\":\"n8n-nodes-base.code\",\"position\":[1200,-640],\"parameters\":{\"jsCode\":\"/**\\n * This code node contains a modified version of play-dl,\\n * which is licensed under the GNU General Public License Version 3 (GPLv3).\\n *\\n * Original Library Name: play-dl\\n * Original Library Source: https://github.com/play-dl/play-dl/tree/main\\n * Original Library License: GNU General Public License Version 3 (GPLv3)\\n * (See: https://www.gnu.org/licenses/gpl-3.0.en.html)\\n *\\n * Modifications were made to the original library for use within this N8N workflow.\\n * These modifications are also licensed under the GNU General Public License Version 3 (GPLv3).\\n *\\n * This program is distributed in the hope that it will be useful,\\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\\n * GNU General Public License for more details.\\n *\\n * You should have received a copy of the GNU General Public License\\n * along with this program.  If not, see <https://www.gnu.org/licenses/>.\\n */\\n\\n\\n/**\\n * Basic function to get specific data (title, description, duration)\\n * from pre-fetched HTML body data of a YouTube video page.\\n * Assumes the HTML body is passed as the first argument.\\n *\\n * @param {string} body HTML body data of the YouTube video page.\\n * @param {string} video_id YouTube video ID.\\n * @param {string} url YouTube video URL.\\n * @returns {Promise<{title: string, description: string, duration: number}>} Video Basic Info.\\n * @throws {Error} If video ID cannot be extracted, captcha is detected,\\n * or necessary data cannot be parsed.\\n */\\nasync function video_basic_info(body, video_id, url) {\\n  // --- Input Validation ---\\n  if (typeof body !== 'string') {\\n    throw new Error('body parameter must be a string of HTML');\\n  }\\n  if (typeof video_id !== 'string' || !video_id.trim()) {\\n    throw new Error('video_id parameter must be a non-empty string');\\n  }\\n  if (typeof url !== 'string' || !url.trim()) {\\n    throw new Error('url parameter must be a non-empty URL string');\\n  }\\n\\n  // --- Captcha Check ---\\n  // Added check for consent page as well\\n  if (body.includes('Our systems have detected unusual traffic') || body.includes('consent.google.com')) {\\n    throw new Error('Captcha or Consent page encountered: YouTube likely requires interaction or detected bot-like activity.');\\n  }\\n\\n  // --- Extract Player Data ---\\n  let player_data;\\n  try {\\n    // More robust regex to find ytInitialPlayerResponse, stopping at the next semicolon\\n    const player_data_match = body.match(/var ytInitialPlayerResponse\\\\s*=\\\\s*({.+?});\\\\s*(?:var |<\\\\/script)/);\\n    if (!player_data_match || !player_data_match[1]) {\\n      // Fallback attempt with simpler split (less reliable)\\n      const split_data = body.split('var ytInitialPlayerResponse = ');\\n      player_data = split_data?.[1]?.split(';</script>')?.[0];\\n    } else {\\n      player_data = player_data_match[1];\\n    }\\n\\n    if (!player_data) {\\n      // Check for common failure indicators in the HTML if data isn't found\\n      if (body.includes('<title>YouTube</title>') && !body.includes('videoDetails')) {\\n        throw new Error('Could not find ytInitialPlayerResponse data. The page might be a generic YouTube page, not a video page, or the structure changed.');\\n      }\\n      throw new Error('Could not find ytInitialPlayerResponse data.');\\n    }\\n  } catch (error) {\\n    console.log(\\\"Error during player_data extraction:\\\", error);\\n    throw new Error(`Failed during player data extraction: ${error}`);\\n  }\\n\\n\\n  let player_response;\\n  try {\\n    player_response = JSON.parse(player_data);\\n  } catch (e) {\\n    console.log(\\\"Raw player_data that failed parsing:\\\", player_data.substring(0, 500) + '...'); // Log start of data\\n    throw new Error(`Failed to parse ytInitialPlayerResponse JSON: ${e}`);\\n  }\\n\\n  // --- Extract Required Video Details ---\\n  // Use optional chaining for safety\\n  const vid = player_response?.videoDetails;\\n\\n  // Add more robust checking, including playability status\\n  if (!vid) {\\n    const playabilityStatus = player_response?.playabilityStatus;\\n    let reason = \\\"videoDetails object not found in the response.\\\";\\n    if (playabilityStatus?.status && playabilityStatus.status !== 'OK') {\\n      reason = ` Playability status: ${playabilityStatus.status}. Reason: ${playabilityStatus.reason ||\\n        playabilityStatus.errorScreen?.playerErrorMessageRenderer?.reason?.simpleText ||\\n        playabilityStatus.errorScreen?.playerKavRenderer?.reason?.simpleText ||\\n        'No specific reason provided.'\\n        }`;\\n    } else if (playabilityStatus?.status === 'OK' && !vid) {\\n      reason = \\\" Playability status is OK, but videoDetails is still missing. Response structure might have changed.\\\";\\n    }\\n    throw new Error(`Could not get video details. ${reason}`);\\n  }\\n\\n  // --- Return Simplified Data ---\\n  // Ensure values exist before accessing, provide defaults if necessary\\n  return {\\n    title: vid.title || 'N/A',\\n    description: vid.shortDescription || '', // Default to empty string if missing\\n    duration: Number(vid.lengthSeconds) || 0, // Default to 0 if missing/invalid\\n  };\\n}\\n\\n\\nreturn video_basic_info($input.first().json.data, $('Update Context Intent').first().json.output.id, $('Update Context Intent').first().json.output.url);\"},\"retryOnFail\":true,\"typeVersion\":2,\"alwaysOutputData\":true,\"waitBetweenTries\":500},{\"id\":\"6cea694e-0147-4cd0-a601-9b232813a1d3\",\"name\":\"Split Out2\",\"type\":\"n8n-nodes-base.splitOut\",\"position\":[1440,-860],\"parameters\":{\"include\":\"selectedOtherFields\",\"options\":{},\"fieldToSplitOut\":\"transcript\",\"fieldsToInclude\":\"youtubeId\"},\"typeVersion\":1},{\"id\":\"c479fb51-e17d-477a-b40b-65458cc3e679\",\"name\":\"Concatenate1\",\"type\":\"n8n-nodes-base.summarize\",\"position\":[1660,-860],\"parameters\":{\"options\":{},\"fieldsToSplitBy\":\"youtubeId\",\"fieldsToSummarize\":{\"values\":[{\"field\":\"transcript.text\",\"separateBy\":\" \",\"aggregation\":\"concatenate\"}]}},\"typeVersion\":1},{\"id\":\"ccca5021-248b-4a98-af6b-ee92b2d63dca\",\"name\":\"Sticky Note12\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[800,-1000],\"parameters\":{\"color\":7,\"width\":1140,\"height\":560,\"content\":\"## Fetch and prepare single video transcripts data for processing\\n- Retrieves and pre-processes single video transcripts.\\n- Prepares data for analysis and summarization.\\n\"},\"typeVersion\":1},{\"id\":\"1e9ecc6e-2b4d-4ae8-8949-d4b92eaf9287\",\"name\":\"Get Videos\",\"type\":\"n8n-nodes-base.code\",\"position\":[1520,480],\"parameters\":{\"jsCode\":\"return $('Edit Fields').all();\"},\"typeVersion\":2},{\"id\":\"f8ea7a40-b1f9-4dc2-959d-0e765331b191\",\"name\":\"Get Playlist Videos Data\",\"type\":\"n8n-nodes-base.code\",\"position\":[860,-200],\"parameters\":{\"jsCode\":\"/**\\n * This code node contains a modified version of play-dl,\\n * which is licensed under the GNU General Public License Version 3 (GPLv3).\\n *\\n * Original Library Name: play-dl\\n * Original Library Source: https://github.com/play-dl/play-dl/tree/main\\n * Original Library License: GNU General Public License Version 3 (GPLv3)\\n * (See: https://www.gnu.org/licenses/gpl-3.0.en.html)\\n *\\n * Modifications were made to the original library for use within this N8N workflow.\\n * These modifications are also licensed under the GNU General Public License Version 3 (GPLv3).\\n *\\n * This program is distributed in the hope that it will be useful,\\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\\n * GNU General Public License for more details.\\n *\\n * You should have received a copy of the GNU General Public License\\n * along with this program.  If not, see <https://www.gnu.org/licenses/>.\\n */\\n\\n\\n/**\\n * Gets YouTube playlist info from a playlist url.\\n *\\n * Example\\n * ```js\\n * const playlist = await play.playlist_info('youtube playlist url')\\n *\\n * const playlist = await play.playlist_info('youtube playlist url', { incomplete : true })\\n * ```\\n * @param body HTML body of the playlist page\\n * @param url Playlist URL\\n * @returns YouTube Playlist\\n */\\nfunction playlist_info(body, url) {\\n  let url_ = url.trim();\\n  if (body.indexOf('Our systems have detected unusual traffic from your computer network.') !== -1)\\n    throw new Error('Captcha page: YouTube has detected that you are a bot!');\\n\\n  const response = JSON.parse(\\n    body\\n      .split('var ytInitialData = ')[1]\\n      .split(';</script>')[0]\\n      .split(/;\\\\s*(var|const|let)\\\\s/)[0]\\n  );\\n\\n  if (response.alerts) {\\n    if (response.alerts[0].alertWithButtonRenderer?.type === 'INFO') {\\n      throw new Error(\\n        `While parsing playlist url\\\\n${response.alerts[0].alertWithButtonRenderer.text.simpleText}`\\n      );\\n    } else if (response.alerts[0].alertRenderer?.type === 'ERROR')\\n      throw new Error(`While parsing playlist url\\\\n${response.alerts[0].alertRenderer.text.runs[0].text}`);\\n    else throw new Error('While parsing playlist url\\\\nUnknown Playlist Error');\\n  }\\n  if (response.currentVideoEndpoint) {\\n    return getWatchPlaylist(response, body, url_);\\n  } else return getNormalPlaylist(response, body);\\n}\\n\\n/**\\n * Function to parse Playlist from YouTube search\\n * @param data html data of that request\\n * @param limit No. of videos to parse\\n * @returns Array of YouTube Video objects.\\n */\\nfunction getPlaylistVideos(data, limit = Infinity) {\\n  const videos = [];\\n\\n  for (let i = 0; i < data.length; i++) {\\n    if (limit === videos.length) break;\\n    const info = data[i].playlistVideoRenderer;\\n    if (!info || !info.shortBylineText) continue;\\n\\n    videos.push({\\n      id: info.videoId,\\n      duration: parseInt(info.lengthSeconds) || 0,\\n      duration_raw: info.lengthText?.simpleText ?? '0:00',\\n      thumbnails: info.thumbnail.thumbnails,\\n      title: info.title.runs[0].text,\\n      upcoming: info.upcomingEventData?.startTime\\n        ? new Date(parseInt(info.upcomingEventData.startTime) * 1000)\\n        : undefined,\\n      channel: {\\n        id: info.shortBylineText.runs[0].navigationEndpoint.browseEndpoint.browseId || undefined,\\n        name: info.shortBylineText.runs[0].text || undefined,\\n        url: `https://www.youtube.com${info.shortBylineText.runs[0].navigationEndpoint.browseEndpoint.canonicalBaseUrl ||\\n          info.shortBylineText.runs[0].navigationEndpoint.commandMetadata.webCommandMetadata.url\\n          }`,\\n        icon: undefined\\n      }\\n    });\\n  }\\n  return videos;\\n}\\n\\n\\nfunction getWatchPlaylist(response, body, url) {\\n  const playlist_details = response.contents.twoColumnWatchNextResults.playlist?.playlist;\\n  if (!playlist_details)\\n    throw new Error(\\\"Watch playlist unavailable due to YouTube layout changes.\\\")\\n\\n  const videos = getWatchPlaylistVideos(playlist_details.contents);\\n  const videoCount = playlist_details.totalVideos;\\n  const channel = playlist_details.shortBylineText?.runs?.[0];\\n  const badge = playlist_details.badges?.[0]?.metadataBadgeRenderer?.style.toLowerCase();\\n\\n  return {\\n    id: playlist_details.playlistId || '',\\n    title: playlist_details.title || '',\\n    videoCount: parseInt(videoCount) || 0,\\n    videos: videos,\\n    url: url,\\n    channel: {\\n      id: channel?.navigationEndpoint?.browseEndpoint?.browseId || null,\\n      name: channel?.text || null,\\n      url: `https://www.youtube.com${channel?.navigationEndpoint?.browseEndpoint?.canonicalBaseUrl ||\\n        channel?.navigationEndpoint?.commandMetadata?.webCommandMetadata?.url\\n        }`,\\n      verified: Boolean(badge?.includes('verified')),\\n      artist: Boolean(badge?.includes('artist'))\\n    }\\n  };\\n}\\n\\nfunction getNormalPlaylist(response, body) {\\n  const json_data =\\n    response.contents.twoColumnBrowseResultsRenderer.tabs[0].tabRenderer.content.sectionListRenderer.contents[0]\\n      .itemSectionRenderer.contents[0].playlistVideoListRenderer.contents;\\n  const playlist_details = response.sidebar.playlistSidebarRenderer.items;\\n  const videos = getPlaylistVideos(json_data, 100);\\n\\n  const data = playlist_details[0].playlistSidebarPrimaryInfoRenderer;\\n  if (!data.title.runs || !data.title.runs.length) throw new Error('Failed to Parse Playlist info.');\\n\\n  const author = playlist_details[1]?.playlistSidebarSecondaryInfoRenderer.videoOwner;\\n  const views = data.stats.length === 3 ? data.stats[1].simpleText.replace(/\\\\D/g, '') : 0;\\n  const lastUpdate =\\n    data.stats\\n      .find((x) => 'runs' in x && x['runs'].find((y) => y.text.toLowerCase().includes('last update')))\\n      ?.runs.pop()?.text ?? null;\\n  const videosCount = data.stats[0].runs[0].text.replace(/\\\\D/g, '') || 0;\\n\\n  return {\\n    id: data.title.runs[0].navigationEndpoint.watchEndpoint.playlistId,\\n    title: data.title.runs[0].text,\\n    videoCount: parseInt(videosCount) || 0,\\n    lastUpdate: lastUpdate,\\n    views: parseInt(views) || 0,\\n    videos: videos,\\n    url: `https://www.youtube.com/playlist?list=${data.title.runs[0].navigationEndpoint.watchEndpoint.playlistId}`,\\n    link: `https://www.youtube.com${data.title.runs[0].navigationEndpoint.commandMetadata.webCommandMetadata.url}`,\\n    channel: author\\n      ? {\\n        name: author.videoOwnerRenderer.title.runs[0].text,\\n        id: author.videoOwnerRenderer.title.runs[0].navigationEndpoint.browseEndpoint.browseId,\\n        url: `https://www.youtube.com${author.videoOwnerRenderer.navigationEndpoint.commandMetadata.webCommandMetadata.url ||\\n          author.videoOwnerRenderer.navigationEndpoint.browseEndpoint.canonicalBaseUrl\\n          }`,\\n        icons: author.videoOwnerRenderer.thumbnail.thumbnails ?? []\\n      }\\n      : {},\\n    thumbnail: data.thumbnailRenderer.playlistVideoThumbnailRenderer?.thumbnail.thumbnails.length\\n      ? data.thumbnailRenderer.playlistVideoThumbnailRenderer.thumbnail.thumbnails[\\n      data.thumbnailRenderer.playlistVideoThumbnailRenderer.thumbnail.thumbnails.length - 1\\n      ]\\n      : null\\n  };\\n}\\n\\nfunction parseDuration(text) {\\n  if (!text) return 0;\\n  const split = text.split(':');\\n\\n  switch (split.length) {\\n    case 2:\\n      return parseInt(split[0]) * 60 + parseInt(split[1]);\\n\\n    case 3:\\n      return parseInt(split[0]) * 60 * 60 + parseInt(split[1]) * 60 + parseInt(split[2]);\\n\\n    default:\\n      return 0;\\n  }\\n}\\n\\nfunction getWatchPlaylistVideos(data, limit = Infinity) {\\n  const videos = [];\\n\\n  for (let i = 0; i < data.length; i++) {\\n    if (limit === videos.length) break;\\n    const info = data[i].playlistPanelVideoRenderer;\\n    if (!info || !info.shortBylineText) continue;\\n    const channel_info = info.shortBylineText.runs[0];\\n\\n    videos.push({\\n      id: info.videoId,\\n      duration: parseDuration(info.lengthText?.simpleText) || 0,\\n      duration_raw: info.lengthText?.simpleText ?? '0:00',\\n      thumbnails: info.thumbnail.thumbnails,\\n      title: info.title.simpleText,\\n      upcoming:\\n        info.thumbnailOverlays[0].thumbnailOverlayTimeStatusRenderer?.style === 'UPCOMING' || undefined,\\n      channel: {\\n        id: channel_info.navigationEndpoint.browseEndpoint.browseId || undefined,\\n        name: channel_info.text || undefined,\\n        url: `https://www.youtube.com${channel_info.navigationEndpoint.browseEndpoint.canonicalBaseUrl ||\\n          channel_info.navigationEndpoint.commandMetadata.webCommandMetadata.url\\n          }`,\\n        icon: undefined\\n      }\\n    });\\n  }\\n\\n  return videos;\\n}\\n\\n\\nreturn playlist_info($input.first().json.data, $('Update Context Intent').first().json.output.url);\"},\"retryOnFail\":true,\"typeVersion\":2,\"alwaysOutputData\":true,\"waitBetweenTries\":500},{\"id\":\"71b60b8e-06df-45a8-85a3-7b9e938fb6f0\",\"name\":\"Embeddings Google Gemini2\",\"type\":\"@n8n/n8n-nodes-langchain.embeddingsGoogleGemini\",\"position\":[2640,1060],\"parameters\":{\"modelName\":\"models/text-embedding-004\"},\"credentials\":{\"googlePalmApi\":{\"id\":\"2zwuT5znDglBrUCO\",\"name\":\"Google Gemini(PaLM) Api account\"}},\"typeVersion\":1},{\"id\":\"58feccf5-1b97-4c88-b274-444e177f4515\",\"name\":\"Qdrant Vector Store3\",\"type\":\"@n8n/n8n-nodes-langchain.vectorStoreQdrant\",\"position\":[-100,160],\"parameters\":{\"options\":{},\"qdrantCollection\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"={{ $('Default Intent').first().json.output?.id }}\"}},\"credentials\":{\"qdrantApi\":{\"id\":\"mb8rw8tmUeP6aPJm\",\"name\":\"QdrantApi account\"}},\"typeVersion\":1.1},{\"id\":\"6cff2236-3e78-4e8c-bb3d-5140f106c530\",\"name\":\"Answer questions with a vector store\",\"type\":\"@n8n/n8n-nodes-langchain.toolVectorStore\",\"position\":[180,-40],\"parameters\":{\"name\":\"chat_playlist_data\",\"topK\":10,\"description\":\"=Retrive data about the Playlist or Video from the vector store.\\nplaylistId or youtubeId: {{ $('Default Intent').item.json.output?.id }}\\n\\n**User Message:**\\n{{ $('Chat').item.json.chatInput }}\"},\"typeVersion\":1},{\"id\":\"312081d9-9279-4700-a432-e9f878d5361e\",\"name\":\"Qdrant Vector Store4\",\"type\":\"@n8n/n8n-nodes-langchain.vectorStoreQdrant\",\"position\":[2700,900],\"parameters\":{\"options\":{},\"qdrantCollection\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"={{ $('Default Intent').first().json.output?.id }}\"}},\"credentials\":{\"qdrantApi\":{\"id\":\"mb8rw8tmUeP6aPJm\",\"name\":\"QdrantApi account\"}},\"typeVersion\":1.1},{\"id\":\"f5cba8b5-226d-4b0a-8cb6-a51728ac8247\",\"name\":\"Answer questions with a vector store1\",\"type\":\"@n8n/n8n-nodes-langchain.toolVectorStore\",\"position\":[2860,700],\"parameters\":{\"name\":\"chat_playlist_data\",\"topK\":6,\"description\":\"=User Message:\\n{{ $('Chat').item.json.chatInput }}\"},\"typeVersion\":1},{\"id\":\"22f18788-b47f-4187-9146-28e6de5ec7a6\",\"name\":\"Google Gemini Chat Model\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatGoogleGemini\",\"position\":[3000,900],\"parameters\":{\"options\":{},\"modelName\":\"models/gemini-2.0-flash\"},\"credentials\":{\"googlePalmApi\":{\"id\":\"2zwuT5znDglBrUCO\",\"name\":\"Google Gemini(PaLM) Api account\"}},\"typeVersion\":1},{\"id\":\"2aa52dd2-169b-43dc-8202-1d60f5fd55c0\",\"name\":\"Google Gemini Chat Model3\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatGoogleGemini\",\"position\":[220,160],\"parameters\":{\"options\":{},\"modelName\":\"models/gemini-2.0-flash\"},\"credentials\":{\"googlePalmApi\":{\"id\":\"2zwuT5znDglBrUCO\",\"name\":\"Google Gemini(PaLM) Api account\"}},\"typeVersion\":1},{\"id\":\"d96d3670-ab95-4afc-a275-33f03383a204\",\"name\":\"Qdrant Vector Store2\",\"type\":\"@n8n/n8n-nodes-langchain.vectorStoreQdrant\",\"position\":[-820,-880],\"parameters\":{\"mode\":\"load\",\"prompt\":\"Are there any documents in the store?\",\"options\":{},\"qdrantCollection\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"={{ $('Process Status').item.json.output?.id }}\"}},\"credentials\":{\"qdrantApi\":{\"id\":\"mb8rw8tmUeP6aPJm\",\"name\":\"QdrantApi account\"}},\"typeVersion\":1,\"alwaysOutputData\":true},{\"id\":\"7c289d61-09b2-461e-b771-8781f60828c7\",\"name\":\"Embeddings Google Gemini4\",\"type\":\"@n8n/n8n-nodes-langchain.embeddingsGoogleGemini\",\"position\":[-840,-640],\"parameters\":{\"modelName\":\"models/text-embedding-004\"},\"credentials\":{\"googlePalmApi\":{\"id\":\"2zwuT5znDglBrUCO\",\"name\":\"Google Gemini(PaLM) Api account\"}},\"typeVersion\":1},{\"id\":\"59be01b0-3ff9-4cc2-b569-c0cb4dcae3ec\",\"name\":\"If\",\"type\":\"n8n-nodes-base.if\",\"position\":[-260,-880],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"795da689-23c3-49d5-a312-ca18e2c9d5e3\",\"operator\":{\"type\":\"number\",\"operation\":\"gt\"},\"leftValue\":\"={{ $json.count_document }}\",\"rightValue\":0}]}},\"typeVersion\":2.2},{\"id\":\"ab9bc74d-9659-44fe-aa08-4878609ef808\",\"name\":\"Count Content\",\"type\":\"n8n-nodes-base.summarize\",\"position\":[-460,-880],\"parameters\":{\"options\":{},\"fieldsToSummarize\":{\"values\":[{\"field\":\"document\"}]}},\"typeVersion\":1.1},{\"id\":\"5c953435-1052-4e1c-9d2f-2439ba944b28\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[20,-1020],\"parameters\":{\"color\":7,\"width\":500,\"height\":580,\"content\":\"## Process or ask for more details\\n- Decides next steps based on workflow conditions e.g. missing number of playlist videos to process.\\n- Route to Playlist or Video processing.\"},\"typeVersion\":1},{\"id\":\"78760cd2-74db-482d-b660-bd53a3184b95\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-920,-1020],\"parameters\":{\"color\":7,\"width\":880,\"height\":580,\"content\":\"## Already Processed? \\n- Check if we already have embeddings in the vector store.\"},\"typeVersion\":1},{\"id\":\"a8dc1b1e-2ba9-4b85-9f2f-c3d07ec67c32\",\"name\":\"Update Context Intent1\",\"type\":\"n8n-nodes-base.redis\",\"position\":[-460,-640],\"parameters\":{\"key\":\"=context_intent_{{ $('Chat').item.json.sessionId }}\",\"value\":\"=intent {{ $('Process Status').item.json.output?.intent || null }} url {{ $('Process Status').item.json.output?.url || \\\"\\\" }} id {{ $('Process Status').item.json.output?.id || \\\"\\\" }} limit {{ $('Process Status').item.json.output?.limit || 0 }} status DONE\",\"keyType\":\"hash\",\"operation\":\"set\",\"valueIsJSON\":false},\"credentials\":{\"redis\":{\"id\":\"mA0f9F1ROUThyrRW\",\"name\":\"Redis account\"}},\"typeVersion\":1},{\"id\":\"36ea2e25-8d29-4ec6-bc6a-15c98153c390\",\"name\":\"Sticky Note8\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-2540,20],\"parameters\":{\"width\":1080,\"height\":1320,\"content\":\"# AI-Powered YouTube Playlist & Video Summarization and Analysis Chat Bot\\n\\nThis N8N workflow transforms YouTube playlists or individual videos into interactive knowledge bases. Instead of watching videos, users can chat with the workflow to get summaries and answers based on the video transcripts.\\n\\n## How it Works:\\n\\n1.  **Chat Interaction & Intent Detection:**\\n    * The workflow starts via a chat interface (`Chat Trigger`), prompting the user for a YouTube playlist or video URL.\\n    * It retrieves any previous conversation context stored in Redis.\\n    * A Google Gemini AI agent (`Message Intent`) analyzes the user's input to determine if it contains a valid YouTube playlist URL, a video URL, or neither (`NONE`). It extracts the URL, the corresponding ID (Playlist ID or Video ID), and checks if the user specified a limit for the number of playlist videos to process.\\n    * The workflow maintains context (like the current URL, ID, and processing status) using Redis (`Update Context Intent`, `Get Previous Context Intent`).\\n\\n2.  **Routing & Pre-processing Checks:**\\n    * Based on the detected intent and whether the content needs processing, a `Switch` node (`Route Message Intent`) directs the workflow.\\n    * If a valid URL is provided and hasn't been processed yet (`status != 'DONE'`), it proceeds to the processing pipeline.\\n    * It checks if embeddings for the given ID already exist in the Qdrant vector store (`Qdrant Vector Store2`, `If`). If they do, it skips processing and moves to the query handling stage.\\n    * If the input is a playlist URL but no video limit is specified (`limit=0`), it prompts the user to provide one (`Numb of Videos` agent).\\n\\n3.  **Video/Playlist Processing Pipeline:**\\n    * **Data Fetching:**\\n        * For **Playlists**: Fetches the playlist page (`Playlist HTTP Request`), extracts video details using custom code (`Get Playlist Videos Data`), limits the videos if specified (`Limit`), and then fetches the transcript for each video (`YouTube Transcript`).\\n        * For **Videos**: Fetches the video page (`Video HTTP Request`), extracts title/description (`Get Title and Desc`), and fetches the transcript (`YouTube Transcript1`).\\n    * **Transcript Processing & Summarization:**\\n        * Transcripts are retrieved using the `youtubeTranscripter` node.\\n        * Transcripts are concatenated (`Concatenate`, `Concatenate1`).\\n        * Data (like video ID, title, transcript text) is merged and structured (`Merge`, `Edit Fields`).\\n        * Each video's transcript is summarized by a Google Gemini AI chain (`Summarize & Analyze Transcript`).\\n    * **Embedding & Storage:**\\n        * Any existing data for the playlist/video ID is cleared from the Qdrant vector store (`Delete Collection`).\\n        * The processed transcripts (potentially alongside summaries/metadata) are loaded (`Default Data Loader`).\\n        * Text is split into manageable chunks (`Recursive Character Text Splitter`).\\n        * Google Gemini generates vector embeddings for the text chunks (`Embeddings Google Gemini`).\\n        * These embeddings are stored in a Qdrant collection, indexed by the playlist or video ID (`Qdrant Vector Store`).\\n    * **Status Update & Final Summary:**\\n        * The context status in Redis is updated to 'DONE' (`Update Context Process Done1`).\\n        * All individual video summaries are combined (`Full Summary`).\\n        * An AI agent (`AI Agent`) may generate a final, comprehensive summary or response based on the processed data, using a tool to query the vector store (`Answer questions with a vector store1`).\\n\\n4.  **Query Handling (Chatting with Content):**\\n    * If the user's input is identified as a query rather than a new URL to process (or if processing for a URL is complete), the workflow activates the main query handler.\\n    * A conversational AI agent (`Handle Queries`), powered by Google Gemini and equipped with chat memory (`Chat Buffer Memory`), answers user questions.\\n    * This agent uses a specialized tool (`Answer questions with a vector store`) that retrieves relevant information directly from the Qdrant vector store based on the user's query and the stored embeddings.\"},\"typeVersion\":1}],\"active\":true,\"pinData\":{},\"settings\":{\"executionOrder\":\"v1\"},\"versionId\":\"7c1d0978-ccea-4618-bcbf-560b34f77023\",\"connections\":{\"If\":{\"main\":[[{\"node\":\"Update Context Intent1\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Playlist Limit\",\"type\":\"main\",\"index\":0}]]},\"Chat\":{\"main\":[[{\"node\":\"Get Previous Context Intent\",\"type\":\"main\",\"index\":0}]]},\"Limit\":{\"main\":[[{\"node\":\"YouTube Transcript\",\"type\":\"main\",\"index\":0},{\"node\":\"Video Titles\",\"type\":\"main\",\"index\":0}]]},\"Merge\":{\"main\":[[{\"node\":\"Summarize & Analyze Transcript\",\"type\":\"main\",\"index\":0}]]},\"Split Out\":{\"main\":[[{\"node\":\"Concatenate\",\"type\":\"main\",\"index\":0}]]},\"Get Videos\":{\"main\":[[{\"node\":\"Qdrant Vector Store\",\"type\":\"main\",\"index\":0}]]},\"Split Out1\":{\"main\":[[{\"node\":\"Limit\",\"type\":\"main\",\"index\":0}]]},\"Split Out2\":{\"main\":[[{\"node\":\"Concatenate1\",\"type\":\"main\",\"index\":0}]]},\"Concatenate\":{\"main\":[[{\"node\":\"Merge\",\"type\":\"main\",\"index\":0}]]},\"Edit Fields\":{\"main\":[[{\"node\":\"Delete Collection\",\"type\":\"main\",\"index\":0}]]},\"Concatenate1\":{\"main\":[[{\"node\":\"Merge\",\"type\":\"main\",\"index\":0}]]},\"Full Summary\":{\"main\":[[{\"node\":\"AI Agent\",\"type\":\"main\",\"index\":0}]]},\"Video Titles\":{\"main\":[[{\"node\":\"Merge\",\"type\":\"main\",\"index\":1}]]},\"Count Content\":{\"main\":[[{\"node\":\"If\",\"type\":\"main\",\"index\":0}]]},\"Simple Memory\":{\"ai_memory\":[[{\"node\":\"Message Intent\",\"type\":\"ai_memory\",\"index\":0}]]},\"Default Intent\":{\"main\":[[{\"node\":\"Route Message Intent\",\"type\":\"main\",\"index\":0}]]},\"Message Intent\":{\"main\":[[{\"node\":\"Default Intent\",\"type\":\"main\",\"index\":0}],[]]},\"Playlist Limit\":{\"main\":[[{\"node\":\"Numb of Videos\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Playlist or Video\",\"type\":\"main\",\"index\":0}]]},\"Process Status\":{\"main\":[[{\"node\":\"Update Context Intent\",\"type\":\"main\",\"index\":0}]]},\"Simple Memory3\":{\"ai_memory\":[[{\"node\":\"Numb of Videos\",\"type\":\"ai_memory\",\"index\":0}]]},\"Delete Collection\":{\"main\":[[{\"node\":\"Get Videos\",\"type\":\"main\",\"index\":0}]]},\"Playlist or Video\":{\"main\":[[{\"node\":\"Video HTTP Request\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Playlist HTTP Request\",\"type\":\"main\",\"index\":0}]]},\"Chat Buffer Memory\":{\"ai_memory\":[[{\"node\":\"Handle Queries\",\"type\":\"ai_memory\",\"index\":0}]]},\"Get Title and Desc\":{\"main\":[[{\"node\":\"Merge\",\"type\":\"main\",\"index\":1}]]},\"Video HTTP Request\":{\"main\":[[{\"node\":\"YouTube Transcript1\",\"type\":\"main\",\"index\":0},{\"node\":\"Get Title and Desc\",\"type\":\"main\",\"index\":0}]]},\"YouTube Transcript\":{\"main\":[[{\"node\":\"Split Out\",\"type\":\"main\",\"index\":0}]]},\"Chat Buffer Memory1\":{\"ai_memory\":[[{\"node\":\"AI Agent\",\"type\":\"ai_memory\",\"index\":0}]]},\"Default Data Loader\":{\"ai_document\":[[{\"node\":\"Qdrant Vector Store\",\"type\":\"ai_document\",\"index\":0}]]},\"Qdrant Vector Store\":{\"main\":[[{\"node\":\"Update Context Process Done1\",\"type\":\"main\",\"index\":0}]]},\"YouTube Transcript1\":{\"main\":[[{\"node\":\"Split Out2\",\"type\":\"main\",\"index\":0}]]},\"Qdrant Vector Store2\":{\"main\":[[{\"node\":\"Count Content\",\"type\":\"main\",\"index\":0}]]},\"Qdrant Vector Store3\":{\"ai_tool\":[[]],\"ai_vectorStore\":[[{\"node\":\"Answer questions with a vector store\",\"type\":\"ai_vectorStore\",\"index\":0}]]},\"Qdrant Vector Store4\":{\"ai_vectorStore\":[[{\"node\":\"Answer questions with a vector store1\",\"type\":\"ai_vectorStore\",\"index\":0}]]},\"Route Message Intent\":{\"main\":[[{\"node\":\"Process Status\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Handle Queries\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Handle Queries\",\"type\":\"main\",\"index\":0}]]},\"Playlist HTTP Request\":{\"main\":[[{\"node\":\"Get Playlist Videos Data\",\"type\":\"main\",\"index\":0}]]},\"Update Context Intent\":{\"main\":[[{\"node\":\"Qdrant Vector Store2\",\"type\":\"main\",\"index\":0}]]},\"Get Fields for Summary\":{\"main\":[[{\"node\":\"Full Summary\",\"type\":\"main\",\"index\":0}]]},\"Update Context Intent1\":{\"main\":[[{\"node\":\"Handle Queries\",\"type\":\"main\",\"index\":0}]]},\"Embeddings Google Gemini\":{\"ai_embedding\":[[{\"node\":\"Qdrant Vector Store\",\"type\":\"ai_embedding\",\"index\":0}]]},\"Get Playlist Videos Data\":{\"main\":[[{\"node\":\"Split Out1\",\"type\":\"main\",\"index\":0}]]},\"Google Gemini Chat Model\":{\"ai_languageModel\":[[{\"node\":\"Answer questions with a vector store1\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"Embeddings Google Gemini1\":{\"ai_embedding\":[[{\"node\":\"Qdrant Vector Store3\",\"type\":\"ai_embedding\",\"index\":0}]]},\"Embeddings Google Gemini2\":{\"ai_embedding\":[[{\"node\":\"Qdrant Vector Store4\",\"type\":\"ai_embedding\",\"index\":0}]]},\"Embeddings Google Gemini4\":{\"ai_embedding\":[[{\"node\":\"Qdrant Vector Store2\",\"type\":\"ai_embedding\",\"index\":0}]]},\"Google Gemini Chat Model1\":{\"ai_languageModel\":[[{\"node\":\"Handle Queries\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"Google Gemini Chat Model2\":{\"ai_languageModel\":[[{\"node\":\"Summarize & Analyze Transcript\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"Google Gemini Chat Model3\":{\"ai_languageModel\":[[{\"node\":\"Answer questions with a vector store\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"Google Gemini Chat Model4\":{\"ai_languageModel\":[[{\"node\":\"AI Agent\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"Google Gemini Chat Model6\":{\"ai_languageModel\":[[{\"node\":\"Message Intent\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"Google Gemini Chat Model8\":{\"ai_languageModel\":[[{\"node\":\"Numb of Videos\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"Structured Output Parser1\":{\"ai_outputParser\":[[{\"node\":\"Message Intent\",\"type\":\"ai_outputParser\",\"index\":0}]]},\"Get Previous Context Intent\":{\"main\":[[{\"node\":\"Message Intent\",\"type\":\"main\",\"index\":0}]]},\"Update Context Process Done1\":{\"main\":[[{\"node\":\"Get Fields for Summary\",\"type\":\"main\",\"index\":0}]]},\"Summarize & Analyze Transcript\":{\"main\":[[{\"node\":\"Edit Fields\",\"type\":\"main\",\"index\":0}]]},\"Recursive Character Text Splitter\":{\"ai_textSplitter\":[[{\"node\":\"Default Data Loader\",\"type\":\"ai_textSplitter\",\"index\":0}]]},\"Answer questions with a vector store\":{\"ai_tool\":[[{\"node\":\"Handle Queries\",\"type\":\"ai_tool\",\"index\":0}]]},\"Answer questions with a vector store1\":{\"ai_tool\":[[{\"node\":\"AI Agent\",\"type\":\"ai_tool\",\"index\":0}]]}}}",
  "readme": "# AI YouTube Playlist & Video Analyst Chatbot\n\nThis n8n workflow transforms entire YouTube playlists or single videos into interactive knowledge bases you can chat with. Ask questions and get summaries without needing to watch hours of content.\n\n## 🌟 How it Works\n\n  1. **🔗 Provide a Link:** Start by giving the workflow a URL for a YouTube playlist or a single video.\n  2. **📄 Content Retrieval:** The workflow automatically fetches the video details and transcripts for the provided link. For playlists, it can process multiple videos at once (you might be asked how many).\n  3. **🧠 AI Processing:** Google's Gemini AI reads through the transcripts, understands the content, and creates summaries.\n  4. **💾 Storage & Context:** The processed information and summaries are stored in a vector database (Qdrant), making them ready for conversation. **Context is managed using Redis** , remembering the current video/playlist you're discussing.\n  5. **💬 Chat & Ask:** Now, you can ask the AI agent questions about the playlist or video content! **Because context is maintained** , you can ask follow-up questions (like \"expand on point X\") without needing to provide the URL again.\n\n\n\n## 🛠️ Requirements\n\n  * **Community Node:** This workflow uses the `youtubeTranscripter` community node to fetch video transcripts. You'll need to install it in your n8n environment. \n    * **Installation:** `npm install n8n-nodes-youtube-transcription-dmr`\n    * **Important:** Community nodes require a **self-hosted n8n instance**.\n  * **Redis:** A Redis instance is required for managing conversation context and status between interactions.\n  * **Credentials:** You will need API credentials configured in your n8n instance for: \n    * Google Gemini (AI Models)\n    * Qdrant (Vector Store)\n    * Redis (Context Store)\n\n\n\n## 🤖 AI Agent Capabilities\n\nEngage with the AI agent to explore the video content. Since the agent remembers the context of your conversation, you can ask detailed follow-up questions naturally:\n\n  * Get a quick **summary** of a single video or an entire playlist.\n  * Ask for **key takeaways** or main topics discussed.\n  * Query for **specific information** mentioned in the videos.\n  * Ask the agent to **elaborate** on a specific point previously mentioned.\n  * Understand complex subjects **without watching** the full duration.\n\n\n\n## 🚀 Use Cases\n\n  * **📊 Content Analysis:** Quickly understand the themes and key points across a playlist or long video.\n  * **📚 Research & Learning:** Extract insights from educational series or tutorials efficiently.\n  * **✍️ Content Creation:** Easily repurpose video transcript information into blog posts, notes, or social media content.\n  * **⏱️ Save Time:** Get the essence of video content when you're short on time.\n  * **♿ Accessibility:** Offers a text-based way to interact with and understand video content.\n\n\n\n## ✨ Sample Prompts\n\n  * Please analyze this playlist and tell me the main topics covered: [YouTube Playlist URL]\n  * Summarize the first 5 videos in this playlist: [YouTube Playlist URL]\n  * _(Follow-up)_ Tell me more about the main point in video 3.\n  * What are the key points discussed in this video? [YouTube Video URL]\n  * _(Follow-up)_ Expand on the second key point you mentioned.\n  * Does the video at [YouTube Video URL] mention [specific topic]?\n\n\n",
  "readme_html": "<!--[--><div data-v-50766329=\"\"><h1>AI YouTube Playlist &amp; Video Analyst Chatbot</h1>\n<p>This n8n workflow transforms entire YouTube playlists or single videos into interactive knowledge bases you can chat with. Ask questions and get summaries without needing to watch hours of content.</p>\n<h2>🌟 How it Works</h2>\n<ol>\n<li><strong>🔗 Provide a Link:</strong> Start by giving the workflow a URL for a YouTube playlist or a single video.</li>\n<li><strong>📄 Content Retrieval:</strong> The workflow automatically fetches the video details and transcripts for the provided link. For playlists, it can process multiple videos at once (you might be asked how many).</li>\n<li><strong>🧠 AI Processing:</strong> Google's Gemini AI reads through the transcripts, understands the content, and creates summaries.</li>\n<li><strong>💾 Storage &amp; Context:</strong> The processed information and summaries are stored in a vector database (Qdrant), making them ready for conversation. <strong>Context is managed using Redis</strong>, remembering the current video/playlist you're discussing.</li>\n<li><strong>💬 Chat &amp; Ask:</strong> Now, you can ask the AI agent questions about the playlist or video content! <strong>Because context is maintained</strong>, you can ask follow-up questions (like \"expand on point X\") without needing to provide the URL again.</li>\n</ol>\n<h2>🛠️ Requirements</h2>\n<ul>\n<li><strong>Community Node:</strong> This workflow uses the <code>youtubeTranscripter</code> community node to fetch video transcripts. You'll need to install it in your n8n environment.\n<ul>\n<li><strong>Installation:</strong> <code>npm install n8n-nodes-youtube-transcription-dmr</code></li>\n<li><strong>Important:</strong> Community nodes require a <strong>self-hosted n8n instance</strong>.</li>\n</ul>\n</li>\n<li><strong>Redis:</strong> A Redis instance is required for managing conversation context and status between interactions.</li>\n<li><strong>Credentials:</strong> You will need API credentials configured in your n8n instance for:\n<ul>\n<li>Google Gemini (AI Models)</li>\n<li>Qdrant (Vector Store)</li>\n<li>Redis (Context Store)</li>\n</ul>\n</li>\n</ul>\n<h2>🤖 AI Agent Capabilities</h2>\n<p>Engage with the AI agent to explore the video content. Since the agent remembers the context of your conversation, you can ask detailed follow-up questions naturally:</p>\n<ul>\n<li>Get a quick <strong>summary</strong> of a single video or an entire playlist.</li>\n<li>Ask for <strong>key takeaways</strong> or main topics discussed.</li>\n<li>Query for <strong>specific information</strong> mentioned in the videos.</li>\n<li>Ask the agent to <strong>elaborate</strong> on a specific point previously mentioned.</li>\n<li>Understand complex subjects <strong>without watching</strong> the full duration.</li>\n</ul>\n<h2>🚀 Use Cases</h2>\n<ul>\n<li><strong>📊 Content Analysis:</strong> Quickly understand the themes and key points across a playlist or long video.</li>\n<li><strong>📚 Research &amp; Learning:</strong> Extract insights from educational series or tutorials efficiently.</li>\n<li><strong>✍️ Content Creation:</strong> Easily repurpose video transcript information into blog posts, notes, or social media content.</li>\n<li><strong>⏱️ Save Time:</strong> Get the essence of video content when you're short on time.</li>\n<li><strong>♿ Accessibility:</strong> Offers a text-based way to interact with and understand video content.</li>\n</ul>\n<h2>✨ Sample Prompts</h2>\n<ul>\n<li>Please analyze this playlist and tell me the main topics covered: [YouTube Playlist URL]</li>\n<li>Summarize the first 5 videos in this playlist: [YouTube Playlist URL]</li>\n<li><em>(Follow-up)</em> Tell me more about the main point in video 3.</li>\n<li>What are the key points discussed in this video? [YouTube Video URL]</li>\n<li><em>(Follow-up)</em> Expand on the second key point you mentioned.</li>\n<li>Does the video at [YouTube Video URL] mention [specific topic]?</li>\n</ul>\n</div><!--]-->",
  "readme_zh": "# AI YouTube播放列表与视频分析聊天机器人\n\n该n8n工作流能将整个YouTube播放列表或单个视频转化为可交互的知识库。无需观看数小时内容，通过问答即可获取摘要信息。\n\n## 🌟 工作原理\n\n1. **🔗 提供链接**：输入YouTube播放列表或视频URL\n2. **📄 内容获取**：自动抓取视频详情及字幕（处理播放列表时会询问处理数量）\n3. **🧠 AI处理**：通过Google Gemini AI解析字幕并生成摘要\n4. **💾 存储上下文**：处理后的数据存入Qdrant向量数据库，**通过Redis管理会话上下文**，记忆当前讨论内容\n5. **💬 智能对话**：可针对内容提问，**基于上下文记忆**支持连续追问（如\"详细说明X点\"），无需重复提供链接\n\n## 🛠️ 环境要求\n\n* **社区节点**：需安装`youtubeTranscripter`节点获取字幕\n  * 安装命令：`npm install n8n-nodes-youtube-transcription-dmr`\n  * **注意**：必须使用**自托管n8n实例**\n* **Redis**：用于维护会话上下文状态\n* **API密钥**：需配置以下服务的凭证：\n  * Google Gemini（AI模型）\n  * Qdrant（向量数据库）\n  * Redis（上下文存储）\n\n## 🤖 智能代理功能\n\n支持自然语言交互与连续追问：\n* 快速获取**单视频/整个播放列表摘要**\n* 查询**核心观点**或主题脉络\n* 定位视频中**特定信息**\n* 要求**延伸讲解**已提及的内容\n* **免观看**理解复杂内容\n\n## 🚀 应用场景\n\n* **📊 内容分析**：快速掌握长视频/系列主题\n* **📚 研究学习**：高效提取教学视频要点\n* **✍️ 内容创作**：将视频转录转化为博客/笔记\n* **⏱️ 省时工具**：快速获取视频精华\n* **♿ 无障碍访问**：文本化理解视频内容\n\n## ✨ 示例指令\n\n* 请分析该播放列表涵盖的主题：[播放列表链接]\n* 总结前5个视频内容：[播放列表链接]\n* （追问）详细说明视频3的核心观点\n* 本视频讨论了哪些要点？[视频链接]\n* （追问）展开你提到的第二个要点\n* [视频链接]中是否提及[特定主题]？",
  "title_zh": "AI YouTube播放列表与视频分析聊天机器人",
  "publish_date_zh": "上次更新于一个月前",
  "workflow_json_zh": "{\n  \"id\": \"4Tq5HZBdETVe7jEb\",\n  \"meta\": {\n    \"instanceId\": \"2cb7a61f866faf57392b91b31f47e08a2b3640258f0abd08dd71f087f3243a5a\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"name\": \"⚡AI-Powered YouTube Playlist & Video Summarization and Analysis v2\",\n  \"tags\": [],\n  \"nodes\": [\n    {\n      \"id\": \"505077d1-a2e4-4b0d-99d6-756940022c3d\",\n      \"name\": \"Google Gemini Chat Model1\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatGoogleGemini\",\n      \"position\": [\n        -440,\n        -40\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"modelName\": \"models/gemini-2.0-pro-exp\"\n      },\n      \"credentials\": {\n        \"googlePalmApi\": {\n          \"id\": \"2zwuT5znDglBrUCO\",\n          \"name\": \"Google Gemini(PaLM) Api account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"5da369db-b801-4653-888d-0e6042620298\",\n      \"name\": \"Handle Queries\",\n      \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n      \"position\": [\n        -160,\n        -280\n      ],\n      \"parameters\": {\n        \"text\": \"={{ $('Chat').item.json.chatInput }}\",\n        \"options\": {\n          \"systemMessage\": \"=You are an intelligent assistant that can respond to queries related to the content of a Youtube Playlist or a single Video.\\n\\n# YOUR TASK\\nDecide if the user has provided the info required and reply accordingly. If there is no url in context you have to suggest the user to provide one. \\n\\n\\n1. If the user provided a YouTube Playlist or Video URL: reply in structured markdown format to the user based on the formulated questions and context. Assume the user is here because they don't won't / have time to watch such videos so:\\n- Use the tool called `chat_playlist_data`, which can analyze YouTube videos. Use this tool effectively to process video content and generate structured summaries.\\n- Your answers needs to be exhaustive and minimise bullet points\\n- Be verbose in your response\\n\\n2. 1. If the user provided a YouTube Playlist or Video URL:\\n- Do not ask for more specific details - always try to summarize the videos with the data from the tool `chat_playlist_data`\\n- Never reply \\\"already provided a detailed summary\\\" - always try to summarize again the videos with more info from the tool `chat_playlist_data` - even if you have already provided the data before (so repeat yourself).\\n\\n3. If the user HAS NOT provided a YouTube Playlist URL or a invaid URL: gently invite the user to provide the URL so you can process it. \\n\\n# Rules\\n\\n## YouTube Playlist URL Definition\\n- A URL from www.youtube.com or youtube.com.\\n- Contains the query parameter `list=` followed by a playlist ID.\\n- Example: https://www.youtube.com/playlist?list=PLXXXXXX (where PLXXXXXX is the playlist ID).\\n\\n## YouTube Video URL Definition\\n- A URL from www.youtube.com, youtube.com, or youtu.be.\\n- For www.youtube.com or youtube.com, it contains the query parameter `v=` followed by a video ID.\\n- For youtu.be, it follows the format https://youtu.be/VIDEO_ID.\\n- Examples:\\n  - https://www.youtube.com/watch?v=VIDEO_ID (where VIDEO_ID is the video ID).\\n  - https://youtu.be/VIDEO_ID\\n- Does NOT have a query parameter `list=`\\n\\n# Context\\n{\\n  \\\"intent\\\": {{ $('Default Intent').item.json.output?.intent || \\\"NONE\\\" }},\\n  \\\"url\\\": {{ $('Default Intent').item.json.output?.url || \\\"\\\" }},\\n  \\\"id\\\": {{ $('Default Intent').item.json.output?.id || \\\"\\\" }},\\n  \\\"limit\\\": {{ $('Default Intent').item.json.output?.limit || 0 }},\\n  \\\"status\\\": {{ $('Default Intent').item.json.output?.status || 'PENDING' }}\\n}\"\n        },\n        \"promptType\": \"define\"\n      },\n      \"typeVersion\": 1.7\n    },\n    {\n      \"id\": \"866bf387-3482-4615-94d5-fd72d5db21da\",\n      \"name\": \"Split Out\",\n      \"type\": \"n8n-nodes-base.splitOut\",\n      \"position\": [\n        1380,\n        -200\n      ],\n      \"parameters\": {\n        \"include\": \"selectedOtherFields\",\n        \"options\": {},\n        \"fieldToSplitOut\": \"transcript\",\n        \"fieldsToInclude\": \"youtubeId\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"359404ce-4bc9-4e4d-9a26-22b9f9b176c9\",\n      \"name\": \"Summarize & Analyze Transcript\",\n      \"type\": \"@n8n/n8n-nodes-langchain.chainLlm\",\n      \"position\": [\n        660,\n        540\n      ],\n      \"parameters\": {\n        \"text\": \"=Please analyze the given text and create a structured summary following these guidelines:\\n\\n1. Break down the content into main topics using Level 2 headers (##)\\n2. Under each header:\\n   - List only the most essential concepts and key points\\n   - Use bullet points for clarity\\n   - Keep explanations concise\\n   - Preserve technical accuracy\\n   - Highlight key terms in bold\\n3. Format requirements:\\n   - Use markdown formatting\\n   - Keep bullet points simple (no nesting)\\n   - Bold important terms using **term**\\n   - Use tables for comparisons\\n   - Include relevant technical details\\n\\nPlease provide a clear, structured summary that captures the core concepts while maintaining technical accuracy.\\n\\n**Make sure the summary is 300-400 max characters long.**\\n\\nInclude metadata such as video number, id, and title in the summary.\\n\\n**Here is the text**\\n\\nVideo number: {{ $json.video_number }}\\nTitle: {{ $json.title }}\\nYoutube ID: {{ $json.youtubeId }}\\nTranscript:\\n{{ $json.transcript_text }}\",\n        \"promptType\": \"define\"\n      },\n      \"typeVersion\": 1.4\n    },\n    {\n      \"id\": \"036765df-6da4-4430-bcea-af4066fb7c24\",\n      \"name\": \"Concatenate\",\n      \"type\": \"n8n-nodes-base.summarize\",\n      \"position\": [\n        1700,\n        -200\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"fieldsToSplitBy\": \"youtubeId\",\n        \"fieldsToSummarize\": {\n          \"values\": [\n            {\n              \"field\": \"transcript.text\",\n              \"separateBy\": \" \",\n              \"aggregation\": \"concatenate\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"9152725c-15ca-41a0-8f98-108834e0c8be\",\n      \"name\": \"Split Out1\",\n      \"type\": \"n8n-nodes-base.splitOut\",\n      \"position\": [\n        660,\n        40\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"fieldToSplitOut\": \"videos\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"fee0e045-614a-41f0-ac75-051dff773e77\",\n      \"name\": \"Limit\",\n      \"type\": \"n8n-nodes-base.limit\",\n      \"position\": [\n        860,\n        40\n      ],\n      \"parameters\": {\n        \"maxItems\": \"={{ $('Update Context Intent').item.json.output.limit }}\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"a691c1c7-d8c4-4eab-861b-f7cfcbeb0fc8\",\n      \"name\": \"Qdrant Vector Store\",\n      \"type\": \"@n8n/n8n-nodes-langchain.vectorStoreQdrant\",\n      \"position\": [\n        1680,\n        480\n      ],\n      \"parameters\": {\n        \"mode\": \"insert\",\n        \"options\": {},\n        \"qdrantCollection\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $('Update Context Intent').first().json.output.id }}\"\n        }\n      },\n      \"credentials\": {\n        \"qdrantApi\": {\n          \"id\": \"mb8rw8tmUeP6aPJm\",\n          \"name\": \"QdrantApi account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"c3949e8f-0deb-4106-aaa5-e64403024243\",\n      \"name\": \"Recursive Character Text Splitter\",\n      \"type\": \"@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter\",\n      \"position\": [\n        1800,\n        860\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"chunkSize\": 1200,\n        \"chunkOverlap\": 200\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"a3b23c6b-14c0-4805-8220-7c6166268276\",\n      \"name\": \"Embeddings Google Gemini\",\n      \"type\": \"@n8n/n8n-nodes-langchain.embeddingsGoogleGemini\",\n      \"position\": [\n        1660,\n        700\n      ],\n      \"parameters\": {\n        \"modelName\": \"models/text-embedding-004\"\n      },\n      \"credentials\": {\n        \"googlePalmApi\": {\n          \"id\": \"2zwuT5znDglBrUCO\",\n          \"name\": \"Google Gemini(PaLM) Api account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"6f4ee00d-dcdc-4468-9713-115912c1e571\",\n      \"name\": \"Google Gemini Chat Model2\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatGoogleGemini\",\n      \"position\": [\n        640,\n        740\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"modelName\": \"models/gemini-2.0-flash\"\n      },\n      \"credentials\": {\n        \"googlePalmApi\": {\n          \"id\": \"2zwuT5znDglBrUCO\",\n          \"name\": \"Google Gemini(PaLM) Api account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"75442631-512e-4b0e-a5a8-ed3e3a3e1f94\",\n      \"name\": \"Embeddings Google Gemini1\",\n      \"type\": \"@n8n/n8n-nodes-langchain.embeddingsGoogleGemini\",\n      \"position\": [\n        -120,\n        320\n      ],\n      \"parameters\": {\n        \"modelName\": \"models/text-embedding-004\"\n      },\n      \"credentials\": {\n        \"googlePalmApi\": {\n          \"id\": \"2zwuT5znDglBrUCO\",\n          \"name\": \"Google Gemini(PaLM) Api account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"c33ceeca-9bf0-4dd2-b8df-fc2a1ccdf512\",\n      \"name\": \"Chat\",\n      \"type\": \"@n8n/n8n-nodes-langchain.chatTrigger\",\n      \"position\": [\n        -2780,\n        -460\n      ],\n      \"webhookId\": \"e66183cc-1eed-4968-b34b-bcecf1bb55e8\",\n      \"parameters\": {\n        \"public\": true,\n        \"options\": {\n          \"loadPreviousSession\": \"notSupported\"\n        },\n        \"initialMessages\": \"Hi there! 👋\\nPlease provide a URL of a Youtube playlist you would like me to analise.\"\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"06bb2dfd-027c-4902-9559-2de080f6c145\",\n      \"name\": \"Video Titles\",\n      \"type\": \"n8n-nodes-base.splitOut\",\n      \"position\": [\n        1160,\n        40\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"fieldToSplitOut\": \"id,title\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"d9bbdda2-ef26-4b6c-94d0-7542f88f1530\",\n      \"name\": \"Merge\",\n      \"type\": \"n8n-nodes-base.merge\",\n      \"position\": [\n        1700,\n        20\n      ],\n      \"parameters\": {\n        \"mode\": \"combineBySql\",\n        \"query\": \"SELECT \\n  ROW_NUMBER() AS video_number,\\n  input1.youtubeId, input2.title, input1.concatenated_transcript_text as transcript_text FROM input1 LEFT JOIN input2 ON input1.youtubeId = input2.id\"\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"e6febdb9-370b-478d-b470-d6c2d3314d7b\",\n      \"name\": \"Edit Fields\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        980,\n        540\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"b5e935c5-4973-40a3-adb9-fa76904d2ed9\",\n              \"name\": \"video_number\",\n              \"type\": \"number\",\n              \"value\": \"={{ $('Merge').item.json.video_number }}\"\n            },\n            {\n              \"id\": \"e98f417d-123f-4a85-b2f7-64430e7b0250\",\n              \"name\": \"youtubeId\",\n              \"type\": \"string\",\n              \"value\": \"={{ $('Merge').item.json.youtubeId }}\"\n            },\n            {\n              \"id\": \"d0ced7fd-c9a3-4a09-bf09-e4b5e45dd03d\",\n              \"name\": \"title\",\n              \"type\": \"string\",\n              \"value\": \"={{ $('Merge').item.json.title }}\"\n            },\n            {\n              \"id\": \"31a80e6d-9b02-4d21-b888-1a00c036a04b\",\n              \"name\": \"summary\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.text }}\"\n            },\n            {\n              \"id\": \"ef12f3f2-3d63-4e78-835f-7da004393a07\",\n              \"name\": \"transcript_text\",\n              \"type\": \"string\",\n              \"value\": \"={{ $('Merge').item.json.transcript_text }}\"\n            },\n            {\n              \"id\": \"afa841e2-6f8b-4b27-9f28-10368ee32c2e\",\n              \"name\": \"playlistId\",\n              \"type\": \"string\",\n              \"value\": \"={{ $('Update Context Intent').first().json.output.id }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"2736a1e6-a982-4f60-aa8d-658e9a3e9193\",\n      \"name\": \"AI Agent\",\n      \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n      \"position\": [\n        2720,\n        480\n      ],\n      \"parameters\": {\n        \"text\": \"=Please analyze the given \\\"Transcript summary\\\" and create a full summary overview, following the below guidelines.\\n\\n1. Provide a full descriptive break down of the content of each video. Assume the user does not won't or have time to watch such videos, so:\\n- Your summary needs to be exhaustive, descriptive, and minimise bullet points\\n- Your summary needs to captures all the core concepts while maintaining technical accuracy\\n- Your summary will be verbose\\n\\n2. Consider that the intent of the user is not to watch the videos but rather have all the content required and summaries from on the \\\"Transcript summary\\\".\\n\\n3. Use the tool called `chat_playlist_data`, which can analyze YouTube videos. Use this tool effectively to process video content and generate structured summaries.\\n\\nUser message:\\n{{ $('Chat').item.json.chatInput }}\\n\\nTranscript summary:\\n{{ $('Full Summary').item.json.concatenated_summary }}\",\n        \"agent\": \"conversationalAgent\",\n        \"options\": {},\n        \"promptType\": \"define\"\n      },\n      \"executeOnce\": true,\n      \"typeVersion\": 1.7\n    },\n    {\n      \"id\": \"cf1e5c50-9c89-465f-beca-482cbd9affba\",\n      \"name\": \"Google Gemini Chat Model4\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatGoogleGemini\",\n      \"position\": [\n        2520,\n        720\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"modelName\": \"models/gemini-2.0-flash\"\n      },\n      \"credentials\": {\n        \"googlePalmApi\": {\n          \"id\": \"2zwuT5znDglBrUCO\",\n          \"name\": \"Google Gemini(PaLM) Api account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"1cbcec5e-b58c-4fce-b944-08c47a7385db\",\n      \"name\": \"Delete Collection\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"onError\": \"continueRegularOutput\",\n      \"position\": [\n        1340,\n        480\n      ],\n      \"parameters\": {\n        \"url\": \"=https://3114dbb7-bd13-4807-8815-c3c8784f66d6.eu-west-1-0.aws.cloud.qdrant.io/collections/{{ $('Update Context Intent').first().json.playlistID }}/points/delete\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"jsonBody\": \"{\\n  \\\"filter\\\": {}\\n}\",\n        \"sendBody\": true,\n        \"sendHeaders\": true,\n        \"specifyBody\": \"json\",\n        \"authentication\": \"predefinedCredentialType\",\n        \"headerParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"Content-Type\",\n              \"value\": \"application/json\"\n            }\n          ]\n        },\n        \"nodeCredentialType\": \"qdrantApi\"\n      },\n      \"credentials\": {\n        \"qdrantApi\": {\n          \"id\": \"mb8rw8tmUeP6aPJm\",\n          \"name\": \"QdrantApi account\"\n        }\n      },\n      \"executeOnce\": true,\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"16d7eaec-1d98-42dd-89aa-2681a9d1697d\",\n      \"name\": \"Default Data Loader\",\n      \"type\": \"@n8n/n8n-nodes-langchain.documentDefaultDataLoader\",\n      \"position\": [\n        1820,\n        700\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"metadata\": {\n            \"metadataValues\": [\n              {\n                \"name\": \"video_number\",\n                \"value\": \"={{ $input.item.json.video_number }}\"\n              },\n              {\n                \"name\": \"=youtubeId\",\n                \"value\": \"={{ $input.item.json.youtubeId }}\"\n              },\n              {\n                \"name\": \"summary\",\n                \"value\": \"={{ $input.item.json.summary }}\"\n              },\n              {\n                \"name\": \"title\",\n                \"value\": \"={{ $input.item.json.title }}\"\n              },\n              {\n                \"name\": \"playlistId\",\n                \"value\": \"={{ $input.item.json.playlistId }}\"\n              }\n            ]\n          }\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"d3bc9db2-7618-46fd-b825-2cc0ad45fc22\",\n      \"name\": \"Chat Buffer Memory\",\n      \"type\": \"@n8n/n8n-nodes-langchain.memoryBufferWindow\",\n      \"position\": [\n        -260,\n        -40\n      ],\n      \"parameters\": {\n        \"sessionKey\": \"={{ $('Chat').item.json.sessionId }}\",\n        \"sessionIdType\": \"customKey\",\n        \"contextWindowLength\": 10\n      },\n      \"typeVersion\": 1.3\n    },\n    {\n      \"id\": \"fb55b13f-880f-404c-9446-9f8a238c8a5c\",\n      \"name\": \"Full Summary\",\n      \"type\": \"n8n-nodes-base.summarize\",\n      \"position\": [\n        2520,\n        480\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"fieldsToSummarize\": {\n          \"values\": [\n            {\n              \"field\": \"summary\",\n              \"separateBy\": \"\\n\",\n              \"aggregation\": \"concatenate\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"efc2fc99-c738-425e-9ee1-669e378e197f\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -560,\n        -400\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 1080,\n        \"height\": 900,\n        \"content\": \"## RAG与用户查询回复\\n- 通过检索增强生成技术获取并提供用户查询的答案\\n- 处理无特定路由规则的消息\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"0040adf6-2cfc-4b79-ba81-b76740bfd158\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        560,\n        -400\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 1380,\n        \"height\": 700,\n        \"content\": \"## 获取并准备播放列表视频转录文本数据以供处理\\n- 收集并整理播放列表中的视频转录文本\\n- 为分析与摘要任务准备数据\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"59b29fc5-5d88-40c0-a273-9dc71d9f009e\",\n      \"name\": \"Chat Buffer Memory1\",\n      \"type\": \"@n8n/n8n-nodes-langchain.memoryBufferWindow\",\n      \"position\": [\n        2700,\n        720\n      ],\n      \"parameters\": {\n        \"sessionKey\": \"={{ $('Chat').item.json.sessionId }}\",\n        \"sessionIdType\": \"customKey\",\n        \"contextWindowLength\": 10\n      },\n      \"typeVersion\": 1.3\n    },\n    {\n      \"id\": \"afb6f6be-d299-402e-a9c6-2c60fbf4974e\",\n      \"name\": \"YouTube Transcript\",\n      \"type\": \"n8n-nodes-youtube-transcription-dmr.youtubeTranscripter\",\n      \"position\": [\n        1160,\n        -200\n      ],\n      \"parameters\": {\n        \"videoId\": \"={{ $json.id }}\",\n        \"continueOnFail\": true\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"9a43eb4a-9d4c-4fce-b19c-94485aa8af76\",\n      \"name\": \"Sticky Note4\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        560,\n        340\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 640,\n        \"height\": 700,\n        \"content\": \"## 总结与分析转录文本\\n- 从转录文本中生成摘要数据\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"676677f0-3dae-4873-a449-92930ced534e\",\n      \"name\": \"Sticky Note5\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1240,\n        340\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 980,\n        \"height\": 700,\n        \"content\": \"## 存储嵌入向量\\n- 保存嵌入数据以供后续使用\\n- 更新当前上下文以维持对话连贯性\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"9ecd4d0d-b8bd-4a5d-981f-49fa515c17be\",\n      \"name\": \"Sticky Note6\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        2260,\n        340\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 940,\n        \"height\": 880,\n        \"content\": \"## 首次摘要分析\\n- 对汇总数据进行初步分析\\n- 向用户反馈经处理的文字记录中的洞察\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"45ae8377-0848-45fb-a7a3-aba8d44e3d35\",\n      \"name\": \"Message Intent\",\n      \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n      \"onError\": \"continueRegularOutput\",\n      \"position\": [\n        -2260,\n        -460\n      ],\n      \"parameters\": {\n        \"text\": \"= {{ $('Chat').item.json.chatInput }}\",\n        \"options\": {\n          \"systemMessage\": \"=**# YOUR TASK:**\\nPlease analyze the user's message and decide if the user has provided the info required - and ALWAYS reply using the **Output format** defined below.\\n\\n# Output format\\nYou use the following JSON structure to reply, don't include anything else, and alway inlude all the fields:\\n```\\n{\\n  \\\"intent\\\": PLAYLIST|VIDEO|NONE,\\n  \\\"url\\\": Youtube Playlist or Video URL or empty string,\\n  \\\"id\\\": Youtube Playlist or Video ID or empty string,\\n  \\\"limit\\\": number, default 0,\\n  \\\"status\\\": Previous context status `{{ $json.context_intent?.status }}` or \\\"PENDING\\\"\\n}\\n```\\n\\n## INTENT field GUIDELINES:\\n\\n**Respond with \\\"PLAYLIST\\\" if:**\\n- The messsage contains a valid Youtube Playlist URL\\n\\n**Respond with \\\"VIDEO\\\" if:**\\n- The messsage contains a valid Youtube Video URL\\n\\n**Respond with \\\"NONE\\\" if:**\\n- The messsage does not contains a valid Youtube Playlist or Video URL\\n\\n## LIMIT field GUIDELINE:\\nIf the \\\"Previous Context\\\" intent or the current intent is a Playlist: Based on current or most recent user message, check if there is an indication of how many videos to process, otherwise default to 0.\\n\\n## STATUS field GUIDELINE\\nIf intent is a Playlist or Video and _different_ from the the \\\"Previous Context\\\" then use \\\"PENDING\\\" since the user intent is to run a new process. Otherwise use the \\\"Previous Context\\\" status value.\\n\\n\\n# Rules for Playlist and Video\\n\\n## YouTube Playlist URL Definition\\n- A URL from www.youtube.com or youtube.com.\\n- Contains the query parameter `&list=` followed by a playlist ID.\\n- Example: https://www.youtube.com/...&list=PLXXXXXX (where PLXXXXXX is the playlist ID).\\n\\n## YouTube Video URL Definition\\n- A URL from www.youtube.com, youtube.com, or youtu.be.\\n- For www.youtube.com or youtube.com, it contains the query parameter `v=` followed by a video ID.\\n- For youtu.be, it follows the format https://youtu.be/VIDEO_ID.\\n- Examples:\\n  - https://www.youtube.com/watch?v=VIDEO_ID (where VIDEO_ID is the video ID).\\n  - https://youtu.be/VIDEO_ID\\n- IMPORTANT: YouTube Video URL **Does NOT have a query parameter `list=`**\\n\\n\\n# Previous Context\\n{{ JSON.stringify($json.context_intent) }}\\n\"\n        },\n        \"promptType\": \"define\",\n        \"hasOutputParser\": true\n      },\n      \"retryOnFail\": true,\n      \"typeVersion\": 1.7,\n      \"alwaysOutputData\": true\n    },\n    {\n      \"id\": \"a29403f0-ed5c-465c-a43d-84e8dee69662\",\n      \"name\": \"Structured Output Parser1\",\n      \"type\": \"@n8n/n8n-nodes-langchain.outputParserStructured\",\n      \"position\": [\n        -2020,\n        -220\n      ],\n      \"parameters\": {\n        \"jsonSchemaExample\": \"{\\n  \\\"intent\\\": \\\"PLAYLIST|VIDEO|NONE\\\",\\n  \\\"url\\\": \\\"Youtube Playlist or Video URL or empty string,\\\",\\n  \\\"id\\\": \\\"Youtube Playlist or Video ID or empty string,\\\",\\n  \\\"limit\\\": \\\"number of playlist videos to process or 0\\\",\\n  \\\"status\\\": \\\"PENDING|READY|DONE\\\"\\n}\"\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"b3f43325-aa7b-47f3-8bbb-e27fa0c44a1e\",\n      \"name\": \"Update Context Intent\",\n      \"type\": \"n8n-nodes-base.redis\",\n      \"position\": [\n        -1160,\n        -640\n      ],\n      \"parameters\": {\n        \"key\": \"=context_intent_{{ $('Chat').item.json.sessionId }}\",\n        \"value\": \"=intent {{ $('Process Status').item.json.output?.intent || null }} url {{ $('Process Status').item.json.output?.url || \\\"\\\" }} id {{ $('Process Status').item.json.output?.id || \\\"\\\" }} limit {{ $('Process Status').item.json.output?.limit || 0 }} status {{ $('Process Status').item.json.output?.status || 'PENDING'  }}\",\n        \"keyType\": \"hash\",\n        \"operation\": \"set\",\n        \"valueIsJSON\": false\n      },\n      \"credentials\": {\n        \"redis\": {\n          \"id\": \"mA0f9F1ROUThyrRW\",\n          \"name\": \"Redis account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"9c296501-049c-44b5-ae8d-8dda2c523278\",\n      \"name\": \"Get Previous Context Intent\",\n      \"type\": \"n8n-nodes-base.redis\",\n      \"onError\": \"continueRegularOutput\",\n      \"position\": [\n        -2440,\n        -460\n      ],\n      \"parameters\": {\n        \"key\": \"=context_intent_{{ $('Chat').item.json.sessionId }}\",\n        \"keyType\": \"hash\",\n        \"options\": {\n          \"dotNotation\": false\n        },\n        \"operation\": \"get\",\n        \"valueIsJSON\": false,\n        \"propertyName\": \"context_intent\"\n      },\n      \"credentials\": {\n        \"redis\": {\n          \"id\": \"mA0f9F1ROUThyrRW\",\n          \"name\": \"Redis account\"\n        }\n      },\n      \"typeVersion\": 1,\n      \"alwaysOutputData\": true\n    },\n    {\n      \"id\": \"9499d9f2-7d6d-432b-bdde-b4b98b90b224\",\n      \"name\": \"Route Message Intent\",\n      \"type\": \"n8n-nodes-base.switch\",\n      \"position\": [\n        -1700,\n        -460\n      ],\n      \"parameters\": {\n        \"rules\": {\n          \"values\": [\n            {\n              \"outputKey\": \"PROCESS\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"44e008af-4a1a-429d-adb6-039e74b643a6\",\n                    \"operator\": {\n                      \"type\": \"boolean\",\n                      \"operation\": \"true\",\n                      \"singleValue\": true\n                    },\n                    \"leftValue\": \"={{ \\n  ($json.output.intent == \\\"VIDEO\\\" || $json.output.intent == \\\"PLAYLIST\\\")\\n  && $json.output.status != \\\"DONE\\\" \\n}}\",\n                    \"rightValue\": \"/PLAYLIST|VIDEO/\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            },\n            {\n              \"outputKey\": \"QUERY\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"12641857-945d-4470-968e-f3f805bfe1cd\",\n                    \"operator\": {\n                      \"type\": \"boolean\",\n                      \"operation\": \"true\",\n                      \"singleValue\": true\n                    },\n                    \"leftValue\": \"={{ \\n  $json.output.intent == \\\"NONE\\\" || $json.output.status == \\\"DONE\\\"\\n}}\",\n                    \"rightValue\": \"NONE\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            }\n          ]\n        },\n        \"options\": {\n          \"fallbackOutput\": \"extra\"\n        }\n      },\n      \"typeVersion\": 3.2\n    },\n    {\n      \"id\": \"dfd329e8-98b1-4ae8-8cc1-a1a5215b1c09\",\n      \"name\": \"Process Status\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        -1340,\n        -640\n      ],\n      \"parameters\": {\n        \"jsCode\": \"// Loop over input items and add a new field called 'myNewField' to the JSON of each one\\nif ($input.last().json.output.intent == 'VIDEO') {\\n  $input.last().json.output.status = 'READY'\\n}\\n\\nelse if ($input.last().json.output.intent == 'PLAYLIST' && parseInt($input.last().json.output.limit) > 0) {\\n  $input.last().json.output.status = 'READY'\\n}\\n\\nelse {\\n  $input.last().json.output = {\\n    intent: $('Default Intent').first().json.output.intent,\\n    url: $('Default Intent').first().json.output.url,\\n    id: $('Default Intent').first().json.output.id,\\n    limit: $('Default Intent').first().json.output.limit,\\n    status: 'PENDING',\\n  }\\n}\\n\\n\\nreturn $input.all();\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"c84c21c6-0948-4628-b7a8-7cd2a5602cdc\",\n      \"name\": \"Simple Memory\",\n      \"type\": \"@n8n/n8n-nodes-langchain.memoryBufferWindow\",\n      \"position\": [\n        -2180,\n        -220\n      ],\n      \"parameters\": {\n        \"sessionKey\": \"=intent_{{ $('Chat').item.json.sessionId }}\",\n        \"sessionIdType\": \"customKey\"\n      },\n      \"typeVersion\": 1.3\n    },\n    {\n      \"id\": \"8ad2e1d1-b657-47cd-afa5-4fc49dc7e0e6\",\n      \"name\": \"Simple Memory3\",\n      \"type\": \"@n8n/n8n-nodes-langchain.memoryBufferWindow\",\n      \"position\": [\n        1040,\n        -1180\n      ],\n      \"parameters\": {\n        \"sessionKey\": \"=pl_n_{{ $('Chat').item.json.sessionId }}\",\n        \"sessionIdType\": \"customKey\"\n      },\n      \"typeVersion\": 1.3\n    },\n    {\n      \"id\": \"cf4d7c73-d9b1-42da-9ccc-6abccde4110c\",\n      \"name\": \"Sticky Note7\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -2540,\n        -620\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 1080,\n        \"height\": 580,\n        \"content\": \"## 消息意图路由\\n- 获取先前上下文以保持连续性\\n- 在处理前确保数据完整性\\n- 根据意图路由传入消息\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"c0ecf826-b803-421a-aa2a-cb713131fbb7\",\n      \"name\": \"Google Gemini Chat Model6\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatGoogleGemini\",\n      \"position\": [\n        -2340,\n        -220\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"modelName\": \"models/gemini-2.0-flash-lite\"\n      },\n      \"credentials\": {\n        \"googlePalmApi\": {\n          \"id\": \"2zwuT5znDglBrUCO\",\n          \"name\": \"Google Gemini(PaLM) Api account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"513a8c71-e982-47df-87bd-1e3d3ae9c613\",\n      \"name\": \"Sticky Note9\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -1420,\n        -1020\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 460,\n        \"height\": 580,\n        \"content\": \"## 更新上下文\\n- 修正上下文中发现的任何问题。\\n- 为工作流程推进准备数据。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"d4a9d7aa-dfee-418f-900a-9649f0405861\",\n      \"name\": \"Sticky Note10\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        800,\n        -1480\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 480,\n        \"height\": 460,\n        \"content\": \"## 询问需要处理的播放列表视频数量\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"f89481a4-64a2-4895-821f-effe48f7d331\",\n      \"name\": \"Numb of Videos\",\n      \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n      \"position\": [\n        900,\n        -1380\n      ],\n      \"parameters\": {\n        \"text\": \"={{ $('Chat').item.json.chatInput }}\",\n        \"options\": {\n          \"systemMessage\": \"=**Objective:**\\n\\nWe are here because the user wants to analyse a playlist in context, but we are missing how many videos he would like to process. Please reply to the user asking user to provide a number.\\n\\n## Context\\n{{ JSON.stringify($json.output) }}\"\n        },\n        \"promptType\": \"define\"\n      },\n      \"typeVersion\": 1.7\n    },\n    {\n      \"id\": \"bb8fa898-4953-4148-8339-2d205b86fc91\",\n      \"name\": \"Default Intent\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        -1920,\n        -460\n      ],\n      \"parameters\": {\n        \"jsCode\": \"if(\\n  ($('Message Intent').first().json?.output?.intent == 'NONE' \\n     || Object.keys($('Message Intent').first().json?.output || {}).length == 0)\\n  && Object.keys($('Get Previous Context Intent').first().json.context_intent).length > 0\\n) {\\n  //use prev context intent\\n  if(!$input.first().json.output) {\\n    $input.first().json.output = {}\\n  }\\n  $input.first().json.output.intent = $('Get Previous Context Intent').first().json.context_intent?.intent || \\\"NONE\\\";\\n  $input.first().json.output.url = $('Get Previous Context Intent').first().json.context_intent?.url || \\\"\\\";\\n  $input.first().json.output.id = $('Get Previous Context Intent').first().json.context_intent?.id || \\\"\\\";\\n  $input.first().json.output.limit = $('Get Previous Context Intent').first().json.context_intent?.limit || 0;\\n  $input.first().json.output.status = $('Get Previous Context Intent').first().json.context_intent?.status || \\\"PENDING\\\";\\n} else {\\n  // $input.first().json.output.intent = $('Message Intent').first().json.context_intent?.intent || \\\"NONE\\\";\\n  // $input.first().json.output.url = $('Message Intent').first().json.context_intent?.url || \\\"\\\";\\n  // $input.first().json.output.id = $('Message Intent').first().json.context_intent?.id || \\\"\\\";\\n  // $input.first().json.output.limit = $('Message Intent').first().json.context_intent?.limit || 0;\\n  // $input.first().json.output.status = $('Message Intent').first().json.context_intent?.status || \\\"PENDING\\\";\\n}\\n\\n// else use message intent\\n\\nreturn $input.all();\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"0f1d1bb6-22c0-4b65-beaf-eaf4401d7550\",\n      \"name\": \"Playlist Limit\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        160,\n        -860\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"6ee01f0a-9533-4fb3-b023-cfcc422d9011\",\n              \"operator\": {\n                \"name\": \"filter.operator.equals\",\n                \"type\": \"string\",\n                \"operation\": \"equals\"\n              },\n              \"leftValue\": \"={{ $('Process Status').item.json.output.intent }}\",\n              \"rightValue\": \"PLAYLIST\"\n            },\n            {\n              \"id\": \"e9575bb2-3c60-498b-b2c7-436b62e5195c\",\n              \"operator\": {\n                \"type\": \"number\",\n                \"operation\": \"lte\"\n              },\n              \"leftValue\": \"={{ parseInt($('Process Status').item.json.output.limit) }}\",\n              \"rightValue\": 0\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"083c17aa-de83-4f3c-8d71-f665903ce3d5\",\n      \"name\": \"Playlist or Video\",\n      \"type\": \"n8n-nodes-base.switch\",\n      \"position\": [\n        160,\n        -640\n      ],\n      \"parameters\": {\n        \"rules\": {\n          \"values\": [\n            {\n              \"outputKey\": \"VIDEO\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"cc3ec644-7c3d-4d9f-b7a7-89b85824e3e3\",\n                    \"operator\": {\n                      \"name\": \"filter.operator.equals\",\n                      \"type\": \"string\",\n                      \"operation\": \"equals\"\n                    },\n                    \"leftValue\": \"={{ $('Route Message Intent').item.json.output.intent }}\",\n                    \"rightValue\": \"VIDEO\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            },\n            {\n              \"outputKey\": \"PLAYLIST\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"33beac83-b96b-4e76-9d18-e22df163ea4d\",\n                    \"operator\": {\n                      \"type\": \"string\",\n                      \"operation\": \"equals\"\n                    },\n                    \"leftValue\": \"={{ $('Route Message Intent').item.json.output.intent }}\",\n                    \"rightValue\": \"PLAYLIST\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            }\n          ]\n        },\n        \"options\": {}\n      },\n      \"typeVersion\": 3.2\n    },\n    {\n      \"id\": \"0626bc2d-9e3a-4a4f-a331-62e8b6c69840\",\n      \"name\": \"Get Fields for Summary\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        2340,\n        480\n      ],\n      \"parameters\": {\n        \"jsCode\": \"return $('Edit Fields').all();\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"4aaaed18-ce90-4296-aba2-b5fa9492655d\",\n      \"name\": \"Update Context Process Done1\",\n      \"type\": \"n8n-nodes-base.redis\",\n      \"position\": [\n        2040,\n        480\n      ],\n      \"parameters\": {\n        \"key\": \"=context_intent_{{ $('Chat').first().json.sessionId }}\",\n        \"value\": \"=intent {{ $('Process Status').first().json.output?.intent || null }} url {{ $('Process Status').first().json.output?.url || \\\"\\\" }} id {{ $('Process Status').first().json.output?.id || \\\"\\\" }} limit {{ $('Process Status').first().json.output?.limit || 0 }} status DONE\",\n        \"keyType\": \"hash\",\n        \"operation\": \"set\",\n        \"valueIsJSON\": false\n      },\n      \"credentials\": {\n        \"redis\": {\n          \"id\": \"mA0f9F1ROUThyrRW\",\n          \"name\": \"Redis account\"\n        }\n      },\n      \"executeOnce\": true,\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"d3f71d59-a158-43e2-bfbd-a3bec20dea5b\",\n      \"name\": \"Google Gemini Chat Model8\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatGoogleGemini\",\n      \"position\": [\n        880,\n        -1180\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"modelName\": \"models/gemini-2.0-flash-thinking-exp\"\n      },\n      \"credentials\": {\n        \"googlePalmApi\": {\n          \"id\": \"2zwuT5znDglBrUCO\",\n          \"name\": \"Google Gemini(PaLM) Api account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"fa6b8a79-436e-4742-9732-cd5c1b2d3c88\",\n      \"name\": \"Playlist HTTP Request\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        660,\n        -200\n      ],\n      \"parameters\": {\n        \"url\": \"={{ $('Update Context Intent').item.json.output.url }}\",\n        \"options\": {}\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"99d6da96-8983-4e7d-8343-b9ac975f5d20\",\n      \"name\": \"YouTube Transcript1\",\n      \"type\": \"n8n-nodes-youtube-transcription-dmr.youtubeTranscripter\",\n      \"position\": [\n        1200,\n        -860\n      ],\n      \"parameters\": {\n        \"videoId\": \"={{ $('Update Context Intent').item.json.output.id }}\",\n        \"continueOnFail\": true\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"41a07802-3fba-42fa-8482-f526a7e1b173\",\n      \"name\": \"Video HTTP Request\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        900,\n        -860\n      ],\n      \"parameters\": {\n        \"url\": \"={{ $('Update Context Intent').item.json.output.url }}\",\n        \"options\": {}\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"02103114-9c22-49b1-9dee-746b84cdef66\",\n      \"name\": \"Get Title and Desc\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        1200,\n        -640\n      ],\n      \"parameters\": {\n        \"jsCode\": \"/**\\n * This code node contains a modified version of play-dl,\\n * which is licensed under the GNU General Public License Version 3 (GPLv3).\\n *\\n * Original Library Name: play-dl\\n * Original Library Source: https://github.com/play-dl/play-dl/tree/main\\n * Original Library License: GNU General Public License Version 3 (GPLv3)\\n * (See: https://www.gnu.org/licenses/gpl-3.0.en.html)\\n *\\n * Modifications were made to the original library for use within this N8N workflow.\\n * These modifications are also licensed under the GNU General Public License Version 3 (GPLv3).\\n *\\n * This program is distributed in the hope that it will be useful,\\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\\n * GNU General Public License for more details.\\n *\\n * You should have received a copy of the GNU General Public License\\n * along with this program.  If not, see <https://www.gnu.org/licenses/>.\\n */\\n\\n\\n/**\\n * Basic function to get specific data (title, description, duration)\\n * from pre-fetched HTML body data of a YouTube video page.\\n * Assumes the HTML body is passed as the first argument.\\n *\\n * @param {string} body HTML body data of the YouTube video page.\\n * @param {string} video_id YouTube video ID.\\n * @param {string} url YouTube video URL.\\n * @returns {Promise<{title: string, description: string, duration: number}>} Video Basic Info.\\n * @throws {Error} If video ID cannot be extracted, captcha is detected,\\n * or necessary data cannot be parsed.\\n */\\nasync function video_basic_info(body, video_id, url) {\\n  // --- Input Validation ---\\n  if (typeof body !== 'string') {\\n    throw new Error('body parameter must be a string of HTML');\\n  }\\n  if (typeof video_id !== 'string' || !video_id.trim()) {\\n    throw new Error('video_id parameter must be a non-empty string');\\n  }\\n  if (typeof url !== 'string' || !url.trim()) {\\n    throw new Error('url parameter must be a non-empty URL string');\\n  }\\n\\n  // --- Captcha Check ---\\n  // Added check for consent page as well\\n  if (body.includes('Our systems have detected unusual traffic') || body.includes('consent.google.com')) {\\n    throw new Error('Captcha or Consent page encountered: YouTube likely requires interaction or detected bot-like activity.');\\n  }\\n\\n  // --- Extract Player Data ---\\n  let player_data;\\n  try {\\n    // More robust regex to find ytInitialPlayerResponse, stopping at the next semicolon\\n    const player_data_match = body.match(/var ytInitialPlayerResponse\\\\s*=\\\\s*({.+?});\\\\s*(?:var |<\\\\/script)/);\\n    if (!player_data_match || !player_data_match[1]) {\\n      // Fallback attempt with simpler split (less reliable)\\n      const split_data = body.split('var ytInitialPlayerResponse = ');\\n      player_data = split_data?.[1]?.split(';</script>')?.[0];\\n    } else {\\n      player_data = player_data_match[1];\\n    }\\n\\n    if (!player_data) {\\n      // Check for common failure indicators in the HTML if data isn't found\\n      if (body.includes('<title>YouTube</title>') && !body.includes('videoDetails')) {\\n        throw new Error('Could not find ytInitialPlayerResponse data. The page might be a generic YouTube page, not a video page, or the structure changed.');\\n      }\\n      throw new Error('Could not find ytInitialPlayerResponse data.');\\n    }\\n  } catch (error) {\\n    console.log(\\\"Error during player_data extraction:\\\", error);\\n    throw new Error(`Failed during player data extraction: ${error}`);\\n  }\\n\\n\\n  let player_response;\\n  try {\\n    player_response = JSON.parse(player_data);\\n  } catch (e) {\\n    console.log(\\\"Raw player_data that failed parsing:\\\", player_data.substring(0, 500) + '...'); // Log start of data\\n    throw new Error(`Failed to parse ytInitialPlayerResponse JSON: ${e}`);\\n  }\\n\\n  // --- Extract Required Video Details ---\\n  // Use optional chaining for safety\\n  const vid = player_response?.videoDetails;\\n\\n  // Add more robust checking, including playability status\\n  if (!vid) {\\n    const playabilityStatus = player_response?.playabilityStatus;\\n    let reason = \\\"videoDetails object not found in the response.\\\";\\n    if (playabilityStatus?.status && playabilityStatus.status !== 'OK') {\\n      reason = ` Playability status: ${playabilityStatus.status}. Reason: ${playabilityStatus.reason ||\\n        playabilityStatus.errorScreen?.playerErrorMessageRenderer?.reason?.simpleText ||\\n        playabilityStatus.errorScreen?.playerKavRenderer?.reason?.simpleText ||\\n        'No specific reason provided.'\\n        }`;\\n    } else if (playabilityStatus?.status === 'OK' && !vid) {\\n      reason = \\\" Playability status is OK, but videoDetails is still missing. Response structure might have changed.\\\";\\n    }\\n    throw new Error(`Could not get video details. ${reason}`);\\n  }\\n\\n  // --- Return Simplified Data ---\\n  // Ensure values exist before accessing, provide defaults if necessary\\n  return {\\n    title: vid.title || 'N/A',\\n    description: vid.shortDescription || '', // Default to empty string if missing\\n    duration: Number(vid.lengthSeconds) || 0, // Default to 0 if missing/invalid\\n  };\\n}\\n\\n\\nreturn video_basic_info($input.first().json.data, $('Update Context Intent').first().json.output.id, $('Update Context Intent').first().json.output.url);\"\n      },\n      \"retryOnFail\": true,\n      \"typeVersion\": 2,\n      \"alwaysOutputData\": true,\n      \"waitBetweenTries\": 500\n    },\n    {\n      \"id\": \"6cea694e-0147-4cd0-a601-9b232813a1d3\",\n      \"name\": \"Split Out2\",\n      \"type\": \"n8n-nodes-base.splitOut\",\n      \"position\": [\n        1440,\n        -860\n      ],\n      \"parameters\": {\n        \"include\": \"selectedOtherFields\",\n        \"options\": {},\n        \"fieldToSplitOut\": \"transcript\",\n        \"fieldsToInclude\": \"youtubeId\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"c479fb51-e17d-477a-b40b-65458cc3e679\",\n      \"name\": \"Concatenate1\",\n      \"type\": \"n8n-nodes-base.summarize\",\n      \"position\": [\n        1660,\n        -860\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"fieldsToSplitBy\": \"youtubeId\",\n        \"fieldsToSummarize\": {\n          \"values\": [\n            {\n              \"field\": \"transcript.text\",\n              \"separateBy\": \" \",\n              \"aggregation\": \"concatenate\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"ccca5021-248b-4a98-af6b-ee92b2d63dca\",\n      \"name\": \"Sticky Note12\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        800,\n        -1000\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 1140,\n        \"height\": 560,\n        \"content\": \"## 获取并准备单条视频转录数据以供处理\\n- 检索并预处理单条视频的转录文本\\n- 为后续分析与摘要生成准备数据\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"1e9ecc6e-2b4d-4ae8-8949-d4b92eaf9287\",\n      \"name\": \"Get Videos\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        1520,\n        480\n      ],\n      \"parameters\": {\n        \"jsCode\": \"return $('Edit Fields').all();\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"f8ea7a40-b1f9-4dc2-959d-0e765331b191\",\n      \"name\": \"Get Playlist Videos Data\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        860,\n        -200\n      ],\n      \"parameters\": {\n        \"jsCode\": \"/**\\n * This code node contains a modified version of play-dl,\\n * which is licensed under the GNU General Public License Version 3 (GPLv3).\\n *\\n * Original Library Name: play-dl\\n * Original Library Source: https://github.com/play-dl/play-dl/tree/main\\n * Original Library License: GNU General Public License Version 3 (GPLv3)\\n * (See: https://www.gnu.org/licenses/gpl-3.0.en.html)\\n *\\n * Modifications were made to the original library for use within this N8N workflow.\\n * These modifications are also licensed under the GNU General Public License Version 3 (GPLv3).\\n *\\n * This program is distributed in the hope that it will be useful,\\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\\n * GNU General Public License for more details.\\n *\\n * You should have received a copy of the GNU General Public License\\n * along with this program.  If not, see <https://www.gnu.org/licenses/>.\\n */\\n\\n\\n/**\\n * Gets YouTube playlist info from a playlist url.\\n *\\n * Example\\n * ```js\\n * const playlist = await play.playlist_info('youtube playlist url')\\n *\\n * const playlist = await play.playlist_info('youtube playlist url', { incomplete : true })\\n * ```\\n * @param body HTML body of the playlist page\\n * @param url Playlist URL\\n * @returns YouTube Playlist\\n */\\nfunction playlist_info(body, url) {\\n  let url_ = url.trim();\\n  if (body.indexOf('Our systems have detected unusual traffic from your computer network.') !== -1)\\n    throw new Error('Captcha page: YouTube has detected that you are a bot!');\\n\\n  const response = JSON.parse(\\n    body\\n      .split('var ytInitialData = ')[1]\\n      .split(';</script>')[0]\\n      .split(/;\\\\s*(var|const|let)\\\\s/)[0]\\n  );\\n\\n  if (response.alerts) {\\n    if (response.alerts[0].alertWithButtonRenderer?.type === 'INFO') {\\n      throw new Error(\\n        `While parsing playlist url\\\\n${response.alerts[0].alertWithButtonRenderer.text.simpleText}`\\n      );\\n    } else if (response.alerts[0].alertRenderer?.type === 'ERROR')\\n      throw new Error(`While parsing playlist url\\\\n${response.alerts[0].alertRenderer.text.runs[0].text}`);\\n    else throw new Error('While parsing playlist url\\\\nUnknown Playlist Error');\\n  }\\n  if (response.currentVideoEndpoint) {\\n    return getWatchPlaylist(response, body, url_);\\n  } else return getNormalPlaylist(response, body);\\n}\\n\\n/**\\n * Function to parse Playlist from YouTube search\\n * @param data html data of that request\\n * @param limit No. of videos to parse\\n * @returns Array of YouTube Video objects.\\n */\\nfunction getPlaylistVideos(data, limit = Infinity) {\\n  const videos = [];\\n\\n  for (let i = 0; i < data.length; i++) {\\n    if (limit === videos.length) break;\\n    const info = data[i].playlistVideoRenderer;\\n    if (!info || !info.shortBylineText) continue;\\n\\n    videos.push({\\n      id: info.videoId,\\n      duration: parseInt(info.lengthSeconds) || 0,\\n      duration_raw: info.lengthText?.simpleText ?? '0:00',\\n      thumbnails: info.thumbnail.thumbnails,\\n      title: info.title.runs[0].text,\\n      upcoming: info.upcomingEventData?.startTime\\n        ? new Date(parseInt(info.upcomingEventData.startTime) * 1000)\\n        : undefined,\\n      channel: {\\n        id: info.shortBylineText.runs[0].navigationEndpoint.browseEndpoint.browseId || undefined,\\n        name: info.shortBylineText.runs[0].text || undefined,\\n        url: `https://www.youtube.com${info.shortBylineText.runs[0].navigationEndpoint.browseEndpoint.canonicalBaseUrl ||\\n          info.shortBylineText.runs[0].navigationEndpoint.commandMetadata.webCommandMetadata.url\\n          }`,\\n        icon: undefined\\n      }\\n    });\\n  }\\n  return videos;\\n}\\n\\n\\nfunction getWatchPlaylist(response, body, url) {\\n  const playlist_details = response.contents.twoColumnWatchNextResults.playlist?.playlist;\\n  if (!playlist_details)\\n    throw new Error(\\\"Watch playlist unavailable due to YouTube layout changes.\\\")\\n\\n  const videos = getWatchPlaylistVideos(playlist_details.contents);\\n  const videoCount = playlist_details.totalVideos;\\n  const channel = playlist_details.shortBylineText?.runs?.[0];\\n  const badge = playlist_details.badges?.[0]?.metadataBadgeRenderer?.style.toLowerCase();\\n\\n  return {\\n    id: playlist_details.playlistId || '',\\n    title: playlist_details.title || '',\\n    videoCount: parseInt(videoCount) || 0,\\n    videos: videos,\\n    url: url,\\n    channel: {\\n      id: channel?.navigationEndpoint?.browseEndpoint?.browseId || null,\\n      name: channel?.text || null,\\n      url: `https://www.youtube.com${channel?.navigationEndpoint?.browseEndpoint?.canonicalBaseUrl ||\\n        channel?.navigationEndpoint?.commandMetadata?.webCommandMetadata?.url\\n        }`,\\n      verified: Boolean(badge?.includes('verified')),\\n      artist: Boolean(badge?.includes('artist'))\\n    }\\n  };\\n}\\n\\nfunction getNormalPlaylist(response, body) {\\n  const json_data =\\n    response.contents.twoColumnBrowseResultsRenderer.tabs[0].tabRenderer.content.sectionListRenderer.contents[0]\\n      .itemSectionRenderer.contents[0].playlistVideoListRenderer.contents;\\n  const playlist_details = response.sidebar.playlistSidebarRenderer.items;\\n  const videos = getPlaylistVideos(json_data, 100);\\n\\n  const data = playlist_details[0].playlistSidebarPrimaryInfoRenderer;\\n  if (!data.title.runs || !data.title.runs.length) throw new Error('Failed to Parse Playlist info.');\\n\\n  const author = playlist_details[1]?.playlistSidebarSecondaryInfoRenderer.videoOwner;\\n  const views = data.stats.length === 3 ? data.stats[1].simpleText.replace(/\\\\D/g, '') : 0;\\n  const lastUpdate =\\n    data.stats\\n      .find((x) => 'runs' in x && x['runs'].find((y) => y.text.toLowerCase().includes('last update')))\\n      ?.runs.pop()?.text ?? null;\\n  const videosCount = data.stats[0].runs[0].text.replace(/\\\\D/g, '') || 0;\\n\\n  return {\\n    id: data.title.runs[0].navigationEndpoint.watchEndpoint.playlistId,\\n    title: data.title.runs[0].text,\\n    videoCount: parseInt(videosCount) || 0,\\n    lastUpdate: lastUpdate,\\n    views: parseInt(views) || 0,\\n    videos: videos,\\n    url: `https://www.youtube.com/playlist?list=${data.title.runs[0].navigationEndpoint.watchEndpoint.playlistId}`,\\n    link: `https://www.youtube.com${data.title.runs[0].navigationEndpoint.commandMetadata.webCommandMetadata.url}`,\\n    channel: author\\n      ? {\\n        name: author.videoOwnerRenderer.title.runs[0].text,\\n        id: author.videoOwnerRenderer.title.runs[0].navigationEndpoint.browseEndpoint.browseId,\\n        url: `https://www.youtube.com${author.videoOwnerRenderer.navigationEndpoint.commandMetadata.webCommandMetadata.url ||\\n          author.videoOwnerRenderer.navigationEndpoint.browseEndpoint.canonicalBaseUrl\\n          }`,\\n        icons: author.videoOwnerRenderer.thumbnail.thumbnails ?? []\\n      }\\n      : {},\\n    thumbnail: data.thumbnailRenderer.playlistVideoThumbnailRenderer?.thumbnail.thumbnails.length\\n      ? data.thumbnailRenderer.playlistVideoThumbnailRenderer.thumbnail.thumbnails[\\n      data.thumbnailRenderer.playlistVideoThumbnailRenderer.thumbnail.thumbnails.length - 1\\n      ]\\n      : null\\n  };\\n}\\n\\nfunction parseDuration(text) {\\n  if (!text) return 0;\\n  const split = text.split(':');\\n\\n  switch (split.length) {\\n    case 2:\\n      return parseInt(split[0]) * 60 + parseInt(split[1]);\\n\\n    case 3:\\n      return parseInt(split[0]) * 60 * 60 + parseInt(split[1]) * 60 + parseInt(split[2]);\\n\\n    default:\\n      return 0;\\n  }\\n}\\n\\nfunction getWatchPlaylistVideos(data, limit = Infinity) {\\n  const videos = [];\\n\\n  for (let i = 0; i < data.length; i++) {\\n    if (limit === videos.length) break;\\n    const info = data[i].playlistPanelVideoRenderer;\\n    if (!info || !info.shortBylineText) continue;\\n    const channel_info = info.shortBylineText.runs[0];\\n\\n    videos.push({\\n      id: info.videoId,\\n      duration: parseDuration(info.lengthText?.simpleText) || 0,\\n      duration_raw: info.lengthText?.simpleText ?? '0:00',\\n      thumbnails: info.thumbnail.thumbnails,\\n      title: info.title.simpleText,\\n      upcoming:\\n        info.thumbnailOverlays[0].thumbnailOverlayTimeStatusRenderer?.style === 'UPCOMING' || undefined,\\n      channel: {\\n        id: channel_info.navigationEndpoint.browseEndpoint.browseId || undefined,\\n        name: channel_info.text || undefined,\\n        url: `https://www.youtube.com${channel_info.navigationEndpoint.browseEndpoint.canonicalBaseUrl ||\\n          channel_info.navigationEndpoint.commandMetadata.webCommandMetadata.url\\n          }`,\\n        icon: undefined\\n      }\\n    });\\n  }\\n\\n  return videos;\\n}\\n\\n\\nreturn playlist_info($input.first().json.data, $('Update Context Intent').first().json.output.url);\"\n      },\n      \"retryOnFail\": true,\n      \"typeVersion\": 2,\n      \"alwaysOutputData\": true,\n      \"waitBetweenTries\": 500\n    },\n    {\n      \"id\": \"71b60b8e-06df-45a8-85a3-7b9e938fb6f0\",\n      \"name\": \"Embeddings Google Gemini2\",\n      \"type\": \"@n8n/n8n-nodes-langchain.embeddingsGoogleGemini\",\n      \"position\": [\n        2640,\n        1060\n      ],\n      \"parameters\": {\n        \"modelName\": \"models/text-embedding-004\"\n      },\n      \"credentials\": {\n        \"googlePalmApi\": {\n          \"id\": \"2zwuT5znDglBrUCO\",\n          \"name\": \"Google Gemini(PaLM) Api account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"58feccf5-1b97-4c88-b274-444e177f4515\",\n      \"name\": \"Qdrant Vector Store3\",\n      \"type\": \"@n8n/n8n-nodes-langchain.vectorStoreQdrant\",\n      \"position\": [\n        -100,\n        160\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"qdrantCollection\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $('Default Intent').first().json.output?.id }}\"\n        }\n      },\n      \"credentials\": {\n        \"qdrantApi\": {\n          \"id\": \"mb8rw8tmUeP6aPJm\",\n          \"name\": \"QdrantApi account\"\n        }\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"6cff2236-3e78-4e8c-bb3d-5140f106c530\",\n      \"name\": \"Answer questions with a vector store\",\n      \"type\": \"@n8n/n8n-nodes-langchain.toolVectorStore\",\n      \"position\": [\n        180,\n        -40\n      ],\n      \"parameters\": {\n        \"name\": \"chat_playlist_data\",\n        \"topK\": 10,\n        \"description\": \"=Retrive data about the Playlist or Video from the vector store.\\nplaylistId or youtubeId: {{ $('Default Intent').item.json.output?.id }}\\n\\n**User Message:**\\n{{ $('Chat').item.json.chatInput }}\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"312081d9-9279-4700-a432-e9f878d5361e\",\n      \"name\": \"Qdrant Vector Store4\",\n      \"type\": \"@n8n/n8n-nodes-langchain.vectorStoreQdrant\",\n      \"position\": [\n        2700,\n        900\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"qdrantCollection\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $('Default Intent').first().json.output?.id }}\"\n        }\n      },\n      \"credentials\": {\n        \"qdrantApi\": {\n          \"id\": \"mb8rw8tmUeP6aPJm\",\n          \"name\": \"QdrantApi account\"\n        }\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"f5cba8b5-226d-4b0a-8cb6-a51728ac8247\",\n      \"name\": \"Answer questions with a vector store1\",\n      \"type\": \"@n8n/n8n-nodes-langchain.toolVectorStore\",\n      \"position\": [\n        2860,\n        700\n      ],\n      \"parameters\": {\n        \"name\": \"chat_playlist_data\",\n        \"topK\": 6,\n        \"description\": \"=User Message:\\n{{ $('Chat').item.json.chatInput }}\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"22f18788-b47f-4187-9146-28e6de5ec7a6\",\n      \"name\": \"Google Gemini Chat Model\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatGoogleGemini\",\n      \"position\": [\n        3000,\n        900\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"modelName\": \"models/gemini-2.0-flash\"\n      },\n      \"credentials\": {\n        \"googlePalmApi\": {\n          \"id\": \"2zwuT5znDglBrUCO\",\n          \"name\": \"Google Gemini(PaLM) Api account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"2aa52dd2-169b-43dc-8202-1d60f5fd55c0\",\n      \"name\": \"Google Gemini Chat Model3\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatGoogleGemini\",\n      \"position\": [\n        220,\n        160\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"modelName\": \"models/gemini-2.0-flash\"\n      },\n      \"credentials\": {\n        \"googlePalmApi\": {\n          \"id\": \"2zwuT5znDglBrUCO\",\n          \"name\": \"Google Gemini(PaLM) Api account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"d96d3670-ab95-4afc-a275-33f03383a204\",\n      \"name\": \"Qdrant Vector Store2\",\n      \"type\": \"@n8n/n8n-nodes-langchain.vectorStoreQdrant\",\n      \"position\": [\n        -820,\n        -880\n      ],\n      \"parameters\": {\n        \"mode\": \"load\",\n        \"prompt\": \"Are there any documents in the store?\",\n        \"options\": {},\n        \"qdrantCollection\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $('Process Status').item.json.output?.id }}\"\n        }\n      },\n      \"credentials\": {\n        \"qdrantApi\": {\n          \"id\": \"mb8rw8tmUeP6aPJm\",\n          \"name\": \"QdrantApi account\"\n        }\n      },\n      \"typeVersion\": 1,\n      \"alwaysOutputData\": true\n    },\n    {\n      \"id\": \"7c289d61-09b2-461e-b771-8781f60828c7\",\n      \"name\": \"Embeddings Google Gemini4\",\n      \"type\": \"@n8n/n8n-nodes-langchain.embeddingsGoogleGemini\",\n      \"position\": [\n        -840,\n        -640\n      ],\n      \"parameters\": {\n        \"modelName\": \"models/text-embedding-004\"\n      },\n      \"credentials\": {\n        \"googlePalmApi\": {\n          \"id\": \"2zwuT5znDglBrUCO\",\n          \"name\": \"Google Gemini(PaLM) Api account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"59be01b0-3ff9-4cc2-b569-c0cb4dcae3ec\",\n      \"name\": \"If\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        -260,\n        -880\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"795da689-23c3-49d5-a312-ca18e2c9d5e3\",\n              \"operator\": {\n                \"type\": \"number\",\n                \"operation\": \"gt\"\n              },\n              \"leftValue\": \"={{ $json.count_document }}\",\n              \"rightValue\": 0\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"ab9bc74d-9659-44fe-aa08-4878609ef808\",\n      \"name\": \"Count Content\",\n      \"type\": \"n8n-nodes-base.summarize\",\n      \"position\": [\n        -460,\n        -880\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"fieldsToSummarize\": {\n          \"values\": [\n            {\n              \"field\": \"document\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"5c953435-1052-4e1c-9d2f-2439ba944b28\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        20,\n        -1020\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 500,\n        \"height\": 580,\n        \"content\": \"## 处理或请求更多细节\\n- 根据工作流条件决定下一步操作，例如缺少待处理的播放列表视频数量时。\\n- 将任务路由至播放列表处理或视频处理流程。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"78760cd2-74db-482d-b660-bd53a3184b95\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -920,\n        -1020\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 880,\n        \"height\": 580,\n        \"content\": \"## 已处理？\\n- 检查向量存储中是否已有嵌入数据。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"a8dc1b1e-2ba9-4b85-9f2f-c3d07ec67c32\",\n      \"name\": \"Update Context Intent1\",\n      \"type\": \"n8n-nodes-base.redis\",\n      \"position\": [\n        -460,\n        -640\n      ],\n      \"parameters\": {\n        \"key\": \"=context_intent_{{ $('Chat').item.json.sessionId }}\",\n        \"value\": \"=intent {{ $('Process Status').item.json.output?.intent || null }} url {{ $('Process Status').item.json.output?.url || \\\"\\\" }} id {{ $('Process Status').item.json.output?.id || \\\"\\\" }} limit {{ $('Process Status').item.json.output?.limit || 0 }} status DONE\",\n        \"keyType\": \"hash\",\n        \"operation\": \"set\",\n        \"valueIsJSON\": false\n      },\n      \"credentials\": {\n        \"redis\": {\n          \"id\": \"mA0f9F1ROUThyrRW\",\n          \"name\": \"Redis account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"36ea2e25-8d29-4ec6-bc6a-15c98153c390\",\n      \"name\": \"Sticky Note8\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -2540,\n        20\n      ],\n      \"parameters\": {\n        \"width\": 1080,\n        \"height\": 1320,\n        \"content\": \"# AI驱动的YouTube播放列表与视频摘要分析聊天机器人\\n\\n该N8N工作流将YouTube播放列表或单个视频转化为交互式知识库。用户无需观看视频，可直接通过对话获取基于视频字幕的摘要与解答。\\n\\n## 工作原理：\\n\\n1.  **对话交互与意图识别：**\\n    * 工作流通过聊天界面(`Chat Trigger`)启动，提示用户输入YouTube播放列表或视频链接\\n    * 从Redis检索历史对话上下文\\n    * Google Gemini智能体(`Message Intent`)分析输入内容，判断是否包含有效播放列表链接、视频链接或无效输入(`NONE`)，同时提取URL、对应ID(播放列表ID/视频ID)，并检测用户是否设定了播放列表视频处理数量上限\\n    * 工作流通过Redis维护上下文状态(`Update Context Intent`, `Get Previous Context Intent`)，记录当前URL、ID及处理进度\\n\\n2.  **路由与预处理检查：**\\n    * 根据识别意图和内容处理状态，`Switch`节点(`Route Message Intent`)进行流程分流\\n    * 若提供有效URL且未完成处理(`status != 'DONE'`)，进入处理管线\\n    * 检查Qdrant向量数据库(`Qdrant Vector Store2`, `If`)是否已存在对应ID的嵌入数据，若存在则跳过处理直接进入问答阶段\\n    * 若输入为播放列表链接但未指定视频数量上限(`limit=0`)，则提示用户补充(`Numb of Videos`智能体)\\n\\n3.  **视频/播放列表处理管线：**\\n    * **数据获取：**\\n        * **播放列表**：获取播放列表页(`Playlist HTTP Request`)，通过自定义代码提取视频详情(`Get Playlist Videos Data`)，按设定上限截取视频(`Limit`)，逐条获取字幕(`YouTube Transcript`)\\n        * **单视频**：获取视频页(`Video HTTP Request`)，提取标题/描述(`Get Title and Desc`)，获取字幕(`YouTube Transcript1`)\\n    * **字幕处理与摘要生成：**\\n        * 使用`youtubeTranscripter`节点获取字幕文本\\n        * 多段字幕进行拼接(`Concatenate`, `Concatenate1`)\\n        * 整合视频ID、标题、字幕等元数据(`Merge`, `Edit Fields`)\\n        * 通过Google Gemini链为每条视频字幕生成摘要(`Summarize & Analyze Transcript`)\\n    * **向量嵌入与存储：**\\n        * 清除Qdrant中该播放列表/视频ID的旧数据(`Delete Collection`)\\n        * 载入处理后的字幕数据(`Default Data Loader`)\\n        * 文本分块处理(`Recursive Character Text Splitter`)\\n        * 通过Google Gemini生成文本块向量嵌入(`Embeddings Google Gemini`)\\n        * 将嵌入数据按ID存入Qdrant集合(`Qdrant Vector Store`)\\n    * **状态更新与最终摘要：**\\n        * 将Redis中的上下文状态更新为'DONE'(`Update Context Process Done1`)\\n        * 整合所有视频摘要(`Full Summary`)\\n        * 由AI智能体(`AI Agent`)基于向量数据库查询工具(`Answer questions with a vector store1`)生成最终综合摘要或响应\\n\\n4.  **查询处理(内容对话)：**\\n    * 当用户输入被识别为查询请求而非待处理URL时(或URL已完成处理)，工作流启动主查询处理器\\n    * 搭载对话记忆(`Chat Buffer Memory`)的Google Gemini智能体(`Handle Queries`)负责应答\\n    * 该智能体使用专用工具(`Answer questions with a vector store`)，根据用户查询直接从Qdrant向量数据库中检索关联信息\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"active\": true,\n  \"pinData\": {},\n  \"settings\": {\n    \"executionOrder\": \"v1\"\n  },\n  \"versionId\": \"7c1d0978-ccea-4618-bcbf-560b34f77023\",\n  \"connections\": {\n    \"If\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Update Context Intent1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Playlist Limit\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Chat\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get Previous Context Intent\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Limit\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"YouTube Transcript\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Video Titles\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Merge\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Summarize & Analyze Transcript\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Split Out\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Concatenate\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get Videos\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Qdrant Vector Store\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Split Out1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Limit\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Split Out2\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Concatenate1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Concatenate\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Edit Fields\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Delete Collection\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Concatenate1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Full Summary\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"AI Agent\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Video Titles\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge\",\n            \"type\": \"main\",\n            \"index\": 1\n          }\n        ]\n      ]\n    },\n    \"Count Content\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"If\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Simple Memory\": {\n      \"ai_memory\": [\n        [\n          {\n            \"node\": \"Message Intent\",\n            \"type\": \"ai_memory\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Default Intent\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Route Message Intent\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Message Intent\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Default Intent\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        []\n      ]\n    },\n    \"Playlist Limit\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Numb of Videos\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Playlist or Video\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Process Status\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Update Context Intent\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Simple Memory3\": {\n      \"ai_memory\": [\n        [\n          {\n            \"node\": \"Numb of Videos\",\n            \"type\": \"ai_memory\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Delete Collection\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get Videos\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Playlist or Video\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Video HTTP Request\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Playlist HTTP Request\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Chat Buffer Memory\": {\n      \"ai_memory\": [\n        [\n          {\n            \"node\": \"Handle Queries\",\n            \"type\": \"ai_memory\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get Title and Desc\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge\",\n            \"type\": \"main\",\n            \"index\": 1\n          }\n        ]\n      ]\n    },\n    \"Video HTTP Request\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"YouTube Transcript1\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Get Title and Desc\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"YouTube Transcript\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Split Out\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Chat Buffer Memory1\": {\n      \"ai_memory\": [\n        [\n          {\n            \"node\": \"AI Agent\",\n            \"type\": \"ai_memory\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Default Data Loader\": {\n      \"ai_document\": [\n        [\n          {\n            \"node\": \"Qdrant Vector Store\",\n            \"type\": \"ai_document\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Qdrant Vector Store\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Update Context Process Done1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"YouTube Transcript1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Split Out2\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Qdrant Vector Store2\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Count Content\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Qdrant Vector Store3\": {\n      \"ai_tool\": [\n        []\n      ],\n      \"ai_vectorStore\": [\n        [\n          {\n            \"node\": \"Answer questions with a vector store\",\n            \"type\": \"ai_vectorStore\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Qdrant Vector Store4\": {\n      \"ai_vectorStore\": [\n        [\n          {\n            \"node\": \"Answer questions with a vector store1\",\n            \"type\": \"ai_vectorStore\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Route Message Intent\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Process Status\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Handle Queries\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Handle Queries\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Playlist HTTP Request\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get Playlist Videos Data\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Update Context Intent\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Qdrant Vector Store2\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get Fields for Summary\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Full Summary\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Update Context Intent1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Handle Queries\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Embeddings Google Gemini\": {\n      \"ai_embedding\": [\n        [\n          {\n            \"node\": \"Qdrant Vector Store\",\n            \"type\": \"ai_embedding\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get Playlist Videos Data\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Split Out1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Google Gemini Chat Model\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"Answer questions with a vector store1\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Embeddings Google Gemini1\": {\n      \"ai_embedding\": [\n        [\n          {\n            \"node\": \"Qdrant Vector Store3\",\n            \"type\": \"ai_embedding\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Embeddings Google Gemini2\": {\n      \"ai_embedding\": [\n        [\n          {\n            \"node\": \"Qdrant Vector Store4\",\n            \"type\": \"ai_embedding\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Embeddings Google Gemini4\": {\n      \"ai_embedding\": [\n        [\n          {\n            \"node\": \"Qdrant Vector Store2\",\n            \"type\": \"ai_embedding\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Google Gemini Chat Model1\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"Handle Queries\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Google Gemini Chat Model2\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"Summarize & Analyze Transcript\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Google Gemini Chat Model3\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"Answer questions with a vector store\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Google Gemini Chat Model4\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"AI Agent\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Google Gemini Chat Model6\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"Message Intent\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Google Gemini Chat Model8\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"Numb of Videos\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Structured Output Parser1\": {\n      \"ai_outputParser\": [\n        [\n          {\n            \"node\": \"Message Intent\",\n            \"type\": \"ai_outputParser\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get Previous Context Intent\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Message Intent\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Update Context Process Done1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get Fields for Summary\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Summarize & Analyze Transcript\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Edit Fields\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Recursive Character Text Splitter\": {\n      \"ai_textSplitter\": [\n        [\n          {\n            \"node\": \"Default Data Loader\",\n            \"type\": \"ai_textSplitter\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Answer questions with a vector store\": {\n      \"ai_tool\": [\n        [\n          {\n            \"node\": \"Handle Queries\",\n            \"type\": \"ai_tool\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Answer questions with a vector store1\": {\n      \"ai_tool\": [\n        [\n          {\n            \"node\": \"AI Agent\",\n            \"type\": \"ai_tool\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}