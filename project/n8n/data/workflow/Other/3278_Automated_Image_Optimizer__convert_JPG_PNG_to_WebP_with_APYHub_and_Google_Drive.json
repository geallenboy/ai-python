{
  "title": "Automated Image Optimizer: convert JPG/PNG to WebP with APYHub and Google Drive",
  "url": "https://n8n.io/workflows/3278-automated-image-optimizer-convert-jpgpng-to-webp-with-apyhub-and-google-drive/",
  "category": "Other",
  "category_url": "https://n8n.io/workflows/categories/other/?sort=createdAt:desc",
  "author": "Davide",
  "publish_date": "Last update a month ago",
  "publish_date_absolute": "",
  "content": "",
  "workflow_json": "{\"id\":\"IyDJ7Zgh4MV43YTh\",\"meta\":{\"instanceId\":\"a4bfc93e975ca233ac45ed7c9227d84cf5a2329310525917adaf3312e10d5462\",\"templateCredsSetupCompleted\":true},\"name\":\"Convert image from jpg/png to webp\",\"tags\":[],\"nodes\":[{\"id\":\"09977b8b-e095-4419-b136-bcbadf0f5d84\",\"name\":\"When clicking ‘Test workflow’\",\"type\":\"n8n-nodes-base.manualTrigger\",\"position\":[-320,-20],\"parameters\":{},\"typeVersion\":1},{\"id\":\"55c01841-9576-4663-bb24-c9e0082ecab5\",\"name\":\"Set API KEY\",\"type\":\"n8n-nodes-base.set\",\"position\":[40,-20],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"1fa468da-3e30-46b0-a44b-a723e45c5fda\",\"name\":\"apikey\",\"type\":\"string\",\"value\":\"APY**************************************************************\"}]}},\"typeVersion\":3.4},{\"id\":\"2d50e290-a861-4575-abbc-7f311d1934bb\",\"name\":\"Get images\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[380,-20],\"parameters\":{\"options\":{\"returnFirstMatch\":true},\"filtersUI\":{\"values\":[{\"lookupColumn\":\"DONE\"}]},\"sheetName\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"gid=0\",\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1upj3EDLwU1N7NHWWV3DhwMuE6ty39tIK5z5lCVDWWuM/edit#gid=0\",\"cachedResultName\":\"Foglio1\"},\"documentId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"1upj3EDLwU1N7NHWWV3DhwMuE6ty39tIK5z5lCVDWWuM\",\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1upj3EDLwU1N7NHWWV3DhwMuE6ty39tIK5z5lCVDWWuM/edit?usp=drivesdk\",\"cachedResultName\":\"Convert images\"}},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"JYR6a64Qecd6t8Hb\",\"name\":\"Google Sheets account\"}},\"typeVersion\":4.5},{\"id\":\"b3c5d64c-0e2a-472b-83f7-91cabd4d1646\",\"name\":\"Get extension\",\"type\":\"n8n-nodes-base.code\",\"position\":[660,-20],\"parameters\":{\"jsCode\":\"// Loop over input items and add new fields 'FILENAME' and 'EXTENSION' to the JSON of each one\\nfor (const item of $input.all()) {\\n  // Extract the 'FROM' field\\n  const url = item.json.FROM;\\n\\n  const filenameWithExtension = url.split('/').pop().split(/[#?]/)[0];\\n\\n  const extension = filenameWithExtension.split('.').pop();\\n\\n  const filename = filenameWithExtension.substring(0, filenameWithExtension.length - extension.length - 1);\\n\\n  item.json.FILENAME = filename;\\n  item.json.EXTENSION = extension;\\n}\\n\\nreturn $input.all();\\n\"},\"typeVersion\":2},{\"id\":\"e281cd63-79d1-4ca3-88c0-81aaa7e0dbe8\",\"name\":\"JPG or PNG?\",\"type\":\"n8n-nodes-base.switch\",\"position\":[-320,460],\"parameters\":{\"rules\":{\"values\":[{\"outputKey\":\"jpeg\",\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"f25651ea-ee05-4e8d-91a8-fa96997e2794\",\"operator\":{\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $json.EXTENSION }}\",\"rightValue\":\"jpg\"}]},\"renameOutput\":true},{\"outputKey\":\"jpeg\",\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"6a2dc1fd-5e5a-4015-bad1-e258dfead84f\",\"operator\":{\"name\":\"filter.operator.equals\",\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $json.EXTENSION }}\",\"rightValue\":\"jpeg\"}]},\"renameOutput\":true},{\"outputKey\":\"png\",\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"1d0e09dd-edee-4778-9b3a-9a4429a06db0\",\"operator\":{\"name\":\"filter.operator.equals\",\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $json.EXTENSION }}\",\"rightValue\":\"png\"}]},\"renameOutput\":true}]},\"options\":{}},\"typeVersion\":3.2},{\"id\":\"f3257837-88e0-4f5f-bbd5-5c63c5ba4ed1\",\"name\":\"From JPG to WEBP\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[-100,320],\"parameters\":{\"url\":\"=https://api.apyhub.com/convert/image/jpeg/webp/url?output=test-sample\",\"method\":\"POST\",\"options\":{},\"jsonBody\":\"={\\n  \\\"url\\\":\\\"{{ $json.FROM }}\\\"\\n} \",\"sendBody\":true,\"sendHeaders\":true,\"specifyBody\":\"json\",\"headerParameters\":{\"parameters\":[{\"name\":\"Content-Type\",\"value\":\"application/json\"},{\"name\":\"api-token\",\"value\":\"={{ $('Set API KEY').item.json.apikey }}\"}]}},\"typeVersion\":4.2},{\"id\":\"de1198c3-17a2-4b45-a334-6334b2b935c4\",\"name\":\"PNG to WEBP\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[-100,580],\"parameters\":{\"url\":\"=https://api.apyhub.com/convert/image/png/webp/url?output=test-sample\",\"method\":\"POST\",\"options\":{},\"jsonBody\":\"={\\n  \\\"url\\\":\\\"{{ $json.FROM }}\\\"\\n} \",\"sendBody\":true,\"sendHeaders\":true,\"specifyBody\":\"json\",\"headerParameters\":{\"parameters\":[{\"name\":\"Content-Type\",\"value\":\"application/json\"},{\"name\":\"apy-token\",\"value\":\"={{ $('Set API KEY').item.json.apikey }}\"}]}},\"typeVersion\":4.2},{\"id\":\"38b46480-c089-4bca-88ac-7f006c12d3b9\",\"name\":\"Update Sheet\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[160,440],\"parameters\":{\"columns\":{\"value\":{\"TO\":\"={{ $json.data }}\",\"DONE\":\"x\",\"row_number\":\"={{ $('Get images').item.json.row_number }}\"},\"schema\":[{\"id\":\"FROM\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"FROM\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"TO\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"TO\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"DONE\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"DONE\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"row_number\",\"type\":\"string\",\"display\":true,\"removed\":false,\"readOnly\":true,\"required\":false,\"displayName\":\"row_number\",\"defaultMatch\":false,\"canBeUsedToMatch\":true}],\"mappingMode\":\"defineBelow\",\"matchingColumns\":[\"row_number\"],\"attemptToConvertTypes\":false,\"convertFieldsToString\":false},\"options\":{},\"operation\":\"update\",\"sheetName\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"gid=0\",\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1upj3EDLwU1N7NHWWV3DhwMuE6ty39tIK5z5lCVDWWuM/edit#gid=0\",\"cachedResultName\":\"Foglio1\"},\"documentId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"1upj3EDLwU1N7NHWWV3DhwMuE6ty39tIK5z5lCVDWWuM\",\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1upj3EDLwU1N7NHWWV3DhwMuE6ty39tIK5z5lCVDWWuM/edit?usp=drivesdk\",\"cachedResultName\":\"Convert images from jpg/png to webp\"}},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"JYR6a64Qecd6t8Hb\",\"name\":\"Google Sheets account\"}},\"typeVersion\":4.5},{\"id\":\"2dc29c73-efcb-4bef-8d9a-5a1914df62ad\",\"name\":\"Get file image\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[420,440],\"parameters\":{\"url\":\"={{ $json.TO }}\",\"options\":{\"response\":{\"response\":{\"responseFormat\":\"file\"}}}},\"typeVersion\":4.2},{\"id\":\"acee7120-ceb4-472e-a941-066056da5cd6\",\"name\":\"Upload image\",\"type\":\"n8n-nodes-base.googleDrive\",\"position\":[700,440],\"parameters\":{\"name\":\"={{ $('Get extension').item.json.FILENAME }}.webp\",\"driveId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"My Drive\"},\"options\":{},\"folderId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"1XyUSYXdNrZIw0XyZ3YpuaxGJjOaARyEJ\",\"cachedResultUrl\":\"https://drive.google.com/drive/folders/1XyUSYXdNrZIw0XyZ3YpuaxGJjOaARyEJ\",\"cachedResultName\":\"Immagini\"}},\"credentials\":{\"googleDriveOAuth2Api\":{\"id\":\"HEy5EuZkgPZVEa9w\",\"name\":\"Google Drive account (n3w.it)\"}},\"typeVersion\":3},{\"id\":\"0a491e7b-2482-429e-9901-cb2bf3d34509\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-360,-520],\"parameters\":{\"color\":3,\"width\":800,\"height\":200,\"content\":\"## Convert image from jpg/png to webp\\n\\nThis workflow automates the process of converting images from **JPG/PNG** format to **WEBP** using the **APYHub API**. It retrieves image URLs from a **Google Sheet**, converts the images, and uploads the converted files to **Google Drive**. \\n\\nThis workflow is a powerful tool for automating image conversion tasks, saving time and ensuring that images are efficiently converted and stored in the desired format.\"},\"typeVersion\":1},{\"id\":\"78a198c4-449f-4a68-96e4-20ecd044fe1f\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-360,-280],\"parameters\":{\"width\":800,\"height\":120,\"content\":\"## PRELIMINARY STEP\\n- Get your FREE API KEY from [APYHub](https://apyhub.com//)\\n- Clone [this sheet](https://docs.google.com/spreadsheets/d/1upj3EDLwU1N7NHWWV3DhwMuE6ty39tIK5z5lCVDWWuM/edit?usp=sharing) and insert the URL of your images (only jpg, jpeg and png format) in the column \\\"FROM\\\"\"},\"typeVersion\":1}],\"active\":false,\"pinData\":{},\"settings\":{\"executionOrder\":\"v1\"},\"versionId\":\"e2fa7236-fbf9-43ec-a217-aeb43664d129\",\"connections\":{\"Get images\":{\"main\":[[{\"node\":\"Get extension\",\"type\":\"main\",\"index\":0}]]},\"JPG or PNG?\":{\"main\":[[{\"node\":\"From JPG to WEBP\",\"type\":\"main\",\"index\":0}],[{\"node\":\"From JPG to WEBP\",\"type\":\"main\",\"index\":0}],[{\"node\":\"PNG to WEBP\",\"type\":\"main\",\"index\":0}]]},\"PNG to WEBP\":{\"main\":[[{\"node\":\"Update Sheet\",\"type\":\"main\",\"index\":0}]]},\"Set API KEY\":{\"main\":[[{\"node\":\"Get images\",\"type\":\"main\",\"index\":0}]]},\"Update Sheet\":{\"main\":[[{\"node\":\"Get file image\",\"type\":\"main\",\"index\":0}]]},\"Get extension\":{\"main\":[[{\"node\":\"JPG or PNG?\",\"type\":\"main\",\"index\":0}]]},\"Get file image\":{\"main\":[[{\"node\":\"Upload image\",\"type\":\"main\",\"index\":0}]]},\"From JPG to WEBP\":{\"main\":[[{\"node\":\"Update Sheet\",\"type\":\"main\",\"index\":0}]]},\"When clicking ‘Test workflow’\":{\"main\":[[{\"node\":\"Set API KEY\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "This workflow automates the process of converting images from **JPG/PNG** format to **WEBP** using the **APYHub API**. It retrieves image URLs from a **Google Sheet** , converts the images, and uploads the converted files to **Google Drive**.\n\nThis workflow is a powerful tool for automating image conversion tasks, saving time and ensuring that images are efficiently converted and stored in the desired format.\n\nUsing WebP images on a website provides several SEO benefits:\n\n  1. **Faster Loading Speed** – WebP files are smaller than JPG and PNG, reducing page load times and improving user experience.\n  2. **Better Core Web Vitals** – Google prioritizes websites with good performance metrics like LCP (Largest Contentful Paint).\n  3. **Improved Mobile Performance** – Smaller images consume less bandwidth, enhancing mobile usability.\n  4. **Higher Search Rankings** – Faster sites tend to rank better on Google due to improved user experience.\n  5. **Reduced Server Load** – Lighter images lower hosting and CDN costs while improving site efficiency.\n\n\n\nBelow is a breakdown of the workflow:\n\n* * *\n\n#### **1\\. How It Works**\n\nThe workflow is designed to convert images from JPG/PNG to WEBP format and manage the converted files. Here's how it works:\n\n  1. **Manual Trigger** :\n\n     * The workflow starts with a **Manual Trigger** node, which initiates the process when the user clicks \"Test workflow.\"\n  2. **Set API Key** :\n\n     * The **Set API KEY** node defines the API key required to access the APYHub API.\n  3. **Get Images** :\n\n     * The **Get Images** node retrieves a list of image URLs from a **Google Sheet**. The sheet contains columns for the original image URL (`FROM`), the converted image URL (`TO`), and a status flag (`DONE`).\n  4. **Get Extension** :\n\n     * The **Get Extension** node extracts the file extension (JPG, JPEG, or PNG) from the image URL and adds it to the JSON data.\n  5. **Determine Image Type** :\n\n     * The **JPG or PNG?** node checks the file extension and routes the workflow to the appropriate conversion node: \n       * **JPG/JPEG** : Routes to the **From JPG to WEBP** node.\n       * **PNG** : Routes to the **PNG to WEBP** node.\n  6. **Convert Image** :\n\n     * The **From JPG to WEBP** and **PNG to WEBP** nodes send POST requests to the **APYHub API** to convert the images to WEBP format.\n     * The API returns the URL of the converted image.\n  7. **Update Google Sheet** :\n\n     * The **Update Sheet** node updates the Google Sheet with the URL of the converted image and marks the row as done (`DONE`).\n  8. **Get Converted Image** :\n\n     * The **Get File Image** node downloads the converted WEBP image from the URL provided by the APYHub API.\n  9. **Upload to Google Drive** :\n\n     * The **Upload Image** node uploads the converted WEBP image to a specified folder in **Google Drive**.\n\n\n\n* * *\n\n#### **2\\. Set Up Steps**\n\nTo set up and use this workflow in n8n, follow these steps:\n\n  1. **APYHub API Key** :\n\n     * Obtain an **API Key** from [APYHub](https://apyhub.com/).\n     * In the **Set API KEY** node, define the API key.\n  2. **Google Sheets Integration** :\n\n     * Set up **Google Sheets** credentials in n8n for the **Get Images** and **Update Sheet** nodes.\n     * Create a Google Sheet with columns for `FROM` (original image URL), `TO` (converted image URL), and `DONE` (status flag).\n     * Provide the **Document ID** and **Sheet Name** in the **Get Images** node.\n  3. **Google Drive Integration** :\n\n     * Set up **Google Drive** credentials in n8n for the **Upload Image** node.\n     * Specify the folder ID in Google Drive where the converted images will be uploaded.\n  4. **Test the Workflow** :\n\n     * Click the **\"Test workflow\"** button in n8n to trigger the workflow.\n     * The workflow will: \n       * Retrieve image URLs from the Google Sheet.\n       * Convert the images to WEBP format using the APYHub API.\n       * Update the Google Sheet with the converted image URLs.\n       * Upload the converted images to Google Drive.\n  5. **Optional Customization** :\n\n     * Modify the workflow to include additional features, such as: \n       * Adding more image formats for conversion.\n       * Sending notifications when the conversion is complete.\n       * Integrating with other storage services (e.g., Dropbox, AWS S3).\n\n\n",
  "readme_html": "<!--[--><div data-v-50766329=\"\"><p>This workflow automates the process of converting images from <strong>JPG/PNG</strong> format to <strong>WEBP</strong> using the <strong>APYHub API</strong>. It retrieves image URLs from a <strong>Google Sheet</strong>, converts the images, and uploads the converted files to <strong>Google Drive</strong>.</p>\n<p>This workflow is a powerful tool for automating image conversion tasks, saving time and ensuring that images are efficiently converted and stored in the desired format.</p>\n<p>Using WebP images on a website provides several SEO benefits:</p>\n<ol>\n<li><strong>Faster Loading Speed</strong> – WebP files are smaller than JPG and PNG, reducing page load times and improving user experience.</li>\n<li><strong>Better Core Web Vitals</strong> – Google prioritizes websites with good performance metrics like LCP (Largest Contentful Paint).</li>\n<li><strong>Improved Mobile Performance</strong> – Smaller images consume less bandwidth, enhancing mobile usability.</li>\n<li><strong>Higher Search Rankings</strong> – Faster sites tend to rank better on Google due to improved user experience.</li>\n<li><strong>Reduced Server Load</strong> – Lighter images lower hosting and CDN costs while improving site efficiency.</li>\n</ol>\n<p>Below is a breakdown of the workflow:</p>\n<hr>\n<h4><strong>1. How It Works</strong></h4>\n<p>The workflow is designed to convert images from JPG/PNG to WEBP format and manage the converted files. Here's how it works:</p>\n<ol>\n<li>\n<p><strong>Manual Trigger</strong>:</p>\n<ul>\n<li>The workflow starts with a <strong>Manual Trigger</strong> node, which initiates the process when the user clicks \"Test workflow.\"</li>\n</ul>\n</li>\n<li>\n<p><strong>Set API Key</strong>:</p>\n<ul>\n<li>The <strong>Set API KEY</strong> node defines the API key required to access the APYHub API.</li>\n</ul>\n</li>\n<li>\n<p><strong>Get Images</strong>:</p>\n<ul>\n<li>The <strong>Get Images</strong> node retrieves a list of image URLs from a <strong>Google Sheet</strong>. The sheet contains columns for the original image URL (<code>FROM</code>), the converted image URL (<code>TO</code>), and a status flag (<code>DONE</code>).</li>\n</ul>\n</li>\n<li>\n<p><strong>Get Extension</strong>:</p>\n<ul>\n<li>The <strong>Get Extension</strong> node extracts the file extension (JPG, JPEG, or PNG) from the image URL and adds it to the JSON data.</li>\n</ul>\n</li>\n<li>\n<p><strong>Determine Image Type</strong>:</p>\n<ul>\n<li>The <strong>JPG or PNG?</strong> node checks the file extension and routes the workflow to the appropriate conversion node:\n<ul>\n<li><strong>JPG/JPEG</strong>: Routes to the <strong>From JPG to WEBP</strong> node.</li>\n<li><strong>PNG</strong>: Routes to the <strong>PNG to WEBP</strong> node.</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><strong>Convert Image</strong>:</p>\n<ul>\n<li>The <strong>From JPG to WEBP</strong> and <strong>PNG to WEBP</strong> nodes send POST requests to the <strong>APYHub API</strong> to convert the images to WEBP format.</li>\n<li>The API returns the URL of the converted image.</li>\n</ul>\n</li>\n<li>\n<p><strong>Update Google Sheet</strong>:</p>\n<ul>\n<li>The <strong>Update Sheet</strong> node updates the Google Sheet with the URL of the converted image and marks the row as done (<code>DONE</code>).</li>\n</ul>\n</li>\n<li>\n<p><strong>Get Converted Image</strong>:</p>\n<ul>\n<li>The <strong>Get File Image</strong> node downloads the converted WEBP image from the URL provided by the APYHub API.</li>\n</ul>\n</li>\n<li>\n<p><strong>Upload to Google Drive</strong>:</p>\n<ul>\n<li>The <strong>Upload Image</strong> node uploads the converted WEBP image to a specified folder in <strong>Google Drive</strong>.</li>\n</ul>\n</li>\n</ol>\n<hr>\n<h4><strong>2. Set Up Steps</strong></h4>\n<p>To set up and use this workflow in n8n, follow these steps:</p>\n<ol>\n<li>\n<p><strong>APYHub API Key</strong>:</p>\n<ul>\n<li>Obtain an <strong>API Key</strong> from <a href=\"https://apyhub.com/\" rel=\"ugc nofollow\" target=\"_blank\">APYHub</a>.</li>\n<li>In the <strong>Set API KEY</strong> node, define the API key.</li>\n</ul>\n</li>\n<li>\n<p><strong>Google Sheets Integration</strong>:</p>\n<ul>\n<li>Set up <strong>Google Sheets</strong> credentials in n8n for the <strong>Get Images</strong> and <strong>Update Sheet</strong> nodes.</li>\n<li>Create a Google Sheet with columns for <code>FROM</code> (original image URL), <code>TO</code> (converted image URL), and <code>DONE</code> (status flag).</li>\n<li>Provide the <strong>Document ID</strong> and <strong>Sheet Name</strong> in the <strong>Get Images</strong> node.</li>\n</ul>\n</li>\n<li>\n<p><strong>Google Drive Integration</strong>:</p>\n<ul>\n<li>Set up <strong>Google Drive</strong> credentials in n8n for the <strong>Upload Image</strong> node.</li>\n<li>Specify the folder ID in Google Drive where the converted images will be uploaded.</li>\n</ul>\n</li>\n<li>\n<p><strong>Test the Workflow</strong>:</p>\n<ul>\n<li>Click the <strong>\"Test workflow\"</strong> button in n8n to trigger the workflow.</li>\n<li>The workflow will:\n<ul>\n<li>Retrieve image URLs from the Google Sheet.</li>\n<li>Convert the images to WEBP format using the APYHub API.</li>\n<li>Update the Google Sheet with the converted image URLs.</li>\n<li>Upload the converted images to Google Drive.</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><strong>Optional Customization</strong>:</p>\n<ul>\n<li>Modify the workflow to include additional features, such as:\n<ul>\n<li>Adding more image formats for conversion.</li>\n<li>Sending notifications when the conversion is complete.</li>\n<li>Integrating with other storage services (e.g., Dropbox, AWS S3).</li>\n</ul>\n</li>\n</ul>\n</li>\n</ol>\n</div><!--]-->",
  "readme_zh": "该工作流利用**APYHub API**实现了**JPG/PNG**格式图片自动转**WEBP**的全流程自动化：从**谷歌表格**获取图片链接、转换格式后上传至**谷歌云盘**。\n\n作为图像转换任务的自动化利器，它能显著提升效率，确保图片精准转换为目标格式并妥善存储。\n\n网站采用WebP图像可带来多重SEO优势：\n1. **加载提速** - 更小的文件体积缩短页面加载时间，优化用户体验\n2. **核心指标提升** - 改善LCP（最大内容绘制）等谷歌看重的性能指标\n3. **移动端优化** - 低带宽消耗增强移动设备适用性\n4. **搜索排名跃升** - 更快的速度带来更好的谷歌排名\n5. **服务器减压** - 轻量图片降低主机/CDN成本，提升站点效能\n\n* * *\n\n### **一、实现原理**\n本工作流专为图像格式转换与文件管理设计，运行流程如下：\n\n1. **手动触发**  \n   - 通过**手动触发节点**启动，点击\"测试工作流\"即开始运行\n2. **API密钥设置**  \n   - **密钥设置节点**配置调用APYHub API所需的认证密钥\n3. **获取图像**  \n   - **图像获取节点**从**谷歌表格**读取图片URL列表，表格需包含原始链接(`FROM`)、转换后链接(`TO`)和状态标记(`DONE`)三列\n4. **提取扩展名**  \n   - **扩展名获取节点**从URL解析文件格式(JPG/JPEG/PNG)并写入JSON数据\n5. **格式判断**  \n   - **格式判断节点**根据扩展名分流：  \n     ✓ JPG/JPEG → 转至**JPG转WEBP节点**  \n     ✓ PNG → 转至**PNG转WEBP节点**\n6. **图像转换**  \n   - 转换节点向**APYHub API**发送POST请求获取WEBP格式图片，API返回转换后文件URL\n7. **表格更新**  \n   - **表格更新节点**将转换后的URL回填至谷歌表格，并标记该行状态为已完成(`DONE`)\n8. **获取转换件**  \n   - **文件获取节点**从API返回的URL下载WEBP格式图像\n9. **云端存储**  \n   - **图像上传节点**将转换后的文件保存至指定**谷歌云盘**文件夹\n\n* * *\n\n### **二、配置指南**\n在n8n中部署本工作流需完成以下步骤：\n\n1. **APYHub密钥配置**  \n   - 前往[APYHub官网](https://apyhub.com/)获取**API密钥**  \n   - 在**密钥设置节点**填入获得的密钥\n\n2. **谷歌表格对接**  \n   - 为**图像获取节点**和**表格更新节点**配置谷歌表格凭证  \n   - 创建包含`FROM`(原图链接)、`TO`(转换链接)、`DONE`(状态)三列的表格  \n   - 在**图像获取节点**填写表格文档ID和工作表名称\n\n3. **谷歌云盘对接**  \n   - 为**图像上传节点**配置谷歌云盘凭证  \n   - 指定目标文件夹ID用于存储转换后的图片\n\n4. **工作流测试**  \n   - 点击n8n中的**\"测试工作流\"**按钮触发流程  \n   - 系统将自动执行：  \n     ✓ 从表格读取图片链接  \n     ✓ 通过APYHub API转换格式  \n     ✓ 更新表格数据  \n     ✓ 上传文件至云盘\n\n5. **扩展定制**（可选）  \n   - 可拓展功能包括：  \n     ✓ 支持更多图像格式转换  \n     ✓ 添加转换完成通知  \n     ✓ 对接其他存储服务（如Dropbox、AWS S3等）",
  "title_zh": "自动化图像优化器：通过APYHub与Google Drive将JPG/PNG转换为WebP",
  "publish_date_zh": "上次更新于一个月前",
  "workflow_json_zh": "{\n  \"id\": \"IyDJ7Zgh4MV43YTh\",\n  \"meta\": {\n    \"instanceId\": \"a4bfc93e975ca233ac45ed7c9227d84cf5a2329310525917adaf3312e10d5462\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"name\": \"Convert image from jpg/png to webp\",\n  \"tags\": [],\n  \"nodes\": [\n    {\n      \"id\": \"09977b8b-e095-4419-b136-bcbadf0f5d84\",\n      \"name\": \"When clicking ‘Test workflow’\",\n      \"type\": \"n8n-nodes-base.manualTrigger\",\n      \"position\": [\n        -320,\n        -20\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"55c01841-9576-4663-bb24-c9e0082ecab5\",\n      \"name\": \"Set API KEY\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        40,\n        -20\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"1fa468da-3e30-46b0-a44b-a723e45c5fda\",\n              \"name\": \"apikey\",\n              \"type\": \"string\",\n              \"value\": \"APY**************************************************************\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"2d50e290-a861-4575-abbc-7f311d1934bb\",\n      \"name\": \"Get images\",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"position\": [\n        380,\n        -20\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"returnFirstMatch\": true\n        },\n        \"filtersUI\": {\n          \"values\": [\n            {\n              \"lookupColumn\": \"DONE\"\n            }\n          ]\n        },\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"gid=0\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1upj3EDLwU1N7NHWWV3DhwMuE6ty39tIK5z5lCVDWWuM/edit#gid=0\",\n          \"cachedResultName\": \"Foglio1\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"1upj3EDLwU1N7NHWWV3DhwMuE6ty39tIK5z5lCVDWWuM\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1upj3EDLwU1N7NHWWV3DhwMuE6ty39tIK5z5lCVDWWuM/edit?usp=drivesdk\",\n          \"cachedResultName\": \"Convert images\"\n        }\n      },\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"JYR6a64Qecd6t8Hb\",\n          \"name\": \"Google Sheets account\"\n        }\n      },\n      \"typeVersion\": 4.5\n    },\n    {\n      \"id\": \"b3c5d64c-0e2a-472b-83f7-91cabd4d1646\",\n      \"name\": \"Get extension\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        660,\n        -20\n      ],\n      \"parameters\": {\n        \"jsCode\": \"// Loop over input items and add new fields 'FILENAME' and 'EXTENSION' to the JSON of each one\\nfor (const item of $input.all()) {\\n  // Extract the 'FROM' field\\n  const url = item.json.FROM;\\n\\n  const filenameWithExtension = url.split('/').pop().split(/[#?]/)[0];\\n\\n  const extension = filenameWithExtension.split('.').pop();\\n\\n  const filename = filenameWithExtension.substring(0, filenameWithExtension.length - extension.length - 1);\\n\\n  item.json.FILENAME = filename;\\n  item.json.EXTENSION = extension;\\n}\\n\\nreturn $input.all();\\n\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"e281cd63-79d1-4ca3-88c0-81aaa7e0dbe8\",\n      \"name\": \"JPG or PNG?\",\n      \"type\": \"n8n-nodes-base.switch\",\n      \"position\": [\n        -320,\n        460\n      ],\n      \"parameters\": {\n        \"rules\": {\n          \"values\": [\n            {\n              \"outputKey\": \"jpeg\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"f25651ea-ee05-4e8d-91a8-fa96997e2794\",\n                    \"operator\": {\n                      \"type\": \"string\",\n                      \"operation\": \"equals\"\n                    },\n                    \"leftValue\": \"={{ $json.EXTENSION }}\",\n                    \"rightValue\": \"jpg\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            },\n            {\n              \"outputKey\": \"jpeg\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"6a2dc1fd-5e5a-4015-bad1-e258dfead84f\",\n                    \"operator\": {\n                      \"name\": \"filter.operator.equals\",\n                      \"type\": \"string\",\n                      \"operation\": \"equals\"\n                    },\n                    \"leftValue\": \"={{ $json.EXTENSION }}\",\n                    \"rightValue\": \"jpeg\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            },\n            {\n              \"outputKey\": \"png\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"1d0e09dd-edee-4778-9b3a-9a4429a06db0\",\n                    \"operator\": {\n                      \"name\": \"filter.operator.equals\",\n                      \"type\": \"string\",\n                      \"operation\": \"equals\"\n                    },\n                    \"leftValue\": \"={{ $json.EXTENSION }}\",\n                    \"rightValue\": \"png\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            }\n          ]\n        },\n        \"options\": {}\n      },\n      \"typeVersion\": 3.2\n    },\n    {\n      \"id\": \"f3257837-88e0-4f5f-bbd5-5c63c5ba4ed1\",\n      \"name\": \"From JPG to WEBP\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        -100,\n        320\n      ],\n      \"parameters\": {\n        \"url\": \"=https://api.apyhub.com/convert/image/jpeg/webp/url?output=test-sample\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"jsonBody\": \"={\\n  \\\"url\\\":\\\"{{ $json.FROM }}\\\"\\n} \",\n        \"sendBody\": true,\n        \"sendHeaders\": true,\n        \"specifyBody\": \"json\",\n        \"headerParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"Content-Type\",\n              \"value\": \"application/json\"\n            },\n            {\n              \"name\": \"api-token\",\n              \"value\": \"={{ $('Set API KEY').item.json.apikey }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"de1198c3-17a2-4b45-a334-6334b2b935c4\",\n      \"name\": \"PNG to WEBP\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        -100,\n        580\n      ],\n      \"parameters\": {\n        \"url\": \"=https://api.apyhub.com/convert/image/png/webp/url?output=test-sample\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"jsonBody\": \"={\\n  \\\"url\\\":\\\"{{ $json.FROM }}\\\"\\n} \",\n        \"sendBody\": true,\n        \"sendHeaders\": true,\n        \"specifyBody\": \"json\",\n        \"headerParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"Content-Type\",\n              \"value\": \"application/json\"\n            },\n            {\n              \"name\": \"apy-token\",\n              \"value\": \"={{ $('Set API KEY').item.json.apikey }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"38b46480-c089-4bca-88ac-7f006c12d3b9\",\n      \"name\": \"Update Sheet\",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"position\": [\n        160,\n        440\n      ],\n      \"parameters\": {\n        \"columns\": {\n          \"value\": {\n            \"TO\": \"={{ $json.data }}\",\n            \"DONE\": \"x\",\n            \"row_number\": \"={{ $('Get images').item.json.row_number }}\"\n          },\n          \"schema\": [\n            {\n              \"id\": \"FROM\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"FROM\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"TO\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"TO\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"DONE\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"DONE\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"row_number\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"readOnly\": true,\n              \"required\": false,\n              \"displayName\": \"row_number\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            }\n          ],\n          \"mappingMode\": \"defineBelow\",\n          \"matchingColumns\": [\n            \"row_number\"\n          ],\n          \"attemptToConvertTypes\": false,\n          \"convertFieldsToString\": false\n        },\n        \"options\": {},\n        \"operation\": \"update\",\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"gid=0\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1upj3EDLwU1N7NHWWV3DhwMuE6ty39tIK5z5lCVDWWuM/edit#gid=0\",\n          \"cachedResultName\": \"Foglio1\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"1upj3EDLwU1N7NHWWV3DhwMuE6ty39tIK5z5lCVDWWuM\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1upj3EDLwU1N7NHWWV3DhwMuE6ty39tIK5z5lCVDWWuM/edit?usp=drivesdk\",\n          \"cachedResultName\": \"Convert images from jpg/png to webp\"\n        }\n      },\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"JYR6a64Qecd6t8Hb\",\n          \"name\": \"Google Sheets account\"\n        }\n      },\n      \"typeVersion\": 4.5\n    },\n    {\n      \"id\": \"2dc29c73-efcb-4bef-8d9a-5a1914df62ad\",\n      \"name\": \"Get file image\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        420,\n        440\n      ],\n      \"parameters\": {\n        \"url\": \"={{ $json.TO }}\",\n        \"options\": {\n          \"response\": {\n            \"response\": {\n              \"responseFormat\": \"file\"\n            }\n          }\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"acee7120-ceb4-472e-a941-066056da5cd6\",\n      \"name\": \"Upload image\",\n      \"type\": \"n8n-nodes-base.googleDrive\",\n      \"position\": [\n        700,\n        440\n      ],\n      \"parameters\": {\n        \"name\": \"={{ $('Get extension').item.json.FILENAME }}.webp\",\n        \"driveId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"My Drive\"\n        },\n        \"options\": {},\n        \"folderId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"1XyUSYXdNrZIw0XyZ3YpuaxGJjOaARyEJ\",\n          \"cachedResultUrl\": \"https://drive.google.com/drive/folders/1XyUSYXdNrZIw0XyZ3YpuaxGJjOaARyEJ\",\n          \"cachedResultName\": \"Immagini\"\n        }\n      },\n      \"credentials\": {\n        \"googleDriveOAuth2Api\": {\n          \"id\": \"HEy5EuZkgPZVEa9w\",\n          \"name\": \"Google Drive account (n3w.it)\"\n        }\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"0a491e7b-2482-429e-9901-cb2bf3d34509\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -360,\n        -520\n      ],\n      \"parameters\": {\n        \"color\": 3,\n        \"width\": 800,\n        \"height\": 200,\n        \"content\": \"## 将图片从JPG/PNG转换为WEBP格式\\n\\n该工作流利用**APYHub API**实现了将**JPG/PNG**格式图片自动转换为**WEBP**格式的全过程。系统会从**谷歌表格**中获取图片链接，完成格式转换后，将转换后的文件上传至**谷歌云盘**。\\n\\n此工作流是自动化图片转换任务的强力工具，既能节省时间，又能确保图片高效转换为目标格式并妥善存储。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"78a198c4-449f-4a68-96e4-20ecd044fe1f\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -360,\n        -280\n      ],\n      \"parameters\": {\n        \"width\": 800,\n        \"height\": 120,\n        \"content\": \"## 初步步骤\\n- 从[APYHub](https://apyhub.com//)获取您的免费API密钥\\n- 复制[此表格](https://docs.google.com/spreadsheets/d/1upj3EDLwU1N7NHWWV3DhwMuE6ty39tIK5z5lCVDWWuM/edit?usp=sharing)，并将您的图片链接（仅限jpg、jpeg和png格式）填入\\\"FROM\\\"列中\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"active\": false,\n  \"pinData\": {},\n  \"settings\": {\n    \"executionOrder\": \"v1\"\n  },\n  \"versionId\": \"e2fa7236-fbf9-43ec-a217-aeb43664d129\",\n  \"connections\": {\n    \"Get images\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get extension\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"JPG or PNG?\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"From JPG to WEBP\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"From JPG to WEBP\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"PNG to WEBP\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"PNG to WEBP\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Update Sheet\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Set API KEY\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get images\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Update Sheet\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get file image\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get extension\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"JPG or PNG?\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get file image\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Upload image\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"From JPG to WEBP\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Update Sheet\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"When clicking ‘Test workflow’\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Set API KEY\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}