{
  "title": "Food Delivery Notifications and Easy Expense Tracking",
  "url": "https://n8n.io/workflows/2707-food-delivery-notifications-and-easy-expense-tracking/",
  "category": "Other",
  "category_url": "https://n8n.io/workflows/categories/other/?sort=createdAt:desc",
  "author": "darrell_tw",
  "publish_date": "Last update 4 months ago",
  "publish_date_absolute": "2025-01-22",
  "content": "",
  "workflow_json": "{\"id\":\"dDInVHNAfSedBUCb\",\"meta\":{\"instanceId\":\"fddb3e91967f1012c95dd02bf5ad21f279fc44715f47a7a96a33433621caa253\"},\"name\":\"外送記帳\",\"tags\":[],\"nodes\":[{\"id\":\"09c19ba1-45f2-43af-9985-3508d801c1b7\",\"name\":\"Loop Over Items\",\"type\":\"n8n-nodes-base.splitInBatches\",\"position\":[440,0],\"parameters\":{\"options\":{}},\"typeVersion\":3},{\"id\":\"18625b1d-f8ff-4e48-8b64-a9d42d24eccc\",\"name\":\"Click to Test Flow\",\"type\":\"n8n-nodes-base.manualTrigger\",\"position\":[40,0],\"parameters\":{},\"typeVersion\":1},{\"id\":\"649933c4-b16b-46de-9038-7d8c0b3d8e88\",\"name\":\"Get emails from Gmail with certain subject\",\"type\":\"n8n-nodes-base.gmail\",\"position\":[220,0],\"webhookId\":\"99c4deca-17c7-47ae-a38c-50344938e792\",\"parameters\":{\"simple\":false,\"filters\":{\"q\":\"subject:透過 Uber Eats 系統送出的訂單\"},\"options\":{},\"operation\":\"getAll\",\"returnAll\":true},\"credentials\":{\"gmailOAuth2\":{\"id\":\"34rX9kxKlJadOY6u\",\"name\":\"Gmail account\"}},\"typeVersion\":2.1},{\"id\":\"b2118a34-52ad-4464-b7ea-7f3105536fad\",\"name\":\"Receive certain keyword Gmail Trigger\",\"type\":\"n8n-nodes-base.gmailTrigger\",\"position\":[120,-180],\"parameters\":{\"simple\":false,\"filters\":{\"q\":\"subject:透過 Uber Eats 系統送出的訂單\"},\"options\":{},\"pollTimes\":{\"item\":[{\"mode\":\"everyHour\",\"minute\":30}]}},\"credentials\":{\"gmailOAuth2\":{\"id\":\"34rX9kxKlJadOY6u\",\"name\":\"Gmail account\"}},\"typeVersion\":1.2},{\"id\":\"00986543-d01a-4b11-bbaa-60c73a1dae02\",\"name\":\"Extract Price, Shop, Date, TIme\",\"type\":\"n8n-nodes-base.set\",\"position\":[620,60],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"c24405f8-267f-4933-a178-1b51145d62bf\",\"name\":\"price\",\"type\":\"string\",\"value\":\"={{ $json[\\\"text\\\"].match(/\\\\$(\\\\d+(\\\\.\\\\d{2})?)/)[1] }}\"},{\"id\":\"968cf7cd-6e28-4328-a829-3fe2cb327643\",\"name\":\"shop\",\"type\":\"string\",\"value\":\"={{ $json[\\\"text\\\"].match(/以下是您在([\\\\u4e00-\\\\u9fa5a-zA-Z0-9\\\\s]+)訂購/)[1] }}\"},{\"id\":\"53642bcb-f3a6-4086-bdc1-2f8d27927462\",\"name\":\"date\",\"type\":\"string\",\"value\":\"={{ $json[\\\"text\\\"].match(/Date: (\\\\d{4}年\\\\d{1,2}月\\\\d{1,2}日)/)[1].replace(\\\"年\\\", \\\".\\\").replace(\\\"月\\\", \\\".\\\").replace(\\\"日\\\", \\\"\\\") }}\"},{\"id\":\"cd227132-971b-4970-8b5d-724463efe036\",\"name\":\"time\",\"type\":\"string\",\"value\":\"={{ \\n  $json[\\\"text\\\"].match(/(上午|下午) (\\\\d{1,2}):(\\\\d{2})/) ? \\n  ($json[\\\"text\\\"].match(/(上午|下午) (\\\\d{1,2}):(\\\\d{2})/)[1] === '下午' && $json[\\\"text\\\"].match(/(上午|下午) (\\\\d{1,2}):(\\\\d{2})/)[2] !== '12' \\n    ? (parseInt($json[\\\"text\\\"].match(/(上午|下午) (\\\\d{1,2}):(\\\\d{2})/)[2]) + 12) + ':' + $json[\\\"text\\\"].match(/(上午|下午) (\\\\d{1,2}):(\\\\d{2})/)[3] \\n    : $json[\\\"text\\\"].match(/(上午|下午) (\\\\d{1,2}):(\\\\d{2})/)[2] + ':' + $json[\\\"text\\\"].match(/(上午|下午) (\\\\d{1,2}):(\\\\d{2})/)[3]\\n  )\\n  : null \\n}}\"}]}},\"typeVersion\":3.4},{\"id\":\"3d8f97ea-4a0d-4939-898f-8a0ca9415e7d\",\"name\":\"Send to Slack with Block\",\"type\":\"n8n-nodes-base.slack\",\"position\":[800,60],\"webhookId\":\"0e812732-74d2-4924-8db3-6b9234965937\",\"parameters\":{\"text\":\"=Ubereat 訂餐資訊: \\n商家:  {{ $json.shop }}\\n金額: {{ $json.price }}\\n日期: {{ $json.date }}\\n\\n記帳網址:\\nmoze3://expense?amount={{ $json.price }}&account=信用卡&subcategory=外送&store={{ $json.shop }}&date={{ $json.date }}\",\"select\":\"channel\",\"blocksUi\":\"={\\n\\t\\\"blocks\\\": [\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"section\\\",\\n\\t\\t\\t\\\"text\\\": {\\n\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\\"text\\\": \\\"Ubereat 訂餐資訊:\\\\n\\\\n*商家:* {{ $json.shop }}\\\\n*金額:* {{ $json.price }}\\\\n*日期:* {{ $json.date }}\\\"\\n\\t\\t\\t}\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"divider\\\"\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"section\\\",\\n\\t\\t\\t\\\"text\\\": {\\n\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\\"text\\\": \\\"Moze 記帳請點我\\\"\\n\\t\\t\\t},\\n\\t\\t\\t\\\"accessory\\\": {\\n\\t\\t\\t\\t\\\"type\\\": \\\"button\\\",\\n\\t\\t\\t\\t\\\"text\\\": {\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"plain_text\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"記帳\\\",\\n\\t\\t\\t\\t\\t\\\"emoji\\\": true\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\\"value\\\": \\\"click\\\",\\n\\t\\t\\t\\t\\\"url\\\": \\\"moze3://expense?amount={{ $json.price }}&account=信用卡&subcategory=外送&store={{ $json.shop }}&date={{ $json.date }}&&project=生活開銷&&time={{ $json.time }}\\\",\\n\\t\\t\\t\\t\\\"action_id\\\": \\\"button-action\\\"\\n\\t\\t\\t}\\n\\t\\t}\\n\\t]\\n}\",\"channelId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"C0883CJM1UH\",\"cachedResultName\":\"外送記帳自動化\"},\"messageType\":\"block\",\"otherOptions\":{},\"authentication\":\"oAuth2\"},\"credentials\":{\"slackOAuth2Api\":{\"id\":\"sD1J9ZLyEhcglrRa\",\"name\":\"Slack account\"}},\"typeVersion\":2.3}],\"active\":true,\"pinData\":{},\"settings\":{\"executionOrder\":\"v1\"},\"versionId\":\"0840254c-0058-47fe-9b22-7fbb93144788\",\"connections\":{\"Loop Over Items\":{\"main\":[[],[{\"node\":\"Extract Price, Shop, Date, TIme\",\"type\":\"main\",\"index\":0}]]},\"Click to Test Flow\":{\"main\":[[{\"node\":\"Get emails from Gmail with certain subject\",\"type\":\"main\",\"index\":0}]]},\"Send to Slack with Block\":{\"main\":[[{\"node\":\"Loop Over Items\",\"type\":\"main\",\"index\":0}]]},\"Extract Price, Shop, Date, TIme\":{\"main\":[[{\"node\":\"Send to Slack with Block\",\"type\":\"main\",\"index\":0}]]},\"Receive certain keyword Gmail Trigger\":{\"main\":[[{\"node\":\"Loop Over Items\",\"type\":\"main\",\"index\":0}]]},\"Get emails from Gmail with certain subject\":{\"main\":[[{\"node\":\"Loop Over Items\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "# Workflow Description\n\nThis workflow automates the process of retrieving emails from a food delivery platform, extracting key order details, and sending notifications to a Slack channel. Additionally, the Slack message includes a **Moze accounting app URL scheme** link for quick expense tracking.\n\n* * *\n\n## Key Features\n\n  1. **Manual Trigger** : Allows the workflow to be executed manually for immediate testing.\n  2. **Gmail Integration** : Retrieves emails containing specific keywords in the subject line (e.g., \"透過 Uber Eats 系統送出的訂單\"). (You can adjust the keywords to fit your language.)\n  3. **Data Extraction** : Parses the email content to extract key details such as: \n     * Order price\n     * Shop name\n     * Order date and time\n  4. **Slack Notification** : Sends a notification to a specified Slack channel using a structured block format, including a link to record the expense in the **Moze accounting app**.\n\n\n\n* * *\n\n## Node Configurations\n\n### 1\\. Manual Trigger\n\n  * **Purpose** : Starts the workflow manually for testing or immediate execution.\n  * **Configuration** : No setup needed.\n\n\n\n* * *\n\n### 2\\. Gmail Trigger\n\n  * **Purpose** : Automatically polls Gmail for new emails matching specific subject keywords.\n  * **Configuration** : \n    * **Filters** : \n      * `q`: `subject:透過 Uber Eats 系統送出的訂單` (You can adjust the keywords to fit your language.)\n    * **Polling Frequency** : Every hour at 30 minutes past the hour.\n    * **Credentials** : Linked Gmail account.\n\n\n\n* * *\n\n### 3\\. Extract Price, Shop, Date, Time\n\n  * **Purpose** : Extracts key information from the email content using regular expressions.\n  * **Extracted Data** : \n    * `price`: Order price (e.g., `$200`).\n    * `shop`: Shop name (e.g., \"店名\").\n    * `date`: Order date (e.g., `2024.01.01`).\n    * `time`: Order time converted to 24-hour format (e.g., `14:30`).\n\n\n\n* * *\n\n### 4\\. Slack Notification\n\n  * **Purpose** : Sends a formatted message to a Slack channel with extracted order details.\n  * **Message Content** : \n    * **Text** :\n          \n          Ubereat 訂餐資訊:\n          商家: {{ shop }}\n          金額: {{ price }}\n          日期: {{ date }}\n          \n\n    * **Moze App Link** : Includes a clickable button in the Slack message with a pre-filled Moze app URL scheme:\n          \n          moze3://expense?amount={{ price }}&account=信用卡&subcategory=外送&store={{ shop }}&date={{ date }}&time={{ time }}&project=生活開銷\n          \n\n    * **Channel** : Slack channel ID associated with food delivery notifications.\n\n\n\n* * *\n\n## Additional Notes\n\n  * **Customization** : Adjust the email subject filter (`subject`) to match other types of food delivery platforms or services.\n  * **Error Handling** : Ensure regular expressions for data extraction match the email format. Test with sample emails before deployment.\n  * **Moze URL Scheme Reference** : Learn more about Moze app URL schemes for customization by visiting the [Moze Documentation](https://moze.app/).\n\n\n\nThis workflow is ideal for automating expense tracking and centralizing notifications for food delivery orders, streamlining personal or team expense management.\n\n* * *\n\nImage:  \nUberEat Gmail with order information  \n![n8n_delievery_slack_moze_step1.PNG](https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/n8n_delievery_slack_moze_step1_bd59d73e86.PNG)\n\nSlack text with button  \n![n8n_delievery_slack_moze_step2.jpg](https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/n8n_delievery_slack_moze_step2_5352662b67.jpg)\n\nClick the button will call moze url scheme  \n![n8n_delievery_slack_moze_step3.jpg](https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/n8n_delievery_slack_moze_step3_029e4eafe8.jpg)\n\n* * *\n\n# 工作流程描述\n\n此工作流程自動化從外送平台獲取郵件，提取關鍵訂單詳細資訊，並將通知發送到指定的 Slack 頻道。此外，Slack 消息中包含一個 **Moze 記帳 App URL Scheme** 的連結，方便快速記帳。\n\n* * *\n\n## 主要功能\n\n  1. **Manual Trigger** ：允許手動執行工作流程，方便測試。\n  2. **Gmail Integration** ：從 Gmail 中提取包含特定關鍵字（例如：「透過 Uber Eats 系統送出的訂單」）的郵件。\n  3. **資料提取** ：解析郵件內容，提取以下關鍵資訊： \n     * 訂單金額\n     * 商家名稱\n     * 訂單日期與時間\n  4. **Slack 通知** ：將結構化的通知發送到指定的 Slack 頻道，並包含一個連結供用戶快速記帳。\n\n\n\n* * *\n\n## 節點設定\n\n### 1\\. Manual Trigger\n\n  * **用途** ：手動啟動工作流程以進行測試或即時執行。\n  * **設定** ：無需額外設定。\n\n\n\n* * *\n\n### 2\\. Gmail Trigger\n\n  * **用途** ：自動檢查 Gmail 中是否有符合特定主題關鍵字的新郵件。\n  * **設定** ： \n    * **篩選條件** ： \n      * `q`: `subject:透過 Uber Eats 系統送出的訂單`\n    * **檢查頻率** ：每小時的 30 分。\n    * **憑證** ：已連結的 Gmail 帳號。\n\n\n\n* * *\n\n### 3\\. Extract Price, Shop, Date, Time\n\n  * **用途** ：使用正則表達式從郵件內容中提取關鍵資訊。\n  * **提取的資料** ： \n    * `price`：訂單金額（例如：`$200`）。\n    * `shop`：商家名稱（例如：「店名」）。\n    * `date`：訂單日期（例如：`2024.01.01`）。\n    * `time`：訂單時間（24 小時制，例如：`14:30`）。\n\n\n\n* * *\n\n### 4\\. Slack 通知\n\n  * **用途** ：將訂單詳細資訊以格式化消息發送到 Slack。\n  * **消息內容** ： \n    * **文字** ：\n          \n          Ubereat 訂餐資訊:\n          商家: {{ shop }}\n          金額: {{ price }}\n          日期: {{ date }}\n          \n\n    * **Moze App 連結** ：Slack 消息中包含一個可點擊按鈕，預填 Moze App URL Scheme：\n          \n          moze3://expense?amount={{ price }}&account=信用卡&subcategory=外送&store={{ shop }}&date={{ date }}&time={{ time }}&project=生活開銷\n          \n\n    * **頻道** ：與外送通知相關的 Slack 頻道。\n\n\n\n* * *\n\n## 補充說明\n\n  * **自訂化** ：可調整郵件主題篩選條件（`subject`），以匹配其他外送平台或服務。\n  * **錯誤處理** ：確保正則表達式匹配郵件格式。在部署前使用樣本郵件進行測試。\n  * **Moze URL Scheme 參考** ：了解更多關於 Moze App URL Scheme 的客製化資訊，請參閱 [Moze 官方文件](https://moze.app/)。\n\n\n\n此工作流程適合自動化費用記帳以及集中管理外送訂單通知，提升個人或團隊的費用管理效率。\n",
  "readme_html": "<!--[--><div data-v-50766329=\"\"><h1>Workflow Description</h1>\n<p>This workflow automates the process of retrieving emails from a food delivery platform, extracting key order details, and sending notifications to a Slack channel. Additionally, the Slack message includes a <strong>Moze accounting app URL scheme</strong> link for quick expense tracking.</p>\n<hr>\n<h2>Key Features</h2>\n<ol>\n<li><strong>Manual Trigger</strong>: Allows the workflow to be executed manually for immediate testing.</li>\n<li><strong>Gmail Integration</strong>: Retrieves emails containing specific keywords in the subject line (e.g., \"透過 Uber Eats 系統送出的訂單\"). (You can adjust the keywords to fit your language.)</li>\n<li><strong>Data Extraction</strong>: Parses the email content to extract key details such as:\n<ul>\n<li>Order price</li>\n<li>Shop name</li>\n<li>Order date and time</li>\n</ul>\n</li>\n<li><strong>Slack Notification</strong>: Sends a notification to a specified Slack channel using a structured block format, including a link to record the expense in the <strong>Moze accounting app</strong>.</li>\n</ol>\n<hr>\n<h2>Node Configurations</h2>\n<h3>1. Manual Trigger</h3>\n<ul>\n<li><strong>Purpose</strong>: Starts the workflow manually for testing or immediate execution.</li>\n<li><strong>Configuration</strong>: No setup needed.</li>\n</ul>\n<hr>\n<h3>2. Gmail Trigger</h3>\n<ul>\n<li><strong>Purpose</strong>: Automatically polls Gmail for new emails matching specific subject keywords.</li>\n<li><strong>Configuration</strong>:\n<ul>\n<li><strong>Filters</strong>:\n<ul>\n<li><code>q</code>: <code>subject:透過 Uber Eats 系統送出的訂單</code> (You can adjust the keywords to fit your language.)</li>\n</ul>\n</li>\n<li><strong>Polling Frequency</strong>: Every hour at 30 minutes past the hour.</li>\n<li><strong>Credentials</strong>: Linked Gmail account.</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h3>3. Extract Price, Shop, Date, Time</h3>\n<ul>\n<li><strong>Purpose</strong>: Extracts key information from the email content using regular expressions.</li>\n<li><strong>Extracted Data</strong>:\n<ul>\n<li><code>price</code>: Order price (e.g., <code>$200</code>).</li>\n<li><code>shop</code>: Shop name (e.g., \"店名\").</li>\n<li><code>date</code>: Order date (e.g., <code>2024.01.01</code>).</li>\n<li><code>time</code>: Order time converted to 24-hour format (e.g., <code>14:30</code>).</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h3>4. Slack Notification</h3>\n<ul>\n<li><strong>Purpose</strong>: Sends a formatted message to a Slack channel with extracted order details.</li>\n<li><strong>Message Content</strong>:\n<ul>\n<li><strong>Text</strong>:<pre><code>Ubereat 訂餐資訊:\n商家: {{ shop }}\n金額: {{ price }}\n日期: {{ date }}\n</code></pre>\n</li>\n<li><strong>Moze App Link</strong>: Includes a clickable button in the Slack message with a pre-filled Moze app URL scheme:<pre><code>moze3://expense?amount={{ price }}&amp;account=信用卡&amp;subcategory=外送&amp;store={{ shop }}&amp;date={{ date }}&amp;time={{ time }}&amp;project=生活開銷\n</code></pre>\n</li>\n<li><strong>Channel</strong>: Slack channel ID associated with food delivery notifications.</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h2>Additional Notes</h2>\n<ul>\n<li><strong>Customization</strong>: Adjust the email subject filter (<code>subject</code>) to match other types of food delivery platforms or services.</li>\n<li><strong>Error Handling</strong>: Ensure regular expressions for data extraction match the email format. Test with sample emails before deployment.</li>\n<li><strong>Moze URL Scheme Reference</strong>: Learn more about Moze app URL schemes for customization by visiting the <a href=\"https://moze.app/\" rel=\"ugc nofollow\" target=\"_blank\">Moze Documentation</a>.</li>\n</ul>\n<p>This workflow is ideal for automating expense tracking and centralizing notifications for food delivery orders, streamlining personal or team expense management.</p>\n<hr>\n<p>Image:<br>\nUberEat Gmail with order information<br>\n<img src=\"https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/n8n_delievery_slack_moze_step1_bd59d73e86.PNG\" alt=\"n8n_delievery_slack_moze_step1.PNG\"></p>\n<p>Slack text with button<br>\n<img src=\"https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/n8n_delievery_slack_moze_step2_5352662b67.jpg\" alt=\"n8n_delievery_slack_moze_step2.jpg\"></p>\n<p>Click the button will call moze url scheme<br>\n<img src=\"https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/n8n_delievery_slack_moze_step3_029e4eafe8.jpg\" alt=\"n8n_delievery_slack_moze_step3.jpg\"></p>\n<hr>\n<h1>工作流程描述</h1>\n<p>此工作流程自動化從外送平台獲取郵件，提取關鍵訂單詳細資訊，並將通知發送到指定的 Slack 頻道。此外，Slack 消息中包含一個 <strong>Moze 記帳 App URL Scheme</strong> 的連結，方便快速記帳。</p>\n<hr>\n<h2>主要功能</h2>\n<ol>\n<li><strong>Manual Trigger</strong>：允許手動執行工作流程，方便測試。</li>\n<li><strong>Gmail Integration</strong>：從 Gmail 中提取包含特定關鍵字（例如：「透過 Uber Eats 系統送出的訂單」）的郵件。</li>\n<li><strong>資料提取</strong>：解析郵件內容，提取以下關鍵資訊：\n<ul>\n<li>訂單金額</li>\n<li>商家名稱</li>\n<li>訂單日期與時間</li>\n</ul>\n</li>\n<li><strong>Slack 通知</strong>：將結構化的通知發送到指定的 Slack 頻道，並包含一個連結供用戶快速記帳。</li>\n</ol>\n<hr>\n<h2>節點設定</h2>\n<h3>1. Manual Trigger</h3>\n<ul>\n<li><strong>用途</strong>：手動啟動工作流程以進行測試或即時執行。</li>\n<li><strong>設定</strong>：無需額外設定。</li>\n</ul>\n<hr>\n<h3>2. Gmail Trigger</h3>\n<ul>\n<li><strong>用途</strong>：自動檢查 Gmail 中是否有符合特定主題關鍵字的新郵件。</li>\n<li><strong>設定</strong>：\n<ul>\n<li><strong>篩選條件</strong>：\n<ul>\n<li><code>q</code>: <code>subject:透過 Uber Eats 系統送出的訂單</code></li>\n</ul>\n</li>\n<li><strong>檢查頻率</strong>：每小時的 30 分。</li>\n<li><strong>憑證</strong>：已連結的 Gmail 帳號。</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h3>3. Extract Price, Shop, Date, Time</h3>\n<ul>\n<li><strong>用途</strong>：使用正則表達式從郵件內容中提取關鍵資訊。</li>\n<li><strong>提取的資料</strong>：\n<ul>\n<li><code>price</code>：訂單金額（例如：<code>$200</code>）。</li>\n<li><code>shop</code>：商家名稱（例如：「店名」）。</li>\n<li><code>date</code>：訂單日期（例如：<code>2024.01.01</code>）。</li>\n<li><code>time</code>：訂單時間（24 小時制，例如：<code>14:30</code>）。</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h3>4. Slack 通知</h3>\n<ul>\n<li><strong>用途</strong>：將訂單詳細資訊以格式化消息發送到 Slack。</li>\n<li><strong>消息內容</strong>：\n<ul>\n<li><strong>文字</strong>：<pre><code>Ubereat 訂餐資訊:\n商家: {{ shop }}\n金額: {{ price }}\n日期: {{ date }}\n</code></pre>\n</li>\n<li><strong>Moze App 連結</strong>：Slack 消息中包含一個可點擊按鈕，預填 Moze App URL Scheme：<pre><code>moze3://expense?amount={{ price }}&amp;account=信用卡&amp;subcategory=外送&amp;store={{ shop }}&amp;date={{ date }}&amp;time={{ time }}&amp;project=生活開銷\n</code></pre>\n</li>\n<li><strong>頻道</strong>：與外送通知相關的 Slack 頻道。</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h2>補充說明</h2>\n<ul>\n<li><strong>自訂化</strong>：可調整郵件主題篩選條件（<code>subject</code>），以匹配其他外送平台或服務。</li>\n<li><strong>錯誤處理</strong>：確保正則表達式匹配郵件格式。在部署前使用樣本郵件進行測試。</li>\n<li><strong>Moze URL Scheme 參考</strong>：了解更多關於 Moze App URL Scheme 的客製化資訊，請參閱 <a href=\"https://moze.app/\" rel=\"ugc nofollow\" target=\"_blank\">Moze 官方文件</a>。</li>\n</ul>\n<p>此工作流程適合自動化費用記帳以及集中管理外送訂單通知，提升個人或團隊的費用管理效率。</p>\n</div><!--]-->",
  "readme_zh": "# 工作流程说明\n\n该工作流实现了从外卖平台自动获取邮件、提取关键订单信息并向Slack频道发送通知的自动化流程。同时，Slack消息中还包含**Moze记账应用URL方案**链接，便于快速记录支出。\n\n* * *\n\n## 核心功能\n\n  1. **手动触发器**：支持手动执行工作流以便即时测试\n  2. **Gmail集成**：获取邮件主题包含特定关键词（如\"通过Uber Eats系统发送的订单\"）的邮件（可根据需要调整关键词）\n  3. **数据提取**：解析邮件内容获取关键信息：\n     * 订单金额\n     * 商家名称\n     * 订单日期时间\n  4. **Slack通知**：向指定Slack频道发送结构化区块格式的通知，包含跳转**Moze记账应用**的快捷链接\n\n* * *\n\n## 节点配置\n\n### 1. 手动触发器\n\n  * **功能**：用于测试或立即执行工作流\n  * **配置**：无需设置\n\n* * *\n\n### 2. Gmail触发器\n\n  * **功能**：自动检索符合主题关键词的新邮件\n  * **配置**：\n    * **筛选条件**：\n      * `q`: `subject:通过Uber Eats系统发送的订单`（可调整关键词）\n    * **轮询频率**：每小时第30分钟\n    * **凭证**：已关联的Gmail账户\n\n* * *\n\n### 3. 提取金额/商家/日期/时间\n\n  * **功能**：使用正则表达式从邮件内容提取关键信息\n  * **提取数据**：\n    * `price`：订单金额（如`¥200`）\n    * `shop`：商家名称（如\"XX餐厅\"）\n    * `date`：订单日期（如`2024.01.01`）\n    * `time`：转换为24小时制的时间（如`14:30`）\n\n* * *\n\n### 4. Slack通知\n\n  * **功能**：向Slack频道发送格式化消息\n  * **消息内容**：\n    * **文本**：\n          \n          UberEats订餐信息:\n          商家: {{ shop }}\n          金额: {{ price }}\n          日期: {{ date }}\n          \n    * **Moze应用链接**：消息中包含预填Moze应用URL的可点击按钮：\n          \n          moze3://expense?amount={{ price }}&account=信用卡&subcategory=外卖&store={{ shop }}&date={{ date }}&time={{ time }}&project=生活开支\n          \n    * **频道**：关联外卖通知的Slack频道ID\n\n* * *\n\n## 补充说明\n\n  * **自定义**：可调整邮件主题筛选条件以适配其他外卖平台\n  * **错误处理**：确保数据提取的正则表达式与邮件格式匹配，部署前需测试样本邮件\n  * **Moze URL方案参考**：访问[Moze文档](https://moze.app/)了解URL方案定制\n\n该工作流能有效实现外卖订单的自动化记账和集中通知，优化个人或团队的支出管理效率。\n\n* * *\n\n图示：  \n包含订单信息的UberEats邮件  \n![n8n_delievery_slack_moze_step1.PNG](https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/n8n_delievery_slack_moze_step1_bd59d73e86.PNG)\n\n带按钮的Slack消息  \n![n8n_delievery_slack_moze_step2.jpg](https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/n8n_delievery_slack_moze_step2_5352662b67.jpg)\n\n点击按钮调用Moze链接  \n![n8n_delievery_slack_moze_step3.jpg](https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/n8n_delievery_slack_moze_step3_029e4eafe8.jpg)",
  "title_zh": "外卖通知与便捷支出追踪",
  "publish_date_zh": "最后更新于4个月前",
  "workflow_json_zh": "{\n  \"id\": \"dDInVHNAfSedBUCb\",\n  \"meta\": {\n    \"instanceId\": \"fddb3e91967f1012c95dd02bf5ad21f279fc44715f47a7a96a33433621caa253\"\n  },\n  \"name\": \"外送記帳\",\n  \"tags\": [],\n  \"nodes\": [\n    {\n      \"id\": \"09c19ba1-45f2-43af-9985-3508d801c1b7\",\n      \"name\": \"Loop Over Items\",\n      \"type\": \"n8n-nodes-base.splitInBatches\",\n      \"position\": [\n        440,\n        0\n      ],\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"18625b1d-f8ff-4e48-8b64-a9d42d24eccc\",\n      \"name\": \"Click to Test Flow\",\n      \"type\": \"n8n-nodes-base.manualTrigger\",\n      \"position\": [\n        40,\n        0\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"649933c4-b16b-46de-9038-7d8c0b3d8e88\",\n      \"name\": \"Get emails from Gmail with certain subject\",\n      \"type\": \"n8n-nodes-base.gmail\",\n      \"position\": [\n        220,\n        0\n      ],\n      \"webhookId\": \"99c4deca-17c7-47ae-a38c-50344938e792\",\n      \"parameters\": {\n        \"simple\": false,\n        \"filters\": {\n          \"q\": \"subject:透過 Uber Eats 系統送出的訂單\"\n        },\n        \"options\": {},\n        \"operation\": \"getAll\",\n        \"returnAll\": true\n      },\n      \"credentials\": {\n        \"gmailOAuth2\": {\n          \"id\": \"34rX9kxKlJadOY6u\",\n          \"name\": \"Gmail account\"\n        }\n      },\n      \"typeVersion\": 2.1\n    },\n    {\n      \"id\": \"b2118a34-52ad-4464-b7ea-7f3105536fad\",\n      \"name\": \"Receive certain keyword Gmail Trigger\",\n      \"type\": \"n8n-nodes-base.gmailTrigger\",\n      \"position\": [\n        120,\n        -180\n      ],\n      \"parameters\": {\n        \"simple\": false,\n        \"filters\": {\n          \"q\": \"subject:透過 Uber Eats 系統送出的訂單\"\n        },\n        \"options\": {},\n        \"pollTimes\": {\n          \"item\": [\n            {\n              \"mode\": \"everyHour\",\n              \"minute\": 30\n            }\n          ]\n        }\n      },\n      \"credentials\": {\n        \"gmailOAuth2\": {\n          \"id\": \"34rX9kxKlJadOY6u\",\n          \"name\": \"Gmail account\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"00986543-d01a-4b11-bbaa-60c73a1dae02\",\n      \"name\": \"Extract Price, Shop, Date, TIme\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        620,\n        60\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"c24405f8-267f-4933-a178-1b51145d62bf\",\n              \"name\": \"price\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json[\\\"text\\\"].match(/\\\\$(\\\\d+(\\\\.\\\\d{2})?)/)[1] }}\"\n            },\n            {\n              \"id\": \"968cf7cd-6e28-4328-a829-3fe2cb327643\",\n              \"name\": \"shop\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json[\\\"text\\\"].match(/以下是您在([\\\\u4e00-\\\\u9fa5a-zA-Z0-9\\\\s]+)訂購/)[1] }}\"\n            },\n            {\n              \"id\": \"53642bcb-f3a6-4086-bdc1-2f8d27927462\",\n              \"name\": \"date\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json[\\\"text\\\"].match(/Date: (\\\\d{4}年\\\\d{1,2}月\\\\d{1,2}日)/)[1].replace(\\\"年\\\", \\\".\\\").replace(\\\"月\\\", \\\".\\\").replace(\\\"日\\\", \\\"\\\") }}\"\n            },\n            {\n              \"id\": \"cd227132-971b-4970-8b5d-724463efe036\",\n              \"name\": \"time\",\n              \"type\": \"string\",\n              \"value\": \"={{ \\n  $json[\\\"text\\\"].match(/(上午|下午) (\\\\d{1,2}):(\\\\d{2})/) ? \\n  ($json[\\\"text\\\"].match(/(上午|下午) (\\\\d{1,2}):(\\\\d{2})/)[1] === '下午' && $json[\\\"text\\\"].match(/(上午|下午) (\\\\d{1,2}):(\\\\d{2})/)[2] !== '12' \\n    ? (parseInt($json[\\\"text\\\"].match(/(上午|下午) (\\\\d{1,2}):(\\\\d{2})/)[2]) + 12) + ':' + $json[\\\"text\\\"].match(/(上午|下午) (\\\\d{1,2}):(\\\\d{2})/)[3] \\n    : $json[\\\"text\\\"].match(/(上午|下午) (\\\\d{1,2}):(\\\\d{2})/)[2] + ':' + $json[\\\"text\\\"].match(/(上午|下午) (\\\\d{1,2}):(\\\\d{2})/)[3]\\n  )\\n  : null \\n}}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"3d8f97ea-4a0d-4939-898f-8a0ca9415e7d\",\n      \"name\": \"Send to Slack with Block\",\n      \"type\": \"n8n-nodes-base.slack\",\n      \"position\": [\n        800,\n        60\n      ],\n      \"webhookId\": \"0e812732-74d2-4924-8db3-6b9234965937\",\n      \"parameters\": {\n        \"text\": \"=Ubereat 訂餐資訊: \\n商家:  {{ $json.shop }}\\n金額: {{ $json.price }}\\n日期: {{ $json.date }}\\n\\n記帳網址:\\nmoze3://expense?amount={{ $json.price }}&account=信用卡&subcategory=外送&store={{ $json.shop }}&date={{ $json.date }}\",\n        \"select\": \"channel\",\n        \"blocksUi\": \"={\\n\\t\\\"blocks\\\": [\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"section\\\",\\n\\t\\t\\t\\\"text\\\": {\\n\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\\"text\\\": \\\"Ubereat 訂餐資訊:\\\\n\\\\n*商家:* {{ $json.shop }}\\\\n*金額:* {{ $json.price }}\\\\n*日期:* {{ $json.date }}\\\"\\n\\t\\t\\t}\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"divider\\\"\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"section\\\",\\n\\t\\t\\t\\\"text\\\": {\\n\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\\"text\\\": \\\"Moze 記帳請點我\\\"\\n\\t\\t\\t},\\n\\t\\t\\t\\\"accessory\\\": {\\n\\t\\t\\t\\t\\\"type\\\": \\\"button\\\",\\n\\t\\t\\t\\t\\\"text\\\": {\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"plain_text\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"記帳\\\",\\n\\t\\t\\t\\t\\t\\\"emoji\\\": true\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\\"value\\\": \\\"click\\\",\\n\\t\\t\\t\\t\\\"url\\\": \\\"moze3://expense?amount={{ $json.price }}&account=信用卡&subcategory=外送&store={{ $json.shop }}&date={{ $json.date }}&&project=生活開銷&&time={{ $json.time }}\\\",\\n\\t\\t\\t\\t\\\"action_id\\\": \\\"button-action\\\"\\n\\t\\t\\t}\\n\\t\\t}\\n\\t]\\n}\",\n        \"channelId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"C0883CJM1UH\",\n          \"cachedResultName\": \"外送記帳自動化\"\n        },\n        \"messageType\": \"block\",\n        \"otherOptions\": {},\n        \"authentication\": \"oAuth2\"\n      },\n      \"credentials\": {\n        \"slackOAuth2Api\": {\n          \"id\": \"sD1J9ZLyEhcglrRa\",\n          \"name\": \"Slack account\"\n        }\n      },\n      \"typeVersion\": 2.3\n    }\n  ],\n  \"active\": true,\n  \"pinData\": {},\n  \"settings\": {\n    \"executionOrder\": \"v1\"\n  },\n  \"versionId\": \"0840254c-0058-47fe-9b22-7fbb93144788\",\n  \"connections\": {\n    \"Loop Over Items\": {\n      \"main\": [\n        [],\n        [\n          {\n            \"node\": \"Extract Price, Shop, Date, TIme\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Click to Test Flow\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get emails from Gmail with certain subject\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Send to Slack with Block\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Loop Over Items\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Extract Price, Shop, Date, TIme\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Send to Slack with Block\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Receive certain keyword Gmail Trigger\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Loop Over Items\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get emails from Gmail with certain subject\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Loop Over Items\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}