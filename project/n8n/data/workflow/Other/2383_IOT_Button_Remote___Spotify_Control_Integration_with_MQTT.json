{
  "title": "IOT Button Remote / Spotify Control Integration with MQTT",
  "url": "https://n8n.io/workflows/2383-iot-button-remote-spotify-control-integration-with-mqtt/",
  "category": "Other",
  "category_url": "https://n8n.io/workflows/categories/other/?sort=createdAt:desc",
  "author": "Hubschrauber",
  "publish_date": "Last update 8 months ago",
  "publish_date_absolute": "2024-09-23",
  "content": "",
  "workflow_json": "{\"nodes\":[{\"id\":\"169e3a8c-82f5-4527-a187-27b8e5d903c1\",\"name\":\"Spotify Next\",\"type\":\"n8n-nodes-base.spotify\",\"position\":[1300,-40],\"parameters\":{\"operation\":\"nextSong\"},\"credentials\":{\"spotifyOAuth2Api\":{\"id\":\"4AquI6TQMHILfmvx\",\"name\":\"Spotify App Credentials\"}},\"typeVersion\":1},{\"id\":\"7840d6b8-7eb4-4ac2-8bd0-946561f7de38\",\"name\":\"Spotify Resume\",\"type\":\"n8n-nodes-base.spotify\",\"position\":[1300,660],\"parameters\":{\"operation\":\"resume\"},\"credentials\":{\"spotifyOAuth2Api\":{\"id\":\"4AquI6TQMHILfmvx\",\"name\":\"Spotify App Credentials\"}},\"typeVersion\":1},{\"id\":\"35e768a3-b648-4d5e-a6a4-fa5f5be3d922\",\"name\":\"Spotify Pause\",\"type\":\"n8n-nodes-base.spotify\",\"position\":[1300,480],\"parameters\":{\"operation\":\"pause\"},\"credentials\":{\"spotifyOAuth2Api\":{\"id\":\"4AquI6TQMHILfmvx\",\"name\":\"Spotify App Credentials\"}},\"typeVersion\":1},{\"id\":\"0a391400-a8f0-4c1e-ac79-bbdea4aa21b4\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-361,55],\"parameters\":{\"width\":611.1911357340722,\"height\":291.1542012927053,\"content\":\"### Receive MQTT message from IKEA 5-button Switch, and route actions.\"},\"typeVersion\":1},{\"id\":\"164e904f-278d-4e48-81de-e1fc050e683a\",\"name\":\"Spotify API - Volume up 5pct\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[1300,120],\"parameters\":{\"url\":\"https://api.spotify.com/v1/me/player/volume\",\"method\":\"PUT\",\"options\":{},\"sendQuery\":true,\"authentication\":\"predefinedCredentialType\",\"queryParameters\":{\"parameters\":[{\"name\":\"=device_id\",\"value\":\"={{ $json.device.id }}\"},{\"name\":\"volume_percent\",\"value\":\"={{ Math.min($json.device.volume_percent + 5, 100) }}\"}]},\"nodeCredentialType\":\"spotifyOAuth2Api\"},\"credentials\":{\"spotifyOAuth2Api\":{\"id\":\"4AquI6TQMHILfmvx\",\"name\":\"Spotify App Credentials\"}},\"typeVersion\":4.1,\"alwaysOutputData\":true},{\"id\":\"a75cfc9b-ba21-4771-a2ff-f7aee843f344\",\"name\":\"Spotify API - Volume down 5pct\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[1300,300],\"parameters\":{\"url\":\"https://api.spotify.com/v1/me/player/volume\",\"method\":\"PUT\",\"options\":{},\"sendQuery\":true,\"authentication\":\"predefinedCredentialType\",\"queryParameters\":{\"parameters\":[{\"name\":\"device_id\",\"value\":\"={{ $json.device.id }}\"},{\"name\":\"volume_percent\",\"value\":\"={{ Math.max($json.device.volume_percent - 5, 20) }}\"}]},\"nodeCredentialType\":\"spotifyOAuth2Api\"},\"credentials\":{\"spotifyOAuth2Api\":{\"id\":\"4AquI6TQMHILfmvx\",\"name\":\"Spotify App Credentials\"}},\"typeVersion\":4.1,\"alwaysOutputData\":true},{\"id\":\"deae216d-aaaa-406c-b978-45b790c5d837\",\"name\":\"Sticky Note8\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-360,608.2274931489221],\"parameters\":{\"color\":5,\"width\":906.3175117167951,\"height\":278.70214810442735,\"content\":\"### Find the target player device (or spotify device group) by name, and activate it.\"},\"typeVersion\":1},{\"id\":\"2733fd1e-4c58-4f3e-bf7d-f4111fea6efc\",\"name\":\"Spotify API - Get Available Devices\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[-260,680],\"parameters\":{\"url\":\"https://api.spotify.com/v1/me/player/devices\",\"options\":{},\"sendQuery\":true,\"authentication\":\"predefinedCredentialType\",\"queryParameters\":{\"parameters\":[{}]},\"nodeCredentialType\":\"spotifyOAuth2Api\"},\"credentials\":{\"spotifyOAuth2Api\":{\"id\":\"4AquI6TQMHILfmvx\",\"name\":\"Spotify App Credentials\"}},\"typeVersion\":4.1,\"alwaysOutputData\":true},{\"id\":\"1d7fcab5-e49d-4d03-8e7d-aa339afa45ec\",\"name\":\"Extract Individual Devices\",\"type\":\"n8n-nodes-base.splitOut\",\"position\":[-60,680],\"parameters\":{\"options\":{},\"fieldToSplitOut\":\"devices\"},\"typeVersion\":1},{\"id\":\"7ae0af1c-2fbb-47e4-b2ab-670be441d86f\",\"name\":\"Select Device by Name to get device_id\",\"type\":\"n8n-nodes-base.filter\",\"position\":[140,680],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"069d11c8-75a2-4a5c-81c4-e6f771ee4829\",\"operator\":{\"name\":\"filter.operator.equals\",\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $json.name }}\",\"rightValue\":\"={{ $('Globals').first().json.target_spotify_playback_device_name }}\"}]}},\"typeVersion\":2},{\"id\":\"738d57fd-9dcb-4d3d-b070-73867c926d3f\",\"name\":\"Custom Function 1 - P1\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[880,840],\"parameters\":{\"url\":\"https://api.spotify.com/v1/me/player/volume\",\"method\":\"PUT\",\"options\":{},\"sendQuery\":true,\"authentication\":\"predefinedCredentialType\",\"queryParameters\":{\"parameters\":[{\"name\":\"volume_percent\",\"value\":\"80\"}]},\"nodeCredentialType\":\"spotifyOAuth2Api\"},\"credentials\":{\"spotifyOAuth2Api\":{\"id\":\"4AquI6TQMHILfmvx\",\"name\":\"Spotify App Credentials\"}},\"typeVersion\":4.1,\"alwaysOutputData\":true},{\"id\":\"e3fc6784-1612-427d-9b78-a3f4050ed176\",\"name\":\"Custom Function 2 - P2\",\"type\":\"n8n-nodes-base.spotify\",\"position\":[1080,840],\"parameters\":{\"id\":\"spotify:track:4PTG3Z6ehGkBFwjybzWkR8\"},\"credentials\":{\"spotifyOAuth2Api\":{\"id\":\"4AquI6TQMHILfmvx\",\"name\":\"Spotify App Credentials\"}},\"typeVersion\":1},{\"id\":\"340f23ff-ae8a-4032-a641-30bc32af09c7\",\"name\":\"Custom Function 1 - P3\",\"type\":\"n8n-nodes-base.spotify\",\"position\":[1300,840],\"parameters\":{\"operation\":\"nextSong\"},\"credentials\":{\"spotifyOAuth2Api\":{\"id\":\"4AquI6TQMHILfmvx\",\"name\":\"Spotify App Credentials\"}},\"typeVersion\":1},{\"id\":\"30a413da-5ce3-44a9-a43e-c6679b712087\",\"name\":\"Spotify API - Activate Target Playback Device\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[360,680],\"parameters\":{\"url\":\"https://api.spotify.com/v1/me/player\",\"method\":\"PUT\",\"options\":{},\"jsonBody\":\"={\\n  \\\"device_ids\\\": [\\n    \\\"{{ $('Select Device by Name to get device_id').first().json.id }}\\\"\\n  ],\\n  \\\"play\\\": true\\n}\",\"sendBody\":true,\"sendQuery\":true,\"specifyBody\":\"json\",\"authentication\":\"predefinedCredentialType\",\"queryParameters\":{\"parameters\":[{}]},\"nodeCredentialType\":\"spotifyOAuth2Api\"},\"credentials\":{\"spotifyOAuth2Api\":{\"id\":\"4AquI6TQMHILfmvx\",\"name\":\"Spotify App Credentials\"}},\"typeVersion\":4.1,\"alwaysOutputData\":true},{\"id\":\"91dd48fe-6c3c-4170-8392-3d9885e61047\",\"name\":\"Route to Requested Function\",\"type\":\"n8n-nodes-base.switch\",\"position\":[900,420],\"parameters\":{\"rules\":{\"values\":[{\"outputKey\":\"=volume_up\",\"conditions\":{\"options\":{\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"operator\":{\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $('MQTT Trigger - Ikea Remote Switch').first().json.message }}\",\"rightValue\":\"brightness_up_click\"}]},\"renameOutput\":true},{\"outputKey\":\"volume_down\",\"conditions\":{\"options\":{\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"c0726ee0-31b2-48fd-a860-0b923d8c18e7\",\"operator\":{\"name\":\"filter.operator.equals\",\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $('MQTT Trigger - Ikea Remote Switch').first().json.message }}\",\"rightValue\":\"brightness_down_click\"}]},\"renameOutput\":true},{\"outputKey\":\"play/pause\",\"conditions\":{\"options\":{\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"569014d8-0db4-4126-a0dd-7264a3b6db51\",\"operator\":{\"name\":\"filter.operator.equals\",\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $('MQTT Trigger - Ikea Remote Switch').first().json.message }}\",\"rightValue\":\"toggle\"}]},\"renameOutput\":true},{\"outputKey\":\"custom_function_1\",\"conditions\":{\"options\":{\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"af6d07f3-0ac2-4c05-8535-26d618892b8b\",\"operator\":{\"name\":\"filter.operator.equals\",\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $('MQTT Trigger - Ikea Remote Switch').first().json.message }}\",\"rightValue\":\"brightness_up_hold\"}]},\"renameOutput\":true},{\"outputKey\":\"custom_function_2\",\"conditions\":{\"options\":{\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"a5e8ce30-4b18-450a-8b15-342a698fec61\",\"operator\":{\"name\":\"filter.operator.equals\",\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $('MQTT Trigger - Ikea Remote Switch').first().json.message }}\",\"rightValue\":\"brightness_down_hold\"}]},\"renameOutput\":true}]},\"options\":{\"fallbackOutput\":\"extra\"}},\"typeVersion\":3},{\"id\":\"4a9ddd4d-ae2d-43c8-b3fd-70a2b15c5743\",\"name\":\"Custom Function 2 - P1\",\"type\":\"n8n-nodes-base.spotify\",\"position\":[840,1020],\"parameters\":{\"resource\":\"playlist\",\"operation\":\"getUserPlaylists\",\"returnAll\":true},\"credentials\":{\"spotifyOAuth2Api\":{\"id\":\"4AquI6TQMHILfmvx\",\"name\":\"Spotify App Credentials\"}},\"typeVersion\":1},{\"id\":\"29f842ad-f7cb-47b5-81fe-349f193e54bb\",\"name\":\"Filter\",\"type\":\"n8n-nodes-base.filter\",\"position\":[1040,1020],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"f7b6844a-ad78-4f29-801b-cef817a42e94\",\"operator\":{\"name\":\"filter.operator.equals\",\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $json.name }}\",\"rightValue\":\"={{ $('Globals').first().json.favorite_playlist_name }}\"}]}},\"typeVersion\":2},{\"id\":\"cb038583-e930-4fee-9166-fa182d20868e\",\"name\":\"Globals\",\"type\":\"n8n-nodes-base.set\",\"position\":[-100,160],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"2124b4d2-f929-459d-b285-3ac18df3ab60\",\"name\":\"target_spotify_playback_device_name\",\"type\":\"string\",\"value\":\"My Smart-Speaker Playback Device\"},{\"id\":\"b7f0468d-c5c3-4424-8db8-af823a10c7f0\",\"name\":\"favorite_playlist_name\",\"type\":\"string\",\"value\":\"Discover Weekly\"}]}},\"typeVersion\":3.4},{\"id\":\"f4505b9a-6f04-4ff7-9384-05bae95b2fc8\",\"name\":\"Custom Function 2 - P3\",\"type\":\"n8n-nodes-base.spotify\",\"position\":[1260,1020],\"parameters\":{\"id\":\"=spotify:playlist:{{ $json.id }}\",\"operation\":\"startMusic\"},\"credentials\":{\"spotifyOAuth2Api\":{\"id\":\"4AquI6TQMHILfmvx\",\"name\":\"Spotify App Credentials\"}},\"typeVersion\":1},{\"id\":\"2b2a81f9-69b6-42ca-accc-d4d987d6823c\",\"name\":\"Oops. How was this reached?\",\"type\":\"n8n-nodes-base.noOp\",\"position\":[1080,680],\"parameters\":{},\"typeVersion\":1},{\"id\":\"e45f04d6-bb3c-4580-9ef4-307d3692ad29\",\"name\":\"Spotify API - Get Device Status\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[440,260],\"parameters\":{\"url\":\"https://api.spotify.com/v1/me/player\",\"options\":{},\"sendQuery\":true,\"authentication\":\"predefinedCredentialType\",\"queryParameters\":{\"parameters\":[{\"name\":\"device_id\",\"value\":\"={{ $('Globals').first().json.target_spotify_playback_device_id }}\"}]},\"nodeCredentialType\":\"spotifyOAuth2Api\"},\"credentials\":{\"spotifyOAuth2Api\":{\"id\":\"4AquI6TQMHILfmvx\",\"name\":\"Spotify App Credentials\"}},\"typeVersion\":4.1,\"alwaysOutputData\":true},{\"id\":\"ffa38f10-f9b4-4a52-954e-39adcd924633\",\"name\":\"Already playing on Target Device?\",\"type\":\"n8n-nodes-base.if\",\"position\":[640,300],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"92d0f5fc-0743-4ea7-aad3-c8b72481bb97\",\"operator\":{\"name\":\"filter.operator.equals\",\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $('Spotify API - Get Device Status').first().json.device.name }}\",\"rightValue\":\"={{ $('Globals').first().json.target_spotify_playback_device_name }}\"}]}},\"typeVersion\":2},{\"id\":\"f92ed1ea-c9a7-4818-9a8e-a5fa460177ea\",\"name\":\"Is Playing?\",\"type\":\"n8n-nodes-base.if\",\"position\":[1140,520],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"caa4edf5-6436-4416-92f7-febd63cd47c5\",\"operator\":{\"type\":\"boolean\",\"operation\":\"true\",\"singleValue\":true},\"leftValue\":\"={{ $('Spotify API - Get Device Status').first().json.is_playing && !$('Spotify API - Activate Target Playback Device').isExecuted }}\",\"rightValue\":\"\"}]}},\"typeVersion\":2},{\"id\":\"5580215d-0f20-4349-a7c2-b74f0e01080e\",\"name\":\"Spotify Prev\",\"type\":\"n8n-nodes-base.spotify\",\"position\":[1300,-200],\"parameters\":{\"operation\":\"previousSong\"},\"credentials\":{\"spotifyOAuth2Api\":{\"id\":\"4AquI6TQMHILfmvx\",\"name\":\"Spotify App Credentials\"}},\"typeVersion\":1},{\"id\":\"f3babdeb-86d4-4dc6-85a4-95c48f4f07ef\",\"name\":\"MQTT Trigger - Remote Switch\",\"type\":\"n8n-nodes-base.mqttTrigger\",\"position\":[-280,160],\"parameters\":{\"topics\":\"zigbee2mqtt/MyIOTButton1234/action\",\"options\":{\"jsonParseBody\":true}},\"credentials\":{\"mqtt\":{\"id\":\"65ppR4lt7hVNzfVG\",\"name\":\"MQTT account\"}},\"typeVersion\":1},{\"id\":\"0c1bd86f-49f7-4505-9c8a-047dcb10a1bd\",\"name\":\"Remote Action -> Function Router\",\"type\":\"n8n-nodes-base.switch\",\"position\":[100,140],\"parameters\":{\"rules\":{\"rules\":[{\"value2\":\"arrow_left_click\",\"outputKey\":\"left\"},{\"value2\":\"arrow_right_click\",\"outputKey\":\"right\"},{\"value2\":\"brightness_up_click\",\"outputKey\":\"up\"},{\"value2\":\"brightness_down_click\",\"outputKey\":\"down\"},{\"value2\":\"toggle\",\"outputKey\":\"on_off\"},{\"value2\":\"brightness_up_hold\",\"outputKey\":\"custom_function_1\"},{\"value2\":\"brightness_down_hold\",\"outputKey\":\"custom_function_2\"}]},\"value1\":\"={{ $('MQTT Trigger - Ikea Remote Switch').first().json.message }}\",\"dataType\":\"string\"},\"typeVersion\":2}],\"pinData\":{},\"connections\":{\"Filter\":{\"main\":[[{\"node\":\"Custom Function 2 - P3\",\"type\":\"main\",\"index\":0}]]},\"Globals\":{\"main\":[[{\"node\":\"Remote Action -> Function Router\",\"type\":\"main\",\"index\":0}]]},\"Is Playing?\":{\"main\":[[{\"node\":\"Spotify Pause\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Spotify Resume\",\"type\":\"main\",\"index\":0}]]},\"Custom Function 1 - P1\":{\"main\":[[{\"node\":\"Custom Function 2 - P2\",\"type\":\"main\",\"index\":0}]]},\"Custom Function 2 - P1\":{\"main\":[[{\"node\":\"Filter\",\"type\":\"main\",\"index\":0}]]},\"Custom Function 2 - P2\":{\"main\":[[{\"node\":\"Custom Function 1 - P3\",\"type\":\"main\",\"index\":0}]]},\"Extract Individual Devices\":{\"main\":[[{\"node\":\"Select Device by Name to get device_id\",\"type\":\"main\",\"index\":0}]]},\"Route to Requested Function\":{\"main\":[[{\"node\":\"Spotify API - Volume up 5pct\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Spotify API - Volume down 5pct\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Is Playing?\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Custom Function 1 - P1\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Custom Function 2 - P1\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Oops. How was this reached?\",\"type\":\"main\",\"index\":0}]]},\"Spotify API - Get Device Status\":{\"main\":[[{\"node\":\"Already playing on Target Device?\",\"type\":\"main\",\"index\":0}]]},\"Remote Action -> Function Router\":{\"main\":[[{\"node\":\"Spotify Prev\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Spotify Next\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Spotify API - Get Device Status\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Spotify API - Get Device Status\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Spotify API - Get Device Status\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Spotify API - Get Device Status\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Spotify API - Get Device Status\",\"type\":\"main\",\"index\":0}]]},\"Already playing on Target Device?\":{\"main\":[[{\"node\":\"Route to Requested Function\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Spotify API - Get Available Devices\",\"type\":\"main\",\"index\":0}]]},\"MQTT Trigger - Ikea Remote Switch\":{\"main\":[[{\"node\":\"Globals\",\"type\":\"main\",\"index\":0}]]},\"Spotify API - Get Available Devices\":{\"main\":[[{\"node\":\"Extract Individual Devices\",\"type\":\"main\",\"index\":0}]]},\"Select Device by Name to get device_id\":{\"main\":[[{\"node\":\"Spotify API - Activate Target Playback Device\",\"type\":\"main\",\"index\":0}]]},\"Spotify API - Activate Target Playback Device\":{\"main\":[[{\"node\":\"Route to Requested Function\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "## Overview\n\nThis template integrates an IOT multi-button switch (meant for controlling a dimmable light) with Spotify playback functions, via MQTT messages. This isn't likely to work without some tinkering, but should be a good head start on receiving/routing IOT/MQTT messages and hooking up to a Spotify-like API.\n\n## Requirements\n\n  * An IOT device capable of generating events that can be delivered as MQTT messages through an MQTT Broker \n    * e.g. [Ikea Strybar remote](https://www.ikea.com/us/en/p/styrbar-remote-control-smart-white-80488370/)\n  * An MQTT Broker to which n8n can connect and consume messages \n    * e.g. Zigbee2MQTT in HomeAssistant\n  * A Spotify **developer-account** (which provides access to API functions via OAuth2 authorization)\n  * A Spotify **user-account** (which provides access to Spotify streamed content, user settings, etc.)\n\n\n\n## Setup\n\n  1. Create an MQTT Credential item in n8n and assign it to the MQTT Trigger node\n  2. Modify the MQTT trigger node to match the topic for your IOT device messages\n  3. Modify the switch/router nodes to map to the message text from your IOT button (e.g. arrow_left_click, brightness_up_click, etc.)\n  4. Create a Spotify **developer-account** (or use the login for a **user-account**)\n  5. Create an \"App\" in the **developer-account** to represent the n8n workflow \n     * Chicken/Egg ALERT: The n8n Spotify Credentials dialog box will display the \"OAuth Redirect URL\" required to create the App in Spotify, but the n8n Credential item itself cannot be created until AFTER the App has been created.\n  6. Create a Spotify Credentials item in n8n \n     * Open the Settings on the Spotify App to find the required Client ID and Client Secret information.\n     * ALERT: Save this before proceeding to the Connect step.\n  7. Connect the n8n Spotify Credential item to the Spotify **user-account**\n     * ALERT: Expect n8n to open a separate OAuth2 window on [authorization.spotify.com](http://authorization.spotify.com) here, which may require a login to the Spotify **user-account**\n  8. Open each of the HTTP and Spotify nodes, one by one, and re-assign to **your** Spotify Credential (try not to miss any). \n     * (Then, probably, upvote this feature request: <https://community.n8n.io/t/select-credentials-via-expression/5150>\n  9. Modify the variable values in the Globals node to match your own environment. \n     * target_spotify_playback_device_name - The name of a playback device available to the Spotify user-account\n     * favorite_playlist_name - The name of a playlist to start when one of the button actions is indicated in the MQTT message. Used in example \"Custom Function 2\" sequence.\n\n\n\n## Notes\n\n  * You're on your own for getting the multi-button remote switch talking to MQTT, figuring out what the exact MQTT topic name is, and mapping the message parts to the workflow (actions, etc.).\n  * The next / previous actions are wired up to **not** transfer control to the target device. This alternative routing just illustrates a different behavior than the remaining actions/functions, which include activation of the target device when required.\n  * Some of the Spotify API interactions use the Spotify node in n8n, but many of the available Spotify API functions are limited or not implemented at all in the Spotify node. So, in other cases, a regular HTTP node is used with the Spotify OAuth2 API credential instead. By modifying one of the examples included in the template, it should be possible to call nearly anything the Spotify API has to offer.\n\n\n\n## Spotify+n8n OAuth Mini-Tutorial\n\n### Definitions\n\n  * The **developer-account** is the Spotify login for creating a **spotify-app** which will be associated with a **client id** and **client secret**.\n  * The **user-account** is the Spotify login that has permission to stream songs, set up playback devices, etc.\n  * ++A **spotify-login** allows access to a Spotify **user-account** , _or_ a Spotify **developer-account** , **_OR BOTH_** ++\n  * The **spotify-app** , which has a **client id** and **client secret** , is an object created in the **developer-account**.\n  * The **app-implementation** (in this case, an ++n8n workflow++) uses the **spotify-app's** credentials (client id / client secret) to call Spotify API endpoints **on behalf of** a **user-account**.\n\n\n\n### Using One Spotify Login as Both User and Developer\n\nWhen an n8n _Spotify-node_ or _HTTP-node_ (i.e. an **app-implementation**) calls a Spotify API endpoint, the Credentials item **may** be using the **client id and client secret** from a **spotify-app** , which was created in a **developer-account** that is ++**one and the same _spotify-login_** as the **user-account** ++. However, it helps to remind yourself that from the Spotify API server's perspective, the **developer-account + spotify-app** , and the **user-account** , are ++**two independent entities** ++.\n\n### n8n Spotify-OAuth2-API Credential Authorization Process\n\nThe **2** layers/steps, in the process of authorizing an n8n Spotify-OAuth2-API credential to make API calls, are:\n\n  1. n8n must identify itself to Spotify as the **app-implementation** associated with the **developer-account/spotify-app** by sending the app's credentials (client id and client secret) to Spotify. \n     * The Client ID and Client Secret are supplied in the n8n Spotify OAuth2 Credentials UI/dialog-box\n  2. Separately, n8n must obtain an authorization token from Spotify to represent the **permissions granted by the user** to execute actions (call API endpoints) **on behalf of** the user (i.e. access things that belong to the **user-account**). \n     * This authorization for the **user-account** access is obtained when the \"Connect\" or \"Reconnect\" button is clicked in the n8n Spotify Credentials UI/dialog-box (which pops up a separate authorization UI/browser-window managed by Spotify).\n     * The Authorization for a given **spotify-app** stays \"registered\" in the **user-account** until revoked. \n       * See: <https://support.spotify.com/us/article/spotify-on-other-apps/>\n       * Direct Link: <https://www.spotify.com/account/apps/>\n     * More than one **user-account** _can_ be authorized for a given **spotify-app**. A particular n8n Spotify-OAuth2-API credential item appears to cache an authorization token for the **user-account** that was **_most recently_** authorized. \n       * Up to 25 users can be allowed access to a **spotify-app** in Developer-Mode, but any **user-account** other than the one associated with the **developer-account** must be added by email address at **[https://developer.spotify.com/dashboard/**_{{app-credential-id}](https://developer.spotify.com/dashboard/**_%7B%7Bapp-credential-id%7D)}_**/users**\n     * **ALERT:** IF the browser running the n8n UI is ALSO logged into a Spotify account, and the **spotify-app** is already authorized for that Spotify account, the \"reconnect\" button in the Spotify-OAuth2-API credential dialog may automatically grab a token for that logged in **user-account** , offering no opportunity to select a different **user-account**. \n       * This can be managed somewhat by using \"incognito\" browser windows for n8n, Spotify, or both.\n\n\n\n### References\n\n  * [n8n Spotify Credentials Docs](https://docs.n8n.io/integrations/builtin/credentials/spotify/)\n  * [Spotify Authorization Docs](https://developer.spotify.com/documentation/web-api/concepts/authorization)\n\n\n",
  "readme_html": "<!--[--><div data-v-50766329=\"\"><h2>Overview</h2>\n<p>This template integrates an IOT multi-button switch (meant for controlling a dimmable light) with Spotify playback functions, via MQTT messages.  This isn't likely to work without some tinkering, but should be a good head start on receiving/routing IOT/MQTT messages and hooking up to a Spotify-like API.</p>\n<h2>Requirements</h2>\n<ul>\n<li>An IOT device capable of generating events that can be delivered as MQTT messages through an MQTT Broker\n<ul>\n<li>e.g. <a href=\"https://www.ikea.com/us/en/p/styrbar-remote-control-smart-white-80488370/\" rel=\"ugc nofollow\" target=\"_blank\">Ikea Strybar remote</a></li>\n</ul>\n</li>\n<li>An MQTT Broker to which n8n can connect and consume messages\n<ul>\n<li>e.g. Zigbee2MQTT in HomeAssistant</li>\n</ul>\n</li>\n<li>A Spotify <strong>developer-account</strong> (which provides access to API functions via OAuth2 authorization)</li>\n<li>A Spotify <strong>user-account</strong> (which provides access to Spotify streamed content, user settings, etc.)</li>\n</ul>\n<h2>Setup</h2>\n<ol>\n<li>Create an MQTT Credential item in n8n and assign it to the MQTT Trigger node</li>\n<li>Modify the MQTT trigger node to match the topic for your IOT device messages</li>\n<li>Modify the switch/router nodes to map to the message text from your IOT button (e.g. arrow_left_click, brightness_up_click, etc.)</li>\n<li>Create a Spotify <strong>developer-account</strong> (or use the login for a <strong>user-account</strong>)</li>\n<li>Create an \"App\" in the <strong>developer-account</strong> to represent the n8n workflow\n<ul>\n<li>Chicken/Egg ALERT: The n8n Spotify Credentials dialog box will display the \"OAuth Redirect URL\" required to create the App in Spotify, but the n8n Credential item itself cannot be created until AFTER the App has been created.</li>\n</ul>\n</li>\n<li>Create a Spotify Credentials item in n8n\n<ul>\n<li>Open the Settings on the Spotify App to find the required Client ID and Client Secret information.</li>\n<li>ALERT: Save this before proceeding to the Connect step.</li>\n</ul>\n</li>\n<li>Connect the n8n Spotify Credential item to the Spotify <strong>user-account</strong>\n<ul>\n<li>ALERT: Expect n8n to open a separate OAuth2 window on <a href=\"http://authorization.spotify.com\" rel=\"ugc nofollow\" target=\"_blank\">authorization.spotify.com</a> here, which may require a login to the Spotify <strong>user-account</strong></li>\n</ul>\n</li>\n<li>Open each of the HTTP and Spotify nodes, one by one, and re-assign to <strong>your</strong> Spotify Credential (try not to miss any).\n<ul>\n<li>(Then, probably, upvote this feature request: <a href=\"https://community.n8n.io/t/select-credentials-via-expression/5150\" rel=\"ugc nofollow\" target=\"_blank\">https://community.n8n.io/t/select-credentials-via-expression/5150</a></li>\n</ul>\n</li>\n<li>Modify the variable values in the Globals node to match your own environment.\n<ul>\n<li>target_spotify_playback_device_name - The name of a playback device available to the Spotify user-account</li>\n<li>favorite_playlist_name - The name of a playlist to start when one of the button actions is indicated in the MQTT message.  Used in example \"Custom Function 2\" sequence.</li>\n</ul>\n</li>\n</ol>\n<h2>Notes</h2>\n<ul>\n<li>You're on your own for getting the multi-button remote switch talking to MQTT, figuring out what the exact MQTT topic name is, and mapping the message parts to the workflow (actions, etc.).</li>\n<li>The next / previous actions are wired up to <strong>not</strong> transfer control to the target device. This alternative routing just illustrates a different behavior than the remaining actions/functions, which include activation of the target device when required.</li>\n<li>Some of the Spotify API interactions use the Spotify node in n8n, but many of the available Spotify API functions are limited or not implemented at all in the Spotify node.  So, in other cases, a regular HTTP node is used with the Spotify OAuth2 API credential instead.  By modifying one of the examples included in the template, it should be possible to call nearly anything the Spotify API has to offer.</li>\n</ul>\n<h2>Spotify+n8n OAuth Mini-Tutorial</h2>\n<h3>Definitions</h3>\n<ul>\n<li>The <strong>developer-account</strong> is the Spotify login for creating a <strong>spotify-app</strong> which will be associated with a <strong>client id</strong> and <strong>client secret</strong>.</li>\n<li>The <strong>user-account</strong> is the Spotify login that has permission to stream songs, set up playback devices, etc.</li>\n<li>++A <strong>spotify-login</strong> allows access to a Spotify <strong>user-account</strong>, <em>or</em> a Spotify <strong>developer-account</strong>, <strong><em>OR BOTH</em></strong>++</li>\n<li>The <strong>spotify-app</strong>, which has a <strong>client id</strong> and <strong>client secret</strong>, is an object created in the <strong>developer-account</strong>.</li>\n<li>The <strong>app-implementation</strong> (in this case, an ++n8n workflow++) uses the <strong>spotify-app's</strong> credentials (client id / client secret) to call Spotify API endpoints <strong>on behalf of</strong> a <strong>user-account</strong>.</li>\n</ul>\n<h3>Using One Spotify Login as Both User and Developer</h3>\n<p>When an n8n <em>Spotify-node</em> or <em>HTTP-node</em> (i.e. an <strong>app-implementation</strong>) calls a Spotify API endpoint, the Credentials item <strong>may</strong> be using the <strong>client id and client secret</strong> from a <strong>spotify-app</strong>, which was created in a <strong>developer-account</strong> that is ++<strong>one and the same <em>spotify-login</em></strong> as the <strong>user-account</strong>++.  However, it helps to remind yourself that from the Spotify API server's perspective, the <strong>developer-account + spotify-app</strong>, and the <strong>user-account</strong>, are ++<strong>two independent entities</strong>++.</p>\n<h3>n8n Spotify-OAuth2-API Credential Authorization Process</h3>\n<p>The <strong>2</strong> layers/steps, in the process of authorizing an n8n Spotify-OAuth2-API credential to make API calls, are:</p>\n<ol>\n<li>n8n must identify itself to Spotify as the <strong>app-implementation</strong> associated with the <strong>developer-account/spotify-app</strong> by sending the app's credentials (client id and client secret) to Spotify.\n<ul>\n<li>The Client ID and Client Secret are supplied in the n8n Spotify OAuth2 Credentials UI/dialog-box</li>\n</ul>\n</li>\n<li>Separately, n8n must obtain an authorization token from Spotify to represent the <strong>permissions granted by the user</strong> to execute actions (call API endpoints) <strong>on behalf of</strong> the user (i.e. access things that belong to the <strong>user-account</strong>).\n<ul>\n<li>This authorization for the <strong>user-account</strong> access is obtained when the \"Connect\" or \"Reconnect\" button is clicked in the n8n Spotify Credentials UI/dialog-box (which pops up a separate authorization UI/browser-window managed by Spotify).</li>\n<li>The Authorization for a given <strong>spotify-app</strong> stays \"registered\" in the <strong>user-account</strong> until revoked.\n<ul>\n<li>See: <a href=\"https://support.spotify.com/us/article/spotify-on-other-apps/\" rel=\"ugc nofollow\" target=\"_blank\">https://support.spotify.com/us/article/spotify-on-other-apps/</a></li>\n<li>Direct Link: <a href=\"https://www.spotify.com/account/apps/\" rel=\"ugc nofollow\" target=\"_blank\">https://www.spotify.com/account/apps/</a></li>\n</ul>\n</li>\n<li>More than one <strong>user-account</strong> <em>can</em> be authorized for a given <strong>spotify-app</strong>. A particular n8n Spotify-OAuth2-API credential item appears to cache an authorization token for the <strong>user-account</strong> that was <strong><em>most recently</em></strong> authorized.\n<ul>\n<li>Up to 25 users can be allowed access to a <strong>spotify-app</strong> in Developer-Mode, but any <strong>user-account</strong> other than the one associated with the <strong>developer-account</strong> must be added by email address at <strong><a href=\"https://developer.spotify.com/dashboard/**_%7B%7Bapp-credential-id%7D\" rel=\"ugc nofollow\" target=\"_blank\">https://developer.spotify.com/dashboard/**_{{app-credential-id}</a>}_</strong>/users**</li>\n</ul>\n</li>\n<li><strong>ALERT:</strong> IF the browser running the n8n UI is ALSO logged into a Spotify account, and the <strong>spotify-app</strong> is already authorized for that Spotify account, the \"reconnect\" button in the Spotify-OAuth2-API credential dialog may automatically grab a token for that logged in <strong>user-account</strong>, offering no opportunity to select a different <strong>user-account</strong>.\n<ul>\n<li>This can be managed somewhat by using \"incognito\" browser windows for n8n, Spotify, or both.</li>\n</ul>\n</li>\n</ul>\n</li>\n</ol>\n<h3>References</h3>\n<ul>\n<li><a href=\"https://docs.n8n.io/integrations/builtin/credentials/spotify/\" rel=\"ugc nofollow\" target=\"_blank\">n8n Spotify Credentials Docs</a></li>\n<li><a href=\"https://developer.spotify.com/documentation/web-api/concepts/authorization\" rel=\"ugc nofollow\" target=\"_blank\">Spotify Authorization Docs</a></li>\n</ul>\n</div><!--]-->",
  "readme_zh": "## 概述\n\n本模板通过MQTT消息将物联网多键开关（用于控制可调光灯具）与Spotify播放功能集成。虽需调试才能正常运行，但为接收/路由物联网MQTT消息及对接Spotify类API提供了良好起点。\n\n## 需求条件\n\n* 能生成可通过MQTT代理传递消息的物联网设备  \n  * 例如[宜家Styrbar遥控器](https://www.ikea.com/us/en/p/styrbar-remote-control-smart-white-80488370/)\n* n8n可连接并消费消息的MQTT代理  \n  * 例如HomeAssistant中的Zigbee2MQTT\n* Spotify**开发者账号**（通过OAuth2授权访问API功能）\n* Spotify**用户账号**（访问流媒体内容、用户设置等）\n\n## 配置步骤\n\n1. 在n8n创建MQTT凭证项并分配给MQTT触发器节点\n2. 修改MQTT触发器节点以匹配物联网设备消息主题\n3. 调整路由节点以映射物联网按钮消息文本（如arrow_left_click、brightness_up_click等）\n4. 创建Spotify**开发者账号**（或使用**用户账号**登录）\n5. 在**开发者账号**中创建代表n8n工作流的\"应用\"  \n   * 注意：n8n Spotify凭证对话框会显示创建应用所需的\"OAuth重定向URL\"，但该凭证项需在应用创建后才能建立\n6. 在n8n创建Spotify凭证项  \n   * 通过Spotify应用设置获取客户端ID和密钥\n   * 重要：保存后再进行连接步骤\n7. 将n8n Spotify凭证项连接到**用户账号**  \n   * 注意：n8n会弹出[authorization.spotify.com](http://authorization.spotify.com)的OAuth2授权窗口，可能需要登录**用户账号**\n8. 逐个打开HTTP和Spotify节点重新分配凭证  \n   * （建议支持此功能请求：<https://community.n8n.io/t/select-credentials-via-expression/5150>）\n9. 修改全局节点变量以匹配您的环境  \n   * target_spotify_playback_device_name - 用户账号可用的播放设备名称\n   * favorite_playlist_name - 按钮触发时启动的播放列表名称（用于\"自定义函数2\"示例）\n\n## 注意事项\n\n* 需自行实现多键遥控开关与MQTT的通信，确定准确MQTT主题名称并将消息映射到工作流\n* 上一曲/下一曲动作设置为**不**转移控制权，此特殊路由用于展示与其他动作的差异\n* 部分Spotify API交互使用n8n原生节点，但许多功能未实现，此时需改用HTTP节点配合OAuth2凭证。通过修改模板示例，可调用绝大多数Spotify API功能\n\n## Spotify+n8n OAuth迷你教程\n\n### 术语定义\n\n* **开发者账号**：用于创建关联**客户端ID/密钥**的Spotify应用\n* **用户账号**：具有歌曲流媒体、播放设备管理等权限的登录账号\n* ++**Spotify登录**可同时访问**用户账号**和**开发者账号**++\n* **Spotify应用**：在开发者账号中创建，包含客户端凭证\n* **应用实现**（此处为++n8n工作流++）使用应用凭证代表**用户账号**调用API\n\n### 单账号双重身份场景\n\n当n8n节点调用API时，所用凭证可能来自与**用户账号**同属一个++登录账号++的**开发者账号应用**。但需注意：从API服务器视角，**开发者账号+应用**与**用户账号**是++两个独立实体++。\n\n### 授权流程详解\n\nn8n Spotify OAuth2 API凭证授权包含**两个**层级：\n\n1. n8n通过**应用凭证**向Spotify验证开发者身份  \n   * 在凭证对话框输入客户端ID和密钥\n2. 单独获取代表**用户授权**的访问令牌  \n   * 点击\"连接\"按钮时弹出Spotify授权窗口完成\n   * 用户授权状态持续有效直至手动撤销  \n     * 管理地址：<https://www.spotify.com/account/apps/>\n   * 单个应用最多可授权25个用户账号（需在[开发者面板](https://developer.spotify.com/dashboard/**_%7B%7Bapp-credential-id%7D}_**/users)添加邮箱）\n   * 重要：若浏览器已登录Spotify账号且已授权应用，n8n可能自动获取该账号令牌。可使用无痕模式规避\n\n### 参考文档\n\n* [n8n Spotify凭证文档](https://docs.n8n.io/integrations/builtin/credentials/spotify/)\n* [Spotify授权机制说明](https://developer.spotify.com/documentation/web-api/concepts/authorization)",
  "title_zh": "物联网按钮遥控器 / 通过MQTT实现Spotify控制集成",
  "publish_date_zh": "最后更新于8个月前",
  "workflow_json_zh": "{\n  \"nodes\": [\n    {\n      \"id\": \"169e3a8c-82f5-4527-a187-27b8e5d903c1\",\n      \"name\": \"Spotify Next\",\n      \"type\": \"n8n-nodes-base.spotify\",\n      \"position\": [\n        1300,\n        -40\n      ],\n      \"parameters\": {\n        \"operation\": \"nextSong\"\n      },\n      \"credentials\": {\n        \"spotifyOAuth2Api\": {\n          \"id\": \"4AquI6TQMHILfmvx\",\n          \"name\": \"Spotify App Credentials\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"7840d6b8-7eb4-4ac2-8bd0-946561f7de38\",\n      \"name\": \"Spotify Resume\",\n      \"type\": \"n8n-nodes-base.spotify\",\n      \"position\": [\n        1300,\n        660\n      ],\n      \"parameters\": {\n        \"operation\": \"resume\"\n      },\n      \"credentials\": {\n        \"spotifyOAuth2Api\": {\n          \"id\": \"4AquI6TQMHILfmvx\",\n          \"name\": \"Spotify App Credentials\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"35e768a3-b648-4d5e-a6a4-fa5f5be3d922\",\n      \"name\": \"Spotify Pause\",\n      \"type\": \"n8n-nodes-base.spotify\",\n      \"position\": [\n        1300,\n        480\n      ],\n      \"parameters\": {\n        \"operation\": \"pause\"\n      },\n      \"credentials\": {\n        \"spotifyOAuth2Api\": {\n          \"id\": \"4AquI6TQMHILfmvx\",\n          \"name\": \"Spotify App Credentials\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"0a391400-a8f0-4c1e-ac79-bbdea4aa21b4\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -361,\n        55\n      ],\n      \"parameters\": {\n        \"width\": 611.1911357340722,\n        \"height\": 291.1542012927053,\n        \"content\": \"### 接收来自宜家五键开关的MQTT消息，并路由操作\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"164e904f-278d-4e48-81de-e1fc050e683a\",\n      \"name\": \"Spotify API - Volume up 5pct\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1300,\n        120\n      ],\n      \"parameters\": {\n        \"url\": \"https://api.spotify.com/v1/me/player/volume\",\n        \"method\": \"PUT\",\n        \"options\": {},\n        \"sendQuery\": true,\n        \"authentication\": \"predefinedCredentialType\",\n        \"queryParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"=device_id\",\n              \"value\": \"={{ $json.device.id }}\"\n            },\n            {\n              \"name\": \"volume_percent\",\n              \"value\": \"={{ Math.min($json.device.volume_percent + 5, 100) }}\"\n            }\n          ]\n        },\n        \"nodeCredentialType\": \"spotifyOAuth2Api\"\n      },\n      \"credentials\": {\n        \"spotifyOAuth2Api\": {\n          \"id\": \"4AquI6TQMHILfmvx\",\n          \"name\": \"Spotify App Credentials\"\n        }\n      },\n      \"typeVersion\": 4.1,\n      \"alwaysOutputData\": true\n    },\n    {\n      \"id\": \"a75cfc9b-ba21-4771-a2ff-f7aee843f344\",\n      \"name\": \"Spotify API - Volume down 5pct\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1300,\n        300\n      ],\n      \"parameters\": {\n        \"url\": \"https://api.spotify.com/v1/me/player/volume\",\n        \"method\": \"PUT\",\n        \"options\": {},\n        \"sendQuery\": true,\n        \"authentication\": \"predefinedCredentialType\",\n        \"queryParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"device_id\",\n              \"value\": \"={{ $json.device.id }}\"\n            },\n            {\n              \"name\": \"volume_percent\",\n              \"value\": \"={{ Math.max($json.device.volume_percent - 5, 20) }}\"\n            }\n          ]\n        },\n        \"nodeCredentialType\": \"spotifyOAuth2Api\"\n      },\n      \"credentials\": {\n        \"spotifyOAuth2Api\": {\n          \"id\": \"4AquI6TQMHILfmvx\",\n          \"name\": \"Spotify App Credentials\"\n        }\n      },\n      \"typeVersion\": 4.1,\n      \"alwaysOutputData\": true\n    },\n    {\n      \"id\": \"deae216d-aaaa-406c-b978-45b790c5d837\",\n      \"name\": \"Sticky Note8\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -360,\n        608.2274931489221\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 906.3175117167951,\n        \"height\": 278.70214810442735,\n        \"content\": \"### 根据名称查找目标播放设备（或Spotify设备组），并将其激活。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"2733fd1e-4c58-4f3e-bf7d-f4111fea6efc\",\n      \"name\": \"Spotify API - Get Available Devices\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        -260,\n        680\n      ],\n      \"parameters\": {\n        \"url\": \"https://api.spotify.com/v1/me/player/devices\",\n        \"options\": {},\n        \"sendQuery\": true,\n        \"authentication\": \"predefinedCredentialType\",\n        \"queryParameters\": {\n          \"parameters\": [\n            {}\n          ]\n        },\n        \"nodeCredentialType\": \"spotifyOAuth2Api\"\n      },\n      \"credentials\": {\n        \"spotifyOAuth2Api\": {\n          \"id\": \"4AquI6TQMHILfmvx\",\n          \"name\": \"Spotify App Credentials\"\n        }\n      },\n      \"typeVersion\": 4.1,\n      \"alwaysOutputData\": true\n    },\n    {\n      \"id\": \"1d7fcab5-e49d-4d03-8e7d-aa339afa45ec\",\n      \"name\": \"Extract Individual Devices\",\n      \"type\": \"n8n-nodes-base.splitOut\",\n      \"position\": [\n        -60,\n        680\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"fieldToSplitOut\": \"devices\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"7ae0af1c-2fbb-47e4-b2ab-670be441d86f\",\n      \"name\": \"Select Device by Name to get device_id\",\n      \"type\": \"n8n-nodes-base.filter\",\n      \"position\": [\n        140,\n        680\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"069d11c8-75a2-4a5c-81c4-e6f771ee4829\",\n              \"operator\": {\n                \"name\": \"filter.operator.equals\",\n                \"type\": \"string\",\n                \"operation\": \"equals\"\n              },\n              \"leftValue\": \"={{ $json.name }}\",\n              \"rightValue\": \"={{ $('Globals').first().json.target_spotify_playback_device_name }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"738d57fd-9dcb-4d3d-b070-73867c926d3f\",\n      \"name\": \"Custom Function 1 - P1\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        880,\n        840\n      ],\n      \"parameters\": {\n        \"url\": \"https://api.spotify.com/v1/me/player/volume\",\n        \"method\": \"PUT\",\n        \"options\": {},\n        \"sendQuery\": true,\n        \"authentication\": \"predefinedCredentialType\",\n        \"queryParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"volume_percent\",\n              \"value\": \"80\"\n            }\n          ]\n        },\n        \"nodeCredentialType\": \"spotifyOAuth2Api\"\n      },\n      \"credentials\": {\n        \"spotifyOAuth2Api\": {\n          \"id\": \"4AquI6TQMHILfmvx\",\n          \"name\": \"Spotify App Credentials\"\n        }\n      },\n      \"typeVersion\": 4.1,\n      \"alwaysOutputData\": true\n    },\n    {\n      \"id\": \"e3fc6784-1612-427d-9b78-a3f4050ed176\",\n      \"name\": \"Custom Function 2 - P2\",\n      \"type\": \"n8n-nodes-base.spotify\",\n      \"position\": [\n        1080,\n        840\n      ],\n      \"parameters\": {\n        \"id\": \"spotify:track:4PTG3Z6ehGkBFwjybzWkR8\"\n      },\n      \"credentials\": {\n        \"spotifyOAuth2Api\": {\n          \"id\": \"4AquI6TQMHILfmvx\",\n          \"name\": \"Spotify App Credentials\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"340f23ff-ae8a-4032-a641-30bc32af09c7\",\n      \"name\": \"Custom Function 1 - P3\",\n      \"type\": \"n8n-nodes-base.spotify\",\n      \"position\": [\n        1300,\n        840\n      ],\n      \"parameters\": {\n        \"operation\": \"nextSong\"\n      },\n      \"credentials\": {\n        \"spotifyOAuth2Api\": {\n          \"id\": \"4AquI6TQMHILfmvx\",\n          \"name\": \"Spotify App Credentials\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"30a413da-5ce3-44a9-a43e-c6679b712087\",\n      \"name\": \"Spotify API - Activate Target Playback Device\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        360,\n        680\n      ],\n      \"parameters\": {\n        \"url\": \"https://api.spotify.com/v1/me/player\",\n        \"method\": \"PUT\",\n        \"options\": {},\n        \"jsonBody\": \"={\\n  \\\"device_ids\\\": [\\n    \\\"{{ $('Select Device by Name to get device_id').first().json.id }}\\\"\\n  ],\\n  \\\"play\\\": true\\n}\",\n        \"sendBody\": true,\n        \"sendQuery\": true,\n        \"specifyBody\": \"json\",\n        \"authentication\": \"predefinedCredentialType\",\n        \"queryParameters\": {\n          \"parameters\": [\n            {}\n          ]\n        },\n        \"nodeCredentialType\": \"spotifyOAuth2Api\"\n      },\n      \"credentials\": {\n        \"spotifyOAuth2Api\": {\n          \"id\": \"4AquI6TQMHILfmvx\",\n          \"name\": \"Spotify App Credentials\"\n        }\n      },\n      \"typeVersion\": 4.1,\n      \"alwaysOutputData\": true\n    },\n    {\n      \"id\": \"91dd48fe-6c3c-4170-8392-3d9885e61047\",\n      \"name\": \"Route to Requested Function\",\n      \"type\": \"n8n-nodes-base.switch\",\n      \"position\": [\n        900,\n        420\n      ],\n      \"parameters\": {\n        \"rules\": {\n          \"values\": [\n            {\n              \"outputKey\": \"=volume_up\",\n              \"conditions\": {\n                \"options\": {\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"operator\": {\n                      \"type\": \"string\",\n                      \"operation\": \"equals\"\n                    },\n                    \"leftValue\": \"={{ $('MQTT Trigger - Ikea Remote Switch').first().json.message }}\",\n                    \"rightValue\": \"brightness_up_click\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            },\n            {\n              \"outputKey\": \"volume_down\",\n              \"conditions\": {\n                \"options\": {\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"c0726ee0-31b2-48fd-a860-0b923d8c18e7\",\n                    \"operator\": {\n                      \"name\": \"filter.operator.equals\",\n                      \"type\": \"string\",\n                      \"operation\": \"equals\"\n                    },\n                    \"leftValue\": \"={{ $('MQTT Trigger - Ikea Remote Switch').first().json.message }}\",\n                    \"rightValue\": \"brightness_down_click\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            },\n            {\n              \"outputKey\": \"play/pause\",\n              \"conditions\": {\n                \"options\": {\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"569014d8-0db4-4126-a0dd-7264a3b6db51\",\n                    \"operator\": {\n                      \"name\": \"filter.operator.equals\",\n                      \"type\": \"string\",\n                      \"operation\": \"equals\"\n                    },\n                    \"leftValue\": \"={{ $('MQTT Trigger - Ikea Remote Switch').first().json.message }}\",\n                    \"rightValue\": \"toggle\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            },\n            {\n              \"outputKey\": \"custom_function_1\",\n              \"conditions\": {\n                \"options\": {\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"af6d07f3-0ac2-4c05-8535-26d618892b8b\",\n                    \"operator\": {\n                      \"name\": \"filter.operator.equals\",\n                      \"type\": \"string\",\n                      \"operation\": \"equals\"\n                    },\n                    \"leftValue\": \"={{ $('MQTT Trigger - Ikea Remote Switch').first().json.message }}\",\n                    \"rightValue\": \"brightness_up_hold\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            },\n            {\n              \"outputKey\": \"custom_function_2\",\n              \"conditions\": {\n                \"options\": {\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"a5e8ce30-4b18-450a-8b15-342a698fec61\",\n                    \"operator\": {\n                      \"name\": \"filter.operator.equals\",\n                      \"type\": \"string\",\n                      \"operation\": \"equals\"\n                    },\n                    \"leftValue\": \"={{ $('MQTT Trigger - Ikea Remote Switch').first().json.message }}\",\n                    \"rightValue\": \"brightness_down_hold\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            }\n          ]\n        },\n        \"options\": {\n          \"fallbackOutput\": \"extra\"\n        }\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"4a9ddd4d-ae2d-43c8-b3fd-70a2b15c5743\",\n      \"name\": \"Custom Function 2 - P1\",\n      \"type\": \"n8n-nodes-base.spotify\",\n      \"position\": [\n        840,\n        1020\n      ],\n      \"parameters\": {\n        \"resource\": \"playlist\",\n        \"operation\": \"getUserPlaylists\",\n        \"returnAll\": true\n      },\n      \"credentials\": {\n        \"spotifyOAuth2Api\": {\n          \"id\": \"4AquI6TQMHILfmvx\",\n          \"name\": \"Spotify App Credentials\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"29f842ad-f7cb-47b5-81fe-349f193e54bb\",\n      \"name\": \"Filter\",\n      \"type\": \"n8n-nodes-base.filter\",\n      \"position\": [\n        1040,\n        1020\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"f7b6844a-ad78-4f29-801b-cef817a42e94\",\n              \"operator\": {\n                \"name\": \"filter.operator.equals\",\n                \"type\": \"string\",\n                \"operation\": \"equals\"\n              },\n              \"leftValue\": \"={{ $json.name }}\",\n              \"rightValue\": \"={{ $('Globals').first().json.favorite_playlist_name }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"cb038583-e930-4fee-9166-fa182d20868e\",\n      \"name\": \"Globals\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        -100,\n        160\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"2124b4d2-f929-459d-b285-3ac18df3ab60\",\n              \"name\": \"target_spotify_playback_device_name\",\n              \"type\": \"string\",\n              \"value\": \"My Smart-Speaker Playback Device\"\n            },\n            {\n              \"id\": \"b7f0468d-c5c3-4424-8db8-af823a10c7f0\",\n              \"name\": \"favorite_playlist_name\",\n              \"type\": \"string\",\n              \"value\": \"Discover Weekly\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"f4505b9a-6f04-4ff7-9384-05bae95b2fc8\",\n      \"name\": \"Custom Function 2 - P3\",\n      \"type\": \"n8n-nodes-base.spotify\",\n      \"position\": [\n        1260,\n        1020\n      ],\n      \"parameters\": {\n        \"id\": \"=spotify:playlist:{{ $json.id }}\",\n        \"operation\": \"startMusic\"\n      },\n      \"credentials\": {\n        \"spotifyOAuth2Api\": {\n          \"id\": \"4AquI6TQMHILfmvx\",\n          \"name\": \"Spotify App Credentials\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"2b2a81f9-69b6-42ca-accc-d4d987d6823c\",\n      \"name\": \"Oops. How was this reached?\",\n      \"type\": \"n8n-nodes-base.noOp\",\n      \"position\": [\n        1080,\n        680\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"e45f04d6-bb3c-4580-9ef4-307d3692ad29\",\n      \"name\": \"Spotify API - Get Device Status\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        440,\n        260\n      ],\n      \"parameters\": {\n        \"url\": \"https://api.spotify.com/v1/me/player\",\n        \"options\": {},\n        \"sendQuery\": true,\n        \"authentication\": \"predefinedCredentialType\",\n        \"queryParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"device_id\",\n              \"value\": \"={{ $('Globals').first().json.target_spotify_playback_device_id }}\"\n            }\n          ]\n        },\n        \"nodeCredentialType\": \"spotifyOAuth2Api\"\n      },\n      \"credentials\": {\n        \"spotifyOAuth2Api\": {\n          \"id\": \"4AquI6TQMHILfmvx\",\n          \"name\": \"Spotify App Credentials\"\n        }\n      },\n      \"typeVersion\": 4.1,\n      \"alwaysOutputData\": true\n    },\n    {\n      \"id\": \"ffa38f10-f9b4-4a52-954e-39adcd924633\",\n      \"name\": \"Already playing on Target Device?\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        640,\n        300\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"92d0f5fc-0743-4ea7-aad3-c8b72481bb97\",\n              \"operator\": {\n                \"name\": \"filter.operator.equals\",\n                \"type\": \"string\",\n                \"operation\": \"equals\"\n              },\n              \"leftValue\": \"={{ $('Spotify API - Get Device Status').first().json.device.name }}\",\n              \"rightValue\": \"={{ $('Globals').first().json.target_spotify_playback_device_name }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"f92ed1ea-c9a7-4818-9a8e-a5fa460177ea\",\n      \"name\": \"Is Playing?\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        1140,\n        520\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"caa4edf5-6436-4416-92f7-febd63cd47c5\",\n              \"operator\": {\n                \"type\": \"boolean\",\n                \"operation\": \"true\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $('Spotify API - Get Device Status').first().json.is_playing && !$('Spotify API - Activate Target Playback Device').isExecuted }}\",\n              \"rightValue\": \"\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"5580215d-0f20-4349-a7c2-b74f0e01080e\",\n      \"name\": \"Spotify Prev\",\n      \"type\": \"n8n-nodes-base.spotify\",\n      \"position\": [\n        1300,\n        -200\n      ],\n      \"parameters\": {\n        \"operation\": \"previousSong\"\n      },\n      \"credentials\": {\n        \"spotifyOAuth2Api\": {\n          \"id\": \"4AquI6TQMHILfmvx\",\n          \"name\": \"Spotify App Credentials\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"f3babdeb-86d4-4dc6-85a4-95c48f4f07ef\",\n      \"name\": \"MQTT Trigger - Remote Switch\",\n      \"type\": \"n8n-nodes-base.mqttTrigger\",\n      \"position\": [\n        -280,\n        160\n      ],\n      \"parameters\": {\n        \"topics\": \"zigbee2mqtt/MyIOTButton1234/action\",\n        \"options\": {\n          \"jsonParseBody\": true\n        }\n      },\n      \"credentials\": {\n        \"mqtt\": {\n          \"id\": \"65ppR4lt7hVNzfVG\",\n          \"name\": \"MQTT account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"0c1bd86f-49f7-4505-9c8a-047dcb10a1bd\",\n      \"name\": \"Remote Action -> Function Router\",\n      \"type\": \"n8n-nodes-base.switch\",\n      \"position\": [\n        100,\n        140\n      ],\n      \"parameters\": {\n        \"rules\": {\n          \"rules\": [\n            {\n              \"value2\": \"arrow_left_click\",\n              \"outputKey\": \"left\"\n            },\n            {\n              \"value2\": \"arrow_right_click\",\n              \"outputKey\": \"right\"\n            },\n            {\n              \"value2\": \"brightness_up_click\",\n              \"outputKey\": \"up\"\n            },\n            {\n              \"value2\": \"brightness_down_click\",\n              \"outputKey\": \"down\"\n            },\n            {\n              \"value2\": \"toggle\",\n              \"outputKey\": \"on_off\"\n            },\n            {\n              \"value2\": \"brightness_up_hold\",\n              \"outputKey\": \"custom_function_1\"\n            },\n            {\n              \"value2\": \"brightness_down_hold\",\n              \"outputKey\": \"custom_function_2\"\n            }\n          ]\n        },\n        \"value1\": \"={{ $('MQTT Trigger - Ikea Remote Switch').first().json.message }}\",\n        \"dataType\": \"string\"\n      },\n      \"typeVersion\": 2\n    }\n  ],\n  \"pinData\": {},\n  \"connections\": {\n    \"Filter\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Custom Function 2 - P3\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Globals\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Remote Action -> Function Router\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Is Playing?\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Spotify Pause\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Spotify Resume\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Custom Function 1 - P1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Custom Function 2 - P2\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Custom Function 2 - P1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Filter\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Custom Function 2 - P2\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Custom Function 1 - P3\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Extract Individual Devices\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Select Device by Name to get device_id\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Route to Requested Function\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Spotify API - Volume up 5pct\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Spotify API - Volume down 5pct\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Is Playing?\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Custom Function 1 - P1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Custom Function 2 - P1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Oops. How was this reached?\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Spotify API - Get Device Status\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Already playing on Target Device?\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Remote Action -> Function Router\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Spotify Prev\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Spotify Next\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Spotify API - Get Device Status\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Spotify API - Get Device Status\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Spotify API - Get Device Status\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Spotify API - Get Device Status\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Spotify API - Get Device Status\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Already playing on Target Device?\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Route to Requested Function\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Spotify API - Get Available Devices\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"MQTT Trigger - Ikea Remote Switch\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Globals\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Spotify API - Get Available Devices\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Extract Individual Devices\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Select Device by Name to get device_id\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Spotify API - Activate Target Playback Device\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Spotify API - Activate Target Playback Device\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Route to Requested Function\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}