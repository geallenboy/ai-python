{
  "title": "Sync Shopify customers to Google Sheets + Squarespace compatible csv",
  "url": "https://n8n.io/workflows/3280-sync-shopify-customers-to-google-sheets-squarespace-compatible-csv/",
  "category": "Other",
  "category_url": "https://n8n.io/workflows/categories/other/?sort=createdAt:desc",
  "author": "bangank36",
  "publish_date": "Last update a month ago",
  "publish_date_absolute": "",
  "content": "",
  "workflow_json": "{\"meta\":{\"instanceId\":\"e634e668fe1fc93a75c4f2a7fc0dad807ca318b79654157eadb9578496acbc76\",\"templateCredsSetupCompleted\":true},\"nodes\":[{\"id\":\"ff5634c3-349b-4181-a03a-97b310e5232b\",\"name\":\"When clicking ‘Test workflow’\",\"type\":\"n8n-nodes-base.manualTrigger\",\"position\":[120,60],\"parameters\":{},\"typeVersion\":1},{\"id\":\"66e204fb-3e00-45e0-b1b2-341836476b95\",\"name\":\"Extract page_info \",\"type\":\"n8n-nodes-base.code\",\"position\":[900,120],\"parameters\":{\"jsCode\":\"function parseNextParams(headerValue) {\\n    // Match the URL inside <>\\n    const urlMatch = headerValue.match(/<([^>]+)>;\\\\s*rel=\\\"next\\\"/);\\n    if (!urlMatch) return null;\\n\\n    const url = urlMatch[1]; // Extracted URL\\n    const paramsString = url.split(\\\"?\\\")[1]; // Get query string\\n\\n    if (!paramsString) return {}; // No params found\\n\\n    // Convert query string to object\\n    return paramsString.split(\\\"&\\\").reduce((acc, param) => {\\n        const [key, value] = param.split(\\\"=\\\");\\n        acc[decodeURIComponent(key)] = decodeURIComponent(value);\\n        return acc;\\n    }, {});\\n}\\n\\n/* Example usage\\n`<https://59b774-3.myshopify.com/admin/api/2025-01/orders.json?limit=250&fields=id%2Cnote%2Cemail%2Cprocessed_at%2Ccustomer&page_info=eyJzdGF0dXMiOiJhbnkiLCJsYXN0X2lkIjo2MzQ5MjI3MDAwMDk0LCJsYXN0X3ZhbHVlIjoiMjAyNC0xMi0zMSAwOToxMzowMi42MTcxNjYiLCJkaXJlY3Rpb24iOiJuZXh0In0>; rel=\\\"next\\\"`\\n*/\\nconst headerValue = $input.first().json.headers.link;\\nconst params = parseNextParams(headerValue);\\nreturn params;\"},\"typeVersion\":2},{\"id\":\"5b0086ce-f09b-4d55-86b6-9a14574506ab\",\"name\":\"Merge Loop items\",\"type\":\"n8n-nodes-base.code\",\"position\":[1120,-100],\"parameters\":{\"jsCode\":\"let results = [],\\n  i = 0;\\n\\ndo {\\n  try {\\n    results = results.concat($(\\\"Get Customers\\\").all(0, i));\\n  } catch (error) {\\n    return results;\\n  }\\n  i++;\\n} while (true);\"},\"typeVersion\":2},{\"id\":\"2302257c-51c0-42d7-8745-ecc0b4fc9faf\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[440,-160],\"parameters\":{\"width\":232,\"height\":346,\"content\":\"## Edit this node 👇\\n\\nGet your store URL and replace in the GET url: https://{your-store}.myshopify.com/admin/api/2025-01/customers.json\\n\"},\"typeVersion\":1},{\"id\":\"d857962a-6599-44b2-acb0-3eb8165e93ce\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1560,-440],\"parameters\":{\"width\":272,\"height\":506,\"content\":\"## Clone this spreadsheet\\n\\nhttps://docs.google.com/spreadsheets/d/1E8i98hwiFW7XG9HuxIZrOWfuLxGFaDm3EOAGQBZjhfk/edit?usp=sharing\\n\\nYour spreadsheet can have up to three columns, and need to be arranged in this order (no header):\\n\\nEmail address\\nFirst name (optional)\\nLast name (optional)\\nShopify Customer ID (will be ignored)\"},\"typeVersion\":1},{\"id\":\"be7cf143-893a-44f8-ace9-8ad581bddb68\",\"name\":\"Schedule Trigger\",\"type\":\"n8n-nodes-base.scheduleTrigger\",\"position\":[120,-120],\"parameters\":{\"rule\":{\"interval\":[{}]}},\"typeVersion\":1.2},{\"id\":\"58097363-29ec-4067-a439-717d355df91f\",\"name\":\"Assign page_info parameter\",\"type\":\"n8n-nodes-base.set\",\"position\":[1120,120],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"57e59bb7-ac20-4a1b-b54a-3468fc0519d3\",\"name\":\"page_info\",\"type\":\"string\",\"value\":\"={{ $json.page_info }}\"}]}},\"typeVersion\":3.4},{\"id\":\"0676abce-4405-42a1-87d3-ba75355fe264\",\"name\":\"Check page_info existence\",\"type\":\"n8n-nodes-base.if\",\"position\":[720,0],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"30d965c3-cbba-430e-81c2-ef8b543665e7\",\"operator\":{\"type\":\"string\",\"operation\":\"notContains\"},\"leftValue\":\"={{ $json.headers.link }}\",\"rightValue\":\"rel=\\\"next\\\"\"}]}},\"typeVersion\":2.2},{\"id\":\"1cc63979-b2f8-4678-b40b-f3f0ad63d377\",\"name\":\"Get Customers\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[500,0],\"parameters\":{\"url\":\"https://{your-store}.myshopify.com/admin/api/2025-01/customers.json\",\"options\":{\"response\":{\"response\":{\"fullResponse\":true}}},\"sendQuery\":true,\"authentication\":\"predefinedCredentialType\",\"queryParameters\":{\"parameters\":[{\"name\":\"limit\",\"value\":\"250\"},{\"name\":\"fields\",\"value\":\"id,email,first_name,last_name\"},{\"name\":\"={{ $json.page_info ? \\\"page_info\\\" : \\\"status\\\" }}\",\"value\":\"={{ $json.page_info ? $json.page_info : 'any' }}\"}]},\"nodeCredentialType\":\"shopifyAccessTokenApi\"},\"credentials\":{\"shopifyAccessTokenApi\":{\"id\":\"vtyKGPLLdjc7MLea\",\"name\":\"Shopify Access Token account\"}},\"typeVersion\":4.2},{\"id\":\"ce91af42-1634-4773-944a-2b24dcaf812b\",\"name\":\"List Customers\",\"type\":\"n8n-nodes-base.splitOut\",\"position\":[1380,-100],\"parameters\":{\"options\":{},\"fieldToSplitOut\":\"body.customers\"},\"typeVersion\":1},{\"id\":\"19a0f6a7-b86a-43bd-8504-62e3bd37af89\",\"name\":\"Customers Spreadsheet\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[1620,-100],\"parameters\":{\"columns\":{\"value\":{\"Last name\":\"={{ $json.last_name }}\",\"First name\":\"={{ $json.first_name }}\",\"Email address\":\"={{ $json.email }}\",\"Shopify Customer ID\":\"={{ $json.id }}\"},\"schema\":[{\"id\":\"Email address\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"Email address\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"First name\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"First name\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Last name\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"Last name\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Shopify Customer ID\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"Shopify Customer ID\",\"defaultMatch\":false,\"canBeUsedToMatch\":true}],\"mappingMode\":\"defineBelow\",\"matchingColumns\":[\"Shopify Customer ID\"],\"attemptToConvertTypes\":false,\"convertFieldsToString\":false},\"options\":{},\"operation\":\"appendOrUpdate\",\"sheetName\":{\"__rl\":true,\"mode\":\"list\",\"value\":1358690917,\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1yf_RYZGFHpMyOvD3RKGSvIFY2vumvI4474Qm_1t4-jM/edit#gid=1358690917\",\"cachedResultName\":\"sqs_contacts\"},\"documentId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"1yf_RYZGFHpMyOvD3RKGSvIFY2vumvI4474Qm_1t4-jM\",\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1yf_RYZGFHpMyOvD3RKGSvIFY2vumvI4474Qm_1t4-jM/edit?usp=drivesdk\",\"cachedResultName\":\"Squarespace automation\"}},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"JgI9maibw5DnBXRP\",\"name\":\"Google Sheets account\"}},\"typeVersion\":4.5},{\"id\":\"48ec5e3b-9bb5-451c-9495-b03080c9211e\",\"name\":\"Convert to Squarespace contacts csv\",\"type\":\"n8n-nodes-base.convertToFile\",\"position\":[1920,160],\"parameters\":{\"options\":{\"headerRow\":false}},\"typeVersion\":1.1},{\"id\":\"8de9174a-af87-4602-a9aa-a5c35a3f0ed4\",\"name\":\"Extract customers data\",\"type\":\"n8n-nodes-base.set\",\"position\":[1620,160],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"27c42d50-df07-46b4-b67a-13a1b64b5145\",\"name\":\"Email address\",\"type\":\"string\",\"value\":\"={{ $json['Email address'] }}\"},{\"id\":\"9fd2c3fd-9b03-4562-ad78-9ce30da7bb26\",\"name\":\"First name\",\"type\":\"string\",\"value\":\"={{ $json['First name'] }}\"},{\"id\":\"f51b7da6-0065-41ea-b04c-420058ce3b9c\",\"name\":\"Last name\",\"type\":\"string\",\"value\":\"={{ $json['Last name'] }}\"}]}},\"typeVersion\":3.4}],\"pinData\":{},\"connections\":{\"Get Customers\":{\"main\":[[{\"node\":\"Check page_info existence\",\"type\":\"main\",\"index\":0}]]},\"List Customers\":{\"main\":[[{\"node\":\"Customers Spreadsheet\",\"type\":\"main\",\"index\":0},{\"node\":\"Extract customers data\",\"type\":\"main\",\"index\":0}]]},\"Merge Loop items\":{\"main\":[[{\"node\":\"List Customers\",\"type\":\"main\",\"index\":0}]]},\"Schedule Trigger\":{\"main\":[[{\"node\":\"Get Customers\",\"type\":\"main\",\"index\":0}]]},\"Extract page_info \":{\"main\":[[{\"node\":\"Assign page_info parameter\",\"type\":\"main\",\"index\":0}]]},\"Customers Spreadsheet\":{\"main\":[[]]},\"Extract customers data\":{\"main\":[[{\"node\":\"Convert to Squarespace contacts csv\",\"type\":\"main\",\"index\":0}]]},\"Check page_info existence\":{\"main\":[[{\"node\":\"Merge Loop items\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Extract page_info \",\"type\":\"main\",\"index\":0}]]},\"Assign page_info parameter\":{\"main\":[[{\"node\":\"Get Customers\",\"type\":\"main\",\"index\":0}]]},\"When clicking ‘Test workflow’\":{\"main\":[[{\"node\":\"Get Customers\",\"type\":\"main\",\"index\":0}]]},\"Convert to Squarespace contacts csv\":{\"main\":[[]]}}}",
  "readme": "This workflow retrieves all Shopify Customers and saves them into a Google Sheets spreadsheet using the [Shopify Admin REST API](https://shopify.dev/docs/api/admin-rest/2025-01/resources/customer). It uses [pagination](https://shopify.dev/docs/api/admin-rest/usage/pagination) to ensure all customers are collected efficiently.\n\nN8n does not have built-in actions for Customers, so I built the workflow using an HTTP Request node.\n\n## How It Works\n\nThis workflow uses the HTTP Request node to fetch paginated chunks manually.\n\n  * Shopify uses cursor-based pagination (**page_info**) instead of traditional page numbers.\n  * Pagination data is stored in the response headers, so we need to enable `Include Response Headers and Status` in the HTTP Request node.\n  * The workflow processes customer data, saves it to Google Sheets, and formats a compatible CSV for Squarespace Contacts import.\n  * This workflow can be run on demand or scheduled to keep your data up to date.\n\n\n\n## Parameters\n\nYou can adjust these parameters in the HTTP Request node:\n\n  * **limit** – The number of customers per request (default: 50, max: 250).\n  * **fields** – Comma-separated list of fields to retrieve.\n  * **page_info** – Used for pagination; only limit and fields are allowed when paginating.\n\n\n\n📌 **Note:** When you query paginated chunks with `page_info`, only the `limit` and `fields` parameters are allowed.\n\n## Credentials\n\n  * **Shopify API Key** – Required for authentication.\n  * **Google Sheets API credentials** – Needed to insert data into the spreadsheet.\n\n\n\n## Google Sheets Template\n\n### Clone this spreadsheet:\n\n📎 [Google Sheets Template](https://docs.google.com/spreadsheets/d/1E8i98hwiFW7XG9HuxIZrOWfuLxGFaDm3EOAGQBZjhfk/edit?usp=sharing)\n\nAccording to [Squarespace documentation](https://support.squarespace.com/hc/en-us/articles/360001280708-Building-mailing-lists#h_01H95WGA8Y7F3D2AJ4K7J30CMY), your spreadsheet can have up to three columns and must be arranged in this order (no header):\n\n  1. **Email Address**\n  2. **First Name** (optional)\n  3. **Last Name** (optional)\n  4. **Shopify Customer ID** (this field will be ignored)\n\n\n\n## Exporting a Compatible CSV for Squarespace Contacts\n\nThis workflow also generates a CSV file that can be imported into Squarespace Contacts.\n\n### How to Import the CSV to Squarespace:\n\n  1. Open the **Lists & Segments** panel and click on your mailing list.\n  2. Click **Add Subscribers** , then select **Upload a list**.\n  3. Click **Add a CSV file** and select the file to import.\n  4. Toggle **These subscribers accept marketing** to confirm permission.\n  5. Preview your list, then click **Import**.\n\n\n\n## Who Is This For?\n\n  * **Shopify store owners** who need to export all customers to Google Sheets.\n  * **Anyone looking for a flexible and scalable** Shopify customers extraction solution.\n  * **Squarespace website owners** who want to bulk-create their Contacts using CSV.\n\n\n\n* * *\n\nExplore More Templates  \n👉 [Check out my other n8n templates](https://n8n.io/creators/bangank36/)\n",
  "readme_html": "<!--[--><div data-v-50766329=\"\"><p>This workflow retrieves all Shopify Customers and saves them into a Google Sheets spreadsheet using the <a href=\"https://shopify.dev/docs/api/admin-rest/2025-01/resources/customer\" rel=\"ugc nofollow\" target=\"_blank\">Shopify Admin REST API</a>. It uses <a href=\"https://shopify.dev/docs/api/admin-rest/usage/pagination\" rel=\"ugc nofollow\" target=\"_blank\">pagination</a> to ensure all customers are collected efficiently.</p>\n<p>N8n does not have built-in actions for Customers, so I built the workflow using an HTTP Request node.</p>\n<h2>How It Works</h2>\n<p>This workflow uses the HTTP Request node to fetch paginated chunks manually.</p>\n<ul>\n<li>Shopify uses cursor-based pagination (<strong>page_info</strong>) instead of traditional page numbers.</li>\n<li>Pagination data is stored in the response headers, so we need to enable <code>Include Response Headers and Status</code> in the HTTP Request node.</li>\n<li>The workflow processes customer data, saves it to Google Sheets, and formats a compatible CSV for Squarespace Contacts import.</li>\n<li>This workflow can be run on demand or scheduled to keep your data up to date.</li>\n</ul>\n<h2>Parameters</h2>\n<p>You can adjust these parameters in the HTTP Request node:</p>\n<ul>\n<li><strong>limit</strong> – The number of customers per request (default: 50, max: 250).</li>\n<li><strong>fields</strong> – Comma-separated list of fields to retrieve.</li>\n<li><strong>page_info</strong> – Used for pagination; only limit and fields are allowed when paginating.</li>\n</ul>\n<p>📌 <strong>Note:</strong> When you query paginated chunks with <code>page_info</code>, only the <code>limit</code> and <code>fields</code> parameters are allowed.</p>\n<h2>Credentials</h2>\n<ul>\n<li><strong>Shopify API Key</strong> – Required for authentication.</li>\n<li><strong>Google Sheets API credentials</strong> – Needed to insert data into the spreadsheet.</li>\n</ul>\n<h2>Google Sheets Template</h2>\n<h3>Clone this spreadsheet:</h3>\n<p>📎 <a href=\"https://docs.google.com/spreadsheets/d/1E8i98hwiFW7XG9HuxIZrOWfuLxGFaDm3EOAGQBZjhfk/edit?usp=sharing\" rel=\"ugc nofollow\" target=\"_blank\">Google Sheets Template</a></p>\n<p>According to <a href=\"https://support.squarespace.com/hc/en-us/articles/360001280708-Building-mailing-lists#h_01H95WGA8Y7F3D2AJ4K7J30CMY\" rel=\"ugc nofollow\" target=\"_blank\">Squarespace documentation</a>, your spreadsheet can have up to three columns and must be arranged in this order (no header):</p>\n<ol>\n<li><strong>Email Address</strong></li>\n<li><strong>First Name</strong> (optional)</li>\n<li><strong>Last Name</strong> (optional)</li>\n<li><strong>Shopify Customer ID</strong> (this field will be ignored)</li>\n</ol>\n<h2>Exporting a Compatible CSV for Squarespace Contacts</h2>\n<p>This workflow also generates a CSV file that can be imported into Squarespace Contacts.</p>\n<h3>How to Import the CSV to Squarespace:</h3>\n<ol>\n<li>Open the <strong>Lists &amp; Segments</strong> panel and click on your mailing list.</li>\n<li>Click <strong>Add Subscribers</strong>, then select <strong>Upload a list</strong>.</li>\n<li>Click <strong>Add a CSV file</strong> and select the file to import.</li>\n<li>Toggle <strong>These subscribers accept marketing</strong> to confirm permission.</li>\n<li>Preview your list, then click <strong>Import</strong>.</li>\n</ol>\n<h2>Who Is This For?</h2>\n<ul>\n<li><strong>Shopify store owners</strong> who need to export all customers to Google Sheets.</li>\n<li><strong>Anyone looking for a flexible and scalable</strong> Shopify customers extraction solution.</li>\n<li><strong>Squarespace website owners</strong> who want to bulk-create their Contacts using CSV.</li>\n</ul>\n<hr>\n<p>Explore More Templates<br>\n👉 <a href=\"https://n8n.io/creators/bangank36/\" rel=\"ugc nofollow\" target=\"_blank\">Check out my other n8n templates</a></p>\n</div><!--]-->",
  "readme_zh": "该工作流通过[Shopify Admin REST API](https://shopify.dev/docs/api/admin-rest/2025-01/resources/customer)获取所有Shopify客户数据，并将其保存至Google Sheets表格。采用[分页机制](https://shopify.dev/docs/api/admin-rest/usage/pagination)确保高效采集全部客户数据。\n\n由于n8n平台未内置客户数据操作模块，本工作流通过HTTP请求节点实现。\n\n## 实现原理\n\n通过HTTP请求节点手动获取分页数据：\n  * Shopify采用基于游标的分页机制（**page_info**），而非传统页码\n  * 分页数据存储于响应头，需在HTTP请求节点启用`包含响应头及状态`选项\n  * 工作流处理客户数据后，既保存至Google表格，又生成兼容Squarespace联系人导入的CSV文件\n  * 支持手动触发或定时执行以保持数据同步\n\n## 参数配置\n\nHTTP请求节点可调整以下参数：\n  * **limit** - 单次请求获取的客户数（默认50，上限250）\n  * **fields** - 需获取的字段列表（逗号分隔）\n  * **page_info** - 分页游标（使用分页时仅允许limit和fields参数）\n\n📌 **注意**：使用`page_info`进行分页查询时，仅允许搭配`limit`和`fields`参数。\n\n## 认证凭证\n  * **Shopify API密钥** - 身份验证必备\n  * **Google Sheets API凭证** - 表格数据写入所需\n\n## Google表格模板\n\n### 复制以下模板表格：\n📎 [Google表格模板](https://docs.google.com/spreadsheets/d/1E8i98hwiFW7XG9HuxIZrOWfuLxGFaDm3EOAGQBZjhfk/edit?usp=sharing)\n\n根据[Squarespace官方文档](https://support.squarespace.com/hc/en-us/articles/360001280708-Building-mailing-lists#h_01H95WGA8Y7F3D2AJ4K7J30CMY)，表格最多包含三列且必须按以下顺序排列（无表头）：\n  1. **电子邮箱**\n  2. **名字**（可选）\n  3. **姓氏**（可选）\n  4. **Shopify客户ID**（该字段将被忽略）\n\n## 生成Squarespace联系人兼容CSV\n\n本工作流同时生成可导入Squarespace联系人的CSV文件。\n\n### Squarespace导入步骤：\n  1. 打开**邮件列表与分组**面板，选择目标邮件列表\n  2. 点击**添加订阅者** → **上传列表**\n  3. 选择**添加CSV文件**并上传\n  4. 开启**这些订阅者接受营销**确认权限\n  5. 预览后点击**导入**\n\n## 适用场景\n  * 需将Shopify客户导出至Google表格的店主\n  * 需要灵活可扩展的Shopify客户数据提取方案\n  * 希望通过CSV批量创建Squarespace联系人的网站所有者\n\n* * *\n探索更多模板  \n👉 [查看其他n8n模板](https://n8n.io/creators/bangank36/)",
  "title_zh": "将Shopify客户同步至Google表格 + 兼容Squarespace的CSV文件",
  "publish_date_zh": "上次更新于一个月前",
  "workflow_json_zh": "{\n  \"meta\": {\n    \"instanceId\": \"e634e668fe1fc93a75c4f2a7fc0dad807ca318b79654157eadb9578496acbc76\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"nodes\": [\n    {\n      \"id\": \"ff5634c3-349b-4181-a03a-97b310e5232b\",\n      \"name\": \"When clicking ‘Test workflow’\",\n      \"type\": \"n8n-nodes-base.manualTrigger\",\n      \"position\": [\n        120,\n        60\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"66e204fb-3e00-45e0-b1b2-341836476b95\",\n      \"name\": \"Extract page_info \",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        900,\n        120\n      ],\n      \"parameters\": {\n        \"jsCode\": \"function parseNextParams(headerValue) {\\n    // Match the URL inside <>\\n    const urlMatch = headerValue.match(/<([^>]+)>;\\\\s*rel=\\\"next\\\"/);\\n    if (!urlMatch) return null;\\n\\n    const url = urlMatch[1]; // Extracted URL\\n    const paramsString = url.split(\\\"?\\\")[1]; // Get query string\\n\\n    if (!paramsString) return {}; // No params found\\n\\n    // Convert query string to object\\n    return paramsString.split(\\\"&\\\").reduce((acc, param) => {\\n        const [key, value] = param.split(\\\"=\\\");\\n        acc[decodeURIComponent(key)] = decodeURIComponent(value);\\n        return acc;\\n    }, {});\\n}\\n\\n/* Example usage\\n`<https://59b774-3.myshopify.com/admin/api/2025-01/orders.json?limit=250&fields=id%2Cnote%2Cemail%2Cprocessed_at%2Ccustomer&page_info=eyJzdGF0dXMiOiJhbnkiLCJsYXN0X2lkIjo2MzQ5MjI3MDAwMDk0LCJsYXN0X3ZhbHVlIjoiMjAyNC0xMi0zMSAwOToxMzowMi42MTcxNjYiLCJkaXJlY3Rpb24iOiJuZXh0In0>; rel=\\\"next\\\"`\\n*/\\nconst headerValue = $input.first().json.headers.link;\\nconst params = parseNextParams(headerValue);\\nreturn params;\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"5b0086ce-f09b-4d55-86b6-9a14574506ab\",\n      \"name\": \"Merge Loop items\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        1120,\n        -100\n      ],\n      \"parameters\": {\n        \"jsCode\": \"let results = [],\\n  i = 0;\\n\\ndo {\\n  try {\\n    results = results.concat($(\\\"Get Customers\\\").all(0, i));\\n  } catch (error) {\\n    return results;\\n  }\\n  i++;\\n} while (true);\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"2302257c-51c0-42d7-8745-ecc0b4fc9faf\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        440,\n        -160\n      ],\n      \"parameters\": {\n        \"width\": 232,\n        \"height\": 346,\n        \"content\": \"## 编辑此节点 👇\\n\\n获取您的商店URL并替换到GET请求的URL中：https://{您的商店}.myshopify.com/admin/api/2025-01/customers.json\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"d857962a-6599-44b2-acb0-3eb8165e93ce\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1560,\n        -440\n      ],\n      \"parameters\": {\n        \"width\": 272,\n        \"height\": 506,\n        \"content\": \"## 复制此电子表格\\n\\nhttps://docs.google.com/spreadsheets/d/1E8i98hwiFW7XG9HuxIZrOWfuLxGFaDm3EOAGQBZjhfk/edit?usp=sharing\\n\\n您的电子表格最多可包含三列，并按以下顺序排列（无需表头）：\\n\\n电子邮箱地址\\n名字（选填）\\n姓氏（选填）\\nShopify客户ID（将被忽略）\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"be7cf143-893a-44f8-ace9-8ad581bddb68\",\n      \"name\": \"Schedule Trigger\",\n      \"type\": \"n8n-nodes-base.scheduleTrigger\",\n      \"position\": [\n        120,\n        -120\n      ],\n      \"parameters\": {\n        \"rule\": {\n          \"interval\": [\n            {}\n          ]\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"58097363-29ec-4067-a439-717d355df91f\",\n      \"name\": \"Assign page_info parameter\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1120,\n        120\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"57e59bb7-ac20-4a1b-b54a-3468fc0519d3\",\n              \"name\": \"page_info\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.page_info }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"0676abce-4405-42a1-87d3-ba75355fe264\",\n      \"name\": \"Check page_info existence\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        720,\n        0\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"30d965c3-cbba-430e-81c2-ef8b543665e7\",\n              \"operator\": {\n                \"type\": \"string\",\n                \"operation\": \"notContains\"\n              },\n              \"leftValue\": \"={{ $json.headers.link }}\",\n              \"rightValue\": \"rel=\\\"next\\\"\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"1cc63979-b2f8-4678-b40b-f3f0ad63d377\",\n      \"name\": \"Get Customers\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        500,\n        0\n      ],\n      \"parameters\": {\n        \"url\": \"https://{your-store}.myshopify.com/admin/api/2025-01/customers.json\",\n        \"options\": {\n          \"response\": {\n            \"response\": {\n              \"fullResponse\": true\n            }\n          }\n        },\n        \"sendQuery\": true,\n        \"authentication\": \"predefinedCredentialType\",\n        \"queryParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"limit\",\n              \"value\": \"250\"\n            },\n            {\n              \"name\": \"fields\",\n              \"value\": \"id,email,first_name,last_name\"\n            },\n            {\n              \"name\": \"={{ $json.page_info ? \\\"page_info\\\" : \\\"status\\\" }}\",\n              \"value\": \"={{ $json.page_info ? $json.page_info : 'any' }}\"\n            }\n          ]\n        },\n        \"nodeCredentialType\": \"shopifyAccessTokenApi\"\n      },\n      \"credentials\": {\n        \"shopifyAccessTokenApi\": {\n          \"id\": \"vtyKGPLLdjc7MLea\",\n          \"name\": \"Shopify Access Token account\"\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"ce91af42-1634-4773-944a-2b24dcaf812b\",\n      \"name\": \"List Customers\",\n      \"type\": \"n8n-nodes-base.splitOut\",\n      \"position\": [\n        1380,\n        -100\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"fieldToSplitOut\": \"body.customers\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"19a0f6a7-b86a-43bd-8504-62e3bd37af89\",\n      \"name\": \"Customers Spreadsheet\",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"position\": [\n        1620,\n        -100\n      ],\n      \"parameters\": {\n        \"columns\": {\n          \"value\": {\n            \"Last name\": \"={{ $json.last_name }}\",\n            \"First name\": \"={{ $json.first_name }}\",\n            \"Email address\": \"={{ $json.email }}\",\n            \"Shopify Customer ID\": \"={{ $json.id }}\"\n          },\n          \"schema\": [\n            {\n              \"id\": \"Email address\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"Email address\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"First name\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"First name\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Last name\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"Last name\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Shopify Customer ID\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"Shopify Customer ID\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            }\n          ],\n          \"mappingMode\": \"defineBelow\",\n          \"matchingColumns\": [\n            \"Shopify Customer ID\"\n          ],\n          \"attemptToConvertTypes\": false,\n          \"convertFieldsToString\": false\n        },\n        \"options\": {},\n        \"operation\": \"appendOrUpdate\",\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": 1358690917,\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1yf_RYZGFHpMyOvD3RKGSvIFY2vumvI4474Qm_1t4-jM/edit#gid=1358690917\",\n          \"cachedResultName\": \"sqs_contacts\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"1yf_RYZGFHpMyOvD3RKGSvIFY2vumvI4474Qm_1t4-jM\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1yf_RYZGFHpMyOvD3RKGSvIFY2vumvI4474Qm_1t4-jM/edit?usp=drivesdk\",\n          \"cachedResultName\": \"Squarespace automation\"\n        }\n      },\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"JgI9maibw5DnBXRP\",\n          \"name\": \"Google Sheets account\"\n        }\n      },\n      \"typeVersion\": 4.5\n    },\n    {\n      \"id\": \"48ec5e3b-9bb5-451c-9495-b03080c9211e\",\n      \"name\": \"Convert to Squarespace contacts csv\",\n      \"type\": \"n8n-nodes-base.convertToFile\",\n      \"position\": [\n        1920,\n        160\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"headerRow\": false\n        }\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"8de9174a-af87-4602-a9aa-a5c35a3f0ed4\",\n      \"name\": \"Extract customers data\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1620,\n        160\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"27c42d50-df07-46b4-b67a-13a1b64b5145\",\n              \"name\": \"Email address\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json['Email address'] }}\"\n            },\n            {\n              \"id\": \"9fd2c3fd-9b03-4562-ad78-9ce30da7bb26\",\n              \"name\": \"First name\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json['First name'] }}\"\n            },\n            {\n              \"id\": \"f51b7da6-0065-41ea-b04c-420058ce3b9c\",\n              \"name\": \"Last name\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json['Last name'] }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    }\n  ],\n  \"pinData\": {},\n  \"connections\": {\n    \"Get Customers\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Check page_info existence\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"List Customers\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Customers Spreadsheet\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Extract customers data\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Merge Loop items\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"List Customers\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Schedule Trigger\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get Customers\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Extract page_info \": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Assign page_info parameter\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Customers Spreadsheet\": {\n      \"main\": [\n        []\n      ]\n    },\n    \"Extract customers data\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Convert to Squarespace contacts csv\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Check page_info existence\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge Loop items\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Extract page_info \",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Assign page_info parameter\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get Customers\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"When clicking ‘Test workflow’\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get Customers\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Convert to Squarespace contacts csv\": {\n      \"main\": [\n        []\n      ]\n    }\n  }\n}"
}