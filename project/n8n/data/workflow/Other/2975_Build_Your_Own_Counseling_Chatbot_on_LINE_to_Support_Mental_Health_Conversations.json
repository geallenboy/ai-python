{
  "title": "Build Your Own Counseling Chatbot on LINE to Support Mental Health Conversations",
  "url": "https://n8n.io/workflows/2975-build-your-own-counseling-chatbot-on-line-to-support-mental-health-conversations/",
  "category": "Other",
  "category_url": "https://n8n.io/workflows/categories/other/?sort=createdAt:desc",
  "author": "lin@davoy.tech",
  "publish_date": "Last update 2 months ago",
  "publish_date_absolute": "2025-03-23",
  "content": "",
  "workflow_json": "{\"id\":\"ghfbOYrOSiQVAbl5\",\"meta\":{\"instanceId\":\"558d88703fb65b2d0e44613bc35916258b0f0bf983c5d4730c00c424b77ca36a\"},\"name\":\"Chatbot AI\",\"tags\":[],\"nodes\":[{\"id\":\"6eec6665-eea6-4aaa-8ae5-2fc7bf0c4746\",\"name\":\"Loading Animation\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[-520,340],\"parameters\":{\"url\":\"https://api.line.me/v2/bot/chat/loading/start\",\"body\":\"={\\n    \\\"chatId\\\": \\\"{{ $json.body.events[0].source.userId }}\\\",\\n    \\\"loadingSeconds\\\": 60\\n}\",\"method\":\"POST\",\"options\":{},\"sendBody\":true,\"contentType\":\"raw\",\"authentication\":\"genericCredentialType\",\"rawContentType\":\"application/json\",\"genericAuthType\":\"httpHeaderAuth\"},\"credentials\":{\"httpHeaderAuth\":{\"id\":\"PQI3F0ibV3txKWfv\",\"name\":\"Talking Therapy Line@\"}},\"typeVersion\":4.2},{\"id\":\"72ff06e5-e1d8-47e7-be15-888ec9171c72\",\"name\":\"ReplyMessage - Not supported\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[100,760],\"parameters\":{\"url\":\"https://api.line.me/v2/bot/message/reply\",\"body\":\"={\\n    \\\"replyToken\\\":\\\"{{ $('Line Chatbot').item.json.body.events[0].replyToken }}\\\",\\n    \\\"messages\\\":[\\n        {\\n            \\\"type\\\":\\\"text\\\",\\n            \\\"text\\\":\\\"Currently, the input of image or other type are not supported.\\\"\\n        }\\n    ]\\n}\",\"method\":\"POST\",\"options\":{},\"sendBody\":true,\"contentType\":\"raw\",\"sendHeaders\":true,\"rawContentType\":\"application/json\",\"headerParameters\":{\"parameters\":[{\"name\":\"Authorization\",\"value\":\"Bearer /lQWKI4dp71pOMWZu2q18mL8P+zwf9iIOBzUDQOPMqLGMMIg88J6jPcFGfZ2ntsFfaiwCKTEcAsMjliZYXrV5E4lsjioJmv2hS7XYbh8lxmuyz1vXegKwAT66hTIBjQ1zf4l6yKugYNsUmwSYfCSQgdB04t89/1O/w1cDnyilFU=\"}]}},\"typeVersion\":4.2},{\"id\":\"3a4eb71f-033d-4aff-a4fd-2ed14ea80c6c\",\"name\":\"AI Agent\",\"type\":\"@n8n/n8n-nodes-langchain.agent\",\"position\":[40,80],\"parameters\":{\"text\":\"={{ $('Line Chatbot').item.json.body.events[0].message.text }}\",\"options\":{\"systemMessage\":\"You're CBT therapist. You'll help the user find the answer to their problems using CBT. but you will not tell them that you're using CBT\\n\\nCBT is a talking therapy. Talking therapies are also known as psychotherapies. You can find out more about these on our information page on psychotherapies and psychological treatments.\\n\\nCBT helps you to learn more helpful ways of thinking and reacting in everyday situations. Changing the way you think, and what you do, can help you to feel better.\\n\\nUnlike some other talking therapies, CBT focuses on your current challenges rather than on your past experiences. It aims to improve your state of mind by teaching you to spot the links between your thoughts, actions and feelings.\\n\\nC stands for ‘cognitive’ (what you think) – In CBT, you learn to notice when you are thinking negatively. You work to challenge negative or unhelpful thoughts, for example:\\n-‘I’m useless’ or\\n-‘It’s all going to go wrong’.\\nInstead, you work to develop more useful, realistic thoughts, for example:\\n-‘What’s the evidence this is true?’\\n-‘What’s another way to think about this?’ or\\n-‘What advice would I give a friend in my situation?’\\n\\nB stands for ‘behaviour’ (what you do) – Your behaviour is what you do and how you act. CBT can help you to deal with things you have been avoiding or have fears around. When doing CBT, you might keep a daily diary of activities, and set goals to try things that you are afraid of doing. Writing down your goals and actions can give you a sense of achievement and help you to mark your progress.\\n\\nT stands for ‘therapy’ (what you learn) – Through CBT you learn new skills that you can then practise as ‘homework’. After you have finished receiving CBT you can continue to practise these skills, which can give you the tools to stay well in the future.\\n\\n\\nCBT can help you to make sense of overwhelming problems by breaking them down into smaller parts. This makes it easier to see how they are connected and how they affect you. These parts are:\\n\\nA situation – for example, an activity, or something that happens to you that you find difficult\\nFrom this can follow:\\n-Thoughts\\n-Emotions\\n-Physical feelings\\n-Actions\\n\\nTypes of CBT \\n- Cognitive therapy : Spot unhelpful thoughts and beliefs. Keep a record and try out more useful and realistic ways of thinking and reacting.\\n- Behaviour therapy (e.g., graded exposure) : Change unhelpful behaviours, like avoiding, checking, or getting reassurance. Gradually face situations, thoughts, or memories you’ve been avoiding.\\n- Behavioural activation: Get more active and involved in life by doing things that give a sense of pleasure or achievement. Keep a diary and schedule in positive activities.\\n- Problem-solving therapy: Identify the problem, come up with ways of solving it, pick one solution, and put it into practice.\\n- Motivational interviewing: Look at the pros and cons of a habit. Set goals for change.\\n- Mindfulness : Pay attention to your thoughts and surroundings in the here and now without reacting to them.\\n- Compassionate mind therapy : Be kinder and less critical of yourself and others, helping you to feel safer and more content.\\n- Acceptance and commitment therapy (ACT, pronounced ‘act’) : Accept unpleasant thoughts and feelings rather than fight them or get upset.\\n- Dialectical behaviour therapy (DBT) :Manage strong feelings and sudden mood changes to overcome relationship difficulties. Combines one-to-one CBT with group therapy.\\n- Cognitive analytic therapy : Understand past causes for current difficulties and find new ways of coping. Combines CBT with analytic therapy.\\n\\nReference: https://www.rcpsych.ac.uk/mental-health/treatments-and-wellbeing/cognitive-behavioural-therapy-(cbt)?spm=5aebb161.59ab0a80.0.0.3380c921WQnNWN\\n\\nYou'll keep the character limit under 500\"},\"promptType\":\"define\"},\"typeVersion\":1.7},{\"id\":\"7a92aeaf-3496-410f-a6fd-4be5172b650e\",\"name\":\"Azure OpenAI Chat Model\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatAzureOpenAi\",\"position\":[80,200],\"parameters\":{\"model\":\"4o\",\"options\":{}},\"credentials\":{\"azureOpenAiApi\":{\"id\":\"5AjoWhww5SQi2VXd\",\"name\":\"Azure Open AI account\"}},\"typeVersion\":1},{\"id\":\"36df34d5-4232-40c8-b0ca-de7e30807adc\",\"name\":\"ReplyMessage - Line\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[920,80],\"parameters\":{\"url\":\"https://api.line.me/v2/bot/message/reply\",\"method\":\"POST\",\"options\":{},\"jsonBody\":\"={\\n  \\\"replyToken\\\": \\\"{{ $('Line Chatbot').item.json.body.events[0].replyToken }}\\\",\\n  \\\"messages\\\": [\\n    {\\n      \\\"type\\\": \\\"text\\\",\\n      \\\"text\\\": \\\"{{ $json.output }}\\\"\\n    }\\n  ]} \",\"sendBody\":true,\"specifyBody\":\"json\",\"authentication\":\"genericCredentialType\",\"genericAuthType\":\"httpHeaderAuth\"},\"credentials\":{\"httpHeaderAuth\":{\"id\":\"PQI3F0ibV3txKWfv\",\"name\":\"Talking Therapy Line@\"}},\"typeVersion\":4.2},{\"id\":\"c3e227dd-3306-4259-ad7a-c1911c3c5176\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[0,680],\"parameters\":{\"color\":4,\"width\":320,\"height\":260,\"content\":\"For non-text, we do not process and just provide user that it's not supported right now\"},\"typeVersion\":1},{\"id\":\"fba0b833-896e-4332-97e5-fa09a3838191\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-1000,280],\"parameters\":{\"color\":4,\"width\":340,\"height\":560,\"content\":\"**Webhook from Line**\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nYou need to set-up this webhook at Line Manager or Line Developer Console\\n\\nYou'll need to copy Webhook URL from this node to put in Line Console\\n\\nAlso, don't forget to remove 'test' part when going for production\\n\\nhttps://developers.line.biz/en/docs/messaging-api/receiving-messages/\\n\"},\"typeVersion\":1},{\"id\":\"f58d7af5-70c4-412a-a8f6-6cfceaf65ade\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-640,280],\"parameters\":{\"color\":4,\"width\":340,\"height\":560,\"content\":\"**Line Loading Animation**\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nThis node is to only give ... loading animation back in Line.\\n\\nIt seems stupid but it actually tells user that the workflow is running and you are not left waiting without hope\\n\\nTo authorize, use header authorization \\n\\nhttps://developers.line.biz/en/docs/messaging-api/use-loading-indicator/\"},\"typeVersion\":1},{\"id\":\"7c67d79d-e2b8-453c-8adc-cb66e6ef290c\",\"name\":\"Line Chatbot\",\"type\":\"n8n-nodes-base.webhook\",\"position\":[-900,340],\"webhookId\":\"c69b940a-5a44-45e3-b9b4-04abda6462b2\",\"parameters\":{\"path\":\"AIChatbot\",\"options\":{},\"httpMethod\":\"POST\"},\"typeVersion\":2},{\"id\":\"a44319cf-d985-4bbf-be99-ac479406c369\",\"name\":\"Sticky Note3\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[820,0],\"parameters\":{\"color\":4,\"width\":320,\"height\":600,\"content\":\"**Reply Message**\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nYou can send anything with reply-token without using your broadcast quota.\\n\\nTo use header auth: \\n- select generic > header auth\\n- add new \\n- name = Authorization\\n- value = Bearer <your token>\\n- you can rename this credential on top\\n\\nhttps://developers.line.biz/en/docs/messaging-api/sending-messages/\"},\"typeVersion\":1},{\"id\":\"1cfa159b-57c6-424a-a9e2-4b237a0bcbb5\",\"name\":\"Check Message Type IsText?\",\"type\":\"n8n-nodes-base.if\",\"position\":[-220,340],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"e44288a5-18de-48b3-9bb1-0e18f6491043\",\"operator\":{\"name\":\"filter.operator.equals\",\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $('Line Chatbot').item.json.body.events[0].message.type }}\",\"rightValue\":\"text\"}]}},\"typeVersion\":2.2},{\"id\":\"48363222-487e-4d4a-a424-4406aacc7f74\",\"name\":\"Sticky Note4\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[400,0],\"parameters\":{\"color\":2,\"width\":320,\"height\":320,\"content\":\"The output from AI-Agent is not properly formatted for JSON to send via reply. So you need to edit it a bit\\n\"},\"typeVersion\":1},{\"id\":\"d7b7d3ca-c685-4a02-8b73-a5b24aa663d4\",\"name\":\"Sticky Note5\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[0,0],\"parameters\":{\"color\":5,\"width\":320,\"height\":620,\"content\":\"**Chat Model (LLM)**\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nTo use chat LLM, you need to have AI Agent or LLM Chain. Then you can connect the model to the node.\\n- edit system prompt on the mother node. \\n- edit model parameters eg. temperature at the AI node (closer to 1 = more creative)\\n\\nAzure OpenAI Ref : https://davoy.tech/how-to-use-azure-openai-2/\\n\\nOr you can choose different models\"},\"typeVersion\":1},{\"id\":\"8cb1b56a-15dd-4936-b343-c2350b2a6a48\",\"name\":\"Format Reply\",\"type\":\"n8n-nodes-base.set\",\"position\":[500,80],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"15bd9ebd-ba6b-4ee5-9f4b-185260e51b0a\",\"name\":\"output\",\"type\":\"string\",\"value\":\"={{ $json.output.replaceAll(\\\"\\\\n\\\",\\\"\\\\\\\\n\\\").replaceAll(\\\"\\\\n\\\",\\\"\\\").removeMarkdown().removeTags().replaceAll('\\\"',\\\"\\\") }}\"}]}},\"typeVersion\":3.4}],\"active\":false,\"pinData\":{},\"settings\":{\"executionOrder\":\"v1\"},\"versionId\":\"cca20e40-0b31-4e64-9953-610dc6b569d7\",\"connections\":{\"AI Agent\":{\"main\":[[{\"node\":\"Format Reply\",\"type\":\"main\",\"index\":0}]]},\"Format Reply\":{\"main\":[[{\"node\":\"ReplyMessage - Line\",\"type\":\"main\",\"index\":0}]]},\"Line Chatbot\":{\"main\":[[{\"node\":\"Loading Animation\",\"type\":\"main\",\"index\":0}]]},\"Loading Animation\":{\"main\":[[{\"node\":\"Check Message Type IsText?\",\"type\":\"main\",\"index\":0}]]},\"Azure OpenAI Chat Model\":{\"ai_languageModel\":[[{\"node\":\"AI Agent\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"Check Message Type IsText?\":{\"main\":[[{\"node\":\"AI Agent\",\"type\":\"main\",\"index\":0}],[{\"node\":\"ReplyMessage - Not supported\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "Are you looking to create a counseling chatbot that provides emotional support and mental health guidance through the LINE messaging platform ? This guide will walk you through connecting LINE with powerful AI language models like GPT-4 to build a chatbot that supports users in navigating their emotions, offering 24/7 conversational therapy and accessible mental health resources .\n\nBy leveraging LINE's webhook integration and Azure OpenAI , this template allows you to design a chatbot that is both empathetic and efficient, ensuring users receive timely and professional responses. Whether you're a developer, counselor, or business owner, this guide will help you create a customizable counseling chatbot tailored to your audience's needs.\n\n## Who Is This Template For?\n\n**Developers** who want to integrate AI-powered chatbots into the LINE platform for mental health applications.  \n**Counselors & Therapists** looking to expand their reach and provide automated emotional support to clients outside of traditional sessions.  \n**Businesses & Organizations** focused on improving mental health accessibility and offering innovative solutions to their users.  \n**Educators & Nonprofits** seeking tools to provide free or low-cost counseling services to underserved communities.\n\n## How this work?\n\n  * Line Webhook to receive new message\n  * Send loading animation in Line\n  * Check if the input is text or not\n  * Send the text as prompt in chat model (GPT 4o)\n  * Reply the message to user (you'll need 'edit field' to format it before reply)\n\n\n\n## Pre-Requisites\n\n  * You have access to the LINE Developers Console.\n  * An Azure OpenAI account with necessary credentials.\n\n\n\n## Set-up\n\n  1. To receive messages from LINE, configure your webhook:\n\n\n  * Set up a webhook in LINE Developer Console.\n  * Copy the Webhook URL from the Line Chatbot node and paste it into the LINE Console.\n  * Ensure to remove any 'test' part when moving to production.\n\n\n  1. The loading animation reassures users that the system is processing their request.\n\n\n  * Authorize using header authorization\n\n\n  1. Message Handling\n\n\n  * Use the Check Message Type IsText? node to verify if the incoming message is text.  \nIf the message type is text, proceed with ChatGPT processing; otherwise, send a reply indicating non-text inputs are not supported.\n\n\n  1. AI Agent Configuration\n\n\n  * Define the system message within the AI Agent node to guide the conversation based on desired interaction principles.\n  * Connect the Azure OpenAI Chat Model to the AI Agent.\n\n\n  1. Formatting Responses\n\n\n  * Ensure responses are properly formatted before sending them back to the user.\n\n\n  1. Reply Message\n\n\n  * Use the ReplyMessage - Line node to send the formatted response.\n  * Ensure proper header authorization using Bearer tokens.\n\n\n",
  "readme_html": "<!--[--><div data-v-50766329=\"\"><p>Are you looking to create a counseling chatbot that provides emotional support and mental health guidance through the LINE messaging platform ? This guide will walk you through connecting LINE with powerful AI language models like GPT-4 to build a chatbot that supports users in navigating their emotions, offering 24/7 conversational therapy and accessible mental health resources .</p>\n<p>By leveraging LINE's webhook integration and Azure OpenAI , this template allows you to design a chatbot that is both empathetic and efficient, ensuring users receive timely and professional responses. Whether you're a developer, counselor, or business owner, this guide will help you create a customizable counseling chatbot tailored to your audience's needs.</p>\n<h2>Who Is This Template For?</h2>\n<p><strong>Developers</strong> who want to integrate AI-powered chatbots into the LINE platform for mental health applications.<br>\n<strong>Counselors &amp; Therapists</strong> looking to expand their reach and provide automated emotional support to clients outside of traditional sessions.<br>\n<strong>Businesses &amp; Organizations</strong> focused on improving mental health accessibility and offering innovative solutions to their users.<br>\n<strong>Educators &amp; Nonprofits</strong> seeking tools to provide free or low-cost counseling services to underserved communities.</p>\n<h2>How this work?</h2>\n<ul>\n<li>Line Webhook to receive new message</li>\n<li>Send loading animation in Line</li>\n<li>Check if the input is text or not</li>\n<li>Send the text as prompt in chat model (GPT 4o)</li>\n<li>Reply the message to user (you'll need  'edit field' to format it before reply)</li>\n</ul>\n<h2>Pre-Requisites</h2>\n<ul>\n<li>You have access to the LINE Developers Console.</li>\n<li>An Azure OpenAI account with necessary credentials.</li>\n</ul>\n<h2>Set-up</h2>\n<ol>\n<li>To receive messages from LINE, configure your webhook:</li>\n</ol>\n<ul>\n<li>Set up a webhook in  LINE Developer Console.</li>\n<li>Copy the Webhook URL from the Line Chatbot node and paste it into the LINE Console.</li>\n<li>Ensure to remove any 'test' part when moving to production.</li>\n</ul>\n<ol>\n<li>The loading animation reassures users that the system is processing their request.</li>\n</ol>\n<ul>\n<li>Authorize using header authorization</li>\n</ul>\n<ol>\n<li>Message Handling</li>\n</ol>\n<ul>\n<li>Use the Check Message Type IsText? node to verify if the incoming message is text.<br>\nIf the message type is text, proceed with ChatGPT processing; otherwise, send a reply indicating non-text inputs are not supported.</li>\n</ul>\n<ol>\n<li>AI Agent Configuration</li>\n</ol>\n<ul>\n<li>Define the system message within the AI Agent node to guide the conversation based on desired interaction principles.</li>\n<li>Connect the Azure OpenAI Chat Model to the AI Agent.</li>\n</ul>\n<ol>\n<li>Formatting Responses</li>\n</ol>\n<ul>\n<li>Ensure responses are properly formatted before sending them back to the user.</li>\n</ul>\n<ol>\n<li>Reply Message</li>\n</ol>\n<ul>\n<li>Use the ReplyMessage - Line node to send the formatted response.</li>\n<li>Ensure proper header authorization using Bearer tokens.</li>\n</ul>\n</div><!--]-->",
  "readme_zh": "您是否希望打造一款通过LINE即时通讯平台提供情感支持与心理健康指导的咨询聊天机器人？本指南将带您逐步实现LINE与GPT-4等强大AI语言模型的对接，构建能帮助用户疏导情绪、提供24/7对话式疗愈服务及便捷心理健康资源的聊天机器人。\n\n通过整合LINE的Webhook功能与Azure OpenAI服务，本模板可助您设计出兼具共情力与高效响应的聊天机器人，确保用户获得及时专业的反馈。无论您是开发者、心理咨询师还是企业主，本指南都能帮助您创建符合目标群体需求的可定制化心理咨询机器人。\n\n## 适用对象\n\n**开发者**：希望为LINE平台集成AI心理援助聊天机器人  \n**心理咨询师**：寻求扩展服务范围，在传统咨询时段外提供自动化情感支持  \n**企业与组织**：致力于提升心理健康服务可及性，为用户提供创新解决方案  \n**教育机构与非营利组织**：需要为资源匮乏社区提供免费或低价咨询服务的工具  \n\n## 实现原理\n\n  * 通过LINE Webhook接收新消息\n  * 发送加载动画提升等待体验\n  * 校验输入内容是否为文本\n  * 将文本作为提示词发送至聊天模型（GPT-4o）\n  * 格式化后回复用户（需使用'编辑字段'功能优化回复内容）\n\n## 环境准备\n\n  * 拥有LINE开发者控制台访问权限\n  * 已开通Azure OpenAI服务并获取凭证\n\n## 配置步骤\n\n  1. 配置LINE消息接收：\n\n  * 在LINE开发者控制台设置Webhook\n  * 从Line Chatbot节点复制Webhook URL至LINE控制台\n  * 正式部署时需移除所有'test'测试字段\n\n  2. 加载动画设置：\n\n  * 通过头部授权验证实现\n\n  3. 消息处理：\n\n  * 使用\"Check Message Type IsText?\"节点验证消息类型  \n若为文本则交由ChatGPT处理，否则回复\"暂不支持非文本内容\"\n\n  4. AI代理配置：\n\n  * 在AI Agent节点设定系统消息以引导对话原则\n  * 将Azure OpenAI聊天模型连接至AI Agent\n\n  5. 响应格式化：\n\n  * 确保返回用户前完成内容格式优化\n\n  6. 消息回复：\n\n  * 通过ReplyMessage - Line节点发送格式化响应\n  * 使用Bearer令牌完成头部授权验证",
  "title_zh": "在LINE上打造专属心理咨询聊天机器人，助力心理健康对话",
  "publish_date_zh": "最后更新于2个月前",
  "workflow_json_zh": "{\n  \"id\": \"ghfbOYrOSiQVAbl5\",\n  \"meta\": {\n    \"instanceId\": \"558d88703fb65b2d0e44613bc35916258b0f0bf983c5d4730c00c424b77ca36a\"\n  },\n  \"name\": \"Chatbot AI\",\n  \"tags\": [],\n  \"nodes\": [\n    {\n      \"id\": \"6eec6665-eea6-4aaa-8ae5-2fc7bf0c4746\",\n      \"name\": \"Loading Animation\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        -520,\n        340\n      ],\n      \"parameters\": {\n        \"url\": \"https://api.line.me/v2/bot/chat/loading/start\",\n        \"body\": \"={\\n    \\\"chatId\\\": \\\"{{ $json.body.events[0].source.userId }}\\\",\\n    \\\"loadingSeconds\\\": 60\\n}\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"sendBody\": true,\n        \"contentType\": \"raw\",\n        \"authentication\": \"genericCredentialType\",\n        \"rawContentType\": \"application/json\",\n        \"genericAuthType\": \"httpHeaderAuth\"\n      },\n      \"credentials\": {\n        \"httpHeaderAuth\": {\n          \"id\": \"PQI3F0ibV3txKWfv\",\n          \"name\": \"Talking Therapy Line@\"\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"72ff06e5-e1d8-47e7-be15-888ec9171c72\",\n      \"name\": \"ReplyMessage - Not supported\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        100,\n        760\n      ],\n      \"parameters\": {\n        \"url\": \"https://api.line.me/v2/bot/message/reply\",\n        \"body\": \"={\\n    \\\"replyToken\\\":\\\"{{ $('Line Chatbot').item.json.body.events[0].replyToken }}\\\",\\n    \\\"messages\\\":[\\n        {\\n            \\\"type\\\":\\\"text\\\",\\n            \\\"text\\\":\\\"Currently, the input of image or other type are not supported.\\\"\\n        }\\n    ]\\n}\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"sendBody\": true,\n        \"contentType\": \"raw\",\n        \"sendHeaders\": true,\n        \"rawContentType\": \"application/json\",\n        \"headerParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"Authorization\",\n              \"value\": \"Bearer /lQWKI4dp71pOMWZu2q18mL8P+zwf9iIOBzUDQOPMqLGMMIg88J6jPcFGfZ2ntsFfaiwCKTEcAsMjliZYXrV5E4lsjioJmv2hS7XYbh8lxmuyz1vXegKwAT66hTIBjQ1zf4l6yKugYNsUmwSYfCSQgdB04t89/1O/w1cDnyilFU=\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"3a4eb71f-033d-4aff-a4fd-2ed14ea80c6c\",\n      \"name\": \"AI Agent\",\n      \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n      \"position\": [\n        40,\n        80\n      ],\n      \"parameters\": {\n        \"text\": \"={{ $('Line Chatbot').item.json.body.events[0].message.text }}\",\n        \"options\": {\n          \"systemMessage\": \"You're CBT therapist. You'll help the user find the answer to their problems using CBT. but you will not tell them that you're using CBT\\n\\nCBT is a talking therapy. Talking therapies are also known as psychotherapies. You can find out more about these on our information page on psychotherapies and psychological treatments.\\n\\nCBT helps you to learn more helpful ways of thinking and reacting in everyday situations. Changing the way you think, and what you do, can help you to feel better.\\n\\nUnlike some other talking therapies, CBT focuses on your current challenges rather than on your past experiences. It aims to improve your state of mind by teaching you to spot the links between your thoughts, actions and feelings.\\n\\nC stands for ‘cognitive’ (what you think) – In CBT, you learn to notice when you are thinking negatively. You work to challenge negative or unhelpful thoughts, for example:\\n-‘I’m useless’ or\\n-‘It’s all going to go wrong’.\\nInstead, you work to develop more useful, realistic thoughts, for example:\\n-‘What’s the evidence this is true?’\\n-‘What’s another way to think about this?’ or\\n-‘What advice would I give a friend in my situation?’\\n\\nB stands for ‘behaviour’ (what you do) – Your behaviour is what you do and how you act. CBT can help you to deal with things you have been avoiding or have fears around. When doing CBT, you might keep a daily diary of activities, and set goals to try things that you are afraid of doing. Writing down your goals and actions can give you a sense of achievement and help you to mark your progress.\\n\\nT stands for ‘therapy’ (what you learn) – Through CBT you learn new skills that you can then practise as ‘homework’. After you have finished receiving CBT you can continue to practise these skills, which can give you the tools to stay well in the future.\\n\\n\\nCBT can help you to make sense of overwhelming problems by breaking them down into smaller parts. This makes it easier to see how they are connected and how they affect you. These parts are:\\n\\nA situation – for example, an activity, or something that happens to you that you find difficult\\nFrom this can follow:\\n-Thoughts\\n-Emotions\\n-Physical feelings\\n-Actions\\n\\nTypes of CBT \\n- Cognitive therapy : Spot unhelpful thoughts and beliefs. Keep a record and try out more useful and realistic ways of thinking and reacting.\\n- Behaviour therapy (e.g., graded exposure) : Change unhelpful behaviours, like avoiding, checking, or getting reassurance. Gradually face situations, thoughts, or memories you’ve been avoiding.\\n- Behavioural activation: Get more active and involved in life by doing things that give a sense of pleasure or achievement. Keep a diary and schedule in positive activities.\\n- Problem-solving therapy: Identify the problem, come up with ways of solving it, pick one solution, and put it into practice.\\n- Motivational interviewing: Look at the pros and cons of a habit. Set goals for change.\\n- Mindfulness : Pay attention to your thoughts and surroundings in the here and now without reacting to them.\\n- Compassionate mind therapy : Be kinder and less critical of yourself and others, helping you to feel safer and more content.\\n- Acceptance and commitment therapy (ACT, pronounced ‘act’) : Accept unpleasant thoughts and feelings rather than fight them or get upset.\\n- Dialectical behaviour therapy (DBT) :Manage strong feelings and sudden mood changes to overcome relationship difficulties. Combines one-to-one CBT with group therapy.\\n- Cognitive analytic therapy : Understand past causes for current difficulties and find new ways of coping. Combines CBT with analytic therapy.\\n\\nReference: https://www.rcpsych.ac.uk/mental-health/treatments-and-wellbeing/cognitive-behavioural-therapy-(cbt)?spm=5aebb161.59ab0a80.0.0.3380c921WQnNWN\\n\\nYou'll keep the character limit under 500\"\n        },\n        \"promptType\": \"define\"\n      },\n      \"typeVersion\": 1.7\n    },\n    {\n      \"id\": \"7a92aeaf-3496-410f-a6fd-4be5172b650e\",\n      \"name\": \"Azure OpenAI Chat Model\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatAzureOpenAi\",\n      \"position\": [\n        80,\n        200\n      ],\n      \"parameters\": {\n        \"model\": \"4o\",\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"azureOpenAiApi\": {\n          \"id\": \"5AjoWhww5SQi2VXd\",\n          \"name\": \"Azure Open AI account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"36df34d5-4232-40c8-b0ca-de7e30807adc\",\n      \"name\": \"ReplyMessage - Line\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        920,\n        80\n      ],\n      \"parameters\": {\n        \"url\": \"https://api.line.me/v2/bot/message/reply\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"jsonBody\": \"={\\n  \\\"replyToken\\\": \\\"{{ $('Line Chatbot').item.json.body.events[0].replyToken }}\\\",\\n  \\\"messages\\\": [\\n    {\\n      \\\"type\\\": \\\"text\\\",\\n      \\\"text\\\": \\\"{{ $json.output }}\\\"\\n    }\\n  ]} \",\n        \"sendBody\": true,\n        \"specifyBody\": \"json\",\n        \"authentication\": \"genericCredentialType\",\n        \"genericAuthType\": \"httpHeaderAuth\"\n      },\n      \"credentials\": {\n        \"httpHeaderAuth\": {\n          \"id\": \"PQI3F0ibV3txKWfv\",\n          \"name\": \"Talking Therapy Line@\"\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"c3e227dd-3306-4259-ad7a-c1911c3c5176\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        0,\n        680\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 320,\n        \"height\": 260,\n        \"content\": \"对于非文本内容，我们暂不处理并告知用户当前不支持该类型。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"fba0b833-896e-4332-97e5-fa09a3838191\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -1000,\n        280\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 340,\n        \"height\": 560,\n        \"content\": \"**来自Line的Webhook**\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"f58d7af5-70c4-412a-a8f6-6cfceaf65ade\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -640,\n        280\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 340,\n        \"height\": 560,\n        \"content\": \"**线条加载动画**\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"7c67d79d-e2b8-453c-8adc-cb66e6ef290c\",\n      \"name\": \"Line Chatbot\",\n      \"type\": \"n8n-nodes-base.webhook\",\n      \"position\": [\n        -900,\n        340\n      ],\n      \"webhookId\": \"c69b940a-5a44-45e3-b9b4-04abda6462b2\",\n      \"parameters\": {\n        \"path\": \"AIChatbot\",\n        \"options\": {},\n        \"httpMethod\": \"POST\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"a44319cf-d985-4bbf-be99-ac479406c369\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        820,\n        0\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 320,\n        \"height\": 600,\n        \"content\": \"**回复消息**\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"1cfa159b-57c6-424a-a9e2-4b237a0bcbb5\",\n      \"name\": \"Check Message Type IsText?\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        -220,\n        340\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"e44288a5-18de-48b3-9bb1-0e18f6491043\",\n              \"operator\": {\n                \"name\": \"filter.operator.equals\",\n                \"type\": \"string\",\n                \"operation\": \"equals\"\n              },\n              \"leftValue\": \"={{ $('Line Chatbot').item.json.body.events[0].message.type }}\",\n              \"rightValue\": \"text\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"48363222-487e-4d4a-a424-4406aacc7f74\",\n      \"name\": \"Sticky Note4\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        400,\n        0\n      ],\n      \"parameters\": {\n        \"color\": 2,\n        \"width\": 320,\n        \"height\": 320,\n        \"content\": \"AI-Agent的输出格式不符合通过回复发送JSON的要求，因此你需要稍作编辑。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"d7b7d3ca-c685-4a02-8b73-a5b24aa663d4\",\n      \"name\": \"Sticky Note5\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        0,\n        0\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 320,\n        \"height\": 620,\n        \"content\": \"**聊天模型（LLM）**\\n\\n要使用聊天LLM，您需要具备AI代理或LLM链。然后您可以将模型连接到节点。\\n- 在母节点上编辑系统提示。\\n- 在AI节点上编辑模型参数，例如温度（越接近1，创造性越强）。\\n\\nAzure OpenAI 参考：https://davoy.tech/how-to-use-azure-openai-2/\\n\\n或者您可以选择不同的模型。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"8cb1b56a-15dd-4936-b343-c2350b2a6a48\",\n      \"name\": \"Format Reply\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        500,\n        80\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"15bd9ebd-ba6b-4ee5-9f4b-185260e51b0a\",\n              \"name\": \"output\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.output.replaceAll(\\\"\\\\n\\\",\\\"\\\\\\\\n\\\").replaceAll(\\\"\\\\n\\\",\\\"\\\").removeMarkdown().removeTags().replaceAll('\\\"',\\\"\\\") }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    }\n  ],\n  \"active\": false,\n  \"pinData\": {},\n  \"settings\": {\n    \"executionOrder\": \"v1\"\n  },\n  \"versionId\": \"cca20e40-0b31-4e64-9953-610dc6b569d7\",\n  \"connections\": {\n    \"AI Agent\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Format Reply\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Format Reply\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"ReplyMessage - Line\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Line Chatbot\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Loading Animation\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Loading Animation\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Check Message Type IsText?\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Azure OpenAI Chat Model\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"AI Agent\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Check Message Type IsText?\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"AI Agent\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"ReplyMessage - Not supported\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}