{
  "title": "Organize Email Attachments into Google Drive Folders by Company with Gmail & Sheets",
  "url": "https://n8n.io/workflows/3464-organize-email-attachments-into-google-drive-folders-by-company-with-gmail-and-sheets/",
  "category": "Other",
  "category_url": "https://n8n.io/workflows/categories/other/",
  "author": "Ventsislav Minev",
  "publish_date": "Last update 21 days ago",
  "publish_date_absolute": "2025-05-02",
  "content": "",
  "workflow_json": "{\"meta\":{\"instanceId\":\"5e2cdd86a9e1ca2fc82cc63db38d1710d5d6a5c6fe352258a6f7112815bcd512\"},\"nodes\":[{\"id\":\"13188ea7-7e66-4955-89d0-82ba4dc08dc9\",\"name\":\"Search For Folder\",\"type\":\"n8n-nodes-base.googleDrive\",\"position\":[-2420,500],\"parameters\":{\"filter\":{\"folderId\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"={{ $json.id }}\"}},\"options\":{},\"resource\":\"fileFolder\",\"queryString\":\"={{$json.folderName}}\"},\"credentials\":{\"googleDriveOAuth2Api\":{\"id\":\"VypmUgEf64twpmiZ\",\"name\":\"Google Drive account\"}},\"typeVersion\":3,\"alwaysOutputData\":true},{\"id\":\"ed2ababb-7022-43e1-b638-0132c08ef701\",\"name\":\"Create Month Folder\",\"type\":\"n8n-nodes-base.googleDrive\",\"position\":[-2060,680],\"parameters\":{\"name\":\"={{ $('YYYY/MM').first().json.folderName }}\",\"driveId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"My Drive\"},\"options\":{},\"folderId\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"={{ $('YYYY/MM').item.json.id }}\"},\"resource\":\"folder\"},\"credentials\":{\"googleDriveOAuth2Api\":{\"id\":\"VypmUgEf64twpmiZ\",\"name\":\"Google Drive account\"}},\"typeVersion\":3},{\"id\":\"f5f2365d-0977-48b1-bd2e-29b7707839d9\",\"name\":\"Check If Folder Exists\",\"type\":\"n8n-nodes-base.if\",\"position\":[-2240,500],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"09b62415-cb8f-478e-b6d3-aa463fe70c81\",\"operator\":{\"type\":\"object\",\"operation\":\"notEmpty\",\"singleValue\":true},\"leftValue\":\"={{ $json }}\",\"rightValue\":\"\"}]}},\"typeVersion\":2.2},{\"id\":\"c27b0a9d-8ee2-4eae-963c-14256ffae0b8\",\"name\":\"Gmail Trigger\",\"type\":\"n8n-nodes-base.gmailTrigger\",\"position\":[-4400,780],\"parameters\":{\"simple\":false,\"filters\":{\"labelIds\":[\"Label_2\"]},\"options\":{},\"pollTimes\":{\"item\":[{\"mode\":\"everyX\",\"unit\":\"minutes\",\"value\":15}]}},\"credentials\":{\"gmailOAuth2\":{\"id\":\"HI2iZSvhvC5XOdpp\",\"name\":\"Gmail account 2\"}},\"typeVersion\":1.2},{\"id\":\"3eac8c53-1b20-4511-9f2a-f5e838ca0fa0\",\"name\":\"Gmail\",\"type\":\"n8n-nodes-base.gmail\",\"position\":[-1720,460],\"webhookId\":\"e62ae049-d968-4e6a-a62d-06963c8e592f\",\"parameters\":{\"simple\":false,\"options\":{\"downloadAttachments\":true},\"messageId\":\"={{ $('Gmail Trigger').item.json.id }}\",\"operation\":\"get\"},\"credentials\":{\"gmailOAuth2\":{\"id\":\"HI2iZSvhvC5XOdpp\",\"name\":\"Gmail account 2\"}},\"typeVersion\":2.1},{\"id\":\"bfae9bb5-6915-4968-8b5e-e72dd46bda55\",\"name\":\"Split Up Binary Data1\",\"type\":\"n8n-nodes-base.function\",\"position\":[-1560,460],\"parameters\":{\"functionCode\":\"let results = [];\\n\\nfor (item of items) {\\n    for (key of Object.keys(item.binary)) {\\n        results.push({\\n            json: {\\n                fileName: item.binary[key].fileName\\n            },\\n            binary: {\\n                data: item.binary[key],\\n            }\\n        });\\n    }\\n}\\n\\nreturn results;\"},\"typeVersion\":1},{\"id\":\"baf55ab9-511f-4404-a2cc-b1c848f6f5c5\",\"name\":\"Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-1800,280],\"parameters\":{\"color\":7,\"width\":920,\"height\":660,\"content\":\"## Upload attachments to Drive\\nIncoming files are split up into individual items, each with a single binary data object under the `data` key.\\nFiles names are prefixed with the current timestamp\"},\"typeVersion\":1},{\"id\":\"5d706d3a-db17-4f5f-9eac-ba91c470dbdd\",\"name\":\"YYYY/MM\",\"type\":\"n8n-nodes-base.set\",\"position\":[-2600,500],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"143b3b94-a8d7-46b6-8ea8-2e70c082f5b1\",\"name\":\"=folderName\",\"type\":\"string\",\"value\":\"={{\\n  new Date($('Gmail Trigger').item.json.date).getUTCFullYear() \\n  + '/' + \\n  String(new Date($('Gmail Trigger').item.json.date).getUTCMonth() + 1).padStart(2, '0')\\n}}\\n\"}]},\"includeOtherFields\":true},\"typeVersion\":3.4},{\"id\":\"b20a3833-f648-454d-999b-d799727e18e8\",\"name\":\"Loop Over Items\",\"type\":\"n8n-nodes-base.splitInBatches\",\"position\":[-1320,460],\"parameters\":{\"options\":{}},\"typeVersion\":3},{\"id\":\"bb8c0d21-de74-4abf-bf6c-5eef3f301513\",\"name\":\"Note3\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-2680,280],\"parameters\":{\"color\":7,\"width\":820,\"height\":660,\"content\":\"# Checks if YYYY/MM Folder exists\\n## If the directory doesn't exist it is created\"},\"typeVersion\":1},{\"id\":\"40971ca3-91d3-4651-8137-e973dbd2dbbd\",\"name\":\"Company Folder Exists\",\"type\":\"n8n-nodes-base.if\",\"position\":[-3180,500],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"09b62415-cb8f-478e-b6d3-aa463fe70c81\",\"operator\":{\"type\":\"object\",\"operation\":\"notEmpty\",\"singleValue\":true},\"leftValue\":\"={{ $json }}\",\"rightValue\":\"\"}]}},\"typeVersion\":2.2},{\"id\":\"086ff643-ca10-46ec-92b5-8a014fd3bf3f\",\"name\":\"Create Company Folder\",\"type\":\"n8n-nodes-base.googleDrive\",\"position\":[-2920,620],\"parameters\":{\"name\":\"={{ $('Lookup in Sheets').item.json.company }}\",\"driveId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"My Drive\"},\"options\":{},\"folderId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"18ry0AUtrpp3re6u3zQvvs0BQUGFmBKN9\",\"cachedResultUrl\":\"https://drive.google.com/drive/folders/18ry0AUtrpp3re6u3zQvvs0BQUGFmBKN9\",\"cachedResultName\":\"Invoices\"},\"resource\":\"folder\"},\"credentials\":{\"googleDriveOAuth2Api\":{\"id\":\"VypmUgEf64twpmiZ\",\"name\":\"Google Drive account\"}},\"typeVersion\":3},{\"id\":\"7792afb7-61d9-402f-814b-f4625cd012bc\",\"name\":\"Note4\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-3500,120],\"parameters\":{\"color\":7,\"width\":760,\"height\":820,\"content\":\"# Checks if a folder with the company of the email exists\\n## If it doesn't the directory is created\"},\"typeVersion\":1},{\"id\":\"1f61ea45-49e6-4018-91ad-2144c1bbc19a\",\"name\":\"Sticky Note4\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-4120,280],\"parameters\":{\"color\":6,\"width\":560,\"height\":660,\"content\":\"# 2. Google Sheets Whitelist Config\\n\\n## To filter contacts against a whitelist:\\n### 1. Make a copy of [this spreadsheet](https://docs.google.com/spreadsheets/d/1tTz9BflstxVL18YG11Ny1eiDj3FcjvtZ619b_bHx8h4/edit?usp=sharing)\\n**OR** create a Google Sheet with two columns:\\n| **email**     | **company**      |\\n\\n\\n### 2. Add whitelisted emails and their company as rows in the sheet and configure this node **Document** and **Sheet** to point to it.\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\"},\"typeVersion\":1},{\"id\":\"f7009cc2-8194-40c9-98e9-edc4a29c5ce8\",\"name\":\"Lookup in Sheets\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[-3900,780],\"parameters\":{\"options\":{},\"filtersUI\":{\"values\":[{\"lookupValue\":\"={{ $('Gmail Trigger').item.json.from.value[0].address }}\",\"lookupColumn\":\"email\"}]},\"sheetName\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"gid=0\",\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1gZE7EbLJqfMzQlPoCgE0eeqee_F1Lh9eIwhHsVmYKdw/edit#gid=0\",\"cachedResultName\":\"Sheet1\"},\"documentId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"1gZE7EbLJqfMzQlPoCgE0eeqee_F1Lh9eIwhHsVmYKdw\",\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1gZE7EbLJqfMzQlPoCgE0eeqee_F1Lh9eIwhHsVmYKdw/edit?usp=drivesdk\",\"cachedResultName\":\"Contacts Whitelist\"}},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"63dUs6P8a2b5ed5J\",\"name\":\"Google Sheets account\"}},\"typeVersion\":4.5,\"alwaysOutputData\":false},{\"id\":\"932afe12-3341-4f77-88ab-0b558e0d6ee2\",\"name\":\"Search Company Folder1\",\"type\":\"n8n-nodes-base.googleDrive\",\"position\":[-3440,500],\"parameters\":{\"filter\":{\"whatToSearch\":\"folders\"},\"options\":{},\"resource\":\"fileFolder\",\"queryString\":\"={{ $('Lookup in Sheets').item.json.company }}\"},\"credentials\":{\"googleDriveOAuth2Api\":{\"id\":\"VypmUgEf64twpmiZ\",\"name\":\"Google Drive account\"}},\"typeVersion\":3,\"alwaysOutputData\":true},{\"id\":\"b9e66cf4-365a-4d11-bff9-48bf28be9e96\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-4740,280],\"parameters\":{\"color\":6,\"width\":560,\"height\":660,\"content\":\"# 1. Trigger Settings and Filters\\n\\n## Configure the interval to check for new emails and apply filters to process only some emails\\n\\n**For example**: To create a filter that applies a label to emails **with attachments** containing the words \\\"invoice\\\" or \\\"receipt,\\\" follow these steps:\\n\\n1. Open your Gmail and click on the burger menu button next to the search bar to open the search options.\\n2. In the `Has the words` field type in 'invoice receipt'\\n3. Check the `Has attachment` checkbox\\n4. Click on the \\\"Create filter with this search\\\" option at the bottom of the search window.\\n5. In the filter options, select the \\\"Apply the label\\\" option and choose or create a label for these emails.\\n6. Click \\\"Create filter\\\" to save your new filter.\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\"},\"typeVersion\":1},{\"id\":\"2a932450-d0e9-44b4-adfb-2254b8e6e547\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-3000,220],\"parameters\":{\"color\":6,\"height\":540,\"content\":\"# 3. Configure storage location\\n## Set where to store files from the `parent folder` dropdown\"},\"typeVersion\":1},{\"id\":\"247e4ed7-ebff-4392-adf2-4a63e80e04f4\",\"name\":\"Upload To Folder\",\"type\":\"n8n-nodes-base.googleDrive\",\"position\":[-1100,480],\"parameters\":{\"name\":\"={{ Date.now();}}-{{ $('Loop Over Items').item.binary.data.fileName }} \",\"driveId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"My Drive\",\"cachedResultUrl\":\"https://drive.google.com/drive/my-drive\",\"cachedResultName\":\"My Drive\"},\"options\":{\"ocrLanguage\":\"en\",\"propertiesUi\":{\"propertyValues\":[{\"key\":\"sender\",\"value\":\"={{ $('Gmail').item.json.from.value[0].address }}\"},{\"key\":\"time_received\",\"value\":\"={{ $('Gmail').item.json.date }}\"}]}},\"folderId\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"={{ $('Search For Folder').first().json.id || $('Create Month Folder').item.json.id }}\"},\"inputDataFieldName\":\"=data\"},\"credentials\":{\"googleDriveOAuth2Api\":{\"id\":\"VypmUgEf64twpmiZ\",\"name\":\"Google Drive account\"}},\"typeVersion\":3}],\"pinData\":{},\"connections\":{\"Gmail\":{\"main\":[[{\"node\":\"Split Up Binary Data1\",\"type\":\"main\",\"index\":0}]]},\"YYYY/MM\":{\"main\":[[{\"node\":\"Search For Folder\",\"type\":\"main\",\"index\":0}]]},\"Gmail Trigger\":{\"main\":[[{\"node\":\"Lookup in Sheets\",\"type\":\"main\",\"index\":0}]]},\"Loop Over Items\":{\"main\":[[],[{\"node\":\"Upload To Folder\",\"type\":\"main\",\"index\":0}]]},\"Lookup in Sheets\":{\"main\":[[{\"node\":\"Search Company Folder1\",\"type\":\"main\",\"index\":0}]]},\"Upload To Folder\":{\"main\":[[{\"node\":\"Loop Over Items\",\"type\":\"main\",\"index\":0}]]},\"Search For Folder\":{\"main\":[[{\"node\":\"Check If Folder Exists\",\"type\":\"main\",\"index\":0}]]},\"Create Month Folder\":{\"main\":[[{\"node\":\"Gmail\",\"type\":\"main\",\"index\":0}]]},\"Company Folder Exists\":{\"main\":[[{\"node\":\"YYYY/MM\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Create Company Folder\",\"type\":\"main\",\"index\":0}]]},\"Create Company Folder\":{\"main\":[[{\"node\":\"YYYY/MM\",\"type\":\"main\",\"index\":0}]]},\"Split Up Binary Data1\":{\"main\":[[{\"node\":\"Loop Over Items\",\"type\":\"main\",\"index\":0}]]},\"Check If Folder Exists\":{\"main\":[[{\"node\":\"Gmail\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Create Month Folder\",\"type\":\"main\",\"index\":0}]]},\"Search Company Folder1\":{\"main\":[[{\"node\":\"Company Folder Exists\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "# Automated Email Attachment Organizer\n\n_Automatically process labeled emails with attachments into organized Google Drive folders_\n\n* * *\n\n## Who Is This For?\n\n  * **Teams or Individuals** needing to: \n    * Automatically sort invoices, receipts, and files.\n    * Organize client documents by date.\n    * Verify sender emails against a whitelist.\n    * Timestamp files to avoid duplicate names.\n\n\n\n* * *\n\n## What Does This Workflow Solve?\n\n  * 🕒 **Manual Email Sorting** : Saves time by automating the organization of email attachments.\n  * 📂 **Disorganized Cloud Storage** : Ensures attachments are neatly stored in Google Drive folders.\n  * 📧 **Unverified Sender Issues** : Filters and validates emails using a whitelist.\n  * 🔄 **Duplicate Filenames** : Uses timestamps to ensure every file name is unique.\n\n\n\n* * *\n\n## Setup Guide\n\n### 1\\. Pre-Requisites\n\n  * **Whitelist Sheet** : Make a copy of the [Example Whitelist Sheet](https://docs.google.com/spreadsheets/d/1tTz9BflstxVL18YG11Ny1eiDj3FcjvtZ619b_bHx8h4/copy)\n  * **Gmail Filter** : Create a filter in Gmail to label emails with attachments.\n\n\n\n**To Create a Gmail Filter:**\n\n  1. Open your Gmail Inbox.\n  2. Click the search bar and select **\"Show search options\"**.\n  3. Enter your criteria (e.g., type `has:attachment`).\n  4. Click **\"Create filter\"**.\n  5. Choose **\"Apply the label: Custom_Label\"** and save.\n\n\n\n* * *\n\n### 2\\. Credentials Setup\n\nMake sure your n8n instance is connected with:\n\n  * **Gmail Account** : (via OAuth2)\n  * **Google Drive Account** : (via OAuth2)\n  * **Google Sheets** (via OAuth2)\n\n\n\n* * *\n\n### 3\\. Configure Your n8n Workflow Nodes\n\n#### 1\\. Trigger and Email Retrieval\n\n  * **Gmail Trigger** : Setup check interval and filters for emails (i.e. emails labeled with `Custom_Label`)\n\n\n\n#### 2\\. Whitelist settings\n\n  * **Lookup in Sheets** : Searches for a row with the sender email. Configure this node to point to your whitelist spreadsheet containing two columnds:  \n_|email|company|_\n\n\n\n#### 3\\. File storage location\n\n  * Confirue parent folder to create sub-folders and store files into in the **Create Company Folder** node _Parent Folder_ dropdown\n\n\n\n* * *\n\n## Final Steps\n\n  1. **Test Your Workflow** : Run the workflow to verify emails are processed and files are uploaded correctly.\n\n\n\n* * *\n\nHappy Automating!\n",
  "readme_html": "<!--[--><div data-v-50766329=\"\"><h1>Automated Email Attachment Organizer</h1>\n<p><em>Automatically process labeled emails with attachments into organized Google Drive folders</em></p>\n<hr>\n<h2>Who Is This For?</h2>\n<ul>\n<li><strong>Teams or Individuals</strong> needing to:\n<ul>\n<li>Automatically sort invoices, receipts, and files.</li>\n<li>Organize client documents by date.</li>\n<li>Verify sender emails against a whitelist.</li>\n<li>Timestamp files to avoid duplicate names.</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h2>What Does This Workflow Solve?</h2>\n<ul>\n<li>🕒 <strong>Manual Email Sorting</strong>: Saves time by automating the organization of email attachments.</li>\n<li>📂 <strong>Disorganized Cloud Storage</strong>: Ensures attachments are neatly stored in Google Drive folders.</li>\n<li>📧 <strong>Unverified Sender Issues</strong>: Filters and validates emails using a whitelist.</li>\n<li>🔄 <strong>Duplicate Filenames</strong>: Uses timestamps to ensure every file name is unique.</li>\n</ul>\n<hr>\n<h2>Setup Guide</h2>\n<h3>1. Pre-Requisites</h3>\n<ul>\n<li><strong>Whitelist Sheet</strong>: Make a copy of the <a href=\"https://docs.google.com/spreadsheets/d/1tTz9BflstxVL18YG11Ny1eiDj3FcjvtZ619b_bHx8h4/copy\" rel=\"ugc nofollow\" target=\"_blank\">Example Whitelist Sheet</a></li>\n<li><strong>Gmail Filter</strong>: Create a filter in Gmail to label emails with attachments.</li>\n</ul>\n<p><strong>To Create a Gmail Filter:</strong></p>\n<ol>\n<li>Open your Gmail Inbox.</li>\n<li>Click the search bar and select <strong>\"Show search options\"</strong>.</li>\n<li>Enter your criteria (e.g., type <code>has:attachment</code>).</li>\n<li>Click <strong>\"Create filter\"</strong>.</li>\n<li>Choose <strong>\"Apply the label: Custom_Label\"</strong> and save.</li>\n</ol>\n<hr>\n<h3>2. Credentials Setup</h3>\n<p>Make sure your n8n instance is connected with:</p>\n<ul>\n<li><strong>Gmail Account</strong>: (via OAuth2)</li>\n<li><strong>Google Drive Account</strong>: (via OAuth2)</li>\n<li><strong>Google Sheets</strong> (via OAuth2)</li>\n</ul>\n<hr>\n<h3>3. Configure Your n8n Workflow Nodes</h3>\n<h4>1. Trigger and Email Retrieval</h4>\n<ul>\n<li><strong>Gmail Trigger</strong>: Setup check interval and filters for emails (i.e. emails labeled with <code>Custom_Label</code>)</li>\n</ul>\n<h4>2. Whitelist settings</h4>\n<ul>\n<li><strong>Lookup in Sheets</strong>: Searches for a row with the sender email. Configure this node to point to your whitelist spreadsheet containing two columnds:<br>\n<em>|email|company|</em></li>\n</ul>\n<h4>3. File storage location</h4>\n<ul>\n<li>Confirue parent folder to create sub-folders and store files into in the <strong>Create Company Folder</strong> node <em>Parent Folder</em> dropdown</li>\n</ul>\n<hr>\n<h2>Final Steps</h2>\n<ol>\n<li><strong>Test Your Workflow</strong>: Run the workflow to verify emails are processed and files are uploaded correctly.</li>\n</ol>\n<hr>\n<p>Happy Automating!</p>\n</div><!--]-->",
  "readme_zh": "# 邮件附件自动整理工具\n\n_自动将带标签的邮件附件归类至Google Drive指定文件夹_\n\n* * *\n\n## 适用场景\n\n  * **团队或个人**需要： \n    * 自动分类发票、收据等文件\n    * 按日期整理客户文档\n    * 通过白名单验证发件人邮箱\n    * 添加时间戳避免文件名重复",
  "title_zh": "使用Gmail和Sheets按公司整理邮件附件至Google Drive文件夹",
  "publish_date_zh": "上次更新于21天前",
  "workflow_json_zh": "{\n  \"meta\": {\n    \"instanceId\": \"5e2cdd86a9e1ca2fc82cc63db38d1710d5d6a5c6fe352258a6f7112815bcd512\"\n  },\n  \"nodes\": [\n    {\n      \"id\": \"13188ea7-7e66-4955-89d0-82ba4dc08dc9\",\n      \"name\": \"Search For Folder\",\n      \"type\": \"n8n-nodes-base.googleDrive\",\n      \"position\": [\n        -2420,\n        500\n      ],\n      \"parameters\": {\n        \"filter\": {\n          \"folderId\": {\n            \"__rl\": true,\n            \"mode\": \"id\",\n            \"value\": \"={{ $json.id }}\"\n          }\n        },\n        \"options\": {},\n        \"resource\": \"fileFolder\",\n        \"queryString\": \"={{$json.folderName}}\"\n      },\n      \"credentials\": {\n        \"googleDriveOAuth2Api\": {\n          \"id\": \"VypmUgEf64twpmiZ\",\n          \"name\": \"Google Drive account\"\n        }\n      },\n      \"typeVersion\": 3,\n      \"alwaysOutputData\": true\n    },\n    {\n      \"id\": \"ed2ababb-7022-43e1-b638-0132c08ef701\",\n      \"name\": \"Create Month Folder\",\n      \"type\": \"n8n-nodes-base.googleDrive\",\n      \"position\": [\n        -2060,\n        680\n      ],\n      \"parameters\": {\n        \"name\": \"={{ $('YYYY/MM').first().json.folderName }}\",\n        \"driveId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"My Drive\"\n        },\n        \"options\": {},\n        \"folderId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $('YYYY/MM').item.json.id }}\"\n        },\n        \"resource\": \"folder\"\n      },\n      \"credentials\": {\n        \"googleDriveOAuth2Api\": {\n          \"id\": \"VypmUgEf64twpmiZ\",\n          \"name\": \"Google Drive account\"\n        }\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"f5f2365d-0977-48b1-bd2e-29b7707839d9\",\n      \"name\": \"Check If Folder Exists\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        -2240,\n        500\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"09b62415-cb8f-478e-b6d3-aa463fe70c81\",\n              \"operator\": {\n                \"type\": \"object\",\n                \"operation\": \"notEmpty\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json }}\",\n              \"rightValue\": \"\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"c27b0a9d-8ee2-4eae-963c-14256ffae0b8\",\n      \"name\": \"Gmail Trigger\",\n      \"type\": \"n8n-nodes-base.gmailTrigger\",\n      \"position\": [\n        -4400,\n        780\n      ],\n      \"parameters\": {\n        \"simple\": false,\n        \"filters\": {\n          \"labelIds\": [\n            \"Label_2\"\n          ]\n        },\n        \"options\": {},\n        \"pollTimes\": {\n          \"item\": [\n            {\n              \"mode\": \"everyX\",\n              \"unit\": \"minutes\",\n              \"value\": 15\n            }\n          ]\n        }\n      },\n      \"credentials\": {\n        \"gmailOAuth2\": {\n          \"id\": \"HI2iZSvhvC5XOdpp\",\n          \"name\": \"Gmail account 2\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"3eac8c53-1b20-4511-9f2a-f5e838ca0fa0\",\n      \"name\": \"Gmail\",\n      \"type\": \"n8n-nodes-base.gmail\",\n      \"position\": [\n        -1720,\n        460\n      ],\n      \"webhookId\": \"e62ae049-d968-4e6a-a62d-06963c8e592f\",\n      \"parameters\": {\n        \"simple\": false,\n        \"options\": {\n          \"downloadAttachments\": true\n        },\n        \"messageId\": \"={{ $('Gmail Trigger').item.json.id }}\",\n        \"operation\": \"get\"\n      },\n      \"credentials\": {\n        \"gmailOAuth2\": {\n          \"id\": \"HI2iZSvhvC5XOdpp\",\n          \"name\": \"Gmail account 2\"\n        }\n      },\n      \"typeVersion\": 2.1\n    },\n    {\n      \"id\": \"bfae9bb5-6915-4968-8b5e-e72dd46bda55\",\n      \"name\": \"Split Up Binary Data1\",\n      \"type\": \"n8n-nodes-base.function\",\n      \"position\": [\n        -1560,\n        460\n      ],\n      \"parameters\": {\n        \"functionCode\": \"let results = [];\\n\\nfor (item of items) {\\n    for (key of Object.keys(item.binary)) {\\n        results.push({\\n            json: {\\n                fileName: item.binary[key].fileName\\n            },\\n            binary: {\\n                data: item.binary[key],\\n            }\\n        });\\n    }\\n}\\n\\nreturn results;\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"baf55ab9-511f-4404-a2cc-b1c848f6f5c5\",\n      \"name\": \"Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -1800,\n        280\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 920,\n        \"height\": 660,\n        \"content\": \"## 上传附件至云端硬盘\\n接收到的文件会被拆分为独立条目，每个条目下的`data`键对应单个二进制数据对象。所有文件名均以当前时间戳作为前缀。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"5d706d3a-db17-4f5f-9eac-ba91c470dbdd\",\n      \"name\": \"YYYY/MM\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        -2600,\n        500\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"143b3b94-a8d7-46b6-8ea8-2e70c082f5b1\",\n              \"name\": \"=folderName\",\n              \"type\": \"string\",\n              \"value\": \"={{\\n  new Date($('Gmail Trigger').item.json.date).getUTCFullYear() \\n  + '/' + \\n  String(new Date($('Gmail Trigger').item.json.date).getUTCMonth() + 1).padStart(2, '0')\\n}}\\n\"\n            }\n          ]\n        },\n        \"includeOtherFields\": true\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"b20a3833-f648-454d-999b-d799727e18e8\",\n      \"name\": \"Loop Over Items\",\n      \"type\": \"n8n-nodes-base.splitInBatches\",\n      \"position\": [\n        -1320,\n        460\n      ],\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"bb8c0d21-de74-4abf-bf6c-5eef3f301513\",\n      \"name\": \"Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -2680,\n        280\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 820,\n        \"height\": 660,\n        \"content\": \"# 检查YYYY/MM文件夹是否存在\\n## 如果目录不存在，则创建该目录\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"40971ca3-91d3-4651-8137-e973dbd2dbbd\",\n      \"name\": \"Company Folder Exists\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        -3180,\n        500\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"09b62415-cb8f-478e-b6d3-aa463fe70c81\",\n              \"operator\": {\n                \"type\": \"object\",\n                \"operation\": \"notEmpty\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json }}\",\n              \"rightValue\": \"\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"086ff643-ca10-46ec-92b5-8a014fd3bf3f\",\n      \"name\": \"Create Company Folder\",\n      \"type\": \"n8n-nodes-base.googleDrive\",\n      \"position\": [\n        -2920,\n        620\n      ],\n      \"parameters\": {\n        \"name\": \"={{ $('Lookup in Sheets').item.json.company }}\",\n        \"driveId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"My Drive\"\n        },\n        \"options\": {},\n        \"folderId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"18ry0AUtrpp3re6u3zQvvs0BQUGFmBKN9\",\n          \"cachedResultUrl\": \"https://drive.google.com/drive/folders/18ry0AUtrpp3re6u3zQvvs0BQUGFmBKN9\",\n          \"cachedResultName\": \"Invoices\"\n        },\n        \"resource\": \"folder\"\n      },\n      \"credentials\": {\n        \"googleDriveOAuth2Api\": {\n          \"id\": \"VypmUgEf64twpmiZ\",\n          \"name\": \"Google Drive account\"\n        }\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"7792afb7-61d9-402f-814b-f4625cd012bc\",\n      \"name\": \"Note4\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -3500,\n        120\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 760,\n        \"height\": 820,\n        \"content\": \"# 检查是否存在以电子邮件公司命名的文件夹\\n## 如果不存在，则创建该目录\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"1f61ea45-49e6-4018-91ad-2144c1bbc19a\",\n      \"name\": \"Sticky Note4\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -4120,\n        280\n      ],\n      \"parameters\": {\n        \"color\": 6,\n        \"width\": 560,\n        \"height\": 660,\n        \"content\": \"# 2. Google Sheets 白名单配置\\n\\n## 通过白名单筛选联系人：\\n### 1. 复制[此电子表格](https://docs.google.com/spreadsheets/d/1tTz9BflstxVL18YG11Ny1eiDj3FcjvtZ619b_bHx8h4/edit?usp=sharing)\\n**或** 创建一个包含两列的Google表格：\\n| **邮箱**     | **公司**      |\\n\\n\\n### 2. 在表格中添加白名单邮箱及其公司作为行，并配置此节点的**文档**和**表格**指向该文件。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"f7009cc2-8194-40c9-98e9-edc4a29c5ce8\",\n      \"name\": \"Lookup in Sheets\",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"position\": [\n        -3900,\n        780\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"filtersUI\": {\n          \"values\": [\n            {\n              \"lookupValue\": \"={{ $('Gmail Trigger').item.json.from.value[0].address }}\",\n              \"lookupColumn\": \"email\"\n            }\n          ]\n        },\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"gid=0\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1gZE7EbLJqfMzQlPoCgE0eeqee_F1Lh9eIwhHsVmYKdw/edit#gid=0\",\n          \"cachedResultName\": \"Sheet1\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"1gZE7EbLJqfMzQlPoCgE0eeqee_F1Lh9eIwhHsVmYKdw\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1gZE7EbLJqfMzQlPoCgE0eeqee_F1Lh9eIwhHsVmYKdw/edit?usp=drivesdk\",\n          \"cachedResultName\": \"Contacts Whitelist\"\n        }\n      },\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"63dUs6P8a2b5ed5J\",\n          \"name\": \"Google Sheets account\"\n        }\n      },\n      \"typeVersion\": 4.5,\n      \"alwaysOutputData\": false\n    },\n    {\n      \"id\": \"932afe12-3341-4f77-88ab-0b558e0d6ee2\",\n      \"name\": \"Search Company Folder1\",\n      \"type\": \"n8n-nodes-base.googleDrive\",\n      \"position\": [\n        -3440,\n        500\n      ],\n      \"parameters\": {\n        \"filter\": {\n          \"whatToSearch\": \"folders\"\n        },\n        \"options\": {},\n        \"resource\": \"fileFolder\",\n        \"queryString\": \"={{ $('Lookup in Sheets').item.json.company }}\"\n      },\n      \"credentials\": {\n        \"googleDriveOAuth2Api\": {\n          \"id\": \"VypmUgEf64twpmiZ\",\n          \"name\": \"Google Drive account\"\n        }\n      },\n      \"typeVersion\": 3,\n      \"alwaysOutputData\": true\n    },\n    {\n      \"id\": \"b9e66cf4-365a-4d11-bff9-48bf28be9e96\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -4740,\n        280\n      ],\n      \"parameters\": {\n        \"color\": 6,\n        \"width\": 560,\n        \"height\": 660,\n        \"content\": \"# 1. 触发设置与过滤器\\n\\n## 配置检查新邮件的间隔时间，并应用过滤器仅处理特定邮件\\n\\n**例如**：要创建一个为**含附件**且内容包含\\\"invoice\\\"或\\\"receipt\\\"字样的邮件添加标签的过滤器，请按以下步骤操作：\\n\\n1. 打开Gmail，点击搜索栏旁的汉堡菜单按钮展开搜索选项\\n2. 在`包含字词`字段输入'invoice receipt'\\n3. 勾选`包含附件`复选框\\n4. 点击搜索窗口底部的\\\"根据此搜索条件创建过滤器\\\"选项\\n5. 在过滤器设置中，选择\\\"应用标签\\\"选项并为此类邮件选择或创建标签\\n6. 点击\\\"创建过滤器\\\"保存新过滤器\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"2a932450-d0e9-44b4-adfb-2254b8e6e547\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -3000,\n        220\n      ],\n      \"parameters\": {\n        \"color\": 6,\n        \"height\": 540,\n        \"content\": \"# 3. 配置存储位置\\n## 通过`父文件夹`下拉菜单设置文件存储路径\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"247e4ed7-ebff-4392-adf2-4a63e80e04f4\",\n      \"name\": \"Upload To Folder\",\n      \"type\": \"n8n-nodes-base.googleDrive\",\n      \"position\": [\n        -1100,\n        480\n      ],\n      \"parameters\": {\n        \"name\": \"={{ Date.now();}}-{{ $('Loop Over Items').item.binary.data.fileName }} \",\n        \"driveId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"My Drive\",\n          \"cachedResultUrl\": \"https://drive.google.com/drive/my-drive\",\n          \"cachedResultName\": \"My Drive\"\n        },\n        \"options\": {\n          \"ocrLanguage\": \"en\",\n          \"propertiesUi\": {\n            \"propertyValues\": [\n              {\n                \"key\": \"sender\",\n                \"value\": \"={{ $('Gmail').item.json.from.value[0].address }}\"\n              },\n              {\n                \"key\": \"time_received\",\n                \"value\": \"={{ $('Gmail').item.json.date }}\"\n              }\n            ]\n          }\n        },\n        \"folderId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $('Search For Folder').first().json.id || $('Create Month Folder').item.json.id }}\"\n        },\n        \"inputDataFieldName\": \"=data\"\n      },\n      \"credentials\": {\n        \"googleDriveOAuth2Api\": {\n          \"id\": \"VypmUgEf64twpmiZ\",\n          \"name\": \"Google Drive account\"\n        }\n      },\n      \"typeVersion\": 3\n    }\n  ],\n  \"pinData\": {},\n  \"connections\": {\n    \"Gmail\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Split Up Binary Data1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"YYYY/MM\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Search For Folder\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Gmail Trigger\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Lookup in Sheets\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Loop Over Items\": {\n      \"main\": [\n        [],\n        [\n          {\n            \"node\": \"Upload To Folder\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Lookup in Sheets\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Search Company Folder1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Upload To Folder\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Loop Over Items\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Search For Folder\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Check If Folder Exists\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Create Month Folder\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Gmail\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Company Folder Exists\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"YYYY/MM\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Create Company Folder\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Create Company Folder\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"YYYY/MM\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Split Up Binary Data1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Loop Over Items\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Check If Folder Exists\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Gmail\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Create Month Folder\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Search Company Folder1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Company Folder Exists\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}