{
  "title": "Mark outdated workflow nodes on canvas and send a summary with Gmail (add-on)",
  "url": "https://n8n.io/workflows/2477-mark-outdated-workflow-nodes-on-canvas-and-send-a-summary-with-gmail-add-on/",
  "category": "Other",
  "category_url": "https://n8n.io/workflows/categories/other/?sort=createdAt:desc",
  "author": "Mario",
  "publish_date": "Last update 6 months ago",
  "publish_date_absolute": "2024-11-23",
  "content": "",
  "workflow_json": "{\"id\":\"xlMrGt0c1eFi4J1U\",\"meta\":{\"instanceId\":\"fb8bc2e315f7f03c97140b30aa454a27bc7883a19000fa1da6e6b571bf56ad6d\",\"templateCredsSetupCompleted\":true},\"name\":\"Addon for Workflow Nodes Update Check Template\",\"tags\":[],\"nodes\":[{\"id\":\"e8068a93-5474-474e-a48e-947269b7ca5f\",\"name\":\"Execute Workflow Trigger\",\"type\":\"n8n-nodes-base.executeWorkflowTrigger\",\"position\":[860,1140],\"parameters\":{},\"typeVersion\":1},{\"id\":\"9b4524d8-6ded-489b-bf45-6810f5306652\",\"name\":\"Sticky Note4\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[800,120],\"parameters\":{\"color\":5,\"width\":1316.8621045610755,\"height\":887.980239951363,\"content\":\"## Download the main workflow and connect it's output to this workflow\\n- Download this workflow and follow the belonging instructions: [https://n8n.io/workflows/2301-check-if-workflows-contain-build-in-nodes-that-are-not-of-the-latest-version/](https://n8n.io/workflows/2301-check-if-workflows-contain-build-in-nodes-that-are-not-of-the-latest-version/)\\n- Add an \\\"Execute Workflow\\\" node and configure it, so it calls this workflow.\\n  \\n![Image](https://i.imgur.com/y0vPhYz.png#full-width)\"},\"typeVersion\":1},{\"id\":\"cb0cacc1-34d0-4e4d-a7db-e44ece1a155f\",\"name\":\"Prepare Output\",\"type\":\"n8n-nodes-base.set\",\"position\":[2180,1140],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"26c2bf59-2051-47e3-a6bf-3896ad427404\",\"name\":\"name\",\"type\":\"string\",\"value\":\"=<a href={{ $('Settings').item.json.instanceBaseUrl }}/workflow/{{ $json.id }}>{{ $json.name }}</a>\"}]}},\"typeVersion\":3.4},{\"id\":\"4b914937-1cff-4fc2-886b-64ec6818daf3\",\"name\":\"Send Summary\",\"type\":\"n8n-nodes-base.gmail\",\"position\":[2400,1140],\"webhookId\":\"1ad759b3-f1cd-49dd-b288-e3344fa94c8a\",\"parameters\":{\"message\":\"=These workflows contain outdated nodes:<br>\\n<ul>\\n{{ $('Prepare Output').all().pluck('json').pluck('name').map(item => \\\"<li>\\\"+item+\\\"</li>\\\").join('') }}\\n</ul>\",\"options\":{\"appendAttribution\":false},\"subject\":\"Outdated n8n Workflow Nodes\"},\"credentials\":{\"gmailOAuth2\":{\"id\":\"TWM2BLjDHQtGAFQn\",\"name\":\"Gmail (octionicsolutions)\"}},\"executeOnce\":true,\"typeVersion\":2.1},{\"id\":\"2f259d45-cb31-4007-beb0-93123cc619c3\",\"name\":\"Get Workflow\",\"type\":\"n8n-nodes-base.n8n\",\"position\":[1520,1140],\"parameters\":{\"operation\":\"get\",\"workflowId\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"={{ $('Start Reference').item.json.Id }}\"},\"requestOptions\":{}},\"credentials\":{\"n8nApi\":{\"id\":\"fRyEJuhN9Nf3aQap\",\"name\":\"n8n account\"}},\"typeVersion\":1},{\"id\":\"e2bbfc5b-1af6-43b1-9d03-f35b5837d3cc\",\"name\":\"Update Workflow\",\"type\":\"n8n-nodes-base.n8n\",\"position\":[1960,1140],\"parameters\":{\"operation\":\"update\",\"workflowId\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"={{ $json.id }}\"},\"requestOptions\":{},\"workflowObject\":\"={{ JSON.stringify($json) }}\"},\"credentials\":{\"n8nApi\":{\"id\":\"fRyEJuhN9Nf3aQap\",\"name\":\"n8n account\"}},\"typeVersion\":1},{\"id\":\"f2bb0529-6e38-46c6-93e8-de76e9ecc31e\",\"name\":\"Modify Workflow (if required)\",\"type\":\"n8n-nodes-base.code\",\"position\":[1740,1140],\"parameters\":{\"mode\":\"runOnceForEachItem\",\"jsCode\":\"let symbol = $('Settings').item.json.symbol;\\nlet onlyMajorChanges = $('Settings').item.json.onlyMajorChanges;\\nlet addNodesToCanvas = $('Settings').item.json.addNodesToCanvas;\\n\\n// create shallow copy including nested objects\\nlet data = JSON.parse(JSON.stringify($json));\\n\\nchangeCount = 0;\\n// Loop through nodes and update the names\\nfor (let outdatedNode of $('Start Reference').item.json.outdated_nodes) {\\n  // skip minor changes, if settings require it\\n  if (onlyMajorChanges && outdatedNode.version.toString().substring(0, 1) == outdatedNode.latestVersion.toString().substring(0, 1)) {\\n    continue;\\n  }\\n  // update nodes, it they are not already renamed with symbol\\n  for (let existingNode of data.nodes) {\\n    if (outdatedNode.name == existingNode.name && !existingNode.name.startsWith(symbol) && existingNode.id) {\\n      // prepend new nodes, so they appear below outdated nodes on the canvas\\n      if (addNodesToCanvas) {\\n        let newNode = JSON.parse(JSON.stringify(existingNode));\\n        delete newNode.id;\\n        newNode.typeVersion = outdatedNode.latestVersion;\\n        newNode.position = [newNode.position[0] + 40, newNode.position[1] - 40];\\n        data.nodes.unshift(newNode);\\n      }\\n      // rename outdated nodes (prepend symbol)\\n      existingNode.name = symbol + \\\" \\\" + existingNode.name;\\n    \\n      // update connections\\n      for (let connectionKey in data.connections) {\\n        let connection = data.connections[connectionKey];\\n      \\n        // rename keys\\n        if (connectionKey == outdatedNode.name) {\\n          let newKey = symbol + \\\" \\\" + connectionKey;\\n          data.connections[newKey] = connection;\\n          delete data.connections[connectionKey];\\n        }\\n      \\n        // check the nested \\\"main\\\" array\\n        if (connection.main) {\\n          for (let mainArray of connection.main) {\\n            for (let nodeObj of mainArray) {\\n              if (nodeObj.node == outdatedNode.name) {\\n                nodeObj.node = symbol + \\\" \\\" + nodeObj.node;\\n              }\\n            }\\n          }\\n        }\\n      }\\n      changeCount++;\\n    }\\n  }\\n}\\n\\nif (changeCount == 0) {\\n  return null;\\n}\\n\\nreturn {\\n  id: data.id,\\n  name: data.name,\\n  nodes: data.nodes,\\n  connections: data.connections,\\n  settings: data.settings\\n}\"},\"typeVersion\":2},{\"id\":\"b4b7d328-8128-4f07-841a-1efa26c3fdd5\",\"name\":\"Start Reference\",\"type\":\"n8n-nodes-base.noOp\",\"position\":[1080,1140],\"parameters\":{},\"typeVersion\":1},{\"id\":\"7d80b557-15ac-479e-a219-dd254580a063\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[800,1020],\"parameters\":{\"color\":7,\"width\":216.6228464570463,\"height\":282.1449413577448,\"content\":\"This workflow is called by another workflow which provides a list of all workflows with major and minor node updates\"},\"typeVersion\":1},{\"id\":\"1becaab6-fe2a-44e9-bc7e-ce87665f25bd\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[2120,680],\"parameters\":{\"color\":7,\"width\":435.46822963832705,\"height\":327.68691689762716,\"content\":\"## Example input data\\n\\n```\\n[\\n  {\\n    \\\"workflow\\\": \\\"Workflow Nodes Update\\\",\\n    \\\"Id\\\": \\\"dFJpQTFg3QPH6Ol9\\\",\\n    \\\"outdated_nodes\\\": [\\n      {\\n        \\\"name\\\": \\\"If\\\",\\n        \\\"type\\\": \\\"n8n-nodes-base.if\\\",\\n        \\\"version\\\": 2,\\n        \\\"latestVersion\\\": 2.2\\n      }\\n    ]\\n  }\\n]\\n```\"},\"typeVersion\":1},{\"id\":\"9ce81677-4dd4-4a9a-a7a3-66b113c69de6\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1020,1020],\"parameters\":{\"color\":7,\"width\":216.6228464570463,\"height\":282.1449413577448,\"content\":\"The following nodes start referencing from here, so it is easily possible to change the logic prior to this node.\"},\"typeVersion\":1},{\"id\":\"f6e7e7ce-1282-4292-8675-ca8bbe215d5f\",\"name\":\"Sticky Note5\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1240,1020],\"parameters\":{\"width\":216.6228464570463,\"height\":282.1449413577448,\"content\":\"## Update settings\\nMinimum requirement:\\n- Set your instanceBaseUrl\"},\"typeVersion\":1},{\"id\":\"46b168d5-c866-497b-8664-92722a356feb\",\"name\":\"Settings\",\"type\":\"n8n-nodes-base.set\",\"position\":[1300,1140],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"99947a54-e9f9-4d04-b273-9d7eeed62775\",\"name\":\"instanceBaseUrl\",\"type\":\"string\",\"value\":\"http://localhost:5432\"},{\"id\":\"35a63bda-fcbb-4885-a8d6-4b52c6579206\",\"name\":\"symbol\",\"type\":\"string\",\"value\":\"⚠️\"},{\"id\":\"3481286b-359f-4e86-8f56-bdb267ebd6a2\",\"name\":\"onlyMajorChanges\",\"type\":\"boolean\",\"value\":true},{\"id\":\"2377c274-5501-494f-813e-0d3ebe47e375\",\"name\":\"addNodesToCanvas\",\"type\":\"boolean\",\"value\":true}]}},\"typeVersion\":3.4},{\"id\":\"d28ac933-7dbc-4039-821b-7cd4c4c5ec94\",\"name\":\"Sticky Note6\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[2120,1020],\"parameters\":{\"color\":7,\"width\":216.6228464570463,\"height\":282.1449413577448,\"content\":\"URL's are generated for each affected workflow\"},\"typeVersion\":1},{\"id\":\"0fef2be5-92d5-4d4f-8afc-b958ee616787\",\"name\":\"Sticky Note7\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[2340,1020],\"parameters\":{\"width\":216.6228464570463,\"height\":282.1449413577448,\"content\":\"## Setup Gmail\\nMinimum requirement:\\n- Update mail recipient\"},\"typeVersion\":1},{\"id\":\"dc940f78-1eff-4393-9d9a-f4afefe24d45\",\"name\":\"Sticky Note8\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1460,1020],\"parameters\":{\"color\":7,\"width\":657.2496253932529,\"height\":282.1449413577448,\"content\":\"Each workflow is being processed and modified if needed. Depending on the settings an icon is being prepended to the name of outdated nodes. In addition a newer version is being added close by, so it can be replaced quicker by the user.\"},\"typeVersion\":1}],\"active\":false,\"pinData\":{},\"settings\":{\"executionOrder\":\"v1\"},\"versionId\":\"f4bb34b0-7561-4d77-beac-8f6988a0ed64\",\"connections\":{\"Settings\":{\"main\":[[{\"node\":\"Get Workflow\",\"type\":\"main\",\"index\":0}]]},\"Get Workflow\":{\"main\":[[{\"node\":\"Modify Workflow (if required)\",\"type\":\"main\",\"index\":0}]]},\"Prepare Output\":{\"main\":[[{\"node\":\"Send Summary\",\"type\":\"main\",\"index\":0}]]},\"Start Reference\":{\"main\":[[{\"node\":\"Settings\",\"type\":\"main\",\"index\":0}]]},\"Update Workflow\":{\"main\":[[{\"node\":\"Prepare Output\",\"type\":\"main\",\"index\":0}]]},\"Execute Workflow Trigger\":{\"main\":[[{\"node\":\"Start Reference\",\"type\":\"main\",\"index\":0}]]},\"Modify Workflow (if required)\":{\"main\":[[{\"node\":\"Update Workflow\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "This is an **add-on** for the template [Check if workflows contain build-in nodes that are not of the latest version](https://n8n.io/workflows/2301-check-if-workflows-contain-build-in-nodes-that-are-not-of-the-latest-version/)\n\n## Purpose\n\nThis workflow highlights outdated nodes within all workflows of a single n8n instance and places an updated preconfigured node right next to it, so it can be swapped easily.\n\n![Image](https://i.imgur.com/yRI0adF.png)\n\n## How it works\n\n  * The parent workflow checks the entire n8n instance for outdated nodes within all workflows and passes a list of those alongside some metadata to this workflow\n  * This workflow then processes that data and updates the affected workflows\n  * Outdated nodes are renamed by prepending an emoji (default: ⚠️) - this is also used for future checks to prevent from double-processing\n  * The latest version of each outdated node is added to the workflow canvas (not wired up) behind the old one, slightly shifted in position\n  * An Email is sent with a list of modified workflows\n\n\n\nIn the settings it is possible to define:\n\n  * which symbol/emoji should be prepended to outdated notes\n  * whether to include only major node updates or all of them\n  * whether to add the new nodes to the canvas or not\n\n\n\n## Setup\n\n  * Clone this template to your n8n instance\n  * Update the Settings node by setting at least the base URL of your n8n instance\n  * Set a recipient in the Gmail node\n  * Clone the [parent template](https://n8n.io/workflows/2301-check-if-workflows-contain-build-in-nodes-that-are-not-of-the-latest-version/) to your n8n instance and configure it as described in it’s description\n  * Add an “Execute Workflow” node to the end of the parent workflow and configure it, so it calls this workflow\n\n\n\n## How to use\n\nExecute the parent workflow and check your Email Inbox.\n\nAll linked workflows should contain one or more updated nodes with an emoji prepended to their names.\n\n## Disclaimer\n\n  * Beware, that major updates can cause migrations of nodes to fail, since their structure can differ. So always compare the old nodes with the newly created, if all parameters still meet the requirements.\n\n  * Be careful when executing this workflow on a production environment, since it directly modifies your workflows. It is advisable to run this on your testing environment and migrate successfully tested workflows to your production environment using git or manually.\n\n\n\n",
  "readme_html": "<!--[--><div data-v-50766329=\"\"><p>This is an <strong>add-on</strong> for the template <a href=\"https://n8n.io/workflows/2301-check-if-workflows-contain-build-in-nodes-that-are-not-of-the-latest-version/\" rel=\"ugc nofollow\" target=\"_blank\">Check if workflows contain build-in nodes that are not of the latest version</a></p>\n<h2>Purpose</h2>\n<p>This workflow highlights outdated nodes within all workflows of a single n8n instance and places an updated preconfigured node right next to it, so it can be swapped easily.</p>\n<p><img src=\"https://i.imgur.com/yRI0adF.png\" alt=\"Image\"></p>\n<h2>How it works</h2>\n<ul>\n<li>The parent workflow checks the entire n8n instance for outdated nodes within all workflows and passes a list of those alongside some metadata to this workflow</li>\n<li>This workflow then processes that data and updates the affected workflows</li>\n<li>Outdated nodes are renamed by prepending an emoji (default: ⚠️) - this is also used for future checks to prevent from double-processing</li>\n<li>The latest version of each outdated node is added to the workflow canvas (not wired up) behind the old one, slightly shifted in position</li>\n<li>An Email is sent with a list of modified workflows</li>\n</ul>\n<p>In the settings it is possible to define:</p>\n<ul>\n<li>which symbol/emoji should be prepended to outdated notes</li>\n<li>whether to include only major node updates or all of them</li>\n<li>whether to add the new nodes to the canvas or not</li>\n</ul>\n<h2>Setup</h2>\n<ul>\n<li>Clone this template to your n8n instance</li>\n<li>Update the Settings node by setting at least the base URL of your n8n instance</li>\n<li>Set a recipient in the Gmail node</li>\n<li>Clone the <a href=\"https://n8n.io/workflows/2301-check-if-workflows-contain-build-in-nodes-that-are-not-of-the-latest-version/\" rel=\"ugc nofollow\" target=\"_blank\">parent template</a> to your n8n instance and configure it as described in it’s description</li>\n<li>Add an “Execute Workflow” node to the end of the parent workflow and configure it, so it calls this workflow</li>\n</ul>\n<h2>How to use</h2>\n<p>Execute the parent workflow and check your Email Inbox.</p>\n<p>All linked workflows should contain one or more updated nodes with an emoji prepended to their names.</p>\n<h2>Disclaimer</h2>\n<ul>\n<li>\n<p>Beware, that major updates can cause migrations of nodes to fail, since their structure can differ. So always compare the old nodes with the newly created, if all parameters still meet the requirements.</p>\n</li>\n<li>\n<p>Be careful when executing this workflow on a production environment, since it directly modifies your workflows. It is advisable to run this on your testing environment and migrate successfully tested workflows to your production environment using git or manually.</p>\n</li>\n</ul>\n</div><!--]-->",
  "readme_zh": "这是针对模板[检查工作流中是否包含非最新版本的内置节点](https://n8n.io/workflows/2301-check-if-workflows-contain-build-in-nodes-that-are-not-of-the-latest-version/)的**扩展插件**\n\n## 功能说明\n\n该工作流会高亮显示单个n8n实例中所有工作流内的过时节点，并在其旁边放置一个预先配置好的更新节点，便于快速替换。\n\n![图示](https://i.imgur.com/yRI0adF.png)\n\n## 运行原理\n\n  * 父工作流会检查整个n8n实例中所有工作流内的过时节点，并将这些节点列表及相关元数据传递给本工作流\n  * 本工作流处理数据并更新受影响的工作流\n  * 过时节点会通过添加前缀符号（默认⚠️）进行重命名——该标记也用于后续检查以防止重复处理\n  * 每个过时节点的最新版本会被添加到工作流画布（未连线），以略微偏移的位置显示在旧节点后方\n  * 系统将发送邮件列出所有被修改的工作流",
  "title_zh": "在画布上标记过时的工作流节点并通过Gmail（插件）发送摘要",
  "publish_date_zh": "最后更新于6个月前",
  "workflow_json_zh": "{\n  \"id\": \"xlMrGt0c1eFi4J1U\",\n  \"meta\": {\n    \"instanceId\": \"fb8bc2e315f7f03c97140b30aa454a27bc7883a19000fa1da6e6b571bf56ad6d\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"name\": \"Addon for Workflow Nodes Update Check Template\",\n  \"tags\": [],\n  \"nodes\": [\n    {\n      \"id\": \"e8068a93-5474-474e-a48e-947269b7ca5f\",\n      \"name\": \"Execute Workflow Trigger\",\n      \"type\": \"n8n-nodes-base.executeWorkflowTrigger\",\n      \"position\": [\n        860,\n        1140\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"9b4524d8-6ded-489b-bf45-6810f5306652\",\n      \"name\": \"Sticky Note4\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        800,\n        120\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 1316.8621045610755,\n        \"height\": 887.980239951363,\n        \"content\": \"## 下载主工作流并将其输出连接至本工作流\\n- 下载此工作流并按照附属说明操作：[https://n8n.io/workflows/2301-check-if-workflows-contain-build-in-nodes-that-are-not-of-the-latest-version/](https://n8n.io/workflows/2301-check-if-workflows-contain-build-in-nodes-that-are-not-of-the-latest-version/)\\n- 添加一个\\\"执行工作流\\\"节点并配置，使其调用本工作流。\\n\\n![图片](https://i.imgur.com/y0vPhYz.png#full-width)\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"cb0cacc1-34d0-4e4d-a7db-e44ece1a155f\",\n      \"name\": \"Prepare Output\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        2180,\n        1140\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"26c2bf59-2051-47e3-a6bf-3896ad427404\",\n              \"name\": \"name\",\n              \"type\": \"string\",\n              \"value\": \"=<a href={{ $('Settings').item.json.instanceBaseUrl }}/workflow/{{ $json.id }}>{{ $json.name }}</a>\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"4b914937-1cff-4fc2-886b-64ec6818daf3\",\n      \"name\": \"Send Summary\",\n      \"type\": \"n8n-nodes-base.gmail\",\n      \"position\": [\n        2400,\n        1140\n      ],\n      \"webhookId\": \"1ad759b3-f1cd-49dd-b288-e3344fa94c8a\",\n      \"parameters\": {\n        \"message\": \"=These workflows contain outdated nodes:<br>\\n<ul>\\n{{ $('Prepare Output').all().pluck('json').pluck('name').map(item => \\\"<li>\\\"+item+\\\"</li>\\\").join('') }}\\n</ul>\",\n        \"options\": {\n          \"appendAttribution\": false\n        },\n        \"subject\": \"Outdated n8n Workflow Nodes\"\n      },\n      \"credentials\": {\n        \"gmailOAuth2\": {\n          \"id\": \"TWM2BLjDHQtGAFQn\",\n          \"name\": \"Gmail (octionicsolutions)\"\n        }\n      },\n      \"executeOnce\": true,\n      \"typeVersion\": 2.1\n    },\n    {\n      \"id\": \"2f259d45-cb31-4007-beb0-93123cc619c3\",\n      \"name\": \"Get Workflow\",\n      \"type\": \"n8n-nodes-base.n8n\",\n      \"position\": [\n        1520,\n        1140\n      ],\n      \"parameters\": {\n        \"operation\": \"get\",\n        \"workflowId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $('Start Reference').item.json.Id }}\"\n        },\n        \"requestOptions\": {}\n      },\n      \"credentials\": {\n        \"n8nApi\": {\n          \"id\": \"fRyEJuhN9Nf3aQap\",\n          \"name\": \"n8n account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"e2bbfc5b-1af6-43b1-9d03-f35b5837d3cc\",\n      \"name\": \"Update Workflow\",\n      \"type\": \"n8n-nodes-base.n8n\",\n      \"position\": [\n        1960,\n        1140\n      ],\n      \"parameters\": {\n        \"operation\": \"update\",\n        \"workflowId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $json.id }}\"\n        },\n        \"requestOptions\": {},\n        \"workflowObject\": \"={{ JSON.stringify($json) }}\"\n      },\n      \"credentials\": {\n        \"n8nApi\": {\n          \"id\": \"fRyEJuhN9Nf3aQap\",\n          \"name\": \"n8n account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"f2bb0529-6e38-46c6-93e8-de76e9ecc31e\",\n      \"name\": \"Modify Workflow (if required)\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        1740,\n        1140\n      ],\n      \"parameters\": {\n        \"mode\": \"runOnceForEachItem\",\n        \"jsCode\": \"let symbol = $('Settings').item.json.symbol;\\nlet onlyMajorChanges = $('Settings').item.json.onlyMajorChanges;\\nlet addNodesToCanvas = $('Settings').item.json.addNodesToCanvas;\\n\\n// create shallow copy including nested objects\\nlet data = JSON.parse(JSON.stringify($json));\\n\\nchangeCount = 0;\\n// Loop through nodes and update the names\\nfor (let outdatedNode of $('Start Reference').item.json.outdated_nodes) {\\n  // skip minor changes, if settings require it\\n  if (onlyMajorChanges && outdatedNode.version.toString().substring(0, 1) == outdatedNode.latestVersion.toString().substring(0, 1)) {\\n    continue;\\n  }\\n  // update nodes, it they are not already renamed with symbol\\n  for (let existingNode of data.nodes) {\\n    if (outdatedNode.name == existingNode.name && !existingNode.name.startsWith(symbol) && existingNode.id) {\\n      // prepend new nodes, so they appear below outdated nodes on the canvas\\n      if (addNodesToCanvas) {\\n        let newNode = JSON.parse(JSON.stringify(existingNode));\\n        delete newNode.id;\\n        newNode.typeVersion = outdatedNode.latestVersion;\\n        newNode.position = [newNode.position[0] + 40, newNode.position[1] - 40];\\n        data.nodes.unshift(newNode);\\n      }\\n      // rename outdated nodes (prepend symbol)\\n      existingNode.name = symbol + \\\" \\\" + existingNode.name;\\n    \\n      // update connections\\n      for (let connectionKey in data.connections) {\\n        let connection = data.connections[connectionKey];\\n      \\n        // rename keys\\n        if (connectionKey == outdatedNode.name) {\\n          let newKey = symbol + \\\" \\\" + connectionKey;\\n          data.connections[newKey] = connection;\\n          delete data.connections[connectionKey];\\n        }\\n      \\n        // check the nested \\\"main\\\" array\\n        if (connection.main) {\\n          for (let mainArray of connection.main) {\\n            for (let nodeObj of mainArray) {\\n              if (nodeObj.node == outdatedNode.name) {\\n                nodeObj.node = symbol + \\\" \\\" + nodeObj.node;\\n              }\\n            }\\n          }\\n        }\\n      }\\n      changeCount++;\\n    }\\n  }\\n}\\n\\nif (changeCount == 0) {\\n  return null;\\n}\\n\\nreturn {\\n  id: data.id,\\n  name: data.name,\\n  nodes: data.nodes,\\n  connections: data.connections,\\n  settings: data.settings\\n}\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"b4b7d328-8128-4f07-841a-1efa26c3fdd5\",\n      \"name\": \"Start Reference\",\n      \"type\": \"n8n-nodes-base.noOp\",\n      \"position\": [\n        1080,\n        1140\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"7d80b557-15ac-479e-a219-dd254580a063\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        800,\n        1020\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 216.6228464570463,\n        \"height\": 282.1449413577448,\n        \"content\": \"该工作流由另一个工作流调用，后者提供包含主节点和次节点更新的所有工作流列表。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"1becaab6-fe2a-44e9-bc7e-ce87665f25bd\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        2120,\n        680\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 435.46822963832705,\n        \"height\": 327.68691689762716,\n        \"content\": \"## 示例输入数据\\n\\n```\\n[\\n  {\\n    \\\"工作流\\\": \\\"工作流节点更新\\\",\\n    \\\"标识号\\\": \\\"dFJpQTFg3QPH6Ol9\\\",\\n    \\\"过时节点\\\": [\\n      {\\n        \\\"名称\\\": \\\"条件判断\\\",\\n        \\\"类型\\\": \\\"n8n-nodes-base.if\\\",\\n        \\\"当前版本\\\": 2,\\n        \\\"最新版本\\\": 2.2\\n      }\\n    ]\\n  }\\n]\\n```\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"9ce81677-4dd4-4a9a-a7a3-66b113c69de6\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1020,\n        1020\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 216.6228464570463,\n        \"height\": 282.1449413577448,\n        \"content\": \"以下节点从此处开始引用，因此可以轻松更改此节点之前的逻辑。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"f6e7e7ce-1282-4292-8675-ca8bbe215d5f\",\n      \"name\": \"Sticky Note5\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1240,\n        1020\n      ],\n      \"parameters\": {\n        \"width\": 216.6228464570463,\n        \"height\": 282.1449413577448,\n        \"content\": \"## 更新设置\\n最低要求：\\n- 设置您的instanceBaseUrl\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"46b168d5-c866-497b-8664-92722a356feb\",\n      \"name\": \"Settings\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1300,\n        1140\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"99947a54-e9f9-4d04-b273-9d7eeed62775\",\n              \"name\": \"instanceBaseUrl\",\n              \"type\": \"string\",\n              \"value\": \"http://localhost:5432\"\n            },\n            {\n              \"id\": \"35a63bda-fcbb-4885-a8d6-4b52c6579206\",\n              \"name\": \"symbol\",\n              \"type\": \"string\",\n              \"value\": \"⚠️\"\n            },\n            {\n              \"id\": \"3481286b-359f-4e86-8f56-bdb267ebd6a2\",\n              \"name\": \"onlyMajorChanges\",\n              \"type\": \"boolean\",\n              \"value\": true\n            },\n            {\n              \"id\": \"2377c274-5501-494f-813e-0d3ebe47e375\",\n              \"name\": \"addNodesToCanvas\",\n              \"type\": \"boolean\",\n              \"value\": true\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"d28ac933-7dbc-4039-821b-7cd4c4c5ec94\",\n      \"name\": \"Sticky Note6\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        2120,\n        1020\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 216.6228464570463,\n        \"height\": 282.1449413577448,\n        \"content\": \"为每个受影响的工作流程生成URL\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"0fef2be5-92d5-4d4f-8afc-b958ee616787\",\n      \"name\": \"Sticky Note7\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        2340,\n        1020\n      ],\n      \"parameters\": {\n        \"width\": 216.6228464570463,\n        \"height\": 282.1449413577448,\n        \"content\": \"## 设置Gmail\\n最低要求：\\n- 更新邮件收件人\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"dc940f78-1eff-4393-9d9a-f4afefe24d45\",\n      \"name\": \"Sticky Note8\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1460,\n        1020\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 657.2496253932529,\n        \"height\": 282.1449413577448,\n        \"content\": \"每个工作流程都在进行处理，并在必要时进行修改。根据设置，系统会在过时节点的名称前添加一个图标。此外，附近还会添加一个较新版本，以便用户能更快地进行替换。\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"active\": false,\n  \"pinData\": {},\n  \"settings\": {\n    \"executionOrder\": \"v1\"\n  },\n  \"versionId\": \"f4bb34b0-7561-4d77-beac-8f6988a0ed64\",\n  \"connections\": {\n    \"Settings\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get Workflow\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get Workflow\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Modify Workflow (if required)\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Prepare Output\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Send Summary\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Start Reference\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Settings\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Update Workflow\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Prepare Output\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Execute Workflow Trigger\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Start Reference\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Modify Workflow (if required)\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Update Workflow\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}