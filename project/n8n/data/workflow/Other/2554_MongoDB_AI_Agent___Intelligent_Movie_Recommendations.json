{
  "title": "MongoDB AI Agent - Intelligent Movie Recommendations",
  "url": "https://n8n.io/workflows/2554-mongodb-ai-agent-intelligent-movie-recommendations/",
  "category": "Other",
  "category_url": "https://n8n.io/workflows/categories/other/?sort=createdAt:desc",
  "author": "Pavel Duchovny",
  "publish_date": "Last update 6 months ago",
  "publish_date_absolute": "",
  "content": "",
  "workflow_json": "{\"id\":\"22PddLUgcjSJbT1w\",\"meta\":{\"instanceId\":\"fa7d5e2425ec76075df7100dbafffed91cc6f71f12fe92614bf78af63c54a61d\",\"templateCredsSetupCompleted\":true},\"name\":\"MongoDB Agent\",\"tags\":[],\"nodes\":[{\"id\":\"d8c07efe-eca0-48cb-80e6-ea8117073c5f\",\"name\":\"OpenAI Chat Model\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\"position\":[1300,560],\"parameters\":{\"options\":{}},\"credentials\":{\"openAiApi\":{\"id\":\"TreGPMKr9hrtCvVp\",\"name\":\"OpenAi account\"}},\"typeVersion\":1},{\"id\":\"636de178-7b68-429a-9371-41cf2a950076\",\"name\":\"MongoDBAggregate\",\"type\":\"n8n-nodes-base.mongoDbTool\",\"position\":[1640,540],\"parameters\":{\"query\":\"={{   $fromAI(\\\"pipeline\\\", \\\"The MongoDB pipeline to execute\\\" , \\\"string\\\" , [{\\\"$match\\\" : { \\\"rating\\\" : 5 }  }])}}\",\"operation\":\"aggregate\",\"collection\":\"movies\",\"descriptionType\":\"manual\",\"toolDescription\":\"Get from AI the MongoDB Aggregation pipeline to get context based on the provided pipeline, the document structure of the documents is : {\\n  \\\"plot\\\": \\\"A group of bandits stage a brazen train hold-up, only to find a determined posse hot on their heels.\\\",\\n  \\\"genres\\\": [\\n    \\\"Short\\\",\\n    \\\"Western\\\"\\n  ],\\n  \\\"runtime\\\": 11,\\n  \\\"cast\\\": [\\n    \\\"A.C. Abadie\\\",\\n    \\\"Gilbert M. 'Broncho Billy' Anderson\\\",\\n    ...\\n  ],\\n  \\\"poster\\\": \\\"...jpg\\\",\\n  \\\"title\\\": \\\"The Great Train Robbery\\\",\\n  \\\"fullplot\\\": \\\"Among the earliest existing films in American cinema - notable as the ...\\\",\\n  \\\"languages\\\": [\\n    \\\"English\\\"\\n  ],\\n  \\\"released\\\": \\\"date\\\"\\n  },\\n  \\\"directors\\\": [\\n    \\\"Edwin S. Porter\\\"\\n  ],\\n  \\\"rated\\\": \\\"TV-G\\\",\\n  \\\"awards\\\": {\\n    \\\"wins\\\": 1,\\n    \\\"nominations\\\": 0,\\n    \\\"text\\\": \\\"1 win.\\\"\\n  },\\n  \\\"lastupdated\\\": \\\"2015-08-13 00:27:59.177000000\\\",\\n  \\\"year\\\": 1903,\\n  \\\"imdb\\\": {\\n    \\\"rating\\\": 7.4,\"},\"credentials\":{\"mongoDb\":{\"id\":\"8xGgiXzf2o0L4a0y\",\"name\":\"MongoDB account\"}},\"typeVersion\":1.1},{\"id\":\"e0f248dc-22b7-40a2-a00e-6298b51e4470\",\"name\":\"Window Buffer Memory\",\"type\":\"@n8n/n8n-nodes-langchain.memoryBufferWindow\",\"position\":[1500,540],\"parameters\":{\"contextWindowLength\":10},\"typeVersion\":1.2},{\"id\":\"da27ee52-43db-4818-9844-3c0a064bf958\",\"name\":\"When chat message received\",\"type\":\"@n8n/n8n-nodes-langchain.chatTrigger\",\"position\":[1160,400],\"webhookId\":\"0730df2d-2f90-45e0-83dc-609668260fda\",\"parameters\":{\"mode\":\"webhook\",\"public\":true,\"options\":{\"allowedOrigins\":\"*\"}},\"typeVersion\":1.1},{\"id\":\"9ad79da9-3145-44be-9026-e37b0e856f5d\",\"name\":\"insertFavorite\",\"type\":\"@n8n/n8n-nodes-langchain.toolWorkflow\",\"position\":[1860,520],\"parameters\":{\"name\":\"insertFavorites\",\"workflowId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"6QuKnOrpusQVu66Q\",\"cachedResultName\":\"insertMongoDB\"},\"description\":\"=Use this tool only to add favorites with the structure of {\\\"title\\\"  : \\\"recieved title\\\"  }\"},\"typeVersion\":1.2},{\"id\":\"4d7713d1-d2ad-48bf-971b-b86195e161ca\",\"name\":\"AI Agent - Movie Recommendation\",\"type\":\"@n8n/n8n-nodes-langchain.agent\",\"position\":[1380,300],\"parameters\":{\"text\":\"=Assistant for best movies context, you have tools to search using \\\"MongoDBAggregate\\\" and you need to provide a MongoDB aggregation pipeline code array as a \\\"query\\\" input param. User input and request: {{ $json.chatInput }}. Only when a user confirms a favorite movie use the insert favorite using the \\\"insertFavorite\\\" workflow tool of to insertFavorite as { \\\"title\\\" : \\\"<TITLE>\\\" }.\",\"options\":{},\"promptType\":\"define\"},\"typeVersion\":1.7},{\"id\":\"2eac8aed-9677-4d89-bd76-456637f5b979\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[880,300],\"parameters\":{\"width\":216.0875923062025,\"height\":499.89779507612025,\"content\":\"## AI Agent powered by OpenAI and MongoDB \\n\\nThis flow is designed to work as an AI autonomous agent that can get chat messages, query data from MongoDB using the aggregation framework.\\n\\nFollowing by augmenting the results from the sample movies collection and allowing storing my favorite movies back to the database using an \\\"insert\\\" flow. \"},\"typeVersion\":1},{\"id\":\"4d8130fe-4aed-4e09-9c1d-60fb9ac1a500\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1300,720],\"parameters\":{\"content\":\"## Process\\n\\nThe message is being processed by the \\\"Chat Model\\\" and the correct tool is used according to the message. \"},\"typeVersion\":1}],\"active\":true,\"pinData\":{},\"settings\":{\"executionOrder\":\"v1\"},\"versionId\":\"879aab24-6346-435f-8fd4-3fca856ba64c\",\"connections\":{\"insertFavorite\":{\"ai_tool\":[[{\"node\":\"AI Agent - Movie Recommendation\",\"type\":\"ai_tool\",\"index\":0}]]},\"MongoDBAggregate\":{\"ai_tool\":[[{\"node\":\"AI Agent - Movie Recommendation\",\"type\":\"ai_tool\",\"index\":0}]]},\"OpenAI Chat Model\":{\"ai_languageModel\":[[{\"node\":\"AI Agent - Movie Recommendation\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"Window Buffer Memory\":{\"ai_memory\":[[{\"node\":\"AI Agent - Movie Recommendation\",\"type\":\"ai_memory\",\"index\":0}]]},\"When chat message received\":{\"main\":[[{\"node\":\"AI Agent - Movie Recommendation\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "## Who is this for?\n\nThis workflow is designed for:\n\n  * Database administrators and developers working with MongoDB\n  * Content managers handling movie databases\n  * Organizations looking to implement AI-powered search and recommendation systems\n  * Developers interested in combining LangChain, OpenAI, and MongoDB capabilities\n\n\n\n## What problem does this workflow solve?\n\nTraditional database queries can be complex and require specific MongoDB syntax knowledge. This workflow addresses:\n\n  * The complexity of writing MongoDB aggregation pipelines\n  * The need for natural language interaction with movie databases\n  * The challenge of maintaining user preferences and favorites\n  * The gap between AI language models and database operations\n\n\n\n## What this workflow does\n\nThis workflow creates an intelligent agent that:\n\n  1. Accepts natural language queries about movies\n  2. Translates user requests into MongoDB aggregation pipelines\n  3. Queries a movie database containing detailed information including: \n     * Plot summaries\n     * Genre classifications\n     * Cast and director information\n     * Runtime and release dates\n     * Ratings and awards\n  4. Provides contextual responses using OpenAI's language model\n  5. Allows users to save favorite movies to the database\n  6. Maintains conversation context using a window buffer memory\n\n\n\n## Setup\n\n  1. **Required Credentials** :\n\n     * OpenAI API credentials\n     * MongoDB connection details\n  2. **Node Configuration** :\n\n     * Configure the MongoDB connection in the MongoDBAggregate node\n     * Set up the OpenAI Chat Model with your API key\n     * Ensure the webhook trigger is properly configured for receiving chat messages\n  3. **Database Requirements** :\n\n     * A MongoDB collection named \"movies\" with the specified document structure\n     * Proper indexes for efficient querying\n     * Appropriate user permissions for read/write operations\n\n\n\n## How to customize this workflow\n\n  1. **Modify the Document Structure** :\n\n     * Update the tool description in the MongoDBAggregate node to match your collection schema\n     * Adjust the aggregation pipeline templates for your specific use case\n  2. **Enhance the AI Agent** :\n\n     * Customize the prompt in the \"AI Agent - Movie Recommendation\" node\n     * Modify the window buffer memory size based on your context needs\n     * Add additional tools for more functionality\n  3. **Extend Functionality** :\n\n     * Add more MongoDB operations beyond aggregation\n     * Implement additional workflows for different types of queries\n     * Create custom error handling and validation\n     * Add user authentication and rate limiting\n  4. **Integration Options** :\n\n     * Connect to external APIs for additional movie data\n     * Add webhook endpoints for different platforms\n     * Implement caching mechanisms for frequent queries\n     * Add data transformation nodes for specific output formats\n\n\n\nThis workflow serves as a foundation that can be adapted to various use cases beyond movie recommendations, such as e-commerce product search, content management systems, or any scenario requiring intelligent database interaction.\n",
  "readme_html": "<!--[--><div data-v-50766329=\"\"><h2>Who is this for?</h2>\n<p>This workflow is designed for:</p>\n<ul>\n<li>Database administrators and developers working with MongoDB</li>\n<li>Content managers handling movie databases</li>\n<li>Organizations looking to implement AI-powered search and recommendation systems</li>\n<li>Developers interested in combining LangChain, OpenAI, and MongoDB capabilities</li>\n</ul>\n<h2>What problem does this workflow solve?</h2>\n<p>Traditional database queries can be complex and require specific MongoDB syntax knowledge. This workflow addresses:</p>\n<ul>\n<li>The complexity of writing MongoDB aggregation pipelines</li>\n<li>The need for natural language interaction with movie databases</li>\n<li>The challenge of maintaining user preferences and favorites</li>\n<li>The gap between AI language models and database operations</li>\n</ul>\n<h2>What this workflow does</h2>\n<p>This workflow creates an intelligent agent that:</p>\n<ol>\n<li>Accepts natural language queries about movies</li>\n<li>Translates user requests into MongoDB aggregation pipelines</li>\n<li>Queries a movie database containing detailed information including:\n<ul>\n<li>Plot summaries</li>\n<li>Genre classifications</li>\n<li>Cast and director information</li>\n<li>Runtime and release dates</li>\n<li>Ratings and awards</li>\n</ul>\n</li>\n<li>Provides contextual responses using OpenAI's language model</li>\n<li>Allows users to save favorite movies to the database</li>\n<li>Maintains conversation context using a window buffer memory</li>\n</ol>\n<h2>Setup</h2>\n<ol>\n<li>\n<p><strong>Required Credentials</strong>:</p>\n<ul>\n<li>OpenAI API credentials</li>\n<li>MongoDB connection details</li>\n</ul>\n</li>\n<li>\n<p><strong>Node Configuration</strong>:</p>\n<ul>\n<li>Configure the MongoDB connection in the MongoDBAggregate node</li>\n<li>Set up the OpenAI Chat Model with your API key</li>\n<li>Ensure the webhook trigger is properly configured for receiving chat messages</li>\n</ul>\n</li>\n<li>\n<p><strong>Database Requirements</strong>:</p>\n<ul>\n<li>A MongoDB collection named \"movies\" with the specified document structure</li>\n<li>Proper indexes for efficient querying</li>\n<li>Appropriate user permissions for read/write operations</li>\n</ul>\n</li>\n</ol>\n<h2>How to customize this workflow</h2>\n<ol>\n<li>\n<p><strong>Modify the Document Structure</strong>:</p>\n<ul>\n<li>Update the tool description in the MongoDBAggregate node to match your collection schema</li>\n<li>Adjust the aggregation pipeline templates for your specific use case</li>\n</ul>\n</li>\n<li>\n<p><strong>Enhance the AI Agent</strong>:</p>\n<ul>\n<li>Customize the prompt in the \"AI Agent - Movie Recommendation\" node</li>\n<li>Modify the window buffer memory size based on your context needs</li>\n<li>Add additional tools for more functionality</li>\n</ul>\n</li>\n<li>\n<p><strong>Extend Functionality</strong>:</p>\n<ul>\n<li>Add more MongoDB operations beyond aggregation</li>\n<li>Implement additional workflows for different types of queries</li>\n<li>Create custom error handling and validation</li>\n<li>Add user authentication and rate limiting</li>\n</ul>\n</li>\n<li>\n<p><strong>Integration Options</strong>:</p>\n<ul>\n<li>Connect to external APIs for additional movie data</li>\n<li>Add webhook endpoints for different platforms</li>\n<li>Implement caching mechanisms for frequent queries</li>\n<li>Add data transformation nodes for specific output formats</li>\n</ul>\n</li>\n</ol>\n<p>This workflow serves as a foundation that can be adapted to various use cases beyond movie recommendations, such as e-commerce product search, content management systems, or any scenario requiring intelligent database interaction.</p>\n</div><!--]-->"
}