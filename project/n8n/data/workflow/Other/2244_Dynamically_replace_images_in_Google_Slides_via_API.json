{
  "title": "Dynamically replace images in Google Slides via API",
  "url": "https://n8n.io/workflows/2244-dynamically-replace-images-in-google-slides-via-api/",
  "category": "Other",
  "category_url": "https://n8n.io/workflows/categories/other/?sort=createdAt:desc",
  "author": "Emmanuel Bernard",
  "publish_date": "Last update 5 months ago",
  "publish_date_absolute": "2024-12-23",
  "content": "",
  "workflow_json": "{\"nodes\":[{\"id\":\"aea55995-2c2c-4f59-8b68-43fa1871bb4c\",\"name\":\"Replace Images\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[860,140],\"parameters\":{\"url\":\"=https://slides.googleapis.com/v1/presentations/{{ $('Webhook').item.json[\\\"body\\\"][\\\"presentation_id\\\"] }}:batchUpdate \",\"method\":\"POST\",\"options\":{},\"jsonBody\":\"={\\n  \\\"requests\\\": [\\n    {\\n        \\\"replaceImage\\\": {\\n          \\\"imageObjectId\\\": \\\"{{ $json.objectId }}\\\",\\n          \\\"url\\\": \\\"{{ $('Webhook').item.json[\\\"body\\\"][\\\"image_url\\\"] }}\\\",\\n          \\\"imageReplaceMethod\\\": \\\"CENTER_CROP\\\"\\n        }\\n    },\\n    {\\n      \\\"updatePageElementAltText\\\": {\\n        \\\"objectId\\\": \\\"{{ $json.objectId }}\\\",\\n        \\\"description\\\": \\\"{{ $('Webhook').item.json[\\\"body\\\"][\\\"image_key\\\"] }}\\\"\\n      }\\n    }\\n  ]\\n}  \\n   \",\"sendBody\":true,\"specifyBody\":\"json\",\"authentication\":\"predefinedCredentialType\",\"nodeCredentialType\":\"googleSlidesOAuth2Api\"},\"credentials\":{\"googleSlidesOAuth2Api\":{\"id\":\"XnM5YeAtI5QnYrMh\",\"name\":\"Google Slides account\"}},\"typeVersion\":4.2},{\"id\":\"92eeca3a-47b2-4daa-ac51-5b957c8d7d56\",\"name\":\"Error Missing Fields\",\"type\":\"n8n-nodes-base.respondToWebhook\",\"position\":[500,340],\"parameters\":{\"options\":{\"responseCode\":500},\"respondWith\":\"json\",\"responseBody\":\"{\\n  \\\"error\\\": \\\"Missing fields.\\\"\\n}\"},\"typeVersion\":1.1},{\"id\":\"14878542-6a42-4fe4-8dd6-328450a883eb\",\"name\":\"Respond to Webhook\",\"type\":\"n8n-nodes-base.respondToWebhook\",\"position\":[1040,140],\"parameters\":{\"options\":{},\"respondWith\":\"json\",\"responseBody\":\"{\\n  \\\"message\\\": \\\"Image replaced.\\\"\\n}\"},\"typeVersion\":1.1},{\"id\":\"ac42249b-3c7d-4ba1-be7d-ba6e1ae652cd\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[60,-540],\"parameters\":{\"width\":596.8395976509729,\"height\":654.4370838798395,\"content\":\"## Dynamically Replace Images in Google Slides\\nThis workflow exposes an API endpoint that lets you dynamically replace an image in Google Slides, perfect for automating deck presentations like updating backgrounds or client logos.\\n\\n### Step 1: Set Up a Key Identifier in Google Slides\\nAdd a unique key identifier to the images you want to replace.\\n1. Click on the image.\\n2. Go to **Format Options** and then **Alt Text**.\\n3. Enter your unique identifier, like `client_logo` or `background`.\\n\\n### Step 2: Use a POST Request to Update the Image\\nSend a POST request to the workflow endpoint with the following parameters in the body:\\n- `presentation_id`: The ID of your Google Slides presentation.\\nYou can find it in the URL of your Google presentation : `https://docs.google.com/presentation/d/{this-part}/edit#slide=id.p`)\\n- `image_key`: The unique identifier you created.\\n- `image_url`: The URL of the new image.\\n\\nThat's it! The specified image in your Google Slides presentation will be replaced with the new one from the provided URL.\\n\\nThis workflow is designed to be flexible, allowing you to use the same identifier across multiple slides and presentations. I hope it streamlines your slide automation process!\\n\\nHappy automating!\\nThe n8Ninja\"},\"typeVersion\":1},{\"id\":\"735c5c4e-df8f-47ad-b0d7-ed57453a84d0\",\"name\":\"Webhook\",\"type\":\"n8n-nodes-base.webhook\",\"position\":[60,160],\"webhookId\":\"df3b8b83-fd6d-40f8-be13-42bae85dcf63\",\"parameters\":{\"path\":\"replace-image-in-slide\",\"options\":{},\"httpMethod\":\"POST\",\"responseMode\":\"responseNode\"},\"typeVersion\":2},{\"id\":\"22d1dd70-0716-4407-8e25-703355969e95\",\"name\":\"Retrieve matching Images ObjectIds\",\"type\":\"n8n-nodes-base.code\",\"position\":[680,140],\"parameters\":{\"jsCode\":\"const key = $('Webhook').item.json.body.image_key;\\n\\nconst pageElements = $input\\n  .all()\\n  .flatMap(item => item.json.slides)\\n  .flatMap(slide => slide.pageElements.filter(el => el.image && el.description === key));\\n\\nconst objectIds = pageElements.map(el => ({ objectId: el.objectId }));\\n\\nreturn objectIds\"},\"typeVersion\":2},{\"id\":\"f942a8de-9fa8-4855-9be1-4247bae887e5\",\"name\":\"Retrieve All Slide Elements\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[500,140],\"parameters\":{\"url\":\"=https://slides.googleapis.com/v1/presentations/{{ $('Webhook').item.json.body.presentation_id }}\",\"options\":{},\"authentication\":\"predefinedCredentialType\",\"nodeCredentialType\":\"googleSlidesOAuth2Api\"},\"credentials\":{\"googleSlidesOAuth2Api\":{\"id\":\"XnM5YeAtI5QnYrMh\",\"name\":\"Google Slides account\"}},\"typeVersion\":4.2},{\"id\":\"ddcbe7ed-9abc-49ac-98e5-4d5222a641d4\",\"name\":\"Check if all params are provided\",\"type\":\"n8n-nodes-base.if\",\"position\":[260,160],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"3272f7e8-4bc2-44bd-9760-437b2992e6e7\",\"operator\":{\"type\":\"string\",\"operation\":\"exists\",\"singleValue\":true},\"leftValue\":\"={{ $json.body.presentation_id }}\",\"rightValue\":\"\"},{\"id\":\"9e8abf56-622d-4704-95ea-c0f5f31683dd\",\"operator\":{\"type\":\"string\",\"operation\":\"exists\",\"singleValue\":true},\"leftValue\":\"={{ $json.body.image_key }}\",\"rightValue\":\"\"},{\"id\":\"d2cec4c9-2a90-4a24-ab6c-628689419698\",\"operator\":{\"type\":\"string\",\"operation\":\"exists\",\"singleValue\":true},\"leftValue\":\"={{ $json.body.image_url }}\",\"rightValue\":\"\"}]}},\"typeVersion\":2}],\"pinData\":{},\"connections\":{\"Webhook\":{\"main\":[[{\"node\":\"Check if all params are provided\",\"type\":\"main\",\"index\":0}]]},\"Replace Images\":{\"main\":[[{\"node\":\"Respond to Webhook\",\"type\":\"main\",\"index\":0}]]},\"Retrieve All Slide Elements\":{\"main\":[[{\"node\":\"Retrieve matching Images ObjectIds\",\"type\":\"main\",\"index\":0}]]},\"Check if all params are provided\":{\"main\":[[{\"node\":\"Retrieve All Slide Elements\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Error Missing Fields\",\"type\":\"main\",\"index\":0}]]},\"Retrieve matching Images ObjectIds\":{\"main\":[[{\"node\":\"Replace Images\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "**🎉 Do you want to master AI automation, so you can save time and build cool stuff?**\n\nI’ve created a welcoming Skool community for non-technical yet resourceful learners.\n\n**👉🏻[Join the AI Atelier](https://www.skool.com/the-ai-atelier-3311/about) 👈🏻**\n\n* * *\n\nThis workflow exposes an API endpoint that lets you dynamically replace an image in Google Slides, perfect for automating deck presentations like updating backgrounds or client logos.\n\n**[📺 Youtube Overview 📺](https://www.youtube.com/watch?v=3kM7lKorWkQ)**\n\n## Here's how to get started:\n\n### Step 1: Set Up a Key Identifier in Google Slides\n\nAdd a unique key identifier to the images you want to replace.\n\n  1. Click on the image.\n  2. Go to **Format Options** and then **Alt Text**.\n  3. Enter your unique identifier, like `client_logo` or `background`.\n\n\n\n### Step 2: Use a POST Request to Update the Image\n\nSend a POST request to the workflow endpoint with the following parameters in the body:\n\n  * `presentation_id`: The ID of your Google Slides presentation.  \nYou can find it in the URL of your Google presentation: `https://docs.google.com/presentation/d/&lt;this-part&gt;/edit`)\n  * `image_key`: The unique identifier you created.\n  * `image_url`: The URL of the new image.\n\n\n\nThat's it! The specified image in your Google Slides presentation will be replaced with the new one from the provided URL.\n\nThis workflow is designed to be flexible, allowing you to use the same identifier across multiple slides and presentations. I hope it streamlines your slide automation process!\n\nExample Curl Request to execute:\n    \n    \n    curl --location 'https://workflow.url' \\\n    --form 'presentation_id=\"google-presentation-id\"' \\\n    --form 'image_key=\"background\"' \\\n    --form 'image_url=\"https://picsum.photos/536/354\"'\n    \n\nHappy automating!  \nThe n8Ninja 🥷\n",
  "readme_html": "<!--[--><div data-v-50766329=\"\"><p><strong>🎉 Do you want to master AI automation, so you can save time and build cool stuff?</strong></p>\n<p>I’ve created a welcoming Skool community for non-technical yet resourceful learners.</p>\n<p><strong>👉🏻 <a href=\"https://www.skool.com/the-ai-atelier-3311/about\" rel=\"ugc nofollow\" target=\"_blank\">Join the AI Atelier</a> 👈🏻</strong></p>\n<hr>\n<p>This workflow exposes an API endpoint that lets you dynamically replace an image in Google Slides, perfect for automating deck presentations like updating backgrounds or client logos.</p>\n<p><strong><a href=\"https://www.youtube.com/watch?v=3kM7lKorWkQ\" rel=\"ugc nofollow\" target=\"_blank\">📺 Youtube Overview 📺 </a></strong></p>\n<h2>Here's how to get started:</h2>\n<h3>Step 1: Set Up a Key Identifier in Google Slides</h3>\n<p>Add a unique key identifier to the images you want to replace.</p>\n<ol>\n<li>Click on the image.</li>\n<li>Go to <strong>Format Options</strong> and then <strong>Alt Text</strong>.</li>\n<li>Enter your unique identifier, like <code>client_logo</code> or <code>background</code>.</li>\n</ol>\n<h3>Step 2: Use a POST Request to Update the Image</h3>\n<p>Send a POST request to the workflow endpoint with the following parameters in the body:</p>\n<ul>\n<li><code>presentation_id</code>: The ID of your Google Slides presentation.<br>\nYou can find it in the URL of your Google presentation: <code>https://docs.google.com/presentation/d/&amp;lt;this-part&amp;gt;/edit</code>)</li>\n<li><code>image_key</code>: The unique identifier you created.</li>\n<li><code>image_url</code>: The URL of the new image.</li>\n</ul>\n<p>That's it! The specified image in your Google Slides presentation will be replaced with the new one from the provided URL.</p>\n<p>This workflow is designed to be flexible, allowing you to use the same identifier across multiple slides and presentations. I hope it streamlines your slide automation process!</p>\n<p>Example Curl Request to execute:</p>\n<pre><code>curl --location 'https://workflow.url' \\\n--form 'presentation_id=\"google-presentation-id\"' \\\n--form 'image_key=\"background\"' \\\n--form 'image_url=\"https://picsum.photos/536/354\"'\n</code></pre>\n<p>Happy automating!<br>\nThe n8Ninja 🥷</p>\n</div><!--]-->",
  "readme_zh": "**🎉 想精通AI自动化，节省时间打造炫酷作品吗？**\n\n我为非技术背景但善于资源整合的学习者创建了一个友好的Skool社区。\n\n**👉🏻[加入AI创意工坊](https://www.skool.com/the-ai-atelier-3311/about) 👈🏻**\n\n* * *\n\n这个工作流通过API接口实现动态替换Google幻灯片中的图片，特别适合自动化演示文稿更新（如背景图或客户Logo替换）。\n\n**[📺 视频教程 📺](https://www.youtube.com/watch?v=3kM7lKorWkQ)**\n\n## 快速入门指南：\n\n### 第一步：在Google幻灯片中设置图片标识符\n\n为需要替换的图片添加唯一标识：\n  1. 选中目标图片  \n  2. 进入**格式选项** → **替代文本**  \n  3. 输入唯一标识（如`客户Logo`或`背景图`）\n\n### 第二步：发送POST请求更新图片\n\n向工作流接口发送包含以下参数的POST请求：\n  * `presentation_id`：幻灯片文件ID  \n  （从URL中获取：`https://docs.google.com/presentation/d/&lt;此处即ID&gt;/edit`）\n  * `image_key`：预设的图片标识符  \n  * `image_url`：新图片的在线地址  \n\n完成！指定幻灯片中的图片将自动替换为新图片。\n\n本方案支持跨幻灯片/文档复用相同标识符，助您高效实现演示自动化！\n\n示例Curl指令：\n    \n    \n    curl --location 'https://workflow.url' \\\n    --form 'presentation_id=\"谷歌幻灯片ID\"' \\\n    --form 'image_key=\"背景图\"' \\\n    --form 'image_url=\"https://picsum.photos/536/354\"'\n    \n\n自动化愉快！  \nn8忍者 🥷",
  "title_zh": "通过API动态替换Google幻灯片中的图片",
  "publish_date_zh": "最后更新于5个月前",
  "workflow_json_zh": "{\n  \"nodes\": [\n    {\n      \"id\": \"aea55995-2c2c-4f59-8b68-43fa1871bb4c\",\n      \"name\": \"Replace Images\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        860,\n        140\n      ],\n      \"parameters\": {\n        \"url\": \"=https://slides.googleapis.com/v1/presentations/{{ $('Webhook').item.json[\\\"body\\\"][\\\"presentation_id\\\"] }}:batchUpdate \",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"jsonBody\": \"={\\n  \\\"requests\\\": [\\n    {\\n        \\\"replaceImage\\\": {\\n          \\\"imageObjectId\\\": \\\"{{ $json.objectId }}\\\",\\n          \\\"url\\\": \\\"{{ $('Webhook').item.json[\\\"body\\\"][\\\"image_url\\\"] }}\\\",\\n          \\\"imageReplaceMethod\\\": \\\"CENTER_CROP\\\"\\n        }\\n    },\\n    {\\n      \\\"updatePageElementAltText\\\": {\\n        \\\"objectId\\\": \\\"{{ $json.objectId }}\\\",\\n        \\\"description\\\": \\\"{{ $('Webhook').item.json[\\\"body\\\"][\\\"image_key\\\"] }}\\\"\\n      }\\n    }\\n  ]\\n}  \\n   \",\n        \"sendBody\": true,\n        \"specifyBody\": \"json\",\n        \"authentication\": \"predefinedCredentialType\",\n        \"nodeCredentialType\": \"googleSlidesOAuth2Api\"\n      },\n      \"credentials\": {\n        \"googleSlidesOAuth2Api\": {\n          \"id\": \"XnM5YeAtI5QnYrMh\",\n          \"name\": \"Google Slides account\"\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"92eeca3a-47b2-4daa-ac51-5b957c8d7d56\",\n      \"name\": \"Error Missing Fields\",\n      \"type\": \"n8n-nodes-base.respondToWebhook\",\n      \"position\": [\n        500,\n        340\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"responseCode\": 500\n        },\n        \"respondWith\": \"json\",\n        \"responseBody\": \"{\\n  \\\"error\\\": \\\"Missing fields.\\\"\\n}\"\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"14878542-6a42-4fe4-8dd6-328450a883eb\",\n      \"name\": \"Respond to Webhook\",\n      \"type\": \"n8n-nodes-base.respondToWebhook\",\n      \"position\": [\n        1040,\n        140\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"respondWith\": \"json\",\n        \"responseBody\": \"{\\n  \\\"message\\\": \\\"Image replaced.\\\"\\n}\"\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"ac42249b-3c7d-4ba1-be7d-ba6e1ae652cd\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        60,\n        -540\n      ],\n      \"parameters\": {\n        \"width\": 596.8395976509729,\n        \"height\": 654.4370838798395,\n        \"content\": \"## 动态替换Google幻灯片中的图片  \\n此工作流提供了一个API端点，可动态替换Google幻灯片中的图片，非常适合自动化更新演示文稿（如背景或客户徽标）。\\n\\n### 步骤1：在Google幻灯片中设置关键标识符  \\n为需要替换的图片添加唯一标识符：  \\n1. 点击目标图片  \\n2. 进入**格式选项** → **替代文本**  \\n3. 输入唯一标识符（如`client_logo`或`background`）  \\n\\n### 步骤2：通过POST请求更新图片  \\n向工作流端点发送POST请求，请求体需包含以下参数：  \\n- `presentation_id`：Google幻灯片文件ID  \\n（从演示文稿URL获取：`https://docs.google.com/presentation/d/{这部分}/edit#slide=id.p`）  \\n- `image_key`：预先设置的唯一标识符  \\n- `image_url`：新图片的URL地址  \\n\\n完成！指定幻灯片中的图片将立即替换为提供的URL新图片。  \\n\\n本工作流支持跨多张幻灯片和演示文稿复用相同标识符，具有高度灵活性。希望能为您的幻灯片自动化流程增效！  \\n\\n自动化愉快！  \\nn8Ninja敬上\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"735c5c4e-df8f-47ad-b0d7-ed57453a84d0\",\n      \"name\": \"Webhook\",\n      \"type\": \"n8n-nodes-base.webhook\",\n      \"position\": [\n        60,\n        160\n      ],\n      \"webhookId\": \"df3b8b83-fd6d-40f8-be13-42bae85dcf63\",\n      \"parameters\": {\n        \"path\": \"replace-image-in-slide\",\n        \"options\": {},\n        \"httpMethod\": \"POST\",\n        \"responseMode\": \"responseNode\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"22d1dd70-0716-4407-8e25-703355969e95\",\n      \"name\": \"Retrieve matching Images ObjectIds\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        680,\n        140\n      ],\n      \"parameters\": {\n        \"jsCode\": \"const key = $('Webhook').item.json.body.image_key;\\n\\nconst pageElements = $input\\n  .all()\\n  .flatMap(item => item.json.slides)\\n  .flatMap(slide => slide.pageElements.filter(el => el.image && el.description === key));\\n\\nconst objectIds = pageElements.map(el => ({ objectId: el.objectId }));\\n\\nreturn objectIds\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"f942a8de-9fa8-4855-9be1-4247bae887e5\",\n      \"name\": \"Retrieve All Slide Elements\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        500,\n        140\n      ],\n      \"parameters\": {\n        \"url\": \"=https://slides.googleapis.com/v1/presentations/{{ $('Webhook').item.json.body.presentation_id }}\",\n        \"options\": {},\n        \"authentication\": \"predefinedCredentialType\",\n        \"nodeCredentialType\": \"googleSlidesOAuth2Api\"\n      },\n      \"credentials\": {\n        \"googleSlidesOAuth2Api\": {\n          \"id\": \"XnM5YeAtI5QnYrMh\",\n          \"name\": \"Google Slides account\"\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"ddcbe7ed-9abc-49ac-98e5-4d5222a641d4\",\n      \"name\": \"Check if all params are provided\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        260,\n        160\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"3272f7e8-4bc2-44bd-9760-437b2992e6e7\",\n              \"operator\": {\n                \"type\": \"string\",\n                \"operation\": \"exists\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json.body.presentation_id }}\",\n              \"rightValue\": \"\"\n            },\n            {\n              \"id\": \"9e8abf56-622d-4704-95ea-c0f5f31683dd\",\n              \"operator\": {\n                \"type\": \"string\",\n                \"operation\": \"exists\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json.body.image_key }}\",\n              \"rightValue\": \"\"\n            },\n            {\n              \"id\": \"d2cec4c9-2a90-4a24-ab6c-628689419698\",\n              \"operator\": {\n                \"type\": \"string\",\n                \"operation\": \"exists\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json.body.image_url }}\",\n              \"rightValue\": \"\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2\n    }\n  ],\n  \"pinData\": {},\n  \"connections\": {\n    \"Webhook\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Check if all params are provided\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Replace Images\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Respond to Webhook\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Retrieve All Slide Elements\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Retrieve matching Images ObjectIds\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Check if all params are provided\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Retrieve All Slide Elements\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Error Missing Fields\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Retrieve matching Images ObjectIds\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Replace Images\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}