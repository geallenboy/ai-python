{
  "title": "Automatically prune n8n execution history",
  "url": "https://n8n.io/workflows/2646-automatically-prune-n8n-execution-history/",
  "category": "Other",
  "category_url": "https://n8n.io/workflows/categories/other/?sort=createdAt:desc",
  "author": "Danger",
  "publish_date": "Last update 5 months ago",
  "publish_date_absolute": "",
  "content": "",
  "workflow_json": "{\"meta\":{\"instanceId\":\"d68b0885df4f6057c27649c0cc1cdbf154a8c3c6de34051d82d8f9164d66f031\"},\"nodes\":[{\"id\":\"648130c4-5195-4b91-995b-443624019cd0\",\"name\":\"When clicking ‘Test workflow’\",\"type\":\"n8n-nodes-base.manualTrigger\",\"position\":[820,280],\"parameters\":{},\"typeVersion\":1},{\"id\":\"c25e5656-9ce2-4429-98f5-f86a88a8fe16\",\"name\":\"n8n1\",\"type\":\"n8n-nodes-base.n8n\",\"position\":[2380,140],\"parameters\":{\"filters\":{},\"options\":{},\"resource\":\"execution\",\"returnAll\":true,\"requestOptions\":{}},\"credentials\":{\"n8nApi\":{\"id\":\"23\",\"name\":\"n8n account\"}},\"typeVersion\":1},{\"id\":\"93acd82f-22ce-435c-b89e-a3f8ae876bc5\",\"name\":\"n8n list execution\",\"type\":\"n8n-nodes-base.n8n\",\"position\":[1040,380],\"parameters\":{\"filters\":{},\"options\":{},\"resource\":\"execution\",\"returnAll\":true,\"requestOptions\":{}},\"credentials\":{\"n8nApi\":{\"id\":\"23\",\"name\":\"n8n account\"}},\"typeVersion\":1},{\"id\":\"da03ff80-480d-4616-8aed-dd955d5e92d8\",\"name\":\"If\",\"type\":\"n8n-nodes-base.if\",\"position\":[1260,380],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"6a124591-3347-4224-a997-a7824de12c96\",\"operator\":{\"type\":\"dateTime\",\"operation\":\"before\"},\"leftValue\":\"={{ $json.startedAt }}\",\"rightValue\":\"={{ new Date(Date.now() - 10 * 24 * 60 * 60 * 1000).toISOString();  }}\"}]}},\"typeVersion\":2.2},{\"id\":\"6bc96f0a-5ed9-43f9-91e8-ced15ae53ef5\",\"name\":\"Schedule Trigger\",\"type\":\"n8n-nodes-base.scheduleTrigger\",\"position\":[820,500],\"parameters\":{\"rule\":{\"interval\":[{\"triggerAtHour\":4,\"triggerAtMinute\":44}]}},\"typeVersion\":1.2},{\"id\":\"272f94d2-fcb5-4e6a-a32e-655ac1db9a00\",\"name\":\"delete execution\",\"type\":\"n8n-nodes-base.n8n\",\"position\":[1480,280],\"parameters\":{\"resource\":\"execution\",\"operation\":\"delete\",\"executionId\":\"={{ $json.id }}\",\"requestOptions\":{}},\"credentials\":{\"n8nApi\":{\"id\":\"23\",\"name\":\"n8n account\"}},\"typeVersion\":1},{\"id\":\"b2067d59-3678-400a-a464-cb7aab62413f\",\"name\":\"No Operation, do nothing\",\"type\":\"n8n-nodes-base.noOp\",\"position\":[1480,480],\"parameters\":{},\"typeVersion\":1}],\"pinData\":{},\"connections\":{\"If\":{\"main\":[[{\"node\":\"delete execution\",\"type\":\"main\",\"index\":0}],[{\"node\":\"No Operation, do nothing\",\"type\":\"main\",\"index\":0}]]},\"Schedule Trigger\":{\"main\":[[{\"node\":\"n8n list execution\",\"type\":\"main\",\"index\":0}]]},\"n8n list execution\":{\"main\":[[{\"node\":\"If\",\"type\":\"main\",\"index\":0}]]},\"When clicking ‘Test workflow’\":{\"main\":[[{\"node\":\"n8n list execution\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "## Automated Execution Pruning\n\nThis workflow is designed to help you manage and optimize your n8n instance by automatically pruning old workflow executions, ensuring a cleaner environment and improved performance. You can customize the retention period to suit your needs.\n\n* * *\n\n## Key Features:\n\n  1. **Configurable Retention Period** :  \nThe workflow is preconfigured to delete workflow executions older than 10 days. You can easily adjust this duration by modifying the condition in the **If** node.\n\n  2. **Daily Automation** :  \nUsing the **Schedule Trigger** , the workflow runs daily at the specified time (default: 4:44 AM), retrieving all workflow executions and identifying those that are older than the defined retention period.\n\n  3. **On-Demand Testing** :  \nThe **Manual Trigger** allows you to test the workflow at any time, ensuring everything is working as expected.\n\n  4. **Decision Making** :  \nThe **If** node evaluates each execution based on its start date and determines whether it should be deleted or retained.\n\n  5. **Execution Pruning** :\n\n     * **Delete Action** : Executions meeting the criteria are removed via the **Delete Execution** node.\n     * **No-Operation** : Executions that don't meet the criteria remain untouched.\n\n\n\n* * *\n\n## Workflow Nodes:\n\n  1. **Manual Trigger** : Enables on-demand testing of the workflow.\n  2. **Schedule Trigger** : Runs the workflow daily at the configured time.\n  3. **n8n List Execution** : Fetches all executions in your n8n instance.\n  4. **If Node** : Compares the execution's start date with the configured retention period.\n  5. **Delete Execution** : Deletes executions older than the specified retention period.\n  6. **No Operation** : Serves as a placeholder for executions that don't meet the pruning criteria.\n\n\n\n* * *\n\n## How to Customize:\n\n  * **Retention Period** :  \nUpdate the **If** node's condition to modify the retention period. For instance, change `10 * 24 * 60 * 60 * 1000` to the desired number of days in milliseconds.\n\n  * **Schedule** :  \nAdjust the timing of the **Schedule Trigger** to match your preferred automation schedule.\n\n\n\n\nThis workflow ensures your instance remains efficient by keeping only the relevant execution logs. Use it to maintain a streamlined and clutter-free environment effortlessly.\n",
  "readme_html": "<!--[--><div data-v-50766329=\"\"><h2>Automated Execution Pruning</h2>\n<p>This workflow is designed to help you manage and optimize your n8n instance by automatically pruning old workflow executions, ensuring a cleaner environment and improved performance. You can customize the retention period to suit your needs.</p>\n<hr>\n<h2>Key Features:</h2>\n<ol>\n<li>\n<p><strong>Configurable Retention Period</strong>:<br>\nThe workflow is preconfigured to delete workflow executions older than 10 days. You can easily adjust this duration by modifying the condition in the <strong>If</strong> node.</p>\n</li>\n<li>\n<p><strong>Daily Automation</strong>:<br>\nUsing the <strong>Schedule Trigger</strong>, the workflow runs daily at the specified time (default: 4:44 AM), retrieving all workflow executions and identifying those that are older than the defined retention period.</p>\n</li>\n<li>\n<p><strong>On-Demand Testing</strong>:<br>\nThe <strong>Manual Trigger</strong> allows you to test the workflow at any time, ensuring everything is working as expected.</p>\n</li>\n<li>\n<p><strong>Decision Making</strong>:<br>\nThe <strong>If</strong> node evaluates each execution based on its start date and determines whether it should be deleted or retained.</p>\n</li>\n<li>\n<p><strong>Execution Pruning</strong>:</p>\n<ul>\n<li><strong>Delete Action</strong>: Executions meeting the criteria are removed via the <strong>Delete Execution</strong> node.</li>\n<li><strong>No-Operation</strong>: Executions that don't meet the criteria remain untouched.</li>\n</ul>\n</li>\n</ol>\n<hr>\n<h2>Workflow Nodes:</h2>\n<ol>\n<li><strong>Manual Trigger</strong>: Enables on-demand testing of the workflow.</li>\n<li><strong>Schedule Trigger</strong>: Runs the workflow daily at the configured time.</li>\n<li><strong>n8n List Execution</strong>: Fetches all executions in your n8n instance.</li>\n<li><strong>If Node</strong>: Compares the execution's start date with the configured retention period.</li>\n<li><strong>Delete Execution</strong>: Deletes executions older than the specified retention period.</li>\n<li><strong>No Operation</strong>: Serves as a placeholder for executions that don't meet the pruning criteria.</li>\n</ol>\n<hr>\n<h2>How to Customize:</h2>\n<ul>\n<li>\n<p><strong>Retention Period</strong>:<br>\nUpdate the <strong>If</strong> node's condition to modify the retention period. For instance, change <code>10 * 24 * 60 * 60 * 1000</code> to the desired number of days in milliseconds.</p>\n</li>\n<li>\n<p><strong>Schedule</strong>:<br>\nAdjust the timing of the <strong>Schedule Trigger</strong> to match your preferred automation schedule.</p>\n</li>\n</ul>\n<p>This workflow ensures your instance remains efficient by keeping only the relevant execution logs. Use it to maintain a streamlined and clutter-free environment effortlessly.</p>\n</div><!--]-->"
}