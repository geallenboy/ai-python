{
  "title": "Get Daily Exercise Plan with Flex Message via LINE",
  "url": "https://n8n.io/workflows/2988-get-daily-exercise-plan-with-flex-message-via-line/",
  "category": "Other",
  "category_url": "https://n8n.io/workflows/categories/other/?sort=createdAt:desc",
  "author": "lin@davoy.tech",
  "publish_date": "Last update 2 months ago",
  "publish_date_absolute": "2025-03-23",
  "content": "",
  "workflow_json": "{\"id\":\"2DzQ1FH11S3Gp6wn\",\"meta\":{\"instanceId\":\"558d88703fb65b2d0e44613bc35916258b0f0bf983c5d4730c00c424b77ca36a\",\"templateCredsSetupCompleted\":true},\"name\":\"YogiAI\",\"tags\":[],\"nodes\":[{\"id\":\"2afc390e-d774-4db4-a52f-138f13837646\",\"name\":\"Azure OpenAI Chat Model2\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatAzureOpenAi\",\"position\":[1040,0],\"parameters\":{\"model\":\"4o\",\"options\":{\"temperature\":0.8}},\"credentials\":{\"azureOpenAiApi\":{\"id\":\"5AjoWhww5SQi2VXd\",\"name\":\"Azure Open AI account\"}},\"typeVersion\":1},{\"id\":\"529d9ed9-3ae5-41cb-983e-874aa37ee1c7\",\"name\":\"YogaLog\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[2240,-100],\"parameters\":{\"columns\":{\"value\":{\"Date\":\"={{ $('Trigger 2130 YogaPosesToday').first().json.timestamp }}\",\"JSON\":\"={{ $('CombineAll').item.json.LineBody }}\",\"Text\":\"={{ $('RewritePosesToday').item.json.text }}\"},\"schema\":[{\"id\":\"Date\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"Date\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Text\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"Text\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"JSON\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"JSON\",\"defaultMatch\":false,\"canBeUsedToMatch\":true}],\"mappingMode\":\"defineBelow\",\"matchingColumns\":[\"Date\"],\"attemptToConvertTypes\":false,\"convertFieldsToString\":false},\"options\":{},\"operation\":\"append\",\"sheetName\":{\"__rl\":true,\"mode\":\"list\",\"value\":325576327,\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1s_yzDNbbtXhfoOKUlmBHwhgWkR2FuoiKz4WQOu4tQmk/edit#gid=325576327\",\"cachedResultName\":\"YogaLog\"},\"documentId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"1s_yzDNbbtXhfoOKUlmBHwhgWkR2FuoiKz4WQOu4tQmk\",\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1s_yzDNbbtXhfoOKUlmBHwhgWkR2FuoiKz4WQOu4tQmk/edit?usp=drivesdk\",\"cachedResultName\":\"SerenityAI\"}},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"TKSdrVOdpgxWBVk8\",\"name\":\"Google Sheets account\"}},\"typeVersion\":4.5},{\"id\":\"d491b5c3-31ab-49b2-abc3-8c2a67cf9571\",\"name\":\"Azure OpenAI Chat Model3\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatAzureOpenAi\",\"position\":[2360,120],\"parameters\":{\"model\":\"4o\",\"options\":{}},\"credentials\":{\"azureOpenAiApi\":{\"id\":\"5AjoWhww5SQi2VXd\",\"name\":\"Azure Open AI account\"}},\"typeVersion\":1},{\"id\":\"3b1ebdcb-9e6b-437c-8f51-944218c0c276\",\"name\":\"Auto-fixing Output Parser\",\"type\":\"@n8n/n8n-nodes-langchain.outputParserAutofixing\",\"position\":[2520,80],\"parameters\":{\"options\":{}},\"typeVersion\":1},{\"id\":\"3fc67522-501c-4e43-bf9d-b367d57ad4f9\",\"name\":\"Azure OpenAI Chat Model1\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatAzureOpenAi\",\"position\":[2540,120],\"parameters\":{\"model\":\"4o\",\"options\":{}},\"credentials\":{\"azureOpenAiApi\":{\"id\":\"5AjoWhww5SQi2VXd\",\"name\":\"Azure Open AI account\"}},\"typeVersion\":1},{\"id\":\"19bd208b-a5c5-47b3-a2cc-e92a71444be7\",\"name\":\"Structured Output Parser\",\"type\":\"@n8n/n8n-nodes-langchain.outputParserStructured\",\"position\":[2640,220],\"parameters\":{\"schemaType\":\"manual\",\"inputSchema\":\"{\\n  \\\"type\\\": \\\"object\\\",\\n  \\\"properties\\\": {\\n    \\\"yogaPoses\\\": {\\n      \\\"type\\\": \\\"array\\\",\\n      \\\"items\\\": {\\n        \\\"type\\\": \\\"object\\\",\\n        \\\"properties\\\": {\\n          \\\"sequence\\\": { \\\"type\\\": \\\"integer\\\" },\\n          \\\"name\\\": { \\\"type\\\": \\\"string\\\" }\\n        },\\n        \\\"required\\\": [\\\"sequence\\\", \\\"name\\\"],\\n        \\\"additionalProperties\\\": false\\n      }\\n    }\\n  },\\n  \\\"required\\\": [\\\"yogaPoses\\\"]\\n}\"},\"typeVersion\":1.2},{\"id\":\"2bf3f3d3-84c7-4fd4-b1b9-8c0fb7df44b1\",\"name\":\"AI Agent\",\"type\":\"@n8n/n8n-nodes-langchain.agent\",\"position\":[2400,-60],\"parameters\":{\"text\":\"=You'll change this into properly format of JSON without having emoji. You'll also make sure the name is matched the data in googlesheet\\n\\n {{ $json.Text }}\",\"options\":{},\"promptType\":\"define\",\"hasOutputParser\":true},\"typeVersion\":1.7},{\"id\":\"fa3fc89e-54d8-4706-af59-72dbd80fbef4\",\"name\":\"PosesDatabase1\",\"type\":\"n8n-nodes-base.googleSheetsTool\",\"position\":[2480,220],\"parameters\":{\"options\":{},\"sheetName\":{\"__rl\":true,\"mode\":\"list\",\"value\":1104924292,\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1s_yzDNbbtXhfoOKUlmBHwhgWkR2FuoiKz4WQOu4tQmk/edit#gid=1104924292\",\"cachedResultName\":\"Yoga\"},\"documentId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"1s_yzDNbbtXhfoOKUlmBHwhgWkR2FuoiKz4WQOu4tQmk\",\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1s_yzDNbbtXhfoOKUlmBHwhgWkR2FuoiKz4WQOu4tQmk/edit?usp=drivesdk\",\"cachedResultName\":\"SerenityAI\"},\"descriptionType\":\"manual\",\"toolDescription\":\"Yoga Poses Database to read\\n\"},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"TKSdrVOdpgxWBVk8\",\"name\":\"Google Sheets account\"}},\"typeVersion\":4.5},{\"id\":\"ff7bd540-c89b-43d1-bb07-bb060a6b4ba6\",\"name\":\"YogaLog2\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[2980,20],\"parameters\":{\"columns\":{\"value\":{\"Date\":\"={{ $('Trigger 2130 YogaPosesToday').first().json.timestamp }}\",\"Pose\":\"={{ $json.name }}\",\"Sequence\":\"={{ $json.sequence }}\"},\"schema\":[{\"id\":\"Date\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"Date\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Sequence\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"Sequence\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Pose\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"Pose\",\"defaultMatch\":false,\"canBeUsedToMatch\":true}],\"mappingMode\":\"defineBelow\",\"matchingColumns\":[\"Date\"],\"attemptToConvertTypes\":false,\"convertFieldsToString\":false},\"options\":{},\"operation\":\"append\",\"sheetName\":{\"__rl\":true,\"mode\":\"list\",\"value\":2060471945,\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1s_yzDNbbtXhfoOKUlmBHwhgWkR2FuoiKz4WQOu4tQmk/edit#gid=2060471945\",\"cachedResultName\":\"YogaLog2\"},\"documentId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"1s_yzDNbbtXhfoOKUlmBHwhgWkR2FuoiKz4WQOu4tQmk\",\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1s_yzDNbbtXhfoOKUlmBHwhgWkR2FuoiKz4WQOu4tQmk/edit?usp=drivesdk\",\"cachedResultName\":\"SerenityAI\"}},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"TKSdrVOdpgxWBVk8\",\"name\":\"Google Sheets account\"}},\"typeVersion\":4.5},{\"id\":\"f649c5b9-fad1-412c-8389-ed53b95e5583\",\"name\":\"Split Out\",\"type\":\"n8n-nodes-base.splitOut\",\"position\":[2740,-120],\"parameters\":{\"options\":{},\"fieldToSplitOut\":\"output.yogaPoses\"},\"typeVersion\":1},{\"id\":\"8194e695-fa9e-4555-9da5-b7dbdc1b0e4a\",\"name\":\"Trigger 2130 YogaPosesToday\",\"type\":\"n8n-nodes-base.scheduleTrigger\",\"position\":[-200,-20],\"parameters\":{\"rule\":{\"interval\":[{\"triggerAtHour\":21,\"triggerAtMinute\":30}]}},\"typeVersion\":1.2},{\"id\":\"3b5706d8-4968-4b9c-a255-7d1f806d85dc\",\"name\":\"Azure OpenAI Chat Model5\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatAzureOpenAi\",\"position\":[1340,180],\"parameters\":{\"model\":\"4o\",\"options\":{\"temperature\":0.9}},\"credentials\":{\"azureOpenAiApi\":{\"id\":\"5AjoWhww5SQi2VXd\",\"name\":\"Azure Open AI account\"}},\"typeVersion\":1},{\"id\":\"acee6e43-f094-4f30-bffb-6c56b0425327\",\"name\":\"Get PoseName\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[40,-20],\"parameters\":{\"options\":{\"dataLocationOnSheet\":{\"values\":{\"range\":\"B18:D28\",\"rangeDefinition\":\"specifyRangeA1\"}}},\"sheetName\":{\"__rl\":true,\"mode\":\"list\",\"value\":2035276041,\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1s_yzDNbbtXhfoOKUlmBHwhgWkR2FuoiKz4WQOu4tQmk/edit#gid=2035276041\",\"cachedResultName\":\"NotePad\"},\"documentId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"1s_yzDNbbtXhfoOKUlmBHwhgWkR2FuoiKz4WQOu4tQmk\",\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1s_yzDNbbtXhfoOKUlmBHwhgWkR2FuoiKz4WQOu4tQmk/edit?usp=drivesdk\",\"cachedResultName\":\"SerenityAI\"}},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"TKSdrVOdpgxWBVk8\",\"name\":\"Google Sheets account\"}},\"typeVersion\":4.5},{\"id\":\"6be3a88c-4e0f-44e6-97c1-eafa13230ae7\",\"name\":\"WritePosesToday\",\"type\":\"@n8n/n8n-nodes-langchain.chainLlm\",\"position\":[1120,-160],\"parameters\":{\"text\":\"=Let's calm down and focus on these poses today.\\n\\n{{ $('Code').item.json.poseNamesOnly }}\\n\\nhave a great practice!\",\"messages\":{\"messageValues\":[{\"message\":\"=You're experienced yoga instructor. You'll say the topic and asking the student to focus on practice today. You'll later give the yoga poses list for practicing today. You will also include related pose or variation from the list. You'll make sure to include all the poses from the list.\\n\"}]},\"promptType\":\"define\"},\"retryOnFail\":true,\"typeVersion\":1.5},{\"id\":\"8d9cdf4c-a432-44ff-a0a3-133fbc8e9daa\",\"name\":\"RewritePosesToday\",\"type\":\"@n8n/n8n-nodes-langchain.chainLlm\",\"position\":[1180,60],\"parameters\":{\"text\":\"={{ $json.text }}\",\"messages\":{\"messageValues\":[{\"message\":\"=You'll format and add emoji before the poses name to make it chat-friendly to send via Line. You will only return the message to be sent.\\n\\nIf the message is too long, you'll split by ====== to 3 messages\\n\"}]},\"promptType\":\"define\"},\"retryOnFail\":true,\"typeVersion\":1.5},{\"id\":\"2e419654-1f83-48df-8ac0-9ec621444cc2\",\"name\":\"Azure OpenAI Chat Model\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatAzureOpenAi\",\"position\":[480,100],\"parameters\":{\"model\":\"4o\",\"options\":{\"temperature\":0.9}},\"credentials\":{\"azureOpenAiApi\":{\"id\":\"5AjoWhww5SQi2VXd\",\"name\":\"Azure Open AI account\"}},\"typeVersion\":1},{\"id\":\"ad1bf966-114e-4bb8-abff-f5768e907aff\",\"name\":\"WriteJSONflex\",\"type\":\"@n8n/n8n-nodes-langchain.chainLlm\",\"position\":[580,-80],\"parameters\":{\"text\":\"={{ $json.outputText }}\",\"messages\":{\"messageValues\":[{\"message\":\"=You are JSON parser, you'll write JSON in this format for all the row in 'GetPoseName' You'll notice the differnet between uri and url.\\n\\n{\\n\\\"type\\\": \\\"bubble\\\",\\n\\\"hero\\\": {\\n\\\"type\\\": \\\"image\\\",\\n\\\"url\\\": \\\"https://pocketyoga.com/assets/images/thumbnails146/SupineAngle-tn146.png \\\", \\n\\\"size\\\": \\\"full\\\",\\n\\\"aspectRatio\\\": \\\"20:13\\\",\\n\\\"aspectMode\\\": \\\"fit\\\",\\n\\\"action\\\": {\\n\\\"type\\\": \\\"uri\\\",\\n\\\"uri\\\": \\\"https://pocketyoga.com/pose/SupineAngle \\\"\\n}\\n},\\n\\\"body\\\": {\\n\\\"type\\\": \\\"box\\\",\\n\\\"layout\\\": \\\"vertical\\\",\\n\\\"contents\\\": [\\n{\\n\\\"type\\\": \\\"text\\\",\\n\\\"text\\\": \\\"Supine Angle (supta konasana)\\\",\\n\\\"size\\\": \\\"lg\\\",\\n\\\"wrap\\\": true,\\n\\\"action\\\": {\\n\\\"type\\\": \\\"message\\\",\\n\\\"label\\\": \\\"action\\\",\\n\\\"text\\\": \\\"Supine Angle (supta konasana)\\\"\\n}\\n}\\n]\\n}\\n},\\n{\\n\\\"type\\\": \\\"bubble\\\",\\n\\\"hero\\\": {\\n\\\"type\\\": \\\"image\\\",\\n\\\"url\\\": \\\"https://pocketyoga.com/assets/images/thumbnails146/SupineAngle-tn146.png \\\",\\n\\\"size\\\": \\\"full\\\",\\n\\\"aspectRatio\\\": \\\"20:13\\\",\\n\\\"aspectMode\\\": \\\"fit\\\",\\n\\\"action\\\": {\\n\\\"type\\\": \\\"uri\\\",\\n\\\"uri\\\": \\\"https://pocketyoga.com/pose/SupineAngle \\\"\\n}\\n},\\n\\\"body\\\": {\\n\\\"type\\\": \\\"box\\\",\\n\\\"layout\\\": \\\"vertical\\\",\\n\\\"contents\\\": [\\n{\\n\\\"type\\\": \\\"text\\\",\\n\\\"text\\\": \\\"Supine Angle (supta konasana)\\\",\\n\\\"size\\\": \\\"lg\\\",\\n\\\"wrap\\\": true,\\n\\\"action\\\": {\\n\\\"type\\\": \\\"message\\\",\\n\\\"label\\\": \\\"action\\\",\\n\\\"text\\\": \\\"Supine Angle (supta konasana)\\\"\\n}\\n}\\n]\\n}\\n}\"}]},\"promptType\":\"define\",\"hasOutputParser\":true},\"retryOnFail\":true,\"typeVersion\":1.5},{\"id\":\"1e6af9e5-675d-4d9a-aba6-304d218ea138\",\"name\":\"Structured Output Parser1\",\"type\":\"@n8n/n8n-nodes-langchain.outputParserStructured\",\"position\":[780,220],\"parameters\":{\"jsonSchemaExample\":\"[\\n  {\\n    \\\"type\\\": \\\"bubble\\\",\\n    \\\"hero\\\": {\\n      \\\"type\\\": \\\"image\\\",\\n      \\\"url\\\": \\\"https://pocketyoga.com/assets/images/thumbnails146/SupineAngle-tn146.png\\\",\\n      \\\"size\\\": \\\"full\\\",\\n      \\\"aspectRatio\\\": \\\"20:13\\\",\\n      \\\"aspectMode\\\": \\\"fit\\\",\\n      \\\"action\\\": {\\n        \\\"type\\\": \\\"uri\\\",\\n        \\\"uri\\\": \\\"https://pocketyoga.com/pose/SupineAngle\\\"\\n      }\\n    },\\n    \\\"body\\\": {\\n      \\\"type\\\": \\\"box\\\",\\n      \\\"layout\\\": \\\"vertical\\\",\\n      \\\"contents\\\": [\\n        {\\n          \\\"type\\\": \\\"text\\\",\\n          \\\"text\\\": \\\"Supine Angle (supta konasana)\\\",\\n          \\\"size\\\": \\\"lg\\\",\\n          \\\"wrap\\\": true,\\n          \\\"action\\\": {\\n            \\\"type\\\": \\\"message\\\",\\n            \\\"label\\\": \\\"action\\\",\\n            \\\"text\\\": \\\"Supine Angle (supta konasana)\\\"\\n          }\\n        }\\n      ]\\n    }\\n  },\\n  {\\n    \\\"type\\\": \\\"bubble\\\",\\n    \\\"hero\\\": {\\n      \\\"type\\\": \\\"image\\\",\\n      \\\"url\\\": \\\"https://pocketyoga.com/assets/images/thumbnails146/SupineAngle-tn146.png\\\",\\n      \\\"size\\\": \\\"full\\\",\\n      \\\"aspectRatio\\\": \\\"20:13\\\",\\n      \\\"aspectMode\\\": \\\"fit\\\",\\n      \\\"action\\\": {\\n        \\\"type\\\": \\\"uri\\\",\\n        \\\"uri\\\": \\\"https://pocketyoga.com/pose/SupineAngle\\\"\\n      }\\n    },\\n    \\\"body\\\": {\\n      \\\"type\\\": \\\"box\\\",\\n      \\\"layout\\\": \\\"vertical\\\",\\n      \\\"contents\\\": [\\n        {\\n          \\\"type\\\": \\\"text\\\",\\n          \\\"text\\\": \\\"Supine Angle (supta konasana)\\\",\\n          \\\"size\\\": \\\"lg\\\",\\n          \\\"wrap\\\": true,\\n          \\\"action\\\": {\\n            \\\"type\\\": \\\"message\\\",\\n            \\\"label\\\": \\\"action\\\",\\n            \\\"text\\\": \\\"Supine Angle (supta konasana)\\\"\\n          }\\n        }\\n      ]\\n    }\\n  }\\n]\"},\"typeVersion\":1.2},{\"id\":\"5559c5b9-6c2c-4adb-9544-79be3f1f85d1\",\"name\":\"Auto-fixing Output Parser1\",\"type\":\"@n8n/n8n-nodes-langchain.outputParserAutofixing\",\"position\":[680,80],\"parameters\":{\"options\":{}},\"typeVersion\":1},{\"id\":\"2335f74e-3fe6-4720-bb88-1bbda320ae8b\",\"name\":\"Azure OpenAI Chat Model6\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatAzureOpenAi\",\"position\":[640,200],\"parameters\":{\"model\":\"4o\",\"options\":{}},\"credentials\":{\"azureOpenAiApi\":{\"id\":\"5AjoWhww5SQi2VXd\",\"name\":\"Azure Open AI account\"}},\"typeVersion\":1},{\"id\":\"83d02971-bdf6-4c45-b705-f2f49fa49525\",\"name\":\"Azure OpenAI Chat Model4\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatAzureOpenAi\",\"position\":[1780,200],\"parameters\":{\"model\":\"4o\",\"options\":{\"temperature\":0.5}},\"credentials\":{\"azureOpenAiApi\":{\"id\":\"5AjoWhww5SQi2VXd\",\"name\":\"Azure Open AI account\"}},\"typeVersion\":1},{\"id\":\"5e5c1c11-cf3d-47f4-91ce-14d7e3f493fb\",\"name\":\"Code\",\"type\":\"n8n-nodes-base.code\",\"position\":[240,-20],\"parameters\":{\"jsCode\":\"const items = $input.all();\\n\\nlet outputText = \\\"\\\";\\nlet poseNamesList = []; // New list to store only PoseNames\\n\\nitems.forEach(item => {\\n  const { PoseName, uri, url } = item.json;\\n  outputText += `Name: ${PoseName}\\\\nuri: ${uri}\\\\nurl: ${url}\\\\n\\\\n`;\\n  poseNamesList.push(PoseName); // Add PoseName to the list\\n});\\n\\nreturn [\\n  {\\n    json: {\\n      outputText,  // Original formatted text\\n      poseNamesOnly: poseNamesList.join('\\\\n') // New: PoseNames as text list\\n    }\\n  }\\n];\"},\"typeVersion\":2},{\"id\":\"864e2fbb-a9dc-43ba-918e-0197821de598\",\"name\":\"Line Push with Flex Bubble\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[1980,-80],\"parameters\":{\"url\":\"https://api.line.me/v2/bot/message/push\",\"method\":\"POST\",\"options\":{},\"jsonBody\":\"={{ $json.text }}\",\"sendBody\":true,\"specifyBody\":\"json\",\"authentication\":\"genericCredentialType\",\"genericAuthType\":\"httpHeaderAuth\"},\"credentials\":{\"httpHeaderAuth\":{\"id\":\"yiPG7xPwvDzsY0Qd\",\"name\":\"Line @511dizji\"}},\"retryOnFail\":false,\"typeVersion\":4.2},{\"id\":\"91e50734-8899-4d23-9a4f-ce637d9e5ed1\",\"name\":\"CombineAll\",\"type\":\"n8n-nodes-base.set\",\"position\":[1640,-100],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"9c82e62c-dfbc-4b09-899d-f4d1581e1c15\",\"name\":\"LineBody\",\"type\":\"string\",\"value\":\"={\\n  \\\"to\\\": \\\"Ue9cc622e33e5333e3784298412ec9aed\\\",\\n  \\\"messages\\\": [\\n    {\\n      \\\"type\\\": \\\"text\\\",\\n      \\\"text\\\": \\\"{{ $json.text.replaceAll(\\\"\\\\n\\\",\\\"\\\\\\\\n\\\").replaceAll(\\\"\\\\n\\\",\\\"\\\").removeMarkdown().removeTags().replaceAll('\\\"',\\\"\\\") }}\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"flex\\\",\\n      \\\"altText\\\": \\\"Yoga Poses Images\\\",\\n      \\\"contents\\\": {\\n        \\\"type\\\": \\\"carousel\\\",\\n        \\\"contents\\\": [  {{ $('WriteJSONflex').all().flatMap(item => JSON.stringify(item.json.output)).join(',') }}\\n\\n          ] \\n      }\\n    }\\n  ]\\n}\"}]}},\"typeVersion\":3.4},{\"id\":\"dc6d5dfe-66ad-49ca-b246-ee52f270269d\",\"name\":\"Fix JSON\",\"type\":\"@n8n/n8n-nodes-langchain.chainLlm\",\"position\":[1720,120],\"parameters\":{\"text\":\"=Fix this JSON\\n\\n{{ $json.LineBody }}\",\"messages\":{\"messageValues\":[{\"message\":\"=You are JSON formatter, You'll fix the JSON and return only the JSON that has been fixed. Do not explain or write anything else\"}]},\"promptType\":\"define\",\"hasOutputParser\":true},\"retryOnFail\":true,\"typeVersion\":1.5},{\"id\":\"a062cf06-f438-4d1e-9c0c-d2fc00f40071\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-300,-380],\"parameters\":{\"color\":5,\"width\":260,\"height\":240,\"content\":\"## YogiAI\\n\\nThis YogiAI is to provide daily reminder and pose of the day to the user via Line Push Message\\n\\nThe data will be generated from GoogleSheet Weighted Random Poses and Push to your Line at the scheduled time\\n\\n\"},\"typeVersion\":1},{\"id\":\"8d2184a9-af30-4b1e-826b-69a8f37d8256\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[0,-320],\"parameters\":{\"color\":4,\"width\":400,\"height\":500,\"content\":\"## Get the Data\\nThis is to get the data from GoogleSheet \\n\\nIn the range we got, we'll have PosesName, uri (image link), and url (link when clicked) \\n\\nThe sample is here \\nhttps://docs.google.com/spreadsheets/d/1eqLJsUL_QkOMy_qPzNCrUCZdx36asC8P1i3PowTQqLY/edit?usp=sharing\\n\\nThe data is from https://pocketyoga.com/pose/\\n\\n***YOU SHOULD UPDATE IT WITH YOUR OWN DATA***\"},\"typeVersion\":1},{\"id\":\"6d688a1c-90aa-4c3a-a868-946c61cec7cf\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[440,-320],\"parameters\":{\"color\":2,\"width\":540,\"height\":660,\"content\":\"## Write FlexMessage for Images\\n\\nTo send the information in Line, we need to write a JSON for Flex Message meaning that it can slides to show the images of the pose\\n\\nWe use auto-parser here to make sure the JSON followed the required format\\n\\nhttps://developers.line.biz/en/docs/messaging-api/using-flex-messages/\\n\\nYou can also use https://developers.line.biz/flex-simulator/?status=success to simulate the format \"},\"typeVersion\":1},{\"id\":\"e5b92f32-e282-49cd-8084-68e380572ee9\",\"name\":\"Sticky Note3\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1000,-320],\"parameters\":{\"color\":2,\"width\":540,\"height\":660,\"content\":\"## Write Text for Poses today \\n\\nThis node we want to have user friendly text such as with emojis, etc. So, we give Azure OpenAI the poses of today and ask it to rewrie\"},\"typeVersion\":1},{\"id\":\"38cc9d2f-be2c-4448-9746-5d533108df7c\",\"name\":\"Sticky Note4\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1600,-320],\"parameters\":{\"color\":3,\"width\":540,\"height\":660,\"content\":\"## Combine the result and push it via Line\\n\\n1) We used 'Edit Field' to combine all the output\\n(Hint: you can have input_txt and output_txt to debug your script here)\\n2) To make sure that our JSON is proper, we asked AI to fix it again. \\n3) Use Line Push >> Please replace \\\"to\\\" to your own UID and create the header authorization with the channel you have\\n\\nhttps://developers.line.biz/en/docs/messaging-api/sending-messages/\\n\"},\"typeVersion\":1},{\"id\":\"b88d6f78-ce54-4b83-b009-e4e22e518c7c\",\"name\":\"Sticky Note5\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[2200,-320],\"parameters\":{\"color\":6,\"width\":1020,\"height\":660,\"content\":\"## Write back the data into Log and Log2 \\n\\nWe used log2 to count how many time we send each poses and weighted this back into the 'Yoga' Sheet to make the random more random ;)\\n\\nTo put the data back, we also want to extract from the output and split it out to put back to google sheet\"},\"typeVersion\":1}],\"active\":false,\"pinData\":{},\"settings\":{\"timezone\":\"Asia/Bangkok\",\"callerPolicy\":\"workflowsFromSameOwner\",\"executionOrder\":\"v1\"},\"versionId\":\"8d3482ff-25e6-479f-a33b-b33d1aeb51fc\",\"connections\":{\"Code\":{\"main\":[[{\"node\":\"WriteJSONflex\",\"type\":\"main\",\"index\":0}]]},\"YogaLog\":{\"main\":[[{\"node\":\"AI Agent\",\"type\":\"main\",\"index\":0}]]},\"AI Agent\":{\"main\":[[{\"node\":\"Split Out\",\"type\":\"main\",\"index\":0}]]},\"Fix JSON\":{\"main\":[[{\"node\":\"Line Push with Flex Bubble\",\"type\":\"main\",\"index\":0}]]},\"YogaLog2\":{\"main\":[[]]},\"Split Out\":{\"main\":[[{\"node\":\"YogaLog2\",\"type\":\"main\",\"index\":0}]]},\"CombineAll\":{\"main\":[[{\"node\":\"Fix JSON\",\"type\":\"main\",\"index\":0}]]},\"Get PoseName\":{\"main\":[[{\"node\":\"Code\",\"type\":\"main\",\"index\":0}]]},\"WriteJSONflex\":{\"main\":[[{\"node\":\"WritePosesToday\",\"type\":\"main\",\"index\":0}]]},\"PosesDatabase1\":{\"ai_tool\":[[{\"node\":\"AI Agent\",\"type\":\"ai_tool\",\"index\":0}]]},\"WritePosesToday\":{\"main\":[[{\"node\":\"RewritePosesToday\",\"type\":\"main\",\"index\":0}]]},\"RewritePosesToday\":{\"main\":[[{\"node\":\"CombineAll\",\"type\":\"main\",\"index\":0}]]},\"Azure OpenAI Chat Model\":{\"ai_languageModel\":[[{\"node\":\"WriteJSONflex\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"Azure OpenAI Chat Model1\":{\"ai_languageModel\":[[{\"node\":\"Auto-fixing Output Parser\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"Azure OpenAI Chat Model2\":{\"ai_languageModel\":[[{\"node\":\"WritePosesToday\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"Azure OpenAI Chat Model3\":{\"ai_languageModel\":[[{\"node\":\"AI Agent\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"Azure OpenAI Chat Model4\":{\"ai_languageModel\":[[{\"node\":\"Fix JSON\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"Azure OpenAI Chat Model5\":{\"ai_languageModel\":[[{\"node\":\"RewritePosesToday\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"Azure OpenAI Chat Model6\":{\"ai_languageModel\":[[{\"node\":\"Auto-fixing Output Parser1\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"Structured Output Parser\":{\"ai_outputParser\":[[{\"node\":\"Auto-fixing Output Parser\",\"type\":\"ai_outputParser\",\"index\":0}]]},\"Auto-fixing Output Parser\":{\"ai_outputParser\":[[{\"node\":\"AI Agent\",\"type\":\"ai_outputParser\",\"index\":0}]]},\"Structured Output Parser1\":{\"ai_outputParser\":[[{\"node\":\"Auto-fixing Output Parser1\",\"type\":\"ai_outputParser\",\"index\":0}]]},\"Auto-fixing Output Parser1\":{\"ai_outputParser\":[[{\"node\":\"WriteJSONflex\",\"type\":\"ai_outputParser\",\"index\":0}]]},\"Line Push with Flex Bubble\":{\"main\":[[{\"node\":\"YogaLog\",\"type\":\"main\",\"index\":0}]]},\"Trigger 2130 YogaPosesToday\":{\"main\":[[{\"node\":\"Get PoseName\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "The YogiAI workflow automates sending daily yoga pose reminders and related information via Line Push Messages . This automation leverages data from a Google Sheets database containing yoga pose details such as names, image URLs, and links to ensure users receive personalized and engaging content every day.\n\n**Purpose**\n\n  * Provide users with daily yoga pose suggestions tailored to their practice.\n  * Deliver visually appealing and informative content through Line's Flex Messages, including images and clickable links.\n  * Log user interactions and preferences back into Google Sheets to refine future recommendations.\n\n\n\n**Key Features**\n\n  1. Automated Daily Reminders : Sends a curated list of yoga poses at a scheduled time (21:30 Bangkok time).\n  2. Dynamic Content Generation : Uses AI to rewrite and format messages in a user-friendly manner, complete with emojis and clear instructions.\n  3. Integration with Google Sheets : Pulls data from a predefined Google Sheet and logs interactions for continuous improvement.\n  4. Customizable Messaging : Ensures JSON outputs are properly formatted for Line’s Flex Message API, allowing for interactive and visually rich content.\n\n\n\n**Data Source**  \nGoogle Sheets Structure  \nThe workflow relies on a Google Sheet structured as follows:\n\nPoseName : The name of the yoga pose.  \nuri : The image URL representing the pose.  \nurl : A clickable link directing users to more information about the pose.\n\nSample Data Layout  \nSupine Angle  \n<https://example.com/SupineAngle-tn146.png>  \n<https://example.com/pose/SupineAngle>  \nWarrior II  \n<https://example.com/WarriorII-tn146.png>  \n<https://example.com/pose/WarriorII>\n\n*Note : Ensure that you update the Google Sheet with your own data. Refer to this sample sheet for reference. *\n\n**Scheduled Trigger**  \nThe workflow is triggered daily at 21:30 (9:30 PM) Bangkok Time (Asia/Bangkok) . This ensures timely delivery of reminders to users, keeping them engaged with their yoga practice.\n\n**Workflow Process**\n\n  1. **Data Retrieval**  \nNode: Get PoseName  \nFetches yoga pose details from the specified range in the Google Sheet.\n  2. **Content Generation**  \nNode: WritePosesToday  \nUtilizes Azure OpenAI to craft user-friendly text, complete with emojis and clear instructions.  \nNode: RewritePosesToday  \nFormats the AI-generated text specifically for Line messaging, ensuring compatibility and visual appeal.\n  3. **JSON Formatting**  \nNode: WriteJSONflex  \nGenerates JSON structures required for Line’s Flex Messages, enabling carousel displays of yoga pose images and links.  \nNode: Fix JSON  \nEnsures all JSON outputs are correctly formatted before being sent via Line.\n  4. **Message Delivery**  \nNode: Line Push with Flex Bubble  \nSends the final message, including both text and Flex Message carousels, directly to users via Line Push Messages.\n  5. **Logging Interactions**  \nNodes: YogaLog & YogaLog2  \nLogs each interaction back into Google Sheets to track which poses were sent and how often they appear, refining future recommendations.\n\n\n\n**Setup Prerequisites**  \n_Google Sheets Account_ : Set up a Google Sheet with the required structure and populate it with your yoga pose data.  \n_Line Developer Account_ : Create a Line channel to obtain necessary credentials for sending push messages.  \n_Azure OpenAI Account_ : Configure access to Azure OpenAI services for generating and formatting content.\n\n**Intended Audience**  \nThis workflow is ideal for:\n\n  * Yoga Instructors : Seeking to engage students with daily pose suggestions.\n  * Fitness Enthusiasts : Looking to maintain consistency in their yoga practice.\n  * Content Creators : Interested in automating personalized and visually appealing content distribution.\n\n\n",
  "readme_html": "<!--[--><div data-v-50766329=\"\"><p>The YogiAI workflow automates sending daily yoga pose reminders and related information via Line Push Messages . This automation leverages data from a Google Sheets database containing yoga pose details such as names, image URLs, and links to ensure users receive personalized and engaging content every day.</p>\n<p><strong>Purpose</strong></p>\n<ul>\n<li>Provide users with daily yoga pose suggestions tailored to their practice.</li>\n<li>Deliver visually appealing and informative content through Line's Flex Messages, including images and clickable links.</li>\n<li>Log user interactions and preferences back into Google Sheets to refine future recommendations.</li>\n</ul>\n<p><strong>Key Features</strong></p>\n<ol>\n<li>Automated Daily Reminders : Sends a curated list of yoga poses at a scheduled time (21:30 Bangkok time).</li>\n<li>Dynamic Content Generation : Uses AI to rewrite and format messages in a user-friendly manner, complete with emojis and clear instructions.</li>\n<li>Integration with Google Sheets : Pulls data from a predefined Google Sheet and logs interactions for continuous improvement.</li>\n<li>Customizable Messaging : Ensures JSON outputs are properly formatted for Line’s Flex Message API, allowing for interactive and visually rich content.</li>\n</ol>\n<p><strong>Data Source</strong><br>\nGoogle Sheets Structure<br>\nThe workflow relies on a Google Sheet structured as follows:</p>\n<p>PoseName : The name of the yoga pose.<br>\nuri : The image URL representing the pose.<br>\nurl : A clickable link directing users to more information about the pose.</p>\n<p>Sample Data Layout<br>\nSupine Angle<br>\n<a href=\"https://example.com/SupineAngle-tn146.png\" rel=\"ugc nofollow\" target=\"_blank\">https://example.com/SupineAngle-tn146.png</a><br>\n<a href=\"https://example.com/pose/SupineAngle\" rel=\"ugc nofollow\" target=\"_blank\">https://example.com/pose/SupineAngle</a><br>\nWarrior II<br>\n<a href=\"https://example.com/WarriorII-tn146.png\" rel=\"ugc nofollow\" target=\"_blank\">https://example.com/WarriorII-tn146.png</a><br>\n<a href=\"https://example.com/pose/WarriorII\" rel=\"ugc nofollow\" target=\"_blank\">https://example.com/pose/WarriorII</a></p>\n<p>*Note : Ensure that you update the Google Sheet with your own data. Refer to this sample sheet for reference. *</p>\n<p><strong>Scheduled Trigger</strong><br>\nThe workflow is triggered daily at 21:30 (9:30 PM) Bangkok Time (Asia/Bangkok) . This ensures timely delivery of reminders to users, keeping them engaged with their yoga practice.</p>\n<p><strong>Workflow Process</strong></p>\n<ol>\n<li><strong>Data Retrieval</strong><br>\nNode: Get PoseName<br>\nFetches yoga pose details from the specified range in the Google Sheet.</li>\n<li><strong>Content Generation</strong><br>\nNode: WritePosesToday<br>\nUtilizes Azure OpenAI to craft user-friendly text, complete with emojis and clear instructions.<br>\nNode: RewritePosesToday<br>\nFormats the AI-generated text specifically for Line messaging, ensuring compatibility and visual appeal.</li>\n<li><strong>JSON Formatting</strong><br>\nNode: WriteJSONflex<br>\nGenerates JSON structures required for Line’s Flex Messages, enabling carousel displays of yoga pose images and links.<br>\nNode: Fix JSON<br>\nEnsures all JSON outputs are correctly formatted before being sent via Line.</li>\n<li><strong>Message Delivery</strong><br>\nNode: Line Push with Flex Bubble<br>\nSends the final message, including both text and Flex Message carousels, directly to users via Line Push Messages.</li>\n<li><strong>Logging Interactions</strong><br>\nNodes: YogaLog &amp; YogaLog2<br>\nLogs each interaction back into Google Sheets to track which poses were sent and how often they appear, refining future recommendations.</li>\n</ol>\n<p><strong>Setup Prerequisites</strong><br>\n<em>Google Sheets Account</em> : Set up a Google Sheet with the required structure and populate it with your yoga pose data.<br>\n<em>Line Developer Account</em> : Create a Line channel to obtain necessary credentials for sending push messages.<br>\n<em>Azure OpenAI Account</em> : Configure access to Azure OpenAI services for generating and formatting content.</p>\n<p><strong>Intended Audience</strong><br>\nThis workflow is ideal for:</p>\n<ul>\n<li>Yoga Instructors : Seeking to engage students with daily pose suggestions.</li>\n<li>Fitness Enthusiasts : Looking to maintain consistency in their yoga practice.</li>\n<li>Content Creators : Interested in automating personalized and visually appealing content distribution.</li>\n</ul>\n</div><!--]-->",
  "readme_zh": "YogiAI工作流通过Line推送消息自动发送每日瑜伽体式提醒及相关信息。该自动化系统利用谷歌表格数据库中存储的体式名称、图片链接和详情页网址等数据，确保用户每天都能收到个性化且富有吸引力的内容。\n\n**核心目标**\n\n  * 根据用户练习习惯推送定制化每日体式推荐\n  * 通过Line Flex Messages发送图文并茂的内容（含可点击链接）\n  * 记录用户互动偏好至谷歌表格以优化后续推荐\n\n**核心功能**\n\n  1. 自动化每日提醒 ：每天曼谷时间21:30准时发送精选体式列表\n  2. 动态内容生成 ：AI重写排版消息内容，添加表情符号和清晰指引\n  3. 谷歌表格集成 ：从预设表格调取数据并记录互动日志\n  4. 可定制消息 ：确保JSON输出符合Line Flex Message API规范，实现交互式图文展示\n\n**数据来源**  \n谷歌表格结构  \n工作流依赖包含以下字段的表格：\n\n体式名称 ：瑜伽体式标准名称  \n图片链接 ：体式示意图URL  \n详情链接 ：跳转至体式详解页面的网址\n\n示例数据  \n仰卧角式  \n<https://example.com/SupineAngle-tn146.png>  \n<https://example.com/pose/SupineAngle>  \n战士二式  \n<https://example.com/WarriorII-tn146.png>  \n<https://example.com/pose/WarriorII>\n\n*注：请根据实际需求更新表格数据，可参考示例表格结构*\n\n**定时触发**  \n每日曼谷时间21:30（亚洲/曼谷时区）自动触发工作流，确保持续激活用户练习热情。\n\n**工作流程**\n\n  1. **数据获取**  \n节点：Get PoseName  \n从谷歌表格指定范围获取体式数据\n  2. **内容生成**  \n节点：WritePosesToday  \n调用Azure OpenAI生成含表情符号的友好文本  \n节点：RewritePosesToday  \n优化文本格式适配Line消息规范\n  3. **JSON格式化**  \n节点：WriteJSONflex  \n构建Line Flex Message所需的轮播图JSON结构  \n节点：Fix JSON  \n校验JSON格式确保发送兼容性\n  4. **消息推送**  \n节点：Line Push with Flex Bubble  \n通过Line推送消息（含文本+图文轮播）\n  5. **互动记录**  \n节点：YogaLog & YogaLog2  \n将推送记录回写至谷歌表格，用于分析体式推送频率\n\n**环境准备**  \n_谷歌账户_ ：创建符合结构的表格并录入体式数据  \n_Line开发者账号_ ：申请消息推送所需的频道凭证  \n_Azure OpenAI服务_ ：配置内容生成API访问权限\n\n**适用人群**  \n本工作流特别适合：\n\n  * 瑜伽教练 ：希望为学员提供每日体式指导\n  * 健身爱好者 ：需要规律练习提醒\n  * 内容创作者 ：寻求自动化推送个性化健身内容",
  "title_zh": "通过LINE获取每日弹性锻炼计划",
  "publish_date_zh": "最后更新于2个月前",
  "workflow_json_zh": "{\n  \"id\": \"2DzQ1FH11S3Gp6wn\",\n  \"meta\": {\n    \"instanceId\": \"558d88703fb65b2d0e44613bc35916258b0f0bf983c5d4730c00c424b77ca36a\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"name\": \"YogiAI\",\n  \"tags\": [],\n  \"nodes\": [\n    {\n      \"id\": \"2afc390e-d774-4db4-a52f-138f13837646\",\n      \"name\": \"Azure OpenAI Chat Model2\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatAzureOpenAi\",\n      \"position\": [\n        1040,\n        0\n      ],\n      \"parameters\": {\n        \"model\": \"4o\",\n        \"options\": {\n          \"temperature\": 0.8\n        }\n      },\n      \"credentials\": {\n        \"azureOpenAiApi\": {\n          \"id\": \"5AjoWhww5SQi2VXd\",\n          \"name\": \"Azure Open AI account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"529d9ed9-3ae5-41cb-983e-874aa37ee1c7\",\n      \"name\": \"YogaLog\",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"position\": [\n        2240,\n        -100\n      ],\n      \"parameters\": {\n        \"columns\": {\n          \"value\": {\n            \"Date\": \"={{ $('Trigger 2130 YogaPosesToday').first().json.timestamp }}\",\n            \"JSON\": \"={{ $('CombineAll').item.json.LineBody }}\",\n            \"Text\": \"={{ $('RewritePosesToday').item.json.text }}\"\n          },\n          \"schema\": [\n            {\n              \"id\": \"Date\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"Date\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Text\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"Text\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"JSON\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"JSON\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            }\n          ],\n          \"mappingMode\": \"defineBelow\",\n          \"matchingColumns\": [\n            \"Date\"\n          ],\n          \"attemptToConvertTypes\": false,\n          \"convertFieldsToString\": false\n        },\n        \"options\": {},\n        \"operation\": \"append\",\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": 325576327,\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1s_yzDNbbtXhfoOKUlmBHwhgWkR2FuoiKz4WQOu4tQmk/edit#gid=325576327\",\n          \"cachedResultName\": \"YogaLog\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"1s_yzDNbbtXhfoOKUlmBHwhgWkR2FuoiKz4WQOu4tQmk\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1s_yzDNbbtXhfoOKUlmBHwhgWkR2FuoiKz4WQOu4tQmk/edit?usp=drivesdk\",\n          \"cachedResultName\": \"SerenityAI\"\n        }\n      },\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"TKSdrVOdpgxWBVk8\",\n          \"name\": \"Google Sheets account\"\n        }\n      },\n      \"typeVersion\": 4.5\n    },\n    {\n      \"id\": \"d491b5c3-31ab-49b2-abc3-8c2a67cf9571\",\n      \"name\": \"Azure OpenAI Chat Model3\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatAzureOpenAi\",\n      \"position\": [\n        2360,\n        120\n      ],\n      \"parameters\": {\n        \"model\": \"4o\",\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"azureOpenAiApi\": {\n          \"id\": \"5AjoWhww5SQi2VXd\",\n          \"name\": \"Azure Open AI account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"3b1ebdcb-9e6b-437c-8f51-944218c0c276\",\n      \"name\": \"Auto-fixing Output Parser\",\n      \"type\": \"@n8n/n8n-nodes-langchain.outputParserAutofixing\",\n      \"position\": [\n        2520,\n        80\n      ],\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"3fc67522-501c-4e43-bf9d-b367d57ad4f9\",\n      \"name\": \"Azure OpenAI Chat Model1\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatAzureOpenAi\",\n      \"position\": [\n        2540,\n        120\n      ],\n      \"parameters\": {\n        \"model\": \"4o\",\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"azureOpenAiApi\": {\n          \"id\": \"5AjoWhww5SQi2VXd\",\n          \"name\": \"Azure Open AI account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"19bd208b-a5c5-47b3-a2cc-e92a71444be7\",\n      \"name\": \"Structured Output Parser\",\n      \"type\": \"@n8n/n8n-nodes-langchain.outputParserStructured\",\n      \"position\": [\n        2640,\n        220\n      ],\n      \"parameters\": {\n        \"schemaType\": \"manual\",\n        \"inputSchema\": \"{\\n  \\\"type\\\": \\\"object\\\",\\n  \\\"properties\\\": {\\n    \\\"yogaPoses\\\": {\\n      \\\"type\\\": \\\"array\\\",\\n      \\\"items\\\": {\\n        \\\"type\\\": \\\"object\\\",\\n        \\\"properties\\\": {\\n          \\\"sequence\\\": { \\\"type\\\": \\\"integer\\\" },\\n          \\\"name\\\": { \\\"type\\\": \\\"string\\\" }\\n        },\\n        \\\"required\\\": [\\\"sequence\\\", \\\"name\\\"],\\n        \\\"additionalProperties\\\": false\\n      }\\n    }\\n  },\\n  \\\"required\\\": [\\\"yogaPoses\\\"]\\n}\"\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"2bf3f3d3-84c7-4fd4-b1b9-8c0fb7df44b1\",\n      \"name\": \"AI Agent\",\n      \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n      \"position\": [\n        2400,\n        -60\n      ],\n      \"parameters\": {\n        \"text\": \"=You'll change this into properly format of JSON without having emoji. You'll also make sure the name is matched the data in googlesheet\\n\\n {{ $json.Text }}\",\n        \"options\": {},\n        \"promptType\": \"define\",\n        \"hasOutputParser\": true\n      },\n      \"typeVersion\": 1.7\n    },\n    {\n      \"id\": \"fa3fc89e-54d8-4706-af59-72dbd80fbef4\",\n      \"name\": \"PosesDatabase1\",\n      \"type\": \"n8n-nodes-base.googleSheetsTool\",\n      \"position\": [\n        2480,\n        220\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": 1104924292,\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1s_yzDNbbtXhfoOKUlmBHwhgWkR2FuoiKz4WQOu4tQmk/edit#gid=1104924292\",\n          \"cachedResultName\": \"Yoga\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"1s_yzDNbbtXhfoOKUlmBHwhgWkR2FuoiKz4WQOu4tQmk\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1s_yzDNbbtXhfoOKUlmBHwhgWkR2FuoiKz4WQOu4tQmk/edit?usp=drivesdk\",\n          \"cachedResultName\": \"SerenityAI\"\n        },\n        \"descriptionType\": \"manual\",\n        \"toolDescription\": \"Yoga Poses Database to read\\n\"\n      },\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"TKSdrVOdpgxWBVk8\",\n          \"name\": \"Google Sheets account\"\n        }\n      },\n      \"typeVersion\": 4.5\n    },\n    {\n      \"id\": \"ff7bd540-c89b-43d1-bb07-bb060a6b4ba6\",\n      \"name\": \"YogaLog2\",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"position\": [\n        2980,\n        20\n      ],\n      \"parameters\": {\n        \"columns\": {\n          \"value\": {\n            \"Date\": \"={{ $('Trigger 2130 YogaPosesToday').first().json.timestamp }}\",\n            \"Pose\": \"={{ $json.name }}\",\n            \"Sequence\": \"={{ $json.sequence }}\"\n          },\n          \"schema\": [\n            {\n              \"id\": \"Date\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"Date\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Sequence\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"Sequence\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Pose\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"Pose\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            }\n          ],\n          \"mappingMode\": \"defineBelow\",\n          \"matchingColumns\": [\n            \"Date\"\n          ],\n          \"attemptToConvertTypes\": false,\n          \"convertFieldsToString\": false\n        },\n        \"options\": {},\n        \"operation\": \"append\",\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": 2060471945,\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1s_yzDNbbtXhfoOKUlmBHwhgWkR2FuoiKz4WQOu4tQmk/edit#gid=2060471945\",\n          \"cachedResultName\": \"YogaLog2\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"1s_yzDNbbtXhfoOKUlmBHwhgWkR2FuoiKz4WQOu4tQmk\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1s_yzDNbbtXhfoOKUlmBHwhgWkR2FuoiKz4WQOu4tQmk/edit?usp=drivesdk\",\n          \"cachedResultName\": \"SerenityAI\"\n        }\n      },\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"TKSdrVOdpgxWBVk8\",\n          \"name\": \"Google Sheets account\"\n        }\n      },\n      \"typeVersion\": 4.5\n    },\n    {\n      \"id\": \"f649c5b9-fad1-412c-8389-ed53b95e5583\",\n      \"name\": \"Split Out\",\n      \"type\": \"n8n-nodes-base.splitOut\",\n      \"position\": [\n        2740,\n        -120\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"fieldToSplitOut\": \"output.yogaPoses\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"8194e695-fa9e-4555-9da5-b7dbdc1b0e4a\",\n      \"name\": \"Trigger 2130 YogaPosesToday\",\n      \"type\": \"n8n-nodes-base.scheduleTrigger\",\n      \"position\": [\n        -200,\n        -20\n      ],\n      \"parameters\": {\n        \"rule\": {\n          \"interval\": [\n            {\n              \"triggerAtHour\": 21,\n              \"triggerAtMinute\": 30\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"3b5706d8-4968-4b9c-a255-7d1f806d85dc\",\n      \"name\": \"Azure OpenAI Chat Model5\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatAzureOpenAi\",\n      \"position\": [\n        1340,\n        180\n      ],\n      \"parameters\": {\n        \"model\": \"4o\",\n        \"options\": {\n          \"temperature\": 0.9\n        }\n      },\n      \"credentials\": {\n        \"azureOpenAiApi\": {\n          \"id\": \"5AjoWhww5SQi2VXd\",\n          \"name\": \"Azure Open AI account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"acee6e43-f094-4f30-bffb-6c56b0425327\",\n      \"name\": \"Get PoseName\",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"position\": [\n        40,\n        -20\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"dataLocationOnSheet\": {\n            \"values\": {\n              \"range\": \"B18:D28\",\n              \"rangeDefinition\": \"specifyRangeA1\"\n            }\n          }\n        },\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": 2035276041,\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1s_yzDNbbtXhfoOKUlmBHwhgWkR2FuoiKz4WQOu4tQmk/edit#gid=2035276041\",\n          \"cachedResultName\": \"NotePad\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"1s_yzDNbbtXhfoOKUlmBHwhgWkR2FuoiKz4WQOu4tQmk\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1s_yzDNbbtXhfoOKUlmBHwhgWkR2FuoiKz4WQOu4tQmk/edit?usp=drivesdk\",\n          \"cachedResultName\": \"SerenityAI\"\n        }\n      },\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"TKSdrVOdpgxWBVk8\",\n          \"name\": \"Google Sheets account\"\n        }\n      },\n      \"typeVersion\": 4.5\n    },\n    {\n      \"id\": \"6be3a88c-4e0f-44e6-97c1-eafa13230ae7\",\n      \"name\": \"WritePosesToday\",\n      \"type\": \"@n8n/n8n-nodes-langchain.chainLlm\",\n      \"position\": [\n        1120,\n        -160\n      ],\n      \"parameters\": {\n        \"text\": \"=Let's calm down and focus on these poses today.\\n\\n{{ $('Code').item.json.poseNamesOnly }}\\n\\nhave a great practice!\",\n        \"messages\": {\n          \"messageValues\": [\n            {\n              \"message\": \"=You're experienced yoga instructor. You'll say the topic and asking the student to focus on practice today. You'll later give the yoga poses list for practicing today. You will also include related pose or variation from the list. You'll make sure to include all the poses from the list.\\n\"\n            }\n          ]\n        },\n        \"promptType\": \"define\"\n      },\n      \"retryOnFail\": true,\n      \"typeVersion\": 1.5\n    },\n    {\n      \"id\": \"8d9cdf4c-a432-44ff-a0a3-133fbc8e9daa\",\n      \"name\": \"RewritePosesToday\",\n      \"type\": \"@n8n/n8n-nodes-langchain.chainLlm\",\n      \"position\": [\n        1180,\n        60\n      ],\n      \"parameters\": {\n        \"text\": \"={{ $json.text }}\",\n        \"messages\": {\n          \"messageValues\": [\n            {\n              \"message\": \"=You'll format and add emoji before the poses name to make it chat-friendly to send via Line. You will only return the message to be sent.\\n\\nIf the message is too long, you'll split by ====== to 3 messages\\n\"\n            }\n          ]\n        },\n        \"promptType\": \"define\"\n      },\n      \"retryOnFail\": true,\n      \"typeVersion\": 1.5\n    },\n    {\n      \"id\": \"2e419654-1f83-48df-8ac0-9ec621444cc2\",\n      \"name\": \"Azure OpenAI Chat Model\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatAzureOpenAi\",\n      \"position\": [\n        480,\n        100\n      ],\n      \"parameters\": {\n        \"model\": \"4o\",\n        \"options\": {\n          \"temperature\": 0.9\n        }\n      },\n      \"credentials\": {\n        \"azureOpenAiApi\": {\n          \"id\": \"5AjoWhww5SQi2VXd\",\n          \"name\": \"Azure Open AI account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"ad1bf966-114e-4bb8-abff-f5768e907aff\",\n      \"name\": \"WriteJSONflex\",\n      \"type\": \"@n8n/n8n-nodes-langchain.chainLlm\",\n      \"position\": [\n        580,\n        -80\n      ],\n      \"parameters\": {\n        \"text\": \"={{ $json.outputText }}\",\n        \"messages\": {\n          \"messageValues\": [\n            {\n              \"message\": \"=You are JSON parser, you'll write JSON in this format for all the row in 'GetPoseName' You'll notice the differnet between uri and url.\\n\\n{\\n\\\"type\\\": \\\"bubble\\\",\\n\\\"hero\\\": {\\n\\\"type\\\": \\\"image\\\",\\n\\\"url\\\": \\\"https://pocketyoga.com/assets/images/thumbnails146/SupineAngle-tn146.png \\\", \\n\\\"size\\\": \\\"full\\\",\\n\\\"aspectRatio\\\": \\\"20:13\\\",\\n\\\"aspectMode\\\": \\\"fit\\\",\\n\\\"action\\\": {\\n\\\"type\\\": \\\"uri\\\",\\n\\\"uri\\\": \\\"https://pocketyoga.com/pose/SupineAngle \\\"\\n}\\n},\\n\\\"body\\\": {\\n\\\"type\\\": \\\"box\\\",\\n\\\"layout\\\": \\\"vertical\\\",\\n\\\"contents\\\": [\\n{\\n\\\"type\\\": \\\"text\\\",\\n\\\"text\\\": \\\"Supine Angle (supta konasana)\\\",\\n\\\"size\\\": \\\"lg\\\",\\n\\\"wrap\\\": true,\\n\\\"action\\\": {\\n\\\"type\\\": \\\"message\\\",\\n\\\"label\\\": \\\"action\\\",\\n\\\"text\\\": \\\"Supine Angle (supta konasana)\\\"\\n}\\n}\\n]\\n}\\n},\\n{\\n\\\"type\\\": \\\"bubble\\\",\\n\\\"hero\\\": {\\n\\\"type\\\": \\\"image\\\",\\n\\\"url\\\": \\\"https://pocketyoga.com/assets/images/thumbnails146/SupineAngle-tn146.png \\\",\\n\\\"size\\\": \\\"full\\\",\\n\\\"aspectRatio\\\": \\\"20:13\\\",\\n\\\"aspectMode\\\": \\\"fit\\\",\\n\\\"action\\\": {\\n\\\"type\\\": \\\"uri\\\",\\n\\\"uri\\\": \\\"https://pocketyoga.com/pose/SupineAngle \\\"\\n}\\n},\\n\\\"body\\\": {\\n\\\"type\\\": \\\"box\\\",\\n\\\"layout\\\": \\\"vertical\\\",\\n\\\"contents\\\": [\\n{\\n\\\"type\\\": \\\"text\\\",\\n\\\"text\\\": \\\"Supine Angle (supta konasana)\\\",\\n\\\"size\\\": \\\"lg\\\",\\n\\\"wrap\\\": true,\\n\\\"action\\\": {\\n\\\"type\\\": \\\"message\\\",\\n\\\"label\\\": \\\"action\\\",\\n\\\"text\\\": \\\"Supine Angle (supta konasana)\\\"\\n}\\n}\\n]\\n}\\n}\"\n            }\n          ]\n        },\n        \"promptType\": \"define\",\n        \"hasOutputParser\": true\n      },\n      \"retryOnFail\": true,\n      \"typeVersion\": 1.5\n    },\n    {\n      \"id\": \"1e6af9e5-675d-4d9a-aba6-304d218ea138\",\n      \"name\": \"Structured Output Parser1\",\n      \"type\": \"@n8n/n8n-nodes-langchain.outputParserStructured\",\n      \"position\": [\n        780,\n        220\n      ],\n      \"parameters\": {\n        \"jsonSchemaExample\": \"[\\n  {\\n    \\\"type\\\": \\\"bubble\\\",\\n    \\\"hero\\\": {\\n      \\\"type\\\": \\\"image\\\",\\n      \\\"url\\\": \\\"https://pocketyoga.com/assets/images/thumbnails146/SupineAngle-tn146.png\\\",\\n      \\\"size\\\": \\\"full\\\",\\n      \\\"aspectRatio\\\": \\\"20:13\\\",\\n      \\\"aspectMode\\\": \\\"fit\\\",\\n      \\\"action\\\": {\\n        \\\"type\\\": \\\"uri\\\",\\n        \\\"uri\\\": \\\"https://pocketyoga.com/pose/SupineAngle\\\"\\n      }\\n    },\\n    \\\"body\\\": {\\n      \\\"type\\\": \\\"box\\\",\\n      \\\"layout\\\": \\\"vertical\\\",\\n      \\\"contents\\\": [\\n        {\\n          \\\"type\\\": \\\"text\\\",\\n          \\\"text\\\": \\\"Supine Angle (supta konasana)\\\",\\n          \\\"size\\\": \\\"lg\\\",\\n          \\\"wrap\\\": true,\\n          \\\"action\\\": {\\n            \\\"type\\\": \\\"message\\\",\\n            \\\"label\\\": \\\"action\\\",\\n            \\\"text\\\": \\\"Supine Angle (supta konasana)\\\"\\n          }\\n        }\\n      ]\\n    }\\n  },\\n  {\\n    \\\"type\\\": \\\"bubble\\\",\\n    \\\"hero\\\": {\\n      \\\"type\\\": \\\"image\\\",\\n      \\\"url\\\": \\\"https://pocketyoga.com/assets/images/thumbnails146/SupineAngle-tn146.png\\\",\\n      \\\"size\\\": \\\"full\\\",\\n      \\\"aspectRatio\\\": \\\"20:13\\\",\\n      \\\"aspectMode\\\": \\\"fit\\\",\\n      \\\"action\\\": {\\n        \\\"type\\\": \\\"uri\\\",\\n        \\\"uri\\\": \\\"https://pocketyoga.com/pose/SupineAngle\\\"\\n      }\\n    },\\n    \\\"body\\\": {\\n      \\\"type\\\": \\\"box\\\",\\n      \\\"layout\\\": \\\"vertical\\\",\\n      \\\"contents\\\": [\\n        {\\n          \\\"type\\\": \\\"text\\\",\\n          \\\"text\\\": \\\"Supine Angle (supta konasana)\\\",\\n          \\\"size\\\": \\\"lg\\\",\\n          \\\"wrap\\\": true,\\n          \\\"action\\\": {\\n            \\\"type\\\": \\\"message\\\",\\n            \\\"label\\\": \\\"action\\\",\\n            \\\"text\\\": \\\"Supine Angle (supta konasana)\\\"\\n          }\\n        }\\n      ]\\n    }\\n  }\\n]\"\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"5559c5b9-6c2c-4adb-9544-79be3f1f85d1\",\n      \"name\": \"Auto-fixing Output Parser1\",\n      \"type\": \"@n8n/n8n-nodes-langchain.outputParserAutofixing\",\n      \"position\": [\n        680,\n        80\n      ],\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"2335f74e-3fe6-4720-bb88-1bbda320ae8b\",\n      \"name\": \"Azure OpenAI Chat Model6\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatAzureOpenAi\",\n      \"position\": [\n        640,\n        200\n      ],\n      \"parameters\": {\n        \"model\": \"4o\",\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"azureOpenAiApi\": {\n          \"id\": \"5AjoWhww5SQi2VXd\",\n          \"name\": \"Azure Open AI account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"83d02971-bdf6-4c45-b705-f2f49fa49525\",\n      \"name\": \"Azure OpenAI Chat Model4\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatAzureOpenAi\",\n      \"position\": [\n        1780,\n        200\n      ],\n      \"parameters\": {\n        \"model\": \"4o\",\n        \"options\": {\n          \"temperature\": 0.5\n        }\n      },\n      \"credentials\": {\n        \"azureOpenAiApi\": {\n          \"id\": \"5AjoWhww5SQi2VXd\",\n          \"name\": \"Azure Open AI account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"5e5c1c11-cf3d-47f4-91ce-14d7e3f493fb\",\n      \"name\": \"Code\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        240,\n        -20\n      ],\n      \"parameters\": {\n        \"jsCode\": \"const items = $input.all();\\n\\nlet outputText = \\\"\\\";\\nlet poseNamesList = []; // New list to store only PoseNames\\n\\nitems.forEach(item => {\\n  const { PoseName, uri, url } = item.json;\\n  outputText += `Name: ${PoseName}\\\\nuri: ${uri}\\\\nurl: ${url}\\\\n\\\\n`;\\n  poseNamesList.push(PoseName); // Add PoseName to the list\\n});\\n\\nreturn [\\n  {\\n    json: {\\n      outputText,  // Original formatted text\\n      poseNamesOnly: poseNamesList.join('\\\\n') // New: PoseNames as text list\\n    }\\n  }\\n];\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"864e2fbb-a9dc-43ba-918e-0197821de598\",\n      \"name\": \"Line Push with Flex Bubble\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1980,\n        -80\n      ],\n      \"parameters\": {\n        \"url\": \"https://api.line.me/v2/bot/message/push\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"jsonBody\": \"={{ $json.text }}\",\n        \"sendBody\": true,\n        \"specifyBody\": \"json\",\n        \"authentication\": \"genericCredentialType\",\n        \"genericAuthType\": \"httpHeaderAuth\"\n      },\n      \"credentials\": {\n        \"httpHeaderAuth\": {\n          \"id\": \"yiPG7xPwvDzsY0Qd\",\n          \"name\": \"Line @511dizji\"\n        }\n      },\n      \"retryOnFail\": false,\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"91e50734-8899-4d23-9a4f-ce637d9e5ed1\",\n      \"name\": \"CombineAll\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1640,\n        -100\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"9c82e62c-dfbc-4b09-899d-f4d1581e1c15\",\n              \"name\": \"LineBody\",\n              \"type\": \"string\",\n              \"value\": \"={\\n  \\\"to\\\": \\\"Ue9cc622e33e5333e3784298412ec9aed\\\",\\n  \\\"messages\\\": [\\n    {\\n      \\\"type\\\": \\\"text\\\",\\n      \\\"text\\\": \\\"{{ $json.text.replaceAll(\\\"\\\\n\\\",\\\"\\\\\\\\n\\\").replaceAll(\\\"\\\\n\\\",\\\"\\\").removeMarkdown().removeTags().replaceAll('\\\"',\\\"\\\") }}\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"flex\\\",\\n      \\\"altText\\\": \\\"Yoga Poses Images\\\",\\n      \\\"contents\\\": {\\n        \\\"type\\\": \\\"carousel\\\",\\n        \\\"contents\\\": [  {{ $('WriteJSONflex').all().flatMap(item => JSON.stringify(item.json.output)).join(',') }}\\n\\n          ] \\n      }\\n    }\\n  ]\\n}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"dc6d5dfe-66ad-49ca-b246-ee52f270269d\",\n      \"name\": \"Fix JSON\",\n      \"type\": \"@n8n/n8n-nodes-langchain.chainLlm\",\n      \"position\": [\n        1720,\n        120\n      ],\n      \"parameters\": {\n        \"text\": \"=Fix this JSON\\n\\n{{ $json.LineBody }}\",\n        \"messages\": {\n          \"messageValues\": [\n            {\n              \"message\": \"=You are JSON formatter, You'll fix the JSON and return only the JSON that has been fixed. Do not explain or write anything else\"\n            }\n          ]\n        },\n        \"promptType\": \"define\",\n        \"hasOutputParser\": true\n      },\n      \"retryOnFail\": true,\n      \"typeVersion\": 1.5\n    },\n    {\n      \"id\": \"a062cf06-f438-4d1e-9c0c-d2fc00f40071\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -300,\n        -380\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 260,\n        \"height\": 240,\n        \"content\": \"## 瑜伽AI助手\\n\\n这款瑜伽AI助手旨在通过Line推送消息为用户提供每日练习提醒和推荐体式\\n\\n系统将从谷歌表格中通过加权随机算法选取体式数据，并在预定时间推送至您的Line账号\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"8d2184a9-af30-4b1e-826b-69a8f37d8256\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        0,\n        -320\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 400,\n        \"height\": 500,\n        \"content\": \"## 获取数据\\n此步骤用于从Google表格中获取数据\\n\\n在获取的数据范围内，我们将包含姿势名称（PosesName）、图片链接（uri）以及点击跳转链接（url）\\n\\n示例数据可在此查看\\nhttps://docs.google.com/spreadsheets/d/1eqLJsUL_QkOMy_qPzNCrUCZdx36asC8P1i3PowTQqLY/edit?usp=sharing\\n\\n原始数据来源自 https://pocketyoga.com/pose/\\n\\n***请务必替换为您自己的数据***\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"6d688a1c-90aa-4c3a-a868-946c61cec7cf\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        440,\n        -320\n      ],\n      \"parameters\": {\n        \"color\": 2,\n        \"width\": 540,\n        \"height\": 660,\n        \"content\": \"## 编写图片的FlexMessage\\n\\n为了在Line上发送信息，我们需要编写一个Flex Message的JSON，这意味着它可以滑动显示姿势的图片\\n\\n我们在这里使用自动解析器来确保JSON遵循所需的格式\\n\\nhttps://developers.line.biz/en/docs/messaging-api/using-flex-messages/\\n\\n你也可以使用 https://developers.line.biz/flex-simulator/?status=success 来模拟格式\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"e5b92f32-e282-49cd-8084-68e380572ee9\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1000,\n        -320\n      ],\n      \"parameters\": {\n        \"color\": 2,\n        \"width\": 540,\n        \"height\": 660,\n        \"content\": \"## 今日姿势文案撰写  \\n\\n我们希望这个节点的文本更加用户友好，比如加入表情符号等。因此，我们将今日的姿势提供给Azure OpenAI，请它重新撰写。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"38cc9d2f-be2c-4448-9746-5d533108df7c\",\n      \"name\": \"Sticky Note4\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1600,\n        -320\n      ],\n      \"parameters\": {\n        \"color\": 3,\n        \"width\": 540,\n        \"height\": 660,\n        \"content\": \"## 合并结果并通过Line推送\\n\\n1) 我们使用'编辑字段'功能合并所有输出\\n（提示：可在此处使用input_txt和output_txt调试脚本）\\n2) 为确保JSON格式正确，我们再次通过AI进行了修正\\n3) 使用Line推送功能 >> 请将\\\"to\\\"替换为您自己的UID，并使用您拥有的频道创建授权请求头\\n\\nhttps://developers.line.biz/zh-hant/docs/messaging-api/sending-messages/\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"b88d6f78-ce54-4b83-b009-e4e22e518c7c\",\n      \"name\": \"Sticky Note5\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        2200,\n        -320\n      ],\n      \"parameters\": {\n        \"color\": 6,\n        \"width\": 1020,\n        \"height\": 660,\n        \"content\": \"## 将数据写回Log和Log2\\n\\n我们使用log2来统计每个瑜伽姿势的发送次数，并将此权重反馈至'Yoga'工作表，从而使随机选择更加随机化 ;)\\n\\n在回写数据时，我们还需要从输出中提取信息并进行拆分，以便将其重新存回谷歌表格。\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"active\": false,\n  \"pinData\": {},\n  \"settings\": {\n    \"timezone\": \"Asia/Bangkok\",\n    \"callerPolicy\": \"workflowsFromSameOwner\",\n    \"executionOrder\": \"v1\"\n  },\n  \"versionId\": \"8d3482ff-25e6-479f-a33b-b33d1aeb51fc\",\n  \"connections\": {\n    \"Code\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"WriteJSONflex\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"YogaLog\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"AI Agent\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"AI Agent\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Split Out\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Fix JSON\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Line Push with Flex Bubble\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"YogaLog2\": {\n      \"main\": [\n        []\n      ]\n    },\n    \"Split Out\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"YogaLog2\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"CombineAll\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Fix JSON\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get PoseName\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Code\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"WriteJSONflex\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"WritePosesToday\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"PosesDatabase1\": {\n      \"ai_tool\": [\n        [\n          {\n            \"node\": \"AI Agent\",\n            \"type\": \"ai_tool\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"WritePosesToday\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"RewritePosesToday\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"RewritePosesToday\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"CombineAll\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Azure OpenAI Chat Model\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"WriteJSONflex\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Azure OpenAI Chat Model1\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"Auto-fixing Output Parser\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Azure OpenAI Chat Model2\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"WritePosesToday\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Azure OpenAI Chat Model3\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"AI Agent\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Azure OpenAI Chat Model4\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"Fix JSON\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Azure OpenAI Chat Model5\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"RewritePosesToday\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Azure OpenAI Chat Model6\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"Auto-fixing Output Parser1\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Structured Output Parser\": {\n      \"ai_outputParser\": [\n        [\n          {\n            \"node\": \"Auto-fixing Output Parser\",\n            \"type\": \"ai_outputParser\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Auto-fixing Output Parser\": {\n      \"ai_outputParser\": [\n        [\n          {\n            \"node\": \"AI Agent\",\n            \"type\": \"ai_outputParser\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Structured Output Parser1\": {\n      \"ai_outputParser\": [\n        [\n          {\n            \"node\": \"Auto-fixing Output Parser1\",\n            \"type\": \"ai_outputParser\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Auto-fixing Output Parser1\": {\n      \"ai_outputParser\": [\n        [\n          {\n            \"node\": \"WriteJSONflex\",\n            \"type\": \"ai_outputParser\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Line Push with Flex Bubble\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"YogaLog\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Trigger 2130 YogaPosesToday\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get PoseName\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}