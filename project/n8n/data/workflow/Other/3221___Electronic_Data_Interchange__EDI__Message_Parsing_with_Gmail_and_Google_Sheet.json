{
  "title": "📦 Electronic Data Interchange (EDI) Message Parsing with Gmail and Google Sheet",
  "url": "https://n8n.io/workflows/3221-electronic-data-interchange-edi-message-parsing-with-gmail-and-google-sheet/",
  "category": "Other",
  "category_url": "https://n8n.io/workflows/categories/other/?sort=createdAt:desc",
  "author": "Samir Saci",
  "publish_date": "Last update 21 days ago",
  "publish_date_absolute": "2025-05-01",
  "content": "",
  "workflow_json": "{\"meta\":{\"instanceId\":\"6a5e68bcca67c4cdb3e0b698d01739aea084e1ec06e551db64aeff43d174cb23\",\"templateCredsSetupCompleted\":true},\"nodes\":[{\"id\":\"bc49829b-45f2-4910-9c37-907271982f14\",\"name\":\"Sticky Note3\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-4200,-560],\"parameters\":{\"width\":780,\"height\":540,\"content\":\"### 5. Do you need more details?\\nFind a step-by-step guide in this tutorial\\n![Guide](https://www.samirsaci.com/content/images/2025/04/EDI-Message-Parser.png)\\n[🎥 Watch My Tutorial](https://youtu.be/-phwXeYk7Es)\"},\"typeVersion\":1},{\"id\":\"fca5a1f8-874b-4b25-92af-066e7ca03f67\",\"name\":\"Order Information\",\"type\":\"n8n-nodes-base.set\",\"position\":[-4360,-1000],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"a55ebbb4-3eba-4584-8894-9e8d623d498f\",\"name\":\"documentType\",\"type\":\"string\",\"value\":\"={{ $json.summary.documentType }}\"},{\"id\":\"cbbff4da-4679-4258-bc3c-848075c5f1df\",\"name\":\"documentNumber\",\"type\":\"string\",\"value\":\"={{ $json.summary.documentNumber }}\"},{\"id\":\"a2eb5f07-8d1b-4c3a-b08b-a785045aeb34\",\"name\":\"orderDate\",\"type\":\"string\",\"value\":\"={{ $json.summary.orderDate }}\"},{\"id\":\"7e319d29-463b-4875-b556-684cb0c06c59\",\"name\":\"lineItemCount\",\"type\":\"string\",\"value\":\"={{ $json.summary.lineItemCount }}\"},{\"id\":\"5c9fc86c-e5c0-411f-a7d5-1121b5779906\",\"name\":\"totalQuantity\",\"type\":\"string\",\"value\":\"={{ $json.summary.totalQuantity }}\"}]}},\"notesInFlow\":true,\"typeVersion\":3.4},{\"id\":\"3598dc97-a0d3-4d34-8220-b91925014e4a\",\"name\":\"Return Orders\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[-3620,-960],\"parameters\":{\"columns\":{\"value\":{},\"schema\":[{\"id\":\"documentType\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"documentType\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"documentNumber\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"documentNumber\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"orderDate\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"orderDate\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"lineItemCount\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"lineItemCount\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"totalQuantity\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"totalQuantity\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"header_Document_Type\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"header_Document_Type\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"header_Document_Number\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"header_Document_Number\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"header_Message_Function\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"header_Message_Function\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"header_Sender_ID\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"header_Sender_ID\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"header_Receiver_ID\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"header_Receiver_ID\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"header_Date\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"header_Date\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"header_Time\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"header_Time\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"header_Control_Reference\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"header_Control_Reference\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"date1_Qualifier\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"date1_Qualifier\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"date1_Description\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"date1_Description\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"date1_Date\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"date1_Date\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"date1_Format\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"date1_Format\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"date2_Qualifier\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"date2_Qualifier\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"date2_Description\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"date2_Description\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"date2_Date\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"date2_Date\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"date2_Format\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"date2_Format\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"date3_Qualifier\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"date3_Qualifier\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"date3_Description\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"date3_Description\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"date3_Date\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"date3_Date\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"date3_Format\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"date3_Format\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"party1_Type\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"party1_Type\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"party1_Description\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"party1_Description\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"party1_ID\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"party1_ID\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"party1_Name\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"party1_Name\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"party2_Type\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"party2_Type\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"party2_Description\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"party2_Description\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"party2_ID\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"party2_ID\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"party2_Name\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"party2_Name\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"party3_Type\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"party3_Type\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"party3_Description\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"party3_Description\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"party3_ID\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"party3_ID\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"party3_Name\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"party3_Name\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"party4_Type\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"party4_Type\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"party4_Description\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"party4_Description\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"party4_ID\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"party4_ID\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"party4_Name\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"party4_Name\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"line_Number\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"line_Number\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"line_Product_ID\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"line_Product_ID\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"line_Product_ID_Type\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"line_Product_ID_Type\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"line_Description\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"line_Description\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"line_Quantity\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"line_Quantity\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"line_Unit\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"line_Unit\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"line_Price\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"line_Price\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"line_Price_Qualifier\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"line_Price_Qualifier\",\"defaultMatch\":false,\"canBeUsedToMatch\":true}],\"mappingMode\":\"autoMapInputData\",\"matchingColumns\":[],\"attemptToConvertTypes\":false,\"convertFieldsToString\":false},\"options\":{},\"operation\":\"append\",\"sheetName\":{\"__rl\":true,\"mode\":\"list\",\"value\":1261096359,\"cachedResultUrl\":\"=\",\"cachedResultName\":\"=\"},\"documentId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"1SaSFnJx80wrArf6DLx8zZx2y5VFOAmp0u-a26wliTbU\",\"cachedResultUrl\":\"=\",\"cachedResultName\":\"=\"}},\"notesInFlow\":true,\"typeVersion\":4.5},{\"id\":\"edfa5ef9-3095-47c2-ad80-c09cac647823\",\"name\":\"Outbound Orders\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[-3640,-780],\"parameters\":{\"columns\":{\"value\":{},\"schema\":[{\"id\":\"documentType\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"documentType\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"documentNumber\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"documentNumber\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"orderDate\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"orderDate\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"lineItemCount\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"lineItemCount\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"totalQuantity\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"totalQuantity\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"header_Document_Type\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"header_Document_Type\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"header_Document_Number\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"header_Document_Number\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"header_Message_Function\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"header_Message_Function\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"header_Sender_ID\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"header_Sender_ID\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"header_Receiver_ID\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"header_Receiver_ID\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"header_Date\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"header_Date\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"header_Time\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"header_Time\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"header_Control_Reference\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"header_Control_Reference\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"date1_Qualifier\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"date1_Qualifier\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"date1_Description\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"date1_Description\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"date1_Date\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"date1_Date\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"date1_Format\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"date1_Format\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"date2_Qualifier\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"date2_Qualifier\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"date2_Description\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"date2_Description\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"date2_Date\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"date2_Date\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"date2_Format\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"date2_Format\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"date3_Qualifier\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"date3_Qualifier\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"date3_Description\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"date3_Description\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"date3_Date\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"date3_Date\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"date3_Format\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"date3_Format\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"party1_Type\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"party1_Type\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"party1_Description\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"party1_Description\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"party1_ID\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"party1_ID\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"party1_Name\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"party1_Name\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"party2_Type\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"party2_Type\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"party2_Description\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"party2_Description\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"party2_ID\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"party2_ID\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"party2_Name\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"party2_Name\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"party3_Type\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"party3_Type\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"party3_Description\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"party3_Description\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"party3_ID\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"party3_ID\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"party3_Name\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"party3_Name\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"party4_Type\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"party4_Type\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"party4_Description\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"party4_Description\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"party4_ID\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"party4_ID\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"party4_Name\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"party4_Name\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"line_Number\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"line_Number\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"line_Product_ID\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"line_Product_ID\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"line_Product_ID_Type\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"line_Product_ID_Type\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"line_Description\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"line_Description\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"line_Quantity\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"line_Quantity\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"line_Unit\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"line_Unit\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"line_Price\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"line_Price\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"line_Price_Qualifier\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"line_Price_Qualifier\",\"defaultMatch\":false,\"canBeUsedToMatch\":true}],\"mappingMode\":\"autoMapInputData\",\"matchingColumns\":[],\"attemptToConvertTypes\":false,\"convertFieldsToString\":false},\"options\":{},\"operation\":\"append\",\"sheetName\":{\"__rl\":true,\"mode\":\"list\",\"value\":1261096359,\"cachedResultUrl\":\"=\",\"cachedResultName\":\"=\"},\"documentId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"1SaSFnJx80wrArf6DLx8zZx2y5VFOAmp0u-a26wliTbU\",\"cachedResultUrl\":\"=\",\"cachedResultName\":\"=\"}},\"notesInFlow\":true,\"typeVersion\":4.5},{\"id\":\"6d1c614f-9301-4f25-ab11-350018f145e3\",\"name\":\"Order Type\",\"type\":\"n8n-nodes-base.if\",\"position\":[-3840,-880],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"fc591c63-edfe-4e6d-8074-6ab3079988c8\",\"operator\":{\"name\":\"filter.operator.equals\",\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $json.documentType }}\",\"rightValue\":\"Return Order\"}]}},\"typeVersion\":2.2},{\"id\":\"fc206367-2fbf-4943-b2ce-9fe399dd2730\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-5420,-1240],\"parameters\":{\"color\":7,\"width\":380,\"height\":620,\"content\":\"### 1. Workflow Trigger with Gmail Trigger\\nThe workflow is triggered by a new email received in your Gmail mailbox. \\nIf the subject includes the string \\\"EDI\\\" we proceed, if not we do nothing.\\n\\n#### How to setup?\\n- **Gmail Trigger Node:** set up your Gmail API credentials\\n[Learn more about the Gmail Trigger Node](https://docs.n8n.io/integrations/builtin/trigger-nodes/n8n-nodes-base.gmailtrigger)\\n\"},\"typeVersion\":1},{\"id\":\"c6da1a85-d725-4a41-b63f-504fa8b552fb\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-5420,-540],\"parameters\":{\"width\":800,\"height\":880,\"content\":\"### Example of EDI Message\\nYou can send yourself this email to test the workflow.\\n\\nUNA:+.? '\\nUNB+UNOC:3+SENDER_ID+RECEIVER_ID+240317:1200+ORDER67890'\\nUNH+1+ORDERS:D:96A:UN'\\nBGM+220+PO56789012+9'\\nDTM+137:20250318:102'      \\nDTM+2:20250325:102'        \\nDTM+10:20250324:102'      \\nNAD+BY+BUYER_ABC::91'\\nNAD+SU+SUPPLIER_XYZ::91'\\nNAD+DP+WAREHOUSE_001::91'\\nNAD+DP+Main Distribution Center'\\nLIN+1++987654:IN'\\nIMD+F++:::Product X Description'\\nQTY+21:50:EA'\\nPRI+AAA:20.00'\\nLIN+2++654987:IN'\\nIMD+F++:::Product Y Description'\\nQTY+21:150:EA'\\nPRI+AAA:12.75'\\nUNT+10+1'\\nUNZ+1+ORDER67890'UNA:+.? '\\nUNB+UNOC:3+SENDER_ID+RECEIVER_ID+240317:1200+ORDER67890'\\nUNH+1+ORDERS:D:96A:UN'\\nBGM+220+PO56789012+9'\\nDTM+137:20250318:102'      \\nDTM+2:20250325:102'        \\nDTM+10:20250324:102'      \\nNAD+BY+BUYER_ABC::91'\\nNAD+SU+SUPPLIER_XYZ::91'\\nNAD+DP+WAREHOUSE_001::91'\\nNAD+DP+Main Distribution Center'\\nLIN+1++987654:IN'\\nIMD+F++:::Product X Description'\\nQTY+21:50:EA'\\nPRI+AAA:20.00'\\nLIN+2++654987:IN'\\nIMD+F++:::Product Y Description'\\nQTY+21:150:EA'\\nPRI+AAA:12.75'\\nUNT+10+1'\\nUNZ+1+ORDER67890'\"},\"typeVersion\":1},{\"id\":\"4c82f8ff-e405-4e5f-8386-9c622805023a\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-4980,-1240],\"parameters\":{\"color\":7,\"width\":440,\"height\":620,\"content\":\"### 2. Get Email Body & Parse EDI Message\\nThe first node extracts the email body using the ID from the trigger. This body is parsed using the code node to extract order information.\\n\\n#### How to setup?\\n- **Gmail Node:** set up your Gmail API credentials\\n[Learn more about the Gmail Node](https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.gmail)\\n\"},\"typeVersion\":1},{\"id\":\"e90096b1-ad36-4b18-96a2-9259377b4873\",\"name\":\"Email Trigger\",\"type\":\"n8n-nodes-base.gmailTrigger\",\"position\":[-5400,-860],\"parameters\":{\"filters\":{},\"pollTimes\":{\"item\":[{\"mode\":\"everyMinute\"}]}},\"notesInFlow\":true,\"typeVersion\":1.2},{\"id\":\"26433f0f-487d-49dc-8de7-d4bd3bcf895c\",\"name\":\"Subject includes EDI\",\"type\":\"n8n-nodes-base.if\",\"position\":[-5180,-860],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"3bc8a327-7e66-48e3-b442-38125b6f8670\",\"operator\":{\"type\":\"string\",\"operation\":\"contains\"},\"leftValue\":\"={{ $json.Subject }}\",\"rightValue\":\"EDI\"}]}},\"typeVersion\":2.2},{\"id\":\"6960941f-6b49-41c2-88c6-9442bcb7cb34\",\"name\":\"Extract Body\",\"type\":\"n8n-nodes-base.set\",\"position\":[-4820,-860],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"38358bb8-1b5a-4adc-816d-6710f53f7c0d\",\"name\":\"body\",\"type\":\"string\",\"value\":\"={{ $json.text.replace(/\\\\\\\\n/g, '\\\\n').replace(/^'|'$/g, '') }}\"}]}},\"notesInFlow\":true,\"typeVersion\":3.4},{\"id\":\"6e64556e-07ce-4d9d-89fc-07971dd9c553\",\"name\":\"Get Email\",\"type\":\"n8n-nodes-base.gmail\",\"position\":[-4960,-860],\"webhookId\":\"7476ecd4-e3ba-471d-a73a-ddef7b3ffd28\",\"parameters\":{\"simple\":false,\"options\":{},\"messageId\":\"={{ $json.id }}\",\"operation\":\"get\"},\"notesInFlow\":true,\"typeVersion\":2.1},{\"id\":\"0346eabe-552a-47d8-ac9e-9619926d0242\",\"name\":\"Parse EDI Message\",\"type\":\"n8n-nodes-base.code\",\"position\":[-4660,-860],\"parameters\":{\"jsCode\":\"// EDI Parser function for n8n JavaScript node\\nfunction parseEDI(ediMessage) {\\n  // Define the data structure to store parsed results\\n  const result = {\\n    interchangeHeader: {},\\n    messageHeader: {},\\n    orderDetails: {},\\n    dates: [],\\n    parties: [],\\n    lineItems: []\\n  };\\n  \\n  // Split the message into lines and remove empty lines\\n  const lines = ediMessage.split(\\\"'\\\").filter(line => line.trim().length > 0);\\n  \\n  // Parse each line\\n  let currentLineItem = null;\\n  \\n  for (const line of lines) {\\n    const segments = line.trim().split('+');\\n    const segmentName = segments[0];\\n    \\n    switch (segmentName) {\\n      case 'UNA':\\n        // Service String Advice - contains delimiter information\\n        break;\\n        \\n      case 'UNB':\\n        // Interchange Header\\n        // UNB+UNOC:3+SENDER_ID+RECEIVER_ID+240318:1200+ORDER54321\\n        result.interchangeHeader = {\\n          syntax: segments[1],\\n          senderId: segments[2],\\n          receiverId: segments[3],\\n          dateTime: segments[4]?.split(':')[0] || '',\\n          time: segments[4]?.split(':')[1] || '',\\n          controlReference: segments[5] || ''\\n        };\\n        break;\\n        \\n      case 'UNH':\\n        // Message Header\\n        // UNH+1+ORDERS:D:96A:UN\\n        if (segments.length > 2) {\\n          const messageParts = segments[2].split(':');\\n          result.messageHeader = {\\n            messageReference: segments[1],\\n            messageType: messageParts[0],\\n            messageVersion: messageParts[1],\\n            messageRelease: messageParts[2],\\n            controlAgency: messageParts[3]\\n          };\\n        }\\n        break;\\n        \\n      case 'BGM':\\n        // Beginning of Message\\n        // BGM+230+RT54321098+9\\n        result.orderDetails = {\\n          documentType: segments[1],\\n          documentNumber: segments[2],\\n          messageFunction: segments[3]\\n        };\\n        break;\\n        \\n      case 'DTM':\\n        // Date/Time/Period\\n        // DTM+137:20250319:102\\n        if (segments[1]) {\\n          const dateParts = segments[1].split(':');\\n          const dateObj = {\\n            qualifier: dateParts[0],\\n            date: dateParts[1],\\n            format: dateParts[2]\\n          };\\n          \\n          // Add human-readable description based on qualifier\\n          switch (dateParts[0]) {\\n            case '137':\\n              dateObj.description = 'Document Date';\\n              break;\\n            case '2':\\n              dateObj.description = 'Delivery Date';\\n              break;\\n            case '10':\\n              dateObj.description = 'Shipment Date';\\n              break;\\n            default:\\n              dateObj.description = 'Other Date';\\n          }\\n          \\n          result.dates.push(dateObj);\\n        }\\n        break;\\n      \\n      case 'NAD':\\n        // Name and Address\\n        // NAD+BY+CUSTOMER_123::91\\n        if (segments.length > 1) {\\n          const partyCode = segments[1];\\n          const partyId = segments[2]?.split(':')[0] || '';\\n          \\n          const party = {\\n            partyQualifier: partyCode,\\n            partyId: partyId,\\n            qualifierDescription: ''\\n          };\\n          \\n          // Add human-readable description\\n          switch (partyCode) {\\n            case 'BY':\\n              party.qualifierDescription = 'Buyer';\\n              break;\\n            case 'SU':\\n              party.qualifierDescription = 'Supplier';\\n              break;\\n            case 'DP':\\n              party.qualifierDescription = 'Delivery Party';\\n              break;\\n            default:\\n              party.qualifierDescription = 'Other Party';\\n          }\\n          \\n          // If there's a full name instead of a code (like \\\"Returns Processing Hub\\\")\\n          if (segments[2] && !segments[2].includes(':')) {\\n            party.partyName = segments[2];\\n            party.partyId = '';\\n          }\\n          \\n          result.parties.push(party);\\n        }\\n        break;\\n      \\n      case 'LIN':\\n        // Line Item\\n        // LIN+1++321654:IN\\n        currentLineItem = {\\n          lineNumber: segments[1],\\n          productId: '',\\n          productIdType: '',\\n          description: '',\\n          quantity: 0,\\n          unit: '',\\n          price: 0\\n        };\\n        \\n        // Parse product ID if present\\n        if (segments[3]) {\\n          const productParts = segments[3].split(':');\\n          currentLineItem.productId = productParts[0];\\n          currentLineItem.productIdType = productParts[1] || '';\\n        }\\n        \\n        result.lineItems.push(currentLineItem);\\n        break;\\n      \\n      case 'IMD':\\n        // Item Description\\n        // IMD+F++:::Defective Product A\\n        if (currentLineItem && segments.length > 3) {\\n          // The description is typically in the last component after multiple colons\\n          const descriptionParts = segments[3].split(':');\\n          currentLineItem.description = descriptionParts[descriptionParts.length - 1];\\n        }\\n        break;\\n      \\n      case 'QTY':\\n        // Quantity\\n        // QTY+21:10:EA\\n        if (currentLineItem && segments[1]) {\\n          const quantityParts = segments[1].split(':');\\n          currentLineItem.quantityQualifier = quantityParts[0];\\n          currentLineItem.quantity = parseFloat(quantityParts[1] || '0');\\n          currentLineItem.unit = quantityParts[2] || '';\\n        }\\n        break;\\n      \\n      case 'PRI':\\n        // Price Details\\n        // PRI+AAA:0.00\\n        if (currentLineItem && segments[1]) {\\n          const priceParts = segments[1].split(':');\\n          currentLineItem.priceQualifier = priceParts[0];\\n          currentLineItem.price = parseFloat(priceParts[1] || '0');\\n        }\\n        break;\\n      \\n      case 'UNT':\\n        // Message Trailer\\n        break;\\n      \\n      case 'UNZ':\\n        // Interchange Trailer\\n        break;\\n    }\\n  }\\n  \\n  // Add some summary info\\n  result.summary = {\\n    documentType: 'Return Order',\\n    documentNumber: result.orderDetails.documentNumber,\\n    orderDate: result.dates.find(d => d.qualifier === '137')?.date || '',\\n    lineItemCount: result.lineItems.length,\\n    totalQuantity: result.lineItems.reduce((sum, item) => sum + item.quantity, 0)\\n  };\\n  \\n  return result;\\n}\\n\\n// Return the parsed EDI data\\nconst ediMessage =  $input.first().json.body;\\n\\nif (!ediMessage) {\\n  throw new Error('No EDI message found in input. Please provide the EDI message in the \\\"ediMessage\\\" property.');\\n}\\n\\nconst parsedData = parseEDI(ediMessage);\\nreturn { json: parsedData };\"},\"typeVersion\":2},{\"id\":\"0fa4b446-bb37-48ab-a44b-8b2c52e2660b\",\"name\":\"Sticky Note4\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-4100,-1240],\"parameters\":{\"color\":7,\"width\":700,\"height\":620,\"content\":\"### 4. Store the Transactions in a Google Sheet\\nThis block will filter the order based on the order type (Return Orders, Outbound Orders) extracted from the order information node. Results are stored in two distinct sheets of the same Google Sheet file.\\n\\n#### How to setup?\\n- **Add Results in Google Sheets**:\\n   1. Add your Google Sheet API credentials to access the Google Sheet file\\n   2. Select the file using the list, an URL or an ID\\n   3. Select the sheet in which the vocabulary list is stored\\n   4. You don't need to create columns as the mapping is automatic.\\n  [Learn more about the Google Sheet Node](https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.googlesheets)\"},\"typeVersion\":1},{\"id\":\"7a1451db-9390-431f-bca5-54a537ff8016\",\"name\":\"Order Info + Orderlines\",\"type\":\"n8n-nodes-base.merge\",\"position\":[-4040,-880],\"parameters\":{\"mode\":\"combineBySql\"},\"typeVersion\":3},{\"id\":\"e64a1db7-4c22-4925-9597-9c14fdddbfe4\",\"name\":\"Flatten Data to Orderlines\",\"type\":\"n8n-nodes-base.code\",\"position\":[-4460,-860],\"parameters\":{\"jsCode\":\"// EDI to Flattened Tabular Data Transformer for n8n JavaScript node\\nfunction transformToFlattened(parsedEDI) {\\n  const flattened = [];\\n  \\n  // Create a header object with all order header fields\\n  const headerObj = {\\n    header_Document_Type: parsedEDI.orderDetails.documentType || '',\\n    header_Document_Number: parsedEDI.orderDetails.documentNumber || '',\\n    header_Message_Function: parsedEDI.orderDetails.messageFunction || '',\\n    header_Sender_ID: parsedEDI.interchangeHeader.senderId || '',\\n    header_Receiver_ID: parsedEDI.interchangeHeader.receiverId || '',\\n    header_Date: parsedEDI.interchangeHeader.dateTime || '',\\n    header_Time: parsedEDI.interchangeHeader.time || '',\\n    header_Control_Reference: parsedEDI.interchangeHeader.controlReference || ''\\n  };\\n  \\n  // Process all dates\\n  const dateObjs = {};\\n  if (parsedEDI.dates && Array.isArray(parsedEDI.dates)) {\\n    parsedEDI.dates.forEach((date, index) => {\\n      const prefix = `date${index + 1}_`;\\n      dateObjs[`${prefix}Qualifier`] = date.qualifier || '';\\n      dateObjs[`${prefix}Description`] = date.description || '';\\n      dateObjs[`${prefix}Date`] = date.date || '';\\n      dateObjs[`${prefix}Format`] = date.format || '';\\n    });\\n  }\\n  \\n  // Process all parties\\n  const partyObjs = {};\\n  if (parsedEDI.parties && Array.isArray(parsedEDI.parties)) {\\n    parsedEDI.parties.forEach((party, index) => {\\n      const prefix = `party${index + 1}_`;\\n      partyObjs[`${prefix}Type`] = party.partyQualifier || '';\\n      partyObjs[`${prefix}Description`] = party.qualifierDescription || '';\\n      partyObjs[`${prefix}ID`] = party.partyId || '';\\n      partyObjs[`${prefix}Name`] = party.partyName || '';\\n    });\\n  }\\n  \\n  // Create one row for each line item with all header, date, and party info\\n  if (parsedEDI.lineItems && Array.isArray(parsedEDI.lineItems)) {\\n    parsedEDI.lineItems.forEach((item) => {\\n      const lineItem = {\\n        line_Number: item.lineNumber || '',\\n        line_Product_ID: item.productId || '',\\n        line_Product_ID_Type: item.productIdType || '',\\n        line_Description: item.description || '',\\n        line_Quantity: item.quantity || 0,\\n        line_Unit: item.unit || '',\\n        line_Price: item.price || 0,\\n        line_Price_Qualifier: item.priceQualifier || ''\\n      };\\n      \\n      // Combine all information into one flat object\\n      const flatRow = {\\n        ...headerObj,\\n        ...dateObjs,\\n        ...partyObjs,\\n        ...lineItem\\n      };\\n      \\n      flattened.push(flatRow);\\n    });\\n  }\\n  \\n  // If there are no line items, create at least one row with header info\\n  if (flattened.length === 0) {\\n    flattened.push({\\n      ...headerObj,\\n      ...dateObjs,\\n      ...partyObjs\\n    });\\n  }\\n  \\n  return flattened;\\n}\\n\\nconst parsedEDI = $input.all()[0].json;\\n\\n// Make sure we have valid data\\nif (!parsedEDI || !parsedEDI.orderDetails) {\\n  throw new Error('Invalid EDI data format. Please ensure the input is from the EDI parser.');\\n}\\n\\nconst flattenedData = transformToFlattened(parsedEDI);\\n\\n// Return the flattened data\\nreturn { json: { data: flattenedData } };\"},\"typeVersion\":2},{\"id\":\"5b56fe40-9cfb-4668-946d-470dc9e3a39e\",\"name\":\"Split Out by Line\",\"type\":\"n8n-nodes-base.splitOut\",\"position\":[-4280,-860],\"parameters\":{\"options\":{},\"fieldToSplitOut\":\"data\"},\"typeVersion\":1},{\"id\":\"903399b2-cdee-40c0-99cb-1c44d84e96d2\",\"name\":\"Sticky Note5\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-4480,-1240],\"parameters\":{\"color\":7,\"width\":320,\"height\":620,\"content\":\"### 3. Process Parsed Data\\nThis block extract order information and format the orderlines to be stored in a google sheet.\\n\\n#### How to setup?\\nNothing to do.\"},\"typeVersion\":1}],\"pinData\":{},\"connections\":{\"Get Email\":{\"main\":[[{\"node\":\"Extract Body\",\"type\":\"main\",\"index\":0}]]},\"Order Type\":{\"main\":[[{\"node\":\"Return Orders\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Outbound Orders\",\"type\":\"main\",\"index\":0}]]},\"Extract Body\":{\"main\":[[{\"node\":\"Parse EDI Message\",\"type\":\"main\",\"index\":0}]]},\"Email Trigger\":{\"main\":[[{\"node\":\"Subject includes EDI\",\"type\":\"main\",\"index\":0}]]},\"Order Information\":{\"main\":[[{\"node\":\"Order Info + Orderlines\",\"type\":\"main\",\"index\":0}]]},\"Parse EDI Message\":{\"main\":[[{\"node\":\"Order Information\",\"type\":\"main\",\"index\":0},{\"node\":\"Flatten Data to Orderlines\",\"type\":\"main\",\"index\":0}]]},\"Split Out by Line\":{\"main\":[[{\"node\":\"Order Info + Orderlines\",\"type\":\"main\",\"index\":1}]]},\"Subject includes EDI\":{\"main\":[[{\"node\":\"Get Email\",\"type\":\"main\",\"index\":0}]]},\"Order Info + Orderlines\":{\"main\":[[{\"node\":\"Order Type\",\"type\":\"main\",\"index\":0}]]},\"Flatten Data to Orderlines\":{\"main\":[[{\"node\":\"Split Out by Line\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "_Tags: Supply Chain Management, Logistics, Transportation, Data Transmission_\n\n### Context\n\nHey! I'm Samir, a **Supply Chain Engineer and Data Scientist from Paris** founder of  \n[LogiGreen Consulting](https://www.logi-green.com/)\n\nWe help **small and medium businesses** **improve their logistics processes** using AI, Data Analytics and Automation.\n\n> Sustainable and Efficient supply chains with N8N!\n\n📬 For business inquiries, you can add me on [Here](https://www.linkedin.com/in/samir-saci)\n\n### What is an EDI Message?\n\nElectronic Data Interchange (EDI) is **a standardized method** of automatically transferring data between computer systems.\n\n![Data Exchange between Systems](https://www.samirsaci.com/content/images/size/w1000/2025/03/image-20.png)\n\nThey ensure the **smooth flow of essential transactional data** , such as **purchase orders** , invoices, **shipping notices** , and more.\n\n![Example of Order Translated in EDI](https://www.samirsaci.com/content/images/size/w1000/2025/03/image-21.png)\n\nFor instance, a manufacturing company can receive purchase orders from a retailer via EDI.\n\n![Example of Transactions](https://www.samirsaci.com/content/images/size/w1000/2025/03/image-22.png)\n\nHowever, they need **complex integration** for the transmission and processing of the messages.\n\n### Who is this template for?\n\nThis workflow template is designed for **small companies** that cannot connect to their customers and need to **manually process** the EDI messages received.\n\n### How does it work?\n\nThis workflow uses a **Gmail Trigger** that analyzes all the incoming emails.\n\n  1. **📧 Gmail Trigger** → Detects emails with \"EDI\" in the subject.\n  2. **📜 Parses EDI Message** → Uses a JavaScript Code Node to extract structured data.\n  3. **📊 Formats the Data** → Converts it into a table-friendly format.\n  4. **📑 Updates Google Sheets** → Automatically logs the processed orders.\n\n\n\n### Prerequisite\n\nThis workflow does not require any additional paying subscription.\n\n  * A **Google Drive Account** with a folder including a Google Sheet\n  * API Credentials: **Google Drive API** , **Google Sheets API** and **Gmail API**\n  * A Google sheet to store the shipment records. _You do not need to prepare the columns._\n\n\n\n### Next Steps\n\nFollow the **sticky notes** to set up the parameters inside each node and get ready to improve your logistics operations!\n\n**📺 Watch the Step-by-Step Guide**\n\n![image.png](https://www.samirsaci.com/content/images/2025/04/EDI-Message-Parser.png)\n\n🎥 [Check My Tutorial](https://youtu.be/-phwXeYk7Es)\n\n🚀 Interested in applications of N8N for Logistics & Supply Chain Management? Let's connect on [Linkedin](www.linkedin.com/in/samir-saci)\n\n### Notes\n\n  * This template includes an example of EDI message to test the workflow.\n  * If you want to learn more about Electronic Data Interchange: 🚚 [Blog Article about Electronic Data Interchange (EDI)](https://www.samirsaci.com/what-is-edi-electronic-data-interchange/)\n\n\n\n_This workflow has been created with N8N 1.82.1_  \n_Submitted: March 19th, 2025_\n",
  "readme_html": "<!--[--><div data-v-50766329=\"\"><p><em>Tags: Supply Chain Management, Logistics, Transportation, Data Transmission</em></p>\n<h3>Context</h3>\n<p>Hey! I'm Samir, a <strong>Supply Chain Engineer and Data Scientist from Paris</strong> founder of<br>\n<a href=\"https://www.logi-green.com/\" rel=\"ugc nofollow\" target=\"_blank\">LogiGreen Consulting</a></p>\n<p>We help <strong>small and medium businesses</strong> <strong>improve their logistics processes</strong> using AI, Data Analytics and Automation.</p>\n<blockquote>\n<p>Sustainable and Efficient supply chains with N8N!</p>\n</blockquote>\n<p>📬 For business inquiries, you can add me on <a href=\"https://www.linkedin.com/in/samir-saci\" rel=\"ugc nofollow\" target=\"_blank\">Here</a></p>\n<h3>What is an EDI Message?</h3>\n<p>Electronic Data Interchange (EDI) is <strong>a standardized method</strong> of automatically transferring data between computer systems.</p>\n<p><img src=\"https://www.samirsaci.com/content/images/size/w1000/2025/03/image-20.png\" alt=\"Data Exchange between Systems\"></p>\n<p>They ensure the <strong>smooth flow of essential transactional data</strong>, such as <strong>purchase orders</strong>, invoices, <strong>shipping notices</strong>, and more.</p>\n<p><img src=\"https://www.samirsaci.com/content/images/size/w1000/2025/03/image-21.png\" alt=\"Example of Order Translated in EDI\"></p>\n<p>For instance, a manufacturing company can receive purchase orders from a retailer via EDI.</p>\n<p><img src=\"https://www.samirsaci.com/content/images/size/w1000/2025/03/image-22.png\" alt=\"Example of Transactions\"></p>\n<p>However, they need <strong>complex integration</strong> for the transmission and processing of the messages.</p>\n<h3>Who is this template for?</h3>\n<p>This workflow template is designed for <strong>small companies</strong> that cannot connect to their customers and need to <strong>manually process</strong> the EDI messages received.</p>\n<h3>How does it work?</h3>\n<p>This workflow uses a <strong>Gmail Trigger</strong> that analyzes all the incoming emails.</p>\n<ol>\n<li><strong>📧 Gmail Trigger</strong> → Detects emails with \"EDI\" in the subject.</li>\n<li><strong>📜 Parses EDI Message</strong> → Uses a JavaScript Code Node to extract structured data.</li>\n<li><strong>📊 Formats the Data</strong> → Converts it into a table-friendly format.</li>\n<li><strong>📑 Updates Google Sheets</strong> → Automatically logs the processed orders.</li>\n</ol>\n<h3>Prerequisite</h3>\n<p>This workflow does not require any additional paying subscription.</p>\n<ul>\n<li>A <strong>Google Drive Account</strong> with a folder including a Google Sheet</li>\n<li>API Credentials: <strong>Google Drive API</strong>, <strong>Google Sheets API</strong> and <strong>Gmail API</strong></li>\n<li>A Google sheet to store the shipment records. <em>You do not need to prepare the columns.</em></li>\n</ul>\n<h3>Next Steps</h3>\n<p>Follow the <strong>sticky notes</strong> to set up the parameters inside each node and get ready to improve your logistics operations!</p>\n<p><strong>📺 Watch the Step-by-Step Guide</strong></p>\n<p><img src=\"https://www.samirsaci.com/content/images/2025/04/EDI-Message-Parser.png\" alt=\"image.png\"></p>\n<p>🎥 <a href=\"https://youtu.be/-phwXeYk7Es\" rel=\"ugc nofollow\" target=\"_blank\">Check My Tutorial</a></p>\n<p>🚀 Interested in applications of N8N for Logistics &amp; Supply Chain Management? Let's connect on <a href=\"www.linkedin.com/in/samir-saci\" rel=\"ugc nofollow\">Linkedin</a></p>\n<h3>Notes</h3>\n<ul>\n<li>This template includes an example of EDI message to test the workflow.</li>\n<li>If you want to learn more about Electronic Data Interchange: 🚚 <a href=\"https://www.samirsaci.com/what-is-edi-electronic-data-interchange/\" rel=\"ugc nofollow\" target=\"_blank\">Blog Article about Electronic Data Interchange (EDI)</a></li>\n</ul>\n<p><em>This workflow has been created with N8N  1.82.1</em><br>\n<em>Submitted: March 19th, 2025</em></p>\n</div><!--]-->",
  "readme_zh": "_标签：供应链管理、物流、运输、数据传输_\n\n### 背景介绍  \n\n大家好！我是萨米尔（Samir），一名**来自巴黎的供应链工程师兼数据科学家**，也是  \n[LogiGreen咨询公司](https://www.logi-green.com/)的创始人。  \n\n我们致力于通过**人工智能、数据分析和自动化技术**，帮助**中小企业优化物流流程**。  \n\n> 用N8N打造可持续且高效的供应链！  \n\n📬 商务合作请通过[LinkedIn](https://www.linkedin.com/in/samir-saci)联系我  \n\n### 什么是EDI报文？  \n\n电子数据交换（EDI）是计算机系统之间**自动化传输数据的标准化方法**。  \n\n![系统间数据交换示意图](https://www.samirsaci.com/content/images/size/w1000/2025/03/image-20.png)  \n\n它能确保**采购订单**、发票、**发货通知**等关键业务数据的**无缝流转**。  \n\n![EDI订单转换示例](https://www.samirsaci.com/content/images/size/w1000/2025/03/image-21.png)  \n\n例如，制造企业可通过EDI接收零售商的采购订单。  \n\n![交易流程示例](https://www.samirsaci.com/content/images/size/w1000/2025/03/image-22.png)  \n\n但实现报文传输与处理需要**复杂的系统集成**。  \n\n### 适用对象  \n\n本模板专为**无法直连客户**，需**人工处理EDI报文**的**小型企业**设计。  \n\n### 运作原理  \n\n该工作流通过**Gmail触发器**扫描所有收件：  \n\n1. **📧 Gmail触发器** → 抓取主题含\"EDI\"的邮件  \n2. **📜 解析EDI报文** → 用JavaScript节点提取结构化数据  \n3. **📊 数据格式化** → 转换为表格兼容格式  \n4. **📑 更新Google表格** → 自动记录已处理订单  \n\n### 前置条件  \n\n无需额外付费订阅：  \n\n* 拥有**Google Drive账户**及内含Google表格的文件夹  \n* API凭证：**Google Drive API**、**Google Sheets API**和**Gmail API**  \n* 用于存储发货记录的Google表格（**无需预置列**）  \n\n### 后续步骤  \n\n按节点内的**便签提示**设置参数，即刻提升物流运营效率！  \n\n**📺 观看分步教程**  \n\n![流程图](https://www.samirsaci.com/content/images/2025/04/EDI-Message-Parser.png)  \n\n🎥 [教程视频](https://youtu.be/-phwXeYk7Es)  \n\n🚀 对N8N在物流与供应链中的应用感兴趣？欢迎通过[LinkedIn](www.linkedin.com/in/samir-saci)联系  \n\n### 注意事项  \n\n* 模板包含测试用EDI报文示例  \n* 扩展阅读：🚚 [EDI技术详解博客](https://www.samirsaci.com/what-is-edi-electronic-data-interchange/)  \n\n_本工作流基于N8N 1.82.1版本构建_  \n_提交日期：2025年3月19日_",
  "title_zh": "📦 利用Gmail和Google表格解析电子数据交换（EDI）报文",
  "publish_date_zh": "上次更新于21天前",
  "workflow_json_zh": "{\n  \"meta\": {\n    \"instanceId\": \"6a5e68bcca67c4cdb3e0b698d01739aea084e1ec06e551db64aeff43d174cb23\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"nodes\": [\n    {\n      \"id\": \"bc49829b-45f2-4910-9c37-907271982f14\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -4200,\n        -560\n      ],\n      \"parameters\": {\n        \"width\": 780,\n        \"height\": 540,\n        \"content\": \"### 5. 需要更详细的说明吗？\\n本教程提供分步指南\\n![指南](https://www.samirsaci.com/content/images/2025/04/EDI-Message-Parser.png)\\n[🎥 观看我的教程](https://youtu.be/-phwXeYk7Es)\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"fca5a1f8-874b-4b25-92af-066e7ca03f67\",\n      \"name\": \"Order Information\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        -4360,\n        -1000\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"a55ebbb4-3eba-4584-8894-9e8d623d498f\",\n              \"name\": \"documentType\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.summary.documentType }}\"\n            },\n            {\n              \"id\": \"cbbff4da-4679-4258-bc3c-848075c5f1df\",\n              \"name\": \"documentNumber\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.summary.documentNumber }}\"\n            },\n            {\n              \"id\": \"a2eb5f07-8d1b-4c3a-b08b-a785045aeb34\",\n              \"name\": \"orderDate\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.summary.orderDate }}\"\n            },\n            {\n              \"id\": \"7e319d29-463b-4875-b556-684cb0c06c59\",\n              \"name\": \"lineItemCount\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.summary.lineItemCount }}\"\n            },\n            {\n              \"id\": \"5c9fc86c-e5c0-411f-a7d5-1121b5779906\",\n              \"name\": \"totalQuantity\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.summary.totalQuantity }}\"\n            }\n          ]\n        }\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"3598dc97-a0d3-4d34-8220-b91925014e4a\",\n      \"name\": \"Return Orders\",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"position\": [\n        -3620,\n        -960\n      ],\n      \"parameters\": {\n        \"columns\": {\n          \"value\": {},\n          \"schema\": [\n            {\n              \"id\": \"documentType\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"documentType\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"documentNumber\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"documentNumber\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"orderDate\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"orderDate\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"lineItemCount\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"lineItemCount\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"totalQuantity\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"totalQuantity\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"header_Document_Type\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"header_Document_Type\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"header_Document_Number\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"header_Document_Number\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"header_Message_Function\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"header_Message_Function\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"header_Sender_ID\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"header_Sender_ID\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"header_Receiver_ID\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"header_Receiver_ID\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"header_Date\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"header_Date\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"header_Time\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"header_Time\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"header_Control_Reference\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"header_Control_Reference\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"date1_Qualifier\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"date1_Qualifier\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"date1_Description\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"date1_Description\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"date1_Date\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"date1_Date\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"date1_Format\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"date1_Format\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"date2_Qualifier\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"date2_Qualifier\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"date2_Description\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"date2_Description\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"date2_Date\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"date2_Date\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"date2_Format\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"date2_Format\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"date3_Qualifier\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"date3_Qualifier\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"date3_Description\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"date3_Description\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"date3_Date\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"date3_Date\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"date3_Format\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"date3_Format\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party1_Type\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party1_Type\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party1_Description\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party1_Description\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party1_ID\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party1_ID\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party1_Name\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party1_Name\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party2_Type\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party2_Type\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party2_Description\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party2_Description\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party2_ID\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party2_ID\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party2_Name\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party2_Name\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party3_Type\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party3_Type\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party3_Description\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party3_Description\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party3_ID\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party3_ID\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party3_Name\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party3_Name\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party4_Type\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party4_Type\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party4_Description\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party4_Description\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party4_ID\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party4_ID\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party4_Name\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party4_Name\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"line_Number\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"line_Number\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"line_Product_ID\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"line_Product_ID\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"line_Product_ID_Type\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"line_Product_ID_Type\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"line_Description\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"line_Description\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"line_Quantity\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"line_Quantity\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"line_Unit\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"line_Unit\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"line_Price\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"line_Price\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"line_Price_Qualifier\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"line_Price_Qualifier\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            }\n          ],\n          \"mappingMode\": \"autoMapInputData\",\n          \"matchingColumns\": [],\n          \"attemptToConvertTypes\": false,\n          \"convertFieldsToString\": false\n        },\n        \"options\": {},\n        \"operation\": \"append\",\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": 1261096359,\n          \"cachedResultUrl\": \"=\",\n          \"cachedResultName\": \"=\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"1SaSFnJx80wrArf6DLx8zZx2y5VFOAmp0u-a26wliTbU\",\n          \"cachedResultUrl\": \"=\",\n          \"cachedResultName\": \"=\"\n        }\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 4.5\n    },\n    {\n      \"id\": \"edfa5ef9-3095-47c2-ad80-c09cac647823\",\n      \"name\": \"Outbound Orders\",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"position\": [\n        -3640,\n        -780\n      ],\n      \"parameters\": {\n        \"columns\": {\n          \"value\": {},\n          \"schema\": [\n            {\n              \"id\": \"documentType\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"documentType\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"documentNumber\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"documentNumber\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"orderDate\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"orderDate\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"lineItemCount\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"lineItemCount\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"totalQuantity\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"totalQuantity\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"header_Document_Type\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"header_Document_Type\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"header_Document_Number\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"header_Document_Number\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"header_Message_Function\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"header_Message_Function\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"header_Sender_ID\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"header_Sender_ID\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"header_Receiver_ID\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"header_Receiver_ID\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"header_Date\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"header_Date\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"header_Time\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"header_Time\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"header_Control_Reference\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"header_Control_Reference\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"date1_Qualifier\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"date1_Qualifier\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"date1_Description\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"date1_Description\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"date1_Date\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"date1_Date\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"date1_Format\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"date1_Format\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"date2_Qualifier\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"date2_Qualifier\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"date2_Description\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"date2_Description\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"date2_Date\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"date2_Date\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"date2_Format\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"date2_Format\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"date3_Qualifier\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"date3_Qualifier\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"date3_Description\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"date3_Description\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"date3_Date\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"date3_Date\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"date3_Format\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"date3_Format\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party1_Type\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party1_Type\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party1_Description\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party1_Description\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party1_ID\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party1_ID\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party1_Name\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party1_Name\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party2_Type\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party2_Type\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party2_Description\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party2_Description\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party2_ID\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party2_ID\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party2_Name\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party2_Name\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party3_Type\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party3_Type\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party3_Description\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party3_Description\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party3_ID\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party3_ID\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party3_Name\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party3_Name\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party4_Type\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party4_Type\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party4_Description\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party4_Description\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party4_ID\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party4_ID\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"party4_Name\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"party4_Name\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"line_Number\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"line_Number\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"line_Product_ID\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"line_Product_ID\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"line_Product_ID_Type\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"line_Product_ID_Type\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"line_Description\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"line_Description\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"line_Quantity\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"line_Quantity\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"line_Unit\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"line_Unit\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"line_Price\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"line_Price\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"line_Price_Qualifier\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"line_Price_Qualifier\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            }\n          ],\n          \"mappingMode\": \"autoMapInputData\",\n          \"matchingColumns\": [],\n          \"attemptToConvertTypes\": false,\n          \"convertFieldsToString\": false\n        },\n        \"options\": {},\n        \"operation\": \"append\",\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": 1261096359,\n          \"cachedResultUrl\": \"=\",\n          \"cachedResultName\": \"=\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"1SaSFnJx80wrArf6DLx8zZx2y5VFOAmp0u-a26wliTbU\",\n          \"cachedResultUrl\": \"=\",\n          \"cachedResultName\": \"=\"\n        }\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 4.5\n    },\n    {\n      \"id\": \"6d1c614f-9301-4f25-ab11-350018f145e3\",\n      \"name\": \"Order Type\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        -3840,\n        -880\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"fc591c63-edfe-4e6d-8074-6ab3079988c8\",\n              \"operator\": {\n                \"name\": \"filter.operator.equals\",\n                \"type\": \"string\",\n                \"operation\": \"equals\"\n              },\n              \"leftValue\": \"={{ $json.documentType }}\",\n              \"rightValue\": \"Return Order\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"fc206367-2fbf-4943-b2ce-9fe399dd2730\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -5420,\n        -1240\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 380,\n        \"height\": 620,\n        \"content\": \"### 1. 使用Gmail触发器启动工作流\\n该工作流由您Gmail邮箱收到的新邮件触发。\\n若邮件主题包含字符串\\\"EDI\\\"，则流程继续执行；否则不进行任何操作。\\n\\n#### 如何设置？\\n- **Gmail触发器节点：** 配置您的Gmail API凭证\\n[了解更多关于Gmail触发器节点的信息](https://docs.n8n.io/integrations/builtin/trigger-nodes/n8n-nodes-base.gmailtrigger)\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"c6da1a85-d725-4a41-b63f-504fa8b552fb\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -5420,\n        -540\n      ],\n      \"parameters\": {\n        \"width\": 800,\n        \"height\": 880,\n        \"content\": \"### EDI报文示例\\n您可以通过向自己发送这封邮件来测试工作流程。\\n\\nUNA:+.? '\\nUNB+UNOC:3+发送方ID+接收方ID+240317:1200+订单号ORDER67890'\\nUNH+1+ORDERS:D:96A:UN'\\nBGM+220+采购单号PO56789012+9'\\nDTM+137:20250318:102'       //订单日期\\nDTM+2:20250325:102'         //交货日期\\nDTM+10:20250324:102'       //付款截止日\\nNAD+BY+采购方_ABC::91'      //买方信息\\nNAD+SU+供应商_XYZ::91'      //供应商信息\\nNAD+DP+仓库_001::91'        //配送点信息\\nNAD+DP+主配送中心'          //配送中心名称\\nLIN+1++产品编号987654:IN'  //第一行商品\\nIMD+F++:::产品X描述'\\nQTY+21:50:EA'               //数量50件\\nPRI+AAA:20.00'              //单价20元\\nLIN+2++产品编号654987:IN'  //第二行商品\\nIMD+F++:::产品Y描述'\\nQTY+21:150:EA'              //数量150件\\nPRI+AAA:12.75'              //单价12.75元\\nUNT+10+1'                   //段计数\\nUNZ+1+订单号ORDER67890'     //交换控制尾\\n\\n（注：根据EDI标准规范，实际传输时所有注释符\\\"//\\\"及中文说明均不存在，此处仅为方便理解添加。正式报文应严格保持原始数据格式。）\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"4c82f8ff-e405-4e5f-8386-9c622805023a\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -4980,\n        -1240\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 440,\n        \"height\": 620,\n        \"content\": \"### 2. 获取邮件正文并解析EDI报文  \\n首个节点通过触发器提供的ID提取邮件正文内容，随后利用代码节点解析该正文以提取订单信息。  \\n\\n#### 如何设置？  \\n- **Gmail节点:** 配置您的Gmail API凭证  \\n[了解更多Gmail节点信息](https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.gmail)  \\n\\n（注：根据中文技术文档惯例，\\\"Learn more\\\"链接描述调整为\\\"了解更多...信息\\\"的主动句式；\\\"How to setup\\\"译为\\\"如何设置\\\"符合中文操作指南标题风格；\\\"extracts/parsed\\\"等动词处理为\\\"提取/解析\\\"的主动态短句，避免西式被动语态；保留专业术语\\\"EDI报文\\\"及\\\"API凭证\\\"的规范译法）\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"e90096b1-ad36-4b18-96a2-9259377b4873\",\n      \"name\": \"Email Trigger\",\n      \"type\": \"n8n-nodes-base.gmailTrigger\",\n      \"position\": [\n        -5400,\n        -860\n      ],\n      \"parameters\": {\n        \"filters\": {},\n        \"pollTimes\": {\n          \"item\": [\n            {\n              \"mode\": \"everyMinute\"\n            }\n          ]\n        }\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"26433f0f-487d-49dc-8de7-d4bd3bcf895c\",\n      \"name\": \"Subject includes EDI\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        -5180,\n        -860\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"3bc8a327-7e66-48e3-b442-38125b6f8670\",\n              \"operator\": {\n                \"type\": \"string\",\n                \"operation\": \"contains\"\n              },\n              \"leftValue\": \"={{ $json.Subject }}\",\n              \"rightValue\": \"EDI\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"6960941f-6b49-41c2-88c6-9442bcb7cb34\",\n      \"name\": \"Extract Body\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        -4820,\n        -860\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"38358bb8-1b5a-4adc-816d-6710f53f7c0d\",\n              \"name\": \"body\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.text.replace(/\\\\\\\\n/g, '\\\\n').replace(/^'|'$/g, '') }}\"\n            }\n          ]\n        }\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"6e64556e-07ce-4d9d-89fc-07971dd9c553\",\n      \"name\": \"Get Email\",\n      \"type\": \"n8n-nodes-base.gmail\",\n      \"position\": [\n        -4960,\n        -860\n      ],\n      \"webhookId\": \"7476ecd4-e3ba-471d-a73a-ddef7b3ffd28\",\n      \"parameters\": {\n        \"simple\": false,\n        \"options\": {},\n        \"messageId\": \"={{ $json.id }}\",\n        \"operation\": \"get\"\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 2.1\n    },\n    {\n      \"id\": \"0346eabe-552a-47d8-ac9e-9619926d0242\",\n      \"name\": \"Parse EDI Message\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        -4660,\n        -860\n      ],\n      \"parameters\": {\n        \"jsCode\": \"// EDI Parser function for n8n JavaScript node\\nfunction parseEDI(ediMessage) {\\n  // Define the data structure to store parsed results\\n  const result = {\\n    interchangeHeader: {},\\n    messageHeader: {},\\n    orderDetails: {},\\n    dates: [],\\n    parties: [],\\n    lineItems: []\\n  };\\n  \\n  // Split the message into lines and remove empty lines\\n  const lines = ediMessage.split(\\\"'\\\").filter(line => line.trim().length > 0);\\n  \\n  // Parse each line\\n  let currentLineItem = null;\\n  \\n  for (const line of lines) {\\n    const segments = line.trim().split('+');\\n    const segmentName = segments[0];\\n    \\n    switch (segmentName) {\\n      case 'UNA':\\n        // Service String Advice - contains delimiter information\\n        break;\\n        \\n      case 'UNB':\\n        // Interchange Header\\n        // UNB+UNOC:3+SENDER_ID+RECEIVER_ID+240318:1200+ORDER54321\\n        result.interchangeHeader = {\\n          syntax: segments[1],\\n          senderId: segments[2],\\n          receiverId: segments[3],\\n          dateTime: segments[4]?.split(':')[0] || '',\\n          time: segments[4]?.split(':')[1] || '',\\n          controlReference: segments[5] || ''\\n        };\\n        break;\\n        \\n      case 'UNH':\\n        // Message Header\\n        // UNH+1+ORDERS:D:96A:UN\\n        if (segments.length > 2) {\\n          const messageParts = segments[2].split(':');\\n          result.messageHeader = {\\n            messageReference: segments[1],\\n            messageType: messageParts[0],\\n            messageVersion: messageParts[1],\\n            messageRelease: messageParts[2],\\n            controlAgency: messageParts[3]\\n          };\\n        }\\n        break;\\n        \\n      case 'BGM':\\n        // Beginning of Message\\n        // BGM+230+RT54321098+9\\n        result.orderDetails = {\\n          documentType: segments[1],\\n          documentNumber: segments[2],\\n          messageFunction: segments[3]\\n        };\\n        break;\\n        \\n      case 'DTM':\\n        // Date/Time/Period\\n        // DTM+137:20250319:102\\n        if (segments[1]) {\\n          const dateParts = segments[1].split(':');\\n          const dateObj = {\\n            qualifier: dateParts[0],\\n            date: dateParts[1],\\n            format: dateParts[2]\\n          };\\n          \\n          // Add human-readable description based on qualifier\\n          switch (dateParts[0]) {\\n            case '137':\\n              dateObj.description = 'Document Date';\\n              break;\\n            case '2':\\n              dateObj.description = 'Delivery Date';\\n              break;\\n            case '10':\\n              dateObj.description = 'Shipment Date';\\n              break;\\n            default:\\n              dateObj.description = 'Other Date';\\n          }\\n          \\n          result.dates.push(dateObj);\\n        }\\n        break;\\n      \\n      case 'NAD':\\n        // Name and Address\\n        // NAD+BY+CUSTOMER_123::91\\n        if (segments.length > 1) {\\n          const partyCode = segments[1];\\n          const partyId = segments[2]?.split(':')[0] || '';\\n          \\n          const party = {\\n            partyQualifier: partyCode,\\n            partyId: partyId,\\n            qualifierDescription: ''\\n          };\\n          \\n          // Add human-readable description\\n          switch (partyCode) {\\n            case 'BY':\\n              party.qualifierDescription = 'Buyer';\\n              break;\\n            case 'SU':\\n              party.qualifierDescription = 'Supplier';\\n              break;\\n            case 'DP':\\n              party.qualifierDescription = 'Delivery Party';\\n              break;\\n            default:\\n              party.qualifierDescription = 'Other Party';\\n          }\\n          \\n          // If there's a full name instead of a code (like \\\"Returns Processing Hub\\\")\\n          if (segments[2] && !segments[2].includes(':')) {\\n            party.partyName = segments[2];\\n            party.partyId = '';\\n          }\\n          \\n          result.parties.push(party);\\n        }\\n        break;\\n      \\n      case 'LIN':\\n        // Line Item\\n        // LIN+1++321654:IN\\n        currentLineItem = {\\n          lineNumber: segments[1],\\n          productId: '',\\n          productIdType: '',\\n          description: '',\\n          quantity: 0,\\n          unit: '',\\n          price: 0\\n        };\\n        \\n        // Parse product ID if present\\n        if (segments[3]) {\\n          const productParts = segments[3].split(':');\\n          currentLineItem.productId = productParts[0];\\n          currentLineItem.productIdType = productParts[1] || '';\\n        }\\n        \\n        result.lineItems.push(currentLineItem);\\n        break;\\n      \\n      case 'IMD':\\n        // Item Description\\n        // IMD+F++:::Defective Product A\\n        if (currentLineItem && segments.length > 3) {\\n          // The description is typically in the last component after multiple colons\\n          const descriptionParts = segments[3].split(':');\\n          currentLineItem.description = descriptionParts[descriptionParts.length - 1];\\n        }\\n        break;\\n      \\n      case 'QTY':\\n        // Quantity\\n        // QTY+21:10:EA\\n        if (currentLineItem && segments[1]) {\\n          const quantityParts = segments[1].split(':');\\n          currentLineItem.quantityQualifier = quantityParts[0];\\n          currentLineItem.quantity = parseFloat(quantityParts[1] || '0');\\n          currentLineItem.unit = quantityParts[2] || '';\\n        }\\n        break;\\n      \\n      case 'PRI':\\n        // Price Details\\n        // PRI+AAA:0.00\\n        if (currentLineItem && segments[1]) {\\n          const priceParts = segments[1].split(':');\\n          currentLineItem.priceQualifier = priceParts[0];\\n          currentLineItem.price = parseFloat(priceParts[1] || '0');\\n        }\\n        break;\\n      \\n      case 'UNT':\\n        // Message Trailer\\n        break;\\n      \\n      case 'UNZ':\\n        // Interchange Trailer\\n        break;\\n    }\\n  }\\n  \\n  // Add some summary info\\n  result.summary = {\\n    documentType: 'Return Order',\\n    documentNumber: result.orderDetails.documentNumber,\\n    orderDate: result.dates.find(d => d.qualifier === '137')?.date || '',\\n    lineItemCount: result.lineItems.length,\\n    totalQuantity: result.lineItems.reduce((sum, item) => sum + item.quantity, 0)\\n  };\\n  \\n  return result;\\n}\\n\\n// Return the parsed EDI data\\nconst ediMessage =  $input.first().json.body;\\n\\nif (!ediMessage) {\\n  throw new Error('No EDI message found in input. Please provide the EDI message in the \\\"ediMessage\\\" property.');\\n}\\n\\nconst parsedData = parseEDI(ediMessage);\\nreturn { json: parsedData };\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"0fa4b446-bb37-48ab-a44b-8b2c52e2660b\",\n      \"name\": \"Sticky Note4\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -4100,\n        -1240\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 700,\n        \"height\": 620,\n        \"content\": \"### 4. 将交易记录存储至谷歌表格  \\n此模块将根据从订单信息节点提取的订单类型（退货订单、出库订单）筛选订单，并将结果存储在同一谷歌表格文件的两个不同工作表中。  \\n\\n#### 如何设置？  \\n- **在谷歌表格中添加结果**：  \\n  1. 添加您的谷歌表格API凭证以访问文件  \\n  2. 通过列表、URL或ID选择目标文件  \\n  3. 选择用于存储词汇列表的工作表  \\n  4. 无需手动创建列，映射将自动完成。  \\n  [了解更多谷歌表格节点信息](https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.googlesheets)\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"7a1451db-9390-431f-bca5-54a537ff8016\",\n      \"name\": \"Order Info + Orderlines\",\n      \"type\": \"n8n-nodes-base.merge\",\n      \"position\": [\n        -4040,\n        -880\n      ],\n      \"parameters\": {\n        \"mode\": \"combineBySql\"\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"e64a1db7-4c22-4925-9597-9c14fdddbfe4\",\n      \"name\": \"Flatten Data to Orderlines\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        -4460,\n        -860\n      ],\n      \"parameters\": {\n        \"jsCode\": \"// EDI to Flattened Tabular Data Transformer for n8n JavaScript node\\nfunction transformToFlattened(parsedEDI) {\\n  const flattened = [];\\n  \\n  // Create a header object with all order header fields\\n  const headerObj = {\\n    header_Document_Type: parsedEDI.orderDetails.documentType || '',\\n    header_Document_Number: parsedEDI.orderDetails.documentNumber || '',\\n    header_Message_Function: parsedEDI.orderDetails.messageFunction || '',\\n    header_Sender_ID: parsedEDI.interchangeHeader.senderId || '',\\n    header_Receiver_ID: parsedEDI.interchangeHeader.receiverId || '',\\n    header_Date: parsedEDI.interchangeHeader.dateTime || '',\\n    header_Time: parsedEDI.interchangeHeader.time || '',\\n    header_Control_Reference: parsedEDI.interchangeHeader.controlReference || ''\\n  };\\n  \\n  // Process all dates\\n  const dateObjs = {};\\n  if (parsedEDI.dates && Array.isArray(parsedEDI.dates)) {\\n    parsedEDI.dates.forEach((date, index) => {\\n      const prefix = `date${index + 1}_`;\\n      dateObjs[`${prefix}Qualifier`] = date.qualifier || '';\\n      dateObjs[`${prefix}Description`] = date.description || '';\\n      dateObjs[`${prefix}Date`] = date.date || '';\\n      dateObjs[`${prefix}Format`] = date.format || '';\\n    });\\n  }\\n  \\n  // Process all parties\\n  const partyObjs = {};\\n  if (parsedEDI.parties && Array.isArray(parsedEDI.parties)) {\\n    parsedEDI.parties.forEach((party, index) => {\\n      const prefix = `party${index + 1}_`;\\n      partyObjs[`${prefix}Type`] = party.partyQualifier || '';\\n      partyObjs[`${prefix}Description`] = party.qualifierDescription || '';\\n      partyObjs[`${prefix}ID`] = party.partyId || '';\\n      partyObjs[`${prefix}Name`] = party.partyName || '';\\n    });\\n  }\\n  \\n  // Create one row for each line item with all header, date, and party info\\n  if (parsedEDI.lineItems && Array.isArray(parsedEDI.lineItems)) {\\n    parsedEDI.lineItems.forEach((item) => {\\n      const lineItem = {\\n        line_Number: item.lineNumber || '',\\n        line_Product_ID: item.productId || '',\\n        line_Product_ID_Type: item.productIdType || '',\\n        line_Description: item.description || '',\\n        line_Quantity: item.quantity || 0,\\n        line_Unit: item.unit || '',\\n        line_Price: item.price || 0,\\n        line_Price_Qualifier: item.priceQualifier || ''\\n      };\\n      \\n      // Combine all information into one flat object\\n      const flatRow = {\\n        ...headerObj,\\n        ...dateObjs,\\n        ...partyObjs,\\n        ...lineItem\\n      };\\n      \\n      flattened.push(flatRow);\\n    });\\n  }\\n  \\n  // If there are no line items, create at least one row with header info\\n  if (flattened.length === 0) {\\n    flattened.push({\\n      ...headerObj,\\n      ...dateObjs,\\n      ...partyObjs\\n    });\\n  }\\n  \\n  return flattened;\\n}\\n\\nconst parsedEDI = $input.all()[0].json;\\n\\n// Make sure we have valid data\\nif (!parsedEDI || !parsedEDI.orderDetails) {\\n  throw new Error('Invalid EDI data format. Please ensure the input is from the EDI parser.');\\n}\\n\\nconst flattenedData = transformToFlattened(parsedEDI);\\n\\n// Return the flattened data\\nreturn { json: { data: flattenedData } };\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"5b56fe40-9cfb-4668-946d-470dc9e3a39e\",\n      \"name\": \"Split Out by Line\",\n      \"type\": \"n8n-nodes-base.splitOut\",\n      \"position\": [\n        -4280,\n        -860\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"fieldToSplitOut\": \"data\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"903399b2-cdee-40c0-99cb-1c44d84e96d2\",\n      \"name\": \"Sticky Note5\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -4480,\n        -1240\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 320,\n        \"height\": 620,\n        \"content\": \"### 3. 处理解析后的数据  \\n该代码块用于提取订单信息并将订单行格式化，以便存储到Google表格中。  \\n\\n#### 如何设置？  \\n无需操作。\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"pinData\": {},\n  \"connections\": {\n    \"Get Email\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Extract Body\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Order Type\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Return Orders\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Outbound Orders\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Extract Body\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Parse EDI Message\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Email Trigger\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Subject includes EDI\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Order Information\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Order Info + Orderlines\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Parse EDI Message\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Order Information\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Flatten Data to Orderlines\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Split Out by Line\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Order Info + Orderlines\",\n            \"type\": \"main\",\n            \"index\": 1\n          }\n        ]\n      ]\n    },\n    \"Subject includes EDI\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get Email\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Order Info + Orderlines\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Order Type\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Flatten Data to Orderlines\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Split Out by Line\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}