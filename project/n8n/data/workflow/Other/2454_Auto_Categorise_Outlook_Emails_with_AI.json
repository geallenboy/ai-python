{
  "title": "Auto Categorise Outlook Emails with AI",
  "url": "https://n8n.io/workflows/2454-auto-categorise-outlook-emails-with-ai/",
  "category": "Other",
  "category_url": "https://n8n.io/workflows/categories/other/?sort=createdAt:desc",
  "author": "Wayne Simpson",
  "publish_date": "Last update 7 months ago",
  "publish_date_absolute": "2024-10-23",
  "content": "",
  "workflow_json": "{\"meta\":{\"instanceId\":\"67d4d33d8b0ad4e5e12f051d8ad92fc35893d7f48d7f801bc6da4f39967b3592\"},\"nodes\":[{\"id\":\"30f5203b-469d-4f0c-8493-e8f08e14e4fe\",\"name\":\"When clicking â€˜Test workflowâ€™\",\"type\":\"n8n-nodes-base.manualTrigger\",\"position\":[-560,440],\"parameters\":{},\"typeVersion\":1},{\"id\":\"d16f59dd-f54e-487b-9aac-67f109ba9869\",\"name\":\"Sticky Note8\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1000,-280],\"parameters\":{\"color\":7,\"width\":727.9032097745135,\"height\":110.58643966444157,\"content\":\"# Auto Categorise Outlook Emails with AI\\nBuilt by [Wayne Simpson](https://www.linkedin.com/in/simpsonwayne/) at [nocodecreative.io](https://nocodecreative.io)\"},\"typeVersion\":1},{\"id\":\"4e110412-8530-4322-bc5c-7f9df2b63bcb\",\"name\":\"Sticky Note9\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1100,-120],\"parameters\":{\"color\":7,\"width\":506.8102696237577,\"height\":337.24177957113216,\"content\":\"### Watch Set Up Video ðŸ‘‡\\n[![Auto Categorise Outlook Emails with AI](https://vdyfnvnstovfxpabhdjc.supabase.co/storage/v1/object/public/images/Thumbnails/auto-categories-emails.png?t=2024-10-11T09%3A56%3A37.961Z#full-width)](https://www.youtube.com/watch?v=EhRBkkjv_3c)\\n\\n\"},\"typeVersion\":1},{\"id\":\"9d79875f-148e-46ef-967a-95c07298456d\",\"name\":\"Ollama Chat Model1\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatOllama\",\"position\":[1129,684],\"parameters\":{\"model\":\"qwen2.5:14b\",\"options\":{\"temperature\":0.2}},\"typeVersion\":1},{\"id\":\"bcf92a71-ff5f-46a7-bec3-cedb5be2bf98\",\"name\":\"Microsoft Outlook10\",\"type\":\"n8n-nodes-base.microsoftOutlook\",\"position\":[3020,8],\"parameters\":{\"folderId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"AQMkAGE3ZTU5MGMzLTFkNGItNGQ5Zi04MDQ1LThmNGFlMTVhYjMwYgAuAAAD8UhruVwm402lgPBG2Tj-aQEAnz-IOcWBGE2lrVuQgAF6zAAAAgFJAAAA\",\"cachedResultUrl\":\"https://outlook.office365.com/mail/AQMkAGE3ZTU5MGMzLTFkNGItNGQ5Zi04MDQ1LThmNGFlMTVhYjMwYgAuAAAD8UhruVwm402lgPBG2Tj%2FaQEAnz%2FIOcWBGE2lrVuQgAF6zAAAAgFJAAAA\",\"cachedResultName\":\"Junk Email\"},\"messageId\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"={{ $('varID & Category1').item.json.id }}\"},\"operation\":\"move\"},\"typeVersion\":2},{\"id\":\"100db1cb-3819-43c7-a74b-5c087ad4f2da\",\"name\":\"Microsoft Outlook12\",\"type\":\"n8n-nodes-base.microsoftOutlook\",\"position\":[2700,8],\"parameters\":{\"messageId\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"={{ $('varID & Category1').item.json.id }}\"},\"operation\":\"update\",\"updateFields\":{\"categories\":\"={{ \\n  [$('varJSON1').first().json.output.category, $('varJSON1').first().json.output.subCategory]\\n    .filter(item => item && item.trim() !== \\\"\\\")\\n    .map(item => item.charAt(0).toUpperCase() + item.slice(1))\\n}}\"}},\"typeVersion\":2},{\"id\":\"d4969259-a3ae-473d-82ef-0c9f7933c899\",\"name\":\"Loop Over Items1\",\"type\":\"n8n-nodes-base.splitInBatches\",\"position\":[160,448],\"parameters\":{\"options\":{}},\"typeVersion\":3},{\"id\":\"524f6be3-7708-4aae-b9ab-e0ef8180a627\",\"name\":\"Microsoft Outlook13\",\"type\":\"n8n-nodes-base.microsoftOutlook\",\"position\":[2700,188],\"parameters\":{\"messageId\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"={{ $('varID & Category1').item.json.id }}\"},\"operation\":\"update\",\"updateFields\":{\"categories\":\"={{ \\n  [$('varJSON1').first().json.output.category, $('varJSON1').first().json.output.subCategory]\\n    .filter(item => item && item.trim() !== \\\"\\\")\\n    .map(item => item.charAt(0).toUpperCase() + item.slice(1))\\n}}\"}},\"typeVersion\":2},{\"id\":\"72cb54f3-4e4e-4ad2-8845-11a38fc29f1a\",\"name\":\"Microsoft Outlook15\",\"type\":\"n8n-nodes-base.microsoftOutlook\",\"position\":[3020,188],\"parameters\":{\"folderId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"AQMkAGE3ZTU5MGMzLTFkNGItNGQ5Zi04MDQ1LThmNGFlMTVhYjMwYgAuAAAD8UhruVwm402lgPBG2Tj-aQEAnz-IOcWBGE2lrVuQgAF6zAADLJmrBwAAAA==\",\"cachedResultUrl\":\"https://outlook.office365.com/mail/AQMkAGE3ZTU5MGMzLTFkNGItNGQ5Zi04MDQ1LThmNGFlMTVhYjMwYgAuAAAD8UhruVwm402lgPBG2Tj%2FaQEAnz%2FIOcWBGE2lrVuQgAF6zAADLJmrBwAAAA%3D%3D\",\"cachedResultName\":\"Receipt\"},\"messageId\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"={{ $('varID & Category1').item.json.id }}\"},\"operation\":\"move\"},\"typeVersion\":2},{\"id\":\"e4446e84-c05e-4d04-b415-7608e39024ee\",\"name\":\"Microsoft Outlook16\",\"type\":\"n8n-nodes-base.microsoftOutlook\",\"position\":[2709,504],\"parameters\":{\"messageId\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"={{ $('varID & Category1').item.json.id }}\"},\"operation\":\"update\",\"updateFields\":{\"categories\":\"={{ \\n  [$('varJSON1').first().json.output.category, $('varJSON1').first().json.output.subCategory]\\n    .filter(item => item && item.trim() !== \\\"\\\")\\n    .map(item => item.charAt(0).toUpperCase() + item.slice(1))\\n}}\"}},\"typeVersion\":2},{\"id\":\"3ee05cfe-a528-472e-aa3d-c890fd88b6c4\",\"name\":\"Microsoft Outlook17\",\"type\":\"n8n-nodes-base.microsoftOutlook\",\"position\":[3020,508],\"parameters\":{\"folderId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"AQMkAGE3ZTU5MGMzLTFkNGItNGQ5Zi04MDQ1LThmNGFlMTVhYjMwYgAuAAAD8UhruVwm402lgPBG2Tj-aQEAnz-IOcWBGE2lrVuQgAF6zAADLJmrCAAAAA==\",\"cachedResultUrl\":\"https://outlook.office365.com/mail/AQMkAGE3ZTU5MGMzLTFkNGItNGQ5Zi04MDQ1LThmNGFlMTVhYjMwYgAuAAAD8UhruVwm402lgPBG2Tj%2FaQEAnz%2FIOcWBGE2lrVuQgAF6zAADLJmrCAAAAA%3D%3D\",\"cachedResultName\":\"Community\"},\"messageId\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"={{ $('varID & Category1').item.json.id }}\"},\"operation\":\"move\"},\"typeVersion\":2},{\"id\":\"2fcecd9e-95cc-489a-b874-699c54518e44\",\"name\":\"Microsoft Outlook18\",\"type\":\"n8n-nodes-base.microsoftOutlook\",\"position\":[2709,344],\"parameters\":{\"messageId\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"={{ $('varID & Category1').item.json.id }}\"},\"operation\":\"update\",\"updateFields\":{\"categories\":\"={{ \\n  [$('varJSON1').first().json.output.category, $('varJSON1').first().json.output.subCategory]\\n    .filter(item => item && item.trim() !== \\\"\\\")\\n    .map(item => item.charAt(0).toUpperCase() + item.slice(1))\\n}}\"}},\"typeVersion\":2},{\"id\":\"41a39309-1a94-461f-9308-63dd5b9a94a7\",\"name\":\"Microsoft Outlook19\",\"type\":\"n8n-nodes-base.microsoftOutlook\",\"position\":[3020,348],\"parameters\":{\"folderId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"AQMkAGE3ZTU5MGMzLTFkNGItNGQ5Zi04MDQ1LThmNGFlMTVhYjMwYgAuAAAD8UhruVwm402lgPBG2Tj-aQEAnz-IOcWBGE2lrVuQgAF6zAADLJmrCQAAAA==\",\"cachedResultUrl\":\"https://outlook.office365.com/mail/AQMkAGE3ZTU5MGMzLTFkNGItNGQ5Zi04MDQ1LThmNGFlMTVhYjMwYgAuAAAD8UhruVwm402lgPBG2Tj%2FaQEAnz%2FIOcWBGE2lrVuQgAF6zAADLJmrCQAAAA%3D%3D\",\"cachedResultName\":\"SaaS\"},\"messageId\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"={{ $('varID & Category1').item.json.id }}\"},\"operation\":\"move\"},\"typeVersion\":2},{\"id\":\"ebf606f9-099c-4218-b23b-66e2487262d0\",\"name\":\"Markdown1\",\"type\":\"n8n-nodes-base.markdown\",\"notes\":\"Converts the body of the email to markdown\",\"position\":[420,468],\"parameters\":{\"html\":\"={{ $('Loop Over Items1').item.json.body.content }}\",\"options\":{}},\"notesInFlow\":true,\"typeVersion\":1},{\"id\":\"ff447dd5-3ef6-4a02-8453-3489af8bf6b5\",\"name\":\"varEmal1\",\"type\":\"n8n-nodes-base.set\",\"notes\":\"Set email fields\",\"position\":[620,468],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"edb304e1-3e9f-4a77-918c-25646addbc53\",\"name\":\"subject\",\"type\":\"string\",\"value\":\"={{ $json.subject }}\"},{\"id\":\"57a3ef3a-2701-40d9-882f-f43a7219f148\",\"name\":\"importance\",\"type\":\"string\",\"value\":\"={{ $json.importance }}\"},{\"id\":\"d8317f4f-aa0e-4196-89af-cb016765490a\",\"name\":\"sender\",\"type\":\"object\",\"value\":\"={{ $json.sender.emailAddress }}\"},{\"id\":\"908716c8-9ff7-4bdc-a1a3-64227559635e\",\"name\":\"from\",\"type\":\"object\",\"value\":\"={{ $json.from.emailAddress }}\"},{\"id\":\"ce007329-e221-4c5a-8130-2f8e9130160f\",\"name\":\"body\",\"type\":\"string\",\"value\":\"={{ $json.data\\n    .replace(/<[^>]*>/g, '')                      // Remove HTML tags\\n    .replace(/\\\\[(.*?)\\\\]\\\\((.*?)\\\\)/g, '')            // Remove Markdown links like [text](link)\\n    .replace(/!\\\\[.*?\\\\]\\\\(.*?\\\\)/g, '')               // Remove Markdown images like ![alt](image-link)\\n    .replace(/\\\\|/g, '')                            // Remove table separators \\\"|\\\"\\n    .replace(/-{3,}/g, '')                         // Remove horizontal rule \\\"---\\\"\\n    .replace(/\\\\n+/g, ' ')                          // Remove multiple newlines\\n    .replace(/([^\\\\w\\\\s.,!?@])/g, '')                // Remove special characters except essential ones\\n    .replace(/\\\\s{2,}/g, ' ')                       // Replace multiple spaces with a single space\\n    .trim()                                        // Trim leading/trailing whitespace\\n}}\\n\"}]}},\"typeVersion\":3.4},{\"id\":\"198524cb-c9f0-4261-8c38-7c878efe7457\",\"name\":\"Microsoft Outlook20\",\"type\":\"n8n-nodes-base.microsoftOutlook\",\"position\":[2700,668],\"parameters\":{\"messageId\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"={{ $('varID & Category1').item.json.id }}\"},\"operation\":\"update\",\"updateFields\":{\"categories\":\"={{ \\n  [$('varJSON1').first().json.output.category, $('varJSON1').first().json.output.subCategory]\\n    .filter(item => item && item.trim() !== \\\"\\\")\\n    .map(item => item.charAt(0).toUpperCase() + item.slice(1))\\n}}\"}},\"typeVersion\":2},{\"id\":\"ec73629c-59ac-4f0e-a432-2c06934952ab\",\"name\":\"Microsoft Outlook21\",\"type\":\"n8n-nodes-base.microsoftOutlook\",\"position\":[2709,1044],\"parameters\":{\"messageId\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"={{ $('varID & Category1').item.json.id }}\"},\"operation\":\"update\",\"updateFields\":{\"categories\":\"={{ \\n  [$('varJSON1').first().json.output.category, $('varJSON1').first().json.output.subCategory]\\n    .filter(item => item && item.trim() !== \\\"\\\")\\n    .map(item => item.charAt(0).toUpperCase() + item.slice(1))\\n}}\"}},\"typeVersion\":2},{\"id\":\"0a19d15c-0cd3-4f26-9be2-4914522751fb\",\"name\":\"Filter1\",\"type\":\"n8n-nodes-base.filter\",\"position\":[-100,448],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"c8cd6917-f94e-4fb7-8601-b8ed8f1aa8bf\",\"operator\":{\"type\":\"array\",\"operation\":\"empty\",\"singleValue\":true},\"leftValue\":\"={{ $json.categories }}\",\"rightValue\":\"\"}]}},\"typeVersion\":2.2},{\"id\":\"96e6e31c-6306-44a8-a57a-2b5216636b00\",\"name\":\"If1\",\"type\":\"n8n-nodes-base.if\",\"notes\":\"Checks if the email has been read\",\"position\":[3320,668],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"f8cf2a56-cea8-4150-b7a0-048dbda20f2f\",\"operator\":{\"type\":\"boolean\",\"operation\":\"true\",\"singleValue\":true},\"leftValue\":\"={{ $json.isRead }}\",\"rightValue\":\"\"}]}},\"typeVersion\":2.2},{\"id\":\"8a6e0118-abe3-45e2-aefc-94640348b2ec\",\"name\":\"Microsoft Outlook22\",\"type\":\"n8n-nodes-base.microsoftOutlook\",\"position\":[2709,864],\"parameters\":{\"messageId\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"={{ $('varID & Category1').item.json.id }}\"},\"operation\":\"update\",\"updateFields\":{\"categories\":\"={{ \\n  [$('varJSON1').first().json.output.category, $('varJSON1').first().json.output.subCategory]\\n    .filter(item => item && item.trim() !== \\\"\\\")\\n    .map(item => item.charAt(0).toUpperCase() + item.slice(1))\\n}}\"}},\"typeVersion\":2},{\"id\":\"e2d8e7b5-4447-4327-9f4e-b8d52765667e\",\"name\":\"Catch Errors1\",\"type\":\"n8n-nodes-base.set\",\"position\":[1760,608],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"0dc6d439-60fb-49f6-b4d5-f5cce6f030ad\",\"name\":\"error\",\"type\":\"string\",\"value\":\"={{ $json }}\"}]}},\"typeVersion\":3.4},{\"id\":\"17f6ac43-51e4-4bee-b0d8-13deb3bf3cc9\",\"name\":\"varJSON1\",\"type\":\"n8n-nodes-base.set\",\"onError\":\"continueErrorOutput\",\"position\":[1540,468],\"parameters\":{\"options\":{\"ignoreConversionErrors\":true},\"assignments\":{\"assignments\":[{\"id\":\"0c52f57f-74eb-4385-ac6b-f3e5f4f50e73\",\"name\":\"output\",\"type\":\"object\",\"value\":\"={{ $json.output.replace(/^.*?({.*}).*$/s, '$1') }}\"}]}},\"typeVersion\":3.4},{\"id\":\"82dd9631-a34b-4d54-be28-6f8dcc3548f0\",\"name\":\"Sticky Note10\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-360,220],\"parameters\":{\"width\":411.91693012378937,\"height\":401.49417117683515,\"content\":\"## Outlook Business with filters\\nFilters:\\n```\\nflag/flagStatus eq 'notFlagged' and not categories/any()\\n```\\n\\nThese filters ensure we do not process flagged emails or email that already have a category set.\"},\"typeVersion\":1},{\"id\":\"0583e196-37a5-43db-8c0a-aa624029c926\",\"name\":\"Microsoft Outlook23\",\"type\":\"n8n-nodes-base.microsoftOutlook\",\"position\":[-300,448],\"parameters\":{\"limit\":1,\"fields\":[\"flag\",\"from\",\"importance\",\"replyTo\",\"sender\",\"subject\",\"toRecipients\",\"body\",\"categories\",\"isRead\"],\"output\":\"fields\",\"options\":{},\"filtersUI\":{\"values\":{\"filters\":{\"custom\":\"flag/flagStatus eq 'notFlagged' and not categories/any()\",\"foldersToInclude\":[\"AQMkAGE3ZTU5MGMzLTFkNGItNGQ5Zi04MDQ1LThmNGFlMTVhYjMwYgAuAAAD8UhruVwm402lgPBG2Tj-aQEAnz-IOcWBGE2lrVuQgAF6zAAAAgEMAAAA\"]}}},\"operation\":\"getAll\"},\"typeVersion\":2},{\"id\":\"a9540e6b-929b-4460-8972-93e4d19cd934\",\"name\":\"varID & Category1\",\"type\":\"n8n-nodes-base.set\",\"position\":[900,468],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"de2ad4f2-7381-4715-a3f4-59611e161b74\",\"name\":\"id\",\"type\":\"string\",\"value\":\"={{ $('Microsoft Outlook23').item.json.id }}\"},{\"id\":\"458c7a89-e4a3-46d0-8b38-72d87748e306\",\"name\":\"category\",\"type\":\"string\",\"value\":\"\\\"action\\\", \\\"junk\\\", \\\"receipt\\\", \\\"SaaS\\\", \\\"community\\\", \\\"business\\\" or \\\"other\\\"\"}]}},\"typeVersion\":3.4},{\"id\":\"e6b3b41e-d7d3-4c9b-8189-a005c748ff18\",\"name\":\"Sticky Note11\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[360,348],\"parameters\":{\"color\":6,\"width\":418.7820408163265,\"height\":301.40952380952365,\"content\":\"## Sanitise Email \\nRemoves HTML and useless information in preparation for the AI Agent\"},\"typeVersion\":1},{\"id\":\"f9787a75-526c-4ef1-b0a7-0db7d890ab3f\",\"name\":\"Sticky Note12\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[820,348],\"parameters\":{\"color\":6,\"width\":256.16108843537415,\"height\":298.37931972789124,\"content\":\"## Modify Categories \\nEdit this to customise category selection\"},\"typeVersion\":1},{\"id\":\"50223a01-34cf-4191-9dd7-3dac02a9e945\",\"name\":\"Sticky Note13\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1480,328],\"parameters\":{\"color\":5,\"width\":441.003537414966,\"height\":463.0204081632651,\"content\":\"## Convert to JSON\\n* Ensures the Agent output to converted to JSON\\n* Catches any errors and continues processing\"},\"typeVersion\":1},{\"id\":\"4580c532-96a6-46b4-8922-d79316d1cc01\",\"name\":\"Sticky Note14\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[2120,328],\"parameters\":{\"color\":5,\"width\":311.71482993197264,\"height\":454.93986394557805,\"content\":\"## Switch Categories\\nEnsure your categories match the **varID & Category** Edit Fields node\"},\"typeVersion\":1},{\"id\":\"b51a7c34-2a5e-4670-81a4-d1582711c69a\",\"name\":\"Sticky Note15\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[2629,-76],\"parameters\":{\"color\":4,\"width\":251.3480889735252,\"height\":1289.0156245602684,\"content\":\"## Set Categories\\n\"},\"typeVersion\":1},{\"id\":\"3a7ede7b-539b-49d2-8803-153ca6c9eb69\",\"name\":\"Sticky Note16\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[2949,-76],\"parameters\":{\"color\":4,\"width\":251.3480889735252,\"height\":770.995811762121,\"content\":\"## Move to Folders\\n\"},\"typeVersion\":1},{\"id\":\"ee9a9d78-8c07-470a-9d1b-ceddfc8875ca\",\"name\":\"Sticky Note17\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[3260,553],\"parameters\":{\"color\":4,\"height\":293.65527013262994,\"content\":\"## Check if email has been read\\n\\n\"},\"typeVersion\":1},{\"id\":\"c75b9d38-79a7-4be2-a90b-a99da1bbd745\",\"name\":\"Microsoft Outlook Move Message1\",\"type\":\"n8n-nodes-base.microsoftOutlook\",\"position\":[3609,604],\"parameters\":{\"folderId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"AQMkAGE3ZTU5MGMzLTFkNGItNGQ5Zi04MDQ1LThmNGFlMTVhYjMwYgAuAAAD8UhruVwm402lgPBG2Tj-aQEAnz-IOcWBGE2lrVuQgAF6zAADLJmrCwAAAA==\",\"cachedResultUrl\":\"https://outlook.office365.com/mail/AQMkAGE3ZTU5MGMzLTFkNGItNGQ5Zi04MDQ1LThmNGFlMTVhYjMwYgAuAAAD8UhruVwm402lgPBG2Tj%2FaQEAnz%2FIOcWBGE2lrVuQgAF6zAADLJmrCwAAAA%3D%3D\",\"cachedResultName\":\"Actioned\"},\"messageId\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"={{ $('varID & Category1').item.json.id }}\"},\"operation\":\"move\"},\"typeVersion\":2},{\"id\":\"85ff0348-16dc-46e6-bf70-48a10fe0ded8\",\"name\":\"AI Agent1\",\"type\":\"@n8n/n8n-nodes-langchain.agent\",\"position\":[1160,468],\"parameters\":{\"text\":\"=Categorise the following email\\n<email>\\n{{ $('varEmal1').first().json.toJsonString() }}\\n</email>\\n\\nEnsure your final output is valid JSON with no additional text or token in the following format:\\n\\n{\\n  \\\"subject\\\": \\\"SUBJECT_LINE\\\",1\\n  \\\"category\\\": \\\"CATEGORY\\\",\\n  \\\"subCategory\\\": \\\"SUBCATEGORY\\\", //use sparingly\\n  \\\"analysis\\\": \\\"ANALYSIS_REASONING\\\"\\n}\\n\\nRemember you can only use ONE of the following categories {{ $json.category }}. No other categories can be used. Use the subcategory for additional context, for example, if a SaaS email requires action, or if a business email requires action. Do not create any additional subcategories, you can only use ONE of the following {{ $json.category }}.\",\"options\":{\"systemMessage\":\"=You're an AI assistant for a freelance developer, categorizing emails as {{ $json.category }}. Email info is in <email> tags.\\n\\nCategorization priority:\\n\\nAction: Needs response or action (includes some SaaS emails), avoid sales email but include enquires.\\nJunk: Ads, sales, newsletters, promotions, daily digests, (emojis often indicate junk), phishing, scams, discounts etc.\\nReceipt: Any purchase confirmation.\\nSaaS: Account/security updates, unless action required, generic SaaS information, usually from a non-personal email address.\\nCommunity: Updates, events, forums, everything related to \\\"community\\\".\\nBusiness: Any communication related to freelance work, usually from a humans email address\\nOther: Doesn't fit into any other category.\\n\\nKey points:\\n\\nSaaS emails needing action are \\\"SaaS\\\" and subcategory \\\"action\\\".\\nAnalyze the subject, body, email addresses and other data.\\nLook for specific keywords and phrases for each category.\\nEmail can have 2 categories, primary and sub, for example, \\\"action\\\" and \\\"SaaS\\\" or \\\"action\\\" and \\\"business\\\".\\nEmails from business development executives are often junk.\\n\\n\\nOutput in valid JSON format:\\n{\\n\\\"subject\\\": \\\"SUBJECT_LINE\\\",\\n\\\"category\\\": \\\"PRIMARY CATEGORY\\\",\\n\\\"subCategory\\\": \\\"SUBCATEGORY\\\", //use sparingly\\n\\\"analysis\\\": \\\"Brief 1-2 sentence explanation of category choice\\\"\\n}\\nNo additional text or tokens outside the JSON.\\n\\nYou may only use the following categories and subcategories, do not create any more categories or subcategories: {{ $json.category }}\"},\"promptType\":\"define\",\"hasOutputParser\":true},\"typeVersion\":1.6},{\"id\":\"93e7be79-9035-4b58-9a83-b9182a0515f8\",\"name\":\"Merge1\",\"type\":\"n8n-nodes-base.merge\",\"position\":[3989,564],\"parameters\":{\"numberInputs\":7},\"typeVersion\":3},{\"id\":\"cbaeaed1-cb09-4614-93f1-3fe349cd0e4e\",\"name\":\"Switch1\",\"type\":\"n8n-nodes-base.switch\",\"position\":[2220,488],\"parameters\":{\"rules\":{\"values\":[{\"outputKey\":\"junk\",\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":false,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"operator\":{\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $json.output.category }}\",\"rightValue\":\"junk\"}]},\"renameOutput\":true},{\"outputKey\":\"receipt\",\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":false,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"0c61c7a8-e8b4-49c5-a96c-402d5eae7089\",\"operator\":{\"name\":\"filter.operator.equals\",\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $json.output.category }}\",\"rightValue\":\"receipt\"}]},\"renameOutput\":true},{\"outputKey\":\"SaaS\",\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":false,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"703f65c8-cf4a-47fe-ad1a-a5f6e0412ae7\",\"operator\":{\"name\":\"filter.operator.equals\",\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $json.output.category }}\",\"rightValue\":\"SaaS\"}]},\"renameOutput\":true},{\"outputKey\":\"community\",\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":false,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"b074d5cd-9215-40df-8877-5df904edc000\",\"operator\":{\"name\":\"filter.operator.equals\",\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $json.output.category }}\",\"rightValue\":\"community\"}]},\"renameOutput\":true},{\"outputKey\":\"action\",\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":false,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"bece338a-e0c5-43b5-b8cc-41229a374213\",\"operator\":{\"name\":\"filter.operator.equals\",\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $json.output.category }}\",\"rightValue\":\"action\"}]},\"renameOutput\":true},{\"outputKey\":\"business\",\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":false,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"d6c9751f-0ffa-4041-a579-6957bb9c9296\",\"operator\":{\"name\":\"filter.operator.equals\",\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $json.output.category }}\",\"rightValue\":\"business\"}]},\"renameOutput\":true}]},\"options\":{\"ignoreCase\":true,\"fallbackOutput\":\"extra\"}},\"typeVersion\":3.2}],\"pinData\":{},\"connections\":{\"If1\":{\"main\":[[{\"node\":\"Microsoft Outlook Move Message1\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Merge1\",\"type\":\"main\",\"index\":5}]]},\"Merge1\":{\"main\":[[{\"node\":\"Loop Over Items1\",\"type\":\"main\",\"index\":0}]]},\"Filter1\":{\"main\":[[{\"node\":\"Loop Over Items1\",\"type\":\"main\",\"index\":0}]]},\"Switch1\":{\"main\":[[{\"node\":\"Microsoft Outlook12\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Microsoft Outlook13\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Microsoft Outlook18\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Microsoft Outlook16\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Microsoft Outlook20\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Microsoft Outlook22\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Microsoft Outlook21\",\"type\":\"main\",\"index\":0}]]},\"varEmal1\":{\"main\":[[{\"node\":\"varID & Category1\",\"type\":\"main\",\"index\":0}]]},\"varJSON1\":{\"main\":[[{\"node\":\"Switch1\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Catch Errors1\",\"type\":\"main\",\"index\":0}]]},\"AI Agent1\":{\"main\":[[{\"node\":\"varJSON1\",\"type\":\"main\",\"index\":0}]]},\"Markdown1\":{\"main\":[[{\"node\":\"varEmal1\",\"type\":\"main\",\"index\":0}]]},\"Catch Errors1\":{\"main\":[[{\"node\":\"Loop Over Items1\",\"type\":\"main\",\"index\":0}]]},\"Loop Over Items1\":{\"main\":[null,[{\"node\":\"Markdown1\",\"type\":\"main\",\"index\":0}]]},\"varID & Category1\":{\"main\":[[{\"node\":\"AI Agent1\",\"type\":\"main\",\"index\":0}]]},\"Ollama Chat Model1\":{\"ai_languageModel\":[[{\"node\":\"AI Agent1\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"Microsoft Outlook10\":{\"main\":[[{\"node\":\"Merge1\",\"type\":\"main\",\"index\":0}]]},\"Microsoft Outlook12\":{\"main\":[[{\"node\":\"Microsoft Outlook10\",\"type\":\"main\",\"index\":0}]]},\"Microsoft Outlook13\":{\"main\":[[{\"node\":\"Microsoft Outlook15\",\"type\":\"main\",\"index\":0}]]},\"Microsoft Outlook15\":{\"main\":[[{\"node\":\"Merge1\",\"type\":\"main\",\"index\":1}]]},\"Microsoft Outlook16\":{\"main\":[[{\"node\":\"Microsoft Outlook17\",\"type\":\"main\",\"index\":0}]]},\"Microsoft Outlook17\":{\"main\":[[{\"node\":\"Merge1\",\"type\":\"main\",\"index\":3}]]},\"Microsoft Outlook18\":{\"main\":[[{\"node\":\"Microsoft Outlook19\",\"type\":\"main\",\"index\":0}]]},\"Microsoft Outlook19\":{\"main\":[[{\"node\":\"Merge1\",\"type\":\"main\",\"index\":2}]]},\"Microsoft Outlook20\":{\"main\":[[{\"node\":\"If1\",\"type\":\"main\",\"index\":0}]]},\"Microsoft Outlook21\":{\"main\":[[{\"node\":\"Merge1\",\"type\":\"main\",\"index\":6}]]},\"Microsoft Outlook22\":{\"main\":[[{\"node\":\"If1\",\"type\":\"main\",\"index\":0}]]},\"Microsoft Outlook23\":{\"main\":[[{\"node\":\"Filter1\",\"type\":\"main\",\"index\":0}]]},\"Microsoft Outlook Move Message1\":{\"main\":[[{\"node\":\"Merge1\",\"type\":\"main\",\"index\":4}]]},\"When clicking â€˜Test workflowâ€™\":{\"main\":[[{\"node\":\"Microsoft Outlook23\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "**Automate your email management** with this workflow, designed for freelancers and business professionals who receive high volumes of emails. By leveraging AI-powered categorisation and dynamic email processing, this template helps you organise your inbox and streamline communication for better efficiency and productivity.\n\n**[Check out the YouTube video for step-by-step set up instructions!](https://www.youtube.com/watch?v=EhRBkkjv_3c)**\n\n### **How it works:**\n\n  1. **Fetch & Filter Emails:** The workflow retrieves emails from your Microsoft Outlook account, filtering out flagged emails and those already categorised.\n  2. **Content Preparation:** Each email is cleaned up and converted to a structured format using Markdown, making it easier for AI processing.\n  3. **AI Categorization:** The content is analysed using an AI model, which categorises the emails into predefined categories (e.g., Action, Junk, Business, SaaS) based on the context and content.\n  4. **Email Categorization & Folder Management:** The categorised emails are updated in Microsoft Outlook and moved to respective folders such as \"Junk Email\" or \"Receipts\" based on the AI's classification.\n  5. **Conditional Processing & Final Checks:** Additional checks and conditions ensure that only unread emails are processed, and errors are gracefully managed to maintain workflow stability.\n\n\n\n### **Set up steps:**\n\n  1. **Connect Microsoft Outlook:** Link your Microsoft Outlook account using the built-in credentials node to enable email fetching, updating, and folder management.\n  2. **Configure AI Model (Ollama API):** Set up the AI model by connecting to the Ollama API and choosing your desired language model for categorisation.\n  3. **Modify Email Categories (Optional):** Customize the categories and subcategories within the workflow to suit your unique email management needs.\n  4. **Set Up Error Handling:** Review the error handling node settings to ensure smooth workflow execution.\n\n\n\nThis template offers a robust solution for managing and organising your inbox, helping you save time and keep your focus on important emails.\n",
  "readme_html": "<!--[--><div data-v-50766329=\"\"><p><strong>Automate your email management</strong> with this workflow, designed for freelancers and business professionals who receive high volumes of emails. By leveraging AI-powered categorisation and dynamic email processing, this template helps you organise your inbox and streamline communication for better efficiency and productivity.</p>\n<p><strong><a href=\"https://www.youtube.com/watch?v=EhRBkkjv_3c\" rel=\"ugc nofollow\" target=\"_blank\">Check out the YouTube video for step-by-step set up instructions!</a></strong></p>\n<h3><strong>How it works:</strong></h3>\n<ol>\n<li><strong>Fetch &amp; Filter Emails:</strong> The workflow retrieves emails from your Microsoft Outlook account, filtering out flagged emails and those already categorised.</li>\n<li><strong>Content Preparation:</strong> Each email is cleaned up and converted to a structured format using Markdown, making it easier for AI processing.</li>\n<li><strong>AI Categorization:</strong> The content is analysed using an AI model, which categorises the emails into predefined categories (e.g., Action, Junk, Business, SaaS) based on the context and content.</li>\n<li><strong>Email Categorization &amp; Folder Management:</strong> The categorised emails are updated in Microsoft Outlook and moved to respective folders such as \"Junk Email\" or \"Receipts\" based on the AI's classification.</li>\n<li><strong>Conditional Processing &amp; Final Checks:</strong> Additional checks and conditions ensure that only unread emails are processed, and errors are gracefully managed to maintain workflow stability.</li>\n</ol>\n<h3><strong>Set up steps:</strong></h3>\n<ol>\n<li><strong>Connect Microsoft Outlook:</strong> Link your Microsoft Outlook account using the built-in credentials node to enable email fetching, updating, and folder management.</li>\n<li><strong>Configure AI Model (Ollama API):</strong> Set up the AI model by connecting to the Ollama API and choosing your desired language model for categorisation.</li>\n<li><strong>Modify Email Categories (Optional):</strong> Customize the categories and subcategories within the workflow to suit your unique email management needs.</li>\n<li><strong>Set Up Error Handling:</strong> Review the error handling node settings to ensure smooth workflow execution.</li>\n</ol>\n<p>This template offers a robust solution for managing and organising your inbox, helping you save time and keep your focus on important emails.</p>\n</div><!--]-->",
  "readme_zh": "**è‡ªåŠ¨åŒ–é‚®ä»¶ç®¡ç†**  \næœ¬å·¥ä½œæµä¸“ä¸ºæŽ¥æ”¶å¤§é‡é‚®ä»¶çš„è‡ªç”±èŒä¸šè€…å’Œå•†åŠ¡äººå£«è®¾è®¡ï¼Œé€šè¿‡AIæ™ºèƒ½åˆ†ç±»ä¸ŽåŠ¨æ€é‚®ä»¶å¤„ç†ï¼ŒåŠ©æ‚¨é«˜æ•ˆæ•´ç†æ”¶ä»¶ç®±ï¼Œä¼˜åŒ–æ²Ÿé€šæµç¨‹ï¼Œæå‡å·¥ä½œæ•ˆçŽ‡ã€‚\n\n**[ç‚¹å‡»è§‚çœ‹YouTubeè§†é¢‘ï¼ŒèŽ·å–é€æ­¥è®¾ç½®æŒ‡å—ï¼](https://www.youtube.com/watch?v=EhRBkkjv_3c)**\n\n### **è¿ä½œåŽŸç†ï¼š**\n\n1. **æŠ“å–ä¸Žç­›é€‰é‚®ä»¶**  \n   å·¥ä½œæµä»ŽMicrosoft Outlookè´¦æˆ·èŽ·å–é‚®ä»¶ï¼Œè‡ªåŠ¨è¿‡æ»¤å·²æ ‡è®°æˆ–å·²åˆ†ç±»é‚®ä»¶ã€‚  \n2. **å†…å®¹é¢„å¤„ç†**  \n   æ¯å°é‚®ä»¶ç»æ¸…ç†åŽè½¬ä¸ºMarkdownç»“æž„åŒ–æ ¼å¼ï¼Œä¾¿äºŽAIè§£æžã€‚  \n3. **AIæ™ºèƒ½åˆ†ç±»**  \n   åŸºäºŽä¸Šä¸‹æ–‡å’Œå†…å®¹ï¼ŒAIæ¨¡åž‹å°†é‚®ä»¶å½’ç±»è‡³é¢„è®¾æ ‡ç­¾ï¼ˆå¦‚ï¼šå¾…å¤„ç†ã€åžƒåœ¾é‚®ä»¶ã€å•†åŠ¡ã€SaaSæœåŠ¡ç­‰ï¼‰ã€‚  \n4. **åˆ†ç±»ä¸Žæ–‡ä»¶å¤¹ç®¡ç†**  \n   æ ¹æ®AIåˆ†ç±»ç»“æžœï¼Œè‡ªåŠ¨æ›´æ–°Outlooké‚®ä»¶æ ‡ç­¾å¹¶å°†é‚®ä»¶ç§»è‡³å¯¹åº”æ–‡ä»¶å¤¹ï¼ˆå¦‚â€œåžƒåœ¾é‚®ä»¶â€æˆ–â€œæ”¶æ®â€ï¼‰ã€‚  \n5. **æ¡ä»¶å¤„ç†ä¸Žç»ˆæ£€**  \n   ä»…å¤„ç†æœªè¯»é‚®ä»¶ï¼Œå¹¶é€šè¿‡é”™è¯¯å¤„ç†æœºåˆ¶ä¿éšœå·¥ä½œæµç¨³å®šè¿è¡Œã€‚\n\n### **è®¾ç½®æ­¥éª¤ï¼š**\n\n1. **è¿žæŽ¥Microsoft Outlook**  \n   ä½¿ç”¨å†…ç½®å‡­è¯èŠ‚ç‚¹å…³è”Outlookè´¦æˆ·ï¼Œå¯ç”¨é‚®ä»¶æŠ“å–ã€æ›´æ–°åŠæ–‡ä»¶å¤¹ç®¡ç†åŠŸèƒ½ã€‚  \n2. **é…ç½®AIæ¨¡åž‹ï¼ˆOllama APIï¼‰**  \n   è¿žæŽ¥Ollama APIï¼Œé€‰æ‹©é€‚åˆåˆ†ç±»ä»»åŠ¡çš„è¯­è¨€æ¨¡åž‹ã€‚  \n3. **è‡ªå®šä¹‰é‚®ä»¶åˆ†ç±»ï¼ˆå¯é€‰ï¼‰**  \n   æŒ‰éœ€è°ƒæ•´å·¥ä½œæµä¸­çš„ä¸»åˆ†ç±»ä¸Žå­åˆ†ç±»æ ‡ç­¾ã€‚  \n4. **è®¾ç½®é”™è¯¯å¤„ç†**  \n   æ£€æŸ¥é”™è¯¯å¤„ç†èŠ‚ç‚¹é…ç½®ï¼Œç¡®ä¿å·¥ä½œæµé¡ºç•…æ‰§è¡Œã€‚  \n\nè¯¥æ¨¡æ¿ä¸ºæ”¶ä»¶ç®±ç®¡ç†æä¾›å¼ºåŠ›æ”¯æŒï¼ŒåŠ©æ‚¨èŠ‚çœæ—¶é—´ï¼Œä¸“æ³¨å¤„ç†é‡è¦é‚®ä»¶ã€‚",
  "title_zh": "åˆ©ç”¨AIè‡ªåŠ¨åˆ†ç±»Outlooké‚®ä»¶",
  "publish_date_zh": "æœ€åŽæ›´æ–°äºŽ7ä¸ªæœˆå‰",
  "workflow_json_zh": "{\n  \"meta\": {\n    \"instanceId\": \"67d4d33d8b0ad4e5e12f051d8ad92fc35893d7f48d7f801bc6da4f39967b3592\"\n  },\n  \"nodes\": [\n    {\n      \"id\": \"30f5203b-469d-4f0c-8493-e8f08e14e4fe\",\n      \"name\": \"When clicking â€˜Test workflowâ€™\",\n      \"type\": \"n8n-nodes-base.manualTrigger\",\n      \"position\": [\n        -560,\n        440\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"d16f59dd-f54e-487b-9aac-67f109ba9869\",\n      \"name\": \"Sticky Note8\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1000,\n        -280\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 727.9032097745135,\n        \"height\": 110.58643966444157,\n        \"content\": \"# ä½¿ç”¨AIè‡ªåŠ¨åˆ†ç±»Outlooké‚®ä»¶\\nç”±[Wayne Simpson](https://www.linkedin.com/in/simpsonwayne/)åœ¨[nocodecreative.io](https://nocodecreative.io)åˆ›å»º\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"4e110412-8530-4322-bc5c-7f9df2b63bcb\",\n      \"name\": \"Sticky Note9\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1100,\n        -120\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 506.8102696237577,\n        \"height\": 337.24177957113216,\n        \"content\": \"### è§‚çœ‹è®¾ç½®è§†é¢‘ ðŸ‘‡\\n[![ç”¨AIè‡ªåŠ¨åˆ†ç±»Outlooké‚®ä»¶](https://vdyfnvnstovfxpabhdjc.supabase.co/storage/v1/object/public/images/Thumbnails/auto-categories-emails.png?t=2024-10-11T09%3A56%3A37.961Z#full-width)](https://www.youtube.com/watch?v=EhRBkkjv_3c)\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"9d79875f-148e-46ef-967a-95c07298456d\",\n      \"name\": \"Ollama Chat Model1\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatOllama\",\n      \"position\": [\n        1129,\n        684\n      ],\n      \"parameters\": {\n        \"model\": \"qwen2.5:14b\",\n        \"options\": {\n          \"temperature\": 0.2\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"bcf92a71-ff5f-46a7-bec3-cedb5be2bf98\",\n      \"name\": \"Microsoft Outlook10\",\n      \"type\": \"n8n-nodes-base.microsoftOutlook\",\n      \"position\": [\n        3020,\n        8\n      ],\n      \"parameters\": {\n        \"folderId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"AQMkAGE3ZTU5MGMzLTFkNGItNGQ5Zi04MDQ1LThmNGFlMTVhYjMwYgAuAAAD8UhruVwm402lgPBG2Tj-aQEAnz-IOcWBGE2lrVuQgAF6zAAAAgFJAAAA\",\n          \"cachedResultUrl\": \"https://outlook.office365.com/mail/AQMkAGE3ZTU5MGMzLTFkNGItNGQ5Zi04MDQ1LThmNGFlMTVhYjMwYgAuAAAD8UhruVwm402lgPBG2Tj%2FaQEAnz%2FIOcWBGE2lrVuQgAF6zAAAAgFJAAAA\",\n          \"cachedResultName\": \"Junk Email\"\n        },\n        \"messageId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $('varID & Category1').item.json.id }}\"\n        },\n        \"operation\": \"move\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"100db1cb-3819-43c7-a74b-5c087ad4f2da\",\n      \"name\": \"Microsoft Outlook12\",\n      \"type\": \"n8n-nodes-base.microsoftOutlook\",\n      \"position\": [\n        2700,\n        8\n      ],\n      \"parameters\": {\n        \"messageId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $('varID & Category1').item.json.id }}\"\n        },\n        \"operation\": \"update\",\n        \"updateFields\": {\n          \"categories\": \"={{ \\n  [$('varJSON1').first().json.output.category, $('varJSON1').first().json.output.subCategory]\\n    .filter(item => item && item.trim() !== \\\"\\\")\\n    .map(item => item.charAt(0).toUpperCase() + item.slice(1))\\n}}\"\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"d4969259-a3ae-473d-82ef-0c9f7933c899\",\n      \"name\": \"Loop Over Items1\",\n      \"type\": \"n8n-nodes-base.splitInBatches\",\n      \"position\": [\n        160,\n        448\n      ],\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"524f6be3-7708-4aae-b9ab-e0ef8180a627\",\n      \"name\": \"Microsoft Outlook13\",\n      \"type\": \"n8n-nodes-base.microsoftOutlook\",\n      \"position\": [\n        2700,\n        188\n      ],\n      \"parameters\": {\n        \"messageId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $('varID & Category1').item.json.id }}\"\n        },\n        \"operation\": \"update\",\n        \"updateFields\": {\n          \"categories\": \"={{ \\n  [$('varJSON1').first().json.output.category, $('varJSON1').first().json.output.subCategory]\\n    .filter(item => item && item.trim() !== \\\"\\\")\\n    .map(item => item.charAt(0).toUpperCase() + item.slice(1))\\n}}\"\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"72cb54f3-4e4e-4ad2-8845-11a38fc29f1a\",\n      \"name\": \"Microsoft Outlook15\",\n      \"type\": \"n8n-nodes-base.microsoftOutlook\",\n      \"position\": [\n        3020,\n        188\n      ],\n      \"parameters\": {\n        \"folderId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"AQMkAGE3ZTU5MGMzLTFkNGItNGQ5Zi04MDQ1LThmNGFlMTVhYjMwYgAuAAAD8UhruVwm402lgPBG2Tj-aQEAnz-IOcWBGE2lrVuQgAF6zAADLJmrBwAAAA==\",\n          \"cachedResultUrl\": \"https://outlook.office365.com/mail/AQMkAGE3ZTU5MGMzLTFkNGItNGQ5Zi04MDQ1LThmNGFlMTVhYjMwYgAuAAAD8UhruVwm402lgPBG2Tj%2FaQEAnz%2FIOcWBGE2lrVuQgAF6zAADLJmrBwAAAA%3D%3D\",\n          \"cachedResultName\": \"Receipt\"\n        },\n        \"messageId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $('varID & Category1').item.json.id }}\"\n        },\n        \"operation\": \"move\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"e4446e84-c05e-4d04-b415-7608e39024ee\",\n      \"name\": \"Microsoft Outlook16\",\n      \"type\": \"n8n-nodes-base.microsoftOutlook\",\n      \"position\": [\n        2709,\n        504\n      ],\n      \"parameters\": {\n        \"messageId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $('varID & Category1').item.json.id }}\"\n        },\n        \"operation\": \"update\",\n        \"updateFields\": {\n          \"categories\": \"={{ \\n  [$('varJSON1').first().json.output.category, $('varJSON1').first().json.output.subCategory]\\n    .filter(item => item && item.trim() !== \\\"\\\")\\n    .map(item => item.charAt(0).toUpperCase() + item.slice(1))\\n}}\"\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"3ee05cfe-a528-472e-aa3d-c890fd88b6c4\",\n      \"name\": \"Microsoft Outlook17\",\n      \"type\": \"n8n-nodes-base.microsoftOutlook\",\n      \"position\": [\n        3020,\n        508\n      ],\n      \"parameters\": {\n        \"folderId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"AQMkAGE3ZTU5MGMzLTFkNGItNGQ5Zi04MDQ1LThmNGFlMTVhYjMwYgAuAAAD8UhruVwm402lgPBG2Tj-aQEAnz-IOcWBGE2lrVuQgAF6zAADLJmrCAAAAA==\",\n          \"cachedResultUrl\": \"https://outlook.office365.com/mail/AQMkAGE3ZTU5MGMzLTFkNGItNGQ5Zi04MDQ1LThmNGFlMTVhYjMwYgAuAAAD8UhruVwm402lgPBG2Tj%2FaQEAnz%2FIOcWBGE2lrVuQgAF6zAADLJmrCAAAAA%3D%3D\",\n          \"cachedResultName\": \"Community\"\n        },\n        \"messageId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $('varID & Category1').item.json.id }}\"\n        },\n        \"operation\": \"move\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"2fcecd9e-95cc-489a-b874-699c54518e44\",\n      \"name\": \"Microsoft Outlook18\",\n      \"type\": \"n8n-nodes-base.microsoftOutlook\",\n      \"position\": [\n        2709,\n        344\n      ],\n      \"parameters\": {\n        \"messageId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $('varID & Category1').item.json.id }}\"\n        },\n        \"operation\": \"update\",\n        \"updateFields\": {\n          \"categories\": \"={{ \\n  [$('varJSON1').first().json.output.category, $('varJSON1').first().json.output.subCategory]\\n    .filter(item => item && item.trim() !== \\\"\\\")\\n    .map(item => item.charAt(0).toUpperCase() + item.slice(1))\\n}}\"\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"41a39309-1a94-461f-9308-63dd5b9a94a7\",\n      \"name\": \"Microsoft Outlook19\",\n      \"type\": \"n8n-nodes-base.microsoftOutlook\",\n      \"position\": [\n        3020,\n        348\n      ],\n      \"parameters\": {\n        \"folderId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"AQMkAGE3ZTU5MGMzLTFkNGItNGQ5Zi04MDQ1LThmNGFlMTVhYjMwYgAuAAAD8UhruVwm402lgPBG2Tj-aQEAnz-IOcWBGE2lrVuQgAF6zAADLJmrCQAAAA==\",\n          \"cachedResultUrl\": \"https://outlook.office365.com/mail/AQMkAGE3ZTU5MGMzLTFkNGItNGQ5Zi04MDQ1LThmNGFlMTVhYjMwYgAuAAAD8UhruVwm402lgPBG2Tj%2FaQEAnz%2FIOcWBGE2lrVuQgAF6zAADLJmrCQAAAA%3D%3D\",\n          \"cachedResultName\": \"SaaS\"\n        },\n        \"messageId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $('varID & Category1').item.json.id }}\"\n        },\n        \"operation\": \"move\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"ebf606f9-099c-4218-b23b-66e2487262d0\",\n      \"name\": \"Markdown1\",\n      \"type\": \"n8n-nodes-base.markdown\",\n      \"notes\": \"Converts the body of the email to markdown\",\n      \"position\": [\n        420,\n        468\n      ],\n      \"parameters\": {\n        \"html\": \"={{ $('Loop Over Items1').item.json.body.content }}\",\n        \"options\": {}\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"ff447dd5-3ef6-4a02-8453-3489af8bf6b5\",\n      \"name\": \"varEmal1\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"notes\": \"Set email fields\",\n      \"position\": [\n        620,\n        468\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"edb304e1-3e9f-4a77-918c-25646addbc53\",\n              \"name\": \"subject\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.subject }}\"\n            },\n            {\n              \"id\": \"57a3ef3a-2701-40d9-882f-f43a7219f148\",\n              \"name\": \"importance\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.importance }}\"\n            },\n            {\n              \"id\": \"d8317f4f-aa0e-4196-89af-cb016765490a\",\n              \"name\": \"sender\",\n              \"type\": \"object\",\n              \"value\": \"={{ $json.sender.emailAddress }}\"\n            },\n            {\n              \"id\": \"908716c8-9ff7-4bdc-a1a3-64227559635e\",\n              \"name\": \"from\",\n              \"type\": \"object\",\n              \"value\": \"={{ $json.from.emailAddress }}\"\n            },\n            {\n              \"id\": \"ce007329-e221-4c5a-8130-2f8e9130160f\",\n              \"name\": \"body\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.data\\n    .replace(/<[^>]*>/g, '')                      // Remove HTML tags\\n    .replace(/\\\\[(.*?)\\\\]\\\\((.*?)\\\\)/g, '')            // Remove Markdown links like [text](link)\\n    .replace(/!\\\\[.*?\\\\]\\\\(.*?\\\\)/g, '')               // Remove Markdown images like ![alt](image-link)\\n    .replace(/\\\\|/g, '')                            // Remove table separators \\\"|\\\"\\n    .replace(/-{3,}/g, '')                         // Remove horizontal rule \\\"---\\\"\\n    .replace(/\\\\n+/g, ' ')                          // Remove multiple newlines\\n    .replace(/([^\\\\w\\\\s.,!?@])/g, '')                // Remove special characters except essential ones\\n    .replace(/\\\\s{2,}/g, ' ')                       // Replace multiple spaces with a single space\\n    .trim()                                        // Trim leading/trailing whitespace\\n}}\\n\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"198524cb-c9f0-4261-8c38-7c878efe7457\",\n      \"name\": \"Microsoft Outlook20\",\n      \"type\": \"n8n-nodes-base.microsoftOutlook\",\n      \"position\": [\n        2700,\n        668\n      ],\n      \"parameters\": {\n        \"messageId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $('varID & Category1').item.json.id }}\"\n        },\n        \"operation\": \"update\",\n        \"updateFields\": {\n          \"categories\": \"={{ \\n  [$('varJSON1').first().json.output.category, $('varJSON1').first().json.output.subCategory]\\n    .filter(item => item && item.trim() !== \\\"\\\")\\n    .map(item => item.charAt(0).toUpperCase() + item.slice(1))\\n}}\"\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"ec73629c-59ac-4f0e-a432-2c06934952ab\",\n      \"name\": \"Microsoft Outlook21\",\n      \"type\": \"n8n-nodes-base.microsoftOutlook\",\n      \"position\": [\n        2709,\n        1044\n      ],\n      \"parameters\": {\n        \"messageId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $('varID & Category1').item.json.id }}\"\n        },\n        \"operation\": \"update\",\n        \"updateFields\": {\n          \"categories\": \"={{ \\n  [$('varJSON1').first().json.output.category, $('varJSON1').first().json.output.subCategory]\\n    .filter(item => item && item.trim() !== \\\"\\\")\\n    .map(item => item.charAt(0).toUpperCase() + item.slice(1))\\n}}\"\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"0a19d15c-0cd3-4f26-9be2-4914522751fb\",\n      \"name\": \"Filter1\",\n      \"type\": \"n8n-nodes-base.filter\",\n      \"position\": [\n        -100,\n        448\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"c8cd6917-f94e-4fb7-8601-b8ed8f1aa8bf\",\n              \"operator\": {\n                \"type\": \"array\",\n                \"operation\": \"empty\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json.categories }}\",\n              \"rightValue\": \"\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"96e6e31c-6306-44a8-a57a-2b5216636b00\",\n      \"name\": \"If1\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"notes\": \"Checks if the email has been read\",\n      \"position\": [\n        3320,\n        668\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"f8cf2a56-cea8-4150-b7a0-048dbda20f2f\",\n              \"operator\": {\n                \"type\": \"boolean\",\n                \"operation\": \"true\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json.isRead }}\",\n              \"rightValue\": \"\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"8a6e0118-abe3-45e2-aefc-94640348b2ec\",\n      \"name\": \"Microsoft Outlook22\",\n      \"type\": \"n8n-nodes-base.microsoftOutlook\",\n      \"position\": [\n        2709,\n        864\n      ],\n      \"parameters\": {\n        \"messageId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $('varID & Category1').item.json.id }}\"\n        },\n        \"operation\": \"update\",\n        \"updateFields\": {\n          \"categories\": \"={{ \\n  [$('varJSON1').first().json.output.category, $('varJSON1').first().json.output.subCategory]\\n    .filter(item => item && item.trim() !== \\\"\\\")\\n    .map(item => item.charAt(0).toUpperCase() + item.slice(1))\\n}}\"\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"e2d8e7b5-4447-4327-9f4e-b8d52765667e\",\n      \"name\": \"Catch Errors1\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1760,\n        608\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"0dc6d439-60fb-49f6-b4d5-f5cce6f030ad\",\n              \"name\": \"error\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"17f6ac43-51e4-4bee-b0d8-13deb3bf3cc9\",\n      \"name\": \"varJSON1\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"onError\": \"continueErrorOutput\",\n      \"position\": [\n        1540,\n        468\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"ignoreConversionErrors\": true\n        },\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"0c52f57f-74eb-4385-ac6b-f3e5f4f50e73\",\n              \"name\": \"output\",\n              \"type\": \"object\",\n              \"value\": \"={{ $json.output.replace(/^.*?({.*}).*$/s, '$1') }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"82dd9631-a34b-4d54-be28-6f8dcc3548f0\",\n      \"name\": \"Sticky Note10\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -360,\n        220\n      ],\n      \"parameters\": {\n        \"width\": 411.91693012378937,\n        \"height\": 401.49417117683515,\n        \"content\": \"## å¸¦ç­›é€‰æ¡ä»¶çš„ä¸šåŠ¡å±•æœ›\\nç­›é€‰æ¡ä»¶ï¼š\\n```\\næ ‡è®°/æ ‡è®°çŠ¶æ€ç­‰äºŽ'æœªæ ‡è®°' ä¸” ä¸å­˜åœ¨ä»»ä½•åˆ†ç±»\\n```\\n\\nè¿™äº›ç­›é€‰æ¡ä»¶ç¡®ä¿æˆ‘ä»¬ä¸ä¼šå¤„ç†å·²æ ‡è®°çš„é‚®ä»¶æˆ–å·²è®¾ç½®åˆ†ç±»çš„é‚®ä»¶ã€‚\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"0583e196-37a5-43db-8c0a-aa624029c926\",\n      \"name\": \"Microsoft Outlook23\",\n      \"type\": \"n8n-nodes-base.microsoftOutlook\",\n      \"position\": [\n        -300,\n        448\n      ],\n      \"parameters\": {\n        \"limit\": 1,\n        \"fields\": [\n          \"flag\",\n          \"from\",\n          \"importance\",\n          \"replyTo\",\n          \"sender\",\n          \"subject\",\n          \"toRecipients\",\n          \"body\",\n          \"categories\",\n          \"isRead\"\n        ],\n        \"output\": \"fields\",\n        \"options\": {},\n        \"filtersUI\": {\n          \"values\": {\n            \"filters\": {\n              \"custom\": \"flag/flagStatus eq 'notFlagged' and not categories/any()\",\n              \"foldersToInclude\": [\n                \"AQMkAGE3ZTU5MGMzLTFkNGItNGQ5Zi04MDQ1LThmNGFlMTVhYjMwYgAuAAAD8UhruVwm402lgPBG2Tj-aQEAnz-IOcWBGE2lrVuQgAF6zAAAAgEMAAAA\"\n              ]\n            }\n          }\n        },\n        \"operation\": \"getAll\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"a9540e6b-929b-4460-8972-93e4d19cd934\",\n      \"name\": \"varID & Category1\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        900,\n        468\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"de2ad4f2-7381-4715-a3f4-59611e161b74\",\n              \"name\": \"id\",\n              \"type\": \"string\",\n              \"value\": \"={{ $('Microsoft Outlook23').item.json.id }}\"\n            },\n            {\n              \"id\": \"458c7a89-e4a3-46d0-8b38-72d87748e306\",\n              \"name\": \"category\",\n              \"type\": \"string\",\n              \"value\": \"\\\"action\\\", \\\"junk\\\", \\\"receipt\\\", \\\"SaaS\\\", \\\"community\\\", \\\"business\\\" or \\\"other\\\"\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"e6b3b41e-d7d3-4c9b-8189-a005c748ff18\",\n      \"name\": \"Sticky Note11\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        360,\n        348\n      ],\n      \"parameters\": {\n        \"color\": 6,\n        \"width\": 418.7820408163265,\n        \"height\": 301.40952380952365,\n        \"content\": \"## é‚®ä»¶å‡€åŒ–\\nç§»é™¤HTMLå’Œæ— ç”¨ä¿¡æ¯ï¼Œä¸ºAIä»£ç†å¤„ç†åšå‡†å¤‡\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"f9787a75-526c-4ef1-b0a7-0db7d890ab3f\",\n      \"name\": \"Sticky Note12\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        820,\n        348\n      ],\n      \"parameters\": {\n        \"color\": 6,\n        \"width\": 256.16108843537415,\n        \"height\": 298.37931972789124,\n        \"content\": \"## ä¿®æ”¹åˆ†ç±»  \\nç¼–è¾‘æ­¤å¤„ä»¥è‡ªå®šä¹‰åˆ†ç±»é€‰æ‹©\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"50223a01-34cf-4191-9dd7-3dac02a9e945\",\n      \"name\": \"Sticky Note13\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1480,\n        328\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 441.003537414966,\n        \"height\": 463.0204081632651,\n        \"content\": \"## è½¬æ¢ä¸ºJSON\\n* ç¡®ä¿ä»£ç†è¾“å‡ºè¢«è½¬æ¢ä¸ºJSONæ ¼å¼\\n* æ•èŽ·ä»»ä½•é”™è¯¯å¹¶ç»§ç»­å¤„ç†\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"4580c532-96a6-46b4-8922-d79316d1cc01\",\n      \"name\": \"Sticky Note14\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        2120,\n        328\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 311.71482993197264,\n        \"height\": 454.93986394557805,\n        \"content\": \"## åˆ‡æ¢ç±»åˆ«\\nç¡®ä¿æ‚¨çš„ç±»åˆ«ä¸Ž **å˜é‡IDå’Œç±»åˆ«** ç¼–è¾‘å­—æ®µèŠ‚ç‚¹ç›¸åŒ¹é…\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"b51a7c34-2a5e-4670-81a4-d1582711c69a\",\n      \"name\": \"Sticky Note15\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        2629,\n        -76\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 251.3480889735252,\n        \"height\": 1289.0156245602684,\n        \"content\": \"## è®¾ç½®åˆ†ç±»\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"3a7ede7b-539b-49d2-8803-153ca6c9eb69\",\n      \"name\": \"Sticky Note16\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        2949,\n        -76\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 251.3480889735252,\n        \"height\": 770.995811762121,\n        \"content\": \"## ç§»è‡³æ–‡ä»¶å¤¹\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"ee9a9d78-8c07-470a-9d1b-ceddfc8875ca\",\n      \"name\": \"Sticky Note17\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        3260,\n        553\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"height\": 293.65527013262994,\n        \"content\": \"## æ£€æŸ¥é‚®ä»¶æ˜¯å¦å·²è¯»\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"c75b9d38-79a7-4be2-a90b-a99da1bbd745\",\n      \"name\": \"Microsoft Outlook Move Message1\",\n      \"type\": \"n8n-nodes-base.microsoftOutlook\",\n      \"position\": [\n        3609,\n        604\n      ],\n      \"parameters\": {\n        \"folderId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"AQMkAGE3ZTU5MGMzLTFkNGItNGQ5Zi04MDQ1LThmNGFlMTVhYjMwYgAuAAAD8UhruVwm402lgPBG2Tj-aQEAnz-IOcWBGE2lrVuQgAF6zAADLJmrCwAAAA==\",\n          \"cachedResultUrl\": \"https://outlook.office365.com/mail/AQMkAGE3ZTU5MGMzLTFkNGItNGQ5Zi04MDQ1LThmNGFlMTVhYjMwYgAuAAAD8UhruVwm402lgPBG2Tj%2FaQEAnz%2FIOcWBGE2lrVuQgAF6zAADLJmrCwAAAA%3D%3D\",\n          \"cachedResultName\": \"Actioned\"\n        },\n        \"messageId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $('varID & Category1').item.json.id }}\"\n        },\n        \"operation\": \"move\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"85ff0348-16dc-46e6-bf70-48a10fe0ded8\",\n      \"name\": \"AI Agent1\",\n      \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n      \"position\": [\n        1160,\n        468\n      ],\n      \"parameters\": {\n        \"text\": \"=Categorise the following email\\n<email>\\n{{ $('varEmal1').first().json.toJsonString() }}\\n</email>\\n\\nEnsure your final output is valid JSON with no additional text or token in the following format:\\n\\n{\\n  \\\"subject\\\": \\\"SUBJECT_LINE\\\",1\\n  \\\"category\\\": \\\"CATEGORY\\\",\\n  \\\"subCategory\\\": \\\"SUBCATEGORY\\\", //use sparingly\\n  \\\"analysis\\\": \\\"ANALYSIS_REASONING\\\"\\n}\\n\\nRemember you can only use ONE of the following categories {{ $json.category }}. No other categories can be used. Use the subcategory for additional context, for example, if a SaaS email requires action, or if a business email requires action. Do not create any additional subcategories, you can only use ONE of the following {{ $json.category }}.\",\n        \"options\": {\n          \"systemMessage\": \"=You're an AI assistant for a freelance developer, categorizing emails as {{ $json.category }}. Email info is in <email> tags.\\n\\nCategorization priority:\\n\\nAction: Needs response or action (includes some SaaS emails), avoid sales email but include enquires.\\nJunk: Ads, sales, newsletters, promotions, daily digests, (emojis often indicate junk), phishing, scams, discounts etc.\\nReceipt: Any purchase confirmation.\\nSaaS: Account/security updates, unless action required, generic SaaS information, usually from a non-personal email address.\\nCommunity: Updates, events, forums, everything related to \\\"community\\\".\\nBusiness: Any communication related to freelance work, usually from a humans email address\\nOther: Doesn't fit into any other category.\\n\\nKey points:\\n\\nSaaS emails needing action are \\\"SaaS\\\" and subcategory \\\"action\\\".\\nAnalyze the subject, body, email addresses and other data.\\nLook for specific keywords and phrases for each category.\\nEmail can have 2 categories, primary and sub, for example, \\\"action\\\" and \\\"SaaS\\\" or \\\"action\\\" and \\\"business\\\".\\nEmails from business development executives are often junk.\\n\\n\\nOutput in valid JSON format:\\n{\\n\\\"subject\\\": \\\"SUBJECT_LINE\\\",\\n\\\"category\\\": \\\"PRIMARY CATEGORY\\\",\\n\\\"subCategory\\\": \\\"SUBCATEGORY\\\", //use sparingly\\n\\\"analysis\\\": \\\"Brief 1-2 sentence explanation of category choice\\\"\\n}\\nNo additional text or tokens outside the JSON.\\n\\nYou may only use the following categories and subcategories, do not create any more categories or subcategories: {{ $json.category }}\"\n        },\n        \"promptType\": \"define\",\n        \"hasOutputParser\": true\n      },\n      \"typeVersion\": 1.6\n    },\n    {\n      \"id\": \"93e7be79-9035-4b58-9a83-b9182a0515f8\",\n      \"name\": \"Merge1\",\n      \"type\": \"n8n-nodes-base.merge\",\n      \"position\": [\n        3989,\n        564\n      ],\n      \"parameters\": {\n        \"numberInputs\": 7\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"cbaeaed1-cb09-4614-93f1-3fe349cd0e4e\",\n      \"name\": \"Switch1\",\n      \"type\": \"n8n-nodes-base.switch\",\n      \"position\": [\n        2220,\n        488\n      ],\n      \"parameters\": {\n        \"rules\": {\n          \"values\": [\n            {\n              \"outputKey\": \"junk\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": false,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"operator\": {\n                      \"type\": \"string\",\n                      \"operation\": \"equals\"\n                    },\n                    \"leftValue\": \"={{ $json.output.category }}\",\n                    \"rightValue\": \"junk\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            },\n            {\n              \"outputKey\": \"receipt\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": false,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"0c61c7a8-e8b4-49c5-a96c-402d5eae7089\",\n                    \"operator\": {\n                      \"name\": \"filter.operator.equals\",\n                      \"type\": \"string\",\n                      \"operation\": \"equals\"\n                    },\n                    \"leftValue\": \"={{ $json.output.category }}\",\n                    \"rightValue\": \"receipt\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            },\n            {\n              \"outputKey\": \"SaaS\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": false,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"703f65c8-cf4a-47fe-ad1a-a5f6e0412ae7\",\n                    \"operator\": {\n                      \"name\": \"filter.operator.equals\",\n                      \"type\": \"string\",\n                      \"operation\": \"equals\"\n                    },\n                    \"leftValue\": \"={{ $json.output.category }}\",\n                    \"rightValue\": \"SaaS\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            },\n            {\n              \"outputKey\": \"community\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": false,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"b074d5cd-9215-40df-8877-5df904edc000\",\n                    \"operator\": {\n                      \"name\": \"filter.operator.equals\",\n                      \"type\": \"string\",\n                      \"operation\": \"equals\"\n                    },\n                    \"leftValue\": \"={{ $json.output.category }}\",\n                    \"rightValue\": \"community\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            },\n            {\n              \"outputKey\": \"action\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": false,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"bece338a-e0c5-43b5-b8cc-41229a374213\",\n                    \"operator\": {\n                      \"name\": \"filter.operator.equals\",\n                      \"type\": \"string\",\n                      \"operation\": \"equals\"\n                    },\n                    \"leftValue\": \"={{ $json.output.category }}\",\n                    \"rightValue\": \"action\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            },\n            {\n              \"outputKey\": \"business\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": false,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"d6c9751f-0ffa-4041-a579-6957bb9c9296\",\n                    \"operator\": {\n                      \"name\": \"filter.operator.equals\",\n                      \"type\": \"string\",\n                      \"operation\": \"equals\"\n                    },\n                    \"leftValue\": \"={{ $json.output.category }}\",\n                    \"rightValue\": \"business\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            }\n          ]\n        },\n        \"options\": {\n          \"ignoreCase\": true,\n          \"fallbackOutput\": \"extra\"\n        }\n      },\n      \"typeVersion\": 3.2\n    }\n  ],\n  \"pinData\": {},\n  \"connections\": {\n    \"If1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Microsoft Outlook Move Message1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Merge1\",\n            \"type\": \"main\",\n            \"index\": 5\n          }\n        ]\n      ]\n    },\n    \"Merge1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Loop Over Items1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Filter1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Loop Over Items1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Switch1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Microsoft Outlook12\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Microsoft Outlook13\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Microsoft Outlook18\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Microsoft Outlook16\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Microsoft Outlook20\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Microsoft Outlook22\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Microsoft Outlook21\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"varEmal1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"varID & Category1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"varJSON1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Switch1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Catch Errors1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"AI Agent1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"varJSON1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Markdown1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"varEmal1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Catch Errors1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Loop Over Items1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Loop Over Items1\": {\n      \"main\": [\n        null,\n        [\n          {\n            \"node\": \"Markdown1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"varID & Category1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"AI Agent1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Ollama Chat Model1\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"AI Agent1\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Microsoft Outlook10\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Microsoft Outlook12\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Microsoft Outlook10\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Microsoft Outlook13\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Microsoft Outlook15\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Microsoft Outlook15\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge1\",\n            \"type\": \"main\",\n            \"index\": 1\n          }\n        ]\n      ]\n    },\n    \"Microsoft Outlook16\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Microsoft Outlook17\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Microsoft Outlook17\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge1\",\n            \"type\": \"main\",\n            \"index\": 3\n          }\n        ]\n      ]\n    },\n    \"Microsoft Outlook18\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Microsoft Outlook19\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Microsoft Outlook19\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge1\",\n            \"type\": \"main\",\n            \"index\": 2\n          }\n        ]\n      ]\n    },\n    \"Microsoft Outlook20\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"If1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Microsoft Outlook21\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge1\",\n            \"type\": \"main\",\n            \"index\": 6\n          }\n        ]\n      ]\n    },\n    \"Microsoft Outlook22\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"If1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Microsoft Outlook23\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Filter1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Microsoft Outlook Move Message1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge1\",\n            \"type\": \"main\",\n            \"index\": 4\n          }\n        ]\n      ]\n    },\n    \"When clicking â€˜Test workflowâ€™\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Microsoft Outlook23\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}