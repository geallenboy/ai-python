{
  "title": "v1 helper - Find params with affected expressions",
  "url": "https://n8n.io/workflows/1929-v1-helper-find-params-with-affected-expressions/",
  "category": "Other",
  "category_url": "https://n8n.io/workflows/categories/other/?sort=createdAt:desc",
  "author": "n8n Team",
  "publish_date": "Last update 10 months ago",
  "publish_date_absolute": "2024-07-23",
  "content": "",
  "workflow_json": "{\"id\":\"zlHbtHIcCZ9enKwg\",\"meta\":{\"instanceId\":\"406f1bca875c48c0fa12bf65a32e67f001617a6df6d6fd6dd72bff9d20014812\"},\"name\":\"v1 helper - Find params with affected expressions\",\"tags\":[],\"nodes\":[{\"id\":\"b3dd44ca-960f-4689-9545-30a05dc0441e\",\"name\":\"When clicking \\\"Execute Workflow\\\"\",\"type\":\"n8n-nodes-base.manualTrigger\",\"position\":[580,320],\"parameters\":{},\"typeVersion\":1},{\"id\":\"96db239d-05b6-4e1d-b101-e66c2a9708f6\",\"name\":\"n8n\",\"type\":\"n8n-nodes-base.n8n\",\"position\":[800,320],\"parameters\":{\"filters\":{\"activeWorkflows\":true}},\"credentials\":{\"n8nApi\":{\"id\":\"hcJ2iZYYgs54eCaT\",\"name\":\"n8n account\"}},\"typeVersion\":1},{\"id\":\"b2286f6b-ba37-433c-b22a-95032bc25b6e\",\"name\":\"Find params with affected expressions\",\"type\":\"n8n-nodes-base.code\",\"position\":[1040,320],\"parameters\":{\"jsCode\":\"const AFFECTED_EXTENSIONS = ['beginningOf', 'endOfMonth', 'minus', 'plus'];\\n\\nconst isExpression = (value) => typeof value === 'string' && value.startsWith('={{');\\n\\nconst containsAny = (str, substrings) => {\\n  for (const substring of substrings) {\\n    if (str.includes(substring)) return true;\\n  }\\n  \\n  return false;\\n}\\n\\nconst isAffected = (value) => isExpression(value) && containsAny(value, AFFECTED_EXTENSIONS);\\n\\nfunction findParamsByTest(target, test) {\\n  const parameterNames = [];\\n\\n  function search(obj) {\\n    if (typeof obj === 'object') {\\n      for (const key in obj) {\\n        const value = obj[key];\\n\\n        if (test(value)) {\\n          parameterNames.push(key);\\n        } else if (typeof value === 'object') {\\n          search(value);\\n        }\\n      }\\n    }\\n  }\\n\\n  search(target);\\n\\n  return parameterNames;\\n}\\n\\nreturn $input.all().reduce((allLocations, { json: workflow }) => {\\n  const perWorkflow = workflow.nodes.reduce((allLocationsPerWorkflow, node) => {\\n    const perNode = findParamsByTest(node.parameters, isAffected).map(\\n      (parameterName) => {\\n\\t\\treturn {\\n\\t\\t\\tworkflowName: workflow.name,\\n\\t\\t\\tnodeName: node.name,\\n\\t\\t\\tparameterName,\\n        };\\n      },\\n    );\\n\\n    return [...allLocationsPerWorkflow, ...perNode];\\n  }, []);\\n\\n  return [...allLocations, ...perWorkflow];\\n}, []);\"},\"typeVersion\":1},{\"id\":\"ee189fa0-cf89-4b8d-8351-ed9598f18502\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[600,92],\"parameters\":{\"width\":548.6551724137931,\"height\":191.08045977011497,\"content\":\"## v1 Helper\\n\\nℹ️ This workflow is to be run **after upgrading to n8n v1**.\\n\\nThis workflow returns all locations where a node in an active workflow contains a parameter using an **expression extension affected by [v1 changes](https://github.com/n8n-io/n8n/pull/6435)**. For every location, please check that the workflow still behaves as intended.\"},\"typeVersion\":1}],\"active\":false,\"pinData\":{},\"settings\":{},\"versionId\":\"da694734-30ae-46b1-8e29-877c95b670ab\",\"connections\":{\"n8n\":{\"main\":[[{\"node\":\"Find params with affected expressions\",\"type\":\"main\",\"index\":0}]]},\"When clicking \\\"Execute Workflow\\\"\":{\"main\":[[{\"node\":\"n8n\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "## v1 Helper\n\nℹ️ This workflow is to be run **after upgrading to n8n v1**.\n\nThis workflow returns all locations where a node in an active workflow contains a parameter using an **expression extension affected by[v1 changes](https://github.com/n8n-io/n8n/pull/6435)**.\n\nFor every location, please check that the workflow still behaves as intended.\n",
  "readme_html": "<!--[--><div data-v-50766329=\"\"><h2>v1 Helper</h2>\n<p>ℹ️ This workflow is to be run <strong>after upgrading to n8n v1</strong>.</p>\n<p>This workflow returns all locations where a node in an active workflow contains a parameter using an <strong>expression extension affected by <a href=\"https://github.com/n8n-io/n8n/pull/6435\" rel=\"ugc nofollow\" target=\"_blank\">v1 changes</a></strong>.</p>\n<p>For every location, please check that the workflow still behaves as intended.</p>\n</div><!--]-->",
  "readme_zh": "## v1 辅助工具\n\nℹ️ 此工作流需在**升级至n8n v1版本后**运行。\n\n本工作流将返回所有活跃工作流中节点参数使用**受[v1版本变更影响](https://github.com/n8n-io/n8n/pull/6435)的表达式扩展**的具体位置。\n\n请逐一检查每个标识位置，确保工作流仍按预期运行。",
  "title_zh": "v1 辅助工具 - 查找受影响的表达式参数",
  "publish_date_zh": "最后更新于10个月前",
  "workflow_json_zh": "{\n  \"id\": \"zlHbtHIcCZ9enKwg\",\n  \"meta\": {\n    \"instanceId\": \"406f1bca875c48c0fa12bf65a32e67f001617a6df6d6fd6dd72bff9d20014812\"\n  },\n  \"name\": \"v1 helper - Find params with affected expressions\",\n  \"tags\": [],\n  \"nodes\": [\n    {\n      \"id\": \"b3dd44ca-960f-4689-9545-30a05dc0441e\",\n      \"name\": \"When clicking \\\"Execute Workflow\\\"\",\n      \"type\": \"n8n-nodes-base.manualTrigger\",\n      \"position\": [\n        580,\n        320\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"96db239d-05b6-4e1d-b101-e66c2a9708f6\",\n      \"name\": \"n8n\",\n      \"type\": \"n8n-nodes-base.n8n\",\n      \"position\": [\n        800,\n        320\n      ],\n      \"parameters\": {\n        \"filters\": {\n          \"activeWorkflows\": true\n        }\n      },\n      \"credentials\": {\n        \"n8nApi\": {\n          \"id\": \"hcJ2iZYYgs54eCaT\",\n          \"name\": \"n8n account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"b2286f6b-ba37-433c-b22a-95032bc25b6e\",\n      \"name\": \"Find params with affected expressions\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        1040,\n        320\n      ],\n      \"parameters\": {\n        \"jsCode\": \"const AFFECTED_EXTENSIONS = ['beginningOf', 'endOfMonth', 'minus', 'plus'];\\n\\nconst isExpression = (value) => typeof value === 'string' && value.startsWith('={{');\\n\\nconst containsAny = (str, substrings) => {\\n  for (const substring of substrings) {\\n    if (str.includes(substring)) return true;\\n  }\\n  \\n  return false;\\n}\\n\\nconst isAffected = (value) => isExpression(value) && containsAny(value, AFFECTED_EXTENSIONS);\\n\\nfunction findParamsByTest(target, test) {\\n  const parameterNames = [];\\n\\n  function search(obj) {\\n    if (typeof obj === 'object') {\\n      for (const key in obj) {\\n        const value = obj[key];\\n\\n        if (test(value)) {\\n          parameterNames.push(key);\\n        } else if (typeof value === 'object') {\\n          search(value);\\n        }\\n      }\\n    }\\n  }\\n\\n  search(target);\\n\\n  return parameterNames;\\n}\\n\\nreturn $input.all().reduce((allLocations, { json: workflow }) => {\\n  const perWorkflow = workflow.nodes.reduce((allLocationsPerWorkflow, node) => {\\n    const perNode = findParamsByTest(node.parameters, isAffected).map(\\n      (parameterName) => {\\n\\t\\treturn {\\n\\t\\t\\tworkflowName: workflow.name,\\n\\t\\t\\tnodeName: node.name,\\n\\t\\t\\tparameterName,\\n        };\\n      },\\n    );\\n\\n    return [...allLocationsPerWorkflow, ...perNode];\\n  }, []);\\n\\n  return [...allLocations, ...perWorkflow];\\n}, []);\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"ee189fa0-cf89-4b8d-8351-ed9598f18502\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        600,\n        92\n      ],\n      \"parameters\": {\n        \"width\": 548.6551724137931,\n        \"height\": 191.08045977011497,\n        \"content\": \"## v1 辅助工具\\n\\nℹ️ 该工作流需在**升级至n8n v1版本后**运行。\\n\\n本工作流将返回所有活跃工作流中节点参数使用**受[v1版本变更](https://github.com/n8n-io/n8n/pull/6435)影响的表达式扩展**的具体位置。请逐一检查每个位置，确保工作流仍按预期运行。\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"active\": false,\n  \"pinData\": {},\n  \"settings\": {},\n  \"versionId\": \"da694734-30ae-46b1-8e29-877c95b670ab\",\n  \"connections\": {\n    \"n8n\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Find params with affected expressions\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"When clicking \\\"Execute Workflow\\\"\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"n8n\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}