{
  "title": "Extract expenses from emails and add to Google Sheets",
  "url": "https://n8n.io/workflows/1466-extract-expenses-from-emails-and-add-to-google-sheets/",
  "category": "BuildingBlocks",
  "category_url": "https://n8n.io/workflows/categories/building-blocks/?sort=createdAt:desc",
  "author": "Jonathan",
  "publish_date": "Last update 10 months ago",
  "publish_date_absolute": "2024-07-07",
  "content": "",
  "workflow_json": "{\"id\":90,\"name\":\"Extract expenses from emails and add to Google Sheet\",\"nodes\":[{\"name\":\"Check subject\",\"type\":\"n8n-nodes-base.if\",\"position\":[800,300],\"parameters\":{\"conditions\":{\"string\":[{\"value1\":\"={{$json[\\\"subject\\\"].toLowerCase()}}\",\"value2\":\"=/{{$json[\\\"subjectPatterns\\\"].toLowerCase()}}/\",\"operation\":\"regex\"}]},\"combineOperation\":\"any\"},\"typeVersion\":1},{\"name\":\"Setup Variables\",\"type\":\"n8n-nodes-base.set\",\"position\":[620,300],\"parameters\":{\"values\":{\"string\":[{\"name\":\"subjectPatterns\",\"value\":\"(expenses|reciept)\"}]},\"options\":{}},\"typeVersion\":1},{\"name\":\"Check for new emails\",\"type\":\"n8n-nodes-base.emailReadImap\",\"position\":[440,300],\"parameters\":{\"format\":\"resolved\",\"mailbox\":\"Inbox\",\"options\":{\"allowUnauthorizedCerts\":true}},\"credentials\":{\"imap\":{\"id\":\"24\",\"name\":\"GMAIL\"}},\"typeVersion\":1},{\"name\":\"Read Receipts\",\"type\":\"n8n-nodes-base.mindee\",\"position\":[1020,280],\"parameters\":{\"binaryPropertyName\":\"attachment_0\"},\"credentials\":{\"mindeeReceiptApi\":{\"id\":\"61\",\"name\":\"Mindee Receipt account\"}},\"typeVersion\":1},{\"name\":\"Set column data\",\"type\":\"n8n-nodes-base.set\",\"position\":[1200,280],\"parameters\":{\"values\":{\"string\":[{\"name\":\"Date\",\"value\":\"={{$json[\\\"date\\\"]}}\"},{\"name\":\"Description\",\"value\":\"={{$node[\\\"Check for new emails\\\"].json[\\\"subject\\\"].split(\\\"-\\\")[1]}}\"},{\"name\":\"Category\",\"value\":\"={{$json[\\\"category\\\"]}}\"},{\"name\":\"Currency\",\"value\":\"={{$json[\\\"currency\\\"]}}\"},{\"name\":\"Amount\",\"value\":\"={{$json[\\\"total\\\"]}}\"}]},\"options\":{}},\"typeVersion\":1},{\"name\":\"Add to Google Sheet\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[1380,280],\"parameters\":{\"range\":\"A:E\",\"options\":{},\"sheetId\":\"1xAtx1ORZYKu4urgqpOe3DawFjiWeOZO0VCVvOlQYnaE\",\"operation\":\"append\",\"authentication\":\"oAuth2\"},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"8\",\"name\":\"Sheets\"}},\"typeVersion\":1}],\"active\":false,\"settings\":{},\"connections\":{\"Check subject\":{\"main\":[[{\"node\":\"Read Receipts\",\"type\":\"main\",\"index\":0}]]},\"Read Receipts\":{\"main\":[[{\"node\":\"Set column data\",\"type\":\"main\",\"index\":0}]]},\"Set column data\":{\"main\":[[{\"node\":\"Add to Google Sheet\",\"type\":\"main\",\"index\":0}]]},\"Setup Variables\":{\"main\":[[{\"node\":\"Check subject\",\"type\":\"main\",\"index\":0}]]},\"Check for new emails\":{\"main\":[[{\"node\":\"Setup Variables\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "This workflow will check a mailbox for new emails and if the Subject contains Expenses or Reciept it will send the attachment to Mindee for processing then it will update a Google sheet with the values.\n\nTo use this node you will need to set the Email Read node to use your mailboxes credentials and configure the Mindee and Google Sheets nodes to use your credentials.\n",
  "readme_html": "<!--[--><div data-v-50766329=\"\"><p>This workflow will check a mailbox for new emails and if the Subject contains Expenses or Reciept it will send the attachment to Mindee for processing then it will update a Google sheet with the values.</p>\n<p>To use this node you will need to set the Email Read node to use your mailboxes credentials and configure the Mindee and Google Sheets nodes to use your credentials.</p>\n</div><!--]-->",
  "readme_zh": "该工作流程将检查邮箱中的新邮件，若邮件主题包含\"Expenses\"或\"Reciept\"，则会将附件发送至Mindee进行处理，随后将处理结果更新至Google表格中。\n\n使用此节点前，需配置以下内容：\n1. 在\"Email Read\"节点设置您的邮箱登录凭证\n2. 在Mindee和Google Sheets节点配置相应的身份验证信息\n\n（注：根据技术文档翻译规范，保留关键节点名称\"Mindee/Google Sheets\"等专有名词不译，采用斜体或引号标注的术语保持原格式）",
  "title_zh": "从邮件中提取费用并添加到Google表格",
  "publish_date_zh": "最后更新于10个月前",
  "workflow_json_zh": "{\"id\":90,\"name\":\"Extract expenses from emails and add to Google Sheet\",\"nodes\":[{\"name\":\"Check subject\",\"type\":\"n8n-nodes-base.if\",\"position\":[800,300],\"parameters\":{\"conditions\":{\"string\":[{\"value1\":\"={{$json[\\\"subject\\\"].toLowerCase()}}\",\"value2\":\"=/{{$json[\\\"subjectPatterns\\\"].toLowerCase()}}/\",\"operation\":\"regex\"}]},\"combineOperation\":\"any\"},\"typeVersion\":1},{\"name\":\"Setup Variables\",\"type\":\"n8n-nodes-base.set\",\"position\":[620,300],\"parameters\":{\"values\":{\"string\":[{\"name\":\"subjectPatterns\",\"value\":\"(expenses|reciept)\"}]},\"options\":{}},\"typeVersion\":1},{\"name\":\"Check for new emails\",\"type\":\"n8n-nodes-base.emailReadImap\",\"position\":[440,300],\"parameters\":{\"format\":\"resolved\",\"mailbox\":\"Inbox\",\"options\":{\"allowUnauthorizedCerts\":true}},\"credentials\":{\"imap\":{\"id\":\"24\",\"name\":\"GMAIL\"}},\"typeVersion\":1},{\"name\":\"Read Receipts\",\"type\":\"n8n-nodes-base.mindee\",\"position\":[1020,280],\"parameters\":{\"binaryPropertyName\":\"attachment_0\"},\"credentials\":{\"mindeeReceiptApi\":{\"id\":\"61\",\"name\":\"Mindee Receipt account\"}},\"typeVersion\":1},{\"name\":\"Set column data\",\"type\":\"n8n-nodes-base.set\",\"position\":[1200,280],\"parameters\":{\"values\":{\"string\":[{\"name\":\"Date\",\"value\":\"={{$json[\\\"date\\\"]}}\"},{\"name\":\"Description\",\"value\":\"={{$node[\\\"Check for new emails\\\"].json[\\\"subject\\\"].split(\\\"-\\\")[1]}}\"},{\"name\":\"Category\",\"value\":\"={{$json[\\\"category\\\"]}}\"},{\"name\":\"Currency\",\"value\":\"={{$json[\\\"currency\\\"]}}\"},{\"name\":\"Amount\",\"value\":\"={{$json[\\\"total\\\"]}}\"}]},\"options\":{}},\"typeVersion\":1},{\"name\":\"Add to Google Sheet\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[1380,280],\"parameters\":{\"range\":\"A:E\",\"options\":{},\"sheetId\":\"1xAtx1ORZYKu4urgqpOe3DawFjiWeOZO0VCVvOlQYnaE\",\"operation\":\"append\",\"authentication\":\"oAuth2\"},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"8\",\"name\":\"Sheets\"}},\"typeVersion\":1}],\"active\":false,\"settings\":{},\"connections\":{\"Check subject\":{\"main\":[[{\"node\":\"Read Receipts\",\"type\":\"main\",\"index\":0}]]},\"Read Receipts\":{\"main\":[[{\"node\":\"Set column data\",\"type\":\"main\",\"index\":0}]]},\"Set column data\":{\"main\":[[{\"node\":\"Add to Google Sheet\",\"type\":\"main\",\"index\":0}]]},\"Setup Variables\":{\"main\":[[{\"node\":\"Check subject\",\"type\":\"main\",\"index\":0}]]},\"Check for new emails\":{\"main\":[[{\"node\":\"Setup Variables\",\"type\":\"main\",\"index\":0}]]}}}"
}