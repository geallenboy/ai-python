{
  "title": "Send a message to Telegram on a new item saved to Reader",
  "url": "https://n8n.io/workflows/1416-send-a-message-to-telegram-on-a-new-item-saved-to-reader/",
  "category": "BuildingBlocks",
  "category_url": "https://n8n.io/workflows/categories/building-blocks/?sort=createdAt:desc",
  "author": "Nicolas",
  "publish_date": "Last update 10 months ago",
  "publish_date_absolute": "2024-07-07",
  "content": "",
  "workflow_json": "{\"nodes\":[{\"name\":\"On clicking 'execute'\",\"type\":\"n8n-nodes-base.manualTrigger\",\"position\":[340,380],\"parameters\":{},\"typeVersion\":1},{\"name\":\"Write Binary File\",\"type\":\"n8n-nodes-base.writeBinaryFile\",\"position\":[1680,280],\"parameters\":{\"fileName\":\"={{$node[\\\"Config\\\"].parameter[\\\"values\\\"][\\\"string\\\"][0][\\\"value\\\"]}}\"},\"typeVersion\":1},{\"name\":\"Read Binary File\",\"type\":\"n8n-nodes-base.readBinaryFile\",\"position\":[580,460],\"parameters\":{\"filePath\":\"={{$node[\\\"Config\\\"].parameter[\\\"values\\\"][\\\"string\\\"][0][\\\"value\\\"]}}\"},\"typeVersion\":1,\"continueOnFail\":true,\"alwaysOutputData\":true},{\"name\":\"HTTP Request\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[1020,460],\"parameters\":{\"url\":\"https://readwise.io/reader/api/state/\",\"options\":{},\"authentication\":\"headerAuth\",\"queryParametersUi\":{\"parameter\":[{\"name\":\"schemaVersion\",\"value\":\"5\"},{\"name\":\"filter[updated_at][gt]\",\"value\":\"={{$json[\\\"last_synced\\\"]}}\"}]},\"headerParametersUi\":{\"parameter\":[]}},\"credentials\":{\"httpHeaderAuth\":{\"id\":\"10\",\"name\":\"Header Auth account\"}},\"typeVersion\":1},{\"name\":\"Telegram\",\"type\":\"n8n-nodes-base.telegram\",\"position\":[1480,460],\"parameters\":{\"text\":\"={{$json[\\\"title\\\"]}} by {{$json[\\\"author\\\"]}}\\n\\n{{$json[\\\"summary\\\"]}}\\n\\n{{$json[\\\"url\\\"]}}\",\"chatId\":\"={{$node[\\\"Config\\\"].parameter[\\\"values\\\"][\\\"number\\\"][0][\\\"value\\\"]}}\",\"additionalFields\":{}},\"credentials\":{\"telegramApi\":{\"id\":\"2\",\"name\":\"my bot\"}},\"typeVersion\":1},{\"name\":\"Binary to json\",\"type\":\"n8n-nodes-base.moveBinaryData\",\"position\":[800,460],\"parameters\":{\"options\":{}},\"typeVersion\":1,\"alwaysOutputData\":true},{\"name\":\"Json to binary\",\"type\":\"n8n-nodes-base.moveBinaryData\",\"position\":[1480,280],\"parameters\":{\"mode\":\"jsonToBinary\",\"options\":{}},\"typeVersion\":1},{\"name\":\"Set new update time\",\"type\":\"n8n-nodes-base.functionItem\",\"position\":[1280,280],\"parameters\":{\"functionCode\":\"return {\\n  last_synced: new Date().getTime()\\n};\"},\"typeVersion\":1},{\"name\":\"Split into baches\",\"type\":\"n8n-nodes-base.function\",\"position\":[1280,460],\"parameters\":{\"functionCode\":\"const newValue = Object.values(items[0].json.documents).filter(it => it.category === 'article').filter(it => it.children.length === 0).map(it => ({\\n  json: {\\n      url: it.url,\\n  title: it.title,\\n  author: it.author,\\n  summary: it.summary,\\n  saved_at: new Date(it.saved_at),\\n  }\\n}))\\n\\n\\nreturn newValue;\"},\"typeVersion\":1},{\"name\":\"Cron\",\"type\":\"n8n-nodes-base.cron\",\"position\":[340,540],\"parameters\":{\"triggerTimes\":{\"item\":[{\"mode\":\"everyX\",\"unit\":\"minutes\",\"value\":10}]}},\"typeVersion\":1},{\"name\":\"Config\",\"type\":\"n8n-nodes-base.set\",\"position\":[800,300],\"parameters\":{\"values\":{\"number\":[{\"name\":\"Telegram chat it\",\"value\":19999}],\"string\":[{\"name\":\"file path\",\"value\":\"/whatever/readwiseLastSynced.json\"}]},\"options\":{}},\"typeVersion\":1}],\"connections\":{\"Cron\":{\"main\":[[{\"node\":\"Read Binary File\",\"type\":\"main\",\"index\":0}]]},\"HTTP Request\":{\"main\":[[{\"node\":\"Split into baches\",\"type\":\"main\",\"index\":0},{\"node\":\"Set new update time\",\"type\":\"main\",\"index\":0}]]},\"Binary to json\":{\"main\":[[{\"node\":\"HTTP Request\",\"type\":\"main\",\"index\":0}]]},\"Json to binary\":{\"main\":[[{\"node\":\"Write Binary File\",\"type\":\"main\",\"index\":0}]]},\"Read Binary File\":{\"main\":[[{\"node\":\"Binary to json\",\"type\":\"main\",\"index\":0}]]},\"Split into baches\":{\"main\":[[{\"node\":\"Telegram\",\"type\":\"main\",\"index\":0}]]},\"Set new update time\":{\"main\":[[{\"node\":\"Json to binary\",\"type\":\"main\",\"index\":0}]]},\"On clicking 'execute'\":{\"main\":[[{\"node\":\"Read Binary File\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "## What is it\n\nThis workflow aims to build a simple bot that will send a message to a telegram channel every time there is a new saved item to the Reader.\n\nThis workflow can be easily modify to support other way of sending the notification, thanks to existing n8n nodes.\n\nWarning: **This is only for folks who already have access to the Reader, it won't work if you don't**\n\nAlso, this workflow use a file to store the last update time in order to not sync everything everytime.\n\n## Setup\n\nThe config node :\n\n  * It contains the telegram channel id\n  * It also contains the file used as storage\n\n\n\nTo get the header auth, you have to :\n\n  1. Go to the reader\n  2. Open the devtools, Option + ⌘ + J (on macOS), or Shift + CTRL + J (on Windows/Linux)\n  3. Go to network and find a `profile_details/` request, click on it\n  4. Go to Request Headers\n  5. Copy the value for \"Cookie\"\n  6. In n8n, set the name of the Header auth account to `Cookie` and the value with the one you copied before\n\n\n",
  "readme_html": "<!--[--><div data-v-50766329=\"\"><h2>What is it</h2>\n<p></p>\n<p>This workflow aims to build a simple bot that will send a message to a telegram channel every time there is a new saved item to the Reader.</p>\n<p>This workflow can be easily modify to support other way of sending the notification, thanks to existing n8n nodes.</p>\n<p>Warning: <strong>This is only for folks who already have access to the Reader, it won't work if you don't</strong></p>\n<p>Also, this workflow use a file to store the last update time in order to not sync everything everytime.</p>\n<h2>Setup</h2>\n<p>The config node :</p>\n<ul>\n<li>It contains the telegram channel id</li>\n<li>It also contains the file used as storage</li>\n</ul>\n<p>To get the header auth, you have to :</p>\n<ol>\n<li>Go to the reader</li>\n<li>Open the devtools, Option + ⌘ + J (on macOS), or Shift + CTRL + J (on Windows/Linux)</li>\n<li>Go to network and find a <code>profile_details/</code> request, click on it</li>\n<li>Go to Request Headers</li>\n<li>Copy the value for \"Cookie\"</li>\n<li>In n8n, set the name of the Header auth account to <code>Cookie</code> and the value with the one you copied before</li>\n</ol>\n</div><!--]-->",
  "readme_zh": "## 这是什么\n\n这个工作流旨在构建一个简单的机器人，每当Reader中有新保存的项目时，就会向一个Telegram频道发送消息。\n\n得益于现有的n8n节点，这个工作流可以轻松修改以支持其他发送通知的方式。\n\n警告：**这仅适用于已经可以访问Reader的用户，如果你没有权限，它将无法工作**\n\n此外，这个工作流使用一个文件来存储最后更新时间，以避免每次都同步所有内容。\n\n## 设置\n\n配置节点：\n\n  * 包含Telegram频道ID\n  * 也包含用作存储的文件",
  "title_zh": "发送一条消息到Telegram，通知有新项目保存至Reader",
  "publish_date_zh": "最后更新于10个月前",
  "workflow_json_zh": "{\n  \"nodes\": [\n    {\n      \"name\": \"On clicking 'execute'\",\n      \"type\": \"n8n-nodes-base.manualTrigger\",\n      \"position\": [\n        340,\n        380\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Write Binary File\",\n      \"type\": \"n8n-nodes-base.writeBinaryFile\",\n      \"position\": [\n        1680,\n        280\n      ],\n      \"parameters\": {\n        \"fileName\": \"={{$node[\\\"Config\\\"].parameter[\\\"values\\\"][\\\"string\\\"][0][\\\"value\\\"]}}\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Read Binary File\",\n      \"type\": \"n8n-nodes-base.readBinaryFile\",\n      \"position\": [\n        580,\n        460\n      ],\n      \"parameters\": {\n        \"filePath\": \"={{$node[\\\"Config\\\"].parameter[\\\"values\\\"][\\\"string\\\"][0][\\\"value\\\"]}}\"\n      },\n      \"typeVersion\": 1,\n      \"continueOnFail\": true,\n      \"alwaysOutputData\": true\n    },\n    {\n      \"name\": \"HTTP Request\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1020,\n        460\n      ],\n      \"parameters\": {\n        \"url\": \"https://readwise.io/reader/api/state/\",\n        \"options\": {},\n        \"authentication\": \"headerAuth\",\n        \"queryParametersUi\": {\n          \"parameter\": [\n            {\n              \"name\": \"schemaVersion\",\n              \"value\": \"5\"\n            },\n            {\n              \"name\": \"filter[updated_at][gt]\",\n              \"value\": \"={{$json[\\\"last_synced\\\"]}}\"\n            }\n          ]\n        },\n        \"headerParametersUi\": {\n          \"parameter\": []\n        }\n      },\n      \"credentials\": {\n        \"httpHeaderAuth\": {\n          \"id\": \"10\",\n          \"name\": \"Header Auth account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Telegram\",\n      \"type\": \"n8n-nodes-base.telegram\",\n      \"position\": [\n        1480,\n        460\n      ],\n      \"parameters\": {\n        \"text\": \"={{$json[\\\"title\\\"]}} by {{$json[\\\"author\\\"]}}\\n\\n{{$json[\\\"summary\\\"]}}\\n\\n{{$json[\\\"url\\\"]}}\",\n        \"chatId\": \"={{$node[\\\"Config\\\"].parameter[\\\"values\\\"][\\\"number\\\"][0][\\\"value\\\"]}}\",\n        \"additionalFields\": {}\n      },\n      \"credentials\": {\n        \"telegramApi\": {\n          \"id\": \"2\",\n          \"name\": \"my bot\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Binary to json\",\n      \"type\": \"n8n-nodes-base.moveBinaryData\",\n      \"position\": [\n        800,\n        460\n      ],\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"typeVersion\": 1,\n      \"alwaysOutputData\": true\n    },\n    {\n      \"name\": \"Json to binary\",\n      \"type\": \"n8n-nodes-base.moveBinaryData\",\n      \"position\": [\n        1480,\n        280\n      ],\n      \"parameters\": {\n        \"mode\": \"jsonToBinary\",\n        \"options\": {}\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Set new update time\",\n      \"type\": \"n8n-nodes-base.functionItem\",\n      \"position\": [\n        1280,\n        280\n      ],\n      \"parameters\": {\n        \"functionCode\": \"return {\\n  last_synced: new Date().getTime()\\n};\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Split into baches\",\n      \"type\": \"n8n-nodes-base.function\",\n      \"position\": [\n        1280,\n        460\n      ],\n      \"parameters\": {\n        \"functionCode\": \"const newValue = Object.values(items[0].json.documents).filter(it => it.category === 'article').filter(it => it.children.length === 0).map(it => ({\\n  json: {\\n      url: it.url,\\n  title: it.title,\\n  author: it.author,\\n  summary: it.summary,\\n  saved_at: new Date(it.saved_at),\\n  }\\n}))\\n\\n\\nreturn newValue;\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Cron\",\n      \"type\": \"n8n-nodes-base.cron\",\n      \"position\": [\n        340,\n        540\n      ],\n      \"parameters\": {\n        \"triggerTimes\": {\n          \"item\": [\n            {\n              \"mode\": \"everyX\",\n              \"unit\": \"minutes\",\n              \"value\": 10\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Config\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        800,\n        300\n      ],\n      \"parameters\": {\n        \"values\": {\n          \"number\": [\n            {\n              \"name\": \"Telegram chat it\",\n              \"value\": 19999\n            }\n          ],\n          \"string\": [\n            {\n              \"name\": \"file path\",\n              \"value\": \"/whatever/readwiseLastSynced.json\"\n            }\n          ]\n        },\n        \"options\": {}\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"connections\": {\n    \"Cron\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Read Binary File\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"HTTP Request\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Split into baches\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Set new update time\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Binary to json\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"HTTP Request\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Json to binary\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Write Binary File\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Read Binary File\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Binary to json\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Split into baches\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Telegram\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Set new update time\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Json to binary\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"On clicking 'execute'\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Read Binary File\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}