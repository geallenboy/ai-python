{
  "title": "SharePoint List Fetch with OAuth Token",
  "url": "https://n8n.io/workflows/2527-sharepoint-list-fetch-with-oauth-token/",
  "category": "BuildingBlocks",
  "category_url": "https://n8n.io/workflows/categories/building-blocks/?sort=createdAt:desc",
  "author": "Aditya Gaur",
  "publish_date": "Last update 6 months ago",
  "publish_date_absolute": "2024-11-07",
  "content": "",
  "workflow_json": "{\"nodes\":[{\"id\":\"2654751b-aa66-40ce-b8a0-79063aa710ad\",\"name\":\"Generate OAuth Token\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[820,460],\"parameters\":{\"url\":\"=https://accounts.accesscontrol.windows.net/{{ $json.tenant_id }}/tokens/oAuth/2\",\"options\":{},\"requestMethod\":\"POST\",\"bodyParametersUi\":{\"parameter\":[{\"name\":\"grant_type\",\"value\":\"client_credentials\"},{\"name\":\"client_id\",\"value\":\"{{client_id}}\"},{\"name\":\"client_secret\",\"value\":\"{{client_secret}}\"},{\"name\":\"resource\",\"value\":\"https://{your-sharepoint-domain}.sharepoint.com\"}]}},\"typeVersion\":2},{\"id\":\"6f713c65-8fbd-4d05-bbef-9b4a1f6248e9\",\"name\":\"Fetch SharePoint List\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[1160,460],\"parameters\":{\"url\":\"https://{your-sharepoint-domain}.sharepoint.com/_api/web/lists/getbytitle('YourListTitle')/items\",\"options\":{},\"headerParametersUi\":{\"parameter\":[{\"name\":\"Accept\",\"value\":\"application/json;odata=nometadata\"},{\"name\":\"Content-Type\",\"value\":\"application/json;odata=verbose\"},{\"name\":\"Authorization\",\"value\":\"Bearer {{Token}}\"}]}},\"typeVersion\":2},{\"id\":\"d11e9e92-2468-485c-87f5-6de7da7f9589\",\"name\":\"Schedule Trigger\",\"type\":\"n8n-nodes-base.scheduleTrigger\",\"position\":[380,460],\"parameters\":{\"rule\":{\"interval\":[{}]}},\"typeVersion\":1.2},{\"id\":\"8539f52c-2218-4a47-9678-3e3e8e9fd4c8\",\"name\":\"setTenant\",\"type\":\"n8n-nodes-base.set\",\"position\":[600,460],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"399d42f3-41e0-4043-9a57-85771bf5cd07\",\"name\":\"tenant_id\",\"type\":\"string\",\"value\":\"\"}]}},\"typeVersion\":3.4},{\"id\":\"5a4fa41c-0726-4528-99a3-b5e0c47c1960\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[580,220],\"parameters\":{\"color\":7,\"width\":458,\"height\":404,\"content\":\"## Never expose or hard code below values \\n**tenant_id,client_id,client_secret** \\n\\nAlways save these either in secure vault like hashicorp or GCP Secret Manager.\"},\"typeVersion\":1}],\"pinData\":{},\"connections\":{\"setTenant\":{\"main\":[[{\"node\":\"Generate OAuth Token\",\"type\":\"main\",\"index\":0}]]},\"Schedule Trigger\":{\"main\":[[{\"node\":\"setTenant\",\"type\":\"main\",\"index\":0}]]},\"Generate OAuth Token\":{\"main\":[[{\"node\":\"Fetch SharePoint List\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "## Who is this template for?\n\nThis template is designed for teams who need to automate data retrieval from SharePoint lists using n8n. It is ideal for users who want to authenticate via OAuth and then use the token to access SharePoint API endpoints, pulling in list data directly into n8n.\n\n## How it works\n\nThe template first generates an OAuth token using the Microsoft OAuth API. This token is then used to authenticate requests to the SharePoint List API, allowing the workflow to fetch data from a specified SharePoint list. By following the n8n workflow, the user can configure the necessary credentials and endpoints to automate SharePoint data access securely.\n\n## Setup steps\n\n**Step 1:** Replace {tenant_id}, {client_id}, and {client_secret} with your Azure AD details for OAuth authentication.\n\n**Step 2:** Specify the SharePoint list API endpoint in the template (under \"SharePoint List Fetch\" node).\n\n**Step 3:** Configure the SharePoint list URL and make adjustments for specific data fields if necessary.\n",
  "readme_html": "<!--[--><div data-v-50766329=\"\"><h2>Who is this template for?</h2>\n<p>This template is designed for teams who need to automate data retrieval from SharePoint lists using n8n. It is ideal for users who want to authenticate via OAuth and then use the token to access SharePoint API endpoints, pulling in list data directly into n8n.</p>\n<h2>How it works</h2>\n<p>The template first generates an OAuth token using the Microsoft OAuth API. This token is then used to authenticate requests to the SharePoint List API, allowing the workflow to fetch data from a specified SharePoint list. By following the n8n workflow, the user can configure the necessary credentials and endpoints to automate SharePoint data access securely.</p>\n<h2>Setup steps</h2>\n<p><strong>Step 1:</strong> Replace {tenant_id}, {client_id}, and {client_secret} with your Azure AD details for OAuth authentication.</p>\n<p><strong>Step 2:</strong> Specify the SharePoint list API endpoint in the template (under \"SharePoint List Fetch\" node).</p>\n<p><strong>Step 3:</strong> Configure the SharePoint list URL and make adjustments for specific data fields if necessary.</p>\n</div><!--]-->",
  "readme_zh": "## 该模板适用于谁？\n\n本模板专为需要通过n8n实现SharePoint列表数据自动抓取的团队设计，特别适合希望采用OAuth认证并利用令牌访问SharePoint API接口的用户，实现将列表数据直接导入n8n工作流。\n\n## 运作原理\n\n模板首先通过Microsoft OAuth API生成认证令牌，随后利用该令牌向SharePoint列表API发起鉴权请求，从而获取指定SharePoint列表的数据。用户只需按照n8n工作流指引配置相关凭证和接口地址，即可安全实现SharePoint数据的自动化获取。\n\n## 配置步骤\n\n**第一步：** 将{tenant_id}、{client_id}和{client_secret}替换为您Azure AD的OAuth认证信息\n\n**第二步：** 在模板的\"SharePoint列表获取\"节点中指定目标列表API接口地址\n\n**第三步：** 配置SharePoint列表URL链接，并根据实际需求调整数据字段映射",
  "title_zh": "使用OAuth令牌获取SharePoint列表",
  "publish_date_zh": "最后更新于6个月前",
  "workflow_json_zh": "{\"nodes\":[{\"id\":\"2654751b-aa66-40ce-b8a0-79063aa710ad\",\"name\":\"Generate OAuth Token\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[820,460],\"parameters\":{\"url\":\"=https://accounts.accesscontrol.windows.net/{{ $json.tenant_id }}/tokens/oAuth/2\",\"options\":{},\"requestMethod\":\"POST\",\"bodyParametersUi\":{\"parameter\":[{\"name\":\"grant_type\",\"value\":\"client_credentials\"},{\"name\":\"client_id\",\"value\":\"{{client_id}}\"},{\"name\":\"client_secret\",\"value\":\"{{client_secret}}\"},{\"name\":\"resource\",\"value\":\"https://{your-sharepoint-domain}.sharepoint.com\"}]}},\"typeVersion\":2},{\"id\":\"6f713c65-8fbd-4d05-bbef-9b4a1f6248e9\",\"name\":\"Fetch SharePoint List\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[1160,460],\"parameters\":{\"url\":\"https://{your-sharepoint-domain}.sharepoint.com/_api/web/lists/getbytitle('YourListTitle')/items\",\"options\":{},\"headerParametersUi\":{\"parameter\":[{\"name\":\"Accept\",\"value\":\"application/json;odata=nometadata\"},{\"name\":\"Content-Type\",\"value\":\"application/json;odata=verbose\"},{\"name\":\"Authorization\",\"value\":\"Bearer {{Token}}\"}]}},\"typeVersion\":2},{\"id\":\"d11e9e92-2468-485c-87f5-6de7da7f9589\",\"name\":\"Schedule Trigger\",\"type\":\"n8n-nodes-base.scheduleTrigger\",\"position\":[380,460],\"parameters\":{\"rule\":{\"interval\":[{}]}},\"typeVersion\":1.2},{\"id\":\"8539f52c-2218-4a47-9678-3e3e8e9fd4c8\",\"name\":\"setTenant\",\"type\":\"n8n-nodes-base.set\",\"position\":[600,460],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"399d42f3-41e0-4043-9a57-85771bf5cd07\",\"name\":\"tenant_id\",\"type\":\"string\",\"value\":\"\"}]}},\"typeVersion\":3.4},{\"id\":\"5a4fa41c-0726-4528-99a3-b5e0c47c1960\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[580,220],\"parameters\":{\"color\":7,\"width\":458,\"height\":404,\"content\":\"## 切勿直接暴露或硬编码以下值  \\n**tenant_id（租户ID）、client_id（客户端ID）、client_secret（客户端密钥）**  \\n\\n请始终将这些信息保存在安全存储中，例如Hashicorp保险库或GCP密钥管理器。\"},\"typeVersion\":1}],\"pinData\":{},\"connections\":{\"setTenant\":{\"main\":[[{\"node\":\"Generate OAuth Token\",\"type\":\"main\",\"index\":0}]]},\"Schedule Trigger\":{\"main\":[[{\"node\":\"setTenant\",\"type\":\"main\",\"index\":0}]]},\"Generate OAuth Token\":{\"main\":[[{\"node\":\"Fetch SharePoint List\",\"type\":\"main\",\"index\":0}]]}}}"
}