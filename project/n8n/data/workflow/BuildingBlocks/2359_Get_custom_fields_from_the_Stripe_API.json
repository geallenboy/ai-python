{
  "title": "Get custom_fields from the Stripe API",
  "url": "https://n8n.io/workflows/2359-get-customfields-from-the-stripe-api/",
  "category": "BuildingBlocks",
  "category_url": "https://n8n.io/workflows/categories/building-blocks/?sort=createdAt:desc",
  "author": "Solomon",
  "publish_date": "Last update 4 months ago",
  "publish_date_absolute": "2025-01-07",
  "content": "",
  "workflow_json": "{\"meta\":{\"instanceId\":\"84ba6d895254e080ac2b4916d987aa66b000f88d4d919a6b9c76848f9b8a7616\",\"templateId\":\"2359\"},\"nodes\":[{\"id\":\"654e210f-08b1-4ba4-b464-9499084092a2\",\"name\":\"split custom_fields\",\"type\":\"n8n-nodes-base.splitOut\",\"position\":[980,640],\"parameters\":{\"include\":\"allOtherFields\",\"options\":{},\"fieldToSplitOut\":\"custom_fields\"},\"typeVersion\":1},{\"id\":\"9b1a4071-7dd8-4d60-b077-d686fff40d24\",\"name\":\"Stripe | Get latest checkout sessions1\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[460,640],\"parameters\":{\"url\":\"=https://api.stripe.com/v1/checkout/sessions\",\"options\":{\"pagination\":{\"pagination\":{\"parameters\":{\"parameters\":[{\"name\":\"starting_after\",\"value\":\"={{ $response.body.data.last().id }}\"}]},\"completeExpression\":\"={{ $response.body.has_more == false }}\",\"paginationCompleteWhen\":\"other\"}}},\"jsonQuery\":\"={\\n  \\\"created\\\": {\\n    \\\"gte\\\":{{ $today.minus(20, 'days').toSeconds() }},\\n    \\\"lte\\\":{{ $today.toSeconds() }}\\n  }\\n}\",\"sendQuery\":true,\"specifyQuery\":\"json\",\"authentication\":\"predefinedCredentialType\",\"nodeCredentialType\":\"stripeApi\"},\"typeVersion\":4.2},{\"id\":\"17016a73-5338-49c7-af8d-8587c778c2f6\",\"name\":\"Sticky Note4\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[380,240],\"parameters\":{\"color\":7,\"width\":252.741654751449,\"height\":593.3373455805055,\"content\":\"## Retrieve all checkout sessions from the last 7 days.\\n\\nYou can adjust the period by changing the \\\"created\\\" value.\\n\\n[🔍 Learn more about the \\\"created\\\" parameter](https://docs.stripe.com/api/checkout/sessions/list?lang=curl#list_checkout_sessions-created)\\n\\n\\nAnd this node uses pagination to get all results. You want to keep those settings at the bottom.\"},\"typeVersion\":1},{\"id\":\"e46a5332-a008-4617-be57-eb22e713022d\",\"name\":\"Sticky Note5\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[700,545],\"parameters\":{\"color\":7,\"width\":451.2991079615292,\"height\":267.24226082469556,\"content\":\"## Split data for easier visualization\"},\"typeVersion\":1},{\"id\":\"ebf8a12a-787c-4ab8-9060-2241bbf38489\",\"name\":\"Sticky Note6\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1220,237],\"parameters\":{\"color\":7,\"height\":598.2429925878827,\"content\":\"## Select the custom fields you want\\n\\nHere you can choose to filter your contacts to keep only the ones who contain certain custom_fields.\\n\\nLet's say you only want the ones who have filled their nickname and job title.\"},\"typeVersion\":1},{\"id\":\"e9c54905-dadb-4b5e-9ce0-cfe7d436c51e\",\"name\":\"Filter by custom_field\",\"type\":\"n8n-nodes-base.filter\",\"position\":[1280,640],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"4579d72e-8d48-4146-952d-9b5b400f5bce\",\"operator\":{\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $json.custom_fields.key }}\",\"rightValue\":\"nickname\"},{\"id\":\"34197f40-9b41-46e4-8796-be3a86e4dcca\",\"operator\":{\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $json.custom_fields.key }}\",\"rightValue\":\"job_title\"}]}},\"typeVersion\":2},{\"id\":\"14915079-68ba-48ab-9a9d-fe627aa2bd33\",\"name\":\"split all data\",\"type\":\"n8n-nodes-base.splitOut\",\"position\":[760,640],\"parameters\":{\"options\":{},\"fieldToSplitOut\":\"data\"},\"typeVersion\":1}],\"pinData\":{},\"connections\":{\"split all data\":{\"main\":[[{\"node\":\"split custom_fields\",\"type\":\"main\",\"index\":0}]]},\"split custom_fields\":{\"main\":[[{\"node\":\"Filter by custom_field\",\"type\":\"main\",\"index\":0}]]},\"Stripe | Get latest checkout sessions1\":{\"main\":[[{\"node\":\"split all data\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "The Stripe API does not provide custom fields in invoice or charge data. So you have to get it from the [**Checkout Sessions**](https://docs.stripe.com/api/checkout/sessions) endpoint.\n\nBut that endpoint is not easy for begginners. It has dictionary parameters and pagination settings.\n\nThis workflows solves that problem by having a preconfigured GET request that gets **all the checkout sessions from the last 7 days**.\n\nIt then transforms the data to make it easier to work with and allows you to **filter by the custom_fields** you want to get.\n\n### Want to generate Stripe invoices automatically?\n\nOpen 👉 [**this workflow**](https://n8n.io/workflows/2675)  \n.\n\n### Check out my other templates\n\n[**https://n8n.io/creators/solomon/**](https://n8n.io/creators/solomon/)\n",
  "readme_html": "<!--[--><div data-v-50766329=\"\"><p>The Stripe API does not provide custom fields in invoice or charge data. So you have to get it from the <a href=\"https://docs.stripe.com/api/checkout/sessions\" rel=\"ugc nofollow\" target=\"_blank\"><strong>Checkout Sessions</strong></a> endpoint.</p>\n<p>But that endpoint is not easy for begginners. It has dictionary parameters and pagination settings.</p>\n<p>This workflows solves that problem by having a preconfigured GET request that gets <strong>all the checkout sessions from the last 7 days</strong>.</p>\n<p>It then transforms the data to make it easier to work with and allows you to <strong>filter by the custom_fields</strong> you want to get.</p>\n<h3>Want to generate Stripe invoices automatically?</h3>\n<p>Open 👉 <a href=\"https://n8n.io/workflows/2675\" rel=\"ugc nofollow\" target=\"_blank\"><strong>this workflow</strong></a><br>\n.</p>\n<h3>Check out my other templates</h3>\n<p><a href=\"https://n8n.io/creators/solomon/\" rel=\"ugc nofollow\" target=\"_blank\"><strong>https://n8n.io/creators/solomon/</strong></a></p>\n</div><!--]-->",
  "readme_zh": "Stripe API并未在发票或支付数据中提供自定义字段功能，因此您需要通过[**Checkout Sessions**](https://docs.stripe.com/api/checkout/sessions)接口获取。\n\n但该接口对初学者并不友好，涉及字典参数和分页设置等复杂操作。\n\n本工作流已预设好GET请求，可自动获取**最近7天所有支付会话数据**，并通过数据转换简化处理流程，支持按需筛选所需的**custom_fields**字段。\n\n### 需要自动生成Stripe发票？\n\n立即打开 👉 [**此工作流**](https://n8n.io/workflows/2675)  \n\n### 查看我的其他模板\n\n[**https://n8n.io/creators/solomon/**](https://n8n.io/creators/solomon/)",
  "title_zh": "从Stripe API获取custom_fields",
  "publish_date_zh": "最后更新于4个月前",
  "workflow_json_zh": "{\n  \"meta\": {\n    \"instanceId\": \"84ba6d895254e080ac2b4916d987aa66b000f88d4d919a6b9c76848f9b8a7616\",\n    \"templateId\": \"2359\"\n  },\n  \"nodes\": [\n    {\n      \"id\": \"654e210f-08b1-4ba4-b464-9499084092a2\",\n      \"name\": \"split custom_fields\",\n      \"type\": \"n8n-nodes-base.splitOut\",\n      \"position\": [\n        980,\n        640\n      ],\n      \"parameters\": {\n        \"include\": \"allOtherFields\",\n        \"options\": {},\n        \"fieldToSplitOut\": \"custom_fields\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"9b1a4071-7dd8-4d60-b077-d686fff40d24\",\n      \"name\": \"Stripe | Get latest checkout sessions1\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        460,\n        640\n      ],\n      \"parameters\": {\n        \"url\": \"=https://api.stripe.com/v1/checkout/sessions\",\n        \"options\": {\n          \"pagination\": {\n            \"pagination\": {\n              \"parameters\": {\n                \"parameters\": [\n                  {\n                    \"name\": \"starting_after\",\n                    \"value\": \"={{ $response.body.data.last().id }}\"\n                  }\n                ]\n              },\n              \"completeExpression\": \"={{ $response.body.has_more == false }}\",\n              \"paginationCompleteWhen\": \"other\"\n            }\n          }\n        },\n        \"jsonQuery\": \"={\\n  \\\"created\\\": {\\n    \\\"gte\\\":{{ $today.minus(20, 'days').toSeconds() }},\\n    \\\"lte\\\":{{ $today.toSeconds() }}\\n  }\\n}\",\n        \"sendQuery\": true,\n        \"specifyQuery\": \"json\",\n        \"authentication\": \"predefinedCredentialType\",\n        \"nodeCredentialType\": \"stripeApi\"\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"17016a73-5338-49c7-af8d-8587c778c2f6\",\n      \"name\": \"Sticky Note4\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        380,\n        240\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 252.741654751449,\n        \"height\": 593.3373455805055,\n        \"content\": \"## 获取过去7天内的所有结账会话\\n\\n您可以通过修改\\\"created\\\"参数来调整查询时间段。\\n\\n[🔍 详细了解\\\"created\\\"参数](https://docs.stripe.com/api/checkout/sessions/list?lang=curl#list_checkout_sessions-created)\\n\\n该节点采用分页机制获取全部结果，请保持底部这些分页设置不变。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"e46a5332-a008-4617-be57-eb22e713022d\",\n      \"name\": \"Sticky Note5\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        700,\n        545\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 451.2991079615292,\n        \"height\": 267.24226082469556,\n        \"content\": \"## 分割数据以便于可视化\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"ebf8a12a-787c-4ab8-9060-2241bbf38489\",\n      \"name\": \"Sticky Note6\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1220,\n        237\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"height\": 598.2429925878827,\n        \"content\": \"## 选择您需要的自定义字段\\n\\n在此处，您可以通过筛选联系人，仅保留包含特定自定义字段的联系人。\\n\\n例如，假设您只想保留填写了昵称和职位头衔的联系人。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"e9c54905-dadb-4b5e-9ce0-cfe7d436c51e\",\n      \"name\": \"Filter by custom_field\",\n      \"type\": \"n8n-nodes-base.filter\",\n      \"position\": [\n        1280,\n        640\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"4579d72e-8d48-4146-952d-9b5b400f5bce\",\n              \"operator\": {\n                \"type\": \"string\",\n                \"operation\": \"equals\"\n              },\n              \"leftValue\": \"={{ $json.custom_fields.key }}\",\n              \"rightValue\": \"nickname\"\n            },\n            {\n              \"id\": \"34197f40-9b41-46e4-8796-be3a86e4dcca\",\n              \"operator\": {\n                \"type\": \"string\",\n                \"operation\": \"equals\"\n              },\n              \"leftValue\": \"={{ $json.custom_fields.key }}\",\n              \"rightValue\": \"job_title\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"14915079-68ba-48ab-9a9d-fe627aa2bd33\",\n      \"name\": \"split all data\",\n      \"type\": \"n8n-nodes-base.splitOut\",\n      \"position\": [\n        760,\n        640\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"fieldToSplitOut\": \"data\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"pinData\": {},\n  \"connections\": {\n    \"split all data\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"split custom_fields\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"split custom_fields\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Filter by custom_field\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Stripe | Get latest checkout sessions1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"split all data\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}