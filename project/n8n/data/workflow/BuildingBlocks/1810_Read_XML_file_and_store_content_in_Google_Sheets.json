{
  "title": "Read XML file and store content in Google Sheets",
  "url": "https://n8n.io/workflows/1810-read-xml-file-and-store-content-in-google-sheets/",
  "category": "BuildingBlocks",
  "category_url": "https://n8n.io/workflows/categories/building-blocks/?sort=createdAt:desc",
  "author": "Tom",
  "publish_date": "Last update 10 months ago",
  "publish_date_absolute": "",
  "content": "",
  "workflow_json": "{\"nodes\":[{\"id\":\"d0c92688-14fc-4393-a1d6-926eb867b81e\",\"name\":\"On clicking 'execute'\",\"type\":\"n8n-nodes-base.manualTrigger\",\"position\":[180,240],\"parameters\":{},\"typeVersion\":1},{\"id\":\"0edbad78-249b-441c-877d-bac57fb44a91\",\"name\":\"Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[180,31],\"parameters\":{\"width\":436,\"height\":169,\"content\":\"## n8n version\\n\\nThis workflow was created using n8n version 0.197.1 and uses a new [expression syntax](https://docs.n8n.io/code-examples/methods-variables-reference/) as well as a new version of the Merge node. Make sure you're also using n8n version 0.197.1 or newer when running this workflow.\"},\"typeVersion\":1},{\"id\":\"251d893c-11cb-4702-a289-44f198581722\",\"name\":\"Download XML File\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[400,240],\"parameters\":{\"url\":\"https://www.w3schools.com/xml/simple.xml\",\"options\":{}},\"typeVersion\":3},{\"id\":\"0973b302-1ba9-4faf-9d6c-2caca1b301f5\",\"name\":\"Parse XML content\",\"type\":\"n8n-nodes-base.xml\",\"position\":[620,240],\"parameters\":{\"options\":{}},\"typeVersion\":1},{\"id\":\"01854111-27cb-40c1-b95e-14f91f89e9f1\",\"name\":\"Create new spreadsheet file\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[1060,140],\"parameters\":{\"title\":\"My XML Data\",\"options\":{},\"resource\":\"spreadsheet\"},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"19\",\"name\":\"Tom's Google Sheets account\"}},\"executeOnce\":true,\"typeVersion\":2},{\"id\":\"affbcb81-5873-406e-a51d-cd6fee682992\",\"name\":\"Define header row\",\"type\":\"n8n-nodes-base.set\",\"position\":[1280,140],\"parameters\":{\"values\":{\"string\":[{\"name\":\"columns\",\"value\":\"={{ [ Object.keys($(\\\"Split out food items\\\").first().json) ] }}\"}]},\"options\":{},\"keepOnlySet\":true},\"executeOnce\":true,\"typeVersion\":1},{\"id\":\"537aff03-ae08-4712-bfae-15f0e3a5e69a\",\"name\":\"Split out food items\",\"type\":\"n8n-nodes-base.itemLists\",\"position\":[840,240],\"parameters\":{\"options\":{},\"fieldToSplitOut\":\"breakfast_menu.food\"},\"typeVersion\":1},{\"id\":\"b247f984-6ed2-4de0-8877-a61571863ff8\",\"name\":\"Write header row\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[1500,140],\"parameters\":{\"options\":{},\"rawData\":true,\"sheetId\":\"={{ $(\\\"Create new spreadsheet file\\\").first().json[\\\"spreadsheetId\\\"] }}\",\"operation\":\"update\",\"dataProperty\":\"columns\"},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"19\",\"name\":\"Tom's Google Sheets account\"}},\"typeVersion\":2},{\"id\":\"fc9e2c32-30b1-4162-a686-2d049e52e111\",\"name\":\"Wait for spreadsheet creation\",\"type\":\"n8n-nodes-base.merge\",\"position\":[1720,240],\"parameters\":{\"mode\":\"chooseBranch\",\"output\":\"input2\"},\"typeVersion\":2},{\"id\":\"fdc6d5d9-e08d-4086-a233-0edb3c11bc86\",\"name\":\"Write data to sheet\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[1940,240],\"parameters\":{\"options\":{},\"sheetId\":\"={{ $(\\\"Create new spreadsheet file\\\").first().json[\\\"spreadsheetId\\\"] }}\",\"operation\":\"append\"},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"19\",\"name\":\"Tom's Google Sheets account\"}},\"typeVersion\":2}],\"connections\":{\"Write header row\":{\"main\":[[{\"node\":\"Wait for spreadsheet creation\",\"type\":\"main\",\"index\":0}]]},\"Define header row\":{\"main\":[[{\"node\":\"Write header row\",\"type\":\"main\",\"index\":0}]]},\"Download XML File\":{\"main\":[[{\"node\":\"Parse XML content\",\"type\":\"main\",\"index\":0}]]},\"Parse XML content\":{\"main\":[[{\"node\":\"Split out food items\",\"type\":\"main\",\"index\":0}]]},\"Split out food items\":{\"main\":[[{\"node\":\"Create new spreadsheet file\",\"type\":\"main\",\"index\":0},{\"node\":\"Wait for spreadsheet creation\",\"type\":\"main\",\"index\":1}]]},\"On clicking 'execute'\":{\"main\":[[{\"node\":\"Download XML File\",\"type\":\"main\",\"index\":0}]]},\"Create new spreadsheet file\":{\"main\":[[{\"node\":\"Define header row\",\"type\":\"main\",\"index\":0}]]},\"Wait for spreadsheet creation\":{\"main\":[[{\"node\":\"Write data to sheet\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "This workflow shows a low code approach to parsing an XML file and storing its contents in a Google Sheets spreadsheet.\n\n![image.png](https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/image_6f4afeaf74.png)\n\nTo run the workflow:\n\n  * Make sure you are running n8n 0.197 or newer\n  * Have n8n authenticated with Google Sheets\n\n\n\nHow it's done:\n\n  1. This workflow first downloads an example file using the [HTTP Request](https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.httprequest/) node and reads this file using the [XML](https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.xml/) node.  \n![image.png](https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/image_343b1db525.png)\n  2. It then runs the [Item Lists](https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.itemlists/) node to split out the individual `food` items from the example file.\n  3. It then splits up the workflow into a separate branch creating a new spreadsheet file using the [Google Sheets](https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.googlesheets/) node. To read the column names we're using the [Object.keys()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/keys) method inside a [Set](https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.set/) node.\n  4. Once the spreadsheet is created (the workflow waits for this using the [Merge](https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.merge/) node), the data is appended to the newly created sheet (again using the [Google Sheets](https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.googlesheets/) node).\n\n\n",
  "readme_html": "<!--[--><div data-v-50766329=\"\"><p>This workflow shows a low code approach to parsing an XML file and storing its contents in a Google Sheets spreadsheet.</p>\n<p><img src=\"https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/image_6f4afeaf74.png\" alt=\"image.png\"></p>\n<p>To run the workflow:</p>\n<ul>\n<li>Make sure you are running n8n 0.197 or newer</li>\n<li>Have n8n authenticated with Google Sheets</li>\n</ul>\n<p>How it's done:</p>\n<ol>\n<li>This workflow first downloads an example file using the <a href=\"https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.httprequest/\" rel=\"ugc nofollow\" target=\"_blank\">HTTP Request</a> node and reads this file using the <a href=\"https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.xml/\" rel=\"ugc nofollow\" target=\"_blank\">XML</a> node.<br>\n<img src=\"https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/image_343b1db525.png\" alt=\"image.png\"></li>\n<li>It then runs the <a href=\"https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.itemlists/\" rel=\"ugc nofollow\" target=\"_blank\">Item Lists</a> node to split out the individual <code>food</code> items from the example file.</li>\n<li>It then splits up the workflow into a separate branch creating a new spreadsheet file using the <a href=\"https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.googlesheets/\" rel=\"ugc nofollow\" target=\"_blank\">Google Sheets</a> node. To read the column names we're using the <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/keys\" rel=\"ugc nofollow\" target=\"_blank\">Object.keys()</a> method inside a <a href=\"https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.set/\" rel=\"ugc nofollow\" target=\"_blank\">Set</a> node.</li>\n<li>Once the spreadsheet is created (the workflow waits for this using the <a href=\"https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.merge/\" rel=\"ugc nofollow\" target=\"_blank\">Merge</a> node), the data is appended to the newly created sheet (again using the <a href=\"https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.googlesheets/\" rel=\"ugc nofollow\" target=\"_blank\">Google Sheets</a> node).</li>\n</ol>\n</div><!--]-->"
}