{
  "title": "Retry on fail except for known error",
  "url": "https://n8n.io/workflows/2719-retry-on-fail-except-for-known-error/",
  "category": "BuildingBlocks",
  "category_url": "https://n8n.io/workflows/categories/building-blocks/?sort=createdAt:desc",
  "author": "Mario",
  "publish_date": "Last update 4 months ago",
  "publish_date_absolute": "2025-01-06",
  "content": "",
  "workflow_json": "{\"id\":\"qAzZekQuABuH8uho\",\"meta\":{\"instanceId\":\"fb8bc2e315f7f03c97140b30aa454a27bc7883a19000fa1da6e6b571bf56ad6d\"},\"name\":\"Retry on fail except for known error Template\",\"tags\":[],\"nodes\":[{\"id\":\"fa6fb462-8c1b-4cab-a9f6-876e67688786\",\"name\":\"Retry limit reached\",\"type\":\"n8n-nodes-base.stopAndError\",\"position\":[-940,500],\"parameters\":{\"errorMessage\":\"Retry limit reached\"},\"typeVersion\":1},{\"id\":\"9627165d-1854-4a4f-b840-721f8d779b89\",\"name\":\"Set tries\",\"type\":\"n8n-nodes-base.set\",\"position\":[-940,260],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"cd93a7f6-4c06-4e8a-8d0d-e812c5ec4bc5\",\"name\":\"tries\",\"type\":\"number\",\"value\":\"={{ $json.tries || 0 }}\"}]},\"includeOtherFields\":true},\"typeVersion\":3.4},{\"id\":\"466efd16-4922-4e61-bc81-d8e8a1d8ea61\",\"name\":\"Update tries\",\"type\":\"n8n-nodes-base.set\",\"position\":[-60,500],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"df3c9b29-afa6-4e08-868d-5b7e8202eefa\",\"name\":\"tries\",\"type\":\"number\",\"value\":\"={{ $('Set tries').item.json.tries + 1 }}\"}]}},\"typeVersion\":3.4},{\"id\":\"a787761f-0a9d-4834-9a65-ac3b9a65b23e\",\"name\":\"Wait\",\"type\":\"n8n-nodes-base.wait\",\"position\":[-280,500],\"webhookId\":\"9d3b561f-4afd-478c-8f6e-60641d4f1d0b\",\"parameters\":{},\"typeVersion\":1.1},{\"id\":\"ff46ce53-69ca-4f88-8cc9-21b8d1e5557a\",\"name\":\"Catch known error\",\"type\":\"n8n-nodes-base.if\",\"position\":[-500,380],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"6a379b06-0b04-4ae4-9bf9-394bd40744b7\",\"operator\":{\"type\":\"string\",\"operation\":\"contains\"},\"leftValue\":\"={{ $json.error }}\",\"rightValue\":\"could not be found\"}]}},\"typeVersion\":2.2},{\"id\":\"0e9c282a-b521-4549-8ad5-9783b4d614b3\",\"name\":\"Replace Me\",\"type\":\"n8n-nodes-base.noOp\",\"onError\":\"continueErrorOutput\",\"position\":[-720,260],\"parameters\":{},\"typeVersion\":1},{\"id\":\"3b2b6839-65b9-4b0e-8e10-2010014fc8d9\",\"name\":\"Success\",\"type\":\"n8n-nodes-base.noOp\",\"position\":[-500,140],\"parameters\":{},\"typeVersion\":1},{\"id\":\"8d972714-8dcb-4ad6-8b5f-fb30a5f3294f\",\"name\":\"Known Error\",\"type\":\"n8n-nodes-base.noOp\",\"position\":[-280,260],\"parameters\":{},\"typeVersion\":1},{\"id\":\"e98cdc4a-73a4-41d1-bf5e-2a3bcfbf23af\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-560,280],\"parameters\":{\"width\":220,\"height\":240,\"content\":\"## Set filter\\nFilter by status code or error message.\"},\"typeVersion\":1},{\"id\":\"e5b76cd3-d90a-4d4b-a659-ff142558cbac\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-780,80],\"parameters\":{\"width\":220,\"height\":320,\"content\":\"## Replace Node\\nReplace this by the Node which retrieves the admired data.\\nEnable error branch in Node Settings and connect the outputs like in this example\"},\"typeVersion\":1},{\"id\":\"7ca409e6-7faf-48d5-972e-abbba3f011ef\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-1220,420],\"parameters\":{\"width\":220,\"height\":220,\"content\":\"## Set max tries\\nChange if needed, default is 3\"},\"typeVersion\":1},{\"id\":\"a13168eb-c4d1-46dd-857b-9a5e13ed1059\",\"name\":\"Manual Trigger\",\"type\":\"n8n-nodes-base.manualTrigger\",\"position\":[-1160,260],\"parameters\":{},\"typeVersion\":1},{\"id\":\"44c17908-96df-471b-97fc-9ce4c3acb3bb\",\"name\":\"Sticky Note3\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-340,400],\"parameters\":{\"width\":220,\"height\":240,\"content\":\"## Set Wait\\nChange duration if needed, default is 5s\"},\"typeVersion\":1},{\"id\":\"da7413f0-7962-4cf1-90ad-168cfc3d4c0d\",\"name\":\"Sticky Note4\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-560,80],\"parameters\":{\"color\":7,\"width\":220,\"height\":200,\"content\":\"Continue here, if the request succeeded\"},\"typeVersion\":1},{\"id\":\"e95c4b6a-2c63-4916-a239-91463728262a\",\"name\":\"Sticky Note5\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-340,200],\"parameters\":{\"color\":7,\"width\":220,\"height\":200,\"content\":\"Continue here, if the request failed\"},\"typeVersion\":1},{\"id\":\"8d8f7df0-35e3-4b94-96a3-6d4593732d0e\",\"name\":\"Sticky Note6\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-1000,420],\"parameters\":{\"color\":7,\"width\":220,\"height\":220,\"content\":\"Stop here, if all tries have failed\"},\"typeVersion\":1},{\"id\":\"893b3e51-f30f-4e2f-9e96-e1fc6f8dd0a3\",\"name\":\"Sticky Note7\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-1000,200],\"parameters\":{\"color\":7,\"width\":220,\"height\":220,\"content\":\"Define counter for tries\"},\"typeVersion\":1},{\"id\":\"cd1b1abb-dbd3-4023-8a6b-49c4ff5510a8\",\"name\":\"If tries left\",\"type\":\"n8n-nodes-base.if\",\"position\":[-1160,500],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"b18f784a-4386-4ced-a9e1-ce5a21ad036e\",\"operator\":{\"type\":\"number\",\"operation\":\"lt\"},\"leftValue\":\"={{ $json.tries }}\",\"rightValue\":3}]}},\"typeVersion\":2.2},{\"id\":\"ccce734b-c726-4b0a-9d37-7bd6df90e840\",\"name\":\"Sticky Note8\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-120,440],\"parameters\":{\"color\":7,\"width\":220,\"height\":220,\"content\":\"Update counter for tries\"},\"typeVersion\":1}],\"active\":false,\"pinData\":{},\"settings\":{\"executionOrder\":\"v1\"},\"versionId\":\"ad610eea-ad27-4a3b-b662-edea474bc5ff\",\"connections\":{\"Wait\":{\"main\":[[{\"node\":\"Update tries\",\"type\":\"main\",\"index\":0}]]},\"Set tries\":{\"main\":[[{\"node\":\"Replace Me\",\"type\":\"main\",\"index\":0}]]},\"Replace Me\":{\"main\":[[{\"node\":\"Success\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Catch known error\",\"type\":\"main\",\"index\":0}]]},\"Update tries\":{\"main\":[[{\"node\":\"If tries left\",\"type\":\"main\",\"index\":0}]]},\"If tries left\":{\"main\":[[{\"node\":\"Set tries\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Retry limit reached\",\"type\":\"main\",\"index\":0}]]},\"Manual Trigger\":{\"main\":[[{\"node\":\"Set tries\",\"type\":\"main\",\"index\":0}]]},\"Catch known error\":{\"main\":[[{\"node\":\"Known Error\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Wait\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "## Purpose\n\nThis workflow snippet allows for advanced error catching during retry attempts.\n\nThere are cases, where you want to check if an item exists first, so you can determine the following actions. Some API’s do not support an endpoint (e.g. Todoist: completed tasks) to do so, which is why you would work with the error branch, only that this does not work well in combination with the retry functionality.\n\n## How it works\n\n  * Instead of the builtin retry function of a Node a custom loop is used, to get more granular control in between the iterations\n  * If the main executed node fails, the error can be filtered for an expected error, which can trigger a separate action\n  * The retries only happen, if an unexpected error happened\n  * The workflow only stops, if the defined amount of retries exceeded\n\n\n\n## Setup\n\n  * Copy the nodes into your existing workflow\n  * Replace the “Replace me” placeholder with the Node you want to apply the retry logic on\n  * Follow the sticky notes for more instructions and optional settings\n\n\n",
  "readme_html": "<!--[--><div data-v-50766329=\"\"><h2>Purpose</h2>\n<p>This workflow snippet allows for advanced error catching during retry attempts.</p>\n<p>There are cases, where you want to check if an item exists first, so you can determine the following actions. Some API’s do not support an endpoint (e.g. Todoist: completed tasks) to do so, which is why you would work with the error branch, only that this does not work well in combination with the retry functionality.</p>\n<h2>How it works</h2>\n<ul>\n<li>Instead of the builtin retry function of a Node a custom loop is used, to get more granular control in between the iterations</li>\n<li>If the main executed node fails, the error can be filtered for an expected error, which can trigger a separate action</li>\n<li>The retries only happen, if an unexpected error happened</li>\n<li>The workflow only stops, if the defined amount of retries exceeded</li>\n</ul>\n<h2>Setup</h2>\n<ul>\n<li>Copy the nodes into your existing workflow</li>\n<li>Replace the “Replace me” placeholder with the Node you want to apply the retry logic on</li>\n<li>Follow the sticky notes for more instructions and optional settings</li>\n</ul>\n</div><!--]-->",
  "readme_zh": "## 目的\n\n本工作流片段实现了重试机制中的高级错误捕获功能。\n\n某些场景下，您需要先检查项目是否存在以决定后续操作。但部分API（例如Todoist的已完成任务接口）未提供专用查询端点，此时通常需依赖错误分支处理——然而这与重试功能结合使用时效果欠佳。\n\n## 运行原理\n\n* 采用自定义循环替代节点的内置重试功能，实现迭代间更精细的控制\n* 当主执行节点失败时，可筛选预期错误并触发特定操作\n* 仅当发生非预期错误时才会执行重试\n* 仅当超过预设重试次数时工作流才会终止\n\n## 配置步骤\n\n* 将节点复制到现有工作流中\n* 将\"Replace me\"占位节点替换为需要应用重试逻辑的目标节点\n* 参照便签注释获取更多配置说明及可选设置",
  "title_zh": "失败时重试（已知错误除外）",
  "publish_date_zh": "最后更新于4个月前",
  "workflow_json_zh": "{\"id\":\"qAzZekQuABuH8uho\",\"meta\":{\"instanceId\":\"fb8bc2e315f7f03c97140b30aa454a27bc7883a19000fa1da6e6b571bf56ad6d\"},\"name\":\"Retry on fail except for known error Template\",\"tags\":[],\"nodes\":[{\"id\":\"fa6fb462-8c1b-4cab-a9f6-876e67688786\",\"name\":\"Retry limit reached\",\"type\":\"n8n-nodes-base.stopAndError\",\"position\":[-940,500],\"parameters\":{\"errorMessage\":\"Retry limit reached\"},\"typeVersion\":1},{\"id\":\"9627165d-1854-4a4f-b840-721f8d779b89\",\"name\":\"Set tries\",\"type\":\"n8n-nodes-base.set\",\"position\":[-940,260],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"cd93a7f6-4c06-4e8a-8d0d-e812c5ec4bc5\",\"name\":\"tries\",\"type\":\"number\",\"value\":\"={{ $json.tries || 0 }}\"}]},\"includeOtherFields\":true},\"typeVersion\":3.4},{\"id\":\"466efd16-4922-4e61-bc81-d8e8a1d8ea61\",\"name\":\"Update tries\",\"type\":\"n8n-nodes-base.set\",\"position\":[-60,500],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"df3c9b29-afa6-4e08-868d-5b7e8202eefa\",\"name\":\"tries\",\"type\":\"number\",\"value\":\"={{ $('Set tries').item.json.tries + 1 }}\"}]}},\"typeVersion\":3.4},{\"id\":\"a787761f-0a9d-4834-9a65-ac3b9a65b23e\",\"name\":\"Wait\",\"type\":\"n8n-nodes-base.wait\",\"position\":[-280,500],\"webhookId\":\"9d3b561f-4afd-478c-8f6e-60641d4f1d0b\",\"parameters\":{},\"typeVersion\":1.1},{\"id\":\"ff46ce53-69ca-4f88-8cc9-21b8d1e5557a\",\"name\":\"Catch known error\",\"type\":\"n8n-nodes-base.if\",\"position\":[-500,380],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"6a379b06-0b04-4ae4-9bf9-394bd40744b7\",\"operator\":{\"type\":\"string\",\"operation\":\"contains\"},\"leftValue\":\"={{ $json.error }}\",\"rightValue\":\"could not be found\"}]}},\"typeVersion\":2.2},{\"id\":\"0e9c282a-b521-4549-8ad5-9783b4d614b3\",\"name\":\"Replace Me\",\"type\":\"n8n-nodes-base.noOp\",\"onError\":\"continueErrorOutput\",\"position\":[-720,260],\"parameters\":{},\"typeVersion\":1},{\"id\":\"3b2b6839-65b9-4b0e-8e10-2010014fc8d9\",\"name\":\"Success\",\"type\":\"n8n-nodes-base.noOp\",\"position\":[-500,140],\"parameters\":{},\"typeVersion\":1},{\"id\":\"8d972714-8dcb-4ad6-8b5f-fb30a5f3294f\",\"name\":\"Known Error\",\"type\":\"n8n-nodes-base.noOp\",\"position\":[-280,260],\"parameters\":{},\"typeVersion\":1},{\"id\":\"e98cdc4a-73a4-41d1-bf5e-2a3bcfbf23af\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-560,280],\"parameters\":{\"width\":220,\"height\":240,\"content\":\"## 设置过滤器\\n按状态码或错误信息进行筛选。\"},\"typeVersion\":1},{\"id\":\"e5b76cd3-d90a-4d4b-a659-ff142558cbac\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-780,80],\"parameters\":{\"width\":220,\"height\":320,\"content\":\"## 替换节点  \\n将此节点替换为用于获取所需数据的节点。  \\n在节点设置中启用错误分支，并按照此示例连接输出。\"},\"typeVersion\":1},{\"id\":\"7ca409e6-7faf-48d5-972e-abbba3f011ef\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-1220,420],\"parameters\":{\"width\":220,\"height\":220,\"content\":\"## 设置最大尝试次数\\n根据需要修改，默认为3次\"},\"typeVersion\":1},{\"id\":\"a13168eb-c4d1-46dd-857b-9a5e13ed1059\",\"name\":\"Manual Trigger\",\"type\":\"n8n-nodes-base.manualTrigger\",\"position\":[-1160,260],\"parameters\":{},\"typeVersion\":1},{\"id\":\"44c17908-96df-471b-97fc-9ce4c3acb3bb\",\"name\":\"Sticky Note3\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-340,400],\"parameters\":{\"width\":220,\"height\":240,\"content\":\"## 设置等待时间\\n根据需要调整持续时间，默认为5秒\"},\"typeVersion\":1},{\"id\":\"da7413f0-7962-4cf1-90ad-168cfc3d4c0d\",\"name\":\"Sticky Note4\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-560,80],\"parameters\":{\"color\":7,\"width\":220,\"height\":200,\"content\":\"继续此处，如果请求成功\"},\"typeVersion\":1},{\"id\":\"e95c4b6a-2c63-4916-a239-91463728262a\",\"name\":\"Sticky Note5\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-340,200],\"parameters\":{\"color\":7,\"width\":220,\"height\":200,\"content\":\"如果请求失败，请在此处继续\"},\"typeVersion\":1},{\"id\":\"8d8f7df0-35e3-4b94-96a3-6d4593732d0e\",\"name\":\"Sticky Note6\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-1000,420],\"parameters\":{\"color\":7,\"width\":220,\"height\":220,\"content\":\"如果所有尝试都已失败，就此停下\"},\"typeVersion\":1},{\"id\":\"893b3e51-f30f-4e2f-9e96-e1fc6f8dd0a3\",\"name\":\"Sticky Note7\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-1000,200],\"parameters\":{\"color\":7,\"width\":220,\"height\":220,\"content\":\"定义尝试计数器\"},\"typeVersion\":1},{\"id\":\"cd1b1abb-dbd3-4023-8a6b-49c4ff5510a8\",\"name\":\"If tries left\",\"type\":\"n8n-nodes-base.if\",\"position\":[-1160,500],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"b18f784a-4386-4ced-a9e1-ce5a21ad036e\",\"operator\":{\"type\":\"number\",\"operation\":\"lt\"},\"leftValue\":\"={{ $json.tries }}\",\"rightValue\":3}]}},\"typeVersion\":2.2},{\"id\":\"ccce734b-c726-4b0a-9d37-7bd6df90e840\",\"name\":\"Sticky Note8\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-120,440],\"parameters\":{\"color\":7,\"width\":220,\"height\":220,\"content\":\"尝试次数计数器更新\"},\"typeVersion\":1}],\"active\":false,\"pinData\":{},\"settings\":{\"executionOrder\":\"v1\"},\"versionId\":\"ad610eea-ad27-4a3b-b662-edea474bc5ff\",\"connections\":{\"Wait\":{\"main\":[[{\"node\":\"Update tries\",\"type\":\"main\",\"index\":0}]]},\"Set tries\":{\"main\":[[{\"node\":\"Replace Me\",\"type\":\"main\",\"index\":0}]]},\"Replace Me\":{\"main\":[[{\"node\":\"Success\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Catch known error\",\"type\":\"main\",\"index\":0}]]},\"Update tries\":{\"main\":[[{\"node\":\"If tries left\",\"type\":\"main\",\"index\":0}]]},\"If tries left\":{\"main\":[[{\"node\":\"Set tries\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Retry limit reached\",\"type\":\"main\",\"index\":0}]]},\"Manual Trigger\":{\"main\":[[{\"node\":\"Set tries\",\"type\":\"main\",\"index\":0}]]},\"Catch known error\":{\"main\":[[{\"node\":\"Known Error\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Wait\",\"type\":\"main\",\"index\":0}]]}}}"
}