{
  "title": "Archive empty pages in Notion database",
  "url": "https://n8n.io/workflows/1478-archive-empty-pages-in-notion-database/",
  "category": "BuildingBlocks",
  "category_url": "https://n8n.io/workflows/categories/building-blocks/?sort=createdAt:desc",
  "author": "Jonathan",
  "publish_date": "Last update 10 months ago",
  "publish_date_absolute": "2024-07-06",
  "content": "",
  "workflow_json": "{\"id\":115,\"name\":\"Archive empty pages in Notion Database\",\"nodes\":[{\"name\":\"Get All Databases\",\"type\":\"n8n-nodes-base.notion\",\"position\":[240,300],\"parameters\":{\"resource\":\"database\",\"operation\":\"getAll\",\"returnAll\":true},\"credentials\":{\"notionApi\":{\"id\":\"36\",\"name\":\"Notion account\"}},\"typeVersion\":2},{\"name\":\"Get All Database Pages\",\"type\":\"n8n-nodes-base.notion\",\"position\":[420,300],\"parameters\":{\"simple\":false,\"options\":{},\"resource\":\"databasePage\",\"operation\":\"getAll\",\"returnAll\":true,\"databaseId\":\"={{$json[\\\"id\\\"]}}\"},\"credentials\":{\"notionApi\":{\"id\":\"36\",\"name\":\"Notion account\"}},\"typeVersion\":2},{\"name\":\"Get Page Blocks\",\"type\":\"n8n-nodes-base.notion\",\"position\":[1180,280],\"parameters\":{\"blockId\":\"={{$json[\\\"id\\\"]}}\",\"resource\":\"block\",\"operation\":\"getAll\",\"returnAll\":true},\"credentials\":{\"notionApi\":{\"id\":\"36\",\"name\":\"Notion account\"}},\"typeVersion\":2,\"alwaysOutputData\":true},{\"name\":\"Process Blocks\",\"type\":\"n8n-nodes-base.function\",\"position\":[1360,280],\"parameters\":{\"functionCode\":\"let returnData = {\\n  json: {\\n    toDelete: false,\\n    pageID: $node[\\\"SplitInBatches\\\"].json[\\\"id\\\"],\\n  }\\n};\\n\\nif (!items[0].json.id) {\\n  returnData.json.toDelete = true;\\n  return [returnData];\\n}\\n\\nfor (item of items) {\\n  \\n  let toDelete = false;\\n\\n  let type = item.json.type;\\n  let data = item.json[type];\\n\\n  if (!toDelete) {\\n    if (data.text.length == 0) {\\n      toDelete = true;\\n    } else {\\n      returnData.json.toDelete = false;\\n      break;\\n    }\\n  }\\n\\n  returnData.json.toDelete = toDelete;\\n}\\n\\nreturn [returnData];\"},\"typeVersion\":1},{\"name\":\"SplitInBatches\",\"type\":\"n8n-nodes-base.splitInBatches\",\"position\":[1000,280],\"parameters\":{\"options\":{},\"batchSize\":1},\"typeVersion\":1},{\"name\":\"Check for empty properties\",\"type\":\"n8n-nodes-base.function\",\"position\":[600,300],\"parameters\":{\"functionCode\":\"for (item of items) {\\n\\n  let toDelete = false;\\n  for (const key in item.json.properties) {\\n    let type = item.json.properties[key].type;\\n    let data = item.json.properties[key][type];\\n    \\n    if (!data || data.length == 0) {\\n      toDelete = true;\\n    } else {\\n      toDelete = false;\\n      break;\\n    }\\n  }\\n\\n  item.json.toDelete = toDelete;\\n}\\n\\nreturn items;\"},\"typeVersion\":1},{\"name\":\"Archive Page\",\"type\":\"n8n-nodes-base.notion\",\"position\":[1760,260],\"parameters\":{\"pageId\":\"={{$json[\\\"pageID\\\"]}}\",\"operation\":\"archive\"},\"credentials\":{\"notionApi\":{\"id\":\"36\",\"name\":\"Notion account\"}},\"typeVersion\":2},{\"name\":\"If toDelete\",\"type\":\"n8n-nodes-base.if\",\"position\":[1560,280],\"parameters\":{\"conditions\":{\"boolean\":[{\"value1\":\"={{$json[\\\"toDelete\\\"]}}\",\"value2\":true}]}},\"typeVersion\":1},{\"name\":\"If Empty Properties\",\"type\":\"n8n-nodes-base.if\",\"position\":[760,300],\"parameters\":{\"conditions\":{\"boolean\":[{\"value1\":\"={{$json[\\\"toDelete\\\"]}}\",\"value2\":true}]}},\"typeVersion\":1},{\"name\":\"Every day @ 2am\",\"type\":\"n8n-nodes-base.cron\",\"position\":[80,300],\"parameters\":{\"triggerTimes\":{\"item\":[{\"hour\":2}]}},\"typeVersion\":1}],\"active\":false,\"settings\":{},\"connections\":{\"If toDelete\":{\"main\":[[{\"node\":\"Archive Page\",\"type\":\"main\",\"index\":0}]]},\"Process Blocks\":{\"main\":[[{\"node\":\"If toDelete\",\"type\":\"main\",\"index\":0},{\"node\":\"SplitInBatches\",\"type\":\"main\",\"index\":0}]]},\"SplitInBatches\":{\"main\":[[{\"node\":\"Get Page Blocks\",\"type\":\"main\",\"index\":0}]]},\"Every day @ 2am\":{\"main\":[[{\"node\":\"Get All Databases\",\"type\":\"main\",\"index\":0}]]},\"Get Page Blocks\":{\"main\":[[{\"node\":\"Process Blocks\",\"type\":\"main\",\"index\":0}]]},\"Get All Databases\":{\"main\":[[{\"node\":\"Get All Database Pages\",\"type\":\"main\",\"index\":0}]]},\"If Empty Properties\":{\"main\":[[{\"node\":\"SplitInBatches\",\"type\":\"main\",\"index\":0}]]},\"Get All Database Pages\":{\"main\":[[{\"node\":\"Check for empty properties\",\"type\":\"main\",\"index\":0}]]},\"Check for empty properties\":{\"main\":[[{\"node\":\"If Empty Properties\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "This workflow will archive empty pages in your Notion databases, Add your n8n integration to the Notion databases that you want to process.\n\nTo configure this workflow set the Notion credentials in the 4 Notion nodes and if needed change the time in the Cron node, The default is to run at 2am every day.\n",
  "readme_html": "<!--[--><div data-v-50766329=\"\"><p>This workflow will archive empty pages in your Notion databases, Add your n8n integration to the Notion databases that you want to process.</p>\n<p>To configure this workflow set the Notion credentials in the 4 Notion nodes and if needed change the time in the Cron node, The default is to run at 2am every day.</p>\n</div><!--]-->",
  "readme_zh": "此工作流程将归档您Notion数据库中的空白页面，请将您的n8n集成添加至需要处理的Notion数据库中。\n\n配置此工作流程时，请在4个Notion节点中设置Notion凭证，如有需要可调整Cron节点中的时间，默认设置为每日凌晨2点运行。",
  "title_zh": "在Notion数据库中归档空白页面",
  "publish_date_zh": "最后更新于10个月前",
  "workflow_json_zh": "{\n  \"id\": 115,\n  \"name\": \"Archive empty pages in Notion Database\",\n  \"nodes\": [\n    {\n      \"name\": \"Get All Databases\",\n      \"type\": \"n8n-nodes-base.notion\",\n      \"position\": [\n        240,\n        300\n      ],\n      \"parameters\": {\n        \"resource\": \"database\",\n        \"operation\": \"getAll\",\n        \"returnAll\": true\n      },\n      \"credentials\": {\n        \"notionApi\": {\n          \"id\": \"36\",\n          \"name\": \"Notion account\"\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"name\": \"Get All Database Pages\",\n      \"type\": \"n8n-nodes-base.notion\",\n      \"position\": [\n        420,\n        300\n      ],\n      \"parameters\": {\n        \"simple\": false,\n        \"options\": {},\n        \"resource\": \"databasePage\",\n        \"operation\": \"getAll\",\n        \"returnAll\": true,\n        \"databaseId\": \"={{$json[\\\"id\\\"]}}\"\n      },\n      \"credentials\": {\n        \"notionApi\": {\n          \"id\": \"36\",\n          \"name\": \"Notion account\"\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"name\": \"Get Page Blocks\",\n      \"type\": \"n8n-nodes-base.notion\",\n      \"position\": [\n        1180,\n        280\n      ],\n      \"parameters\": {\n        \"blockId\": \"={{$json[\\\"id\\\"]}}\",\n        \"resource\": \"block\",\n        \"operation\": \"getAll\",\n        \"returnAll\": true\n      },\n      \"credentials\": {\n        \"notionApi\": {\n          \"id\": \"36\",\n          \"name\": \"Notion account\"\n        }\n      },\n      \"typeVersion\": 2,\n      \"alwaysOutputData\": true\n    },\n    {\n      \"name\": \"Process Blocks\",\n      \"type\": \"n8n-nodes-base.function\",\n      \"position\": [\n        1360,\n        280\n      ],\n      \"parameters\": {\n        \"functionCode\": \"let returnData = {\\n  json: {\\n    toDelete: false,\\n    pageID: $node[\\\"SplitInBatches\\\"].json[\\\"id\\\"],\\n  }\\n};\\n\\nif (!items[0].json.id) {\\n  returnData.json.toDelete = true;\\n  return [returnData];\\n}\\n\\nfor (item of items) {\\n  \\n  let toDelete = false;\\n\\n  let type = item.json.type;\\n  let data = item.json[type];\\n\\n  if (!toDelete) {\\n    if (data.text.length == 0) {\\n      toDelete = true;\\n    } else {\\n      returnData.json.toDelete = false;\\n      break;\\n    }\\n  }\\n\\n  returnData.json.toDelete = toDelete;\\n}\\n\\nreturn [returnData];\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"SplitInBatches\",\n      \"type\": \"n8n-nodes-base.splitInBatches\",\n      \"position\": [\n        1000,\n        280\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"batchSize\": 1\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Check for empty properties\",\n      \"type\": \"n8n-nodes-base.function\",\n      \"position\": [\n        600,\n        300\n      ],\n      \"parameters\": {\n        \"functionCode\": \"for (item of items) {\\n\\n  let toDelete = false;\\n  for (const key in item.json.properties) {\\n    let type = item.json.properties[key].type;\\n    let data = item.json.properties[key][type];\\n    \\n    if (!data || data.length == 0) {\\n      toDelete = true;\\n    } else {\\n      toDelete = false;\\n      break;\\n    }\\n  }\\n\\n  item.json.toDelete = toDelete;\\n}\\n\\nreturn items;\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Archive Page\",\n      \"type\": \"n8n-nodes-base.notion\",\n      \"position\": [\n        1760,\n        260\n      ],\n      \"parameters\": {\n        \"pageId\": \"={{$json[\\\"pageID\\\"]}}\",\n        \"operation\": \"archive\"\n      },\n      \"credentials\": {\n        \"notionApi\": {\n          \"id\": \"36\",\n          \"name\": \"Notion account\"\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"name\": \"If toDelete\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        1560,\n        280\n      ],\n      \"parameters\": {\n        \"conditions\": {\n          \"boolean\": [\n            {\n              \"value1\": \"={{$json[\\\"toDelete\\\"]}}\",\n              \"value2\": true\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"If Empty Properties\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        760,\n        300\n      ],\n      \"parameters\": {\n        \"conditions\": {\n          \"boolean\": [\n            {\n              \"value1\": \"={{$json[\\\"toDelete\\\"]}}\",\n              \"value2\": true\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Every day @ 2am\",\n      \"type\": \"n8n-nodes-base.cron\",\n      \"position\": [\n        80,\n        300\n      ],\n      \"parameters\": {\n        \"triggerTimes\": {\n          \"item\": [\n            {\n              \"hour\": 2\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"active\": false,\n  \"settings\": {},\n  \"connections\": {\n    \"If toDelete\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Archive Page\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Process Blocks\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"If toDelete\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"SplitInBatches\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"SplitInBatches\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get Page Blocks\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Every day @ 2am\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get All Databases\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get Page Blocks\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Process Blocks\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get All Databases\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get All Database Pages\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"If Empty Properties\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"SplitInBatches\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get All Database Pages\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Check for empty properties\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Check for empty properties\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"If Empty Properties\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}