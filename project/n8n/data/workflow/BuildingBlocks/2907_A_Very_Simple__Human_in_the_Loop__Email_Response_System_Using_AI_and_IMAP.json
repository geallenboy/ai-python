{
  "title": "A Very Simple \"Human in the Loop\" Email Response System Using AI and IMAP",
  "url": "https://n8n.io/workflows/2907-a-very-simple-human-in-the-loop-email-response-system-using-ai-and-imap/",
  "category": "BuildingBlocks",
  "category_url": "https://n8n.io/workflows/categories/building-blocks/?sort=createdAt:desc",
  "author": "Davide",
  "publish_date": "Last update 3 months ago",
  "publish_date_absolute": "2025-02-06",
  "content": "",
  "workflow_json": "{\"id\":\"Nvn78tMRNnKji7Fg\",\"meta\":{\"instanceId\":\"a4bfc93e975ca233ac45ed7c9227d84cf5a2329310525917adaf3312e10d5462\",\"templateCredsSetupCompleted\":true},\"name\":\"Very simple Human in the loop system email with AI e IMAP\",\"tags\":[],\"nodes\":[{\"id\":\"271bb16f-9b62-41d9-ab76-114cd7ba915a\",\"name\":\"Email Trigger (IMAP)\",\"type\":\"n8n-nodes-base.emailReadImap\",\"position\":[-1300,1340],\"parameters\":{\"options\":{}},\"credentials\":{\"imap\":{\"id\":\"k31W9oGddl9pMDy4\",\"name\":\"IMAP info@n3witalia.com\"}},\"typeVersion\":2},{\"id\":\"42d150d8-d574-49f9-9c0e-71a2cdea3b79\",\"name\":\"Markdown\",\"type\":\"n8n-nodes-base.markdown\",\"position\":[-1040,1340],\"parameters\":{\"html\":\"={{ $json.textHtml }}\",\"options\":{}},\"typeVersion\":1},{\"id\":\"e9498a60-0078-4581-b269-7ff552f4047a\",\"name\":\"Send Email\",\"type\":\"n8n-nodes-base.emailSend\",\"position\":[920,1320],\"webhookId\":\"a79ae1b4-648c-4cb4-b6cd-04ea3c1d9314\",\"parameters\":{\"html\":\"={{ $('Set Email text').item.json.email }}\",\"options\":{},\"subject\":\"=Re: {{ $('Email Trigger (IMAP)').item.json.subject }}\",\"toEmail\":\"={{ $('Email Trigger (IMAP)').item.json.from }}\",\"fromEmail\":\"={{ $('Email Trigger (IMAP)').item.json.to }}\"},\"credentials\":{\"smtp\":{\"id\":\"hRjP3XbDiIQqvi7x\",\"name\":\"SMTP info@n3witalia.com\"}},\"typeVersion\":2.1},{\"id\":\"ab9f6ac3-2095-44df-aeba-2eab96ecf425\",\"name\":\"Email Summarization Chain\",\"type\":\"@n8n/n8n-nodes-langchain.chainSummarization\",\"position\":[-780,1340],\"parameters\":{\"options\":{\"binaryDataKey\":\"={{ $json.data }}\",\"summarizationMethodAndPrompts\":{\"values\":{\"prompt\":\"=Write a concise summary of the following in max 100 words:\\n\\n\\\"{{ $json.data }}\\\"\\n\\nDo not enter the total number of words used.\",\"combineMapPrompt\":\"=Write a concise summary of the following in max 100 words:\\n\\n\\\"{{ $json.data }}\\\"\\n\\nDo not enter the total number of words used.\"}}},\"operationMode\":\"nodeInputBinary\"},\"typeVersion\":2},{\"id\":\"86b7c3d0-e1f2-4e2f-b293-8042700d6816\",\"name\":\"Write email\",\"type\":\"@n8n/n8n-nodes-langchain.agent\",\"position\":[-340,1340],\"parameters\":{\"text\":\"=Write the text to reply to the following email:\\n\\n{{ $json.response.text }}\",\"options\":{\"systemMessage\":\"You are an expert at answering emails. You need to answer them professionally based on the information you have. This is a business email. Be concise and never exceed 100 words. Only the body of the email, not create the subject\"},\"promptType\":\"define\",\"hasOutputParser\":true},\"typeVersion\":1.7},{\"id\":\"5d5a397f-f9c3-4691-afd0-9a6102679eac\",\"name\":\"OpenAI\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\"position\":[-400,1560],\"parameters\":{\"model\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"gpt-4o-mini\",\"cachedResultName\":\"gpt-4o-mini\"},\"options\":{}},\"credentials\":{\"openAiApi\":{\"id\":\"CDX6QM4gLYanh0P4\",\"name\":\"OpenAi account\"}},\"typeVersion\":1.2},{\"id\":\"5b36a295-fda6-4174-9078-0a8ec57620d2\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-800,1260],\"parameters\":{\"width\":320,\"height\":240,\"content\":\"Chain that summarizes the received email\"},\"typeVersion\":1},{\"id\":\"7110fe1f-0099-49aa-9095-96e733aa468f\",\"name\":\"Sticky Note5\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-360,1260],\"parameters\":{\"width\":340,\"height\":240,\"content\":\"Agent that retrieves business information from a vector database and processes the response\"},\"typeVersion\":1},{\"id\":\"e2bdbd64-3c37-4867-ae2c-0f6937d82b81\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-1100,1260],\"parameters\":{\"height\":240,\"content\":\"Convert email to Markdown format for better understanding of LLM models\"},\"typeVersion\":1},{\"id\":\"8ae5d216-5897-4c33-800a-27ff939b174a\",\"name\":\"Sticky Note7\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[620,1300],\"parameters\":{\"height\":180,\"content\":\"If the feedback is OK send email\"},\"typeVersion\":1},{\"id\":\"4cfce63c-5931-45c5-99ca-eb85dca962b5\",\"name\":\"Approve Email\",\"type\":\"n8n-nodes-base.emailSend\",\"position\":[380,1340],\"webhookId\":\"4f9f06e7-9b2b-4896-9b51-245972341d12\",\"parameters\":{\"message\":\"=<h3>MESSAGE</h3>\\n{{ $('Email Trigger (IMAP)').item.json.textHtml }}\\n\\n<h3>AI RESPONSE</h3>\\n{{ $json.email }}\",\"options\":{},\"subject\":\"=[Approval Required]  {{ $('Email Trigger (IMAP)').item.json.subject }}\",\"toEmail\":\"info@n3witalia.com\",\"fromEmail\":\"info@n3witalia.com\",\"operation\":\"sendAndWait\"},\"credentials\":{\"smtp\":{\"id\":\"hRjP3XbDiIQqvi7x\",\"name\":\"SMTP info@n3witalia.com\"}},\"typeVersion\":2.1},{\"id\":\"d6c8acd2-ebc1-4aaa-bfcc-cdb18fcc8715\",\"name\":\"OpenAI Chat Model\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\"position\":[-820,1560],\"parameters\":{\"model\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"deepseek-chat\",\"cachedResultName\":\"deepseek-chat\"},\"options\":{}},\"credentials\":{\"openAiApi\":{\"id\":\"97Cz4cqyiy1RdcQL\",\"name\":\"DeepSeek\"}},\"typeVersion\":1.2},{\"id\":\"33bbedeb-129a-4e99-ab5a-9e0ec4456156\",\"name\":\"Set Email text\",\"type\":\"n8n-nodes-base.set\",\"position\":[100,1340],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"35d7c303-42f4-4dd1-b41e-6eb087c23c3d\",\"name\":\"email\",\"type\":\"string\",\"value\":\"={{ $json.output }}\"}]}},\"typeVersion\":3.4},{\"id\":\"2293e0e6-4f2a-4622-a610-64b65f34e1e5\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[320,1300],\"parameters\":{\"height\":180,\"content\":\"Human in the loop\"},\"typeVersion\":1},{\"id\":\"510196ec-adaf-4e6c-aac0-8ca8b754438a\",\"name\":\"Sticky Note11\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-1100,940],\"parameters\":{\"color\":3,\"width\":540,\"height\":260,\"content\":\"# How it works\\nThis workflow automates the handling of incoming emails, summarizes their content, generates appropriate responses and validate it through send IMAP email with \\\"Human in the loop\\\" system. \\n\\nYou can quickly integrate Gmail and Outlook via the appropriate nodes\"},\"typeVersion\":1},{\"id\":\"c4c9157d-4d05-47a1-a5eb-63865e838d39\",\"name\":\"Approved?\",\"type\":\"n8n-nodes-base.if\",\"position\":[680,1340],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"62e26bc5-1732-4699-a602-99490c7406fd\",\"operator\":{\"type\":\"boolean\",\"operation\":\"true\",\"singleValue\":true},\"leftValue\":\"={{ $json.data.approved }}\",\"rightValue\":\"\"}]}},\"typeVersion\":2.2}],\"active\":false,\"pinData\":{},\"settings\":{\"executionOrder\":\"v1\"},\"versionId\":\"47e79286-00f4-48e8-a0d1-e0f56d9ba0d5\",\"connections\":{\"OpenAI\":{\"ai_languageModel\":[[{\"node\":\"Write email\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"Markdown\":{\"main\":[[{\"node\":\"Email Summarization Chain\",\"type\":\"main\",\"index\":0}]]},\"Approved?\":{\"main\":[[{\"node\":\"Send Email\",\"type\":\"main\",\"index\":0}],[]]},\"Write email\":{\"main\":[[{\"node\":\"Set Email text\",\"type\":\"main\",\"index\":0}]]},\"Approve Email\":{\"main\":[[{\"node\":\"Approved?\",\"type\":\"main\",\"index\":0}]]},\"Set Email text\":{\"main\":[[{\"node\":\"Approve Email\",\"type\":\"main\",\"index\":0}]]},\"OpenAI Chat Model\":{\"ai_languageModel\":[[{\"node\":\"Email Summarization Chain\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"Email Trigger (IMAP)\":{\"main\":[[{\"node\":\"Markdown\",\"type\":\"main\",\"index\":0}]]},\"Email Summarization Chain\":{\"main\":[[{\"node\":\"Write email\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "### **Functionality**\n\nThis workflow automates the handling of incoming emails by summarizing their content, generating appropriate responses, and validating the responses through a \"Human-in-the-Loop\" system. It integrates with IMAP email services (e.g., Gmail, Outlook) and uses AI models to streamline the email response process.\n\nThe workflow ensures that all AI-generated responses are reviewed by a human before being sent, maintaining a high level of professionalism and accuracy. This approach is particularly useful for businesses that receive a high volume of emails and need to respond quickly while ensuring quality control.\n\n* * *\n\n### **How It Works**\n\n  1. **Email Trigger** :\n\n     * The workflow starts with the **Email Trigger (IMAP)** node, which monitors an email inbox for new messages. When a new email arrives, it triggers the workflow.\n  2. **Email Preprocessing** :\n\n     * The **Markdown** node converts the email's HTML content into plain text for easier processing by the AI models.\n  3. **Email Summarization** :\n\n     * The **Email Summarization Chain** node uses an AI model (OpenAI) to generate a concise summary of the email. The summary is limited to 100 words and is written in a professional tone.\n  4. **Email Response Generation** :\n\n     * The **Write email** node uses an AI model (OpenAI) to draft a professional response to the email. The response is based on the email content and is limited to 100 words.\n  5. **Human-in-the-Loop Approval** :\n\n     * The **Set Email text** node prepares the drafted response for approval.\n     * The **Approve Email** node sends the drafted response to a human approver (e.g., an internal email address) for review. The email includes: \n       * The original message.\n       * The AI-generated response.\n     * The **Approved?** node checks if the response has been approved by the human reviewer. If approved, the workflow proceeds to send the response; otherwise, it stops.\n  6. **Sending the Response** :\n\n     * The **Send Email** node sends the approved response back to the original sender.\n\n\n\n* * *\n\n### **Key Features**\n\n  * **Automated Email Summarization** : Summarizes incoming emails to provide a quick overview of the content.\n  * **AI-Powered Response Generation** : Drafts professional responses to emails using AI.\n  * **Human-in-the-Loop Approval** : Ensures all AI-generated responses are reviewed and approved by a human before being sent.\n  * **IMAP Integration** : Works with IMAP email services like Gmail and Outlook.\n  * **Efficient Email Management** : Reduces the time and effort required to handle incoming emails while maintaining high-quality responses.\n\n\n\nThis workflow is ideal for businesses looking to automate their email response process while maintaining control over the quality of outgoing communications. It leverages AI to handle repetitive tasks and ensures that all responses are reviewed by a human, providing a balance between automation and human oversight.\n",
  "readme_html": "<!--[--><div data-v-50766329=\"\"><h3><strong>Functionality</strong></h3>\n<p>This workflow automates the handling of incoming emails by summarizing their content, generating appropriate responses, and validating the responses through a \"Human-in-the-Loop\" system. It integrates with IMAP email services (e.g., Gmail, Outlook) and uses AI models to streamline the email response process.</p>\n<p>The workflow ensures that all AI-generated responses are reviewed by a human before being sent, maintaining a high level of professionalism and accuracy. This approach is particularly useful for businesses that receive a high volume of emails and need to respond quickly while ensuring quality control.</p>\n<hr>\n<h3><strong>How It Works</strong></h3>\n<ol>\n<li>\n<p><strong>Email Trigger</strong>:</p>\n<ul>\n<li>The workflow starts with the <strong>Email Trigger (IMAP)</strong> node, which monitors an email inbox for new messages. When a new email arrives, it triggers the workflow.</li>\n</ul>\n</li>\n<li>\n<p><strong>Email Preprocessing</strong>:</p>\n<ul>\n<li>The <strong>Markdown</strong> node converts the email's HTML content into plain text for easier processing by the AI models.</li>\n</ul>\n</li>\n<li>\n<p><strong>Email Summarization</strong>:</p>\n<ul>\n<li>The <strong>Email Summarization Chain</strong> node uses an AI model (OpenAI) to generate a concise summary of the email. The summary is limited to 100 words and is written in a professional tone.</li>\n</ul>\n</li>\n<li>\n<p><strong>Email Response Generation</strong>:</p>\n<ul>\n<li>The <strong>Write email</strong> node uses an AI model (OpenAI) to draft a professional response to the email. The response is based on the email content and is limited to 100 words.</li>\n</ul>\n</li>\n<li>\n<p><strong>Human-in-the-Loop Approval</strong>:</p>\n<ul>\n<li>The <strong>Set Email text</strong> node prepares the drafted response for approval.</li>\n<li>The <strong>Approve Email</strong> node sends the drafted response to a human approver (e.g., an internal email address) for review. The email includes:\n<ul>\n<li>The original message.</li>\n<li>The AI-generated response.</li>\n</ul>\n</li>\n<li>The <strong>Approved?</strong> node checks if the response has been approved by the human reviewer. If approved, the workflow proceeds to send the response; otherwise, it stops.</li>\n</ul>\n</li>\n<li>\n<p><strong>Sending the Response</strong>:</p>\n<ul>\n<li>The <strong>Send Email</strong> node sends the approved response back to the original sender.</li>\n</ul>\n</li>\n</ol>\n<hr>\n<h3><strong>Key Features</strong></h3>\n<ul>\n<li><strong>Automated Email Summarization</strong>: Summarizes incoming emails to provide a quick overview of the content.</li>\n<li><strong>AI-Powered Response Generation</strong>: Drafts professional responses to emails using AI.</li>\n<li><strong>Human-in-the-Loop Approval</strong>: Ensures all AI-generated responses are reviewed and approved by a human before being sent.</li>\n<li><strong>IMAP Integration</strong>: Works with IMAP email services like Gmail and Outlook.</li>\n<li><strong>Efficient Email Management</strong>: Reduces the time and effort required to handle incoming emails while maintaining high-quality responses.</li>\n</ul>\n<p>This workflow is ideal for businesses looking to automate their email response process while maintaining control over the quality of outgoing communications. It leverages AI to handle repetitive tasks and ensures that all responses are reviewed by a human, providing a balance between automation and human oversight.</p>\n</div><!--]-->",
  "readme_zh": "### **功能概述**\n\n该工作流通过自动总结邮件内容、生成恰当回复并经由\"人工介入\"系统验证回复内容，实现高效处理接收邮件的自动化流程。它集成IMAP邮件服务（如Gmail、Outlook），利用AI模型简化邮件回复流程。\n\n工作流确保所有AI生成的回复在发送前均经过人工审核，保持专业性与准确性。此方案特别适合需要快速处理大量邮件，同时需严格把控回复质量的商业场景。\n\n* * *\n\n### **运作流程**\n\n  1. **邮件触发** :\n     * **邮件触发器(IMAP)**节点持续监控收件箱，新邮件到达时触发工作流\n  2. **邮件预处理** :\n     * **Markdown**节点将HTML格式的邮件内容转换为纯文本，便于AI模型处理\n  3. **邮件摘要生成** :\n     * **邮件摘要链**节点调用AI模型(OpenAI)生成专业风格的邮件摘要，内容限制在100词以内\n  4. **邮件回复生成** :\n     * **撰写邮件**节点基于邮件内容，使用AI模型(OpenAI)起草专业回复，字数限制100词\n  5. **人工审核机制** :\n     * **设置邮件文本**节点准备待审核的回复草稿\n     * **审核邮件**节点将包含以下内容的审核请求发送至指定人员（如内部邮箱）:\n       - 原始邮件\n       - AI生成的回复草稿\n     * **审核通过？**节点验证回复是否获得人工批准。通过则继续发送流程，否则终止\n  6. **发送回复** :\n     * **发送邮件**节点将核准后的回复发送至原发件人\n\n* * *\n\n### **核心优势**\n\n  * **智能邮件摘要** : 自动提炼邮件核心内容，快速掌握关键信息\n  * **AI辅助撰写** : 运用人工智能生成专业级邮件回复\n  * **人工审核保障** : 所有AI生成内容必经人工核验方可发出\n  * **IMAP服务兼容** : 支持Gmail、Outlook等主流邮件服务\n  * **高效邮件管理** : 在保证回复质量的前提下，显著降低邮件处理时间成本\n\n本工作流完美契合希望实现邮件回复自动化，同时需要严格把控对外沟通质量的企业需求。通过AI处理重复性工作，结合人工审核机制，在自动化效率与人工监督之间实现理想平衡。",
  "title_zh": "一个非常简单的“人在回路”电子邮件响应系统，结合AI与IMAP技术",
  "publish_date_zh": "最后更新于3个月前",
  "workflow_json_zh": "{\n  \"id\": \"Nvn78tMRNnKji7Fg\",\n  \"meta\": {\n    \"instanceId\": \"a4bfc93e975ca233ac45ed7c9227d84cf5a2329310525917adaf3312e10d5462\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"name\": \"Very simple Human in the loop system email with AI e IMAP\",\n  \"tags\": [],\n  \"nodes\": [\n    {\n      \"id\": \"271bb16f-9b62-41d9-ab76-114cd7ba915a\",\n      \"name\": \"Email Trigger (IMAP)\",\n      \"type\": \"n8n-nodes-base.emailReadImap\",\n      \"position\": [\n        -1300,\n        1340\n      ],\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"imap\": {\n          \"id\": \"k31W9oGddl9pMDy4\",\n          \"name\": \"IMAP info@n3witalia.com\"\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"42d150d8-d574-49f9-9c0e-71a2cdea3b79\",\n      \"name\": \"Markdown\",\n      \"type\": \"n8n-nodes-base.markdown\",\n      \"position\": [\n        -1040,\n        1340\n      ],\n      \"parameters\": {\n        \"html\": \"={{ $json.textHtml }}\",\n        \"options\": {}\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"e9498a60-0078-4581-b269-7ff552f4047a\",\n      \"name\": \"Send Email\",\n      \"type\": \"n8n-nodes-base.emailSend\",\n      \"position\": [\n        920,\n        1320\n      ],\n      \"webhookId\": \"a79ae1b4-648c-4cb4-b6cd-04ea3c1d9314\",\n      \"parameters\": {\n        \"html\": \"={{ $('Set Email text').item.json.email }}\",\n        \"options\": {},\n        \"subject\": \"=Re: {{ $('Email Trigger (IMAP)').item.json.subject }}\",\n        \"toEmail\": \"={{ $('Email Trigger (IMAP)').item.json.from }}\",\n        \"fromEmail\": \"={{ $('Email Trigger (IMAP)').item.json.to }}\"\n      },\n      \"credentials\": {\n        \"smtp\": {\n          \"id\": \"hRjP3XbDiIQqvi7x\",\n          \"name\": \"SMTP info@n3witalia.com\"\n        }\n      },\n      \"typeVersion\": 2.1\n    },\n    {\n      \"id\": \"ab9f6ac3-2095-44df-aeba-2eab96ecf425\",\n      \"name\": \"Email Summarization Chain\",\n      \"type\": \"@n8n/n8n-nodes-langchain.chainSummarization\",\n      \"position\": [\n        -780,\n        1340\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"binaryDataKey\": \"={{ $json.data }}\",\n          \"summarizationMethodAndPrompts\": {\n            \"values\": {\n              \"prompt\": \"=Write a concise summary of the following in max 100 words:\\n\\n\\\"{{ $json.data }}\\\"\\n\\nDo not enter the total number of words used.\",\n              \"combineMapPrompt\": \"=Write a concise summary of the following in max 100 words:\\n\\n\\\"{{ $json.data }}\\\"\\n\\nDo not enter the total number of words used.\"\n            }\n          }\n        },\n        \"operationMode\": \"nodeInputBinary\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"86b7c3d0-e1f2-4e2f-b293-8042700d6816\",\n      \"name\": \"Write email\",\n      \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n      \"position\": [\n        -340,\n        1340\n      ],\n      \"parameters\": {\n        \"text\": \"=Write the text to reply to the following email:\\n\\n{{ $json.response.text }}\",\n        \"options\": {\n          \"systemMessage\": \"You are an expert at answering emails. You need to answer them professionally based on the information you have. This is a business email. Be concise and never exceed 100 words. Only the body of the email, not create the subject\"\n        },\n        \"promptType\": \"define\",\n        \"hasOutputParser\": true\n      },\n      \"typeVersion\": 1.7\n    },\n    {\n      \"id\": \"5d5a397f-f9c3-4691-afd0-9a6102679eac\",\n      \"name\": \"OpenAI\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\n      \"position\": [\n        -400,\n        1560\n      ],\n      \"parameters\": {\n        \"model\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"gpt-4o-mini\",\n          \"cachedResultName\": \"gpt-4o-mini\"\n        },\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"CDX6QM4gLYanh0P4\",\n          \"name\": \"OpenAi account\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"5b36a295-fda6-4174-9078-0a8ec57620d2\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -800,\n        1260\n      ],\n      \"parameters\": {\n        \"width\": 320,\n        \"height\": 240,\n        \"content\": \"总结所收邮件内容的链条\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"7110fe1f-0099-49aa-9095-96e733aa468f\",\n      \"name\": \"Sticky Note5\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -360,\n        1260\n      ],\n      \"parameters\": {\n        \"width\": 340,\n        \"height\": 240,\n        \"content\": \"从向量数据库中检索业务信息并处理响应的代理\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"e2bdbd64-3c37-4867-ae2c-0f6937d82b81\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -1100,\n        1260\n      ],\n      \"parameters\": {\n        \"height\": 240,\n        \"content\": \"将电子邮件转换为Markdown格式以便更好地理解LLM模型\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"8ae5d216-5897-4c33-800a-27ff939b174a\",\n      \"name\": \"Sticky Note7\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        620,\n        1300\n      ],\n      \"parameters\": {\n        \"height\": 180,\n        \"content\": \"如果反馈没问题就发邮件\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"4cfce63c-5931-45c5-99ca-eb85dca962b5\",\n      \"name\": \"Approve Email\",\n      \"type\": \"n8n-nodes-base.emailSend\",\n      \"position\": [\n        380,\n        1340\n      ],\n      \"webhookId\": \"4f9f06e7-9b2b-4896-9b51-245972341d12\",\n      \"parameters\": {\n        \"message\": \"=<h3>MESSAGE</h3>\\n{{ $('Email Trigger (IMAP)').item.json.textHtml }}\\n\\n<h3>AI RESPONSE</h3>\\n{{ $json.email }}\",\n        \"options\": {},\n        \"subject\": \"=[Approval Required]  {{ $('Email Trigger (IMAP)').item.json.subject }}\",\n        \"toEmail\": \"info@n3witalia.com\",\n        \"fromEmail\": \"info@n3witalia.com\",\n        \"operation\": \"sendAndWait\"\n      },\n      \"credentials\": {\n        \"smtp\": {\n          \"id\": \"hRjP3XbDiIQqvi7x\",\n          \"name\": \"SMTP info@n3witalia.com\"\n        }\n      },\n      \"typeVersion\": 2.1\n    },\n    {\n      \"id\": \"d6c8acd2-ebc1-4aaa-bfcc-cdb18fcc8715\",\n      \"name\": \"OpenAI Chat Model\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\n      \"position\": [\n        -820,\n        1560\n      ],\n      \"parameters\": {\n        \"model\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"deepseek-chat\",\n          \"cachedResultName\": \"deepseek-chat\"\n        },\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"97Cz4cqyiy1RdcQL\",\n          \"name\": \"DeepSeek\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"33bbedeb-129a-4e99-ab5a-9e0ec4456156\",\n      \"name\": \"Set Email text\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        100,\n        1340\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"35d7c303-42f4-4dd1-b41e-6eb087c23c3d\",\n              \"name\": \"email\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.output }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"2293e0e6-4f2a-4622-a610-64b65f34e1e5\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        320,\n        1300\n      ],\n      \"parameters\": {\n        \"height\": 180,\n        \"content\": \"人在回路\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"510196ec-adaf-4e6c-aac0-8ca8b754438a\",\n      \"name\": \"Sticky Note11\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -1100,\n        940\n      ],\n      \"parameters\": {\n        \"color\": 3,\n        \"width\": 540,\n        \"height\": 260,\n        \"content\": \"# 工作原理\\n该工作流能自动处理接收的电子邮件，对其内容进行摘要，生成适当的回复，并通过\\\"人工介入\\\"系统发送IMAP邮件进行验证。\\n\\n您可以通过相应节点快速集成Gmail和Outlook\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"c4c9157d-4d05-47a1-a5eb-63865e838d39\",\n      \"name\": \"Approved?\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        680,\n        1340\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"62e26bc5-1732-4699-a602-99490c7406fd\",\n              \"operator\": {\n                \"type\": \"boolean\",\n                \"operation\": \"true\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json.data.approved }}\",\n              \"rightValue\": \"\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    }\n  ],\n  \"active\": false,\n  \"pinData\": {},\n  \"settings\": {\n    \"executionOrder\": \"v1\"\n  },\n  \"versionId\": \"47e79286-00f4-48e8-a0d1-e0f56d9ba0d5\",\n  \"connections\": {\n    \"OpenAI\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"Write email\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Markdown\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Email Summarization Chain\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Approved?\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Send Email\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        []\n      ]\n    },\n    \"Write email\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Set Email text\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Approve Email\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Approved?\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Set Email text\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Approve Email\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"OpenAI Chat Model\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"Email Summarization Chain\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Email Trigger (IMAP)\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Markdown\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Email Summarization Chain\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Write email\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}