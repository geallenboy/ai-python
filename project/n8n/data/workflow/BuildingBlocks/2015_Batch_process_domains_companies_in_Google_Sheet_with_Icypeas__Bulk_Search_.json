{
  "title": "Batch process domains/companies in Google Sheet with Icypeas (Bulk Search)",
  "url": "https://n8n.io/workflows/2015-batch-process-domainscompanies-in-google-sheet-with-icypeas-bulk-search/",
  "category": "BuildingBlocks",
  "category_url": "https://n8n.io/workflows/categories/building-blocks/?sort=createdAt:desc",
  "author": "Corentin Ribeyre",
  "publish_date": "Last update a year ago",
  "publish_date_absolute": "",
  "content": "",
  "workflow_json": "{\"meta\":{\"instanceId\":\"257476b1ef58bf3cb6a46e65fac7ee34a53a5e1a8492d5c6e4da5f87c9b82833\"},\"nodes\":[{\"id\":\"bfbd4299-0c8d-4368-b156-c76602ca068c\",\"name\":\"When clicking \\\"Execute Workflow\\\"\",\"type\":\"n8n-nodes-base.manualTrigger\",\"position\":[640,1700],\"parameters\":{},\"typeVersion\":1},{\"id\":\"40cf87be-d9fc-434b-9099-0151968d2a0b\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[500,1420],\"parameters\":{\"height\":259,\"content\":\"## Domain scan with Icypeas (bulk search)\\n\\n\\nThis workflow demonstrates how to perform domain scans (bulk search) using Icypeas. Visit https://icypeas.com to create your account.\"},\"typeVersion\":1},{\"id\":\"c646dddb-bcd4-4ac8-b08f-e61ec16c99c5\",\"name\":\"Authenticates to your Icypeas account\",\"type\":\"n8n-nodes-base.code\",\"position\":[1140,1700],\"parameters\":{\"jsCode\":\"const API_BASE_URL = \\\"https://app.icypeas.com/api\\\";\\nconst API_PATH = \\\"/bulk-search\\\";\\nconst METHOD = \\\"POST\\\";\\n\\n// Change here\\nconst API_KEY = \\\"PUT_API_KEY_HERE\\\";\\nconst API_SECRET = \\\"PUT_API_SECRET_HERE\\\";\\nconst USER_ID = \\\"PUT_USER_ID_HERE\\\";\\n////////////////\\n\\nconst genSignature = (\\n    url,\\n    method,\\n    secret,\\n    timestamp = new Date().toISOString()\\n) => {\\n    const Crypto = require('crypto');\\n    const payload = `${method}${url}${timestamp}`.toLowerCase();\\n    const sign = Crypto.createHmac(\\\"sha1\\\", secret).update(payload).digest(\\\"hex\\\");\\n\\n    return sign;\\n};\\n\\nconst apiUrl = `${API_BASE_URL}${API_PATH}`;\\n\\nconst data = $input.all().map((x) => [ x.json.company]);\\n$input.first().json.data = data;\\n$input.first().json.api = {\\n  timestamp: new Date().toISOString(),\\n  secret: API_SECRET,\\n  key: API_KEY,\\n  userId: USER_ID,\\n  url: apiUrl,\\n};\\n\\n$input.first().json.api.signature = genSignature(apiUrl, METHOD, API_SECRET, $input.first().json.api.timestamp);\\nreturn $input.first();\"},\"typeVersion\":1},{\"id\":\"f0fcf039-2508-429e-8b9a-4ec1ab929d97\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[780,1548.9314213779933],\"parameters\":{\"height\":523.2083276562503,\"content\":\"## Read your Google sheet file\\n\\nThis node reads a Google Sheet. You need to create a sheet with :\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n**The first column** :\\nHeader : company\\n\\n\\n\\n\\nDon't forget to specify the path of your file in the node and your credentials.\"},\"typeVersion\":1},{\"id\":\"1d0d1805-f664-44d3-83be-9ea26d43526c\",\"name\":\"Sticky Note3\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1021.0092314499475,1458.51011235955],\"parameters\":{\"width\":392.0593078758952,\"height\":1203.3290499048028,\"content\":\"## Authenticates to your Icypeas account\\n\\nThis code node utilizes your API key, API secret, and User ID to establish a connection with your Icypeas account.\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nOpen this node and insert your API Key, API secret, and User ID within the quotation marks. You can locate these credentials on your Icypeas profile at https://app.icypeas.com/bo/profile. Here is the extract of what you have to change :\\n\\nconst API_KEY = \\\"**PUT_API_KEY_HERE**\\\";\\nconst API_SECRET = \\\"**PUT_API_SECRET_HERE**\\\";\\nconst USER_ID = \\\"**PUT_USER_ID_HERE**\\\";\\n\\nDo not change any other line of the code.\\n\\nIf you are a self-hosted user, follow these steps to activate the crypto module :\\n\\n1.Access your n8n instance:\\nLog in to your n8n instance using your web browser by navigating to the URL of your instance, for example: http://your-n8n-instance.com.\\n\\n2.Go to Settings:\\nIn the top-right corner, click on your username, then select \\\"Settings.\\\"\\n\\n3.Select General Settings:\\nIn the left menu, click on \\\"General.\\\"\\n\\n4.Enable the Crypto module:\\nScroll down to the \\\"Additional Node Packages\\\" section. You will see an option called \\\"crypto\\\" with a checkbox next to it. Check this box to enable the Crypto module.\\n\\n5.Save the changes:\\nAt the bottom of the page, click \\\"Save\\\" to apply the changes.\\n\\nOnce you've followed these steps, the Crypto module should be activated for your self-hosted n8n instance. Make sure to save your changes and optionally restart your n8n instance for the changes to take effect.\\n\\n\\n\\n\\n\\n\"},\"typeVersion\":1},{\"id\":\"999fda2a-50ba-4641-8842-7d62587e0ad5\",\"name\":\"Sticky Note4\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1413,1460],\"parameters\":{\"width\":328.8456933308303,\"height\":869.114109302513,\"content\":\"## Performs domain scans (bulk).\\n\\n\\nThis node executes an HTTP request (POST) to scan the domains/companies.\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n### You need to create credentials in the HTTP Request node :\\n\\n➔ In the Credential for Header Auth, click on - Create new Credential -.\\n➔ In the Name section, write “Authorization”\\n➔ In the Value section, select expression (located just above the field on the right when you hover on top of it) and write {{ $json.api.key + ':' + $json.api.signature }} .\\n➔ Then click on “Save” to save the changes.\\n\\n### To retrieve the results :\\n\\nAfter some time, the results, which are downloadable, will be available in the Icypeas application  in this section : https://app.icypeas.com/bo/bulksearch?task=domain-search, and you will receive the scan results via email from no-reply@icypeas.com, providing you with the results of your scans.\\n\\n\\n\\n\\n\"},\"typeVersion\":1},{\"id\":\"0f5382ae-cd84-47a7-9818-ad252c9d62c3\",\"name\":\"Reads lastname,firstname and company from your sheet\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[840,1700],\"parameters\":{\"sheetName\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"\"},\"documentId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"\"}},\"typeVersion\":4.1},{\"id\":\"ce00b713-6ddc-4625-a9cc-e9badc2022d4\",\"name\":\"Run bulk search (domain-search)\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[1480,1700],\"parameters\":{\"url\":\"={{ $json.api.url }}\",\"method\":\"POST\",\"options\":{},\"sendBody\":true,\"sendHeaders\":true,\"authentication\":\"genericCredentialType\",\"bodyParameters\":{\"parameters\":[{\"name\":\"task\",\"value\":\"=domain-search\"},{\"name\":\"name\",\"value\":\"dernierT\"},{\"name\":\"user\",\"value\":\"={{ $json.api.userId }}\"},{\"name\":\"data\",\"value\":\"={{ $json.data }}\"}]},\"genericAuthType\":\"httpHeaderAuth\",\"headerParameters\":{\"parameters\":[{\"name\":\"X-ROCK-TIMESTAMP\",\"value\":\"={{ $json.api.timestamp }}\"}]}},\"typeVersion\":4.1}],\"pinData\":{},\"connections\":{\"When clicking \\\"Execute Workflow\\\"\":{\"main\":[[{\"node\":\"Reads lastname,firstname and company from your sheet\",\"type\":\"main\",\"index\":0}]]},\"Authenticates to your Icypeas account\":{\"main\":[[{\"node\":\"Run bulk search (domain-search)\",\"type\":\"main\",\"index\":0}]]},\"Reads lastname,firstname and company from your sheet\":{\"main\":[[{\"node\":\"Authenticates to your Icypeas account\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "This template can be used to verify email addresses with [Icypeas](https://www.icypeas.com/). Be sure to have an active account to use this template.\n\n**How it works**  \nThis workflow can be divided into four steps :\n    \n    \n    1. The workflow initiates with a manual trigger (On clicking ‘execute’).\n    2. It reads your Google Sheet file.\n    3. It connects to your Icypeas account.\n    4. It performs an HTTP request to scan the domains/companies.\n    \n\n**Set up steps**  \n1\\. You will need a formated Google sheet file with company/domain names.  \n2\\. You will need a working icypeas account to run the workflow and get your API Key, API Secret and User ID.  \n3\\. You will need domain/companies names to scan them.\n",
  "readme_html": "<!--[--><div data-v-50766329=\"\"><p>This template can be used to verify email addresses with <a href=\"https://www.icypeas.com/\" rel=\"ugc nofollow\" target=\"_blank\">Icypeas</a>. Be sure to have an active account to use this template.</p>\n<p><strong>How it works</strong><br>\nThis workflow can be divided into four steps :</p>\n<pre><code>1. The workflow initiates with a manual trigger (On clicking ‘execute’).\n2. It reads your Google Sheet file.\n3. It connects to your Icypeas account.\n4. It performs an HTTP request to scan the domains/companies.\n</code></pre>\n<p><strong>Set up steps</strong><br>\n1. You will need a formated Google sheet file with company/domain names.<br>\n2. You will need a working icypeas account to run the workflow and get your API Key, API Secret and User ID.<br>\n3. You will need domain/companies names to scan them.</p>\n</div><!--]-->",
  "readme_zh": "此模板可用于通过[Icypeas](https://www.icypeas.com/)验证电子邮件地址。使用前请确保拥有有效账户。\n\n**运作原理**  \n该工作流程可分为四个步骤：\n    \n    1. 工作流通过手动触发启动（点击\"执行\"按钮）；\n    2. 读取您的Google表格文件；\n    3. 连接至您的Icypeas账户；\n    4. 发起HTTP请求扫描域名/企业信息。\n\n**配置步骤**  \n1. 需准备包含企业/域名信息的格式化Google表格文件  \n2. 需持有有效的Icypeas账户以运行工作流，并获取API密钥、API密钥和用户ID  \n3. 需准备待扫描的域名/企业名称列表",
  "title_zh": "使用Icypeas（批量搜索）在Google表格中批量处理域名/公司",
  "publish_date_zh": "上次更新于一年前",
  "workflow_json_zh": "{\n  \"meta\": {\n    \"instanceId\": \"257476b1ef58bf3cb6a46e65fac7ee34a53a5e1a8492d5c6e4da5f87c9b82833\"\n  },\n  \"nodes\": [\n    {\n      \"id\": \"bfbd4299-0c8d-4368-b156-c76602ca068c\",\n      \"name\": \"When clicking \\\"Execute Workflow\\\"\",\n      \"type\": \"n8n-nodes-base.manualTrigger\",\n      \"position\": [\n        640,\n        1700\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"40cf87be-d9fc-434b-9099-0151968d2a0b\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        500,\n        1420\n      ],\n      \"parameters\": {\n        \"height\": 259,\n        \"content\": \"## Domain scan with Icypeas (bulk search)\\n\\n\\nThis workflow demonstrates how to perform domain scans (bulk search) using Icypeas. Visit https://icypeas.com to create your account.\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"c646dddb-bcd4-4ac8-b08f-e61ec16c99c5\",\n      \"name\": \"Authenticates to your Icypeas account\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        1140,\n        1700\n      ],\n      \"parameters\": {\n        \"jsCode\": \"const API_BASE_URL = \\\"https://app.icypeas.com/api\\\";\\nconst API_PATH = \\\"/bulk-search\\\";\\nconst METHOD = \\\"POST\\\";\\n\\n// Change here\\nconst API_KEY = \\\"PUT_API_KEY_HERE\\\";\\nconst API_SECRET = \\\"PUT_API_SECRET_HERE\\\";\\nconst USER_ID = \\\"PUT_USER_ID_HERE\\\";\\n////////////////\\n\\nconst genSignature = (\\n    url,\\n    method,\\n    secret,\\n    timestamp = new Date().toISOString()\\n) => {\\n    const Crypto = require('crypto');\\n    const payload = `${method}${url}${timestamp}`.toLowerCase();\\n    const sign = Crypto.createHmac(\\\"sha1\\\", secret).update(payload).digest(\\\"hex\\\");\\n\\n    return sign;\\n};\\n\\nconst apiUrl = `${API_BASE_URL}${API_PATH}`;\\n\\nconst data = $input.all().map((x) => [ x.json.company]);\\n$input.first().json.data = data;\\n$input.first().json.api = {\\n  timestamp: new Date().toISOString(),\\n  secret: API_SECRET,\\n  key: API_KEY,\\n  userId: USER_ID,\\n  url: apiUrl,\\n};\\n\\n$input.first().json.api.signature = genSignature(apiUrl, METHOD, API_SECRET, $input.first().json.api.timestamp);\\nreturn $input.first();\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"f0fcf039-2508-429e-8b9a-4ec1ab929d97\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        780,\n        1548.9314213779933\n      ],\n      \"parameters\": {\n        \"height\": 523.2083276562503,\n        \"content\": \"## 读取您的谷歌表格文件\\n\\n此节点用于读取谷歌表格。您需要创建包含以下内容的表格：\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"1d0d1805-f664-44d3-83be-9ea26d43526c\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1021.0092314499475,\n        1458.51011235955\n      ],\n      \"parameters\": {\n        \"width\": 392.0593078758952,\n        \"height\": 1203.3290499048028,\n        \"content\": \"## Authenticates to your Icypeas account\\n\\nThis code node utilizes your API key, API secret, and User ID to establish a connection with your Icypeas account.\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nOpen this node and insert your API Key, API secret, and User ID within the quotation marks. You can locate these credentials on your Icypeas profile at https://app.icypeas.com/bo/profile. Here is the extract of what you have to change :\\n\\nconst API_KEY = \\\"**PUT_API_KEY_HERE**\\\";\\nconst API_SECRET = \\\"**PUT_API_SECRET_HERE**\\\";\\nconst USER_ID = \\\"**PUT_USER_ID_HERE**\\\";\\n\\nDo not change any other line of the code.\\n\\nIf you are a self-hosted user, follow these steps to activate the crypto module :\\n\\n1.Access your n8n instance:\\nLog in to your n8n instance using your web browser by navigating to the URL of your instance, for example: http://your-n8n-instance.com.\\n\\n2.Go to Settings:\\nIn the top-right corner, click on your username, then select \\\"Settings.\\\"\\n\\n3.Select General Settings:\\nIn the left menu, click on \\\"General.\\\"\\n\\n4.Enable the Crypto module:\\nScroll down to the \\\"Additional Node Packages\\\" section. You will see an option called \\\"crypto\\\" with a checkbox next to it. Check this box to enable the Crypto module.\\n\\n5.Save the changes:\\nAt the bottom of the page, click \\\"Save\\\" to apply the changes.\\n\\nOnce you've followed these steps, the Crypto module should be activated for your self-hosted n8n instance. Make sure to save your changes and optionally restart your n8n instance for the changes to take effect.\\n\\n\\n\\n\\n\\n\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"999fda2a-50ba-4641-8842-7d62587e0ad5\",\n      \"name\": \"Sticky Note4\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1413,\n        1460\n      ],\n      \"parameters\": {\n        \"width\": 328.8456933308303,\n        \"height\": 869.114109302513,\n        \"content\": \"## Performs domain scans (bulk).\\n\\n\\nThis node executes an HTTP request (POST) to scan the domains/companies.\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n### You need to create credentials in the HTTP Request node :\\n\\n➔ In the Credential for Header Auth, click on - Create new Credential -.\\n➔ In the Name section, write “Authorization”\\n➔ In the Value section, select expression (located just above the field on the right when you hover on top of it) and write {{ $json.api.key + ':' + $json.api.signature }} .\\n➔ Then click on “Save” to save the changes.\\n\\n### To retrieve the results :\\n\\nAfter some time, the results, which are downloadable, will be available in the Icypeas application  in this section : https://app.icypeas.com/bo/bulksearch?task=domain-search, and you will receive the scan results via email from no-reply@icypeas.com, providing you with the results of your scans.\\n\\n\\n\\n\\n\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"0f5382ae-cd84-47a7-9818-ad252c9d62c3\",\n      \"name\": \"Reads lastname,firstname and company from your sheet\",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"position\": [\n        840,\n        1700\n      ],\n      \"parameters\": {\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"\"\n        }\n      },\n      \"typeVersion\": 4.1\n    },\n    {\n      \"id\": \"ce00b713-6ddc-4625-a9cc-e9badc2022d4\",\n      \"name\": \"Run bulk search (domain-search)\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1480,\n        1700\n      ],\n      \"parameters\": {\n        \"url\": \"={{ $json.api.url }}\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"sendBody\": true,\n        \"sendHeaders\": true,\n        \"authentication\": \"genericCredentialType\",\n        \"bodyParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"task\",\n              \"value\": \"=domain-search\"\n            },\n            {\n              \"name\": \"name\",\n              \"value\": \"dernierT\"\n            },\n            {\n              \"name\": \"user\",\n              \"value\": \"={{ $json.api.userId }}\"\n            },\n            {\n              \"name\": \"data\",\n              \"value\": \"={{ $json.data }}\"\n            }\n          ]\n        },\n        \"genericAuthType\": \"httpHeaderAuth\",\n        \"headerParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"X-ROCK-TIMESTAMP\",\n              \"value\": \"={{ $json.api.timestamp }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 4.1\n    }\n  ],\n  \"pinData\": {},\n  \"connections\": {\n    \"When clicking \\\"Execute Workflow\\\"\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Reads lastname,firstname and company from your sheet\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Authenticates to your Icypeas account\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Run bulk search (domain-search)\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Reads lastname,firstname and company from your sheet\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Authenticates to your Icypeas account\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}