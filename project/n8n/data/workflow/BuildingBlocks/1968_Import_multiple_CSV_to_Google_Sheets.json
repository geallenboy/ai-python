{
  "title": "Import multiple CSV to Google Sheets",
  "url": "https://n8n.io/workflows/1968-import-multiple-csv-to-google-sheets/",
  "category": "BuildingBlocks",
  "category_url": "https://n8n.io/workflows/categories/building-blocks/?sort=createdAt:desc",
  "author": "n8n Team",
  "publish_date": "Last update 10 months ago",
  "publish_date_absolute": "",
  "content": "",
  "workflow_json": "{\"id\":\"zic2ZEHvxHR4UAYI\",\"meta\":{\"instanceId\":\"fb924c73af8f703905bc09c9ee8076f48c17b596ed05b18c0ff86915ef8a7c4a\"},\"name\":\"Import multiple CSV to GoogleSheet\",\"tags\":[],\"nodes\":[{\"id\":\"cd5adfcc-5b92-4a75-8e78-c2c1218d946a\",\"name\":\"When clicking \\\"Execute Workflow\\\"\",\"type\":\"n8n-nodes-base.manualTrigger\",\"position\":[920,380],\"parameters\":{},\"typeVersion\":1},{\"id\":\"17305629-bb19-4b55-964e-689ab5f4d557\",\"name\":\"Read Binary Files\",\"type\":\"n8n-nodes-base.readBinaryFiles\",\"position\":[1120,380],\"parameters\":{\"fileSelector\":\"=./.n8n/*.csv\"},\"typeVersion\":1},{\"id\":\"d3055f63-67fa-4dcd-886d-fe6f56fb7058\",\"name\":\"Split In Batches\",\"type\":\"n8n-nodes-base.splitInBatches\",\"position\":[1320,380],\"parameters\":{\"options\":{},\"batchSize\":1},\"typeVersion\":2},{\"id\":\"597e9b14-1a8c-4fbb-b5df-c965db1e0e16\",\"name\":\"Read CSV\",\"type\":\"n8n-nodes-base.spreadsheetFile\",\"position\":[1520,360],\"parameters\":{\"options\":{\"rawData\":true,\"headerRow\":true,\"readAsString\":true,\"includeEmptyCells\":false},\"fileFormat\":\"csv\"},\"typeVersion\":2},{\"id\":\"90d5ccac-f2a3-42b6-8fa3-d05450ffa67b\",\"name\":\"Remove duplicates\",\"type\":\"n8n-nodes-base.itemLists\",\"position\":[1520,600],\"parameters\":{\"compare\":\"selectedFields\",\"options\":{},\"operation\":\"removeDuplicates\",\"fieldsToCompare\":\"user_name\"},\"typeVersion\":3},{\"id\":\"2bddcd85-1c99-41ec-8e16-ab75631c3fb9\",\"name\":\"Keep only subscribers\",\"type\":\"n8n-nodes-base.filter\",\"position\":[1720,600],\"parameters\":{\"conditions\":{\"string\":[{\"value1\":\"={{ $json.subscribed }}\",\"value2\":\"TRUE\"}]}},\"typeVersion\":1},{\"id\":\"4ac13e9d-8523-4ff3-b778-1d9f0dc744e3\",\"name\":\"Sort by date\",\"type\":\"n8n-nodes-base.itemLists\",\"position\":[1920,600],\"parameters\":{\"options\":{},\"operation\":\"sort\",\"sortFieldsUi\":{\"sortField\":[{\"fieldName\":\"date_subscribed\"}]}},\"typeVersion\":3},{\"id\":\"862a7ded-0199-48bb-8183-10f9ae06724b\",\"name\":\"Upload to spreadsheet\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[2120,600],\"parameters\":{\"columns\":{\"value\":{},\"schema\":[{\"id\":\"user_name\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"user_name\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"user_email\",\"type\":\"string\",\"display\":true,\"removed\":true,\"required\":false,\"displayName\":\"user_email\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"subscribed\",\"type\":\"string\",\"display\":true,\"removed\":true,\"required\":false,\"displayName\":\"subscribed\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"date_subscribed\",\"type\":\"string\",\"display\":true,\"removed\":true,\"required\":false,\"displayName\":\"date_subscribed\",\"defaultMatch\":false,\"canBeUsedToMatch\":true}],\"mappingMode\":\"autoMapInputData\",\"matchingColumns\":[\"user_name\"]},\"options\":{},\"operation\":\"appendOrUpdate\",\"sheetName\":{\"__rl\":true,\"mode\":\"list\",\"value\":2042396108,\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/13YYuEJ1cDf-t8P2MSTFWnnNHCreQ6Zo8oPSp7WeNnbY/edit#gid=2042396108\",\"cachedResultName\":\"n8n-sheet\"},\"documentId\":{\"__rl\":true,\"mode\":\"url\",\"value\":\"https://docs.google.com/spreadsheets/d/13YYuEJ1cDf-t8P2MSTFWnnNHCreQ6Zo8oPSp7WeNnbY\"}},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"54\",\"name\":\"Google Sheets account\"}},\"typeVersion\":4},{\"id\":\"95b499b4-024d-49a5-887f-f2f74bd1b9a1\",\"name\":\"Assign source file name\",\"type\":\"n8n-nodes-base.set\",\"position\":[1720,360],\"parameters\":{\"fields\":{\"values\":[{\"name\":\"Source\",\"stringValue\":\"={{ $('Split In Batches').item.binary.data.fileName }}\"}]},\"options\":{}},\"typeVersion\":3}],\"active\":false,\"pinData\":{},\"settings\":{\"executionOrder\":\"v1\"},\"versionId\":\"a6ccb0b8-04bd-407d-b5ca-010c68bb2128\",\"connections\":{\"Read CSV\":{\"main\":[[{\"node\":\"Assign source file name\",\"type\":\"main\",\"index\":0}]]},\"Sort by date\":{\"main\":[[{\"node\":\"Upload to spreadsheet\",\"type\":\"main\",\"index\":0}]]},\"Split In Batches\":{\"main\":[[{\"node\":\"Read CSV\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Remove duplicates\",\"type\":\"main\",\"index\":0}]]},\"Read Binary Files\":{\"main\":[[{\"node\":\"Split In Batches\",\"type\":\"main\",\"index\":0}]]},\"Remove duplicates\":{\"main\":[[{\"node\":\"Keep only subscribers\",\"type\":\"main\",\"index\":0}]]},\"Keep only subscribers\":{\"main\":[[{\"node\":\"Sort by date\",\"type\":\"main\",\"index\":0}]]},\"Assign source file name\":{\"main\":[[{\"node\":\"Split In Batches\",\"type\":\"main\",\"index\":0}]]},\"When clicking \\\"Execute Workflow\\\"\":{\"main\":[[{\"node\":\"Read Binary Files\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "This workflow imports multiple CSV files and appends or updates them to a Google Sheets document.\n\nHere's a step-by-step breakdown:\n\n  1. When clicked \"Execute Workflow\", the process starts.\n  2. The \"Read Binary Files\" node reads all the '.csv' files from the specified directory.\n  3. The files are then split into batches (one file in a batch) by the \"Split In Batches\" node.\n  4. For each file, the \"Read CSV\" node reads the data from the CSV file.\n  5. The \"Assign source file name\" node assigns the source file name to the data.\n  6. The data is then processed by the \"Remove duplicates\" node. This removes any duplicate entries based on the 'user_name' field.\n  7. The \"Keep only subscribers\" node filters the data to keep only those entries where the 'subscribed' field is set to 'TRUE'.\n  8. The data is then sorted by the 'date_subscribed' field using the \"Sort by date\" node.\n  9. Finally, the processed data is appended or updated to a specified Google Sheets document using the \"Upload to spreadsheet\" node. It checks for the 'user_name' field, if the data corresponding to that 'user_name' already exists, it updates the data, otherwise appends the new data.\n\n\n",
  "readme_html": "<!--[--><div data-v-50766329=\"\"><p>This workflow imports multiple CSV files and appends or updates them to a Google Sheets document.</p>\n<p>Here's a step-by-step breakdown:</p>\n<ol>\n<li>When clicked \"Execute Workflow\", the process starts.</li>\n<li>The \"Read Binary Files\" node reads all the '.csv' files from the specified directory.</li>\n<li>The files are then split into batches (one file in a batch) by the \"Split In Batches\" node.</li>\n<li>For each file, the \"Read CSV\" node reads the data from the CSV file.</li>\n<li>The \"Assign source file name\" node assigns the source file name to the data.</li>\n<li>The data is then processed by the \"Remove duplicates\" node. This removes any duplicate entries based on the 'user_name' field.</li>\n<li>The \"Keep only subscribers\" node filters the data to keep only those entries where the 'subscribed' field is set to 'TRUE'.</li>\n<li>The data is then sorted by the 'date_subscribed' field using the \"Sort by date\" node.</li>\n<li>Finally, the processed data is appended or updated to a specified Google Sheets document using the \"Upload to spreadsheet\" node. It checks for the 'user_name' field, if the data corresponding to that 'user_name' already exists, it updates the data, otherwise appends the new data.</li>\n</ol>\n</div><!--]-->"
}