{
  "title": "Google Calendar to Slack Status and Philips Hue",
  "url": "https://n8n.io/workflows/1420-google-calendar-to-slack-status-and-philips-hue/",
  "category": "BuildingBlocks",
  "category_url": "https://n8n.io/workflows/categories/building-blocks/?sort=createdAt:desc",
  "author": "TheUnknownEntity",
  "publish_date": "Last update 10 months ago",
  "publish_date_absolute": "2024-07-06",
  "content": "",
  "workflow_json": "{\"id\":118,\"name\":\"Google Calendar to Slack Status & Philips Hue\",\"nodes\":[{\"name\":\"On clicking 'execute'\",\"type\":\"n8n-nodes-base.manualTrigger\",\"disabled\":true,\"position\":[420,420],\"parameters\":{},\"typeVersion\":1},{\"name\":\"Google Calendar\",\"type\":\"n8n-nodes-base.googleCalendar\",\"position\":[720,600],\"parameters\":{\"eventId\":\"={{$node[\\\"Event Started\\\"].json[\\\"id\\\"].split(\\\"_\\\")[0]}}\",\"options\":{},\"calendar\":\"youremail@domain.com\",\"operation\":\"get\"},\"credentials\":{\"googleCalendarOAuth2Api\":{\"id\":\"15\",\"name\":\"GoogleCalendar - Personal\"}},\"typeVersion\":1},{\"name\":\"Light - Busy\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[1220,180],\"parameters\":{\"url\":\"WEBHOOK1\",\"options\":{},\"requestMethod\":\"POST\"},\"typeVersion\":1},{\"name\":\"Light - Available\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[1220,600],\"parameters\":{\"url\":\"WEBHOOK3\",\"options\":{},\"requestMethod\":\"POST\"},\"typeVersion\":1},{\"name\":\"Switch\",\"type\":\"n8n-nodes-base.switch\",\"position\":[1040,460],\"parameters\":{\"rules\":{\"rules\":[{\"value2\":\"4dw_doing\",\"operation\":\"startsWith\"},{\"value2\":\"4dw_managing\",\"operation\":\"startsWith\"},{\"value2\":\"4dw_leading\",\"operation\":\"startsWith\"},{\"output\":1,\"value2\":\"4dw_living\",\"operation\":\"startsWith\"}]},\"value1\":\"={{$json[\\\"calColor\\\"]}}\",\"dataType\":\"string\",\"fallbackOutput\":3},\"typeVersion\":1},{\"name\":\"Light - Personal\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[1220,340],\"parameters\":{\"url\":\"WEBHOOK2\",\"options\":{},\"requestMethod\":\"POST\"},\"typeVersion\":1},{\"name\":\"Event Started\",\"type\":\"n8n-nodes-base.googleCalendarTrigger\",\"position\":[540,600],\"parameters\":{\"options\":{},\"pollTimes\":{\"item\":[{\"mode\":\"everyX\",\"unit\":\"minutes\",\"value\":5}]},\"triggerOn\":\"eventStarted\",\"calendarId\":\"youremail@domain.com\"},\"credentials\":{\"googleCalendarOAuth2Api\":{\"id\":\"15\",\"name\":\"GoogleCalendar - Personal\"}},\"typeVersion\":1},{\"name\":\"Slack - Status\",\"type\":\"n8n-nodes-base.slack\",\"position\":[1040,720],\"parameters\":{\"resource\":\"userProfile\",\"operation\":\"update\",\"additionalFields\":{\"status_text\":\"={{$json[\\\"summary\\\"]}}\",\"status_emoji\":\"=:{{$json[\\\"calColor\\\"]}}:\"}},\"credentials\":{\"slackApi\":{\"id\":\"17\",\"name\":\"CompanySlack\"}},\"typeVersion\":1},{\"name\":\"Set CalColor\",\"type\":\"n8n-nodes-base.function\",\"position\":[880,600],\"parameters\":{\"functionCode\":\"for (item of items) {\\n\\n  switch (item.json.colorId) {\\n    case '1':\\n      calColor = 'Lavendar';\\n      break;\\n    case '2':\\n      calColor = '4dw_leading';\\n      break;\\n    case '3':\\n      calColor = 'Grape';\\n      break;\\n    case '4':\\n      calColor = 'Flamingo';\\n      break;\\n    case '5':\\n      calColor = '4dw_managing';\\n      break;\\n    case '6':\\n      calColor = 'Tangerine';\\n      break;\\n    case '7':\\n      calColor = '4dw_living';\\n      break;\\n    case '8':\\n      calColor = 'Graphite';\\n      break;\\n    case '9':\\n      calColor = 'Blueberry';\\n      break;\\n    case '10':\\n      calColor = 'Basil';\\n      break;\\n    case '11':\\n      calColor = '4dw_doing';\\n      break;\\n    default:\\n      calColor = 'undefined';\\n  }\\n  item.json.calColor = calColor;\\n}\\n\\nreturn items;\"},\"typeVersion\":1}],\"active\":false,\"settings\":{},\"connections\":{\"Switch\":{\"main\":[[{\"node\":\"Light - Busy\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Light - Personal\",\"type\":\"main\",\"index\":0}],[],[{\"node\":\"Light - Available\",\"type\":\"main\",\"index\":0}]]},\"Set CalColor\":{\"main\":[[{\"node\":\"Slack - Status\",\"type\":\"main\",\"index\":0},{\"node\":\"Switch\",\"type\":\"main\",\"index\":0}]]},\"Event Started\":{\"main\":[[{\"node\":\"Google Calendar\",\"type\":\"main\",\"index\":0}]]},\"Google Calendar\":{\"main\":[[{\"node\":\"Set CalColor\",\"type\":\"main\",\"index\":0}]]},\"On clicking 'execute'\":{\"main\":[[]]}}}",
  "readme": "I'm currently trialing a 4 day work week for all staff at my company, and one of the major impacts on productivity is interruptions.\n\nAs such, I opted to use N8N to create a workflow to monitor my Google Calendar and when an event starts, to update my Slack status with an emote and the title of the calendar task. Additionally I opted to include to change the colour of Philips Hue lamp located in my living room where my wife is currently working so she know's if she can interrupt me or not.\n\nMy calendar is built on the theory behind the [Diary Detox](https://diarydetox.com/) system and as such the Slack Status reflect the colours involved. This was achieved using the emote aliases for the relevant colour circles.\n\n![4DW Colours.png](https://f000.backblazeb2.com/file/n8n-website-images/c7bf9cb3bc0d4b0c95ec749e5f866fae.png)\n\nThe Philips Hue lamp status is changed via the local API with Home Assistant. This is a very similiar process to controlling it with something like the Streamdeck, but the workflow calls the Webhook instead of the Streamdeck. This process can be found in lots of Youtube videos such as [this](https://www.youtube.com/watch?v=QI328yziiZs).\n\nThis gives my wife a very quick and easy way to know if she can interrupt me in my office (when the lights are Green or Blue) or when I'm busy (Red).\n\n![RedGreenLight.png](https://f000.backblazeb2.com/file/n8n-website-images/d770898b83314c128622f8926d80c9bf.png)\n\n**Please Note:** The above images are not intended to be an incentive to create your own Squid Games.\n\nAdditionally, when integrating Slack with N8N, there are 2 x APIs which can be used. Typically the Bot User OAuth Token is used, however in order for your Status to be updated, the **User OAuth Token** must be used with the _users.profile:read_ and _users.profile:write_ permissions enabled.\n\nFor clarity, I have removed the Webhooks from the Workflow as this would allow any person to control my lights. These can be inserted in the HTTP Request nodes. Each node responds to a different automation within the Home Assistant infrastructure.\n\n_Acknowledgement: I would also credit Jon (Discord) aka 8668 (Workflows) for writing the Function node which turns the ColorID into a named variable._\n",
  "readme_html": "<!--[--><div data-v-50766329=\"\"><p>I'm currently trialing a 4 day work week for all staff at my company, and one of the major impacts on productivity is interruptions.</p>\n<p>As such, I opted to use N8N to create a workflow to monitor my Google Calendar and when an event starts, to update my Slack status with an emote and the title of the calendar task. Additionally I opted to include to change the colour of Philips Hue lamp located in my living room where my wife is currently working so she know's if she can interrupt me or not.</p>\n<p>My calendar is built on the theory behind the <a href=\"https://diarydetox.com/\" rel=\"ugc nofollow\" target=\"_blank\">Diary Detox</a> system and as such the Slack Status reflect the colours involved. This was achieved using the emote aliases for the relevant colour circles.</p>\n<p><img src=\"https://f000.backblazeb2.com/file/n8n-website-images/c7bf9cb3bc0d4b0c95ec749e5f866fae.png\" alt=\"4DW Colours.png\"></p>\n<p>The Philips Hue lamp status is changed via the local API with Home Assistant. This is a very similiar process to controlling it with something like the Streamdeck, but the workflow calls the Webhook instead of the Streamdeck. This process can be found in lots of Youtube videos such as <a href=\"https://www.youtube.com/watch?v=QI328yziiZs\" rel=\"ugc nofollow\" target=\"_blank\">this</a>.</p>\n<p>This gives my wife a very quick and easy way to know if she can interrupt me in my office (when the lights are Green or Blue) or when I'm busy (Red).</p>\n<p><img src=\"https://f000.backblazeb2.com/file/n8n-website-images/d770898b83314c128622f8926d80c9bf.png\" alt=\"RedGreenLight.png\"></p>\n<p><strong>Please Note:</strong> The above images are not intended to be an incentive to create your own Squid Games.</p>\n<p>Additionally, when integrating Slack with N8N, there are 2 x APIs which can be used. Typically the Bot User OAuth Token is used, however in order for your Status to be updated, the <strong>User OAuth Token</strong> must be used with the <em>users.profile:read</em> and <em>users.profile:write</em> permissions enabled.</p>\n<p>For clarity, I have removed the Webhooks from the Workflow as this would allow any person to control my lights. These can be inserted in the HTTP Request nodes. Each node responds to a different automation within the Home Assistant infrastructure.</p>\n<p><em>Acknowledgement: I would also credit Jon (Discord) aka 8668 (Workflows) for writing the Function node which turns the ColorID into a named variable.</em></p>\n</div><!--]-->",
  "readme_zh": "我正在公司试行全员每周四天工作制，发现影响工作效率的主要因素之一是工作被打断。\n\n为此，我选择使用N8N创建自动化流程：监控谷歌日历日程，当会议开始时自动更新Slack状态（显示表情符号和日程标题）。我还额外添加了控制客厅飞利浦Hue灯泡颜色的功能——目前我妻子在那里办公，这样她就能直观判断是否可以打断我的工作。\n\n我的日历系统基于[Diary Detox](https://diarydetox.com/)理论构建，因此Slack状态会同步显示对应的颜色标识。这是通过为不同颜色圆圈设置表情符号别名实现的。\n\n![4DW四色标识.png](https://f000.backblazeb2.com/file/n8n-website-images/c7bf9cb3bc0d4b0c95ec749e5f866fae.png)\n\n飞利浦Hue灯泡的状态通过Home Assistant本地API控制。该原理与使用Streamdeck等设备控制类似，只是改由工作流调用Webhook实现。具体操作可参考[此YouTube视频](https://www.youtube.com/watch?v=QI328yziiZs)等众多教程。\n\n这样我妻子就能通过灯光颜色快速判断：绿灯或蓝灯表示可以进办公室找我，红灯则表示我正在忙。\n\n![红绿灯状态.png](https://f000.backblazeb2.com/file/n8n-website-images/d770898b83314c128622f8926d80c9bf.png)\n\n**请注意**：上述图片并非鼓励您自制《鱿鱼游戏》道具。\n\n补充说明：N8N与Slack集成时有两种API可选。通常使用Bot User OAuth Token，但若要更新状态，必须使用具备_users.profile:read_和_users.profile:write_权限的**User OAuth Token**。\n\n为安全起见，我已从工作流中移除Webhook节点（防止他人控制我的灯光），这些可插入HTTP Request节点使用。每个节点对应Home Assistant基础设施中的不同自动化模块。\n\n_特别致谢：感谢Discord用户Jon（工作流ID8668）编写了将ColorID转换为命名变量的Function节点。_",
  "title_zh": "谷歌日历同步至Slack状态与飞利浦Hue",
  "publish_date_zh": "最后更新于10个月前",
  "workflow_json_zh": "{\n  \"id\": 118,\n  \"name\": \"Google Calendar to Slack Status & Philips Hue\",\n  \"nodes\": [\n    {\n      \"name\": \"On clicking 'execute'\",\n      \"type\": \"n8n-nodes-base.manualTrigger\",\n      \"disabled\": true,\n      \"position\": [\n        420,\n        420\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Google Calendar\",\n      \"type\": \"n8n-nodes-base.googleCalendar\",\n      \"position\": [\n        720,\n        600\n      ],\n      \"parameters\": {\n        \"eventId\": \"={{$node[\\\"Event Started\\\"].json[\\\"id\\\"].split(\\\"_\\\")[0]}}\",\n        \"options\": {},\n        \"calendar\": \"youremail@domain.com\",\n        \"operation\": \"get\"\n      },\n      \"credentials\": {\n        \"googleCalendarOAuth2Api\": {\n          \"id\": \"15\",\n          \"name\": \"GoogleCalendar - Personal\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Light - Busy\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1220,\n        180\n      ],\n      \"parameters\": {\n        \"url\": \"WEBHOOK1\",\n        \"options\": {},\n        \"requestMethod\": \"POST\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Light - Available\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1220,\n        600\n      ],\n      \"parameters\": {\n        \"url\": \"WEBHOOK3\",\n        \"options\": {},\n        \"requestMethod\": \"POST\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Switch\",\n      \"type\": \"n8n-nodes-base.switch\",\n      \"position\": [\n        1040,\n        460\n      ],\n      \"parameters\": {\n        \"rules\": {\n          \"rules\": [\n            {\n              \"value2\": \"4dw_doing\",\n              \"operation\": \"startsWith\"\n            },\n            {\n              \"value2\": \"4dw_managing\",\n              \"operation\": \"startsWith\"\n            },\n            {\n              \"value2\": \"4dw_leading\",\n              \"operation\": \"startsWith\"\n            },\n            {\n              \"output\": 1,\n              \"value2\": \"4dw_living\",\n              \"operation\": \"startsWith\"\n            }\n          ]\n        },\n        \"value1\": \"={{$json[\\\"calColor\\\"]}}\",\n        \"dataType\": \"string\",\n        \"fallbackOutput\": 3\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Light - Personal\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1220,\n        340\n      ],\n      \"parameters\": {\n        \"url\": \"WEBHOOK2\",\n        \"options\": {},\n        \"requestMethod\": \"POST\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Event Started\",\n      \"type\": \"n8n-nodes-base.googleCalendarTrigger\",\n      \"position\": [\n        540,\n        600\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"pollTimes\": {\n          \"item\": [\n            {\n              \"mode\": \"everyX\",\n              \"unit\": \"minutes\",\n              \"value\": 5\n            }\n          ]\n        },\n        \"triggerOn\": \"eventStarted\",\n        \"calendarId\": \"youremail@domain.com\"\n      },\n      \"credentials\": {\n        \"googleCalendarOAuth2Api\": {\n          \"id\": \"15\",\n          \"name\": \"GoogleCalendar - Personal\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Slack - Status\",\n      \"type\": \"n8n-nodes-base.slack\",\n      \"position\": [\n        1040,\n        720\n      ],\n      \"parameters\": {\n        \"resource\": \"userProfile\",\n        \"operation\": \"update\",\n        \"additionalFields\": {\n          \"status_text\": \"={{$json[\\\"summary\\\"]}}\",\n          \"status_emoji\": \"=:{{$json[\\\"calColor\\\"]}}:\"\n        }\n      },\n      \"credentials\": {\n        \"slackApi\": {\n          \"id\": \"17\",\n          \"name\": \"CompanySlack\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"name\": \"Set CalColor\",\n      \"type\": \"n8n-nodes-base.function\",\n      \"position\": [\n        880,\n        600\n      ],\n      \"parameters\": {\n        \"functionCode\": \"for (item of items) {\\n\\n  switch (item.json.colorId) {\\n    case '1':\\n      calColor = 'Lavendar';\\n      break;\\n    case '2':\\n      calColor = '4dw_leading';\\n      break;\\n    case '3':\\n      calColor = 'Grape';\\n      break;\\n    case '4':\\n      calColor = 'Flamingo';\\n      break;\\n    case '5':\\n      calColor = '4dw_managing';\\n      break;\\n    case '6':\\n      calColor = 'Tangerine';\\n      break;\\n    case '7':\\n      calColor = '4dw_living';\\n      break;\\n    case '8':\\n      calColor = 'Graphite';\\n      break;\\n    case '9':\\n      calColor = 'Blueberry';\\n      break;\\n    case '10':\\n      calColor = 'Basil';\\n      break;\\n    case '11':\\n      calColor = '4dw_doing';\\n      break;\\n    default:\\n      calColor = 'undefined';\\n  }\\n  item.json.calColor = calColor;\\n}\\n\\nreturn items;\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"active\": false,\n  \"settings\": {},\n  \"connections\": {\n    \"Switch\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Light - Busy\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Light - Personal\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [],\n        [\n          {\n            \"node\": \"Light - Available\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Set CalColor\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Slack - Status\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Switch\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Event Started\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Google Calendar\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Google Calendar\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Set CalColor\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"On clicking 'execute'\": {\n      \"main\": [\n        []\n      ]\n    }\n  }\n}"
}