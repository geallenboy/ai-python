{
  "title": "Sync Entra User to Zammad User",
  "url": "https://n8n.io/workflows/2587-sync-entra-user-to-zammad-user/",
  "category": "HR",
  "category_url": "https://n8n.io/workflows/categories/hr/?count=20",
  "author": "Sirhexalot",
  "publish_date": "Last update 5 months ago",
  "publish_date_absolute": "",
  "content": "",
  "workflow_json": "{\"id\":\"KKCfXEpBjjhp1LC8\",\"meta\":{\"instanceId\":\"494d0146a0f47676ad70a44a32086b466621f62da855e3eaf0ee51dee1f76753\",\"templateCredsSetupCompleted\":true},\"name\":\"Entra User to Zammad User Sync\",\"tags\":[],\"nodes\":[{\"id\":\"0007443e-b0d4-4f98-a613-3ec7c2842aa3\",\"name\":\"When clicking ‘Test workflow’\",\"type\":\"n8n-nodes-base.manualTrigger\",\"position\":[-2140,140],\"parameters\":{},\"typeVersion\":1},{\"id\":\"2b285a4f-7e39-411b-88b9-cb55c5cf62e3\",\"name\":\"Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-1700,380],\"parameters\":{\"width\":1635.910561370123,\"height\":329.7269624573379,\"content\":\"## Select Entra Users in a named Entra Group that should be synced to Zammad\\n\\n\\n\\n\"},\"typeVersion\":1},{\"id\":\"929e529e-a4a3-4663-b9dc-e2300a860fed\",\"name\":\"Get Groups from Entra\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[-1660,480],\"parameters\":{\"url\":\"https://graph.microsoft.com/v1.0/groups\",\"options\":{},\"authentication\":\"predefinedCredentialType\",\"nodeCredentialType\":\"microsoftOAuth2Api\"},\"credentials\":{\"microsoftOAuth2Api\":{\"id\":\"U2E5p3lreqSi8v1N\",\"name\":\"ms365test.zammad.org\"},\"microsoftGraphSecurityOAuth2Api\":{\"id\":\"b09tqOxzkl0P8UQD\",\"name\":\"ms365test.zammad.org\"}},\"typeVersion\":4.2},{\"id\":\"3390b2ed-6070-429c-bc1a-f0ab324117c7\",\"name\":\"Remove outer Array\",\"type\":\"n8n-nodes-base.splitOut\",\"position\":[-1400,480],\"parameters\":{\"options\":{},\"fieldToSplitOut\":\"value\"},\"typeVersion\":1},{\"id\":\"b0e9531a-7fc0-4de0-8ec5-4be476b18a26\",\"name\":\"Select Entra Zammad default Group\",\"type\":\"n8n-nodes-base.if\",\"notes\":\"Please enter the Entra group name of users to be synchronized.\",\"position\":[-1120,480],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"2dbb2484-2424-4095-a5a2-76ab4e3aaae8\",\"operator\":{\"name\":\"filter.operator.equals\",\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $json.displayName }}\",\"rightValue\":\"ENTRA\"}]}},\"notesInFlow\":true,\"typeVersion\":2.2},{\"id\":\"1be2a745-aea3-46ec-ab84-be2e39358b95\",\"name\":\"Remove outer Array from Entra User\",\"type\":\"n8n-nodes-base.splitOut\",\"position\":[-700,460],\"parameters\":{\"options\":{},\"fieldToSplitOut\":\"value\"},\"typeVersion\":1},{\"id\":\"3b1fc962-7546-4bad-b637-e018649a0652\",\"name\":\"Zammad Univeral User Object\",\"type\":\"n8n-nodes-base.set\",\"position\":[-240,440],\"parameters\":{\"values\":{\"number\":[{\"name\":\"entra_key\",\"value\":\"={{ $json.id }}\"}],\"string\":[{\"name\":\"email\",\"value\":\"={{ $json.userPrincipalName }}\"},{\"name\":\"lastname\",\"value\":\"={{ $json.surname }}\"},{\"name\":\"firstname\",\"value\":\"={{ $json.givenName }}\"},{\"name\":\"mobile\",\"value\":\"={{ $json.mobilePhone }}\"},{\"name\":\"phone\",\"value\":\"={{ $json.businessPhones[0] }}\"},{},{}]},\"options\":{},\"keepOnlySet\":true},\"typeVersion\":1},{\"id\":\"9e36e6a9-cf56-4548-a1af-b1e33dbc61dd\",\"name\":\"Get Zammad Users\",\"type\":\"n8n-nodes-base.zammad\",\"position\":[-1020,140],\"parameters\":{\"filters\":{},\"operation\":\"getAll\",\"returnAll\":true},\"credentials\":{\"zammadTokenAuthApi\":{\"id\":\"fj5GuzcJuNLQeMxz\",\"name\":\"Zammad Token Auth account\"}},\"typeVersion\":1},{\"id\":\"c9a342b1-b5f2-4d31-9737-15f145dc7318\",\"name\":\"Merge\",\"type\":\"n8n-nodes-base.merge\",\"position\":[240,140],\"parameters\":{\"mode\":\"combine\",\"options\":{},\"fieldsToMatchString\":\"email\"},\"typeVersion\":3},{\"id\":\"a04ebfea-e5fe-4903-841a-8ef29d75ff1a\",\"name\":\"Get Members of the default group\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[-880,460],\"parameters\":{\"url\":\"=https://graph.microsoft.com/v1.0/groups/{{ $json.id }}/members \",\"options\":{},\"authentication\":\"predefinedCredentialType\",\"nodeCredentialType\":\"microsoftOAuth2Api\"},\"credentials\":{\"microsoftOAuth2Api\":{\"id\":\"U2E5p3lreqSi8v1N\",\"name\":\"ms365test.zammad.org\"},\"microsoftGraphSecurityOAuth2Api\":{\"id\":\"b09tqOxzkl0P8UQD\",\"name\":\"ms365test.zammad.org\"}},\"typeVersion\":4.2},{\"id\":\"2e68992e-3080-41fd-9aae-c44dc60dc3b0\",\"name\":\"Find new Zammad Users\",\"type\":\"n8n-nodes-base.compareDatasets\",\"position\":[240,460],\"parameters\":{\"options\":{},\"mergeByFields\":{\"values\":[{\"field1\":\"email\",\"field2\":\"email\"}]}},\"typeVersion\":2.3},{\"id\":\"86dc2c72-d54a-40a9-a64b-fc0bde9a2387\",\"name\":\"Update Zammad User\",\"type\":\"n8n-nodes-base.zammad\",\"position\":[560,140],\"parameters\":{\"id\":\"={{ $json.id }}\",\"operation\":\"update\",\"updateFields\":{\"phone\":\"={{ $json.phone }}\",\"mobile\":\"={{ $json.mobile }}\",\"lastname\":\"={{ $json.lastname }}\",\"firstname\":\"={{ $json.firstname }}\",\"customFieldsUi\":{\"customFieldPairs\":[{\"name\":\"entra_key\",\"value\":\"={{ $json.entra_key }}\"},{\"name\":\"entra_object_type\",\"value\":\"user\"}]}}},\"credentials\":{\"zammadTokenAuthApi\":{\"id\":\"fj5GuzcJuNLQeMxz\",\"name\":\"Zammad Token Auth account\"}},\"typeVersion\":1},{\"id\":\"bc883c6d-ec53-4854-824a-bd76b28077d2\",\"name\":\"Create Zammad User\",\"type\":\"n8n-nodes-base.zammad\",\"position\":[580,540],\"parameters\":{\"lastname\":\"={{ $json.lastname }}\",\"firstname\":\"={{ $json.firstname }}\",\"additionalFields\":{\"email\":\"={{ $json.email }}\",\"phone\":\"={{ $json.phone }}\",\"mobile\":\"={{ $json.mobile }}\",\"customFieldsUi\":{\"customFieldPairs\":[{\"name\":\"entra_key\",\"value\":\"={{ $json.entra_key }}\"},{\"name\":\"entra_object_type\",\"value\":\"user\"}]}}},\"credentials\":{\"zammadTokenAuthApi\":{\"id\":\"fj5GuzcJuNLQeMxz\",\"name\":\"Zammad Token Auth account\"}},\"typeVersion\":1},{\"id\":\"3b57e278-e755-407c-b261-7fe76ce82bb5\",\"name\":\"Deactivate Zammad User\",\"type\":\"n8n-nodes-base.zammad\",\"position\":[600,840],\"parameters\":{\"id\":\"={{ $json.id }}\",\"operation\":\"update\",\"updateFields\":{\"phone\":\"={{ $json.phone }}\",\"active\":false,\"mobile\":\"={{ $json.mobile }}\",\"lastname\":\"={{ $json.lastname }}\",\"firstname\":\"={{ $json.firstname }}\",\"customFieldsUi\":{\"customFieldPairs\":[{\"name\":\"entra_key\",\"value\":\"={{ $json.entra_key }}\"}]}}},\"credentials\":{\"zammadTokenAuthApi\":{\"id\":\"fj5GuzcJuNLQeMxz\",\"name\":\"Zammad Token Auth account\"}},\"typeVersion\":1},{\"id\":\"cdaf8b51-9b4c-4ad0-b8f0-c6921849ed4c\",\"name\":\"Find removed Users\",\"type\":\"n8n-nodes-base.compareDatasets\",\"position\":[240,880],\"parameters\":{\"options\":{},\"resolve\":\"preferInput1\",\"mergeByFields\":{\"values\":[{\"field1\":\"entra_key\",\"field2\":\"entra_key\"}]}},\"typeVersion\":2.3},{\"id\":\"9b37b75e-d694-441e-b5a5-8abeccbf4ed7\",\"name\":\"If\",\"type\":\"n8n-nodes-base.if\",\"position\":[-500,460],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"15da9b4f-46fa-4e9b-bd33-40ae79b88cd5\",\"operator\":{\"type\":\"object\",\"operation\":\"exists\",\"singleValue\":true},\"leftValue\":\"={{ $json }}\",\"rightValue\":\"\"}]}},\"typeVersion\":2.2},{\"id\":\"13ac19a6-6689-4e75-86d4-02ec1c0c64cd\",\"name\":\"Select only active Users and entra_obect_type=\\\"user\\\"\",\"type\":\"n8n-nodes-base.if\",\"position\":[-220,140],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"1c9ca19d-18e3-470e-84cd-593794613c59\",\"operator\":{\"name\":\"filter.operator.equals\",\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $json.entra_object_type }}\",\"rightValue\":\"user\"},{\"id\":\"9187eea8-48ec-4488-9bc9-45235ff88114\",\"operator\":{\"type\":\"boolean\",\"operation\":\"true\",\"singleValue\":true},\"leftValue\":\"={{ $json.active }}\",\"rightValue\":\"\"}]}},\"typeVersion\":2.2}],\"active\":false,\"pinData\":{},\"settings\":{\"executionOrder\":\"v1\"},\"versionId\":\"b726c830-9d26-4289-8f66-485850762df7\",\"connections\":{\"If\":{\"main\":[[{\"node\":\"Zammad Univeral User Object\",\"type\":\"main\",\"index\":0}]]},\"Merge\":{\"main\":[[{\"node\":\"Update Zammad User\",\"type\":\"main\",\"index\":0}]]},\"Get Zammad Users\":{\"main\":[[{\"node\":\"Select only active Users and entra_obect_type=\\\"user\\\"\",\"type\":\"main\",\"index\":0}]]},\"Find removed Users\":{\"main\":[[{\"node\":\"Deactivate Zammad User\",\"type\":\"main\",\"index\":0}],[],[]]},\"Remove outer Array\":{\"main\":[[{\"node\":\"Select Entra Zammad default Group\",\"type\":\"main\",\"index\":0}]]},\"Find new Zammad Users\":{\"main\":[[],[],[],[{\"node\":\"Create Zammad User\",\"type\":\"main\",\"index\":0}]]},\"Get Groups from Entra\":{\"main\":[[{\"node\":\"Remove outer Array\",\"type\":\"main\",\"index\":0}]]},\"Zammad Univeral User Object\":{\"main\":[[{\"node\":\"Merge\",\"type\":\"main\",\"index\":1},{\"node\":\"Find new Zammad Users\",\"type\":\"main\",\"index\":1},{\"node\":\"Find removed Users\",\"type\":\"main\",\"index\":1}]]},\"Get Members of the default group\":{\"main\":[[{\"node\":\"Remove outer Array from Entra User\",\"type\":\"main\",\"index\":0}]]},\"Select Entra Zammad default Group\":{\"main\":[[{\"node\":\"Get Members of the default group\",\"type\":\"main\",\"index\":0}]]},\"When clicking ‘Test workflow’\":{\"main\":[[{\"node\":\"Get Zammad Users\",\"type\":\"main\",\"index\":0},{\"node\":\"Get Groups from Entra\",\"type\":\"main\",\"index\":0}]]},\"Remove outer Array from Entra User\":{\"main\":[[{\"node\":\"If\",\"type\":\"main\",\"index\":0}]]},\"Select only active Users and entra_obect_type=\\\"user\\\"\":{\"main\":[[{\"node\":\"Merge\",\"type\":\"main\",\"index\":0},{\"node\":\"Find new Zammad Users\",\"type\":\"main\",\"index\":0},{\"node\":\"Find removed Users\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "This workflow facilitates seamless synchronization between Entra (Microsoft Azure AD) and Zammad. It automates the following processes:\n\n  1. **Fetch Entra Group Members** : Retrieves users from a designated Entra group. These users are candidates for synchronization.\n  2. **Create Universal User Object** : Extracts key user information, such as email, phone, and name, and formats it for Zammad compatibility.\n  3. **Synchronize with Zammad** : \n     * Identifies users in Zammad who need updates based on Entra data.\n     * Adds new users from Entra to Zammad.\n     * Deactivates users in Zammad if they are no longer in the Entra group.\n\n\n\n## Key Features\n\n  * **Dynamic Matching** : Compares users from Entra with existing Zammad users based on email and updates records accordingly.\n  * **Efficient Management** : Automatically creates, updates, or deactivates Zammad users based on their status in Entra.\n  * **Custom Fields** : Supports custom field mapping, ensuring enriched user profiles in Zammad.\n\n\n\n## Setup Instructions\n\n  1. **Microsoft Entra Integration** :\n\n     * Ensure proper API permissions for accessing Entra groups and members.\n     * Configure Microsoft OAuth2 credentials in n8n.\n  2. **Zammad Integration** :\n\n     * Set up Zammad API credentials with appropriate access rights.\n     * Customize the workflow to include additional fields or map existing fields as needed.\n  3. **Run Workflow** :\n\n     * Trigger the workflow manually or set up an automation schedule (e.g., daily sync).\n     * Review created/updated/deactivated users in Zammad.\n\n\n\n## Use Cases\n\n  * **IT Administration** : Keep your support system in sync with the organization’s Entra data.\n  * **User Onboarding** : Automatically onboard new hires into Zammad based on Entra groups.\n  * **Access Management** : Ensure accurate and up-to-date user records in Zammad.\n\n\n\n## Prerequisites\n\n  * Access to an Entra (Azure AD) environment with group data.\n  * A Zammad instance with API credentials for user management.\n  * A custom field in Zammad User Object (`entra_key`) of type `String`.\n\n\n\n![Bildschirmfoto 20241201 um 13.56.37.png](https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/Bildschirmfoto_2024_12_01_um_13_56_37_a11824383c.png)\n\n  * A custom field in Zammad User Object (`entra_object_type`) of type `Single selection field with two key value pairs \n    * user = User\n    * contact = Contact`\n\n\n\n![Bildschirmfoto 20241201 um 13.57.17.png](https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/Bildschirmfoto_2024_12_01_um_13_57_17_f41b4c1ff4.png)\n\n* * *\n\nThis workflow is fully customizable and can be adapted to your organization’s specific needs. Save time and reduce manual errors by automating your user sync process with this template!\n\nIf you have found an error or have any suggestions, please report them here on [Github](https://github.com/Sirhexalot/n8n-Zammad-Sync-Entra-User-to-Zammad-User).\n",
  "readme_html": "<!--[--><div data-v-006f9244=\"\"><p>This workflow facilitates seamless synchronization between Entra (Microsoft Azure AD) and Zammad. It automates the following processes:</p>\n<ol>\n<li><strong>Fetch Entra Group Members</strong>: Retrieves users from a designated Entra group. These users are candidates for synchronization.</li>\n<li><strong>Create Universal User Object</strong>: Extracts key user information, such as email, phone, and name, and formats it for Zammad compatibility.</li>\n<li><strong>Synchronize with Zammad</strong>:\n<ul>\n<li>Identifies users in Zammad who need updates based on Entra data.</li>\n<li>Adds new users from Entra to Zammad.</li>\n<li>Deactivates users in Zammad if they are no longer in the Entra group.</li>\n</ul>\n</li>\n</ol>\n<h2>Key Features</h2>\n<ul>\n<li><strong>Dynamic Matching</strong>: Compares users from Entra with existing Zammad users based on email and updates records accordingly.</li>\n<li><strong>Efficient Management</strong>: Automatically creates, updates, or deactivates Zammad users based on their status in Entra.</li>\n<li><strong>Custom Fields</strong>: Supports custom field mapping, ensuring enriched user profiles in Zammad.</li>\n</ul>\n<h2>Setup Instructions</h2>\n<ol>\n<li>\n<p><strong>Microsoft Entra Integration</strong>:</p>\n<ul>\n<li>Ensure proper API permissions for accessing Entra groups and members.</li>\n<li>Configure Microsoft OAuth2 credentials in n8n.</li>\n</ul>\n</li>\n<li>\n<p><strong>Zammad Integration</strong>:</p>\n<ul>\n<li>Set up Zammad API credentials with appropriate access rights.</li>\n<li>Customize the workflow to include additional fields or map existing fields as needed.</li>\n</ul>\n</li>\n<li>\n<p><strong>Run Workflow</strong>:</p>\n<ul>\n<li>Trigger the workflow manually or set up an automation schedule (e.g., daily sync).</li>\n<li>Review created/updated/deactivated users in Zammad.</li>\n</ul>\n</li>\n</ol>\n<h2>Use Cases</h2>\n<ul>\n<li><strong>IT Administration</strong>: Keep your support system in sync with the organization’s Entra data.</li>\n<li><strong>User Onboarding</strong>: Automatically onboard new hires into Zammad based on Entra groups.</li>\n<li><strong>Access Management</strong>: Ensure accurate and up-to-date user records in Zammad.</li>\n</ul>\n<h2>Prerequisites</h2>\n<ul>\n<li>Access to an Entra (Azure AD) environment with group data.</li>\n<li>A Zammad instance with API credentials for user management.</li>\n<li>A custom field in Zammad User Object (<code>entra_key</code>) of type <code>String</code>.</li>\n</ul>\n<p><img src=\"https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/Bildschirmfoto_2024_12_01_um_13_56_37_a11824383c.png\" alt=\"Bildschirmfoto 20241201 um 13.56.37.png\"></p>\n<ul>\n<li>A custom field in Zammad User Object (<code>entra_object_type</code>) of type `Single selection field with two key value pairs\n<ul>\n<li>user = User</li>\n<li>contact = Contact`</li>\n</ul>\n</li>\n</ul>\n<p><img src=\"https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/Bildschirmfoto_2024_12_01_um_13_57_17_f41b4c1ff4.png\" alt=\"Bildschirmfoto 20241201 um 13.57.17.png\"></p>\n<hr>\n<p>This workflow is fully customizable and can be adapted to your organization’s specific needs. Save time and reduce manual errors by automating your user sync process with this template!</p>\n<p>If you have found an error or have any suggestions, please report them here on <a href=\"https://github.com/Sirhexalot/n8n-Zammad-Sync-Entra-User-to-Zammad-User\" rel=\"ugc nofollow\" target=\"_blank\">Github</a>.</p>\n</div><!--]-->"
}