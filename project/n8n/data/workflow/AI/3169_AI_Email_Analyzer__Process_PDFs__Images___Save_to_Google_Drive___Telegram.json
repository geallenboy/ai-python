{
  "title": "AI Email Analyzer: Process PDFs, Images & Save to Google Drive + Telegram",
  "url": "https://n8n.io/workflows/3169-ai-email-analyzer-process-pdfs-images-and-save-to-google-drive-telegram/",
  "category": "AI",
  "category_url": "https://n8n.io/workflows/categories/ai/?count=20",
  "author": "Davide",
  "publish_date": "Last update a month ago",
  "content": "",
  "workflow_json": "{\"id\":\"MCzA5RzvO83kNJi7\",\"meta\":{\"instanceId\":\"a4bfc93e975ca233ac45ed7c9227d84cf5a2329310525917adaf3312e10d5462\",\"templateCredsSetupCompleted\":true},\"name\":\"AI Email Analyzer: Process PDFs, Images\",\"tags\":[],\"nodes\":[{\"id\":\"0526c603-2c35-4f65-88ee-e143f7aa3ca4\",\"name\":\"Email Trigger (IMAP)\",\"type\":\"n8n-nodes-base.emailReadImap\",\"position\":[-80,500],\"parameters\":{\"options\":{},\"downloadAttachments\":true},\"credentials\":{\"imap\":{\"id\":\"k31W9oGddl9pMDy4\",\"name\":\"IMAP info@n3witalia.com\"}},\"typeVersion\":2},{\"id\":\"9b0b83d1-7d7c-4858-aedc-4816e2f02276\",\"name\":\"DeepSeek R1\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\"position\":[1320,980],\"parameters\":{\"model\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"deepseek/deepseek-r1:free\",\"cachedResultName\":\"deepseek/deepseek-r1:free\"},\"options\":{}},\"credentials\":{\"openAiApi\":{\"id\":\"XJTqRiKFJpFs5MuX\",\"name\":\"OpenRouter account\"}},\"typeVersion\":1.2},{\"id\":\"2e8ad64a-d767-441e-9e12-7a75f5ed4c1c\",\"name\":\"Email Summarization Chain\",\"type\":\"@n8n/n8n-nodes-langchain.chainSummarization\",\"position\":[1360,800],\"parameters\":{\"options\":{\"binaryDataKey\":\"={{ $json.data }}\",\"summarizationMethodAndPrompts\":{\"values\":{\"prompt\":\"=Write a concise summary of the following in max 100 words :\\n\\n\\\"{{ $json.data }}\\\"\\n\\nDo not enter the total number of words used.\",\"combineMapPrompt\":\"=## Email Summarization System Prompt\\n\\nYou are a specialized AI assistant focused exclusively on creating precise, concise summaries of emails. Your task is to analyze the complete email text provided as input and produce a clear, comprehensive summary that captures all essential information in a cohesive narrative format.\\n\\n### Your responsibilities:\\n\\n1. Extract and summarize the main topic and purpose of the email\\n2. Identify key points, requests, deadlines, or action items mentioned\\n3. Preserve critical details like dates, times, locations, and names\\n4. Maintain the original tone and urgency level of the message\\n5. Organize information in order of importance\\n6. Remove unnecessary pleasantries, redundancies, and filler content\\n\\n### Summary format:\\n\\n- Begin with a one-sentence overview of the email's main purpose\\n- Present all key information in a cohesive paragraph format (no bullet points)\\n- Follow a logical flow from most to least important information\\n- Include any critical deadlines, requests, or action items within the narrative\\n- Keep the summary to 3-5 sentences total\\n- Use clear, straightforward language with appropriate transitions between ideas\\n- Preserve the original intent and meaning without introducing new information\\n\\n### What to exclude:\\n\\n- Greetings and sign-offs\\n- Redundant information\\n- Minor details that don't affect the main message\\n- Your own opinions or interpretations\\n- Information not explicitly stated in the email\\n\\nThe email text to summarize is:\\n{{$json.data}}\"}}},\"operationMode\":\"nodeInputBinary\"},\"typeVersion\":2},{\"id\":\"97f2b5f8-b2ba-4bd5-a951-c97e64e6f833\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-140,-280],\"parameters\":{\"color\":3,\"width\":580,\"height\":400,\"content\":\"# AI Email Analyzer: Process PDFs, Images \\n\\nThis is a powerful tool for automating email analysis and summarization, saving time and ensuring that important information is easily accessible and actionable.\\n\\nAll summaries are saved on a Google Sheet and identified by a numeric ID referring to the single email.\\n\\n## Preliminary step:\\n- Clone this [Google Drive Sheet](https://docs.google.com/spreadsheets/d/1rBa0RI6XFfMerylVCV0dlKhJT_f4UAd8S6jyYX4aRRo/edit?usp=sharing)\\n- Insert  your Chat_ID in Telegram node\\n- Choose the AI model you prefer\\n\"},\"typeVersion\":1},{\"id\":\"d2012cbc-0e79-4579-ac3d-e5e84ad56dc1\",\"name\":\"Switch\",\"type\":\"n8n-nodes-base.switch\",\"position\":[960,120],\"parameters\":{\"rules\":{\"values\":[{\"outputKey\":\"pdf\",\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"loose\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"31b7fb0b-3149-479e-852a-52c1ec8935ca\",\"operator\":{\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $binary.data.fileExtension }}\",\"rightValue\":\"pdf\"}]},\"renameOutput\":true},{\"outputKey\":\"image\",\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"loose\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"9fe6411d-cf35-4fdd-a9ad-8c96f0a5cf66\",\"operator\":{\"type\":\"string\",\"operation\":\"regex\"},\"leftValue\":\"={{ $binary.data.fileExtension }}\",\"rightValue\":\"=/^(jpg|png)$/i\"}]},\"renameOutput\":true}]},\"options\":{},\"looseTypeValidation\":true},\"typeVersion\":3.2},{\"id\":\"8a9d55b8-9ba5-4a6f-ae13-9c529875a2a4\",\"name\":\"Structured Output Parser\",\"type\":\"@n8n/n8n-nodes-langchain.outputParserStructured\",\"position\":[2040,-320],\"parameters\":{\"schemaType\":\"manual\",\"inputSchema\":\"{\\n\\t\\\"type\\\": \\\"object\\\",\\n\\t\\\"properties\\\": {\\n\\t\\t\\\"content\\\": {\\n\\t\\t\\t\\\"type\\\": \\\"string\\\"\\n\\t\\t}\\n\\t}\\n}\"},\"typeVersion\":1.2},{\"id\":\"658696f5-08e0-4d51-89bc-2a1c31576700\",\"name\":\"Split Out\",\"type\":\"n8n-nodes-base.splitOut\",\"position\":[2540,-420],\"parameters\":{\"options\":{},\"fieldToSplitOut\":\"=output\"},\"typeVersion\":1},{\"id\":\"d2ba57c3-9e0e-4a7d-957d-216763e357c3\",\"name\":\"Aggregate\",\"type\":\"n8n-nodes-base.aggregate\",\"position\":[3660,220],\"parameters\":{\"options\":{},\"fieldsToAggregate\":{\"fieldToAggregate\":[{\"fieldToAggregate\":\"data.output\"}]}},\"typeVersion\":1},{\"id\":\"10e6d3c6-10f6-4fea-be37-b5ee50e0b529\",\"name\":\"OpenRouter Chat Model1\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatOpenRouter\",\"position\":[3920,400],\"parameters\":{\"model\":\"google/gemini-2.0-flash-exp:free\",\"options\":{}},\"credentials\":{\"openRouterApi\":{\"id\":\"pb06rfB4xmxzVe3Q\",\"name\":\"OpenRouter\"}},\"typeVersion\":1},{\"id\":\"dcdcb7f2-669d-4e1b-a3f2-49a5b6c760b1\",\"name\":\"Contain attachments?\",\"type\":\"n8n-nodes-base.if\",\"position\":[260,500],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"5cf96104-c887-44fe-b528-30171943dd15\",\"operator\":{\"type\":\"boolean\",\"operation\":\"true\",\"singleValue\":true},\"leftValue\":\"={{ $binary.isNotEmpty() }}\",\"rightValue\":\"\"}]}},\"typeVersion\":2.2},{\"id\":\"6280db8e-42e4-4f88-bbe7-4e65eff3a34f\",\"name\":\"Get PDF and images attachments\",\"type\":\"n8n-nodes-base.code\",\"position\":[600,300],\"parameters\":{\"jsCode\":\"let results = [];\\n\\nfor (const item of $input.all()) {\\n  for (key of Object.keys(item.binary)) {\\n        results.push({\\n            json: {},\\n            binary: {\\n                data: item.binary[key],\\n            }\\n        });\\n    }\\n}\\n\\nreturn results;\"},\"typeVersion\":2},{\"id\":\"53a7333d-fb49-46d4-9e3b-d186a5e416ca\",\"name\":\"Extract from PDF\",\"type\":\"n8n-nodes-base.extractFromFile\",\"position\":[1460,-540],\"parameters\":{\"options\":{},\"operation\":\"pdf\"},\"typeVersion\":1},{\"id\":\"9d5c3b14-a3b0-4d2b-88d5-5a2c21a6907f\",\"name\":\"PDF Analyzer\",\"type\":\"@n8n/n8n-nodes-langchain.chainLlm\",\"position\":[1780,-540],\"parameters\":{\"text\":\"=## PDF Summarization System Prompt\\n\\nYou are a specialized AI assistant tasked with creating concise, accurate summaries of documents. Your goal is to extract and distill the most important information from the content provided as input and present it in a clear, precise plain text summary.\\n\\n### Your responsibilities:\\n\\n1. Identify the main topic and purpose of the document\\n2. Extract key points, arguments, findings, or conclusions\\n3. Preserve essential data points, statistics, dates, and figures\\n4. Recognize and highlight critical information and takeaways\\n5. Maintain the original document's logical structure in your summary\\n6. Prioritize information based on its significance to the document's purpose\\n\\n### Summary format:\\n\\n- Provide your summary in plain text only (no formatting)\\n- Begin with a concise overview of the document's main topic and purpose\\n- Present important points in a logical, sequential narrative\\n- Use clear, direct language that accurately represents the original content\\n- Maintain appropriate context for all extracted information\\n- Keep the summary concise while including all crucial information\\n- Use proper transitions between topics to maintain readability\\n\\n### What to exclude:\\n\\n- Minor details that don't contribute to the main points\\n- Repetitive information\\n- Extensive examples unless they're critical to understanding\\n- Citations, references, and bibliographic details unless specifically important\\n- Decorative or non-essential images (describe important visualized data if relevant)\\n- Your own interpretations or opinions not supported by the document\\n\\n{{ $json.text }}\",\"promptType\":\"define\",\"hasOutputParser\":true},\"typeVersion\":1.5},{\"id\":\"ba6f6d2f-9a13-4bb4-80fb-72f5c4124473\",\"name\":\"Save summary PDF\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[2580,-800],\"parameters\":{\"columns\":{\"value\":{\"ID\":\"={{ $('Email Trigger (IMAP)').item.json.metadata[\\\"x-message-id\\\"] }}\",\"DATE\":\"={{ $now.format('dd/LL/yyyy') }}\",\"TYPE\":\"pdf\",\"EMAIL\":\"={{ $('Email Trigger (IMAP)').item.json.from }}\",\"SUBJECT\":\"={{ $('Email Trigger (IMAP)').item.json.subject }}\",\"SUMMARY\":\"={{ $json.output.content }}\"},\"schema\":[{\"id\":\"DATE\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"DATE\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"EMAIL\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"EMAIL\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"ID\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"ID\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"SUBJECT\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"SUBJECT\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"TYPE\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"TYPE\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"SUMMARY\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"SUMMARY\",\"defaultMatch\":false,\"canBeUsedToMatch\":true}],\"mappingMode\":\"defineBelow\",\"matchingColumns\":[],\"attemptToConvertTypes\":false,\"convertFieldsToString\":false},\"options\":{},\"operation\":\"append\",\"sheetName\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"gid=0\",\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1rBa0RI6XFfMerylVCV0dlKhJT_f4UAd8S6jyYX4aRRo/edit#gid=0\",\"cachedResultName\":\"Foglio1\"},\"documentId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"1rBa0RI6XFfMerylVCV0dlKhJT_f4UAd8S6jyYX4aRRo\",\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1rBa0RI6XFfMerylVCV0dlKhJT_f4UAd8S6jyYX4aRRo/edit?usp=drivesdk\",\"cachedResultName\":\"Analyze Email + Attachments\"}},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"JYR6a64Qecd6t8Hb\",\"name\":\"Google Sheets account\"}},\"typeVersion\":4.5},{\"id\":\"4c7ff16e-8649-4364-9aa6-c06670f4c36a\",\"name\":\"All summaries\",\"type\":\"n8n-nodes-base.merge\",\"position\":[3080,220],\"parameters\":{\"numberInputs\":3},\"typeVersion\":3},{\"id\":\"46af5694-6b28-45e7-8b1b-d77482b326e7\",\"name\":\"Map image summaries\",\"type\":\"n8n-nodes-base.set\",\"position\":[2020,280],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"11592bed-7555-4e61-a692-d71b1a733fd4\",\"name\":\"content\",\"type\":\"string\",\"value\":\"={{ $json.content }}\"}]}},\"typeVersion\":3.4},{\"id\":\"dc5858b7-c30b-413b-a1d0-143a068f2c87\",\"name\":\"Upload attachments\",\"type\":\"n8n-nodes-base.googleDrive\",\"position\":[1440,480],\"parameters\":{\"name\":\"={{$now.format('yyyyLLddhhiiss')}}-{{ $binary.data.fileName }}\",\"driveId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"My Drive\"},\"options\":{},\"folderId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"1CV5PgqBQIVFEacmbApdCApjNEtoNPzXQ\",\"cachedResultUrl\":\"https://drive.google.com/drive/folders/1CV5PgqBQIVFEacmbApdCApjNEtoNPzXQ\",\"cachedResultName\":\"Analyze attachments\"}},\"credentials\":{\"googleDriveOAuth2Api\":{\"id\":\"HEy5EuZkgPZVEa9w\",\"name\":\"Google Drive account (n3w.it)\"}},\"typeVersion\":3},{\"id\":\"9537f678-163c-40de-93f3-9934f4ae2ad0\",\"name\":\"Email summary\",\"type\":\"n8n-nodes-base.set\",\"position\":[2000,800],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"ef348518-a9fb-4ea9-bd70-9dcf3bff092a\",\"name\":\"content\",\"type\":\"string\",\"value\":\"={{ $json.response.text }}\"}]}},\"typeVersion\":3.4},{\"id\":\"ba0c45d9-7d5a-413e-9034-3e22a79ead77\",\"name\":\"Send final summary\",\"type\":\"n8n-nodes-base.telegram\",\"position\":[4340,220],\"webhookId\":\"9c8e4675-762e-47dd-8cef-b94a5261ffd4\",\"parameters\":{\"text\":\"={{ $json.text }}\",\"chatId\":\"CHAT_ID\",\"additionalFields\":{}},\"credentials\":{\"telegramApi\":{\"id\":\"0hSq9VwaiJifiscT\",\"name\":\"Telegram account\"}},\"typeVersion\":1.2},{\"id\":\"7a97052b-37c5-4754-ac1a-0f1a20569df7\",\"name\":\"Create final summary\",\"type\":\"@n8n/n8n-nodes-langchain.chainLlm\",\"position\":[3940,220],\"parameters\":{\"text\":\"=The inputs to synthesize are:\\n'''\\n{{ $json.output }}\\n'''\",\"messages\":{\"messageValues\":[{\"message\":\"## Comprehensive Email Analysis System Prompt\\n\\nYou are a specialized AI assistant tasked with creating a unified, concise summary of an email and all its attachments. Your input includes a summary of the email text, summaries of any images, and summaries of any PDF attachments. Your goal is to synthesize all this information into a single coherent summary that captures the essential message and purpose.\\n\\n### Your responsibilities:\\n\\n1. Identify the overarching theme or purpose connecting the email and its attachments\\n2. Recognize relationships between the email content and the attached materials\\n3. Extract and consolidate the most critical information from all sources\\n4. Maintain proper context when combining information from different sources\\n5. Prioritize information based on relevance to the email's main purpose\\n6. Create a unified narrative that flows logically between email content and attachments\\n\\n### Input structure:\\n- Email summary: A summary of the main email text\\n- Image descriptions: Summaries of any images attached to the email\\n- PDF summaries: Condensed versions of any PDF documents attached\\n\\n### Output format:\\n\\n- Provide your summary in plain text only\\n- Begin with a one-sentence statement of the email's overall purpose and theme\\n- Present a unified narrative that integrates information from the email and all attachments\\n- Organize information by importance and relevance, not by source\\n- Keep the final summary concise (5-7 sentences maximum) while including all essential information\\n- Use clear transitions to maintain coherence when moving between different information sources\\n- Preserve the original intent and tone of the communication\\n\\n### What to include:\\n\\n- The main topic and purpose of the communication\\n- Key points from both the email and attachments\\n- Critical requests, deadlines, or action items\\n- Essential details like dates, figures, or specific references\\n- Contextual information that clarifies the purpose of attachments\\n\\n### What to exclude:\\n\\n- Redundant information repeated across multiple sources\\n- Minor details that don't contribute to understanding the main message\\n- Excessive descriptions of attachments beyond their relevance to the email's purpose\\n- Your own interpretations beyond what's supported by the input materials\"}]},\"promptType\":\"define\"},\"typeVersion\":1.5},{\"id\":\"99b4c22c-a29b-4b72-bc4a-bed5c1320386\",\"name\":\"Save summary image\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[2020,20],\"parameters\":{\"columns\":{\"value\":{\"ID\":\"={{ $('Email Trigger (IMAP)').item.json.metadata[\\\"x-message-id\\\"] }}\",\"DATE\":\"={{ $now.format('dd/LL/yyyy') }}\",\"TYPE\":\"image\",\"EMAIL\":\"={{ $('Email Trigger (IMAP)').item.json.from }}\",\"SUBJECT\":\"={{ $('Email Trigger (IMAP)').item.json.subject }}\",\"SUMMARY\":\"={{ $json.content }}\"},\"schema\":[{\"id\":\"DATE\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"DATE\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"EMAIL\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"EMAIL\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"ID\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"ID\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"SUBJECT\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"SUBJECT\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"TYPE\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"TYPE\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"SUMMARY\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"SUMMARY\",\"defaultMatch\":false,\"canBeUsedToMatch\":true}],\"mappingMode\":\"defineBelow\",\"matchingColumns\":[],\"attemptToConvertTypes\":false,\"convertFieldsToString\":false},\"options\":{},\"operation\":\"append\",\"sheetName\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"gid=0\",\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1rBa0RI6XFfMerylVCV0dlKhJT_f4UAd8S6jyYX4aRRo/edit#gid=0\",\"cachedResultName\":\"Foglio1\"},\"documentId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"1rBa0RI6XFfMerylVCV0dlKhJT_f4UAd8S6jyYX4aRRo\",\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1rBa0RI6XFfMerylVCV0dlKhJT_f4UAd8S6jyYX4aRRo/edit?usp=drivesdk\",\"cachedResultName\":\"Analyze Email + Attachments\"}},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"JYR6a64Qecd6t8Hb\",\"name\":\"Google Sheets account\"}},\"typeVersion\":4.5},{\"id\":\"2b32c086-c436-436e-93c3-da88e6f08247\",\"name\":\"Save summary text\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[2020,1040],\"parameters\":{\"columns\":{\"value\":{\"ID\":\"={{ $('Email Trigger (IMAP)').item.json.metadata[\\\"x-message-id\\\"] }}\",\"DATE\":\"={{ $now.format('dd/LL/yyyy') }}\",\"TYPE\":\"email\",\"EMAIL\":\"={{ $('Email Trigger (IMAP)').item.json.from }}\",\"SUBJECT\":\"={{ $('Email Trigger (IMAP)').item.json.subject }}\",\"SUMMARY\":\"={{ $json.response.text }}\"},\"schema\":[{\"id\":\"DATE\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"DATE\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"EMAIL\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"EMAIL\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"ID\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"ID\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"SUBJECT\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"SUBJECT\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"TYPE\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"TYPE\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"SUMMARY\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"SUMMARY\",\"defaultMatch\":false,\"canBeUsedToMatch\":true}],\"mappingMode\":\"defineBelow\",\"matchingColumns\":[],\"attemptToConvertTypes\":false,\"convertFieldsToString\":false},\"options\":{},\"operation\":\"append\",\"sheetName\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"gid=0\",\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1rBa0RI6XFfMerylVCV0dlKhJT_f4UAd8S6jyYX4aRRo/edit#gid=0\",\"cachedResultName\":\"Foglio1\"},\"documentId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"1rBa0RI6XFfMerylVCV0dlKhJT_f4UAd8S6jyYX4aRRo\",\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1rBa0RI6XFfMerylVCV0dlKhJT_f4UAd8S6jyYX4aRRo/edit?usp=drivesdk\",\"cachedResultName\":\"Analyze Email + Attachments\"}},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"JYR6a64Qecd6t8Hb\",\"name\":\"Google Sheets account\"}},\"typeVersion\":4.5},{\"id\":\"135bf3c3-e45f-4363-857b-2345e0bc7964\",\"name\":\"Convert text\",\"type\":\"n8n-nodes-base.markdown\",\"position\":[860,940],\"parameters\":{\"html\":\"={{ $json.textHtml }}\",\"options\":{}},\"typeVersion\":1},{\"id\":\"0c2cf33a-d7bb-438d-a9c9-06a77f91b56e\",\"name\":\"Gemini 2.0 Flash\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatOpenRouter\",\"position\":[1700,-320],\"parameters\":{\"model\":\"google/gemini-2.0-flash-exp:free\",\"options\":{}},\"credentials\":{\"openRouterApi\":{\"id\":\"pb06rfB4xmxzVe3Q\",\"name\":\"OpenRouter\"}},\"typeVersion\":1},{\"id\":\"50d5fd05-db5f-451c-92ce-e0f42d8322f9\",\"name\":\"Parsing\",\"type\":\"n8n-nodes-base.code\",\"position\":[3360,220],\"parameters\":{\"jsCode\":\"const inputData = $input.all();\\n\\nconst outputData = inputData.map(item => {\\n  \\n  const outputValue = item.json.output || item.json.content;\\n\\n  return {\\n    data: {\\n      output: outputValue \\n    }\\n  };\\n});\\n\\nreturn outputData;\"},\"typeVersion\":2},{\"id\":\"801659a1-cc9d-4014-9403-d6d0952e856a\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[520,220],\"parameters\":{\"width\":260,\"height\":240,\"content\":\"Get all attachments present in the email (in this WF only PDFs and images are considered)\"},\"typeVersion\":1},{\"id\":\"15dc13b9-b35c-43d3-8af9-a8793382a2b6\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1740,-600],\"parameters\":{\"width\":340,\"height\":200,\"content\":\"Analyze the content of PDF files and make a summary for each one\"},\"typeVersion\":1},{\"id\":\"6c68ce17-13f1-4aba-9f43-e4003e5cd723\",\"name\":\"Sticky Note3\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1380,120],\"parameters\":{\"height\":200,\"content\":\"Analyze the content of the image and describe it accurately\"},\"typeVersion\":1},{\"id\":\"ff746258-dc11-43aa-afe9-06c9dfb3708b\",\"name\":\"Analyze image\",\"type\":\"@n8n/n8n-nodes-langchain.openAi\",\"position\":[1440,180],\"parameters\":{\"text\":\"## Image Analysis System Prompt\\n\\nYou are a specialized AI assistant focused on analyzing images. Your task is to carefully examine the image provided as input and produce a detailed, accurate description in plain text format.\\n\\n### Your responsibilities:\\n\\n1. Observe and describe the main subject(s) or focal point(s) of the image\\n2. Identify notable objects, people, animals, or other elements present\\n3. Describe the setting, background, and environment if applicable\\n4. Note any text visible in the image, transcribing it accurately\\n5. Recognize any actions, activities, or events taking place\\n6. Identify relevant contextual information (time of day, weather, season, etc.)\\n7. Describe colors, lighting, composition, and other visual elements when relevant\\n\\n### Response format:\\n\\n- Provide your analysis in plain text only (no HTML, markdown, or other formatting)\\n- Begin with a concise overview of what the image depicts\\n- Follow with a detailed description covering all significant elements\\n- Organize information logically, typically moving from main subjects to background details\\n- Use clear, descriptive language that accurately represents what is actually visible\\n- Keep descriptions objective and factual\\n\\n### What to exclude:\\n\\n- Speculation about elements not clearly visible in the image\\n- Subjective judgments or interpretations beyond what is objectively present\\n- Personal opinions about the quality or purpose of the image\\n- Complex technical analysis unless specifically relevant\\n- Any formatting beyond plain text\\n\\nThe image to analyze is the one provided in the input.\",\"modelId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"gpt-4o-mini\",\"cachedResultName\":\"GPT-4O-MINI\"},\"options\":{},\"resource\":\"image\",\"inputType\":\"base64\",\"operation\":\"analyze\"},\"credentials\":{\"openAiApi\":{\"id\":\"CDX6QM4gLYanh0P4\",\"name\":\"OpenAi account\"}},\"typeVersion\":1.8},{\"id\":\"ce353f02-72ff-49bf-9297-5a2b3229fa49\",\"name\":\"Sticky Note4\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1340,740],\"parameters\":{\"width\":320,\"height\":180,\"content\":\"Analyze the content of the email and summarize it\"},\"typeVersion\":1},{\"id\":\"01ee4c00-5993-47ce-af04-320cd3319593\",\"name\":\"Sticky Note5\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[3060,100],\"parameters\":{\"width\":720,\"height\":80,\"content\":\"All the summaries of the email components (text, PDF, images) are aggregated and a final summary is generated\"},\"typeVersion\":1}],\"active\":false,\"pinData\":{},\"settings\":{\"executionOrder\":\"v1\"},\"versionId\":\"30310971-f23c-4761-823c-36ddad8bc8dd\",\"connections\":{\"Switch\":{\"main\":[[{\"node\":\"Upload attachments\",\"type\":\"main\",\"index\":0},{\"node\":\"Extract from PDF\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Upload attachments\",\"type\":\"main\",\"index\":0},{\"node\":\"Analyze image\",\"type\":\"main\",\"index\":0}]]},\"Parsing\":{\"main\":[[{\"node\":\"Aggregate\",\"type\":\"main\",\"index\":0}]]},\"Aggregate\":{\"main\":[[{\"node\":\"Create final summary\",\"type\":\"main\",\"index\":0}]]},\"Split Out\":{\"main\":[[{\"node\":\"All summaries\",\"type\":\"main\",\"index\":0}]]},\"DeepSeek R1\":{\"ai_languageModel\":[[{\"node\":\"Email Summarization Chain\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"Convert text\":{\"main\":[[{\"node\":\"Email Summarization Chain\",\"type\":\"main\",\"index\":0}]]},\"PDF Analyzer\":{\"main\":[[{\"node\":\"Save summary PDF\",\"type\":\"main\",\"index\":0},{\"node\":\"Split Out\",\"type\":\"main\",\"index\":0}]]},\"All summaries\":{\"main\":[[{\"node\":\"Parsing\",\"type\":\"main\",\"index\":0}]]},\"Analyze image\":{\"main\":[[{\"node\":\"Save summary image\",\"type\":\"main\",\"index\":0},{\"node\":\"Map image summaries\",\"type\":\"main\",\"index\":0}]]},\"Email summary\":{\"main\":[[{\"node\":\"All summaries\",\"type\":\"main\",\"index\":2}]]},\"Extract from PDF\":{\"main\":[[{\"node\":\"PDF Analyzer\",\"type\":\"main\",\"index\":0}]]},\"Gemini 2.0 Flash\":{\"ai_languageModel\":[[{\"node\":\"PDF Analyzer\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"Save summary PDF\":{\"main\":[[]]},\"Save summary text\":{\"main\":[[]]},\"Save summary image\":{\"main\":[[]]},\"Upload attachments\":{\"main\":[[]]},\"Map image summaries\":{\"main\":[[{\"node\":\"All summaries\",\"type\":\"main\",\"index\":1}]]},\"Contain attachments?\":{\"main\":[[{\"node\":\"Get PDF and images attachments\",\"type\":\"main\",\"index\":0},{\"node\":\"Convert text\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Convert text\",\"type\":\"main\",\"index\":0}]]},\"Create final summary\":{\"main\":[[{\"node\":\"Send final summary\",\"type\":\"main\",\"index\":0}]]},\"Email Trigger (IMAP)\":{\"main\":[[{\"node\":\"Contain attachments?\",\"type\":\"main\",\"index\":0}]]},\"OpenRouter Chat Model1\":{\"ai_languageModel\":[[{\"node\":\"Create final summary\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"Structured Output Parser\":{\"ai_outputParser\":[[{\"node\":\"PDF Analyzer\",\"type\":\"ai_outputParser\",\"index\":0}]]},\"Email Summarization Chain\":{\"main\":[[{\"node\":\"Save summary text\",\"type\":\"main\",\"index\":0},{\"node\":\"Email summary\",\"type\":\"main\",\"index\":0}]]},\"Get PDF and images attachments\":{\"main\":[[{\"node\":\"Switch\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "This workflow automates the process of **analyzing emails and their attachments** (PDFs and images) using **AI models** (DeepSeek, Gemini, and OpenRouter). It extracts and summarizes the content of emails and attachments, saves the summaries to **Google Sheets** , and sends a final consolidated summary via **Telegram**.\n\nThis is a powerful tool for automating email analysis and summarization, saving time and ensuring that important information is easily accessible and actionable.\n\nBelow is a breakdown of the workflow:\n\n* * *\n\n#### **1\\. How It Works**\n\nThe workflow is designed to process incoming emails, analyze their content and attachments, and generate summaries. Here's how it works:\n\n  1. **Email Trigger** :\n\n     * The workflow starts with the **Email Trigger (IMAP)** node, which monitors an email inbox for new emails.\n     * If an email contains attachments, the workflow processes them.\n  2. **Check for Attachments** :\n\n     * The **Contain Attachments?** node checks if the email has attachments.\n     * If attachments are present, the workflow proceeds to process them.\n  3. **Process Attachments** :\n\n     * The **Get PDF and Images Attachments** node extracts PDF and image attachments from the email.\n     * The **Switch** node separates PDFs and images for further processing: \n       * **PDFs** : The **Extract from PDF** node extracts text from PDFs, and the **PDF Analyzer** node summarizes the content.\n       * **Images** : The **Analyze Image** node uses AI to describe the content of images.\n  4. **Summarize Email Content** :\n\n     * The **Convert Text** node converts the email's HTML content to plain text.\n     * The **Email Summarization Chain** node uses AI to generate a summary of the email's text content.\n  5. **Save Summaries** :\n\n     * The **Save Summary PDF** , **Save Summary Image** , and **Save Summary Text** nodes save the summaries of PDFs, images, and email text, respectively, to **Google Sheets**.\n  6. **Consolidate Summaries** :\n\n     * The **All Summaries** node aggregates the summaries of the email text, PDFs, and images.\n     * The **Create Final Summary** node uses AI to generate a unified summary of all the content.\n  7. **Send Final Summary** :\n\n     * The **Send Final Summary** node sends the consolidated summary via **Telegram** to a specified chat ID.\n\n\n\n* * *\n\n#### **2\\. Set Up Steps**\n\nTo set up and use this workflow in n8n, follow these steps:\n\n  1. **IMAP Configuration** :\n\n     * Set up **IMAP** credentials in n8n for the **Email Trigger (IMAP)** node.\n     * Ensure the email account is accessible via IMAP.\n  2. **AI Model Configuration** :\n\n     * Configure the **DeepSeek** , **Gemini** , and **OpenRouter** credentials in n8n for the **Email Summarization Chain** , **PDF Analyzer** , and **Create Final Summary** nodes.\n     * Ensure the AI models are set up to generate summaries.\n  3. **Google Sheets Integration** :\n\n     * Set up **Google Sheets** credentials in n8n for the **Save Summary PDF** , **Save Summary Image** , and **Save Summary Text** nodes.\n     * Specify the Google Sheet and worksheet where the summaries will be saved.\n  4. **Telegram Integration** :\n\n     * Set up **Telegram** credentials in n8n for the **Send Final Summary** node.\n     * Insert your **Chat ID** in the Telegram node to receive the final summary.\n  5. **Test the Workflow** :\n\n     * Send an email with attachments (PDFs and images) to the monitored email account.\n     * The workflow will: \n       * Extract and summarize the email content and attachments.\n       * Save the summaries to Google Sheets.\n       * Send a consolidated summary via Telegram.\n  6. **Optional Customization** :\n\n     * replace IMAP trigger with Gmail or Outlook trigger\n     * Modify the workflow to include additional features, such as:\n     * Adding more AI models for different types of analysis.\n     * Sending notifications via other channels (e.g., Slack, email).\n     * Integrating with other storage services (e.g., Dropbox, AWS S3).\n\n\n\n* * *\n\n### **Need help customizing?**\n\n[Contact me](mailto:info@n3w.it) for consulting and support or add me on [Linkedin](https://www.linkedin.com/in/davideboizza/).\n",
  "readme_html": "<!--[--><div data-v-006f9244=\"\"><p>This workflow automates the process of <strong>analyzing emails and their attachments</strong> (PDFs and images) using <strong>AI models</strong> (DeepSeek, Gemini, and OpenRouter). It extracts and summarizes the content of emails and attachments, saves the summaries to <strong>Google Sheets</strong>, and sends a final consolidated summary via <strong>Telegram</strong>.</p>\n<p>This is a powerful tool for automating email analysis and summarization, saving time and ensuring that important information is easily accessible and actionable.</p>\n<p>Below is a breakdown of the workflow:</p>\n<hr>\n<h4><strong>1. How It Works</strong></h4>\n<p>The workflow is designed to process incoming emails, analyze their content and attachments, and generate summaries. Here's how it works:</p>\n<ol>\n<li>\n<p><strong>Email Trigger</strong>:</p>\n<ul>\n<li>The workflow starts with the <strong>Email Trigger (IMAP)</strong> node, which monitors an email inbox for new emails.</li>\n<li>If an email contains attachments, the workflow processes them.</li>\n</ul>\n</li>\n<li>\n<p><strong>Check for Attachments</strong>:</p>\n<ul>\n<li>The <strong>Contain Attachments?</strong> node checks if the email has attachments.</li>\n<li>If attachments are present, the workflow proceeds to process them.</li>\n</ul>\n</li>\n<li>\n<p><strong>Process Attachments</strong>:</p>\n<ul>\n<li>The <strong>Get PDF and Images Attachments</strong> node extracts PDF and image attachments from the email.</li>\n<li>The <strong>Switch</strong> node separates PDFs and images for further processing:\n<ul>\n<li><strong>PDFs</strong>: The <strong>Extract from PDF</strong> node extracts text from PDFs, and the <strong>PDF Analyzer</strong> node summarizes the content.</li>\n<li><strong>Images</strong>: The <strong>Analyze Image</strong> node uses AI to describe the content of images.</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><strong>Summarize Email Content</strong>:</p>\n<ul>\n<li>The <strong>Convert Text</strong> node converts the email's HTML content to plain text.</li>\n<li>The <strong>Email Summarization Chain</strong> node uses AI to generate a summary of the email's text content.</li>\n</ul>\n</li>\n<li>\n<p><strong>Save Summaries</strong>:</p>\n<ul>\n<li>The <strong>Save Summary PDF</strong>, <strong>Save Summary Image</strong>, and <strong>Save Summary Text</strong> nodes save the summaries of PDFs, images, and email text, respectively, to <strong>Google Sheets</strong>.</li>\n</ul>\n</li>\n<li>\n<p><strong>Consolidate Summaries</strong>:</p>\n<ul>\n<li>The <strong>All Summaries</strong> node aggregates the summaries of the email text, PDFs, and images.</li>\n<li>The <strong>Create Final Summary</strong> node uses AI to generate a unified summary of all the content.</li>\n</ul>\n</li>\n<li>\n<p><strong>Send Final Summary</strong>:</p>\n<ul>\n<li>The <strong>Send Final Summary</strong> node sends the consolidated summary via <strong>Telegram</strong> to a specified chat ID.</li>\n</ul>\n</li>\n</ol>\n<hr>\n<h4><strong>2. Set Up Steps</strong></h4>\n<p>To set up and use this workflow in n8n, follow these steps:</p>\n<ol>\n<li>\n<p><strong>IMAP Configuration</strong>:</p>\n<ul>\n<li>Set up <strong>IMAP</strong> credentials in n8n for the <strong>Email Trigger (IMAP)</strong> node.</li>\n<li>Ensure the email account is accessible via IMAP.</li>\n</ul>\n</li>\n<li>\n<p><strong>AI Model Configuration</strong>:</p>\n<ul>\n<li>Configure the <strong>DeepSeek</strong>, <strong>Gemini</strong>, and <strong>OpenRouter</strong> credentials in n8n for the <strong>Email Summarization Chain</strong>, <strong>PDF Analyzer</strong>, and <strong>Create Final Summary</strong> nodes.</li>\n<li>Ensure the AI models are set up to generate summaries.</li>\n</ul>\n</li>\n<li>\n<p><strong>Google Sheets Integration</strong>:</p>\n<ul>\n<li>Set up <strong>Google Sheets</strong> credentials in n8n for the <strong>Save Summary PDF</strong>, <strong>Save Summary Image</strong>, and <strong>Save Summary Text</strong> nodes.</li>\n<li>Specify the Google Sheet and worksheet where the summaries will be saved.</li>\n</ul>\n</li>\n<li>\n<p><strong>Telegram Integration</strong>:</p>\n<ul>\n<li>Set up <strong>Telegram</strong> credentials in n8n for the <strong>Send Final Summary</strong> node.</li>\n<li>Insert your <strong>Chat ID</strong> in the Telegram node to receive the final summary.</li>\n</ul>\n</li>\n<li>\n<p><strong>Test the Workflow</strong>:</p>\n<ul>\n<li>Send an email with attachments (PDFs and images) to the monitored email account.</li>\n<li>The workflow will:\n<ul>\n<li>Extract and summarize the email content and attachments.</li>\n<li>Save the summaries to Google Sheets.</li>\n<li>Send a consolidated summary via Telegram.</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><strong>Optional Customization</strong>:</p>\n<ul>\n<li>replace IMAP trigger with Gmail or Outlook trigger</li>\n<li>Modify the workflow to include additional features, such as:</li>\n<li>Adding more AI models for different types of analysis.</li>\n<li>Sending notifications via other channels (e.g., Slack, email).</li>\n<li>Integrating with other storage services (e.g., Dropbox, AWS S3).</li>\n</ul>\n</li>\n</ol>\n<hr>\n<h3><strong>Need help customizing?</strong></h3>\n<p><a href=\"mailto:info@n3w.it\" rel=\"ugc nofollow\">Contact me</a> for consulting and support or add me on <a href=\"https://www.linkedin.com/in/davideboizza/\" rel=\"ugc nofollow\" target=\"_blank\">Linkedin</a>.</p>\n</div><!--]-->",
  "readme_zh": "该工作流利用**AI模型**（DeepSeek、Gemini和OpenRouter）实现了**邮件及附件分析**（PDF与图片）的自动化流程。它能提取并总结邮件正文及附件内容，将摘要保存至**谷歌表格**，并通过**Telegram**发送最终整合版摘要报告。\n\n这是一个高效自动化邮件分析与摘要工具，可节省时间并确保重要信息触手可及、立即可用。\n\n以下是工作流分解说明：\n\n* * *\n\n#### **1\\. 运作原理**\n\n本工作流专为处理接收邮件、分析内容及附件并生成摘要而设计，具体流程如下：\n\n  1. **邮件触发** ：\n     * 流程始于**邮件触发器（IMAP）**节点，该节点持续监控邮箱新邮件\n     * 若邮件含附件，则触发后续处理\n  2. **附件检测** ：\n     * **含附件？**节点进行附件存在性校验\n     * 检测到附件则进入处理环节\n  3. **附件处理** ：\n     * **获取PDF/图片附件**节点提取邮件中的PDF与图片文件\n     * **分流器**节点区分文件类型进行处理： \n       * **PDF文件**：通过**PDF文本提取**节点获取文字内容，**PDF分析器**节点生成摘要\n       * **图片文件**：**图像分析**节点调用AI模型解析图片内容\n  4. **邮件正文摘要** ：\n     * **文本转换**节点将HTML格式邮件转为纯文本\n     * **邮件摘要链**节点使用AI生成邮件正文摘要\n  5. **摘要存储** ：\n     * **保存PDF摘要**/**保存图片摘要**/**保存文本摘要**节点分别将对应内容摘要写入**谷歌表格**\n  6. **摘要整合** ：\n     * **全量摘要**节点汇总邮件正文、PDF及图片的摘要内容\n     * **生成最终摘要**节点调用AI生成统一版总结报告\n  7. **摘要推送** ：\n     * **发送最终摘要**节点通过**Telegram**将整合版摘要发送至指定会话ID",
  "title_zh": "AI邮件分析器：处理PDF、图片并保存至Google Drive与Telegram",
  "publish_date_absolute": "",
  "publish_date_zh": "最后一次更新于一个月前",
  "workflow_json_zh": "{\n  \"id\": \"MCzA5RzvO83kNJi7\",\n  \"meta\": {\n    \"instanceId\": \"a4bfc93e975ca233ac45ed7c9227d84cf5a2329310525917adaf3312e10d5462\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"name\": \"AI Email Analyzer: Process PDFs, Images\",\n  \"tags\": [],\n  \"nodes\": [\n    {\n      \"id\": \"0526c603-2c35-4f65-88ee-e143f7aa3ca4\",\n      \"name\": \"Email Trigger (IMAP)\",\n      \"type\": \"n8n-nodes-base.emailReadImap\",\n      \"position\": [\n        -80,\n        500\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"downloadAttachments\": true\n      },\n      \"credentials\": {\n        \"imap\": {\n          \"id\": \"k31W9oGddl9pMDy4\",\n          \"name\": \"IMAP info@n3witalia.com\"\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"9b0b83d1-7d7c-4858-aedc-4816e2f02276\",\n      \"name\": \"DeepSeek R1\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\n      \"position\": [\n        1320,\n        980\n      ],\n      \"parameters\": {\n        \"model\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"deepseek/deepseek-r1:free\",\n          \"cachedResultName\": \"deepseek/deepseek-r1:free\"\n        },\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"XJTqRiKFJpFs5MuX\",\n          \"name\": \"OpenRouter account\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"2e8ad64a-d767-441e-9e12-7a75f5ed4c1c\",\n      \"name\": \"Email Summarization Chain\",\n      \"type\": \"@n8n/n8n-nodes-langchain.chainSummarization\",\n      \"position\": [\n        1360,\n        800\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"binaryDataKey\": \"={{ $json.data }}\",\n          \"summarizationMethodAndPrompts\": {\n            \"values\": {\n              \"prompt\": \"=Write a concise summary of the following in max 100 words :\\n\\n\\\"{{ $json.data }}\\\"\\n\\nDo not enter the total number of words used.\",\n              \"combineMapPrompt\": \"=## Email Summarization System Prompt\\n\\nYou are a specialized AI assistant focused exclusively on creating precise, concise summaries of emails. Your task is to analyze the complete email text provided as input and produce a clear, comprehensive summary that captures all essential information in a cohesive narrative format.\\n\\n### Your responsibilities:\\n\\n1. Extract and summarize the main topic and purpose of the email\\n2. Identify key points, requests, deadlines, or action items mentioned\\n3. Preserve critical details like dates, times, locations, and names\\n4. Maintain the original tone and urgency level of the message\\n5. Organize information in order of importance\\n6. Remove unnecessary pleasantries, redundancies, and filler content\\n\\n### Summary format:\\n\\n- Begin with a one-sentence overview of the email's main purpose\\n- Present all key information in a cohesive paragraph format (no bullet points)\\n- Follow a logical flow from most to least important information\\n- Include any critical deadlines, requests, or action items within the narrative\\n- Keep the summary to 3-5 sentences total\\n- Use clear, straightforward language with appropriate transitions between ideas\\n- Preserve the original intent and meaning without introducing new information\\n\\n### What to exclude:\\n\\n- Greetings and sign-offs\\n- Redundant information\\n- Minor details that don't affect the main message\\n- Your own opinions or interpretations\\n- Information not explicitly stated in the email\\n\\nThe email text to summarize is:\\n{{$json.data}}\"\n            }\n          }\n        },\n        \"operationMode\": \"nodeInputBinary\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"97f2b5f8-b2ba-4bd5-a951-c97e64e6f833\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -140,\n        -280\n      ],\n      \"parameters\": {\n        \"color\": 3,\n        \"width\": 580,\n        \"height\": 400,\n        \"content\": \"# AI邮件分析器：处理PDF与图片\\n\\n这是一个强大的自动化邮件分析与摘要生成工具，能节省时间并确保重要信息易于获取和操作。\\n\\n所有摘要均保存在Google表格中，并通过专属数字ID与对应邮件关联。\\n\\n## 使用前准备：\\n- 克隆此[Google表格模板](https://docs.google.com/spreadsheets/d/1rBa0RI6XFfMerylVCV0dlKhJT_f4UAd8S6jyYX4aRRo/edit?usp=sharing)\\n- 在Telegram节点处填入您的Chat_ID\\n- 选择您偏好的AI模型\\n\\n（注：根据中文表述习惯调整了技术术语的译法，将\\\"Google Drive Sheet\\\"简化为更符合中文用户认知的\\\"Google表格\\\"，\\\"numeric ID\\\"译为\\\"数字ID\\\"保持技术准确性，同时优化了长句的分割与衔接）\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"d2012cbc-0e79-4579-ac3d-e5e84ad56dc1\",\n      \"name\": \"Switch\",\n      \"type\": \"n8n-nodes-base.switch\",\n      \"position\": [\n        960,\n        120\n      ],\n      \"parameters\": {\n        \"rules\": {\n          \"values\": [\n            {\n              \"outputKey\": \"pdf\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"loose\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"31b7fb0b-3149-479e-852a-52c1ec8935ca\",\n                    \"operator\": {\n                      \"type\": \"string\",\n                      \"operation\": \"equals\"\n                    },\n                    \"leftValue\": \"={{ $binary.data.fileExtension }}\",\n                    \"rightValue\": \"pdf\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            },\n            {\n              \"outputKey\": \"image\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"loose\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"9fe6411d-cf35-4fdd-a9ad-8c96f0a5cf66\",\n                    \"operator\": {\n                      \"type\": \"string\",\n                      \"operation\": \"regex\"\n                    },\n                    \"leftValue\": \"={{ $binary.data.fileExtension }}\",\n                    \"rightValue\": \"=/^(jpg|png)$/i\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            }\n          ]\n        },\n        \"options\": {},\n        \"looseTypeValidation\": true\n      },\n      \"typeVersion\": 3.2\n    },\n    {\n      \"id\": \"8a9d55b8-9ba5-4a6f-ae13-9c529875a2a4\",\n      \"name\": \"Structured Output Parser\",\n      \"type\": \"@n8n/n8n-nodes-langchain.outputParserStructured\",\n      \"position\": [\n        2040,\n        -320\n      ],\n      \"parameters\": {\n        \"schemaType\": \"manual\",\n        \"inputSchema\": \"{\\n\\t\\\"type\\\": \\\"object\\\",\\n\\t\\\"properties\\\": {\\n\\t\\t\\\"content\\\": {\\n\\t\\t\\t\\\"type\\\": \\\"string\\\"\\n\\t\\t}\\n\\t}\\n}\"\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"658696f5-08e0-4d51-89bc-2a1c31576700\",\n      \"name\": \"Split Out\",\n      \"type\": \"n8n-nodes-base.splitOut\",\n      \"position\": [\n        2540,\n        -420\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"fieldToSplitOut\": \"=output\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"d2ba57c3-9e0e-4a7d-957d-216763e357c3\",\n      \"name\": \"Aggregate\",\n      \"type\": \"n8n-nodes-base.aggregate\",\n      \"position\": [\n        3660,\n        220\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"fieldsToAggregate\": {\n          \"fieldToAggregate\": [\n            {\n              \"fieldToAggregate\": \"data.output\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"10e6d3c6-10f6-4fea-be37-b5ee50e0b529\",\n      \"name\": \"OpenRouter Chat Model1\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatOpenRouter\",\n      \"position\": [\n        3920,\n        400\n      ],\n      \"parameters\": {\n        \"model\": \"google/gemini-2.0-flash-exp:free\",\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"openRouterApi\": {\n          \"id\": \"pb06rfB4xmxzVe3Q\",\n          \"name\": \"OpenRouter\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"dcdcb7f2-669d-4e1b-a3f2-49a5b6c760b1\",\n      \"name\": \"Contain attachments?\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        260,\n        500\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"5cf96104-c887-44fe-b528-30171943dd15\",\n              \"operator\": {\n                \"type\": \"boolean\",\n                \"operation\": \"true\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $binary.isNotEmpty() }}\",\n              \"rightValue\": \"\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"6280db8e-42e4-4f88-bbe7-4e65eff3a34f\",\n      \"name\": \"Get PDF and images attachments\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        600,\n        300\n      ],\n      \"parameters\": {\n        \"jsCode\": \"let results = [];\\n\\nfor (const item of $input.all()) {\\n  for (key of Object.keys(item.binary)) {\\n        results.push({\\n            json: {},\\n            binary: {\\n                data: item.binary[key],\\n            }\\n        });\\n    }\\n}\\n\\nreturn results;\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"53a7333d-fb49-46d4-9e3b-d186a5e416ca\",\n      \"name\": \"Extract from PDF\",\n      \"type\": \"n8n-nodes-base.extractFromFile\",\n      \"position\": [\n        1460,\n        -540\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"operation\": \"pdf\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"9d5c3b14-a3b0-4d2b-88d5-5a2c21a6907f\",\n      \"name\": \"PDF Analyzer\",\n      \"type\": \"@n8n/n8n-nodes-langchain.chainLlm\",\n      \"position\": [\n        1780,\n        -540\n      ],\n      \"parameters\": {\n        \"text\": \"=## PDF Summarization System Prompt\\n\\nYou are a specialized AI assistant tasked with creating concise, accurate summaries of documents. Your goal is to extract and distill the most important information from the content provided as input and present it in a clear, precise plain text summary.\\n\\n### Your responsibilities:\\n\\n1. Identify the main topic and purpose of the document\\n2. Extract key points, arguments, findings, or conclusions\\n3. Preserve essential data points, statistics, dates, and figures\\n4. Recognize and highlight critical information and takeaways\\n5. Maintain the original document's logical structure in your summary\\n6. Prioritize information based on its significance to the document's purpose\\n\\n### Summary format:\\n\\n- Provide your summary in plain text only (no formatting)\\n- Begin with a concise overview of the document's main topic and purpose\\n- Present important points in a logical, sequential narrative\\n- Use clear, direct language that accurately represents the original content\\n- Maintain appropriate context for all extracted information\\n- Keep the summary concise while including all crucial information\\n- Use proper transitions between topics to maintain readability\\n\\n### What to exclude:\\n\\n- Minor details that don't contribute to the main points\\n- Repetitive information\\n- Extensive examples unless they're critical to understanding\\n- Citations, references, and bibliographic details unless specifically important\\n- Decorative or non-essential images (describe important visualized data if relevant)\\n- Your own interpretations or opinions not supported by the document\\n\\n{{ $json.text }}\",\n        \"promptType\": \"define\",\n        \"hasOutputParser\": true\n      },\n      \"typeVersion\": 1.5\n    },\n    {\n      \"id\": \"ba6f6d2f-9a13-4bb4-80fb-72f5c4124473\",\n      \"name\": \"Save summary PDF\",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"position\": [\n        2580,\n        -800\n      ],\n      \"parameters\": {\n        \"columns\": {\n          \"value\": {\n            \"ID\": \"={{ $('Email Trigger (IMAP)').item.json.metadata[\\\"x-message-id\\\"] }}\",\n            \"DATE\": \"={{ $now.format('dd/LL/yyyy') }}\",\n            \"TYPE\": \"pdf\",\n            \"EMAIL\": \"={{ $('Email Trigger (IMAP)').item.json.from }}\",\n            \"SUBJECT\": \"={{ $('Email Trigger (IMAP)').item.json.subject }}\",\n            \"SUMMARY\": \"={{ $json.output.content }}\"\n          },\n          \"schema\": [\n            {\n              \"id\": \"DATE\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"DATE\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"EMAIL\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"EMAIL\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"ID\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"ID\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"SUBJECT\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"SUBJECT\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"TYPE\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"TYPE\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"SUMMARY\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"SUMMARY\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            }\n          ],\n          \"mappingMode\": \"defineBelow\",\n          \"matchingColumns\": [],\n          \"attemptToConvertTypes\": false,\n          \"convertFieldsToString\": false\n        },\n        \"options\": {},\n        \"operation\": \"append\",\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"gid=0\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1rBa0RI6XFfMerylVCV0dlKhJT_f4UAd8S6jyYX4aRRo/edit#gid=0\",\n          \"cachedResultName\": \"Foglio1\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"1rBa0RI6XFfMerylVCV0dlKhJT_f4UAd8S6jyYX4aRRo\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1rBa0RI6XFfMerylVCV0dlKhJT_f4UAd8S6jyYX4aRRo/edit?usp=drivesdk\",\n          \"cachedResultName\": \"Analyze Email + Attachments\"\n        }\n      },\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"JYR6a64Qecd6t8Hb\",\n          \"name\": \"Google Sheets account\"\n        }\n      },\n      \"typeVersion\": 4.5\n    },\n    {\n      \"id\": \"4c7ff16e-8649-4364-9aa6-c06670f4c36a\",\n      \"name\": \"All summaries\",\n      \"type\": \"n8n-nodes-base.merge\",\n      \"position\": [\n        3080,\n        220\n      ],\n      \"parameters\": {\n        \"numberInputs\": 3\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"46af5694-6b28-45e7-8b1b-d77482b326e7\",\n      \"name\": \"Map image summaries\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        2020,\n        280\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"11592bed-7555-4e61-a692-d71b1a733fd4\",\n              \"name\": \"content\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.content }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"dc5858b7-c30b-413b-a1d0-143a068f2c87\",\n      \"name\": \"Upload attachments\",\n      \"type\": \"n8n-nodes-base.googleDrive\",\n      \"position\": [\n        1440,\n        480\n      ],\n      \"parameters\": {\n        \"name\": \"={{$now.format('yyyyLLddhhiiss')}}-{{ $binary.data.fileName }}\",\n        \"driveId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"My Drive\"\n        },\n        \"options\": {},\n        \"folderId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"1CV5PgqBQIVFEacmbApdCApjNEtoNPzXQ\",\n          \"cachedResultUrl\": \"https://drive.google.com/drive/folders/1CV5PgqBQIVFEacmbApdCApjNEtoNPzXQ\",\n          \"cachedResultName\": \"Analyze attachments\"\n        }\n      },\n      \"credentials\": {\n        \"googleDriveOAuth2Api\": {\n          \"id\": \"HEy5EuZkgPZVEa9w\",\n          \"name\": \"Google Drive account (n3w.it)\"\n        }\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"9537f678-163c-40de-93f3-9934f4ae2ad0\",\n      \"name\": \"Email summary\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        2000,\n        800\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"ef348518-a9fb-4ea9-bd70-9dcf3bff092a\",\n              \"name\": \"content\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.response.text }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"ba0c45d9-7d5a-413e-9034-3e22a79ead77\",\n      \"name\": \"Send final summary\",\n      \"type\": \"n8n-nodes-base.telegram\",\n      \"position\": [\n        4340,\n        220\n      ],\n      \"webhookId\": \"9c8e4675-762e-47dd-8cef-b94a5261ffd4\",\n      \"parameters\": {\n        \"text\": \"={{ $json.text }}\",\n        \"chatId\": \"CHAT_ID\",\n        \"additionalFields\": {}\n      },\n      \"credentials\": {\n        \"telegramApi\": {\n          \"id\": \"0hSq9VwaiJifiscT\",\n          \"name\": \"Telegram account\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"7a97052b-37c5-4754-ac1a-0f1a20569df7\",\n      \"name\": \"Create final summary\",\n      \"type\": \"@n8n/n8n-nodes-langchain.chainLlm\",\n      \"position\": [\n        3940,\n        220\n      ],\n      \"parameters\": {\n        \"text\": \"=The inputs to synthesize are:\\n'''\\n{{ $json.output }}\\n'''\",\n        \"messages\": {\n          \"messageValues\": [\n            {\n              \"message\": \"## Comprehensive Email Analysis System Prompt\\n\\nYou are a specialized AI assistant tasked with creating a unified, concise summary of an email and all its attachments. Your input includes a summary of the email text, summaries of any images, and summaries of any PDF attachments. Your goal is to synthesize all this information into a single coherent summary that captures the essential message and purpose.\\n\\n### Your responsibilities:\\n\\n1. Identify the overarching theme or purpose connecting the email and its attachments\\n2. Recognize relationships between the email content and the attached materials\\n3. Extract and consolidate the most critical information from all sources\\n4. Maintain proper context when combining information from different sources\\n5. Prioritize information based on relevance to the email's main purpose\\n6. Create a unified narrative that flows logically between email content and attachments\\n\\n### Input structure:\\n- Email summary: A summary of the main email text\\n- Image descriptions: Summaries of any images attached to the email\\n- PDF summaries: Condensed versions of any PDF documents attached\\n\\n### Output format:\\n\\n- Provide your summary in plain text only\\n- Begin with a one-sentence statement of the email's overall purpose and theme\\n- Present a unified narrative that integrates information from the email and all attachments\\n- Organize information by importance and relevance, not by source\\n- Keep the final summary concise (5-7 sentences maximum) while including all essential information\\n- Use clear transitions to maintain coherence when moving between different information sources\\n- Preserve the original intent and tone of the communication\\n\\n### What to include:\\n\\n- The main topic and purpose of the communication\\n- Key points from both the email and attachments\\n- Critical requests, deadlines, or action items\\n- Essential details like dates, figures, or specific references\\n- Contextual information that clarifies the purpose of attachments\\n\\n### What to exclude:\\n\\n- Redundant information repeated across multiple sources\\n- Minor details that don't contribute to understanding the main message\\n- Excessive descriptions of attachments beyond their relevance to the email's purpose\\n- Your own interpretations beyond what's supported by the input materials\"\n            }\n          ]\n        },\n        \"promptType\": \"define\"\n      },\n      \"typeVersion\": 1.5\n    },\n    {\n      \"id\": \"99b4c22c-a29b-4b72-bc4a-bed5c1320386\",\n      \"name\": \"Save summary image\",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"position\": [\n        2020,\n        20\n      ],\n      \"parameters\": {\n        \"columns\": {\n          \"value\": {\n            \"ID\": \"={{ $('Email Trigger (IMAP)').item.json.metadata[\\\"x-message-id\\\"] }}\",\n            \"DATE\": \"={{ $now.format('dd/LL/yyyy') }}\",\n            \"TYPE\": \"image\",\n            \"EMAIL\": \"={{ $('Email Trigger (IMAP)').item.json.from }}\",\n            \"SUBJECT\": \"={{ $('Email Trigger (IMAP)').item.json.subject }}\",\n            \"SUMMARY\": \"={{ $json.content }}\"\n          },\n          \"schema\": [\n            {\n              \"id\": \"DATE\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"DATE\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"EMAIL\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"EMAIL\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"ID\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"ID\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"SUBJECT\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"SUBJECT\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"TYPE\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"TYPE\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"SUMMARY\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"SUMMARY\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            }\n          ],\n          \"mappingMode\": \"defineBelow\",\n          \"matchingColumns\": [],\n          \"attemptToConvertTypes\": false,\n          \"convertFieldsToString\": false\n        },\n        \"options\": {},\n        \"operation\": \"append\",\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"gid=0\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1rBa0RI6XFfMerylVCV0dlKhJT_f4UAd8S6jyYX4aRRo/edit#gid=0\",\n          \"cachedResultName\": \"Foglio1\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"1rBa0RI6XFfMerylVCV0dlKhJT_f4UAd8S6jyYX4aRRo\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1rBa0RI6XFfMerylVCV0dlKhJT_f4UAd8S6jyYX4aRRo/edit?usp=drivesdk\",\n          \"cachedResultName\": \"Analyze Email + Attachments\"\n        }\n      },\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"JYR6a64Qecd6t8Hb\",\n          \"name\": \"Google Sheets account\"\n        }\n      },\n      \"typeVersion\": 4.5\n    },\n    {\n      \"id\": \"2b32c086-c436-436e-93c3-da88e6f08247\",\n      \"name\": \"Save summary text\",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"position\": [\n        2020,\n        1040\n      ],\n      \"parameters\": {\n        \"columns\": {\n          \"value\": {\n            \"ID\": \"={{ $('Email Trigger (IMAP)').item.json.metadata[\\\"x-message-id\\\"] }}\",\n            \"DATE\": \"={{ $now.format('dd/LL/yyyy') }}\",\n            \"TYPE\": \"email\",\n            \"EMAIL\": \"={{ $('Email Trigger (IMAP)').item.json.from }}\",\n            \"SUBJECT\": \"={{ $('Email Trigger (IMAP)').item.json.subject }}\",\n            \"SUMMARY\": \"={{ $json.response.text }}\"\n          },\n          \"schema\": [\n            {\n              \"id\": \"DATE\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"DATE\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"EMAIL\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"EMAIL\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"ID\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"ID\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"SUBJECT\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"SUBJECT\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"TYPE\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"TYPE\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"SUMMARY\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"SUMMARY\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            }\n          ],\n          \"mappingMode\": \"defineBelow\",\n          \"matchingColumns\": [],\n          \"attemptToConvertTypes\": false,\n          \"convertFieldsToString\": false\n        },\n        \"options\": {},\n        \"operation\": \"append\",\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"gid=0\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1rBa0RI6XFfMerylVCV0dlKhJT_f4UAd8S6jyYX4aRRo/edit#gid=0\",\n          \"cachedResultName\": \"Foglio1\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"1rBa0RI6XFfMerylVCV0dlKhJT_f4UAd8S6jyYX4aRRo\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1rBa0RI6XFfMerylVCV0dlKhJT_f4UAd8S6jyYX4aRRo/edit?usp=drivesdk\",\n          \"cachedResultName\": \"Analyze Email + Attachments\"\n        }\n      },\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"JYR6a64Qecd6t8Hb\",\n          \"name\": \"Google Sheets account\"\n        }\n      },\n      \"typeVersion\": 4.5\n    },\n    {\n      \"id\": \"135bf3c3-e45f-4363-857b-2345e0bc7964\",\n      \"name\": \"Convert text\",\n      \"type\": \"n8n-nodes-base.markdown\",\n      \"position\": [\n        860,\n        940\n      ],\n      \"parameters\": {\n        \"html\": \"={{ $json.textHtml }}\",\n        \"options\": {}\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"0c2cf33a-d7bb-438d-a9c9-06a77f91b56e\",\n      \"name\": \"Gemini 2.0 Flash\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatOpenRouter\",\n      \"position\": [\n        1700,\n        -320\n      ],\n      \"parameters\": {\n        \"model\": \"google/gemini-2.0-flash-exp:free\",\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"openRouterApi\": {\n          \"id\": \"pb06rfB4xmxzVe3Q\",\n          \"name\": \"OpenRouter\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"50d5fd05-db5f-451c-92ce-e0f42d8322f9\",\n      \"name\": \"Parsing\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        3360,\n        220\n      ],\n      \"parameters\": {\n        \"jsCode\": \"const inputData = $input.all();\\n\\nconst outputData = inputData.map(item => {\\n  \\n  const outputValue = item.json.output || item.json.content;\\n\\n  return {\\n    data: {\\n      output: outputValue \\n    }\\n  };\\n});\\n\\nreturn outputData;\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"801659a1-cc9d-4014-9403-d6d0952e856a\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        520,\n        220\n      ],\n      \"parameters\": {\n        \"width\": 260,\n        \"height\": 240,\n        \"content\": \"获取邮件中的所有附件（在此工作流中仅考虑PDF和图片）\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"15dc13b9-b35c-43d3-8af9-a8793382a2b6\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1740,\n        -600\n      ],\n      \"parameters\": {\n        \"width\": 340,\n        \"height\": 200,\n        \"content\": \"分析PDF文件内容并为每份文件撰写摘要\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"6c68ce17-13f1-4aba-9f43-e4003e5cd723\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1380,\n        120\n      ],\n      \"parameters\": {\n        \"height\": 200,\n        \"content\": \"分析图像内容并准确描述\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"ff746258-dc11-43aa-afe9-06c9dfb3708b\",\n      \"name\": \"Analyze image\",\n      \"type\": \"@n8n/n8n-nodes-langchain.openAi\",\n      \"position\": [\n        1440,\n        180\n      ],\n      \"parameters\": {\n        \"text\": \"## Image Analysis System Prompt\\n\\nYou are a specialized AI assistant focused on analyzing images. Your task is to carefully examine the image provided as input and produce a detailed, accurate description in plain text format.\\n\\n### Your responsibilities:\\n\\n1. Observe and describe the main subject(s) or focal point(s) of the image\\n2. Identify notable objects, people, animals, or other elements present\\n3. Describe the setting, background, and environment if applicable\\n4. Note any text visible in the image, transcribing it accurately\\n5. Recognize any actions, activities, or events taking place\\n6. Identify relevant contextual information (time of day, weather, season, etc.)\\n7. Describe colors, lighting, composition, and other visual elements when relevant\\n\\n### Response format:\\n\\n- Provide your analysis in plain text only (no HTML, markdown, or other formatting)\\n- Begin with a concise overview of what the image depicts\\n- Follow with a detailed description covering all significant elements\\n- Organize information logically, typically moving from main subjects to background details\\n- Use clear, descriptive language that accurately represents what is actually visible\\n- Keep descriptions objective and factual\\n\\n### What to exclude:\\n\\n- Speculation about elements not clearly visible in the image\\n- Subjective judgments or interpretations beyond what is objectively present\\n- Personal opinions about the quality or purpose of the image\\n- Complex technical analysis unless specifically relevant\\n- Any formatting beyond plain text\\n\\nThe image to analyze is the one provided in the input.\",\n        \"modelId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"gpt-4o-mini\",\n          \"cachedResultName\": \"GPT-4O-MINI\"\n        },\n        \"options\": {},\n        \"resource\": \"image\",\n        \"inputType\": \"base64\",\n        \"operation\": \"analyze\"\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"CDX6QM4gLYanh0P4\",\n          \"name\": \"OpenAi account\"\n        }\n      },\n      \"typeVersion\": 1.8\n    },\n    {\n      \"id\": \"ce353f02-72ff-49bf-9297-5a2b3229fa49\",\n      \"name\": \"Sticky Note4\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1340,\n        740\n      ],\n      \"parameters\": {\n        \"width\": 320,\n        \"height\": 180,\n        \"content\": \"分析邮件内容并总结\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"01ee4c00-5993-47ce-af04-320cd3319593\",\n      \"name\": \"Sticky Note5\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        3060,\n        100\n      ],\n      \"parameters\": {\n        \"width\": 720,\n        \"height\": 80,\n        \"content\": \"所有邮件组成部分（文本、PDF、图片）的摘要被汇总，并生成最终摘要。\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"active\": false,\n  \"pinData\": {},\n  \"settings\": {\n    \"executionOrder\": \"v1\"\n  },\n  \"versionId\": \"30310971-f23c-4761-823c-36ddad8bc8dd\",\n  \"connections\": {\n    \"Switch\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Upload attachments\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Extract from PDF\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Upload attachments\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Analyze image\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Parsing\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Aggregate\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Aggregate\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Create final summary\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Split Out\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"All summaries\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"DeepSeek R1\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"Email Summarization Chain\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Convert text\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Email Summarization Chain\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"PDF Analyzer\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Save summary PDF\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Split Out\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"All summaries\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Parsing\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Analyze image\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Save summary image\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Map image summaries\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Email summary\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"All summaries\",\n            \"type\": \"main\",\n            \"index\": 2\n          }\n        ]\n      ]\n    },\n    \"Extract from PDF\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"PDF Analyzer\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Gemini 2.0 Flash\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"PDF Analyzer\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Save summary PDF\": {\n      \"main\": [\n        []\n      ]\n    },\n    \"Save summary text\": {\n      \"main\": [\n        []\n      ]\n    },\n    \"Save summary image\": {\n      \"main\": [\n        []\n      ]\n    },\n    \"Upload attachments\": {\n      \"main\": [\n        []\n      ]\n    },\n    \"Map image summaries\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"All summaries\",\n            \"type\": \"main\",\n            \"index\": 1\n          }\n        ]\n      ]\n    },\n    \"Contain attachments?\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get PDF and images attachments\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Convert text\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Convert text\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Create final summary\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Send final summary\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Email Trigger (IMAP)\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Contain attachments?\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"OpenRouter Chat Model1\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"Create final summary\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Structured Output Parser\": {\n      \"ai_outputParser\": [\n        [\n          {\n            \"node\": \"PDF Analyzer\",\n            \"type\": \"ai_outputParser\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Email Summarization Chain\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Save summary text\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Email summary\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get PDF and images attachments\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Switch\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}