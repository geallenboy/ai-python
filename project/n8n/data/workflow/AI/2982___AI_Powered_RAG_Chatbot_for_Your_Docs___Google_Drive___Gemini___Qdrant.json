{
  "title": "🤖 AI Powered RAG Chatbot for Your Docs + Google Drive + Gemini + Qdrant",
  "url": "https://n8n.io/workflows/2982-ai-powered-rag-chatbot-for-your-docs-google-drive-gemini-qdrant/",
  "category": "AI",
  "category_url": "https://n8n.io/workflows/categories/ai/",
  "author": "Joseph LePage",
  "publish_date": "Last update 2 months ago",
  "content": "",
  "workflow_json": "{\"id\":\"8tusZTTtcyaiznEG\",\"meta\":{\"instanceId\":\"31e69f7f4a77bf465b805824e303232f0227212ae922d12133a0f96ffeab4fef\",\"templateCredsSetupCompleted\":true},\"name\":\"🤖 AI Powered RAG Chatbot for Your Docs + Google Drive + Gemini + Qdrant\",\"tags\":[],\"nodes\":[{\"id\":\"7ad5796b-d1a0-4cc1-bed6-105ff499beeb\",\"name\":\"Data Loader\",\"type\":\"@n8n/n8n-nodes-langchain.documentDefaultDataLoader\",\"position\":[620,720],\"parameters\":{\"options\":{\"metadata\":{\"metadataValues\":[{\"name\":\"file_id\",\"value\":\"={{ $json.id }}\"},{\"name\":\"pubkey\",\"value\":\"={{ $json.name }}\"},{\"name\":\"=overarching_theme\",\"value\":\"={{ $('Extract Meta Data').item.json.output.overarching_theme }}\"},{\"name\":\"recurring_topics\",\"value\":\"={{ $('Extract Meta Data').item.json.output.recurring_topics }}\"},{\"name\":\"pain_points\",\"value\":\"={{ $('Extract Meta Data').item.json.output.pain_points }}\"},{\"name\":\"analytical_insights\",\"value\":\"={{ $('Extract Meta Data').item.json.output.analytical_insights }}\"},{\"name\":\"conclusion\",\"value\":\"={{ $('Extract Meta Data').item.json.output.conclusion }}\"},{\"name\":\"keywords\",\"value\":\"={{ $('Extract Meta Data').item.json.output.keywords }}\"}]}},\"dataType\":\"binary\",\"binaryMode\":\"specificField\"},\"typeVersion\":1},{\"id\":\"84986ee2-4d79-49e8-8778-b8a955cf2174\",\"name\":\"Token Splitter\",\"type\":\"@n8n/n8n-nodes-langchain.textSplitterTokenSplitter\",\"position\":[720,860],\"parameters\":{\"chunkSize\":3000},\"typeVersion\":1},{\"id\":\"82aa7016-f3af-4de8-a410-b1c802041213\",\"name\":\"Qdrant Vector Store\",\"type\":\"@n8n/n8n-nodes-langchain.vectorStoreQdrant\",\"onError\":\"continueRegularOutput\",\"position\":[540,520],\"parameters\":{\"mode\":\"insert\",\"options\":{},\"qdrantCollection\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"=nostr-damus-user-profiles\"}},\"credentials\":{\"qdrantApi\":{\"id\":\"DJQ4hVAVdWZytjr2\",\"name\":\"QdrantApi account\"}},\"executeOnce\":false,\"retryOnFail\":true,\"typeVersion\":1},{\"id\":\"07f4d14a-1864-406b-946b-09c776e3038b\",\"name\":\"Loop Over Items\",\"type\":\"n8n-nodes-base.splitInBatches\",\"onError\":\"continueRegularOutput\",\"position\":[180,-140],\"parameters\":{\"options\":{}},\"typeVersion\":3},{\"id\":\"b0f9b066-62de-41bc-afce-dcb4d20d100c\",\"name\":\"Wait\",\"type\":\"n8n-nodes-base.wait\",\"position\":[1020,840],\"webhookId\":\"237d7f8a-aead-479a-b813-f407d1f37fa5\",\"parameters\":{},\"typeVersion\":1.1},{\"id\":\"2a883003-f5ec-409e-97e4-809360ca11ed\",\"name\":\"When clicking ‘Test workflow’\",\"type\":\"n8n-nodes-base.manualTrigger\",\"position\":[-1160,-280],\"parameters\":{},\"typeVersion\":1},{\"id\":\"cfbb6b77-142f-4689-b051-436f40ababe6\",\"name\":\"Google Gemini Chat Model\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatGoogleGemini\",\"position\":[1120,-20],\"parameters\":{\"options\":{\"temperature\":0.4},\"modelName\":\"models/gemini-2.0-flash-exp\"},\"credentials\":{\"googlePalmApi\":{\"id\":\"L9UNQHflYlyF9Ngd\",\"name\":\"Google Gemini(PaLM) Api account\"}},\"typeVersion\":1},{\"id\":\"c9c50387-64a3-473f-9ea7-509a301836a3\",\"name\":\"Merge\",\"type\":\"n8n-nodes-base.merge\",\"position\":[820,200],\"parameters\":{\"mode\":\"combine\",\"options\":{},\"combineBy\":\"combineAll\"},\"typeVersion\":3},{\"id\":\"ea143b9f-9bd8-4f3f-8979-5a0fd2691e9d\",\"name\":\"Extract Meta Data\",\"type\":\"@n8n/n8n-nodes-langchain.informationExtractor\",\"position\":[1020,-180],\"parameters\":{\"text\":\"={{ $json.data }}\",\"options\":{\"systemPromptTemplate\":\"You are an expert extraction algorithm.\\nOnly extract relevant information from the text.\\nIf you do not know the value of an attribute asked to extract, you may omit the attribute's value.\"},\"attributes\":{\"attributes\":[{\"name\":\"overarching_theme\",\"description\":\"Summarize the main theme(s) discussed in the \\\"Overarching Theme\\\" section.\"},{\"name\":\"recurring_topics\",\"description\":\"List the recurring topics mentioned in the \\\"Common Threads\\\" section as an array of strings.\"},{\"name\":\"pain_points\",\"description\":\"Summarize the user's frustrations or challenges mentioned in the \\\"Pain Points\\\" section as an array of strings.\"},{\"name\":\"analytical_insights\",\"description\":\"Extract a list of key analytical observations from the \\\"Analytical Insights\\\" section, including shifts in tone or behavior.\"},{\"name\":\"conclusion\",\"description\":\"Summarize the conclusions drawn about the user’s threads and their overall focus.\"},{\"name\":\"keywords\",\"description\":\"Generate a list of 10 keywords that capture the essence of the document (e.g., \\\"askNostr,\\\" \\\"decentralization,\\\" \\\"spam filtering\\\").\"}]}},\"typeVersion\":1},{\"id\":\"2ddd778f-6676-4a4b-b592-536401831bc8\",\"name\":\"Get File Contents\",\"type\":\"n8n-nodes-base.extractFromFile\",\"position\":[820,-180],\"parameters\":{\"options\":{},\"operation\":\"text\"},\"typeVersion\":1},{\"id\":\"cdbb8bbc-967c-4f01-b844-4d31328153df\",\"name\":\"Download File From Google Drive\",\"type\":\"n8n-nodes-base.googleDrive\",\"position\":[500,-180],\"parameters\":{\"fileId\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"={{ $json.id }}\"},\"options\":{},\"operation\":\"download\"},\"credentials\":{\"googleDriveOAuth2Api\":{\"id\":\"UhdXGYLTAJbsa0xX\",\"name\":\"Google Drive account\"}},\"typeVersion\":3},{\"id\":\"399e196c-76ec-4077-aacc-f669173b0229\",\"name\":\"Find File Ids in Google Drive Folder\",\"type\":\"n8n-nodes-base.googleDrive\",\"position\":[-620,-160],\"parameters\":{\"filter\":{\"driveId\":{\"mode\":\"list\",\"value\":\"My Drive\"},\"folderId\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"={{ $json.folder_id }}\"}},\"options\":{},\"resource\":\"fileFolder\",\"returnAll\":true},\"credentials\":{\"googleDriveOAuth2Api\":{\"id\":\"UhdXGYLTAJbsa0xX\",\"name\":\"Google Drive account\"}},\"typeVersion\":3},{\"id\":\"3bc4f005-c6c8-4f73-816a-1573d6dfb62f\",\"name\":\"text-embeddings-3-large\",\"type\":\"@n8n/n8n-nodes-langchain.embeddingsOpenAi\",\"position\":[480,720],\"parameters\":{\"model\":\"text-embedding-3-large\",\"options\":{}},\"credentials\":{\"openAiApi\":{\"id\":\"jEMSvKmtYfzAkhe6\",\"name\":\"OpenAi account\"}},\"typeVersion\":1},{\"id\":\"5d42b34a-7156-4163-a2c4-a9cb3c984c96\",\"name\":\"Google Folder ID\",\"type\":\"n8n-nodes-base.set\",\"position\":[-820,-160],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"e6f6188f-c895-4c8c-b39a-0ef55b490fd6\",\"name\":\"folder_id\",\"type\":\"string\",\"value\":\"[Your-Google-Folder-ID]\"}]}},\"typeVersion\":3.4},{\"id\":\"7be310c2-d30f-42a2-8f57-33c7b184e429\",\"name\":\"gpt-4o-mini1\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\"position\":[-400,940],\"parameters\":{\"options\":{}},\"credentials\":{\"openAiApi\":{\"id\":\"jEMSvKmtYfzAkhe6\",\"name\":\"OpenAi account\"}},\"typeVersion\":1},{\"id\":\"18aacfd9-3f6e-4fba-9f68-d8cc95bc667b\",\"name\":\"Delete Qdrant Points by File ID\",\"type\":\"@n8n/n8n-nodes-langchain.code\",\"position\":[-500,800],\"parameters\":{\"code\":{\"execute\":{\"code\":\"const { QdrantVectorStore } = require(\\\"@langchain/qdrant\\\");\\nconst { OpenAIEmbeddings } = require(\\\"@langchain/openai\\\");\\n\\n// Qdrant connection details\\nconst url = \\\"http://localhost:6333/\\\";\\nconst apiKey = \\\"\\\";\\n\\n// OpenAI API configuration\\nconst openAIApiKey = \\\"[Your-OpenAI-API-Key]\\\";\\n\\n// Get input data\\nconst items = this.getInputData()[0];\\n// console.log(items)\\n\\nconst collectionName =  items.json.qdrant_collection_name;\\n// console.log(collectionName)\\n\\nasync function deleteDocumentsFromQdrant() {\\n  try {\\n    // Initialize OpenAI embeddings\\n    const embeddings = new OpenAIEmbeddings({\\n      model: \\\"text-embedding-3-large\\\",\\n      openAIApiKey: openAIApiKey\\n    });\\n\\n    // Connect to existing Qdrant collection\\n    const vectorStore = await QdrantVectorStore.fromExistingCollection(embeddings, {\\n      url: url,\\n      apiKey: apiKey,\\n      collectionName: collectionName,\\n    });\\n\\n    const fileIds = items.json.appended_id.map(item => item);\\n\\n    console.log(fileIds)\\n\\n    // Delete points by fileId\\n    const deletionResults = await Promise.all(fileIds.map(async (file_id) => {\\n      const filter = {\\n        must: [\\n          {\\n            key: \\\"metadata.file_id\\\",\\n            match: { value: file_id }\\n          }\\n        ]\\n      };\\n\\n      try {\\n        // Access the underlying Qdrant client to perform the deletion\\n        await vectorStore.client.delete(collectionName, { filter });\\n        return { file_id, status: \\\"deleted\\\" };\\n      } catch (error) {\\n        console.error(`Error deleting documents for fileId ${file_id}:`, error);\\n        return { file_id, status: \\\"error\\\", message: error.message };\\n      }\\n    }));\\n\\n    return deletionResults;\\n  } catch (error) {\\n    console.error(\\\"An error occurred during the deletion process:\\\", error);\\n    return error.message;\\n  }\\n}\\n\\n// Execute the deletion process\\ntry {\\n  const result = await deleteDocumentsFromQdrant();\\n  console.log(\\\"Deletion process completed:\\\", result);\\n  return [];\\n} catch (error) {\\n  console.error(\\\"Failed to execute deletion process:\\\", error);\\n  return [{ json: { error } }];\\n}\\n\\n\"}},\"inputs\":{\"input\":[{\"type\":\"main\",\"required\":true,\"maxConnections\":1},{\"type\":\"ai_languageModel\",\"required\":true,\"maxConnections\":1}]},\"outputs\":{\"output\":[{\"type\":\"main\"}]}},\"typeVersion\":1},{\"id\":\"329cec97-aac1-4714-97ce-add5915b1078\",\"name\":\"Qdrant Collection Name\",\"type\":\"n8n-nodes-base.set\",\"position\":[-700,100],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"11fa71e9-6cbc-4183-9439-e3379b2b970e\",\"name\":\"qdrant_collection_name\",\"type\":\"string\",\"value\":\"nostr-damus-user-profiles\"}]}},\"typeVersion\":3.4},{\"id\":\"82e98da8-530d-4a3c-97e6-5e91ad644a46\",\"name\":\"File Id List\",\"type\":\"n8n-nodes-base.summarize\",\"position\":[-700,280],\"parameters\":{\"options\":{},\"fieldsToSummarize\":{\"values\":[{\"field\":\"id\",\"aggregation\":\"append\"}]}},\"typeVersion\":1.1},{\"id\":\"f3def614-2709-4847-831d-d6a80c86ec1c\",\"name\":\"Merge1\",\"type\":\"n8n-nodes-base.merge\",\"position\":[-340,340],\"parameters\":{\"mode\":\"combine\",\"options\":{},\"combineBy\":\"combineByPosition\"},\"typeVersion\":3},{\"id\":\"cfe399fb-8560-4ac4-98f7-4f539ae6a52c\",\"name\":\"Merge2\",\"type\":\"n8n-nodes-base.merge\",\"position\":[-80,-140],\"parameters\":{},\"typeVersion\":3},{\"id\":\"1059da47-2abd-4884-b9c2-6b7d1623e31d\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-1280,560],\"parameters\":{\"color\":3,\"width\":1180,\"height\":760,\"content\":\"## Prepare Qdrant Vector Store\"},\"typeVersion\":1},{\"id\":\"2616e08f-070e-45b5-906f-40e832519aa2\",\"name\":\"Confirm Qdrant Delete Points\",\"type\":\"n8n-nodes-base.telegram\",\"position\":[-1060,760],\"webhookId\":\"29aac1ac-9345-4e44-babf-ebcfae701d88\",\"parameters\":{\"chatId\":\"={{ $env.TELEGRAM_CHAT_ID }}\",\"message\":\"=WARNING - {{ $json.appended_id.length }} Records in the Qdrant vector store collection \\\"{{ $json.qdrant_collection_name }}\\\" will be deleted.  Are you sure you want to continue?  This action cannot be undone!\",\"options\":{\"limitWaitTime\":{\"values\":{\"resumeUnit\":\"minutes\",\"resumeAmount\":15}}},\"operation\":\"sendAndWait\",\"approvalOptions\":{\"values\":{\"approvalType\":\"double\"}}},\"credentials\":{\"telegramApi\":{\"id\":\"pAIFhguJlkO3c7aQ\",\"name\":\"Telegram account\"}},\"typeVersion\":1.2},{\"id\":\"9d167192-e87b-41be-87f2-d7ddf866bb8d\",\"name\":\"If\",\"type\":\"n8n-nodes-base.if\",\"position\":[-1060,1000],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"20f530d6-fd55-420d-b8a9-70e5303f688e\",\"operator\":{\"type\":\"boolean\",\"operation\":\"true\",\"singleValue\":true},\"leftValue\":\"={{ $json.data.approved }}\",\"rightValue\":\"\"}]}},\"typeVersion\":2.2},{\"id\":\"1178f8cf-ece0-4b11-942d-18dd025da366\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[320,420],\"parameters\":{\"color\":7,\"width\":920,\"height\":640,\"content\":\"## Perform Qdrant Vector Store Operations\"},\"typeVersion\":1},{\"id\":\"cbf17a08-2f4c-4605-8418-5bf93ade7cf4\",\"name\":\"Send Declined Message\",\"type\":\"n8n-nodes-base.telegram\",\"position\":[-740,1120],\"webhookId\":\"382a3b43-b83f-47b1-a276-67c6b98a441a\",\"parameters\":{\"text\":\"Qdrant vector store upsert declined\",\"chatId\":\"={{ $env.TELEGRAM_CHAT_ID }}\",\"additionalFields\":{\"appendAttribution\":false}},\"credentials\":{\"telegramApi\":{\"id\":\"pAIFhguJlkO3c7aQ\",\"name\":\"Telegram account\"}},\"typeVersion\":1.2},{\"id\":\"890f478a-e000-418d-8582-4fef946e44d8\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-900,-380],\"parameters\":{\"width\":480,\"height\":840,\"content\":\"## 🌟Workflow Config\\n\\n- Google Drive Folder Id\\n- Qdrant Collection Name\\n- List of Google Drive File Id's\"},\"typeVersion\":1},{\"id\":\"d2bc2fed-c134-4e54-bd9d-69996be966a3\",\"name\":\"Sticky Note3\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[740,-280],\"parameters\":{\"color\":6,\"width\":640,\"height\":420,\"content\":\"## Extract Metadata for Qdrant Hybrid Search\"},\"typeVersion\":1},{\"id\":\"61f3c21e-bc2a-47bc-8ab1-678b1f425ee3\",\"name\":\"Sticky Note4\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[400,-280],\"parameters\":{\"color\":2,\"width\":300,\"height\":320,\"content\":\"## Google Drive\"},\"typeVersion\":1},{\"id\":\"61e608e4-ac6a-4131-9ca8-c46a5134bff9\",\"name\":\"Sticky Note5\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[80,-360],\"parameters\":{\"color\":5,\"width\":1360,\"height\":1480,\"content\":\"## ✨ Save Documents to Qdrant Vector Store\"},\"typeVersion\":1},{\"id\":\"410681cb-e757-42c0-89de-902edbe998e3\",\"name\":\"Sticky Note6\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-580,680],\"parameters\":{\"color\":5,\"width\":420,\"height\":400,\"content\":\"## Delete From Qdrant Vector Store\\nThis operation can not be undone!!!\"},\"typeVersion\":1},{\"id\":\"238469ce-3710-4681-b1b2-200c1b699d5e\",\"name\":\"Sticky Note7\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-1200,640],\"parameters\":{\"color\":4,\"width\":380,\"height\":520,\"content\":\"## Human In The Loop\\nUser must verify deletion of points from Qdrant vector store\"},\"typeVersion\":1},{\"id\":\"0b2f6ff4-dd02-4f0e-b2eb-60b1ce736cf5\",\"name\":\"Sticky Note8\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-1280,-380],\"parameters\":{\"color\":4,\"width\":340,\"height\":460,\"content\":\"## 👍Start Here!\"},\"typeVersion\":1},{\"id\":\"abde545b-1a23-4b3e-8046-335b9d0fa445\",\"name\":\"Webhook\",\"type\":\"n8n-nodes-base.webhook\",\"disabled\":true,\"position\":[-1160,-100],\"webhookId\":\"3a30557f-9264-4bc8-a253-a9356677c791\",\"parameters\":{\"path\":\"upsert\",\"options\":{}},\"typeVersion\":2},{\"id\":\"897d29af-719d-4fe7-93a9-44c693cc6547\",\"name\":\"AI Agent\",\"type\":\"@n8n/n8n-nodes-langchain.agent\",\"position\":[-600,-1200],\"parameters\":{\"text\":\"={{ $json.chatInput }}\",\"options\":{\"systemMessage\":\"=You are an intelligent assistant specialized in answering user questions using Nostr user profiles. Your primary goal is to provide precise, contextually relevant, and concise answers based on the tools and resources available.\\n\\n### TOOL\\nUse the \\\"nostr_damus_user_profiles\\\" tool to:\\n- perform semantic similarity searches and retrieve information from Nostr user profiles relevant to the user's query.\\n- access detailed information about Nostr and/or Damus users when additional context or specifics are required.\\n\\n### Key Instructions\\n1. **Response Guidelines**:\\n   - Clearly explain how the retrieved information addresses the user's query, if applicable.\\n   - If no relevant information is found, respond with: \\\"I cannot find the answer in the available resources.\\\"\\n\\n2. **Focus and Relevance**:\\n   - Ensure all responses are directly aligned with the user's question.\\n   - Avoid including extraneous details or relying solely on internal knowledge.\\n\"},\"promptType\":\"define\"},\"typeVersion\":1.7},{\"id\":\"316b0d8d-bbc7-4c40-b6d0-d0c762554fca\",\"name\":\"Window Buffer Memory\",\"type\":\"@n8n/n8n-nodes-langchain.memoryBufferWindow\",\"position\":[-580,-1000],\"parameters\":{\"contextWindowLength\":40},\"typeVersion\":1.3},{\"id\":\"f1e342a8-d50e-48a8-9d7a-850f8be93cff\",\"name\":\"When chat message received\",\"type\":\"@n8n/n8n-nodes-langchain.chatTrigger\",\"position\":[-1160,-1200],\"webhookId\":\"5f1c0c82-0ff9-40c7-9e2e-b1a96ffe24cd\",\"parameters\":{\"options\":{}},\"typeVersion\":1.1},{\"id\":\"12902fa9-5bcb-4e8b-ac13-7f4cb6e7e1d0\",\"name\":\"Google Gemini Chat Model1\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatGoogleGemini\",\"position\":[-760,-1000],\"parameters\":{\"options\":{\"maxOutputTokens\":8192},\"modelName\":\"models/gemini-2.0-flash-exp\"},\"credentials\":{\"googlePalmApi\":{\"id\":\"L9UNQHflYlyF9Ngd\",\"name\":\"Google Gemini(PaLM) Api account\"}},\"typeVersion\":1},{\"id\":\"1c5818d4-6251-4d14-8b4f-d1f3ddfbed38\",\"name\":\"text-embeddings-3-large1\",\"type\":\"@n8n/n8n-nodes-langchain.embeddingsOpenAi\",\"position\":[-320,-840],\"parameters\":{\"model\":\"text-embedding-3-large\",\"options\":{}},\"credentials\":{\"openAiApi\":{\"id\":\"jEMSvKmtYfzAkhe6\",\"name\":\"OpenAi account\"}},\"typeVersion\":1},{\"id\":\"80056067-5d2b-4ac7-8e69-e75bd66a1ad4\",\"name\":\"Sticky Note9\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-900,-1300],\"parameters\":{\"color\":5,\"width\":860,\"height\":680,\"content\":\"## 🤖Retrieve Content from Qdrant Vector Store\"},\"typeVersion\":1},{\"id\":\"b45b18e4-7773-4eec-837b-f43fc0eeb90c\",\"name\":\"Sticky Note10\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-1280,-1300],\"parameters\":{\"color\":4,\"width\":340,\"height\":320,\"content\":\"## 🗣️ Chat with Your Documents\"},\"typeVersion\":1},{\"id\":\"8fe891dd-dee6-4abb-bc09-d90e6d7bf3cb\",\"name\":\"Sticky Note11\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-1360,-480],\"parameters\":{\"color\":7,\"width\":2880,\"height\":1880,\"content\":\"# Step 1 - Save Documents to Qdrant Vector Store\"},\"typeVersion\":1},{\"id\":\"4a9bf716-3fc3-4ccc-b831-19a1afdb4588\",\"name\":\"Sticky Note12\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-1360,-1420],\"parameters\":{\"color\":7,\"width\":1780,\"height\":880,\"content\":\"# Step 2 - Chat with Your Documents from Qdrant Vector Store\"},\"typeVersion\":1},{\"id\":\"fccedfde-c5aa-4237-9d1c-feb9ebabf4f3\",\"name\":\"Google Drive\",\"type\":\"n8n-nodes-base.googleDrive\",\"disabled\":true,\"position\":[120,-780],\"parameters\":{\"name\":\"=Nostr Chatbot - Avatar - {{ $now }}\",\"content\":\"={{ $json.output }}\",\"driveId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"My Drive\"},\"options\":{},\"folderId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"root\",\"cachedResultName\":\"/ (Root folder)\"},\"operation\":\"createFromText\"},\"credentials\":{\"googleDriveOAuth2Api\":{\"id\":\"UhdXGYLTAJbsa0xX\",\"name\":\"Google Drive account\"}},\"typeVersion\":3},{\"id\":\"6d6813f6-4f2e-499a-9e5c-fe15624a91ef\",\"name\":\"Respond to User\",\"type\":\"n8n-nodes-base.set\",\"position\":[120,-960],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"cd8f88e1-19c0-4b9e-914d-e2e7ba21d9fa\",\"name\":\"output\",\"type\":\"string\",\"value\":\"={{ $json.output }}\"}]}},\"typeVersion\":3.4},{\"id\":\"1c73bae9-2bdd-4383-a6f8-3cf43d3c15be\",\"name\":\"Sticky Note13\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[0,-1300],\"parameters\":{\"color\":4,\"width\":340,\"height\":300,\"content\":\"## Save Chat History\"},\"typeVersion\":1},{\"id\":\"db3dcc69-d1d0-48a1-b949-37f2de802b4a\",\"name\":\"Update Chat History\",\"type\":\"n8n-nodes-base.googleDocs\",\"position\":[120,-1200],\"parameters\":{\"actionsUi\":{\"actionFields\":[{\"text\":\"=\\n-------------------------------\\n\\n{{ $now }}\\n\\n{{ $('When chat message received').item.json.chatInput  }}\\n\\n{{ $json.output }}\",\"action\":\"insert\"}]},\"operation\":\"update\",\"documentURL\":\"1ej_qLolUFp1h4eZkrb99T3DWQ3JOwXVEMS3VUjWyVf0\"},\"credentials\":{\"googleDocsOAuth2Api\":{\"id\":\"YWEHuG28zOt532MQ\",\"name\":\"Google Docs account\"}},\"typeVersion\":2},{\"id\":\"2dd28eed-b71b-44fb-bb78-8cb50b0d0c93\",\"name\":\"Qdrant Vector Store Tool\",\"type\":\"@n8n/n8n-nodes-langchain.vectorStoreQdrant\",\"position\":[-420,-1000],\"parameters\":{\"mode\":\"retrieve-as-tool\",\"topK\":20,\"options\":{},\"toolName\":\"nostr_damus_user_profiles\",\"toolDescription\":\"Retrieve information about Nostr or Damus users\",\"qdrantCollection\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"nostr-damus-user-profiles\",\"cachedResultName\":\"nostr-damus-user-profiles\"}},\"credentials\":{\"qdrantApi\":{\"id\":\"DJQ4hVAVdWZytjr2\",\"name\":\"QdrantApi account\"}},\"typeVersion\":1},{\"id\":\"3b130cf8-ab8e-4001-a3d0-a129194aee98\",\"name\":\"OpenAI Chat Model\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\"disabled\":true,\"position\":[-760,-820],\"parameters\":{\"model\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"gpt-4o-mini\"},\"options\":{}},\"credentials\":{\"openAiApi\":{\"id\":\"jEMSvKmtYfzAkhe6\",\"name\":\"OpenAi account\"}},\"typeVersion\":1.2},{\"id\":\"ccc64645-ad14-4b6b-a507-0b5fb0ac945f\",\"name\":\"Send Completed Message\",\"type\":\"n8n-nodes-base.telegram\",\"position\":[500,200],\"webhookId\":\"382a3b43-b83f-47b1-a276-67c6b98a441a\",\"parameters\":{\"text\":\"Qdrant vector store upsert completed\",\"chatId\":\"={{ $env.TELEGRAM_CHAT_ID }}\",\"additionalFields\":{\"appendAttribution\":false}},\"credentials\":{\"telegramApi\":{\"id\":\"pAIFhguJlkO3c7aQ\",\"name\":\"Telegram account\"}},\"typeVersion\":1.2},{\"id\":\"885fef53-2246-45b1-a122-ab5b82374585\",\"name\":\"Sticky Note14\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-2120,-480],\"parameters\":{\"width\":700,\"height\":1240,\"content\":\"# 🤖 AI-Powered RAG Chatbot with Google Drive Integration\\n\\nThis workflow creates a powerful RAG (Retrieval-Augmented Generation) chatbot that can process, store, and interact with documents from Google Drive using Qdrant vector storage and Google's Gemini AI.\\n\\n## How It Works\\n\\n### Document Processing & Storage 📚\\n- Retrieves documents from a specified Google Drive folder\\n- Processes and splits documents into manageable chunks\\n- Extracts metadata using AI for enhanced search capabilities\\n- Stores document vectors in Qdrant for efficient retrieval\\n\\n### Intelligent Chat Interface 💬\\n- Provides a conversational interface powered by Google Gemini\\n- Uses RAG to retrieve relevant context from stored documents\\n- Maintains chat history in Google Docs for reference\\n- Delivers accurate, context-aware responses\\n\\n### Vector Store Management 🗄️\\n- Features secure delete operations with human verification\\n- Includes Telegram notifications for important operations\\n- Maintains data integrity with proper version control\\n- Supports batch processing of documents\\n\\n## Setup Steps\\n\\n1. Configure API Credentials:\\n   - Set up Google Drive & Docs access\\n   - Configure Gemini AI API\\n   - Set up Qdrant vector store connection\\n   - Add Telegram bot for notifications\\n\\n2. Configure Document Sources:\\n   - Set Google Drive folder ID\\n   - Define Qdrant collection name\\n   - Set up document processing parameters\\n\\n3. Test and Deploy:\\n   - Verify document processing\\n   - Test chat functionality\\n   - Confirm vector store operations\\n   - Check notification system\\n\\n\\nThis workflow is ideal for organizations needing to create intelligent chatbots that can access and understand large document repositories while maintaining context and providing accurate responses through RAG technology.\\n\"},\"typeVersion\":1}],\"active\":false,\"pinData\":{},\"settings\":{\"timezone\":\"America/Vancouver\",\"callerPolicy\":\"workflowsFromSameOwner\",\"executionOrder\":\"v1\"},\"versionId\":\"0c0d90e5-02f9-4169-b477-fd90c52ce44e\",\"connections\":{\"If\":{\"main\":[[{\"node\":\"Delete Qdrant Points by File ID\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Send Declined Message\",\"type\":\"main\",\"index\":0}]]},\"Wait\":{\"main\":[[{\"node\":\"Loop Over Items\",\"type\":\"main\",\"index\":0}]]},\"Merge\":{\"main\":[[{\"node\":\"Qdrant Vector Store\",\"type\":\"main\",\"index\":0}]]},\"Merge1\":{\"main\":[[{\"node\":\"Confirm Qdrant Delete Points\",\"type\":\"main\",\"index\":0}]]},\"Merge2\":{\"main\":[[{\"node\":\"Loop Over Items\",\"type\":\"main\",\"index\":0}]]},\"Webhook\":{\"main\":[[{\"node\":\"Google Folder ID\",\"type\":\"main\",\"index\":0}]]},\"AI Agent\":{\"main\":[[{\"node\":\"Update Chat History\",\"type\":\"main\",\"index\":0},{\"node\":\"Respond to User\",\"type\":\"main\",\"index\":0}]]},\"Data Loader\":{\"ai_document\":[[{\"node\":\"Qdrant Vector Store\",\"type\":\"ai_document\",\"index\":0}]]},\"File Id List\":{\"main\":[[{\"node\":\"Merge1\",\"type\":\"main\",\"index\":1}]]},\"gpt-4o-mini1\":{\"ai_languageModel\":[[{\"node\":\"Delete Qdrant Points by File ID\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"Token Splitter\":{\"ai_textSplitter\":[[{\"node\":\"Data Loader\",\"type\":\"ai_textSplitter\",\"index\":0}]]},\"Loop Over Items\":{\"main\":[[{\"node\":\"Send Completed Message\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Download File From Google Drive\",\"type\":\"main\",\"index\":0}]]},\"Respond to User\":{\"main\":[[]]},\"Google Folder ID\":{\"main\":[[{\"node\":\"Find File Ids in Google Drive Folder\",\"type\":\"main\",\"index\":0}]]},\"Extract Meta Data\":{\"main\":[[{\"node\":\"Merge\",\"type\":\"main\",\"index\":0}]]},\"Get File Contents\":{\"main\":[[{\"node\":\"Extract Meta Data\",\"type\":\"main\",\"index\":0}]]},\"OpenAI Chat Model\":{\"ai_languageModel\":[[]]},\"Qdrant Vector Store\":{\"main\":[[{\"node\":\"Wait\",\"type\":\"main\",\"index\":0}]]},\"Update Chat History\":{\"main\":[[]]},\"Window Buffer Memory\":{\"ai_memory\":[[{\"node\":\"AI Agent\",\"type\":\"ai_memory\",\"index\":0}]]},\"Qdrant Collection Name\":{\"main\":[[{\"node\":\"Merge1\",\"type\":\"main\",\"index\":0}]]},\"text-embeddings-3-large\":{\"ai_embedding\":[[{\"node\":\"Qdrant Vector Store\",\"type\":\"ai_embedding\",\"index\":0}]]},\"Google Gemini Chat Model\":{\"ai_languageModel\":[[{\"node\":\"Extract Meta Data\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"Qdrant Vector Store Tool\":{\"ai_tool\":[[{\"node\":\"AI Agent\",\"type\":\"ai_tool\",\"index\":0}]],\"ai_vectorStore\":[[]]},\"text-embeddings-3-large1\":{\"ai_embedding\":[[{\"node\":\"Qdrant Vector Store Tool\",\"type\":\"ai_embedding\",\"index\":0}]]},\"Google Gemini Chat Model1\":{\"ai_languageModel\":[[{\"node\":\"AI Agent\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"When chat message received\":{\"main\":[[{\"node\":\"AI Agent\",\"type\":\"main\",\"index\":0}]]},\"Confirm Qdrant Delete Points\":{\"main\":[[{\"node\":\"If\",\"type\":\"main\",\"index\":0}]]},\"Delete Qdrant Points by File ID\":{\"main\":[[{\"node\":\"Merge2\",\"type\":\"main\",\"index\":1}]]},\"Download File From Google Drive\":{\"main\":[[{\"node\":\"Get File Contents\",\"type\":\"main\",\"index\":0},{\"node\":\"Merge\",\"type\":\"main\",\"index\":1}]]},\"When clicking ‘Test workflow’\":{\"main\":[[{\"node\":\"Google Folder ID\",\"type\":\"main\",\"index\":0}]]},\"Find File Ids in Google Drive Folder\":{\"main\":[[{\"node\":\"File Id List\",\"type\":\"main\",\"index\":0},{\"node\":\"Qdrant Collection Name\",\"type\":\"main\",\"index\":0},{\"node\":\"Merge2\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "# 🤖 AI-Powered RAG Chatbot with Google Drive Integration\n\nThis workflow creates a powerful RAG (Retrieval-Augmented Generation) chatbot that can process, store, and interact with documents from Google Drive using Qdrant vector storage and Google's Gemini AI.\n\n## How It Works\n\n### Document Processing & Storage 📚\n\n  * Retrieves documents from a specified Google Drive folder\n  * Processes and splits documents into manageable chunks\n  * Extracts metadata using AI for enhanced search capabilities\n  * Stores document vectors in Qdrant for efficient retrieval\n\n\n\n### Intelligent Chat Interface 💬\n\n  * Provides a conversational interface powered by Google Gemini\n  * Uses RAG to retrieve relevant context from stored documents\n  * Maintains chat history in Google Docs for reference\n  * Delivers accurate, context-aware responses\n\n\n\n### Vector Store Management 🗄️\n\n  * Features secure delete operations with human verification\n  * Includes Telegram notifications for important operations\n  * Maintains data integrity with proper version control\n  * Supports batch processing of documents\n\n\n\n## Setup Steps\n\n  1. Configure API Credentials:\n\n     * Set up Google Drive & Docs access\n     * Configure Gemini AI API\n     * Set up Qdrant vector store connection\n     * Add Telegram bot for notifications\n     * Add OpenAI Api Key to the '**Delete Qdrant Points by File ID** ' node\n  2. Configure Document Sources:\n\n     * Set Google Drive folder ID\n     * Define Qdrant collection name\n     * Set up document processing parameters\n  3. Test and Deploy:\n\n     * Verify document processing\n     * Test chat functionality\n     * Confirm vector store operations\n     * Check notification system\n\n\n\nThis workflow is ideal for organizations needing to create intelligent chatbots that can access and understand large document repositories while maintaining context and providing accurate responses through RAG technology.\n",
  "readme_html": "<!--[--><div data-v-006f9244=\"\"><h1>🤖 AI-Powered RAG Chatbot with Google Drive Integration</h1>\n<p>This workflow creates a powerful RAG (Retrieval-Augmented Generation) chatbot that can process, store, and interact with documents from Google Drive using Qdrant vector storage and Google's Gemini AI.</p>\n<h2>How It Works</h2>\n<h3>Document Processing &amp; Storage 📚</h3>\n<ul>\n<li>Retrieves documents from a specified Google Drive folder</li>\n<li>Processes and splits documents into manageable chunks</li>\n<li>Extracts metadata using AI for enhanced search capabilities</li>\n<li>Stores document vectors in Qdrant for efficient retrieval</li>\n</ul>\n<h3>Intelligent Chat Interface 💬</h3>\n<ul>\n<li>Provides a conversational interface powered by Google Gemini</li>\n<li>Uses RAG to retrieve relevant context from stored documents</li>\n<li>Maintains chat history in Google Docs for reference</li>\n<li>Delivers accurate, context-aware responses</li>\n</ul>\n<h3>Vector Store Management 🗄️</h3>\n<ul>\n<li>Features secure delete operations with human verification</li>\n<li>Includes Telegram notifications for important operations</li>\n<li>Maintains data integrity with proper version control</li>\n<li>Supports batch processing of documents</li>\n</ul>\n<h2>Setup Steps</h2>\n<ol>\n<li>\n<p>Configure API Credentials:</p>\n<ul>\n<li>Set up Google Drive &amp; Docs access</li>\n<li>Configure Gemini AI API</li>\n<li>Set up Qdrant vector store connection</li>\n<li>Add Telegram bot for notifications</li>\n<li>Add OpenAI Api Key to the '<strong>Delete Qdrant Points by File ID</strong>' node</li>\n</ul>\n</li>\n<li>\n<p>Configure Document Sources:</p>\n<ul>\n<li>Set Google Drive folder ID</li>\n<li>Define Qdrant collection name</li>\n<li>Set up document processing parameters</li>\n</ul>\n</li>\n<li>\n<p>Test and Deploy:</p>\n<ul>\n<li>Verify document processing</li>\n<li>Test chat functionality</li>\n<li>Confirm vector store operations</li>\n<li>Check notification system</li>\n</ul>\n</li>\n</ol>\n<p>This workflow is ideal for organizations needing to create intelligent chatbots that can access and understand large document repositories while maintaining context and providing accurate responses through RAG technology.</p>\n</div><!--]-->",
  "readme_zh": "# 🤖 基于AI的谷歌网盘RAG智能聊天机器人\n\n此工作流构建了一个强大的RAG（检索增强生成）聊天机器人，能够通过Qdrant向量存储和谷歌Gemini AI处理、存储并交互谷歌网盘中的文档。\n\n## 核心原理\n\n### 文档处理与存储 📚\n\n* 从指定谷歌网盘文件夹获取文档\n* 将文档分割为可管理的文本块\n* 运用AI提取元数据增强搜索能力\n* 将文档向量存储至Qdrant实现高效检索\n\n### 智能对话界面 💬\n\n* 搭载谷歌Gemini的对话交互系统\n* 采用RAG技术从存储文档检索相关上下文\n* 聊天记录自动保存至谷歌文档供追溯\n* 提供精准的上下文感知应答\n\n### 向量存储管理 🗄️\n\n* 配备人工验证的安全删除功能\n* 重要操作触发Telegram通知\n* 完善的版本控制保障数据完整性\n* 支持文档批量处理\n\n## 部署步骤\n\n1. API凭证配置：\n   * 开通谷歌网盘/文档权限\n   * 设置Gemini AI API\n   * 连接Qdrant向量数据库\n   * 添加Telegram通知机器人\n   * 在「按文件ID删除Qdrant节点」中配置OpenAI密钥\n\n2. 文档源设置：\n   * 输入谷歌网盘文件夹ID\n   * 定义Qdrant集合名称\n   * 配置文档处理参数\n\n3. 测试验证：\n   * 检查文档处理流程\n   * 测试对话功能\n   * 验证向量库操作\n   * 测试通知系统\n\n本方案特别适合需要构建智能聊天机器人的组织，通过RAG技术实现对海量文档库的智能访问与理解，在保持上下文连贯的同时提供精准应答。",
  "title_zh": "🤖 智能文档聊天机器人：集成文档库 + Google Drive + Gemini + Qdrant",
  "publish_date_absolute": "2025-03-07",
  "publish_date_zh": "最后更新于2个月前",
  "workflow_json_zh": "{\n  \"id\": \"8tusZTTtcyaiznEG\",\n  \"meta\": {\n    \"instanceId\": \"31e69f7f4a77bf465b805824e303232f0227212ae922d12133a0f96ffeab4fef\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"name\": \"🤖 AI Powered RAG Chatbot for Your Docs + Google Drive + Gemini + Qdrant\",\n  \"tags\": [],\n  \"nodes\": [\n    {\n      \"id\": \"7ad5796b-d1a0-4cc1-bed6-105ff499beeb\",\n      \"name\": \"Data Loader\",\n      \"type\": \"@n8n/n8n-nodes-langchain.documentDefaultDataLoader\",\n      \"position\": [\n        620,\n        720\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"metadata\": {\n            \"metadataValues\": [\n              {\n                \"name\": \"file_id\",\n                \"value\": \"={{ $json.id }}\"\n              },\n              {\n                \"name\": \"pubkey\",\n                \"value\": \"={{ $json.name }}\"\n              },\n              {\n                \"name\": \"=overarching_theme\",\n                \"value\": \"={{ $('Extract Meta Data').item.json.output.overarching_theme }}\"\n              },\n              {\n                \"name\": \"recurring_topics\",\n                \"value\": \"={{ $('Extract Meta Data').item.json.output.recurring_topics }}\"\n              },\n              {\n                \"name\": \"pain_points\",\n                \"value\": \"={{ $('Extract Meta Data').item.json.output.pain_points }}\"\n              },\n              {\n                \"name\": \"analytical_insights\",\n                \"value\": \"={{ $('Extract Meta Data').item.json.output.analytical_insights }}\"\n              },\n              {\n                \"name\": \"conclusion\",\n                \"value\": \"={{ $('Extract Meta Data').item.json.output.conclusion }}\"\n              },\n              {\n                \"name\": \"keywords\",\n                \"value\": \"={{ $('Extract Meta Data').item.json.output.keywords }}\"\n              }\n            ]\n          }\n        },\n        \"dataType\": \"binary\",\n        \"binaryMode\": \"specificField\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"84986ee2-4d79-49e8-8778-b8a955cf2174\",\n      \"name\": \"Token Splitter\",\n      \"type\": \"@n8n/n8n-nodes-langchain.textSplitterTokenSplitter\",\n      \"position\": [\n        720,\n        860\n      ],\n      \"parameters\": {\n        \"chunkSize\": 3000\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"82aa7016-f3af-4de8-a410-b1c802041213\",\n      \"name\": \"Qdrant Vector Store\",\n      \"type\": \"@n8n/n8n-nodes-langchain.vectorStoreQdrant\",\n      \"onError\": \"continueRegularOutput\",\n      \"position\": [\n        540,\n        520\n      ],\n      \"parameters\": {\n        \"mode\": \"insert\",\n        \"options\": {},\n        \"qdrantCollection\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"=nostr-damus-user-profiles\"\n        }\n      },\n      \"credentials\": {\n        \"qdrantApi\": {\n          \"id\": \"DJQ4hVAVdWZytjr2\",\n          \"name\": \"QdrantApi account\"\n        }\n      },\n      \"executeOnce\": false,\n      \"retryOnFail\": true,\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"07f4d14a-1864-406b-946b-09c776e3038b\",\n      \"name\": \"Loop Over Items\",\n      \"type\": \"n8n-nodes-base.splitInBatches\",\n      \"onError\": \"continueRegularOutput\",\n      \"position\": [\n        180,\n        -140\n      ],\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"b0f9b066-62de-41bc-afce-dcb4d20d100c\",\n      \"name\": \"Wait\",\n      \"type\": \"n8n-nodes-base.wait\",\n      \"position\": [\n        1020,\n        840\n      ],\n      \"webhookId\": \"237d7f8a-aead-479a-b813-f407d1f37fa5\",\n      \"parameters\": {},\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"2a883003-f5ec-409e-97e4-809360ca11ed\",\n      \"name\": \"When clicking ‘Test workflow’\",\n      \"type\": \"n8n-nodes-base.manualTrigger\",\n      \"position\": [\n        -1160,\n        -280\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"cfbb6b77-142f-4689-b051-436f40ababe6\",\n      \"name\": \"Google Gemini Chat Model\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatGoogleGemini\",\n      \"position\": [\n        1120,\n        -20\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"temperature\": 0.4\n        },\n        \"modelName\": \"models/gemini-2.0-flash-exp\"\n      },\n      \"credentials\": {\n        \"googlePalmApi\": {\n          \"id\": \"L9UNQHflYlyF9Ngd\",\n          \"name\": \"Google Gemini(PaLM) Api account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"c9c50387-64a3-473f-9ea7-509a301836a3\",\n      \"name\": \"Merge\",\n      \"type\": \"n8n-nodes-base.merge\",\n      \"position\": [\n        820,\n        200\n      ],\n      \"parameters\": {\n        \"mode\": \"combine\",\n        \"options\": {},\n        \"combineBy\": \"combineAll\"\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"ea143b9f-9bd8-4f3f-8979-5a0fd2691e9d\",\n      \"name\": \"Extract Meta Data\",\n      \"type\": \"@n8n/n8n-nodes-langchain.informationExtractor\",\n      \"position\": [\n        1020,\n        -180\n      ],\n      \"parameters\": {\n        \"text\": \"={{ $json.data }}\",\n        \"options\": {\n          \"systemPromptTemplate\": \"You are an expert extraction algorithm.\\nOnly extract relevant information from the text.\\nIf you do not know the value of an attribute asked to extract, you may omit the attribute's value.\"\n        },\n        \"attributes\": {\n          \"attributes\": [\n            {\n              \"name\": \"overarching_theme\",\n              \"description\": \"Summarize the main theme(s) discussed in the \\\"Overarching Theme\\\" section.\"\n            },\n            {\n              \"name\": \"recurring_topics\",\n              \"description\": \"List the recurring topics mentioned in the \\\"Common Threads\\\" section as an array of strings.\"\n            },\n            {\n              \"name\": \"pain_points\",\n              \"description\": \"Summarize the user's frustrations or challenges mentioned in the \\\"Pain Points\\\" section as an array of strings.\"\n            },\n            {\n              \"name\": \"analytical_insights\",\n              \"description\": \"Extract a list of key analytical observations from the \\\"Analytical Insights\\\" section, including shifts in tone or behavior.\"\n            },\n            {\n              \"name\": \"conclusion\",\n              \"description\": \"Summarize the conclusions drawn about the user’s threads and their overall focus.\"\n            },\n            {\n              \"name\": \"keywords\",\n              \"description\": \"Generate a list of 10 keywords that capture the essence of the document (e.g., \\\"askNostr,\\\" \\\"decentralization,\\\" \\\"spam filtering\\\").\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"2ddd778f-6676-4a4b-b592-536401831bc8\",\n      \"name\": \"Get File Contents\",\n      \"type\": \"n8n-nodes-base.extractFromFile\",\n      \"position\": [\n        820,\n        -180\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"operation\": \"text\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"cdbb8bbc-967c-4f01-b844-4d31328153df\",\n      \"name\": \"Download File From Google Drive\",\n      \"type\": \"n8n-nodes-base.googleDrive\",\n      \"position\": [\n        500,\n        -180\n      ],\n      \"parameters\": {\n        \"fileId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $json.id }}\"\n        },\n        \"options\": {},\n        \"operation\": \"download\"\n      },\n      \"credentials\": {\n        \"googleDriveOAuth2Api\": {\n          \"id\": \"UhdXGYLTAJbsa0xX\",\n          \"name\": \"Google Drive account\"\n        }\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"399e196c-76ec-4077-aacc-f669173b0229\",\n      \"name\": \"Find File Ids in Google Drive Folder\",\n      \"type\": \"n8n-nodes-base.googleDrive\",\n      \"position\": [\n        -620,\n        -160\n      ],\n      \"parameters\": {\n        \"filter\": {\n          \"driveId\": {\n            \"mode\": \"list\",\n            \"value\": \"My Drive\"\n          },\n          \"folderId\": {\n            \"__rl\": true,\n            \"mode\": \"id\",\n            \"value\": \"={{ $json.folder_id }}\"\n          }\n        },\n        \"options\": {},\n        \"resource\": \"fileFolder\",\n        \"returnAll\": true\n      },\n      \"credentials\": {\n        \"googleDriveOAuth2Api\": {\n          \"id\": \"UhdXGYLTAJbsa0xX\",\n          \"name\": \"Google Drive account\"\n        }\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"3bc4f005-c6c8-4f73-816a-1573d6dfb62f\",\n      \"name\": \"text-embeddings-3-large\",\n      \"type\": \"@n8n/n8n-nodes-langchain.embeddingsOpenAi\",\n      \"position\": [\n        480,\n        720\n      ],\n      \"parameters\": {\n        \"model\": \"text-embedding-3-large\",\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"jEMSvKmtYfzAkhe6\",\n          \"name\": \"OpenAi account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"5d42b34a-7156-4163-a2c4-a9cb3c984c96\",\n      \"name\": \"Google Folder ID\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        -820,\n        -160\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"e6f6188f-c895-4c8c-b39a-0ef55b490fd6\",\n              \"name\": \"folder_id\",\n              \"type\": \"string\",\n              \"value\": \"[Your-Google-Folder-ID]\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"7be310c2-d30f-42a2-8f57-33c7b184e429\",\n      \"name\": \"gpt-4o-mini1\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\n      \"position\": [\n        -400,\n        940\n      ],\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"jEMSvKmtYfzAkhe6\",\n          \"name\": \"OpenAi account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"18aacfd9-3f6e-4fba-9f68-d8cc95bc667b\",\n      \"name\": \"Delete Qdrant Points by File ID\",\n      \"type\": \"@n8n/n8n-nodes-langchain.code\",\n      \"position\": [\n        -500,\n        800\n      ],\n      \"parameters\": {\n        \"code\": {\n          \"execute\": {\n            \"code\": \"const { QdrantVectorStore } = require(\\\"@langchain/qdrant\\\");\\nconst { OpenAIEmbeddings } = require(\\\"@langchain/openai\\\");\\n\\n// Qdrant connection details\\nconst url = \\\"http://localhost:6333/\\\";\\nconst apiKey = \\\"\\\";\\n\\n// OpenAI API configuration\\nconst openAIApiKey = \\\"[Your-OpenAI-API-Key]\\\";\\n\\n// Get input data\\nconst items = this.getInputData()[0];\\n// console.log(items)\\n\\nconst collectionName =  items.json.qdrant_collection_name;\\n// console.log(collectionName)\\n\\nasync function deleteDocumentsFromQdrant() {\\n  try {\\n    // Initialize OpenAI embeddings\\n    const embeddings = new OpenAIEmbeddings({\\n      model: \\\"text-embedding-3-large\\\",\\n      openAIApiKey: openAIApiKey\\n    });\\n\\n    // Connect to existing Qdrant collection\\n    const vectorStore = await QdrantVectorStore.fromExistingCollection(embeddings, {\\n      url: url,\\n      apiKey: apiKey,\\n      collectionName: collectionName,\\n    });\\n\\n    const fileIds = items.json.appended_id.map(item => item);\\n\\n    console.log(fileIds)\\n\\n    // Delete points by fileId\\n    const deletionResults = await Promise.all(fileIds.map(async (file_id) => {\\n      const filter = {\\n        must: [\\n          {\\n            key: \\\"metadata.file_id\\\",\\n            match: { value: file_id }\\n          }\\n        ]\\n      };\\n\\n      try {\\n        // Access the underlying Qdrant client to perform the deletion\\n        await vectorStore.client.delete(collectionName, { filter });\\n        return { file_id, status: \\\"deleted\\\" };\\n      } catch (error) {\\n        console.error(`Error deleting documents for fileId ${file_id}:`, error);\\n        return { file_id, status: \\\"error\\\", message: error.message };\\n      }\\n    }));\\n\\n    return deletionResults;\\n  } catch (error) {\\n    console.error(\\\"An error occurred during the deletion process:\\\", error);\\n    return error.message;\\n  }\\n}\\n\\n// Execute the deletion process\\ntry {\\n  const result = await deleteDocumentsFromQdrant();\\n  console.log(\\\"Deletion process completed:\\\", result);\\n  return [];\\n} catch (error) {\\n  console.error(\\\"Failed to execute deletion process:\\\", error);\\n  return [{ json: { error } }];\\n}\\n\\n\"\n          }\n        },\n        \"inputs\": {\n          \"input\": [\n            {\n              \"type\": \"main\",\n              \"required\": true,\n              \"maxConnections\": 1\n            },\n            {\n              \"type\": \"ai_languageModel\",\n              \"required\": true,\n              \"maxConnections\": 1\n            }\n          ]\n        },\n        \"outputs\": {\n          \"output\": [\n            {\n              \"type\": \"main\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"329cec97-aac1-4714-97ce-add5915b1078\",\n      \"name\": \"Qdrant Collection Name\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        -700,\n        100\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"11fa71e9-6cbc-4183-9439-e3379b2b970e\",\n              \"name\": \"qdrant_collection_name\",\n              \"type\": \"string\",\n              \"value\": \"nostr-damus-user-profiles\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"82e98da8-530d-4a3c-97e6-5e91ad644a46\",\n      \"name\": \"File Id List\",\n      \"type\": \"n8n-nodes-base.summarize\",\n      \"position\": [\n        -700,\n        280\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"fieldsToSummarize\": {\n          \"values\": [\n            {\n              \"field\": \"id\",\n              \"aggregation\": \"append\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"f3def614-2709-4847-831d-d6a80c86ec1c\",\n      \"name\": \"Merge1\",\n      \"type\": \"n8n-nodes-base.merge\",\n      \"position\": [\n        -340,\n        340\n      ],\n      \"parameters\": {\n        \"mode\": \"combine\",\n        \"options\": {},\n        \"combineBy\": \"combineByPosition\"\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"cfe399fb-8560-4ac4-98f7-4f539ae6a52c\",\n      \"name\": \"Merge2\",\n      \"type\": \"n8n-nodes-base.merge\",\n      \"position\": [\n        -80,\n        -140\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"1059da47-2abd-4884-b9c2-6b7d1623e31d\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -1280,\n        560\n      ],\n      \"parameters\": {\n        \"color\": 3,\n        \"width\": 1180,\n        \"height\": 760,\n        \"content\": \"## 准备Qdrant向量存储\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"2616e08f-070e-45b5-906f-40e832519aa2\",\n      \"name\": \"Confirm Qdrant Delete Points\",\n      \"type\": \"n8n-nodes-base.telegram\",\n      \"position\": [\n        -1060,\n        760\n      ],\n      \"webhookId\": \"29aac1ac-9345-4e44-babf-ebcfae701d88\",\n      \"parameters\": {\n        \"chatId\": \"={{ $env.TELEGRAM_CHAT_ID }}\",\n        \"message\": \"=WARNING - {{ $json.appended_id.length }} Records in the Qdrant vector store collection \\\"{{ $json.qdrant_collection_name }}\\\" will be deleted.  Are you sure you want to continue?  This action cannot be undone!\",\n        \"options\": {\n          \"limitWaitTime\": {\n            \"values\": {\n              \"resumeUnit\": \"minutes\",\n              \"resumeAmount\": 15\n            }\n          }\n        },\n        \"operation\": \"sendAndWait\",\n        \"approvalOptions\": {\n          \"values\": {\n            \"approvalType\": \"double\"\n          }\n        }\n      },\n      \"credentials\": {\n        \"telegramApi\": {\n          \"id\": \"pAIFhguJlkO3c7aQ\",\n          \"name\": \"Telegram account\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"9d167192-e87b-41be-87f2-d7ddf866bb8d\",\n      \"name\": \"If\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        -1060,\n        1000\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"20f530d6-fd55-420d-b8a9-70e5303f688e\",\n              \"operator\": {\n                \"type\": \"boolean\",\n                \"operation\": \"true\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json.data.approved }}\",\n              \"rightValue\": \"\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"1178f8cf-ece0-4b11-942d-18dd025da366\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        320,\n        420\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 920,\n        \"height\": 640,\n        \"content\": \"## 执行Qdrant向量存储操作\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"cbf17a08-2f4c-4605-8418-5bf93ade7cf4\",\n      \"name\": \"Send Declined Message\",\n      \"type\": \"n8n-nodes-base.telegram\",\n      \"position\": [\n        -740,\n        1120\n      ],\n      \"webhookId\": \"382a3b43-b83f-47b1-a276-67c6b98a441a\",\n      \"parameters\": {\n        \"text\": \"Qdrant vector store upsert declined\",\n        \"chatId\": \"={{ $env.TELEGRAM_CHAT_ID }}\",\n        \"additionalFields\": {\n          \"appendAttribution\": false\n        }\n      },\n      \"credentials\": {\n        \"telegramApi\": {\n          \"id\": \"pAIFhguJlkO3c7aQ\",\n          \"name\": \"Telegram account\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"890f478a-e000-418d-8582-4fef946e44d8\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -900,\n        -380\n      ],\n      \"parameters\": {\n        \"width\": 480,\n        \"height\": 840,\n        \"content\": \"## 🌟工作流配置\\n\\n- Google云端硬盘文件夹ID\\n- Qdrant集合名称\\n- Google云端硬盘文件ID列表\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"d2bc2fed-c134-4e54-bd9d-69996be966a3\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        740,\n        -280\n      ],\n      \"parameters\": {\n        \"color\": 6,\n        \"width\": 640,\n        \"height\": 420,\n        \"content\": \"## 提取Qdrant混合搜索的元数据\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"61f3c21e-bc2a-47bc-8ab1-678b1f425ee3\",\n      \"name\": \"Sticky Note4\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        400,\n        -280\n      ],\n      \"parameters\": {\n        \"color\": 2,\n        \"width\": 300,\n        \"height\": 320,\n        \"content\": \"## 谷歌云端硬盘\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"61e608e4-ac6a-4131-9ca8-c46a5134bff9\",\n      \"name\": \"Sticky Note5\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        80,\n        -360\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 1360,\n        \"height\": 1480,\n        \"content\": \"## ✨ 将文档保存至Qdrant向量数据库\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"410681cb-e757-42c0-89de-902edbe998e3\",\n      \"name\": \"Sticky Note6\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -580,\n        680\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 420,\n        \"height\": 400,\n        \"content\": \"## 从Qdrant向量存储中删除\\n此操作不可撤销！！！\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"238469ce-3710-4681-b1b2-200c1b699d5e\",\n      \"name\": \"Sticky Note7\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -1200,\n        640\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 380,\n        \"height\": 520,\n        \"content\": \"## 人工介入环节\\n用户必须确认从Qdrant向量存储中删除点的操作\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"0b2f6ff4-dd02-4f0e-b2eb-60b1ce736cf5\",\n      \"name\": \"Sticky Note8\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -1280,\n        -380\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 340,\n        \"height\": 460,\n        \"content\": \"## 👍从这里开始！\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"abde545b-1a23-4b3e-8046-335b9d0fa445\",\n      \"name\": \"Webhook\",\n      \"type\": \"n8n-nodes-base.webhook\",\n      \"disabled\": true,\n      \"position\": [\n        -1160,\n        -100\n      ],\n      \"webhookId\": \"3a30557f-9264-4bc8-a253-a9356677c791\",\n      \"parameters\": {\n        \"path\": \"upsert\",\n        \"options\": {}\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"897d29af-719d-4fe7-93a9-44c693cc6547\",\n      \"name\": \"AI Agent\",\n      \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n      \"position\": [\n        -600,\n        -1200\n      ],\n      \"parameters\": {\n        \"text\": \"={{ $json.chatInput }}\",\n        \"options\": {\n          \"systemMessage\": \"=You are an intelligent assistant specialized in answering user questions using Nostr user profiles. Your primary goal is to provide precise, contextually relevant, and concise answers based on the tools and resources available.\\n\\n### TOOL\\nUse the \\\"nostr_damus_user_profiles\\\" tool to:\\n- perform semantic similarity searches and retrieve information from Nostr user profiles relevant to the user's query.\\n- access detailed information about Nostr and/or Damus users when additional context or specifics are required.\\n\\n### Key Instructions\\n1. **Response Guidelines**:\\n   - Clearly explain how the retrieved information addresses the user's query, if applicable.\\n   - If no relevant information is found, respond with: \\\"I cannot find the answer in the available resources.\\\"\\n\\n2. **Focus and Relevance**:\\n   - Ensure all responses are directly aligned with the user's question.\\n   - Avoid including extraneous details or relying solely on internal knowledge.\\n\"\n        },\n        \"promptType\": \"define\"\n      },\n      \"typeVersion\": 1.7\n    },\n    {\n      \"id\": \"316b0d8d-bbc7-4c40-b6d0-d0c762554fca\",\n      \"name\": \"Window Buffer Memory\",\n      \"type\": \"@n8n/n8n-nodes-langchain.memoryBufferWindow\",\n      \"position\": [\n        -580,\n        -1000\n      ],\n      \"parameters\": {\n        \"contextWindowLength\": 40\n      },\n      \"typeVersion\": 1.3\n    },\n    {\n      \"id\": \"f1e342a8-d50e-48a8-9d7a-850f8be93cff\",\n      \"name\": \"When chat message received\",\n      \"type\": \"@n8n/n8n-nodes-langchain.chatTrigger\",\n      \"position\": [\n        -1160,\n        -1200\n      ],\n      \"webhookId\": \"5f1c0c82-0ff9-40c7-9e2e-b1a96ffe24cd\",\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"12902fa9-5bcb-4e8b-ac13-7f4cb6e7e1d0\",\n      \"name\": \"Google Gemini Chat Model1\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatGoogleGemini\",\n      \"position\": [\n        -760,\n        -1000\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"maxOutputTokens\": 8192\n        },\n        \"modelName\": \"models/gemini-2.0-flash-exp\"\n      },\n      \"credentials\": {\n        \"googlePalmApi\": {\n          \"id\": \"L9UNQHflYlyF9Ngd\",\n          \"name\": \"Google Gemini(PaLM) Api account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"1c5818d4-6251-4d14-8b4f-d1f3ddfbed38\",\n      \"name\": \"text-embeddings-3-large1\",\n      \"type\": \"@n8n/n8n-nodes-langchain.embeddingsOpenAi\",\n      \"position\": [\n        -320,\n        -840\n      ],\n      \"parameters\": {\n        \"model\": \"text-embedding-3-large\",\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"jEMSvKmtYfzAkhe6\",\n          \"name\": \"OpenAi account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"80056067-5d2b-4ac7-8e69-e75bd66a1ad4\",\n      \"name\": \"Sticky Note9\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -900,\n        -1300\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 860,\n        \"height\": 680,\n        \"content\": \"## 🤖从Qdrant向量存储检索内容\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"b45b18e4-7773-4eec-837b-f43fc0eeb90c\",\n      \"name\": \"Sticky Note10\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -1280,\n        -1300\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 340,\n        \"height\": 320,\n        \"content\": \"## 🗣️ 与您的文档对话\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"8fe891dd-dee6-4abb-bc09-d90e6d7bf3cb\",\n      \"name\": \"Sticky Note11\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -1360,\n        -480\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 2880,\n        \"height\": 1880,\n        \"content\": \"# 第一步 - 将文档保存至Qdrant向量存储库\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"4a9bf716-3fc3-4ccc-b831-19a1afdb4588\",\n      \"name\": \"Sticky Note12\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -1360,\n        -1420\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 1780,\n        \"height\": 880,\n        \"content\": \"# 第二步 - 与Qdrant向量数据库中的文档对话\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"fccedfde-c5aa-4237-9d1c-feb9ebabf4f3\",\n      \"name\": \"Google Drive\",\n      \"type\": \"n8n-nodes-base.googleDrive\",\n      \"disabled\": true,\n      \"position\": [\n        120,\n        -780\n      ],\n      \"parameters\": {\n        \"name\": \"=Nostr Chatbot - Avatar - {{ $now }}\",\n        \"content\": \"={{ $json.output }}\",\n        \"driveId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"My Drive\"\n        },\n        \"options\": {},\n        \"folderId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"root\",\n          \"cachedResultName\": \"/ (Root folder)\"\n        },\n        \"operation\": \"createFromText\"\n      },\n      \"credentials\": {\n        \"googleDriveOAuth2Api\": {\n          \"id\": \"UhdXGYLTAJbsa0xX\",\n          \"name\": \"Google Drive account\"\n        }\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"6d6813f6-4f2e-499a-9e5c-fe15624a91ef\",\n      \"name\": \"Respond to User\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        120,\n        -960\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"cd8f88e1-19c0-4b9e-914d-e2e7ba21d9fa\",\n              \"name\": \"output\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.output }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"1c73bae9-2bdd-4383-a6f8-3cf43d3c15be\",\n      \"name\": \"Sticky Note13\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        0,\n        -1300\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 340,\n        \"height\": 300,\n        \"content\": \"## 保存聊天记录\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"db3dcc69-d1d0-48a1-b949-37f2de802b4a\",\n      \"name\": \"Update Chat History\",\n      \"type\": \"n8n-nodes-base.googleDocs\",\n      \"position\": [\n        120,\n        -1200\n      ],\n      \"parameters\": {\n        \"actionsUi\": {\n          \"actionFields\": [\n            {\n              \"text\": \"=\\n-------------------------------\\n\\n{{ $now }}\\n\\n{{ $('When chat message received').item.json.chatInput  }}\\n\\n{{ $json.output }}\",\n              \"action\": \"insert\"\n            }\n          ]\n        },\n        \"operation\": \"update\",\n        \"documentURL\": \"1ej_qLolUFp1h4eZkrb99T3DWQ3JOwXVEMS3VUjWyVf0\"\n      },\n      \"credentials\": {\n        \"googleDocsOAuth2Api\": {\n          \"id\": \"YWEHuG28zOt532MQ\",\n          \"name\": \"Google Docs account\"\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"2dd28eed-b71b-44fb-bb78-8cb50b0d0c93\",\n      \"name\": \"Qdrant Vector Store Tool\",\n      \"type\": \"@n8n/n8n-nodes-langchain.vectorStoreQdrant\",\n      \"position\": [\n        -420,\n        -1000\n      ],\n      \"parameters\": {\n        \"mode\": \"retrieve-as-tool\",\n        \"topK\": 20,\n        \"options\": {},\n        \"toolName\": \"nostr_damus_user_profiles\",\n        \"toolDescription\": \"Retrieve information about Nostr or Damus users\",\n        \"qdrantCollection\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"nostr-damus-user-profiles\",\n          \"cachedResultName\": \"nostr-damus-user-profiles\"\n        }\n      },\n      \"credentials\": {\n        \"qdrantApi\": {\n          \"id\": \"DJQ4hVAVdWZytjr2\",\n          \"name\": \"QdrantApi account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"3b130cf8-ab8e-4001-a3d0-a129194aee98\",\n      \"name\": \"OpenAI Chat Model\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\n      \"disabled\": true,\n      \"position\": [\n        -760,\n        -820\n      ],\n      \"parameters\": {\n        \"model\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"gpt-4o-mini\"\n        },\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"jEMSvKmtYfzAkhe6\",\n          \"name\": \"OpenAi account\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"ccc64645-ad14-4b6b-a507-0b5fb0ac945f\",\n      \"name\": \"Send Completed Message\",\n      \"type\": \"n8n-nodes-base.telegram\",\n      \"position\": [\n        500,\n        200\n      ],\n      \"webhookId\": \"382a3b43-b83f-47b1-a276-67c6b98a441a\",\n      \"parameters\": {\n        \"text\": \"Qdrant vector store upsert completed\",\n        \"chatId\": \"={{ $env.TELEGRAM_CHAT_ID }}\",\n        \"additionalFields\": {\n          \"appendAttribution\": false\n        }\n      },\n      \"credentials\": {\n        \"telegramApi\": {\n          \"id\": \"pAIFhguJlkO3c7aQ\",\n          \"name\": \"Telegram account\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"885fef53-2246-45b1-a122-ab5b82374585\",\n      \"name\": \"Sticky Note14\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -2120,\n        -480\n      ],\n      \"parameters\": {\n        \"width\": 700,\n        \"height\": 1240,\n        \"content\": \"# 🤖 集成谷歌云盘的AI增强检索聊天机器人\\n\\n该工作流构建了一个强大的RAG（检索增强生成）聊天机器人，能够通过Qdrant向量数据库和谷歌Gemini AI处理、存储并交互谷歌云盘中的文档。\\n\\n## 核心机制\\n\\n### 文档处理与存储 📚\\n- 从指定谷歌云盘文件夹获取文档\\n- 将文档分割为可管理的文本块\\n- 通过AI提取元数据增强搜索能力\\n- 将文档向量存储至Qdrant实现高效检索\\n\\n### 智能对话界面 💬\\n- 搭载谷歌Gemini的对话引擎\\n- 运用RAG技术从存储文档检索相关上下文\\n- 在谷歌文档中保存完整对话历史\\n- 提供精准的上下文感知应答\\n\\n### 向量数据库管理 🗄️\\n- 配备人工验证的安全删除功能\\n- 重要操作触发Telegram通知\\n- 通过版本控制保障数据完整性\\n- 支持文档批量处理\\n\\n## 部署流程\\n\\n1. 配置API凭证：\\n   - 开通谷歌云盘与文档权限\\n   - 设置Gemini AI接口\\n   - 连接Qdrant向量数据库\\n   - 配置Telegram机器人通知\\n\\n2. 设定文档源：\\n   - 指定谷歌云盘文件夹ID\\n   - 定义Qdrant集合名称\\n   - 配置文档处理参数\\n\\n3. 测试验证：\\n   - 检查文档处理流程\\n   - 测试对话功能\\n   - 验证向量库操作\\n   - 测试通知系统\\n\\n本方案特别适合需要构建智能聊天机器人的组织，通过RAG技术访问和理解海量文档库，在保持上下文连贯的同时提供精准应答。\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"active\": false,\n  \"pinData\": {},\n  \"settings\": {\n    \"timezone\": \"America/Vancouver\",\n    \"callerPolicy\": \"workflowsFromSameOwner\",\n    \"executionOrder\": \"v1\"\n  },\n  \"versionId\": \"0c0d90e5-02f9-4169-b477-fd90c52ce44e\",\n  \"connections\": {\n    \"If\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Delete Qdrant Points by File ID\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Send Declined Message\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Wait\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Loop Over Items\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Merge\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Qdrant Vector Store\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Merge1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Confirm Qdrant Delete Points\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Merge2\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Loop Over Items\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Webhook\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Google Folder ID\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"AI Agent\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Update Chat History\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Respond to User\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Data Loader\": {\n      \"ai_document\": [\n        [\n          {\n            \"node\": \"Qdrant Vector Store\",\n            \"type\": \"ai_document\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"File Id List\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge1\",\n            \"type\": \"main\",\n            \"index\": 1\n          }\n        ]\n      ]\n    },\n    \"gpt-4o-mini1\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"Delete Qdrant Points by File ID\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Token Splitter\": {\n      \"ai_textSplitter\": [\n        [\n          {\n            \"node\": \"Data Loader\",\n            \"type\": \"ai_textSplitter\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Loop Over Items\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Send Completed Message\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Download File From Google Drive\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Respond to User\": {\n      \"main\": [\n        []\n      ]\n    },\n    \"Google Folder ID\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Find File Ids in Google Drive Folder\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Extract Meta Data\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get File Contents\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Extract Meta Data\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"OpenAI Chat Model\": {\n      \"ai_languageModel\": [\n        []\n      ]\n    },\n    \"Qdrant Vector Store\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Wait\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Update Chat History\": {\n      \"main\": [\n        []\n      ]\n    },\n    \"Window Buffer Memory\": {\n      \"ai_memory\": [\n        [\n          {\n            \"node\": \"AI Agent\",\n            \"type\": \"ai_memory\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Qdrant Collection Name\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"text-embeddings-3-large\": {\n      \"ai_embedding\": [\n        [\n          {\n            \"node\": \"Qdrant Vector Store\",\n            \"type\": \"ai_embedding\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Google Gemini Chat Model\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"Extract Meta Data\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Qdrant Vector Store Tool\": {\n      \"ai_tool\": [\n        [\n          {\n            \"node\": \"AI Agent\",\n            \"type\": \"ai_tool\",\n            \"index\": 0\n          }\n        ]\n      ],\n      \"ai_vectorStore\": [\n        []\n      ]\n    },\n    \"text-embeddings-3-large1\": {\n      \"ai_embedding\": [\n        [\n          {\n            \"node\": \"Qdrant Vector Store Tool\",\n            \"type\": \"ai_embedding\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Google Gemini Chat Model1\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"AI Agent\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"When chat message received\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"AI Agent\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Confirm Qdrant Delete Points\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"If\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Delete Qdrant Points by File ID\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge2\",\n            \"type\": \"main\",\n            \"index\": 1\n          }\n        ]\n      ]\n    },\n    \"Download File From Google Drive\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get File Contents\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Merge\",\n            \"type\": \"main\",\n            \"index\": 1\n          }\n        ]\n      ]\n    },\n    \"When clicking ‘Test workflow’\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Google Folder ID\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Find File Ids in Google Drive Folder\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"File Id List\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Qdrant Collection Name\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Merge2\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}