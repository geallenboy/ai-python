{
  "title": "🌳 EU Green Legislation Tracker with GPT-4o, Google Sheets and Tasks",
  "url": "https://n8n.io/workflows/3644-eu-green-legislation-tracker-with-gpt-4o-google-sheets-and-tasks/",
  "category": "AI",
  "category_url": "https://n8n.io/workflows/categories/ai/",
  "author": "Samir Saci",
  "publish_date": "Last update 4 days ago",
  "content": "",
  "workflow_json": "{\"meta\":{\"instanceId\":\"=\"},\"nodes\":[{\"id\":\"4dfef9cb-d66a-4818-b5b2-6be81f0bd7c3\",\"name\":\"Loop Over Items\",\"type\":\"n8n-nodes-base.splitInBatches\",\"position\":[1160,500],\"parameters\":{\"options\":{}},\"typeVersion\":3},{\"id\":\"3fd73086-62cc-49c4-9c56-b2467a27601c\",\"name\":\"Merge\",\"type\":\"n8n-nodes-base.merge\",\"position\":[1980,360],\"parameters\":{\"mode\":\"combineBySql\"},\"notesInFlow\":true,\"typeVersion\":3},{\"id\":\"a894cc7b-7e2c-40af-bbdd-de03c9fdf71c\",\"name\":\"If\",\"type\":\"n8n-nodes-base.if\",\"position\":[2200,440],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"e3956615-6ad2-4df7-a15f-63f1f21d10fe\",\"operator\":{\"name\":\"filter.operator.equals\",\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $json.sustainability }}\",\"rightValue\":\"yes\"}]}},\"typeVersion\":2.2},{\"id\":\"b1b1616c-68f7-4911-b58d-8792ac4e822c\",\"name\":\"Extract Yesterday Records\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[280,500],\"parameters\":{\"url\":\"=https://oeil.secure.europarl.europa.eu/oeil/en/search?sessionDay.allDays=false&sessionDay.day={{$now.minus(18,'days').format('yyyyMMdd')}}&sessionDay.type=ALL\",\"options\":{}},\"notesInFlow\":true,\"typeVersion\":4.2},{\"id\":\"707ae04c-51d3-4547-9868-1c603d359cc0\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[0,0],\"parameters\":{\"color\":7,\"width\":1080,\"height\":660,\"content\":\"### 1. First Block: scrape the page to extract all the legislative procedures scheduled for debate yesterday\\nThis workflow sends an HTTP request to collect the HTML of the page by block. For each block we extract the information of the procedures: **Reference Number**. **Committee**, **Rapporteur**, **Title/Description**, **PDF Link**.\\n\\n#### How to setup?\\n*Nothing to do*\\n\"},\"typeVersion\":1},{\"id\":\"721a14b6-c860-431e-8475-b877d5a83768\",\"name\":\"Extract HTML Blocks\",\"type\":\"n8n-nodes-base.html\",\"position\":[500,500],\"parameters\":{\"options\":{},\"operation\":\"extractHtmlContent\",\"extractionValues\":{\"values\":[{\"key\":\"Blocks\",\"cssSelector\":\".erpl_document-wrapper\",\"returnArray\":true,\"returnValue\":\"html\"}]}},\"notesInFlow\":true,\"typeVersion\":1.2},{\"id\":\"fe609066-0f08-40b7-b8a8-13acd8338468\",\"name\":\"Parse Blocks\",\"type\":\"n8n-nodes-base.html\",\"position\":[720,500],\"parameters\":{\"options\":{},\"operation\":\"extractHtmlContent\",\"dataPropertyName\":\"Blocks\",\"extractionValues\":{\"values\":[{\"key\":\"Reference Number\",\"cssSelector\":\"h3 span.t-item\"},{\"key\":\"Committee\",\"cssSelector\":\"span.erpl_badge-committee\"},{\"key\":\"Rapporteur\",\"cssSelector\":\"span.erpl_document-subtitle-author\"},{\"key\":\"Title/Description\",\"cssSelector\":\"div.erpl_document-body p\"},{\"key\":\"PDF Link\\t\",\"attribute\":\"href\",\"cssSelector\":\"a.erpl_document-subtitle-pdf\",\"returnValue\":\"attribute\"},{\"key\":\"Date\",\"cssSelector\":\"div.mt-1 p\"}]}},\"notesInFlow\":true,\"typeVersion\":1.2},{\"id\":\"75770b01-0c98-4077-97d7-3bbc82166372\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1100,0],\"parameters\":{\"color\":7,\"width\":1020,\"height\":660,\"content\":\"### 2. Use a LLM to keep only the procedures related to sustainability\\nWe loop though all items parsed and we provide the description and the committee to a LLM (Open AI). The LLM will use these information to assess if the procedure is related to **sustainability** or not.\\n\\n#### How to setup?\\n\\n- **Open AI Node**:\\n   1. Add the required credentials Open AI credentials and select the model *(Example: Open AI 4o-mini)*\\n   2. Adapt the system prompt with the topic you want to filter out or keep.\\n  [Learn more about the AI Agent Node](https://docs.n8n.io/integrations/builtin/cluster-nodes/root-nodes/n8n-nodes-langchain.agent)\\n\"},\"typeVersion\":1},{\"id\":\"bfdc9844-7d9c-4582-83bb-9e945276864e\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[2140,20],\"parameters\":{\"color\":7,\"width\":500,\"height\":660,\"content\":\"### 3. Topics related to sustainability are stored in a Google Sheet\\nThe output of the LLM is combined with the other fields. A IF node filters out all the procedure not related to sustainability. The remaining items are loaded in a Google Sheet.\\n\\n#### How to setup?\\n\\n- **Record outputs in the Google Sheet Node**:\\n   1. Add your Google Sheet API credentials to access the Google Sheet file\\n   2. Select the file using the list, an URL or an ID\\n   3. Select the sheet in which you want to record your working sessions\\n   4. Map the fields: **Reference Number**. **Committee**, **Rapporteur**, **Title/Description**, **PDF Link**\\n  [Learn more about the Google Sheet Node](https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.googlesheets)\\n\"},\"typeVersion\":1},{\"id\":\"38a6d477-0a95-4177-a5d4-10f4c97bcf0c\",\"name\":\"Google Tasks\",\"type\":\"n8n-nodes-base.googleTasks\",\"position\":[2400,940],\"parameters\":{\"task\":\"MTIxODU0NDk4MzM3NzAxMTQ0NzY6MDow\",\"title\":\"=Study {{ $json['Reference Number'] }} - EU Legislation\",\"additionalFields\":{\"notes\":\"=Title: {{ $json['Title/Description'] }}\\nReference Number: {{ $json['Reference Number'] }}\\nCommittee: {{ $json.Committee }}\\nRapporteur: {{ $json.Rapporteur }}\\nPDF Link: {{ $json['PDF Link\\t'] }}\\nDate: {{ $json.Date }}\",\"status\":\"needsAction\"}},\"typeVersion\":1},{\"id\":\"9d27672c-2434-46d3-ae52-e0ba07b3a181\",\"name\":\"Sticky Note3\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[2140,700],\"parameters\":{\"color\":7,\"width\":500,\"height\":440,\"content\":\"### 4. Create Sustainability Study Task\\nCreate a Google Task for each EU legislative file related to sustainability, scheduled for tomorrow at 09:00 AM.\\n#### How to setup?\\n\\n- **Add a task in Google Task**:\\n   1. Add your Google Task API credentials to access your task list\\n   2. Change the Task List name\\n  [Learn more about the Google Task Node](https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.googletasks)\\n\"},\"typeVersion\":1},{\"id\":\"8196fd1c-3223-402b-935b-a6a135795999\",\"name\":\"When clicking ‘Test workflow’\",\"type\":\"n8n-nodes-base.manualTrigger\",\"position\":[60,500],\"parameters\":{},\"typeVersion\":1},{\"id\":\"ff6f948b-9db4-479d-afab-3db6176abad6\",\"name\":\"Classification Agent\",\"type\":\"@n8n/n8n-nodes-langchain.openAi\",\"position\":[1380,280],\"parameters\":{\"modelId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"gpt-4-turbo\",\"cachedResultName\":\"GPT-4-TURBO\"},\"options\":{},\"messages\":{\"values\":[{\"content\":\"=Is the following legislative document related to sustainability? Answer \\\"yes\\\" or \\\"no\\\".\\n\\nTitle: {{ $json['Title/Description'] }}\\nCommittee: {{ $json[\\\"Committee\\\"] }}\\n\\nBe strict: Only answer \\\"yes\\\" if the topic directly impacts environmental or climate sustainability, circular economy, resource conservation, or pollution reduction.\\n\"},{\"role\":\"system\",\"content\":\"Sample output:\\n{\\\"answer\\\": \\\"yes\\\"}\\n\"}]},\"jsonOutput\":true},\"typeVersion\":1.8},{\"id\":\"01379394-a5e9-4673-bc0e-225e2d3f5214\",\"name\":\"Collect Answer\",\"type\":\"n8n-nodes-base.set\",\"position\":[1760,280],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"19b1ea4c-3c78-4473-9f16-17d37b273735\",\"name\":\"sustainability\",\"type\":\"string\",\"value\":\"={{ $json.message.content.answer }}\"}]}},\"notesInFlow\":true,\"typeVersion\":3.4},{\"id\":\"8f96dfd0-0a38-435c-83a0-7649b350f813\",\"name\":\"Record Sustainability Procedures\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[2420,380],\"parameters\":{\"columns\":{\"value\":{\"Date\":\"={{ $json.Date }}\",\"PDF Link\":\"={{ $json['PDF Link\\t'] }}\",\"Committee\":\"={{ $json.Committee }}\",\"Rapporteur\":\"={{ $json.Rapporteur }}\",\"Reference Number\":\"={{ $json['Reference Number'] }}\",\"Title/Description\":\"={{ $json['Title/Description'] }}\"},\"schema\":[{\"id\":\"Reference Number\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"Reference Number\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Committee\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"Committee\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Rapporteur\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"Rapporteur\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Title/Description\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"Title/Description\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"PDF Link\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"PDF Link\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Date\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"Date\",\"defaultMatch\":false,\"canBeUsedToMatch\":true}],\"mappingMode\":\"defineBelow\",\"matchingColumns\":[],\"attemptToConvertTypes\":false,\"convertFieldsToString\":false},\"options\":{},\"operation\":\"append\",\"sheetName\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"gid=0\",\"cachedResultUrl\":\"=\",\"cachedResultName\":\"EU Legislative Procedure\"},\"documentId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"=\",\"cachedResultUrl\":\"=\",\"cachedResultName\":\"Sustainability Content\"}},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"rnPYZIig8l6seOd5\",\"name\":\"Google Sheets Temporary\"}},\"notesInFlow\":true,\"typeVersion\":4.5},{\"id\":\"c2cf974e-f182-48f8-9d26-8aea4dbdf486\",\"name\":\"Edit Links\",\"type\":\"n8n-nodes-base.set\",\"position\":[940,500],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"7a802593-2b9b-42fe-bd0c-66e11510834a\",\"name\":\"PDF Link\\t\",\"type\":\"string\",\"value\":\"=https://oeil.secure.europarl.europa.eu{{ $json['PDF Link\\t'] }}\"}]},\"includeOtherFields\":true},\"notesInFlow\":true,\"typeVersion\":3.4},{\"id\":\"bdc398f0-a882-4fbe-ac37-7ca7e15a1081\",\"name\":\"Sticky Note4\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[2660,20],\"parameters\":{\"width\":460,\"height\":340,\"content\":\"![Tutorial](https://www.samirsaci.com/content/images/2025/04/temp-9.png)\\n[🎥 Check My Tutorial](https://www.youtube.com/watch?v=f_nyArpH6kk)\"},\"typeVersion\":1}],\"pinData\":{},\"connections\":{\"If\":{\"main\":[[{\"node\":\"Record Sustainability Procedures\",\"type\":\"main\",\"index\":0},{\"node\":\"Google Tasks\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Loop Over Items\",\"type\":\"main\",\"index\":0}]]},\"Merge\":{\"main\":[[{\"node\":\"If\",\"type\":\"main\",\"index\":0}]]},\"Edit Links\":{\"main\":[[{\"node\":\"Loop Over Items\",\"type\":\"main\",\"index\":0}]]},\"Google Tasks\":{\"main\":[[{\"node\":\"Loop Over Items\",\"type\":\"main\",\"index\":0}]]},\"Parse Blocks\":{\"main\":[[{\"node\":\"Edit Links\",\"type\":\"main\",\"index\":0}]]},\"Collect Answer\":{\"main\":[[{\"node\":\"Merge\",\"type\":\"main\",\"index\":1}]]},\"Loop Over Items\":{\"main\":[[],[{\"node\":\"Classification Agent\",\"type\":\"main\",\"index\":0},{\"node\":\"Merge\",\"type\":\"main\",\"index\":0}]]},\"Extract HTML Blocks\":{\"main\":[[{\"node\":\"Parse Blocks\",\"type\":\"main\",\"index\":0}]]},\"Classification Agent\":{\"main\":[[{\"node\":\"Collect Answer\",\"type\":\"main\",\"index\":0}]]},\"Extract Yesterday Records\":{\"main\":[[{\"node\":\"Extract HTML Blocks\",\"type\":\"main\",\"index\":0}]]},\"When clicking ‘Test workflow’\":{\"main\":[[{\"node\":\"Extract Yesterday Records\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "_Tags: EU Legislation, Sustainability, Automation, Web Scraping, OpenAI, Google Sheets, Policy Monitoring, Climate_\n\n### Context\n\nHey! I’m Samir, a Supply Chain Engineer and Data Scientist from Paris, and the founder of [LogiGreen Consulting](https://logi-green.com).\n\nWe use **AI, automation, and data** to support sustainable business practices for small, medium and large companies.\n\nThis workflow is part of our broader initiative to **monitor and act on sustainability legislation** in Europe.\n\n![Legislative Observatory](https://www.samirsaci.com/content/images/2025/04/image-10.png)\n\n> How do you know if new EU laws will impact your business's sustainability goals?\n\nThis n8n workflow automatically scrapes the EU Parliament’s legislative portal to find and flag procedures related to **environmental sustainability**.\n\n📬 For business inquiries, feel free to connect with me on [LinkedIn](https://www.linkedin.com/in/samir-saci)\n\n### Who is this template for?\n\nThis workflow is useful for:\n\n  * **Sustainability consultants** monitoring legal frameworks\n  * **NGOs and researchers** tracking environmental regulations\n  * **Companies** aligning with **CSRD** or **EU Green Deal** objectives\n  * **Policy analysts** looking for automation tools\n\n\n\n### What does it do?\n\nThis n8n workflow:\n\n  1. 🌐 Scrapes the **EU Parliament legislative portal** for yesterday’s entries\n  2. 🧠 Uses **OpenAI** to classify if each procedure is related to **sustainability**\n  3. 🗂️ Filters out irrelevant items\n  4. 📊 Saves the results in a **Google Sheet**\n  5. ✅ Creates a **Google Task** for each relevant file to review the legislation\n\n\n\n### How it works\n\n![EU Legislation Workflow](https://www.samirsaci.com/content/images/size/w1000/2025/04/image-8.png)\n\n  1. **Trigger manually or on schedule**\n  2. **Scrape HTML blocks** for scheduled debates\n  3. **Parse each procedure** to extract Title, Committee, Rapporteur, PDF link\n  4. **Call GPT-4-turbo** to check if the topic matches sustainability criteria\n  5. **Filter responses** based on “yes” or “no”\n  6. **Store valid items** into Google Sheets\n  7. **Generate tasks** in Google Tasks\n\n\n\nThe AI only flags procedures that **directly impact the environment, circular economy, or pollution control**.\n\n### What do I need to get started?\n\nYou’ll need:\n\n  * A **Google Sheet** connected to your n8n instance\n  * An **OpenAI account** with GPT-4 access\n  * A **Google Task List**\n\n\n\n### Follow the Guide!\n\nFollow the sticky notes in the workflow or **check my tutorial** to configure each node and start using AI to monitor sustainability regulations in Europe.\n\n![YouTube Tutorial](https://www.samirsaci.com/content/images/2025/04/temp-9.png)\n\n🎥 [Watch My Tutorial](https://www.youtube.com/watch?v=f_nyArpH6kk)\n\n### Notes\n\n  * AI filters are strict — you can customise the system prompt to match your needs\n  * This is ideal for tracking **legislative risk** for **climate regulations**\n\n\n\n_This workflow was built using n8n version 1.85.4_  \n_Submitted: April 21, 2025_\n",
  "readme_html": "<!--[--><div data-v-006f9244=\"\"><p><em>Tags: EU Legislation, Sustainability, Automation, Web Scraping, OpenAI, Google Sheets, Policy Monitoring, Climate</em></p>\n<h3>Context</h3>\n<p>Hey! I’m Samir, a Supply Chain Engineer and Data Scientist from Paris, and the founder of <a href=\"https://logi-green.com\" rel=\"ugc nofollow\" target=\"_blank\">LogiGreen Consulting</a>.</p>\n<p>We use <strong>AI, automation, and data</strong> to support sustainable business practices for small, medium and large companies.</p>\n<p>This workflow is part of our broader initiative to <strong>monitor and act on sustainability legislation</strong> in Europe.</p>\n<p><img src=\"https://www.samirsaci.com/content/images/2025/04/image-10.png\" alt=\"Legislative Observatory\"></p>\n<blockquote>\n<p>How do you know if new EU laws will impact your business's sustainability goals?</p>\n</blockquote>\n<p>This n8n workflow automatically scrapes the EU Parliament’s legislative portal to find and flag procedures related to <strong>environmental sustainability</strong>.</p>\n<p>📬 For business inquiries, feel free to connect with me on <a href=\"https://www.linkedin.com/in/samir-saci\" rel=\"ugc nofollow\" target=\"_blank\">LinkedIn</a></p>\n<h3>Who is this template for?</h3>\n<p>This workflow is useful for:</p>\n<ul>\n<li><strong>Sustainability consultants</strong> monitoring legal frameworks</li>\n<li><strong>NGOs and researchers</strong> tracking environmental regulations</li>\n<li><strong>Companies</strong> aligning with <strong>CSRD</strong> or <strong>EU Green Deal</strong> objectives</li>\n<li><strong>Policy analysts</strong> looking for automation tools</li>\n</ul>\n<h3>What does it do?</h3>\n<p>This n8n workflow:</p>\n<ol>\n<li>🌐 Scrapes the <strong>EU Parliament legislative portal</strong> for yesterday’s entries</li>\n<li>🧠 Uses <strong>OpenAI</strong> to classify if each procedure is related to <strong>sustainability</strong></li>\n<li>🗂️ Filters out irrelevant items</li>\n<li>📊 Saves the results in a <strong>Google Sheet</strong></li>\n<li>✅ Creates a <strong>Google Task</strong> for each relevant file to review the legislation</li>\n</ol>\n<h3>How it works</h3>\n<p><img src=\"https://www.samirsaci.com/content/images/size/w1000/2025/04/image-8.png\" alt=\"EU Legislation Workflow\"></p>\n<ol>\n<li><strong>Trigger manually or on schedule</strong></li>\n<li><strong>Scrape HTML blocks</strong> for scheduled debates</li>\n<li><strong>Parse each procedure</strong> to extract Title, Committee, Rapporteur, PDF link</li>\n<li><strong>Call GPT-4-turbo</strong> to check if the topic matches sustainability criteria</li>\n<li><strong>Filter responses</strong> based on “yes” or “no”</li>\n<li><strong>Store valid items</strong> into Google Sheets</li>\n<li><strong>Generate tasks</strong> in Google Tasks</li>\n</ol>\n<p>The AI only flags procedures that <strong>directly impact the environment, circular economy, or pollution control</strong>.</p>\n<h3>What do I need to get started?</h3>\n<p>You’ll need:</p>\n<ul>\n<li>A <strong>Google Sheet</strong> connected to your n8n instance</li>\n<li>An <strong>OpenAI account</strong> with GPT-4 access</li>\n<li>A <strong>Google Task List</strong></li>\n</ul>\n<h3>Follow the Guide!</h3>\n<p>Follow the sticky notes in the workflow or <strong>check my tutorial</strong> to configure each node and start using AI to monitor sustainability regulations in Europe.</p>\n<p><img src=\"https://www.samirsaci.com/content/images/2025/04/temp-9.png\" alt=\"YouTube Tutorial\"></p>\n<p>🎥 <a href=\"https://www.youtube.com/watch?v=f_nyArpH6kk\" rel=\"ugc nofollow\" target=\"_blank\">Watch My Tutorial</a></p>\n<h3>Notes</h3>\n<ul>\n<li>AI filters are strict — you can customise the system prompt to match your needs</li>\n<li>This is ideal for tracking <strong>legislative risk</strong> for <strong>climate regulations</strong></li>\n</ul>\n<p><em>This workflow was built using n8n version 1.85.4</em><br>\n<em>Submitted: April 21, 2025</em></p>\n</div><!--]-->",
  "readme_zh": "_标签：欧盟法规、可持续发展、自动化、网络爬虫、OpenAI、谷歌表格、政策监测、气候_\n\n### 背景介绍\n\n大家好！我是萨米尔，一名来自巴黎的供应链工程师和数据科学家，也是[LogiGreen咨询公司](https://logi-green.com)的创始人。\n\n我们运用**人工智能、自动化和数据技术**，为各类规模的企业提供可持续商业实践支持。\n\n本工作流是我们**监测并响应欧洲可持续发展法规**整体计划的一部分。\n\n![立法观察站](https://www.samirsaci.com/content/images/2025/04/image-10.png)\n\n> 如何判断新出台的欧盟法律是否会影响企业的可持续发展目标？\n\n这个n8n工作流能自动抓取欧盟议会立法门户网站，识别并标记与**环境可持续性**相关的立法程序。\n\n📬 商务合作请通过[领英](https://www.linkedin.com/in/samir-saci)联系我\n\n### 适用对象\n\n本工作流特别适合：\n\n  * 监测法律框架的**可持续发展顾问**\n  * 追踪环保法规的**非政府组织及研究人员**\n  * 需要符合**CSRD**（企业可持续发展报告指令）或**欧盟绿色新政**目标的企业\n  * 寻求自动化工具的**政策分析师**",
  "title_zh": "🌳 欧盟绿色法规追踪器：基于GPT-4o、谷歌表格与任务管理",
  "publish_date_zh": "上次更新于4天前",
  "workflow_json_zh": "{\"meta\": {\"instanceId\": \"=\"}, \"nodes\": [{\"id\": \"4dfef9cb-d66a-4818-b5b2-6be81f0bd7c3\", \"name\": \"遍历项目\", \"type\": \"n8n-nodes-base.splitInBatches\", \"position\": [1160, 500], \"parameters\": {\"options\": {}}, \"typeVersion\": 3}, {\"id\": \"3fd73086-62cc-49c4-9c56-b2467a27601c\", \"name\": \"合并\", \"type\": \"n8n-nodes-base.merge\", \"position\": [1980, 360], \"parameters\": {\"mode\": \"通过SQL合并\"}, \"notesInFlow\": true, \"typeVersion\": 3}, {\"id\": \"a894cc7b-7e2c-40af-bbdd-de03c9fdf71c\", \"name\": \"如果\", \"type\": \"n8n-nodes-base.if\", \"position\": [2200, 440], \"parameters\": {\"options\": {}, \"conditions\": {\"options\": {\"version\": 2, \"leftValue\": \"\", \"caseSensitive\": true, \"typeValidation\": \"strict\"}, \"combinator\": \"and\", \"conditions\": [{\"id\": \"e3956615-6ad2-4df7-a15f-63f1f21d10fe\", \"operator\": {\"name\": \"filter.operator.equals\", \"type\": \"string\", \"operation\": \"equals\"}, \"leftValue\": \"={{ $json.sustainability }}\", \"rightValue\": \"yes\"}]}}, \"typeVersion\": 2.2}, {\"id\": \"b1b1616c-68f7-4911-b58d-8792ac4e822c\", \"name\": \"提取昨日记录\", \"type\": \"n8n-nodes-base.httpRequest\", \"position\": [280, 500], \"parameters\": {\"url\": \"https://oeil.secure.europarl.europa.eu/oeil/zh/search?sessionDay.allDays=false&sessionDay.day={{$now.minus(18,'days').format('yyyyMMdd')}}&sessionDay.type=ALL\", \"options\": {}}, \"notesInFlow\": true, \"typeVersion\": 4.2}, {\"id\": \"707ae04c-51d3-4547-9868-1c603d359cc0\", \"name\": \"便利贴1\", \"type\": \"n8n-nodes-base.stickyNote\", \"position\": [0, 0], \"parameters\": {\"color\": 7, \"width\": 1080, \"height\": 660, \"content\": \"### 1. 第一模块：抓取页面以提取昨日安排辩论的所有立法程序  \\n此工作流通过分块发送HTTP请求来收集页面的HTML内容。针对每个模块，我们提取以下程序信息：**参考编号**、**委员会**、**报告人**、**标题/描述**、**PDF链接**。  \\n\\n#### 如何设置？  \\n*无需操作*\"}, \"typeVersion\": 1}, {\"id\": \"721a14b6-c860-431e-8475-b877d5a83768\", \"name\": \"提取HTML块\", \"type\": \"n8n-nodes-base.html\", \"position\": [500, 500], \"parameters\": {\"options\": {}, \"operation\": \"提取HTML内容\", \"extractionValues\": {\"values\": [{\"key\": \"Blocks\", \"cssSelector\": \".erpl_document-wrapper\", \"returnArray\": true, \"returnValue\": \"html\"}]}}, \"notesInFlow\": true, \"typeVersion\": 1.2}, {\"id\": \"fe609066-0f08-40b7-b8a8-13acd8338468\", \"name\": \"解析块\", \"type\": \"n8n-nodes-base.html\", \"position\": [720, 500], \"parameters\": {\"options\": {}, \"operation\": \"提取HTML内容\", \"dataPropertyName\": \"积木\", \"extractionValues\": {\"values\": [{\"key\": \"Reference Number\", \"cssSelector\": \"h3 span.t-item\"}, {\"key\": \"Committee\", \"cssSelector\": \"span.erpl_badge-committee\"}, {\"key\": \"Rapporteur\", \"cssSelector\": \"span.erpl_document-subtitle-author\"}, {\"key\": \"Title/Description\", \"cssSelector\": \"div.erpl_document-body p\"}, {\"key\": \"PDF Link\\t\", \"attribute\": \"href\", \"cssSelector\": \"a.erpl_document-subtitle-pdf\", \"returnValue\": \"attribute\"}, {\"key\": \"Date\", \"cssSelector\": \"div.mt-1 p\"}]}}, \"notesInFlow\": true, \"typeVersion\": 1.2}, {\"id\": \"75770b01-0c98-4077-97d7-3bbc82166372\", \"name\": \"便利贴\", \"type\": \"n8n-nodes-base.stickyNote\", \"position\": [1100, 0], \"parameters\": {\"color\": 7, \"width\": 1020, \"height\": 660, \"content\": \"### 2. 使用大语言模型筛选与可持续发展相关的流程  \\n我们遍历所有解析后的条目，并将流程描述及所属委员会提交给大语言模型（如Open AI）。该模型将基于这些信息判断流程是否与**可持续发展**相关。  \\n\\n#### 如何设置？  \\n\\n- **Open AI节点**：  \\n  1. 添加必要的Open AI凭证并选择模型（例如：Open AI 4o-mini）  \\n  2. 根据需筛选或保留的主题调整系统提示语。  \\n  [详细了解AI代理节点](https://docs.n8n.io/integrations/builtin/cluster-nodes/root-nodes/n8n-nodes-langchain.agent)\"}, \"typeVersion\": 1}, {\"id\": \"bfdc9844-7d9c-4582-83bb-9e945276864e\", \"name\": \"便利贴2\", \"type\": \"n8n-nodes-base.stickyNote\", \"position\": [2140, 20], \"parameters\": {\"color\": 7, \"width\": 500, \"height\": 660, \"content\": \"### 3. 与可持续发展相关的主题存储于谷歌表格中  \\nLLM的输出与其他字段合并后，通过IF节点筛选掉所有不涉及可持续发展的流程。剩余条目将被载入谷歌表格。  \\n\\n#### 如何设置？  \\n\\n- **在谷歌表格节点中记录输出**：  \\n  1. 添加谷歌表格API凭证以访问文件  \\n  2. 通过列表、URL或ID选择目标文件  \\n  3. 选择用于记录工作会话的工作表  \\n  4. 映射字段：**参考编号**、**委员会**、**报告人**、**标题/描述**、**PDF链接**  \\n  [了解更多谷歌表格节点信息](https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.googlesheets)\"}, \"typeVersion\": 1}, {\"id\": \"38a6d477-0a95-4177-a5d4-10f4c97bcf0c\", \"name\": \"谷歌任务\", \"type\": \"n8n-nodes-base.googleTasks\", \"position\": [2400, 940], \"parameters\": {\"task\": \"MTIxODU0NDk4MzM3NzAxMTQ0NzY6MDow\", \"title\": \"=研究{{ $json['参考编号'] }} - 欧盟法规\", \"additionalFields\": {\"notes\": \"=Title: {{ $json['Title/Description'] }}\\nReference Number: {{ $json['Reference Number'] }}\\nCommittee: {{ $json.Committee }}\\nRapporteur: {{ $json.Rapporteur }}\\nPDF Link: {{ $json['PDF Link\\t'] }}\\nDate: {{ $json.Date }}\", \"status\": \"needsAction\"}}, \"typeVersion\": 1}, {\"id\": \"9d27672c-2434-46d3-ae52-e0ba07b3a181\", \"name\": \"便利贴3\", \"type\": \"n8n-nodes-base.stickyNote\", \"position\": [2140, 700], \"parameters\": {\"color\": 7, \"width\": 500, \"height\": 440, \"content\": \"### 4. 创建可持续性研究任务  \\n为每项与可持续性相关的欧盟立法文件创建一个Google任务，设定时间为明天上午09:00。  \\n#### 如何设置？  \\n\\n- **在Google任务中添加任务**：  \\n  1. 添加您的Google Task API凭证以访问任务列表  \\n  2. 更改任务列表名称  \\n  [了解更多关于Google Task节点的信息](https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.googletasks)\"}, \"typeVersion\": 1}, {\"id\": \"8196fd1c-3223-402b-935b-a6a135795999\", \"name\": \"点击“测试工作流程”时\", \"type\": \"n8n-nodes-base.manualTrigger\", \"position\": [60, 500], \"parameters\": {}, \"typeVersion\": 1}, {\"id\": \"ff6f948b-9db4-479d-afab-3db6176abad6\", \"name\": \"分类代理\", \"type\": \"@n8n/n8n-nodes-langchain.openAi\", \"position\": [1380, 280], \"parameters\": {\"modelId\": {\"__rl\": true, \"mode\": \"list\", \"value\": \"gpt-4-turbo\", \"cachedResultName\": \"GPT-4-TURBO\"}, \"options\": {}, \"messages\": {\"values\": [{\"content\": \"=Is the following legislative document related to sustainability? Answer \\\"yes\\\" or \\\"no\\\".\\n\\nTitle: {{ $json['Title/Description'] }}\\nCommittee: {{ $json[\\\"Committee\\\"] }}\\n\\nBe strict: Only answer \\\"yes\\\" if the topic directly impacts environmental or climate sustainability, circular economy, resource conservation, or pollution reduction.\\n\"}, {\"role\": \"system\", \"content\": \"Sample output:\\n{\\\"answer\\\": \\\"yes\\\"}\\n\"}]}, \"jsonOutput\": true}, \"typeVersion\": 1.8}, {\"id\": \"01379394-a5e9-4673-bc0e-225e2d3f5214\", \"name\": \"收集答案\", \"type\": \"n8n-nodes-base.set\", \"position\": [1760, 280], \"parameters\": {\"options\": {}, \"assignments\": {\"assignments\": [{\"id\": \"19b1ea4c-3c78-4473-9f16-17d37b273735\", \"name\": \"sustainability\", \"type\": \"string\", \"value\": \"={{ $json.message.content.answer }}\"}]}}, \"notesInFlow\": true, \"typeVersion\": 3.4}, {\"id\": \"8f96dfd0-0a38-435c-83a0-7649b350f813\", \"name\": \"记录可持续发展程序\", \"type\": \"n8n-nodes-base.googleSheets\", \"position\": [2420, 380], \"parameters\": {\"columns\": {\"value\": {\"Date\": \"={{ $json.Date }}\", \"PDF Link\": \"={{ $json['PDF Link\\t'] }}\", \"Committee\": \"={{ $json.Committee }}\", \"Rapporteur\": \"={{ $json.Rapporteur }}\", \"Reference Number\": \"={{ $json['Reference Number'] }}\", \"Title/Description\": \"={{ $json['Title/Description'] }}\"}, \"schema\": [{\"id\": \"Reference Number\", \"type\": \"string\", \"display\": true, \"required\": false, \"displayName\": \"Reference Number\", \"defaultMatch\": false, \"canBeUsedToMatch\": true}, {\"id\": \"Committee\", \"type\": \"string\", \"display\": true, \"required\": false, \"displayName\": \"Committee\", \"defaultMatch\": false, \"canBeUsedToMatch\": true}, {\"id\": \"Rapporteur\", \"type\": \"string\", \"display\": true, \"required\": false, \"displayName\": \"Rapporteur\", \"defaultMatch\": false, \"canBeUsedToMatch\": true}, {\"id\": \"Title/Description\", \"type\": \"string\", \"display\": true, \"required\": false, \"displayName\": \"Title/Description\", \"defaultMatch\": false, \"canBeUsedToMatch\": true}, {\"id\": \"PDF Link\", \"type\": \"string\", \"display\": true, \"required\": false, \"displayName\": \"PDF Link\", \"defaultMatch\": false, \"canBeUsedToMatch\": true}, {\"id\": \"Date\", \"type\": \"string\", \"display\": true, \"required\": false, \"displayName\": \"Date\", \"defaultMatch\": false, \"canBeUsedToMatch\": true}], \"mappingMode\": \"defineBelow\", \"matchingColumns\": [], \"attemptToConvertTypes\": false, \"convertFieldsToString\": false}, \"options\": {}, \"operation\": \"附加\", \"sheetName\": {\"__rl\": true, \"mode\": \"list\", \"value\": \"gid=0\", \"cachedResultUrl\": \"=\", \"cachedResultName\": \"EU Legislative Procedure\"}, \"documentId\": {\"__rl\": true, \"mode\": \"list\", \"value\": \"=\", \"cachedResultUrl\": \"=\", \"cachedResultName\": \"Sustainability Content\"}}, \"credentials\": {\"googleSheetsOAuth2Api\": {\"id\": \"rnPYZIig8l6seOd5\", \"name\": \"Google Sheets Temporary\"}}, \"notesInFlow\": true, \"typeVersion\": 4.5}, {\"id\": \"c2cf974e-f182-48f8-9d26-8aea4dbdf486\", \"name\": \"编辑链接\", \"type\": \"n8n-nodes-base.set\", \"position\": [940, 500], \"parameters\": {\"options\": {}, \"assignments\": {\"assignments\": [{\"id\": \"7a802593-2b9b-42fe-bd0c-66e11510834a\", \"name\": \"PDF Link\\t\", \"type\": \"string\", \"value\": \"=https://oeil.secure.europarl.europa.eu{{ $json['PDF Link\\t'] }}\"}]}, \"includeOtherFields\": true}, \"notesInFlow\": true, \"typeVersion\": 3.4}, {\"id\": \"bdc398f0-a882-4fbe-ac37-7ca7e15a1081\", \"name\": \"便利贴4\", \"type\": \"n8n-nodes-base.stickyNote\", \"position\": [2660, 20], \"parameters\": {\"width\": 460, \"height\": 340, \"content\": \"![教程](https://www.samirsaci.com/content/images/2025/04/temp-9.png)\\n[🎥 观看我的教程](https://www.youtube.com/watch?v=f_nyArpH6kk)\"}, \"typeVersion\": 1}], \"pinData\": {}, \"connections\": {\"If\": {\"main\": [[{\"node\": \"Record Sustainability Procedures\", \"type\": \"main\", \"index\": 0}, {\"node\": \"Google Tasks\", \"type\": \"main\", \"index\": 0}], [{\"node\": \"Loop Over Items\", \"type\": \"main\", \"index\": 0}]]}, \"Merge\": {\"main\": [[{\"node\": \"If\", \"type\": \"main\", \"index\": 0}]]}, \"Edit Links\": {\"main\": [[{\"node\": \"Loop Over Items\", \"type\": \"main\", \"index\": 0}]]}, \"Google Tasks\": {\"main\": [[{\"node\": \"Loop Over Items\", \"type\": \"main\", \"index\": 0}]]}, \"Parse Blocks\": {\"main\": [[{\"node\": \"Edit Links\", \"type\": \"main\", \"index\": 0}]]}, \"Collect Answer\": {\"main\": [[{\"node\": \"Merge\", \"type\": \"main\", \"index\": 1}]]}, \"Loop Over Items\": {\"main\": [[], [{\"node\": \"Classification Agent\", \"type\": \"main\", \"index\": 0}, {\"node\": \"Merge\", \"type\": \"main\", \"index\": 0}]]}, \"Extract HTML Blocks\": {\"main\": [[{\"node\": \"Parse Blocks\", \"type\": \"main\", \"index\": 0}]]}, \"Classification Agent\": {\"main\": [[{\"node\": \"Collect Answer\", \"type\": \"main\", \"index\": 0}]]}, \"Extract Yesterday Records\": {\"main\": [[{\"node\": \"Extract HTML Blocks\", \"type\": \"main\", \"index\": 0}]]}, \"When clicking ‘Test workflow’\": {\"main\": [[{\"node\": \"Extract Yesterday Records\", \"type\": \"main\", \"index\": 0}]]}}}"
}