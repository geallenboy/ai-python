{
  "title": "Supabase Insertion & Upsertion & Retrieval",
  "url": "https://n8n.io/workflows/2395-supabase-insertion-and-upsertion-and-retrieval/",
  "category": "AI",
  "category_url": "https://n8n.io/workflows/categories/ai/?count=20",
  "author": "Ria",
  "publish_date": "Last update 7 months ago",
  "content": "",
  "workflow_json": "{\"meta\":{\"instanceId\":\"1a23006df50de49624f69e85993be557d137b6efe723a867a7d68a84e0b32704\"},\"nodes\":[{\"id\":\"54065cc9-047c-4741-95f6-cec3e352abd7\",\"name\":\"Google Drive\",\"type\":\"n8n-nodes-base.googleDrive\",\"position\":[2700,-1840],\"parameters\":{\"fileId\":{\"__rl\":true,\"mode\":\"url\",\"value\":\"https://drive.google.com/file/d/xxxxxxxxxxxxxxx/view\"},\"options\":{},\"operation\":\"download\"},\"typeVersion\":3},{\"id\":\"62af57f5-a001-4174-bece-260a1fc595e8\",\"name\":\"Default Data Loader\",\"type\":\"@n8n/n8n-nodes-langchain.documentDefaultDataLoader\",\"position\":[3120,-1620],\"parameters\":{\"loader\":\"epubLoader\",\"options\":{},\"dataType\":\"binary\"},\"typeVersion\":1},{\"id\":\"ce3d9c7c-6ce9-421a-b4d0-4235217cf8e6\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[2620,-2000],\"parameters\":{\"width\":749.1276349295781,\"height\":820.5109034066329,\"content\":\"# INSERTING\\n\\n- it's important to use the same embedding model when for any interaction with your vector database (inserting, upserting and retrieval)\"},\"typeVersion\":1},{\"id\":\"81cb3d3e-70af-46c8-bc18-3d076a222d0b\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1720,-1160],\"parameters\":{\"color\":3,\"width\":873.9739981925188,\"height\":534.0012007720542,\"content\":\"# UPSERTING\\n\"},\"typeVersion\":1},{\"id\":\"60ebdb71-c7e0-429b-9394-b680cc000951\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1720,-2000],\"parameters\":{\"color\":4,\"width\":876.5116990000852,\"height\":821.787041589866,\"content\":\"# PREPARATION (in Supabase)\\n\\n- your database needs the extension 'pgvector' enabled -> select Database > Extension > Search for 'vector'\\n- make sure you have a table that has the following columns (if not, use the query below in the Supabase SQL Editor)\\n\\n```\\nALTER TABLE \\\"YOUR TABLE NAME\\\"\\nADD COLUMN embedding VECTOR(1536), // check which number of dimensions you need (depends on the embed model)\\nADD COLUMN metadata JSONB,\\nADD COLUMN content TEXT;\\n```\\n\\n- make sure you have the right policies set -> select Authentication > Policies\\n- make sure you have the custom function `match_documents` set up in Supabase -> This is needed for the Vector Store Node (as query name) \\n(if not, use the query below in the Supabase SQL Editor to create that function)\\n- make sure you check the size of the AI model as it should be the same vector size for the table \\n(e.g. OpenAI's Text-Embedding-3-Small uses 1536)\\n\\n```\\nCREATE OR REPLACE FUNCTION public.match_documents(\\n  filter JSONB,\\n  match_count INT,\\n  query_embedding VECTOR(1536) // should match same dimensions as from insertion\\n)\\nRETURNS TABLE (\\n  id BIGINT,\\n  content TEXT,\\n  metadata JSONB,\\n  embedding VECTOR(1536), // should match same dimensions as from insertion\\n  similarity FLOAT\\n)\\nLANGUAGE plpgsql AS $$\\nBEGIN\\n  RETURN QUERY\\n  SELECT\\n    v.id,\\n    v.content,\\n    v.metadata,\\n    v.embedding,\\n    1 - (v.embedding <=> match_documents.query_embedding) AS similarity\\n  FROM \\\"YOUR TABLE NAME\\\" v\\n  WHERE v.metadata @> filter\\n  ORDER BY v.embedding <=> match_documents.query_embedding\\n  LIMIT match_count;\\nEND;\\n$$\\n;\\n```\\n\"},\"typeVersion\":1},{\"id\":\"ae95b0c3-b8b3-44eb-8070-b1bc6cac5cd2\",\"name\":\"Sticky Note3\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[3400,-2000],\"parameters\":{\"color\":5,\"width\":810.9488123113013,\"height\":821.9537074055816,\"content\":\"# RETRIEVAL\"},\"typeVersion\":1},{\"id\":\"58168721-cbd7-498c-9d16-41b4d5c6a68f\",\"name\":\"Question and Answer Chain\",\"type\":\"@n8n/n8n-nodes-langchain.chainRetrievalQa\",\"position\":[3680,-1860],\"parameters\":{},\"typeVersion\":1.3},{\"id\":\"ddf1228f-f051-445b-8a42-54c2510a0b2e\",\"name\":\"OpenAI Chat Model\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\"position\":[3600,-1680],\"parameters\":{\"options\":{}},\"typeVersion\":1},{\"id\":\"734a2c48-b445-4e62-99b7-dc1dcd921c52\",\"name\":\"Vector Store Retriever\",\"type\":\"@n8n/n8n-nodes-langchain.retrieverVectorStore\",\"position\":[3760,-1680],\"parameters\":{\"topK\":10},\"typeVersion\":1},{\"id\":\"43f761b7-f4da-4b29-8099-9b2c15f79fe9\",\"name\":\"Recursive Character Text Splitter1\",\"type\":\"@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter\",\"position\":[3120,-1460],\"parameters\":{\"options\":{}},\"typeVersion\":1},{\"id\":\"de0d2666-88e4-4a4d-ba46-cf789b9cba85\",\"name\":\"Customize Response\",\"type\":\"n8n-nodes-base.set\",\"notes\":\"output || text\",\"position\":[4020,-1860],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"440fc115-ccae-4e30-85a5-501d0617b2cf\",\"name\":\"output\",\"type\":\"string\",\"value\":\"={{ $json.response.text }}\"}]}},\"notesInFlow\":true,\"typeVersion\":3.4},{\"id\":\"a396671f-a217-4f05-b969-cb64f10e4b01\",\"name\":\"When chat message received\",\"type\":\"@n8n/n8n-nodes-langchain.chatTrigger\",\"position\":[3480,-1860],\"webhookId\":\"d7431c58-89aa-4d70-b5bd-044be981b3a9\",\"parameters\":{\"public\":true,\"options\":{\"responseMode\":\"lastNode\"},\"initialMessages\":\"=Hi there! ğŸ™\\n\\nYou can ask me anything about Venerable Geshe Kelsang Gyatso's Book - 'How To Transform Your Life'\\n\\nWhat would you like to know? \"},\"typeVersion\":1.1},{\"id\":\"6312f6bc-c69c-4d4f-8838-8a9d0d22ed55\",\"name\":\"Retrieve by Query\",\"type\":\"@n8n/n8n-nodes-langchain.vectorStoreSupabase\",\"position\":[3700,-1520],\"parameters\":{\"options\":{\"queryName\":\"match_documents\"},\"tableName\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"Kadampa\",\"cachedResultName\":\"Kadampa\"}},\"typeVersion\":1},{\"id\":\"ba6b87b9-e96d-47a3-83f8-169d7172325a\",\"name\":\"Embeddings OpenAI Retrieval\",\"type\":\"@n8n/n8n-nodes-langchain.embeddingsOpenAi\",\"position\":[3700,-1360],\"parameters\":{\"options\":{}},\"typeVersion\":1},{\"id\":\"bcd1b31f-c60b-4c40-b039-d47dadc86b23\",\"name\":\"Embeddings OpenAI Insertion\",\"type\":\"@n8n/n8n-nodes-langchain.embeddingsOpenAi\",\"position\":[2920,-1620],\"parameters\":{\"model\":\"text-embedding-3-small\",\"options\":{}},\"typeVersion\":1},{\"id\":\"dfd7f734-eb00-4af3-9179-724503422fe4\",\"name\":\"Placeholder (File/Content to Upsert)\",\"type\":\"n8n-nodes-base.set\",\"position\":[1900,-1000],\"parameters\":{\"mode\":\"raw\",\"options\":{},\"jsonOutput\":\"={\\n  \\\"Date\\\": \\\"{{ $now.format('dd MMM yyyy') }}\\\",\\n  \\\"Time\\\": \\\"{{ $now.format('HH:mm ZZZZ z') }}\\\"\\n}\\n\"},\"typeVersion\":3.4},{\"id\":\"c54c9458-9b8a-4ef1-a6db-5265729be19d\",\"name\":\"Embeddings OpenAI Upserting\",\"type\":\"@n8n/n8n-nodes-langchain.embeddingsOpenAi\",\"position\":[2120,-840],\"parameters\":{\"model\":\"text-embedding-3-small\",\"options\":{}},\"typeVersion\":1},{\"id\":\"30c18e9e-d047-40d3-8324-f5d0e7892db6\",\"name\":\"Insert Documents\",\"type\":\"@n8n/n8n-nodes-langchain.vectorStoreSupabase\",\"position\":[2920,-1840],\"parameters\":{\"mode\":\"insert\",\"options\":{},\"tableName\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"Kadampa\",\"cachedResultName\":\"Kadampa\"}},\"typeVersion\":1},{\"id\":\"3c0ed0ee-9134-4b4e-bcfd-632dd67a57da\",\"name\":\"Retrieve Rows from Table\",\"type\":\"n8n-nodes-base.supabase\",\"position\":[3960,-1380],\"parameters\":{\"tableId\":\"n8n\",\"operation\":\"getAll\",\"returnAll\":true},\"typeVersion\":1},{\"id\":\"53aca1b4-31e8-4699-b158-673623bc9b95\",\"name\":\"Sticky Note4\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[2620,-1160],\"parameters\":{\"color\":6,\"width\":1587.0771183771394,\"height\":537.3056597675153,\"content\":\"# DELETION\\n\\nAt the moment n8n does not have a built-in Supabase Node to delete records in a Vector Database. For this you would typically use the HTTP Request node to make an authorized API call to Supabase. \\n\\n## HTTP Request Node\\n\\nUse this node to send a DELETE request to your Supabase instance.\\n\\n- Supabase API Endpoint: Use the appropriate URL for your Supabase project. The endpoint will typically look like this: [https://<your-supabase-ref>.supabase.co/rest/v1/<your-vector-table>](https://supabase.com/docs/guides/api). Replace `<your-supabase-ref>` and `<your-vector-table>` with your details.\\n### HEADERS:\\n- apikey: Your Supabase API key.\\n- Authorization: Bearer token with your Supabase JWT.\\n- Query Parameters: Use query parameters to specify which record(s) to delete. For example, `?id=eq.<your-record-id>` where `<your-record-id>` is the specific record ID you want to delete \\n(You can also reference back to the **Retrieve Rows From Table** Node to get the ID dynamically)\\n\\nEnsure you have the necessary permissions set up in Supabase to delete records through the API.\\n\\nPlease refer to the official n8n documentation for more detailed information on using the [HTTP Request Node](https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.httprequest/).\\n\\n_Note:_ Deleting records is a sensitive operation, so make sure that your permissions are correctly configured and that you are targeting the correct records to avoid unwanted data loss.\"},\"typeVersion\":1},{\"id\":\"4ffaccdb-9e0f-464d-9284-7771f6599fd8\",\"name\":\"Update Documents\",\"type\":\"@n8n/n8n-nodes-langchain.vectorStoreSupabase\",\"position\":[2100,-1000],\"parameters\":{\"id\":\"1\",\"mode\":\"update\",\"options\":{\"queryName\":\"match_documents\"},\"tableName\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"n8n\",\"cachedResultName\":\"n8n\"}},\"typeVersion\":1}],\"pinData\":{},\"connections\":{\"Google Drive\":{\"main\":[[{\"node\":\"Insert Documents\",\"type\":\"main\",\"index\":0}]]},\"OpenAI Chat Model\":{\"ai_languageModel\":[[{\"node\":\"Question and Answer Chain\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"Retrieve by Query\":{\"ai_vectorStore\":[[{\"node\":\"Vector Store Retriever\",\"type\":\"ai_vectorStore\",\"index\":0}]]},\"Default Data Loader\":{\"ai_document\":[[{\"node\":\"Insert Documents\",\"type\":\"ai_document\",\"index\":0}]]},\"Vector Store Retriever\":{\"ai_retriever\":[[{\"node\":\"Question and Answer Chain\",\"type\":\"ai_retriever\",\"index\":0}]]},\"Question and Answer Chain\":{\"main\":[[{\"node\":\"Customize Response\",\"type\":\"main\",\"index\":0}]]},\"When chat message received\":{\"main\":[[{\"node\":\"Question and Answer Chain\",\"type\":\"main\",\"index\":0}]]},\"Embeddings OpenAI Insertion\":{\"ai_embedding\":[[{\"node\":\"Insert Documents\",\"type\":\"ai_embedding\",\"index\":0}]]},\"Embeddings OpenAI Retrieval\":{\"ai_embedding\":[[{\"node\":\"Retrieve by Query\",\"type\":\"ai_embedding\",\"index\":0}]]},\"Embeddings OpenAI Upserting\":{\"ai_embedding\":[[{\"node\":\"Update Documents\",\"type\":\"ai_embedding\",\"index\":0}]]},\"Recursive Character Text Splitter1\":{\"ai_textSplitter\":[[{\"node\":\"Default Data Loader\",\"type\":\"ai_textSplitter\",\"index\":0}]]},\"Placeholder (File/Content to Upsert)\":{\"main\":[[{\"node\":\"Update Documents\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "This is a demo workflow to showcase how to use Supabase to embed a document, retrieve information from the vector store via chat and update the database.\n\n## Setup steps:\n\n  * set your credentials for Supabase\n  * set your credentials for an AI model of your choice\n  * set credentials for any service you want to use to upload documents\n  * please follow the guidelines in the workflow itself (Sticky Notes)\n\n\n\n## Feedback & Questions\n\nIf you have any questions or feedback about this workflow - Feel free to get in touch at [ria@n8n.io](mailto:ria@n8n.io)\n",
  "readme_html": "<!--[--><div data-v-006f9244=\"\"><p>This is a demo workflow to showcase how to use Supabase to embed a document, retrieve information from the vector store via chat and update the database.</p>\n<h2>Setup steps:</h2>\n<ul>\n<li>set your credentials for Supabase</li>\n<li>set your credentials for an AI model of your choice</li>\n<li>set credentials for any service you want to use to upload documents</li>\n<li>please follow the guidelines in the workflow itself (Sticky Notes)</li>\n</ul>\n<h2>Feedback &amp; Questions</h2>\n<p>If you have any questions or feedback about this workflow - Feel free to get in touch at <a href=\"mailto:ria@n8n.io\" rel=\"ugc nofollow\">ria@n8n.io</a></p>\n</div><!--]-->",
  "readme_zh": "è¿™æ˜¯ä¸€ä¸ªæ¼”ç¤ºå·¥ä½œæµï¼Œå±•ç¤ºå¦‚ä½•åˆ©ç”¨Supabaseå®ç°æ–‡æ¡£åµŒå…¥ã€é€šè¿‡èŠå¤©ä»å‘é‡å­˜å‚¨æ£€ç´¢ä¿¡æ¯ä»¥åŠæ›´æ–°æ•°æ®åº“ã€‚\n\n## è®¾ç½®æ­¥éª¤ï¼š\n\n  * é…ç½®æ‚¨çš„Supabaseå‡­è¯\n  * ä¸ºæ‚¨é€‰æ‹©çš„AIæ¨¡å‹è®¾ç½®å‡­è¯\n  * ä¸ºæ–‡æ¡£ä¸Šä¼ æœåŠ¡é…ç½®å‡­è¯\n  * è¯·éµå¾ªå·¥ä½œæµå†…çš„æ“ä½œæŒ‡å—ï¼ˆå‚è§ä¾¿åˆ©è´´æ³¨é‡Šï¼‰\n\n## åé¦ˆä¸ç–‘é—®\n\nè‹¥å¯¹è¯¥å·¥ä½œæµæœ‰ä»»ä½•ç–‘é—®æˆ–å»ºè®®ï¼Œæ¬¢è¿é€šè¿‡é‚®ä»¶è”ç³» [ria@n8n.io](mailto:ria@n8n.io)",
  "title_zh": "Supabase æ’å…¥ã€æ›´æ–°æ’å…¥ä¸æ£€ç´¢",
  "publish_date_absolute": "2024-10-06",
  "publish_date_zh": "æœ€åæ›´æ–°äº7ä¸ªæœˆå‰",
  "workflow_json_zh": "{\n  \"meta\": {\n    \"instanceId\": \"1a23006df50de49624f69e85993be557d137b6efe723a867a7d68a84e0b32704\"\n  },\n  \"nodes\": [\n    {\n      \"id\": \"54065cc9-047c-4741-95f6-cec3e352abd7\",\n      \"name\": \"Google Drive\",\n      \"type\": \"n8n-nodes-base.googleDrive\",\n      \"position\": [\n        2700,\n        -1840\n      ],\n      \"parameters\": {\n        \"fileId\": {\n          \"__rl\": true,\n          \"mode\": \"url\",\n          \"value\": \"https://drive.google.com/file/d/xxxxxxxxxxxxxxx/view\"\n        },\n        \"options\": {},\n        \"operation\": \"download\"\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"62af57f5-a001-4174-bece-260a1fc595e8\",\n      \"name\": \"Default Data Loader\",\n      \"type\": \"@n8n/n8n-nodes-langchain.documentDefaultDataLoader\",\n      \"position\": [\n        3120,\n        -1620\n      ],\n      \"parameters\": {\n        \"loader\": \"epubLoader\",\n        \"options\": {},\n        \"dataType\": \"binary\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"ce3d9c7c-6ce9-421a-b4d0-4235217cf8e6\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        2620,\n        -2000\n      ],\n      \"parameters\": {\n        \"width\": 749.1276349295781,\n        \"height\": 820.5109034066329,\n        \"content\": \"# æ’å…¥æ“ä½œ\\n\\n- åœ¨ä¸å‘é‡æ•°æ®åº“è¿›è¡Œä»»ä½•äº¤äº’æ—¶ï¼ˆæ’å…¥ã€æ›´æ–°æˆ–æ£€ç´¢ï¼‰ï¼Œä½¿ç”¨ç›¸åŒçš„åµŒå…¥æ¨¡å‹è‡³å…³é‡è¦\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"81cb3d3e-70af-46c8-bc18-3d076a222d0b\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1720,\n        -1160\n      ],\n      \"parameters\": {\n        \"color\": 3,\n        \"width\": 873.9739981925188,\n        \"height\": 534.0012007720542,\n        \"content\": \"# æ›´æ–°æ’å…¥\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"60ebdb71-c7e0-429b-9394-b680cc000951\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1720,\n        -2000\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 876.5116990000852,\n        \"height\": 821.787041589866,\n        \"content\": \"# Supabaseå‡†å¤‡å·¥ä½œ\\n\\n- éœ€å¯ç”¨æ•°æ®åº“çš„'pgvector'æ‰©å±• -> è¿›å…¥Database > Extension > æœç´¢'vector'\\n- ç¡®ä¿æ‚¨çš„è¡¨åŒ…å«ä»¥ä¸‹åˆ—ï¼ˆè‹¥æ— ï¼Œè¯·åœ¨Supabase SQLç¼–è¾‘å™¨ä¸­æ‰§è¡Œä¸‹æ–¹æŸ¥è¯¢ï¼‰\\n\\n```\\nALTER TABLE \\\"æ‚¨çš„è¡¨å\\\"\\nADD COLUMN embedding VECTOR(1536), // è¯·ç¡®è®¤æ‰€éœ€ç»´åº¦æ•°ï¼ˆå–å†³äºåµŒå…¥æ¨¡å‹ï¼‰\\nADD COLUMN metadata JSONB,\\nADD COLUMN content TEXT;\\n```\\n\\n- ç¡®ä¿å·²è®¾ç½®æ­£ç¡®çš„è®¿é—®ç­–ç•¥ -> è¿›å…¥Authentication > Policies\\n- ç¡®ä¿å·²åœ¨Supabaseä¸­è®¾ç½®è‡ªå®šä¹‰å‡½æ•°`match_documents` -> Vector StoreèŠ‚ç‚¹éœ€ä½¿ç”¨æ­¤æŸ¥è¯¢åç§°\\nï¼ˆè‹¥æ— ï¼Œè¯·åœ¨Supabase SQLç¼–è¾‘å™¨ä¸­æ‰§è¡Œä¸‹æ–¹æŸ¥è¯¢åˆ›å»ºè¯¥å‡½æ•°ï¼‰\\n- æ³¨æ„AIæ¨¡å‹çš„å‘é‡ç»´åº¦éœ€ä¸è¡¨ç»“æ„ä¸€è‡´\\nï¼ˆä¾‹å¦‚OpenAIçš„Text-Embedding-3-Smallä½¿ç”¨1536ç»´ï¼‰\\n\\n```\\nCREATE OR REPLACE FUNCTION public.match_documents(\\n  filter JSONB,\\n  match_count INT,\\n  query_embedding VECTOR(1536) // éœ€ä¸æ’å…¥æ—¶çš„ç»´åº¦ä¿æŒä¸€è‡´\\n)\\nRETURNS TABLE (\\n  id BIGINT,\\n  content TEXT,\\n  metadata JSONB,\\n  embedding VECTOR(1536), // éœ€ä¸æ’å…¥æ—¶çš„ç»´åº¦ä¿æŒä¸€è‡´\\n  similarity FLOAT\\n)\\nLANGUAGE plpgsql AS $$\\nBEGIN\\n  RETURN QUERY\\n  SELECT\\n    v.id,\\n    v.content,\\n    v.metadata,\\n    v.embedding,\\n    1 - (v.embedding <=> match_documents.query_embedding) AS similarity\\n  FROM \\\"æ‚¨çš„è¡¨å\\\" v\\n  WHERE v.metadata @> filter\\n  ORDER BY v.embedding <=> match_documents.query_embedding\\n  LIMIT match_count;\\nEND;\\n$$\\n;\\n```\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"ae95b0c3-b8b3-44eb-8070-b1bc6cac5cd2\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        3400,\n        -2000\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 810.9488123113013,\n        \"height\": 821.9537074055816,\n        \"content\": \"# æ£€ç´¢\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"58168721-cbd7-498c-9d16-41b4d5c6a68f\",\n      \"name\": \"Question and Answer Chain\",\n      \"type\": \"@n8n/n8n-nodes-langchain.chainRetrievalQa\",\n      \"position\": [\n        3680,\n        -1860\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1.3\n    },\n    {\n      \"id\": \"ddf1228f-f051-445b-8a42-54c2510a0b2e\",\n      \"name\": \"OpenAI Chat Model\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\n      \"position\": [\n        3600,\n        -1680\n      ],\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"734a2c48-b445-4e62-99b7-dc1dcd921c52\",\n      \"name\": \"Vector Store Retriever\",\n      \"type\": \"@n8n/n8n-nodes-langchain.retrieverVectorStore\",\n      \"position\": [\n        3760,\n        -1680\n      ],\n      \"parameters\": {\n        \"topK\": 10\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"43f761b7-f4da-4b29-8099-9b2c15f79fe9\",\n      \"name\": \"Recursive Character Text Splitter1\",\n      \"type\": \"@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter\",\n      \"position\": [\n        3120,\n        -1460\n      ],\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"de0d2666-88e4-4a4d-ba46-cf789b9cba85\",\n      \"name\": \"Customize Response\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"notes\": \"output || text\",\n      \"position\": [\n        4020,\n        -1860\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"440fc115-ccae-4e30-85a5-501d0617b2cf\",\n              \"name\": \"output\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.response.text }}\"\n            }\n          ]\n        }\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"a396671f-a217-4f05-b969-cb64f10e4b01\",\n      \"name\": \"When chat message received\",\n      \"type\": \"@n8n/n8n-nodes-langchain.chatTrigger\",\n      \"position\": [\n        3480,\n        -1860\n      ],\n      \"webhookId\": \"d7431c58-89aa-4d70-b5bd-044be981b3a9\",\n      \"parameters\": {\n        \"public\": true,\n        \"options\": {\n          \"responseMode\": \"lastNode\"\n        },\n        \"initialMessages\": \"=Hi there! ğŸ™\\n\\nYou can ask me anything about Venerable Geshe Kelsang Gyatso's Book - 'How To Transform Your Life'\\n\\nWhat would you like to know? \"\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"6312f6bc-c69c-4d4f-8838-8a9d0d22ed55\",\n      \"name\": \"Retrieve by Query\",\n      \"type\": \"@n8n/n8n-nodes-langchain.vectorStoreSupabase\",\n      \"position\": [\n        3700,\n        -1520\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"queryName\": \"match_documents\"\n        },\n        \"tableName\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"Kadampa\",\n          \"cachedResultName\": \"Kadampa\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"ba6b87b9-e96d-47a3-83f8-169d7172325a\",\n      \"name\": \"Embeddings OpenAI Retrieval\",\n      \"type\": \"@n8n/n8n-nodes-langchain.embeddingsOpenAi\",\n      \"position\": [\n        3700,\n        -1360\n      ],\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"bcd1b31f-c60b-4c40-b039-d47dadc86b23\",\n      \"name\": \"Embeddings OpenAI Insertion\",\n      \"type\": \"@n8n/n8n-nodes-langchain.embeddingsOpenAi\",\n      \"position\": [\n        2920,\n        -1620\n      ],\n      \"parameters\": {\n        \"model\": \"text-embedding-3-small\",\n        \"options\": {}\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"dfd7f734-eb00-4af3-9179-724503422fe4\",\n      \"name\": \"Placeholder (File/Content to Upsert)\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1900,\n        -1000\n      ],\n      \"parameters\": {\n        \"mode\": \"raw\",\n        \"options\": {},\n        \"jsonOutput\": \"={\\n  \\\"Date\\\": \\\"{{ $now.format('dd MMM yyyy') }}\\\",\\n  \\\"Time\\\": \\\"{{ $now.format('HH:mm ZZZZ z') }}\\\"\\n}\\n\"\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"c54c9458-9b8a-4ef1-a6db-5265729be19d\",\n      \"name\": \"Embeddings OpenAI Upserting\",\n      \"type\": \"@n8n/n8n-nodes-langchain.embeddingsOpenAi\",\n      \"position\": [\n        2120,\n        -840\n      ],\n      \"parameters\": {\n        \"model\": \"text-embedding-3-small\",\n        \"options\": {}\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"30c18e9e-d047-40d3-8324-f5d0e7892db6\",\n      \"name\": \"Insert Documents\",\n      \"type\": \"@n8n/n8n-nodes-langchain.vectorStoreSupabase\",\n      \"position\": [\n        2920,\n        -1840\n      ],\n      \"parameters\": {\n        \"mode\": \"insert\",\n        \"options\": {},\n        \"tableName\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"Kadampa\",\n          \"cachedResultName\": \"Kadampa\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"3c0ed0ee-9134-4b4e-bcfd-632dd67a57da\",\n      \"name\": \"Retrieve Rows from Table\",\n      \"type\": \"n8n-nodes-base.supabase\",\n      \"position\": [\n        3960,\n        -1380\n      ],\n      \"parameters\": {\n        \"tableId\": \"n8n\",\n        \"operation\": \"getAll\",\n        \"returnAll\": true\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"53aca1b4-31e8-4699-b158-673623bc9b95\",\n      \"name\": \"Sticky Note4\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        2620,\n        -1160\n      ],\n      \"parameters\": {\n        \"color\": 6,\n        \"width\": 1587.0771183771394,\n        \"height\": 537.3056597675153,\n        \"content\": \"# åˆ é™¤æ“ä½œ\\n\\nç›®å‰n8nå°šæœªå†…ç½®SupabaseèŠ‚ç‚¹æ¥åˆ é™¤å‘é‡æ•°æ®åº“ä¸­çš„è®°å½•ã€‚é€šå¸¸æ‚¨éœ€è¦ä½¿ç”¨HTTPè¯·æ±‚èŠ‚ç‚¹å‘Supabaseå‘èµ·æˆæƒAPIè°ƒç”¨ã€‚\\n\\n## HTTPè¯·æ±‚èŠ‚ç‚¹\\n\\nä½¿ç”¨è¯¥èŠ‚ç‚¹å‘æ‚¨çš„Supabaseå®ä¾‹å‘é€DELETEè¯·æ±‚ã€‚\\n\\n- Supabase APIç«¯ç‚¹ï¼šä½¿ç”¨æ‚¨Supabaseé¡¹ç›®çš„å¯¹åº”URLã€‚ç«¯ç‚¹é€šå¸¸å½¢å¦‚ï¼š[https://<æ‚¨çš„supabase-ref>.supabase.co/rest/v1/<æ‚¨çš„å‘é‡è¡¨>](https://supabase.com/docs/guides/api)ã€‚è¯·å°†`<your-supabase-ref>`å’Œ`<your-vector-table>`æ›¿æ¢ä¸ºæ‚¨çš„å®é™…ä¿¡æ¯ã€‚\\n\\n### è¯·æ±‚å¤´ï¼š\\n- apikeyï¼šæ‚¨çš„Supabase APIå¯†é’¥\\n- Authorizationï¼šæºå¸¦Supabase JWTçš„Bearerä»¤ç‰Œ\\n- æŸ¥è¯¢å‚æ•°ï¼šé€šè¿‡æŸ¥è¯¢å‚æ•°æŒ‡å®šè¦åˆ é™¤çš„è®°å½•ã€‚ä¾‹å¦‚`?id=eq.<è®°å½•ID>`ï¼Œå…¶ä¸­`<è®°å½•ID>`æ˜¯æ‚¨è¦åˆ é™¤çš„ç‰¹å®šè®°å½•ID\\nï¼ˆæ‚¨ä¹Ÿå¯ä»¥å›æº¯å¼•ç”¨**ä»è¡¨ä¸­æ£€ç´¢è¡Œ**èŠ‚ç‚¹æ¥åŠ¨æ€è·å–IDï¼‰\\n\\nè¯·ç¡®ä¿å·²åœ¨Supabaseä¸­é…ç½®é€šè¿‡APIåˆ é™¤è®°å½•çš„å¿…è¦æƒé™ã€‚\\n\\næ›´å¤šå…³äº[HTTPè¯·æ±‚èŠ‚ç‚¹](https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.httprequest/)çš„ä½¿ç”¨ç»†èŠ‚ï¼Œè¯·å‚é˜…n8nå®˜æ–¹æ–‡æ¡£ã€‚\\n\\n_æ³¨æ„ï¼š_ åˆ é™¤è®°å½•å±äºæ•æ„Ÿæ“ä½œï¼Œè¯·åŠ¡å¿…æ­£ç¡®é…ç½®æƒé™å¹¶ç¡®è®¤ç›®æ ‡è®°å½•ï¼Œé¿å…æ„å¤–æ•°æ®ä¸¢å¤±ã€‚\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"4ffaccdb-9e0f-464d-9284-7771f6599fd8\",\n      \"name\": \"Update Documents\",\n      \"type\": \"@n8n/n8n-nodes-langchain.vectorStoreSupabase\",\n      \"position\": [\n        2100,\n        -1000\n      ],\n      \"parameters\": {\n        \"id\": \"1\",\n        \"mode\": \"update\",\n        \"options\": {\n          \"queryName\": \"match_documents\"\n        },\n        \"tableName\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"n8n\",\n          \"cachedResultName\": \"n8n\"\n        }\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"pinData\": {},\n  \"connections\": {\n    \"Google Drive\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Insert Documents\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"OpenAI Chat Model\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"Question and Answer Chain\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Retrieve by Query\": {\n      \"ai_vectorStore\": [\n        [\n          {\n            \"node\": \"Vector Store Retriever\",\n            \"type\": \"ai_vectorStore\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Default Data Loader\": {\n      \"ai_document\": [\n        [\n          {\n            \"node\": \"Insert Documents\",\n            \"type\": \"ai_document\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Vector Store Retriever\": {\n      \"ai_retriever\": [\n        [\n          {\n            \"node\": \"Question and Answer Chain\",\n            \"type\": \"ai_retriever\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Question and Answer Chain\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Customize Response\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"When chat message received\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Question and Answer Chain\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Embeddings OpenAI Insertion\": {\n      \"ai_embedding\": [\n        [\n          {\n            \"node\": \"Insert Documents\",\n            \"type\": \"ai_embedding\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Embeddings OpenAI Retrieval\": {\n      \"ai_embedding\": [\n        [\n          {\n            \"node\": \"Retrieve by Query\",\n            \"type\": \"ai_embedding\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Embeddings OpenAI Upserting\": {\n      \"ai_embedding\": [\n        [\n          {\n            \"node\": \"Update Documents\",\n            \"type\": \"ai_embedding\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Recursive Character Text Splitter1\": {\n      \"ai_textSplitter\": [\n        [\n          {\n            \"node\": \"Default Data Loader\",\n            \"type\": \"ai_textSplitter\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Placeholder (File/Content to Upsert)\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Update Documents\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}