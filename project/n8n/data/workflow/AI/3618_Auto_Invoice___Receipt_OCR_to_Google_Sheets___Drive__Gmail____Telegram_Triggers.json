{
  "title": "Auto Invoice & Receipt OCR to Google Sheets – Drive, Gmail, & Telegram Triggers",
  "url": "https://n8n.io/workflows/3618-auto-invoice-and-receipt-ocr-to-google-sheets-drive-gmail-and-telegram-triggers/",
  "category": "AI",
  "category_url": "https://n8n.io/workflows/categories/ai/",
  "author": "Daniel Ng",
  "publish_date": "Last update 4 days ago",
  "content": "",
  "workflow_json": "{\"id\":\"qClJP4aIscQySnQK\",\"meta\":{\"instanceId\":\"b3df22d2875c82e3ba1883c50049ed9cee0bcabf99d2b486961d2245a09e3964\",\"templateCredsSetupCompleted\":true},\"name\":\"(Tung) OCR invoice extract to spreadsheet copy\",\"tags\":[],\"nodes\":[{\"id\":\"ceb8fcc7-c733-4842-8988-2f19695658e4\",\"name\":\"Prompt\",\"type\":\"n8n-nodes-base.set\",\"position\":[2320,-1340],\"parameters\":{},\"typeVersion\":3.4},{\"id\":\"7bba23a4-9ff4-4c0f-9702-6de444b8701e\",\"name\":\"Move file to base64 string\",\"type\":\"n8n-nodes-base.extractFromFile\",\"position\":[2020,-1340],\"parameters\":{},\"typeVersion\":1},{\"id\":\"df138485-9a6a-4d3e-a1ca-1c9568b5e76f\",\"name\":\"Gemini API\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[2620,-1340],\"parameters\":{},\"typeVersion\":4.2},{\"id\":\"e104546f-cf93-43c4-b5b4-5c66b046a72e\",\"name\":\"JSON to string\",\"type\":\"n8n-nodes-base.set\",\"position\":[2900,-1220],\"parameters\":{},\"typeVersion\":3.4},{\"id\":\"182783f8-5285-4506-aa7b-d6f1fdbf5492\",\"name\":\"Parse string\",\"type\":\"n8n-nodes-base.code\",\"position\":[3200,-1220],\"parameters\":{},\"typeVersion\":2},{\"id\":\"ca6d6fc1-8fce-48da-9de5-2395ff4ee3e8\",\"name\":\"Add to Google Sheets\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[3500,-1220],\"parameters\":{},\"typeVersion\":4.5},{\"id\":\"5b512370-b6e8-4cb7-b4d3-333ba15ac666\",\"name\":\"Google Drive Get Receipt\",\"type\":\"n8n-nodes-base.googleDrive\",\"position\":[1720,-1340],\"parameters\":{},\"typeVersion\":3},{\"id\":\"76c34c54-8666-4b3d-bb3f-ae79a6847cde\",\"name\":\"Telegram Trigger Image\",\"type\":\"n8n-nodes-base.telegramTrigger\",\"position\":[1060,-60],\"webhookId\":\"ef2f6b1f-b608-4e2f-9abe-02fe8ae0f085\",\"parameters\":{},\"typeVersion\":1.2},{\"id\":\"9e8e821f-b6f7-4014-937e-9fe734c0e9c9\",\"name\":\"Gmail Trigger\",\"type\":\"n8n-nodes-base.gmailTrigger\",\"position\":[1060,-720],\"parameters\":{},\"typeVersion\":1.2},{\"id\":\"d3a929a9-441f-4896-9a98-d32f374c8a83\",\"name\":\"Split Out Binary Files\",\"type\":\"n8n-nodes-base.code\",\"position\":[1940,-480],\"parameters\":{},\"typeVersion\":2},{\"id\":\"db81d68b-d937-47bd-adfc-215bd4797754\",\"name\":\"Loop Over Attachments\",\"type\":\"n8n-nodes-base.splitInBatches\",\"position\":[2100,-740],\"parameters\":{},\"typeVersion\":3},{\"id\":\"2cbb56fc-eb6a-4f61-8204-bcde99c164c4\",\"name\":\"If\",\"type\":\"n8n-nodes-base.if\",\"position\":[1640,-620],\"parameters\":{},\"typeVersion\":2.2},{\"id\":\"97c167d3-db62-48ae-b9ab-4add617e1258\",\"name\":\"Loop Over Emails\",\"type\":\"n8n-nodes-base.splitInBatches\",\"position\":[1400,-720],\"parameters\":{},\"typeVersion\":3},{\"id\":\"c4c4193a-983b-4f46-9d61-03ecff3157be\",\"name\":\"Wait For Saving\",\"type\":\"n8n-nodes-base.wait\",\"position\":[3020,-720],\"webhookId\":\"a6742af7-28b5-469a-92d6-3f74845692fd\",\"parameters\":{},\"typeVersion\":1.1},{\"id\":\"df28230d-7d7d-4817-8aba-615a9a266ad5\",\"name\":\"Loop Over Items\",\"type\":\"n8n-nodes-base.splitInBatches\",\"position\":[1400,-1360],\"parameters\":{},\"typeVersion\":3},{\"id\":\"f3ee46f7-b3a8-4dfd-8b1f-da92613d5fe9\",\"name\":\"Create File Name\",\"type\":\"n8n-nodes-base.code\",\"position\":[2420,-720],\"parameters\":{},\"typeVersion\":2},{\"id\":\"d7bde712-ece9-4613-9771-379f99a2300d\",\"name\":\"Create File Name For Telegram\",\"type\":\"n8n-nodes-base.code\",\"position\":[1400,-60],\"parameters\":{},\"typeVersion\":2},{\"id\":\"f564d3b2-9be8-4119-9cc2-b4a61809af9f\",\"name\":\"Google Drive Trigger New Files\",\"type\":\"n8n-nodes-base.googleDriveTrigger\",\"position\":[1060,-1360],\"parameters\":{},\"typeVersion\":1},{\"id\":\"3f4adb77-2ab4-4e7f-b9d4-4b030aaf1f68\",\"name\":\"Sticky Note3\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1280,-800],\"parameters\":{\"content\":\"\"},\"typeVersion\":1},{\"id\":\"8a9de5a7-0314-49d0-b87f-513bbb5e9531\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1280,-140],\"parameters\":{\"content\":\"\"},\"typeVersion\":1},{\"id\":\"7b9dc2de-464d-4c76-9ec0-44717bf29753\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1280,-1460],\"parameters\":{\"content\":\"\"},\"typeVersion\":1},{\"id\":\"56c7a141-3265-4528-9f5c-ad3326bcf84e\",\"name\":\"Google Save Files 2\",\"type\":\"n8n-nodes-base.googleDrive\",\"position\":[1740,-60],\"parameters\":{},\"typeVersion\":3},{\"id\":\"e7b8fa1b-9510-450d-a35e-4a0338efa9f0\",\"name\":\"Google Drive Save Files\",\"type\":\"n8n-nodes-base.googleDrive\",\"position\":[2720,-720],\"parameters\":{},\"typeVersion\":3},{\"id\":\"95dc537f-75c1-47dc-b929-838b63f97e25\",\"name\":\"Wait For Saving Data\",\"type\":\"n8n-nodes-base.wait\",\"position\":[3820,-1220],\"webhookId\":\"211ca61f-1915-4fb7-9ebf-8304c75d536e\",\"parameters\":{},\"typeVersion\":1.1},{\"id\":\"d40ea975-5a33-485c-9811-7444181209ca\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[20,-1480],\"parameters\":{\"content\":\"\"},\"typeVersion\":1}],\"active\":true,\"pinData\":{},\"settings\":{\"errorWorkflow\":\"7XxwbKvr4yHpGpKg\",\"executionOrder\":\"v1\"},\"versionId\":\"a6b663dd-a23e-4e18-abb8-65c23310056a\",\"connections\":{\"If\":{\"main\":[[{\"node\":\"Split Out Binary Files\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Loop Over Emails\",\"type\":\"main\",\"index\":0}]]},\"Prompt\":{\"main\":[[{\"node\":\"Gemini API\",\"type\":\"main\",\"index\":0}]]},\"Gemini API\":{\"main\":[[{\"node\":\"JSON to string\",\"type\":\"main\",\"index\":0}]]},\"Parse string\":{\"main\":[[{\"node\":\"Add to Google Sheets\",\"type\":\"main\",\"index\":0}]]},\"Gmail Trigger\":{\"main\":[[{\"node\":\"Loop Over Emails\",\"type\":\"main\",\"index\":0}]]},\"JSON to string\":{\"main\":[[{\"node\":\"Parse string\",\"type\":\"main\",\"index\":0}]]},\"Loop Over Items\":{\"main\":[[],[{\"node\":\"Google Drive Get Receipt\",\"type\":\"main\",\"index\":0}]]},\"Wait For Saving\":{\"main\":[[{\"node\":\"Loop Over Attachments\",\"type\":\"main\",\"index\":0}]]},\"Create File Name\":{\"main\":[[{\"node\":\"Google Drive Save Files\",\"type\":\"main\",\"index\":0}]]},\"Loop Over Emails\":{\"main\":[[{\"node\":\"Loop Over Attachments\",\"type\":\"main\",\"index\":0}],[{\"node\":\"If\",\"type\":\"main\",\"index\":0}]]},\"Add to Google Sheets\":{\"main\":[[{\"node\":\"Wait For Saving Data\",\"type\":\"main\",\"index\":0}]]},\"Wait For Saving Data\":{\"main\":[[{\"node\":\"Loop Over Items\",\"type\":\"main\",\"index\":0}]]},\"Loop Over Attachments\":{\"main\":[[],[{\"node\":\"Create File Name\",\"type\":\"main\",\"index\":0}]]},\"Split Out Binary Files\":{\"main\":[[{\"node\":\"Loop Over Emails\",\"type\":\"main\",\"index\":0}]]},\"Telegram Trigger Image\":{\"main\":[[{\"node\":\"Create File Name For Telegram\",\"type\":\"main\",\"index\":0}]]},\"Google Drive Save Files\":{\"main\":[[{\"node\":\"Wait For Saving\",\"type\":\"main\",\"index\":0}]]},\"Google Drive Get Receipt\":{\"main\":[[{\"node\":\"Move file to base64 string\",\"type\":\"main\",\"index\":0}]]},\"Move file to base64 string\":{\"main\":[[{\"node\":\"Prompt\",\"type\":\"main\",\"index\":0}]]},\"Create File Name For Telegram\":{\"main\":[[{\"node\":\"Google Save Files 2\",\"type\":\"main\",\"index\":0}]]},\"Google Drive Trigger New Files\":{\"main\":[[{\"node\":\"Loop Over Items\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "### **The Best Invoice & Receipt OCR Automation - FREE (for a limited time)**\n\n**Automatically process invoices and receipts** using **Gemini OCR** , extracting data directly into **Google Sheets** from multiple sources including **Google Drive, Gmail** , and **Telegram**. This powerful workflow ensures your bookkeeping is always accurate, organized, and efficient, significantly reducing manual effort and potential errors.\n\n![Automate_invoice_OCR_to_Google_Sheets_Gemini_n8n_workflow_template_screenshot_2.jpeg](https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/Automate_invoice_OCR_to_Google_Sheets_Gemini_n8n_workflow_template_screenshot_2_1361a561f4.jpeg)\n\n### **Who is this for?**\n\nThis workflow is ideal for busy **entrepreneurs, startup founders, freelancers, small business owners, bookkeepers, and accountants** who aim to eliminate manual, repetitive, and error-prone bookkeeping tasks. Whether you regularly manage expenses from physical paper receipts, digital invoices, or email attachments, this workflow will dramatically streamline your bookkeeping processes and save you significant time and effort each month.\n\n### **What problem is this workflow solving?**\n\nManual data entry of invoices and receipts is notoriously tedious, incredibly time-consuming, and highly susceptible to human error. Mistakes in bookkeeping can lead to financial inaccuracies, compliance issues, and wasted resources. By automating the extraction of invoice data, this workflow streamlines your financial management process, significantly improves accuracy, reduces operational overhead, and allows you to redirect valuable resources and attention toward strategic, revenue-generating business activities.\n\n### **What this workflow does**\n\nThis template provides a powerful, automated solution for invoice and receipt data extraction using Google's Gemini API for OCR (Optical Character Recognition) via direct HTTP requests.\n\n  1. **Main Flow (Google Drive Trigger):** The main workflow triggers (_Google Drive Trigger New Files_) whenever a new file (PDF or image) is added to a designated Google Drive folder. It uses a _SplitInBatches node (Loop Over Items)_ to process incoming files one by one. For each file, it: \n     * Downloads the file (_Google Drive Get Receipt_).\n     * Converts it to base64 (_Move file to base64 string_).\n     * Sends the file data and a detailed prompt to the Gemini API (_gemini-2.0-flash_ model specified in the _Prompt_ node, sent via the _Gemini API HTTP Request_ node). The prompt requests structured JSON output with specific fields and formatting (like comma decimal separators, no currency symbols, and a dedicated currency field).\n     * Parses the JSON response (_JSON to string_ , _Parse string_ nodes).\n     * Appends the extracted data (Invoice Date, Category, Sender, Currency, etc.), along with the original filename and a link to the file, to a specified Google Sheet (_Add to Google Sheets_).\n     * Includes _Wait_ nodes to help manage potential rate limits.\n  2. **Supplementary flow 1 (Gmail Trigger):** An additional trigger (_Gmail Trigger_) monitors your Gmail account for emails with a specific label. When a matching email with attachments arrives: \n     * It loops through emails and attachments.\n     * It renames the attachment using the format `YYYY-MM-DD_SenderUsername` (e.g., `2025-04-19_some.sender`) using the _Create File Name_ node.\n     * It saves the renamed attachment to the designated Google Drive folder (_Google Drive Save Files_), which then triggers the core OCR process above.\n  3. **Supplementary Trigger 2 (Telegram Trigger):** Another optional trigger (_Telegram Trigger Image_) allows you to forward photos of physical receipts to your configured Telegram bot: \n     * It renames the image file using the format `YYYY-MM-DD_Telegram` (e.g., `2025-04-19_Telegram`) via the _Create File Name For Telegram_ node.\n     * It saves the renamed image to the designated Google Drive folder (_Google Save Files 2_), also triggering the core OCR process.\n\n\n\n### **Setup**\n\n  1. **Credentials:** Add the following credentials in n8n, using the names specified in the template or your own: \n     * _Google OAuth2_ : For Google Drive, Google Sheets, Gmail.\n     * _Telegram_ : For the Telegram bot trigger\n     * _Gemini API Key_ : Obtain a free API key from [Google AI Studio](https://aistudio.google.com/). You will need to paste this key directly into the Query Parameters of the _Gemini API (HTTP Request)_ node in the workflow.\n  2. **Google Drive:** Create a specific folder in your Google Drive where all invoices/receipts will be stored _and_ processed from. Update the target Folder in the _Google Drive Trigger New Files_ , _Google Drive Save Files_ , and _Google Save Files 2_ nodes to use your designated folder.\n  3. **Google Sheets:** Create a new Google Sheet, or clone [this Sheet template](https://docs.google.com/spreadsheets/d/1HX12aLkBrFjKSvtMlhFbDQkvn8MQrhZQVkkxpXY5c0M/edit?usp=sharing). Ensure it has columns matching the desired output fields (see default list below, including _Currency_). Update the target Spreadsheet and Sheet Name in the _Add to Google Sheets_ node to point to your sheet.\n  4. **Gmail (Optional):** Create a label in Gmail (e.g., `\"receipts\"`). Update the Label filter in the _Gmail Trigger_ node to use the label you created. Consider setting up filters in Gmail to automatically apply this label to relevant emails.\n  5. **Telegram (Optional):** Configure the _Telegram Trigger Image_ node with your bot credentials.\n  6. **Gemini API Node:** Open the _Gemini API (HTTP Request)_ node. In the `\"Query Parameters\"` section, replace the placeholder API key with your actual Gemini API Key. Verify the URL uses the correct model name by referencing the _Prompt_ node's model value (`gemini-2.0-flash` by default).\n  7. **Customize Prompt:** Open the _Prompt (Set)_ node. \n     * Crucially, change the first line `\"My company is Sisu Digital...\"` to reflect your company or remove it if not needed.\n     * Review the list of categories and the specific formatting instructions (e.g., `comma for decimals`, `no currency symbols`, `date format`, `\"N/A\" for notes`) to ensure they match your requirements. You can adjust these details here.\n  8. **Activate Workflow:** Test each trigger path (Drive upload, labeled Gmail, Telegram photo) with sample files/emails/messages, then activate the workflow.\n\n\n\n### **How to customize this workflow to your needs**\n\n  * **Gemini Prompt/Model:** Modify the prompt text, the list of categories, or the detailed formatting instructions within the _Prompt (Set)_ node. You can also change the model value in the _Prompt_ node to use a different Gemini model (ensure the model supports the API endpoint used in the _HTTP Request_ node).\n  * **Extracted Fields:** Modify the prompt in the _Prompt_ node to extract different fields or change formatting. Update the parsing logic in the _Parse string_ node if needed, and ensure your Google Sheet columns match in the _Add to Google Sheets_ node. The default extracted fields (based on the updated prompt) are: \n    * **Invoice Date:** (DD/MM/YYYY)\n    * **Category:** (From predefined list)\n    * **Sender:** (Issuing company)\n    * **Description:** (Brief details)\n    * **Amount (0% VAT):** (Net amount, comma decimal, no currency symbol)\n    * **VAT %:** (Rate number, comma decimal, no % sign, \"0,0\" if none)\n    * **Total:** (Gross amount, comma decimal, no currency symbol)\n    * **Currency:** (Uppercase abbreviation, e.g., \"EUR\", \"USD\")\n    * **Note:** (Relevant notes, or \"N/A\")\n    * _**(Added by workflow):**_ **File Name** , **File URL**\n  * **Triggers & Targets:** Enable/disable or modify the _Gmail_ and _Telegram_ triggers. Select your desired _Google Drive folder_ , _Google Sheet_ , and _Gmail label_ directly within the respective nodes.\n  * **File Naming:** Adjust the Javascript code in the _Create File Name_ (for Gmail) or _Create File Name For Telegram_ nodes to change the renaming pattern. Current formats: `YYYY-MM-DD_SenderUsername` (Gmail), `YYYY-MM-DD_Telegram` (Telegram).\n  * **Configuration Method:** Update configuration like folders, sheets, and labels directly within the relevant nodes. For easier management of multiple settings, consider adding a central `'Set'` node at the beginning of the workflow to define these values and use expressions to reference them in other nodes.\n\n\n\n### **Important Considerations**\n\n  * **AI Accuracy:** AI models can make mistakes. Always review the data extracted into Google Sheets for accuracy, especially with specific formatting like decimal separators. This workflow automates heavily but requires final verification.\n  * **Gemini API Usage:** This template uses the _Gemini API_ via _HTTP Request_. Be mindful of Google's API rate limits, usage policies, and potential costs associated with the model used (`gemini-2.0-flash` by default), especially if you change it. Monitor Google's terms.\n  * **Loops and Waits:** The workflow uses _SplitInBatches_ and _Wait_ nodes to process items individually and pause execution, which helps prevent hitting API rate limits but processes files sequentially rather than in parallel.\n\n\n\n### **Support Disclaimer**\n\n  * This workflow is provided as-is for your convenience. Use it responsibly, and feel free to build upon it for your unique needs!\n  * This workflow has been thoroughly tested and is confirmed to be working flawlessly at the time of release. However, setup complexity or unexpected errors may occur depending on your environment, customizations, or API changes.\n  * Please note that I cannot offer personalized support or troubleshooting for this template (without a fee!). If you encounter an issue, feel free to send me a message describing the problem. If the issue is determined to be a genuine bug within the shared template, I will do my best to fix it and update the workflow. Otherwise, the issue is likely due to a setup misconfiguration or modification on your side. In those cases, I recommend using _ChatGPT_ or referring to _n8n documentation_ to debug the problem.\n\n\n",
  "readme_html": "<!--[--><div data-v-006f9244=\"\"><h3><strong>The Best Invoice &amp; Receipt OCR Automation - FREE (for a limited time)</strong></h3>\n<p><strong>Automatically process invoices and receipts</strong> using <strong>Gemini OCR</strong>, extracting data directly into <strong>Google Sheets</strong> from multiple sources including <strong>Google Drive, Gmail</strong>, and <strong>Telegram</strong>. This powerful workflow ensures your bookkeeping is always accurate, organized, and efficient, significantly reducing manual effort and potential errors.</p>\n<p><img src=\"https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/Automate_invoice_OCR_to_Google_Sheets_Gemini_n8n_workflow_template_screenshot_2_1361a561f4.jpeg\" alt=\"Automate_invoice_OCR_to_Google_Sheets_Gemini_n8n_workflow_template_screenshot_2.jpeg\"></p>\n<h3><strong>Who is this for?</strong></h3>\n<p>This workflow is ideal for busy <strong>entrepreneurs, startup founders, freelancers, small business owners, bookkeepers, and accountants</strong> who aim to eliminate manual, repetitive, and error-prone bookkeeping tasks. Whether you regularly manage expenses from physical paper receipts, digital invoices, or email attachments, this workflow will dramatically streamline your bookkeeping processes and save you significant time and effort each month.</p>\n<h3><strong>What problem is this workflow solving?</strong></h3>\n<p>Manual data entry of invoices and receipts is notoriously tedious, incredibly time-consuming, and highly susceptible to human error. Mistakes in bookkeeping can lead to financial inaccuracies, compliance issues, and wasted resources. By automating the extraction of invoice data, this workflow streamlines your financial management process, significantly improves accuracy, reduces operational overhead, and allows you to redirect valuable resources and attention toward strategic, revenue-generating business activities.</p>\n<h3><strong>What this workflow does</strong></h3>\n<p>This template provides a powerful, automated solution for invoice and receipt data extraction using Google's Gemini API for OCR (Optical Character Recognition) via direct HTTP requests.</p>\n<ol>\n<li><strong>Main Flow (Google Drive Trigger):</strong> The main workflow triggers (<em>Google Drive Trigger New Files</em>) whenever a new file (PDF or image) is added to a designated Google Drive folder. It uses a <em>SplitInBatches node (Loop Over Items)</em> to process incoming files one by one. For each file, it:\n<ul>\n<li>Downloads the file (<em>Google Drive Get Receipt</em>).</li>\n<li>Converts it to base64 (<em>Move file to base64 string</em>).</li>\n<li>Sends the file data and a detailed prompt to the Gemini API (<em>gemini-2.0-flash</em> model specified in the <em>Prompt</em> node, sent via the <em>Gemini API HTTP Request</em> node). The prompt requests structured JSON output with specific fields and formatting (like comma decimal separators, no currency symbols, and a dedicated currency field).</li>\n<li>Parses the JSON response (<em>JSON to string</em>, <em>Parse string</em> nodes).</li>\n<li>Appends the extracted data (Invoice Date, Category, Sender, Currency, etc.), along with the original filename and a link to the file, to a specified Google Sheet (<em>Add to Google Sheets</em>).</li>\n<li>Includes <em>Wait</em> nodes to help manage potential rate limits.</li>\n</ul>\n</li>\n<li><strong>Supplementary flow 1 (Gmail Trigger):</strong> An additional trigger (<em>Gmail Trigger</em>) monitors your Gmail account for emails with a specific label. When a matching email with attachments arrives:\n<ul>\n<li>It loops through emails and attachments.</li>\n<li>It renames the attachment using the format <code>YYYY-MM-DD_SenderUsername</code> (e.g., <code>2025-04-19_some.sender</code>) using the <em>Create File Name</em> node.</li>\n<li>It saves the renamed attachment to the designated Google Drive folder (<em>Google Drive Save Files</em>), which then triggers the core OCR process above.</li>\n</ul>\n</li>\n<li><strong>Supplementary Trigger 2 (Telegram Trigger):</strong> Another optional trigger (<em>Telegram Trigger Image</em>) allows you to forward photos of physical receipts to your configured Telegram bot:\n<ul>\n<li>It renames the image file using the format <code>YYYY-MM-DD_Telegram</code> (e.g., <code>2025-04-19_Telegram</code>) via the <em>Create File Name For Telegram</em> node.</li>\n<li>It saves the renamed image to the designated Google Drive folder (<em>Google Save Files 2</em>), also triggering the core OCR process.</li>\n</ul>\n</li>\n</ol>\n<h3><strong>Setup</strong></h3>\n<ol>\n<li><strong>Credentials:</strong> Add the following credentials in n8n, using the names specified in the template or your own:\n<ul>\n<li><em>Google OAuth2</em>: For Google Drive, Google Sheets, Gmail.</li>\n<li><em>Telegram</em>: For the Telegram bot trigger</li>\n<li><em>Gemini API Key</em>: Obtain a free API key from <a href=\"https://aistudio.google.com/\" rel=\"ugc nofollow\" target=\"_blank\">Google AI Studio</a>. You will need to paste this key directly into the Query Parameters of the <em>Gemini API (HTTP Request)</em> node in the workflow.</li>\n</ul>\n</li>\n<li><strong>Google Drive:</strong> Create a specific folder in your Google Drive where all invoices/receipts will be stored <em>and</em> processed from. Update the target Folder in the <em>Google Drive Trigger New Files</em>, <em>Google Drive Save Files</em>, and <em>Google Save Files 2</em> nodes to use your designated folder.</li>\n<li><strong>Google Sheets:</strong> Create a new Google Sheet, or clone <a href=\"https://docs.google.com/spreadsheets/d/1HX12aLkBrFjKSvtMlhFbDQkvn8MQrhZQVkkxpXY5c0M/edit?usp=sharing\" rel=\"ugc nofollow\" target=\"_blank\">this Sheet template</a>. Ensure it has columns matching the desired output fields (see default list below, including <em>Currency</em>). Update the target Spreadsheet and Sheet Name in the <em>Add to Google Sheets</em> node to point to your sheet.</li>\n<li><strong>Gmail (Optional):</strong> Create a label in Gmail (e.g., <code>\"receipts\"</code>). Update the Label filter in the <em>Gmail Trigger</em> node to use the label you created. Consider setting up filters in Gmail to automatically apply this label to relevant emails.</li>\n<li><strong>Telegram (Optional):</strong> Configure the <em>Telegram Trigger Image</em> node with your bot credentials.</li>\n<li><strong>Gemini API Node:</strong> Open the <em>Gemini API (HTTP Request)</em> node. In the <code>\"Query Parameters\"</code> section, replace the placeholder API key with your actual Gemini API Key. Verify the URL uses the correct model name by referencing the <em>Prompt</em> node's model value (<code>gemini-2.0-flash</code> by default).</li>\n<li><strong>Customize Prompt:</strong> Open the <em>Prompt (Set)</em> node.\n<ul>\n<li>Crucially, change the first line <code>\"My company is Sisu Digital...\"</code> to reflect your company or remove it if not needed.</li>\n<li>Review the list of categories and the specific formatting instructions (e.g., <code>comma for decimals</code>, <code>no currency symbols</code>, <code>date format</code>, <code>\"N/A\" for notes</code>) to ensure they match your requirements. You can adjust these details here.</li>\n</ul>\n</li>\n<li><strong>Activate Workflow:</strong> Test each trigger path (Drive upload, labeled Gmail, Telegram photo) with sample files/emails/messages, then activate the workflow.</li>\n</ol>\n<h3><strong>How to customize this workflow to your needs</strong></h3>\n<ul>\n<li><strong>Gemini Prompt/Model:</strong> Modify the prompt text, the list of categories, or the detailed formatting instructions within the <em>Prompt (Set)</em> node. You can also change the model value in the <em>Prompt</em> node to use a different Gemini model (ensure the model supports the API endpoint used in the <em>HTTP Request</em> node).</li>\n<li><strong>Extracted Fields:</strong> Modify the prompt in the <em>Prompt</em> node to extract different fields or change formatting. Update the parsing logic in the <em>Parse string</em> node if needed, and ensure your Google Sheet columns match in the <em>Add to Google Sheets</em> node. The default extracted fields (based on the updated prompt) are:\n<ul>\n<li><strong>Invoice Date:</strong> (DD/MM/YYYY)</li>\n<li><strong>Category:</strong> (From predefined list)</li>\n<li><strong>Sender:</strong> (Issuing company)</li>\n<li><strong>Description:</strong> (Brief details)</li>\n<li><strong>Amount (0% VAT):</strong> (Net amount, comma decimal, no currency symbol)</li>\n<li><strong>VAT %:</strong> (Rate number, comma decimal, no % sign, \"0,0\" if none)</li>\n<li><strong>Total:</strong> (Gross amount, comma decimal, no currency symbol)</li>\n<li><strong>Currency:</strong> (Uppercase abbreviation, e.g., \"EUR\", \"USD\")</li>\n<li><strong>Note:</strong> (Relevant notes, or \"N/A\")</li>\n<li><em><strong>(Added by workflow):</strong></em> <strong>File Name</strong>, <strong>File URL</strong></li>\n</ul>\n</li>\n<li><strong>Triggers &amp; Targets:</strong> Enable/disable or modify the <em>Gmail</em> and <em>Telegram</em> triggers. Select your desired <em>Google Drive folder</em>, <em>Google Sheet</em>, and <em>Gmail label</em> directly within the respective nodes.</li>\n<li><strong>File Naming:</strong> Adjust the Javascript code in the <em>Create File Name</em> (for Gmail) or <em>Create File Name For Telegram</em> nodes to change the renaming pattern. Current formats: <code>YYYY-MM-DD_SenderUsername</code> (Gmail), <code>YYYY-MM-DD_Telegram</code> (Telegram).</li>\n<li><strong>Configuration Method:</strong> Update configuration like folders, sheets, and labels directly within the relevant nodes. For easier management of multiple settings, consider adding a central <code>'Set'</code> node at the beginning of the workflow to define these values and use expressions to reference them in other nodes.</li>\n</ul>\n<h3><strong>Important Considerations</strong></h3>\n<ul>\n<li><strong>AI Accuracy:</strong> AI models can make mistakes. Always review the data extracted into Google Sheets for accuracy, especially with specific formatting like decimal separators. This workflow automates heavily but requires final verification.</li>\n<li><strong>Gemini API Usage:</strong> This template uses the <em>Gemini API</em> via <em>HTTP Request</em>. Be mindful of Google's API rate limits, usage policies, and potential costs associated with the model used (<code>gemini-2.0-flash</code> by default), especially if you change it. Monitor Google's terms.</li>\n<li><strong>Loops and Waits:</strong> The workflow uses <em>SplitInBatches</em> and <em>Wait</em> nodes to process items individually and pause execution, which helps prevent hitting API rate limits but processes files sequentially rather than in parallel.</li>\n</ul>\n<h3><strong>Support Disclaimer</strong></h3>\n<ul>\n<li>This workflow is provided as-is for your convenience. Use it responsibly, and feel free to build upon it for your unique needs!</li>\n<li>This workflow has been thoroughly tested and is confirmed to be working flawlessly at the time of release. However, setup complexity or unexpected errors may occur depending on your environment, customizations, or API changes.</li>\n<li>Please note that I cannot offer personalized support or troubleshooting for this template (without a fee!). If you encounter an issue, feel free to send me a message describing the problem. If the issue is determined to be a genuine bug within the shared template, I will do my best to fix it and update the workflow. Otherwise, the issue is likely due to a setup misconfiguration or modification on your side. In those cases, I recommend using <em>ChatGPT</em> or referring to <em>n8n documentation</em> to debug the problem.</li>\n</ul>\n</div><!--]-->",
  "readme_zh": "### **最佳发票与收据OCR自动化工具——限时免费**\n\n**通过Gemini OCR自动处理发票和收据**，将数据直接从**Google云端硬盘、Gmail**和**Telegram**等多渠道提取至**Google表格**。这一高效工作流确保您的簿记始终准确、有序且高效，大幅减少人工操作与潜在错误。\n\n![自动化发票OCR至Google表格_Gemini_n8n工作流模板截图2.jpeg](https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/Automate_invoice_OCR_to_Google_Sheets_Gemini_n8n_workflow_template_screenshot_2_1361a561f4.jpeg)\n\n### **适用人群**\n\n本工作流专为忙碌的**企业家、初创公司创始人、自由职业者、小企业主、簿记员及会计师**设计，旨在消除手动、重复且易出错的簿记任务。无论您需要管理纸质收据、电子发票还是邮件附件，此工作流都能显著优化簿记流程，每月为您节省大量时间与精力。\n\n### **解决的核心问题**\n\n手动录入发票和收据数据不仅枯燥耗时，还极易出现人为错误。簿记失误可能导致财务偏差、合规问题及资源浪费。通过自动化提取发票数据，本工作流简化财务管理流程，显著提升准确性，降低运营成本，让您能将宝贵资源集中于战略性的创收业务。\n\n### **工作流功能**\n\n此模板利用Google Gemini API的OCR（光学字符识别）技术，通过直接HTTP请求提供强大的发票与收据数据自动化提取方案。\n\n1. **主流程（Google云端硬盘触发）**：  \n   - 当指定Google云端硬盘文件夹新增文件（PDF或图片）时，主工作流（*Google云端硬盘新文件触发器*）启动。  \n   - 通过*分批处理节点*逐项处理文件：  \n     - 下载文件（*获取收据*）  \n     - 转换为base64格式  \n     - 将文件数据及详细指令发送至Gemini API（*Prompt*节点指定使用*gemini-2.0-flash*模型，经*HTTP请求*节点发送）  \n     - 解析JSON响应  \n     - 将提取数据（发票日期、类别、发送方、货币等）连同原始文件名及文件链接添加至指定Google表格（*添加至Google表格*）  \n     - 内置*等待*节点以规避API速率限制  \n\n2. **辅助流程1（Gmail触发）**：  \n   - 监控Gmail中特定标签的邮件，发现含附件的匹配邮件时：  \n     - 遍历邮件及附件  \n     - 使用*创建文件名*节点按`YYYY-MM-DD_发送方用户名`格式重命名附件  \n     - 将重命名后的附件保存至指定Google云端硬盘文件夹，触发上述OCR流程  \n\n3. **辅助流程2（Telegram触发）**：  \n   - 通过配置的Telegram机器人转发纸质收据照片时：  \n     - 按`YYYY-MM-DD_Telegram`格式重命名图片  \n     - 保存至指定文件夹并触发OCR流程  \n\n### **配置步骤**\n\n1. **凭证设置**：  \n   - 在n8n中添加以下凭证（名称需与模板一致或自定义）：  \n     - *Google OAuth2*（用于云端硬盘、表格、Gmail）  \n     - *Telegram*（用于机器人触发）  \n     - *Gemini API密钥*（从[Google AI Studio](https://aistudio.google.com/)获取，粘贴至*HTTP请求*节点的查询参数中）  \n\n2. **Google云端硬盘**：  \n   - 创建专用文件夹用于存储和处理发票/收据，并在相关节点中更新目标文件夹路径  \n\n3. **Google表格**：  \n   - 新建表格或克隆[此模板](https://docs.google.com/spreadsheets/d/1HX12aLkBrFjKSvtMlhFbDQkvn8MQrhZQVkkxpXY5c0M/edit?usp=sharing)，确保列名与输出字段匹配  \n\n4. **Gmail（可选）**：  \n   - 创建标签（如`“收据”`），并在*Gmail触发器*节点中配置  \n\n5. **Telegram（可选）**：  \n   - 在*Telegram图片触发器*节点中配置机器人凭证  \n\n6. **Gemini API节点**：  \n   - 在*HTTP请求*节点的查询参数中替换为实际API密钥，确认URL使用正确模型名称  \n\n7. **自定义指令**：  \n   - 修改*Prompt*节点的首行公司信息及分类列表，确保符合需求  \n\n8. **测试与激活**：  \n   - 分别测试各触发路径后激活工作流  \n\n### **自定义建议**\n\n- **指令与模型**：在*Prompt*节点中调整指令文本、分类列表或格式要求，也可更换Gemini模型  \n- **字段提取**：修改*Prompt*节点以提取不同字段，并同步更新*解析字符串*节点及表格列  \n- **触发与目标**：按需启用/禁用*Gmail*或*Telegram*触发，直接在各节点中调整目标设置  \n- **文件命名**：编辑*创建文件名*节点的JavaScript代码以更改命名规则  \n- **集中配置**：建议在流程起始处添加*Set*节点统一管理配置项  \n\n### **注意事项**\n\n- **AI准确性**：AI模型可能出错，请务必核对提取数据的准确性（尤其是小数点等格式）  \n- **API使用限制**：注意Gemini API的调用频率及潜在费用（默认使用*gemini-2.0-flash*模型）  \n- **串行处理**：工作流采用串行处理以避免触发API限制  \n\n### **免责声明**\n\n- 本工作流按“原样”提供，请根据自身需求调整使用  \n- 发布时已通过全面测试，但环境差异或自定义修改可能导致意外错误  \n- 恕不提供免费个性化支持（确认为模板缺陷的问题除外），建议通过*ChatGPT*或*n8n文档*自行排查问题",
  "title_zh": "自动发票与收据OCR识别至Google表格——支持Drive、Gmail及Telegram触发",
  "publish_date_zh": "上次更新于4天前",
  "workflow_json_zh": "{\"id\": \"qClJP4aIscQySnQK\", \"meta\": {\"instanceId\": \"b3df22d2875c82e3ba1883c50049ed9cee0bcabf99d2b486961d2245a09e3964\", \"templateCredsSetupCompleted\": true}, \"name\": \"（同）将发票OCR提取内容复制到电子表格\", \"tags\": [], \"nodes\": [{\"id\": \"ceb8fcc7-c733-4842-8988-2f19695658e4\", \"name\": \"提示\", \"type\": \"n8n-nodes-base.set\", \"position\": [2320, -1340], \"parameters\": {}, \"typeVersion\": 3.4}, {\"id\": \"7bba23a4-9ff4-4c0f-9702-6de444b8701e\", \"name\": \"将文件转换为Base64字符串\", \"type\": \"n8n-nodes-base.extractFromFile\", \"position\": [2020, -1340], \"parameters\": {}, \"typeVersion\": 1}, {\"id\": \"df138485-9a6a-4d3e-a1ca-1c9568b5e76f\", \"name\": \"Gemini API\", \"type\": \"n8n-nodes-base.httpRequest\", \"position\": [2620, -1340], \"parameters\": {}, \"typeVersion\": 4.2}, {\"id\": \"e104546f-cf93-43c4-b5b4-5c66b046a72e\", \"name\": \"JSON 转字符串\", \"type\": \"n8n-nodes-base.set\", \"position\": [2900, -1220], \"parameters\": {}, \"typeVersion\": 3.4}, {\"id\": \"182783f8-5285-4506-aa7b-d6f1fdbf5492\", \"name\": \"解析字符串\", \"type\": \"n8n-nodes-base.code\", \"position\": [3200, -1220], \"parameters\": {}, \"typeVersion\": 2}, {\"id\": \"ca6d6fc1-8fce-48da-9de5-2395ff4ee3e8\", \"name\": \"添加到Google表格\", \"type\": \"n8n-nodes-base.googleSheets\", \"position\": [3500, -1220], \"parameters\": {}, \"typeVersion\": 4.5}, {\"id\": \"5b512370-b6e8-4cb7-b4d3-333ba15ac666\", \"name\": \"谷歌云端硬盘获取收据\", \"type\": \"n8n-nodes-base.googleDrive\", \"position\": [1720, -1340], \"parameters\": {}, \"typeVersion\": 3}, {\"id\": \"76c34c54-8666-4b3d-bb3f-ae79a6847cde\", \"name\": \"电报触发图片\", \"type\": \"n8n-nodes-base.telegramTrigger\", \"position\": [1060, -60], \"webhookId\": \"ef2f6b1f-b608-4e2f-9abe-02fe8ae0f085\", \"parameters\": {}, \"typeVersion\": 1.2}, {\"id\": \"9e8e821f-b6f7-4014-937e-9fe734c0e9c9\", \"name\": \"Gmail触发器\", \"type\": \"n8n-nodes-base.gmailTrigger\", \"position\": [1060, -720], \"parameters\": {}, \"typeVersion\": 1.2}, {\"id\": \"d3a929a9-441f-4896-9a98-d32f374c8a83\", \"name\": \"拆分出二进制文件\", \"type\": \"n8n-nodes-base.code\", \"position\": [1940, -480], \"parameters\": {}, \"typeVersion\": 2}, {\"id\": \"db81d68b-d937-47bd-adfc-215bd4797754\", \"name\": \"循环遍历附件\", \"type\": \"n8n-nodes-base.splitInBatches\", \"position\": [2100, -740], \"parameters\": {}, \"typeVersion\": 3}, {\"id\": \"2cbb56fc-eb6a-4f61-8204-bcde99c164c4\", \"name\": \"如果\", \"type\": \"n8n-nodes-base.if\", \"position\": [1640, -620], \"parameters\": {}, \"typeVersion\": 2.2}, {\"id\": \"97c167d3-db62-48ae-b9ab-4add617e1258\", \"name\": \"循环遍历邮件\", \"type\": \"n8n-nodes-base.splitInBatches\", \"position\": [1400, -720], \"parameters\": {}, \"typeVersion\": 3}, {\"id\": \"c4c4193a-983b-4f46-9d61-03ecff3157be\", \"name\": \"等待救援\", \"type\": \"n8n-nodes-base.wait\", \"position\": [3020, -720], \"webhookId\": \"a6742af7-28b5-469a-92d6-3f74845692fd\", \"parameters\": {}, \"typeVersion\": 1.1}, {\"id\": \"df28230d-7d7d-4817-8aba-615a9a266ad5\", \"name\": \"遍历项目\", \"type\": \"n8n-nodes-base.splitInBatches\", \"position\": [1400, -1360], \"parameters\": {}, \"typeVersion\": 3}, {\"id\": \"f3ee46f7-b3a8-4dfd-8b1f-da92613d5fe9\", \"name\": \"创建文件名\", \"type\": \"n8n-nodes-base.code\", \"position\": [2420, -720], \"parameters\": {}, \"typeVersion\": 2}, {\"id\": \"d7bde712-ece9-4613-9771-379f99a2300d\", \"name\": \"为Telegram创建文件名\", \"type\": \"n8n-nodes-base.code\", \"position\": [1400, -60], \"parameters\": {}, \"typeVersion\": 2}, {\"id\": \"f564d3b2-9be8-4119-9cc2-b4a61809af9f\", \"name\": \"Google Drive 触发器 - 新文件\", \"type\": \"n8n-nodes-base.googleDriveTrigger\", \"position\": [1060, -1360], \"parameters\": {}, \"typeVersion\": 1}, {\"id\": \"3f4adb77-2ab4-4e7f-b9d4-4b030aaf1f68\", \"name\": \"便利贴3\", \"type\": \"n8n-nodes-base.stickyNote\", \"position\": [1280, -800], \"parameters\": {\"content\": \"\"}, \"typeVersion\": 1}, {\"id\": \"8a9de5a7-0314-49d0-b87f-513bbb5e9531\", \"name\": \"便利贴\", \"type\": \"n8n-nodes-base.stickyNote\", \"position\": [1280, -140], \"parameters\": {\"content\": \"\"}, \"typeVersion\": 1}, {\"id\": \"7b9dc2de-464d-4c76-9ec0-44717bf29753\", \"name\": \"便利贴1\", \"type\": \"n8n-nodes-base.stickyNote\", \"position\": [1280, -1460], \"parameters\": {\"content\": \"\"}, \"typeVersion\": 1}, {\"id\": \"56c7a141-3265-4528-9f5c-ad3326bcf84e\", \"name\": \"谷歌保存文件2\", \"type\": \"n8n-nodes-base.googleDrive\", \"position\": [1740, -60], \"parameters\": {}, \"typeVersion\": 3}, {\"id\": \"e7b8fa1b-9510-450d-a35e-4a0338efa9f0\", \"name\": \"谷歌云端硬盘保存文件\", \"type\": \"n8n-nodes-base.googleDrive\", \"position\": [2720, -720], \"parameters\": {}, \"typeVersion\": 3}, {\"id\": \"95dc537f-75c1-47dc-b929-838b63f97e25\", \"name\": \"等待保存数据\", \"type\": \"n8n-nodes-base.wait\", \"position\": [3820, -1220], \"webhookId\": \"211ca61f-1915-4fb7-9ebf-8304c75d536e\", \"parameters\": {}, \"typeVersion\": 1.1}, {\"id\": \"d40ea975-5a33-485c-9811-7444181209ca\", \"name\": \"便利贴2\", \"type\": \"n8n-nodes-base.stickyNote\", \"position\": [20, -1480], \"parameters\": {\"content\": \"\"}, \"typeVersion\": 1}], \"active\": true, \"pinData\": {}, \"settings\": {\"errorWorkflow\": \"7XxwbKvr4yHpGpKg\", \"executionOrder\": \"v1\"}, \"versionId\": \"a6b663dd-a23e-4e18-abb8-65c23310056a\", \"connections\": {\"If\": {\"main\": [[{\"node\": \"Split Out Binary Files\", \"type\": \"main\", \"index\": 0}], [{\"node\": \"Loop Over Emails\", \"type\": \"main\", \"index\": 0}]]}, \"Prompt\": {\"main\": [[{\"node\": \"Gemini API\", \"type\": \"main\", \"index\": 0}]]}, \"Gemini API\": {\"main\": [[{\"node\": \"JSON to string\", \"type\": \"main\", \"index\": 0}]]}, \"Parse string\": {\"main\": [[{\"node\": \"Add to Google Sheets\", \"type\": \"main\", \"index\": 0}]]}, \"Gmail Trigger\": {\"main\": [[{\"node\": \"Loop Over Emails\", \"type\": \"main\", \"index\": 0}]]}, \"JSON to string\": {\"main\": [[{\"node\": \"Parse string\", \"type\": \"main\", \"index\": 0}]]}, \"Loop Over Items\": {\"main\": [[], [{\"node\": \"Google Drive Get Receipt\", \"type\": \"main\", \"index\": 0}]]}, \"Wait For Saving\": {\"main\": [[{\"node\": \"Loop Over Attachments\", \"type\": \"main\", \"index\": 0}]]}, \"Create File Name\": {\"main\": [[{\"node\": \"Google Drive Save Files\", \"type\": \"main\", \"index\": 0}]]}, \"Loop Over Emails\": {\"main\": [[{\"node\": \"Loop Over Attachments\", \"type\": \"main\", \"index\": 0}], [{\"node\": \"If\", \"type\": \"main\", \"index\": 0}]]}, \"Add to Google Sheets\": {\"main\": [[{\"node\": \"Wait For Saving Data\", \"type\": \"main\", \"index\": 0}]]}, \"Wait For Saving Data\": {\"main\": [[{\"node\": \"Loop Over Items\", \"type\": \"main\", \"index\": 0}]]}, \"Loop Over Attachments\": {\"main\": [[], [{\"node\": \"Create File Name\", \"type\": \"main\", \"index\": 0}]]}, \"Split Out Binary Files\": {\"main\": [[{\"node\": \"Loop Over Emails\", \"type\": \"main\", \"index\": 0}]]}, \"Telegram Trigger Image\": {\"main\": [[{\"node\": \"Create File Name For Telegram\", \"type\": \"main\", \"index\": 0}]]}, \"Google Drive Save Files\": {\"main\": [[{\"node\": \"Wait For Saving\", \"type\": \"main\", \"index\": 0}]]}, \"Google Drive Get Receipt\": {\"main\": [[{\"node\": \"Move file to base64 string\", \"type\": \"main\", \"index\": 0}]]}, \"Move file to base64 string\": {\"main\": [[{\"node\": \"Prompt\", \"type\": \"main\", \"index\": 0}]]}, \"Create File Name For Telegram\": {\"main\": [[{\"node\": \"Google Save Files 2\", \"type\": \"main\", \"index\": 0}]]}, \"Google Drive Trigger New Files\": {\"main\": [[{\"node\": \"Loop Over Items\", \"type\": \"main\", \"index\": 0}]]}}}"
}