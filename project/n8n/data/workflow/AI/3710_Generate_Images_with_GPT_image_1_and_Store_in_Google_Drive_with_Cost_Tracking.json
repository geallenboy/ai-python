{
  "title": "Generate Images with GPT-image-1 and Store in Google Drive with Cost Tracking",
  "url": "https://n8n.io/workflows/3710-generate-images-with-gpt-image-1-and-store-in-google-drive-with-cost-tracking/",
  "category": "AI",
  "category_url": "https://n8n.io/workflows/categories/ai/",
  "author": "darrell_tw",
  "publish_date": "Last update a day ago",
  "content": "",
  "workflow_json": "{\"id\":\"0GCQ1fO3d5MBdKmi\",\"meta\":{\"instanceId\":\"fddb3e91967f1012c95dd02bf5ad21f279fc44715f47a7a96a33433621caa253\"},\"name\":\"template-demo-chatgpt-image-1-with-drive-and-sheet copy\",\"tags\":[],\"nodes\":[{\"id\":\"7d78d4e3-cbb3-4f32-82d9-73c9d7f6c892\",\"name\":\"When clicking 'Test workflow'\",\"type\":\"n8n-nodes-base.manualTrigger\",\"disabled\":true,\"position\":[-480,-245],\"parameters\":{},\"typeVersion\":1},{\"id\":\"b32b61bb-c837-4697-9742-a1bb2854b628\",\"name\":\"HTTP Request\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[-260,-120],\"parameters\":{\"url\":\"https://api.openai.com/v1/images/generations\",\"method\":\"POST\",\"options\":{},\"sendBody\":true,\"authentication\":\"predefinedCredentialType\",\"bodyParameters\":{\"parameters\":[{\"name\":\"model\",\"value\":\"gpt-image-1\"},{\"name\":\"prompt\",\"value\":\"={{ $json.chatInput }}\"},{\"name\":\"output_format\",\"value\":\"jpeg\"},{\"name\":\"quality\",\"value\":\"low\"},{\"name\":\"output_compression\",\"value\":\"={{parseInt('80')}}\"},{\"name\":\"size\",\"value\":\"1024x1024\"},{\"name\":\"n\",\"value\":\"={{parseInt('1')}}\"},{\"name\":\"moderation\",\"value\":\"low\"}]},\"nodeCredentialType\":\"openAiApi\"},\"credentials\":{\"openAiApi\":{\"id\":\"GgwYNKMKKqKJICYO\",\"name\":\"OpenAi account - Image\"}},\"typeVersion\":4.2},{\"id\":\"0ead70d0-9e3b-4f19-afee-b5d4a7b532e9\",\"name\":\"Google Drive\",\"type\":\"n8n-nodes-base.googleDrive\",\"position\":[860,-20],\"parameters\":{\"name\":\"=chatgpt_created_by_n8n_{{ $('HTTP Request').item.json.created }}\",\"driveId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"My Drive\"},\"options\":{},\"folderId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"1sIbMHDtcOafBVdCq0gTEuGvnT63s8Fdy\",\"cachedResultUrl\":\"https://drive.google.com/drive/folders/1sIbMHDtcOafBVdCq0gTEuGvnT63s8Fdy\",\"cachedResultName\":\"n8n-demo-gpt_image_1\"},\"inputDataFieldName\":\"=data\"},\"credentials\":{\"googleDriveOAuth2Api\":{\"id\":\"iQdqjdvLVh5ldUIq\",\"name\":\"Personal-Google Drive account\"}},\"typeVersion\":3},{\"id\":\"a76c4340-9f34-49d1-a831-1ba4515933ee\",\"name\":\"Split Out\",\"type\":\"n8n-nodes-base.splitOut\",\"position\":[-40,-120],\"parameters\":{\"options\":{\"includeBinary\":true},\"fieldToSplitOut\":\"data\"},\"typeVersion\":1},{\"id\":\"c8090e15-b9b9-4999-89f0-97d45e6176d6\",\"name\":\"Convert to File\",\"type\":\"n8n-nodes-base.convertToFile\",\"position\":[640,-20],\"parameters\":{\"options\":{\"fileName\":\"={{ $now.format(\\\"yyyyMMddHHmmSSS\\\") }}\"},\"operation\":\"toBinary\",\"sourceProperty\":\"b64_json\"},\"typeVersion\":1.1},{\"id\":\"692a71fb-6fe3-4728-a588-f9283f5ab968\",\"name\":\"Loop Over Items\",\"type\":\"n8n-nodes-base.splitInBatches\",\"position\":[200,-20],\"parameters\":{\"options\":{\"reset\":false},\"batchSize\":\"=1\"},\"executeOnce\":false,\"typeVersion\":3},{\"id\":\"dfa88c15-4d38-4670-9c5a-4e52a9ce9d33\",\"name\":\"Edit Fields-file_name\",\"type\":\"n8n-nodes-base.set\",\"position\":[420,-20],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"10e6d39e-c44c-4db4-bf88-806b2f36c09f\",\"name\":\"file_name\",\"type\":\"string\",\"value\":\"={{ $now.format(\\\"yyyyMMddHHmmSSS\\\") }}\"},{\"id\":\"c2610584-aafa-4d90-8977-399e49015c32\",\"name\":\"b64_json\",\"type\":\"string\",\"value\":\"={{ $json.b64_json }}\"}]}},\"typeVersion\":3.4},{\"id\":\"c34c1a91-2601-4750-8134-d31cf377c349\",\"name\":\"Edit Fields1\",\"type\":\"n8n-nodes-base.set\",\"position\":[1080,-20],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"dcfa49d6-a8ed-43a2-9aaa-86751f34e61d\",\"name\":\"id\",\"type\":\"string\",\"value\":\"={{ $json.id }}\"},{\"id\":\"d2f7f22d-9453-4b61-bd46-fb3e8d5ad4d8\",\"name\":\"webViewLink\",\"type\":\"string\",\"value\":\"={{ $json.webViewLink }}\"},{\"id\":\"b8cf5a41-e354-416e-b548-8d1a274873e0\",\"name\":\"thumbnailLink\",\"type\":\"string\",\"value\":\"={{ $json.thumbnailLink }}\"},{\"id\":\"76c11a24-087c-4a6c-a5b4-8901e9436786\",\"name\":\"file_name\",\"type\":\"string\",\"value\":\"={{ $('Edit Fields-file_name').item.json.file_name }}\"}]}},\"typeVersion\":3.4},{\"id\":\"6bd8f7dc-1006-4d7f-b3eb-0a3aaa1b9a84\",\"name\":\"Google Sheets\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[1300,-20],\"parameters\":{\"columns\":{\"value\":{\"image\":\"={{ $json.webViewLink }}\",\"prompt\":\"={{ $('When chat message received').item.json.chatInput }}\",\"image_thumb\":\"==IMAGE(\\\"{{ $('Edit Fields1').item.json.thumbnailLink }}\\\")\"},\"schema\":[{\"id\":\"prompt\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"prompt\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"image\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"image\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"image_thumb\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"image_thumb\",\"defaultMatch\":false,\"canBeUsedToMatch\":true}],\"mappingMode\":\"defineBelow\",\"matchingColumns\":[],\"attemptToConvertTypes\":false,\"convertFieldsToString\":false},\"options\":{\"cellFormat\":\"USER_ENTERED\"},\"operation\":\"append\",\"sheetName\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"gid=0\",\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/11K1tui8itMzcSZqHOmzvFnM0G-ihn1uiLUZ_o478j88/edit#gid=0\",\"cachedResultName\":\"工作表1\"},\"documentId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"11K1tui8itMzcSZqHOmzvFnM0G-ihn1uiLUZ_o478j88\",\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/11K1tui8itMzcSZqHOmzvFnM0G-ihn1uiLUZ_o478j88/edit?usp=drivesdk\",\"cachedResultName\":\"n8n-chatgpt-image-1-model\"}},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"tufEzuSTEveV3tuA\",\"name\":\"(Personal)Google Sheets account\"}},\"typeVersion\":4.5},{\"id\":\"8ee28143-d9e7-4d14-929f-c9b6592c366e\",\"name\":\"When chat message received\",\"type\":\"@n8n/n8n-nodes-langchain.chatTrigger\",\"position\":[-480,-45],\"webhookId\":\"f64b2006-672a-4ad6-8c30-428b76f5a332\",\"parameters\":{\"options\":{}},\"typeVersion\":1.1},{\"id\":\"1e687fde-8465-4490-8738-c9832904f2b5\",\"name\":\"Google Sheets1\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[700,-400],\"parameters\":{\"columns\":{\"value\":{\"prompt\":\"={{ $('When chat message received').item.json.chatInput }}\",\"datetime\":\"={{ $('HTTP Request').item.json.created.toDateTime('s').format('yyyy-MM-dd HH:mm:ss') }}\",\"input token\":\"={{ $('HTTP Request').item.json.usage.input_tokens }}\",\"output token\":\"={{ $('HTTP Request').item.json.usage.output_tokens }}\",\"input estimated price\":\"={{    (     ($('HTTP Request').item.json.usage.input_tokens || 0) * 10 / 1000000   ).toFixed(6)  }}\",\"total estimated price\":\"={{ \\n  (\\n    (($('HTTP Request').item.json.usage.input_tokens || 0) * 10 / 1000000) +\\n    (($('HTTP Request').item.json.usage.output_tokens || 0) * 40 / 1000000)\\n  ).toFixed(6)\\n}}\",\"output estimated price\":\"={{    (     ($('HTTP Request').item.json.usage.output_tokens || 0) * 40 / 1000000   ).toFixed(6)  }}\"},\"schema\":[{\"id\":\"prompt\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"prompt\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"datetime\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"datetime\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"input token\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"input token\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"input estimated price\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"input estimated price\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"output token\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"output token\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"output estimated price\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"output estimated price\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"total estimated price\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"total estimated price\",\"defaultMatch\":false,\"canBeUsedToMatch\":true}],\"mappingMode\":\"defineBelow\",\"matchingColumns\":[],\"attemptToConvertTypes\":false,\"convertFieldsToString\":false},\"options\":{},\"operation\":\"append\",\"sheetName\":{\"__rl\":true,\"mode\":\"list\",\"value\":929800828,\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/11K1tui8itMzcSZqHOmzvFnM0G-ihn1uiLUZ_o478j88/edit#gid=929800828\",\"cachedResultName\":\"usage\"},\"documentId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"11K1tui8itMzcSZqHOmzvFnM0G-ihn1uiLUZ_o478j88\",\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/11K1tui8itMzcSZqHOmzvFnM0G-ihn1uiLUZ_o478j88/edit?usp=drivesdk\",\"cachedResultName\":\"n8n-chatgpt-image-1-model\"}},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"tufEzuSTEveV3tuA\",\"name\":\"(Personal)Google Sheets account\"}},\"typeVersion\":4.5},{\"id\":\"5e1f6dd3-6c1a-4838-86c7-2a3c0cf05c3d\",\"name\":\"Aggregate\",\"type\":\"n8n-nodes-base.aggregate\",\"position\":[480,-400],\"parameters\":{\"options\":{},\"aggregate\":\"aggregateAllItemData\"},\"typeVersion\":1},{\"id\":\"f14edb71-0778-40dc-9f2d-4cfc72b8a351\",\"name\":\"Sticky Note4\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-540,-600],\"parameters\":{\"color\":7,\"width\":340,\"height\":240,\"content\":\"## Created by darrell_tw_ \\n\\nAn engineer now focus on AI and Automation\\n\\n### contact me with following:\\n[X](https://x.com/darrell_tw_)\\n[Threads](https://www.threads.net/@darrell_tw_)\\n[Instagram](https://www.instagram.com/darrell_tw_/)\\n[Website](https://www.darrelltw.com/)\"},\"typeVersion\":1},{\"id\":\"6bbe2346-287b-491d-bf20-a76d39a6e297\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-540,-340],\"parameters\":{\"width\":660,\"height\":480,\"content\":\"## Use Chat to input prompts for image generation\"},\"typeVersion\":1},{\"id\":\"8dd6607a-16cf-424d-902a-04c43e68f424\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[160,-200],\"parameters\":{\"color\":2,\"width\":1260,\"height\":420,\"content\":\"## Process image array data with Loop\\nRegardless of single or multiple images\\nThey will be in the data[] array\\nJust use Loop to process them\\n\\nImages will be uploaded to Drive and saved as a row in the Sheet with links and thumbnails\"},\"typeVersion\":1},{\"id\":\"f8d0819a-e38a-4f7a-aa79-594ebca465a0\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[400,-480],\"parameters\":{\"color\":6,\"width\":480,\"height\":260,\"content\":\"## After processing, save Cost to Sheet\"},\"typeVersion\":1}],\"active\":false,\"pinData\":{},\"settings\":{\"executionOrder\":\"v1\"},\"versionId\":\"cf533114-4aa9-4b06-8247-3c06f9dcbc79\",\"connections\":{\"Aggregate\":{\"main\":[[{\"node\":\"Google Sheets1\",\"type\":\"main\",\"index\":0}]]},\"Split Out\":{\"main\":[[{\"node\":\"Loop Over Items\",\"type\":\"main\",\"index\":0}]]},\"Edit Fields1\":{\"main\":[[{\"node\":\"Google Sheets\",\"type\":\"main\",\"index\":0}]]},\"Google Drive\":{\"main\":[[{\"node\":\"Edit Fields1\",\"type\":\"main\",\"index\":0}]]},\"HTTP Request\":{\"main\":[[{\"node\":\"Split Out\",\"type\":\"main\",\"index\":0}]]},\"Google Sheets\":{\"main\":[[{\"node\":\"Loop Over Items\",\"type\":\"main\",\"index\":0}]]},\"Convert to File\":{\"main\":[[{\"node\":\"Google Drive\",\"type\":\"main\",\"index\":0}]]},\"Loop Over Items\":{\"main\":[[{\"node\":\"Aggregate\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Edit Fields-file_name\",\"type\":\"main\",\"index\":0}]]},\"Edit Fields-file_name\":{\"main\":[[{\"node\":\"Convert to File\",\"type\":\"main\",\"index\":0}]]},\"When chat message received\":{\"main\":[[{\"node\":\"HTTP Request\",\"type\":\"main\",\"index\":0}]]},\"When clicking 'Test workflow'\":{\"main\":[[{\"node\":\"HTTP Request\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "## How it works\n\n  * Receive a chat input as an image prompt.\n  * Call OpenAI's `gpt-image-1` API to generate an image.\n  * Split the returned images and process them one by one.\n  * Upload each generated image to **Google Drive**.\n  * Save image links and thumbnails to a **Google Sheets** document.\n  * Record token usage and estimated cost into a separate sheet.\n\n\n\n## Set up steps\n\n  1. Connect your **OpenAI API** credentials for image generation.\n  2. Connect your **Google Drive** and **Google Sheets** accounts.\n  3. Set the destination folder in Google Drive.\n  4. Set the target Google Sheet and specify the correct sheet tabs.\n  5. The setup usually takes around **5-10 minutes**.\n  6. Detailed field mappings are already pre-configured inside the workflow.\n  7. Additional tips and instructions are included as **sticky notes** inside the workflow.\n\n\n\n![Screenshot_20250425_190410_NRnD1vZE2x 2.jpg](https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/Screenshot_20250425_190410_N_Rn_D1v_ZE_2x_2_655c6573d8.jpg)\n",
  "readme_html": "<!--[--><div data-v-006f9244=\"\"><h2>How it works</h2>\n<ul>\n<li>Receive a chat input as an image prompt.</li>\n<li>Call OpenAI's <code>gpt-image-1</code> API to generate an image.</li>\n<li>Split the returned images and process them one by one.</li>\n<li>Upload each generated image to <strong>Google Drive</strong>.</li>\n<li>Save image links and thumbnails to a <strong>Google Sheets</strong> document.</li>\n<li>Record token usage and estimated cost into a separate sheet.</li>\n</ul>\n<h2>Set up steps</h2>\n<ol>\n<li>Connect your <strong>OpenAI API</strong> credentials for image generation.</li>\n<li>Connect your <strong>Google Drive</strong> and <strong>Google Sheets</strong> accounts.</li>\n<li>Set the destination folder in Google Drive.</li>\n<li>Set the target Google Sheet and specify the correct sheet tabs.</li>\n<li>The setup usually takes around <strong>5-10 minutes</strong>.</li>\n<li>Detailed field mappings are already pre-configured inside the workflow.</li>\n<li>Additional tips and instructions are included as <strong>sticky notes</strong> inside the workflow.</li>\n</ol>\n<p><img src=\"https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/Screenshot_20250425_190410_N_Rn_D1v_ZE_2x_2_655c6573d8.jpg\" alt=\"Screenshot_20250425_190410_NRnD1vZE2x 2.jpg\"></p>\n</div><!--]-->",
  "readme_zh": "## 运作流程\n\n  * 接收聊天输入作为图像生成指令\n  * 调用OpenAI的`gpt-image-1`接口生成图像\n  * 分割返回的图像并逐张处理\n  * 将每张生成图像上传至**Google云端硬盘**\n  * 将图片链接与缩略图保存至**Google表格**文档\n  * 在独立工作表记录令牌用量与预估费用\n\n## 配置步骤\n\n  1. 关联您的**OpenAI API**凭证用于图像生成\n  2. 连接您的**Google云端硬盘**与**Google表格**账户\n  3. 设置Google云端硬盘中的目标文件夹\n  4. 指定目标Google表格及对应工作表标签\n  5. 配置过程通常需要**5-10分钟**\n  6. 工作流内已预设详细的字段映射关系\n  7. 额外提示说明以**便利贴**形式内置于工作流中\n\n![流程截图](https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/Screenshot_20250425_190410_N_Rn_D1v_ZE_2x_2_655c6573d8.jpg)",
  "title_zh": "使用GPT-image-1生成图像并存储至Google Drive，附带成本追踪功能",
  "publish_date_absolute": "",
  "publish_date_zh": "最近更新于一天前",
  "workflow_json_zh": "{\n  \"id\": \"0GCQ1fO3d5MBdKmi\",\n  \"meta\": {\n    \"instanceId\": \"fddb3e91967f1012c95dd02bf5ad21f279fc44715f47a7a96a33433621caa253\"\n  },\n  \"name\": \"template-demo-chatgpt-image-1-with-drive-and-sheet copy\",\n  \"tags\": [],\n  \"nodes\": [\n    {\n      \"id\": \"7d78d4e3-cbb3-4f32-82d9-73c9d7f6c892\",\n      \"name\": \"When clicking 'Test workflow'\",\n      \"type\": \"n8n-nodes-base.manualTrigger\",\n      \"disabled\": true,\n      \"position\": [\n        -480,\n        -245\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"b32b61bb-c837-4697-9742-a1bb2854b628\",\n      \"name\": \"HTTP Request\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        -260,\n        -120\n      ],\n      \"parameters\": {\n        \"url\": \"https://api.openai.com/v1/images/generations\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"sendBody\": true,\n        \"authentication\": \"predefinedCredentialType\",\n        \"bodyParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"model\",\n              \"value\": \"gpt-image-1\"\n            },\n            {\n              \"name\": \"prompt\",\n              \"value\": \"={{ $json.chatInput }}\"\n            },\n            {\n              \"name\": \"output_format\",\n              \"value\": \"jpeg\"\n            },\n            {\n              \"name\": \"quality\",\n              \"value\": \"low\"\n            },\n            {\n              \"name\": \"output_compression\",\n              \"value\": \"={{parseInt('80')}}\"\n            },\n            {\n              \"name\": \"size\",\n              \"value\": \"1024x1024\"\n            },\n            {\n              \"name\": \"n\",\n              \"value\": \"={{parseInt('1')}}\"\n            },\n            {\n              \"name\": \"moderation\",\n              \"value\": \"low\"\n            }\n          ]\n        },\n        \"nodeCredentialType\": \"openAiApi\"\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"GgwYNKMKKqKJICYO\",\n          \"name\": \"OpenAi account - Image\"\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"0ead70d0-9e3b-4f19-afee-b5d4a7b532e9\",\n      \"name\": \"Google Drive\",\n      \"type\": \"n8n-nodes-base.googleDrive\",\n      \"position\": [\n        860,\n        -20\n      ],\n      \"parameters\": {\n        \"name\": \"=chatgpt_created_by_n8n_{{ $('HTTP Request').item.json.created }}\",\n        \"driveId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"My Drive\"\n        },\n        \"options\": {},\n        \"folderId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"1sIbMHDtcOafBVdCq0gTEuGvnT63s8Fdy\",\n          \"cachedResultUrl\": \"https://drive.google.com/drive/folders/1sIbMHDtcOafBVdCq0gTEuGvnT63s8Fdy\",\n          \"cachedResultName\": \"n8n-demo-gpt_image_1\"\n        },\n        \"inputDataFieldName\": \"=data\"\n      },\n      \"credentials\": {\n        \"googleDriveOAuth2Api\": {\n          \"id\": \"iQdqjdvLVh5ldUIq\",\n          \"name\": \"Personal-Google Drive account\"\n        }\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"a76c4340-9f34-49d1-a831-1ba4515933ee\",\n      \"name\": \"Split Out\",\n      \"type\": \"n8n-nodes-base.splitOut\",\n      \"position\": [\n        -40,\n        -120\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"includeBinary\": true\n        },\n        \"fieldToSplitOut\": \"data\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"c8090e15-b9b9-4999-89f0-97d45e6176d6\",\n      \"name\": \"Convert to File\",\n      \"type\": \"n8n-nodes-base.convertToFile\",\n      \"position\": [\n        640,\n        -20\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"fileName\": \"={{ $now.format(\\\"yyyyMMddHHmmSSS\\\") }}\"\n        },\n        \"operation\": \"toBinary\",\n        \"sourceProperty\": \"b64_json\"\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"692a71fb-6fe3-4728-a588-f9283f5ab968\",\n      \"name\": \"Loop Over Items\",\n      \"type\": \"n8n-nodes-base.splitInBatches\",\n      \"position\": [\n        200,\n        -20\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"reset\": false\n        },\n        \"batchSize\": \"=1\"\n      },\n      \"executeOnce\": false,\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"dfa88c15-4d38-4670-9c5a-4e52a9ce9d33\",\n      \"name\": \"Edit Fields-file_name\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        420,\n        -20\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"10e6d39e-c44c-4db4-bf88-806b2f36c09f\",\n              \"name\": \"file_name\",\n              \"type\": \"string\",\n              \"value\": \"={{ $now.format(\\\"yyyyMMddHHmmSSS\\\") }}\"\n            },\n            {\n              \"id\": \"c2610584-aafa-4d90-8977-399e49015c32\",\n              \"name\": \"b64_json\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.b64_json }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"c34c1a91-2601-4750-8134-d31cf377c349\",\n      \"name\": \"Edit Fields1\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1080,\n        -20\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"dcfa49d6-a8ed-43a2-9aaa-86751f34e61d\",\n              \"name\": \"id\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.id }}\"\n            },\n            {\n              \"id\": \"d2f7f22d-9453-4b61-bd46-fb3e8d5ad4d8\",\n              \"name\": \"webViewLink\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.webViewLink }}\"\n            },\n            {\n              \"id\": \"b8cf5a41-e354-416e-b548-8d1a274873e0\",\n              \"name\": \"thumbnailLink\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.thumbnailLink }}\"\n            },\n            {\n              \"id\": \"76c11a24-087c-4a6c-a5b4-8901e9436786\",\n              \"name\": \"file_name\",\n              \"type\": \"string\",\n              \"value\": \"={{ $('Edit Fields-file_name').item.json.file_name }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"6bd8f7dc-1006-4d7f-b3eb-0a3aaa1b9a84\",\n      \"name\": \"Google Sheets\",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"position\": [\n        1300,\n        -20\n      ],\n      \"parameters\": {\n        \"columns\": {\n          \"value\": {\n            \"image\": \"={{ $json.webViewLink }}\",\n            \"prompt\": \"={{ $('When chat message received').item.json.chatInput }}\",\n            \"image_thumb\": \"==IMAGE(\\\"{{ $('Edit Fields1').item.json.thumbnailLink }}\\\")\"\n          },\n          \"schema\": [\n            {\n              \"id\": \"prompt\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"prompt\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"image\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"image\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"image_thumb\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"image_thumb\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            }\n          ],\n          \"mappingMode\": \"defineBelow\",\n          \"matchingColumns\": [],\n          \"attemptToConvertTypes\": false,\n          \"convertFieldsToString\": false\n        },\n        \"options\": {\n          \"cellFormat\": \"USER_ENTERED\"\n        },\n        \"operation\": \"append\",\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"gid=0\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/11K1tui8itMzcSZqHOmzvFnM0G-ihn1uiLUZ_o478j88/edit#gid=0\",\n          \"cachedResultName\": \"工作表1\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"11K1tui8itMzcSZqHOmzvFnM0G-ihn1uiLUZ_o478j88\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/11K1tui8itMzcSZqHOmzvFnM0G-ihn1uiLUZ_o478j88/edit?usp=drivesdk\",\n          \"cachedResultName\": \"n8n-chatgpt-image-1-model\"\n        }\n      },\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"tufEzuSTEveV3tuA\",\n          \"name\": \"(Personal)Google Sheets account\"\n        }\n      },\n      \"typeVersion\": 4.5\n    },\n    {\n      \"id\": \"8ee28143-d9e7-4d14-929f-c9b6592c366e\",\n      \"name\": \"When chat message received\",\n      \"type\": \"@n8n/n8n-nodes-langchain.chatTrigger\",\n      \"position\": [\n        -480,\n        -45\n      ],\n      \"webhookId\": \"f64b2006-672a-4ad6-8c30-428b76f5a332\",\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"1e687fde-8465-4490-8738-c9832904f2b5\",\n      \"name\": \"Google Sheets1\",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"position\": [\n        700,\n        -400\n      ],\n      \"parameters\": {\n        \"columns\": {\n          \"value\": {\n            \"prompt\": \"={{ $('When chat message received').item.json.chatInput }}\",\n            \"datetime\": \"={{ $('HTTP Request').item.json.created.toDateTime('s').format('yyyy-MM-dd HH:mm:ss') }}\",\n            \"input token\": \"={{ $('HTTP Request').item.json.usage.input_tokens }}\",\n            \"output token\": \"={{ $('HTTP Request').item.json.usage.output_tokens }}\",\n            \"input estimated price\": \"={{    (     ($('HTTP Request').item.json.usage.input_tokens || 0) * 10 / 1000000   ).toFixed(6)  }}\",\n            \"total estimated price\": \"={{ \\n  (\\n    (($('HTTP Request').item.json.usage.input_tokens || 0) * 10 / 1000000) +\\n    (($('HTTP Request').item.json.usage.output_tokens || 0) * 40 / 1000000)\\n  ).toFixed(6)\\n}}\",\n            \"output estimated price\": \"={{    (     ($('HTTP Request').item.json.usage.output_tokens || 0) * 40 / 1000000   ).toFixed(6)  }}\"\n          },\n          \"schema\": [\n            {\n              \"id\": \"prompt\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"prompt\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"datetime\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"datetime\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"input token\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"input token\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"input estimated price\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"input estimated price\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"output token\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"output token\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"output estimated price\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"output estimated price\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"total estimated price\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"total estimated price\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            }\n          ],\n          \"mappingMode\": \"defineBelow\",\n          \"matchingColumns\": [],\n          \"attemptToConvertTypes\": false,\n          \"convertFieldsToString\": false\n        },\n        \"options\": {},\n        \"operation\": \"append\",\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": 929800828,\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/11K1tui8itMzcSZqHOmzvFnM0G-ihn1uiLUZ_o478j88/edit#gid=929800828\",\n          \"cachedResultName\": \"usage\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"11K1tui8itMzcSZqHOmzvFnM0G-ihn1uiLUZ_o478j88\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/11K1tui8itMzcSZqHOmzvFnM0G-ihn1uiLUZ_o478j88/edit?usp=drivesdk\",\n          \"cachedResultName\": \"n8n-chatgpt-image-1-model\"\n        }\n      },\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"tufEzuSTEveV3tuA\",\n          \"name\": \"(Personal)Google Sheets account\"\n        }\n      },\n      \"typeVersion\": 4.5\n    },\n    {\n      \"id\": \"5e1f6dd3-6c1a-4838-86c7-2a3c0cf05c3d\",\n      \"name\": \"Aggregate\",\n      \"type\": \"n8n-nodes-base.aggregate\",\n      \"position\": [\n        480,\n        -400\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"aggregate\": \"aggregateAllItemData\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"f14edb71-0778-40dc-9f2d-4cfc72b8a351\",\n      \"name\": \"Sticky Note4\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -540,\n        -600\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 340,\n        \"height\": 240,\n        \"content\": \"## 由 darrell_tw_ 创建\\n\\n一名专注于人工智能与自动化领域的工程师\\n\\n### 通过以下方式联系我：\\n[X](https://x.com/darrell_tw_)\\n[Threads](https://www.threads.net/@darrell_tw_)\\n[Instagram](https://www.instagram.com/darrell_tw_/)\\n[个人网站](https://www.darrelltw.com/)\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"6bbe2346-287b-491d-bf20-a76d39a6e297\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -540,\n        -340\n      ],\n      \"parameters\": {\n        \"width\": 660,\n        \"height\": 480,\n        \"content\": \"## 使用聊天功能输入图像生成提示词\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"8dd6607a-16cf-424d-902a-04c43e68f424\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        160,\n        -200\n      ],\n      \"parameters\": {\n        \"color\": 2,\n        \"width\": 1260,\n        \"height\": 420,\n        \"content\": \"## 使用循环处理图像数组数据\\n无论单张还是多张图片  \\n它们都会存放在 data[] 数组中  \\n只需使用循环进行处理  \\n\\n图片将被上传至云端硬盘  \\n并在表格中保存为带链接和缩略图的行\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"f8d0819a-e38a-4f7a-aa79-594ebca465a0\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        400,\n        -480\n      ],\n      \"parameters\": {\n        \"color\": 6,\n        \"width\": 480,\n        \"height\": 260,\n        \"content\": \"## 处理完成后，将成本保存至工作表\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"active\": false,\n  \"pinData\": {},\n  \"settings\": {\n    \"executionOrder\": \"v1\"\n  },\n  \"versionId\": \"cf533114-4aa9-4b06-8247-3c06f9dcbc79\",\n  \"connections\": {\n    \"Aggregate\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Google Sheets1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Split Out\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Loop Over Items\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Edit Fields1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Google Sheets\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Google Drive\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Edit Fields1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"HTTP Request\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Split Out\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Google Sheets\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Loop Over Items\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Convert to File\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Google Drive\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Loop Over Items\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Aggregate\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Edit Fields-file_name\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Edit Fields-file_name\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Convert to File\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"When chat message received\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"HTTP Request\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"When clicking 'Test workflow'\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"HTTP Request\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}