{
  "title": "Create a Session-Based Telegram Chatbot with GPT-4o-mini and Google Sheets",
  "url": "https://n8n.io/workflows/3798-create-a-session-based-telegram-chatbot-with-gpt-4o-mini-and-google-sheets/",
  "category": "AI",
  "category_url": "https://n8n.io/workflows/categories/ai/?sort=createdAt:desc",
  "author": "Davide",
  "publish_date": "Last update 5 days ago",
  "publish_date_absolute": "2025-05-02",
  "content": "",
  "workflow_json": "{\"id\":\"A7dRnMf9WybO8O02\",\"meta\":{\"instanceId\":\"a4bfc93e975ca233ac45ed7c9227d84cf5a2329310525917adaf3312e10d5462\",\"templateCredsSetupCompleted\":true},\"name\":\"Telegram ChatBot with multiple sessions\",\"tags\":[],\"nodes\":[{\"id\":\"d3104851-90ec-4f0c-ab4d-aee5a6faf81b\",\"name\":\"OpenAI Chat Model\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\"position\":[640,1180],\"parameters\":{\"model\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"gpt-4o-mini\"},\"options\":{}},\"credentials\":{\"openAiApi\":{\"id\":\"4zwP0MSr8zkNvvV9\",\"name\":\"OpenAi account\"}},\"typeVersion\":1.2},{\"id\":\"e25050a1-e49b-4b46-8452-ce7b3388c7f3\",\"name\":\"Simple Memory\",\"type\":\"@n8n/n8n-nodes-langchain.memoryBufferWindow\",\"position\":[780,1180],\"parameters\":{\"sessionKey\":\"={{ $('Get session').item.json.SESSION }}\",\"sessionIdType\":\"customKey\",\"contextWindowLength\":100},\"typeVersion\":1.3},{\"id\":\"d50951ae-e9a2-492c-8ff5-a039ca6975e4\",\"name\":\"Get message\",\"type\":\"n8n-nodes-base.telegramTrigger\",\"position\":[-520,-60],\"webhookId\":\"8d87dcf7-1608-4255-a1f1-03b700a42f0e\",\"parameters\":{\"updates\":[\"message\"],\"additionalFields\":{}},\"credentials\":{\"telegramApi\":{\"id\":\"rQ5q95W7uKesMDx4\",\"name\":\"Telegram account Fastewb\"}},\"typeVersion\":1.2},{\"id\":\"1bc9aa0f-8af8-47b8-b7d7-6bfd9280b65f\",\"name\":\"Command or text?\",\"type\":\"n8n-nodes-base.switch\",\"position\":[-20,-60],\"parameters\":{\"rules\":{\"values\":[{\"outputKey\":\"New session\",\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"955f3c39-0732-4a63-b3f7-70ab0753a68a\",\"operator\":{\"type\":\"string\",\"operation\":\"startsWith\"},\"leftValue\":\"={{ $('Get message').item.json.message.text }}\",\"rightValue\":\"/new\"}]},\"renameOutput\":true},{\"outputKey\":\"Current session\",\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"790f64bc-f3cc-4ef4-9d43-80853742fee6\",\"operator\":{\"type\":\"string\",\"operation\":\"startsWith\"},\"leftValue\":\"={{ $('Get message').item.json.message.text }}\",\"rightValue\":\"/current\"}]},\"renameOutput\":true},{\"outputKey\":\"Resume session\",\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"39f35352-aee4-4a16-b82f-7f58ab8120f0\",\"operator\":{\"type\":\"string\",\"operation\":\"startsWith\"},\"leftValue\":\"={{ $('Get message').item.json.message.text }}\",\"rightValue\":\"/resume\"}]},\"renameOutput\":true},{\"outputKey\":\"Summary \",\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"270d71bf-8ecf-46e7-a601-cc5d1dc58e72\",\"operator\":{\"name\":\"filter.operator.equals\",\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $('Get message').item.json.message.text }}\",\"rightValue\":\"/summary\"}]},\"renameOutput\":true},{\"outputKey\":\"Question\",\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"55fe98fa-e39a-41b3-983f-359a8e730f21\",\"operator\":{\"type\":\"string\",\"operation\":\"startsWith\"},\"leftValue\":\"={{ $('Get message').item.json.message.text }}\",\"rightValue\":\"/question\"}]},\"renameOutput\":true}]},\"options\":{\"fallbackOutput\":\"extra\"}},\"typeVersion\":3.2},{\"id\":\"4a405332-99a8-4ec9-84d5-89f9f5f1610f\",\"name\":\"Get session\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[-260,-60],\"parameters\":{\"options\":{\"returnFirstMatch\":true},\"filtersUI\":{\"values\":[{\"lookupValue\":\"current\",\"lookupColumn\":\"STATE\"}]},\"sheetName\":{\"__rl\":true,\"mode\":\"list\",\"value\":207843712,\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1MCJLAqKP0Y7Qr68ZYoSSBeEVyKI1QgAAZnlEiyqkzXo/edit#gid=207843712\",\"cachedResultName\":\"Session\"},\"documentId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"1MCJLAqKP0Y7Qr68ZYoSSBeEVyKI1QgAAZnlEiyqkzXo\",\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1MCJLAqKP0Y7Qr68ZYoSSBeEVyKI1QgAAZnlEiyqkzXo/edit?usp=drivesdk\",\"cachedResultName\":\"Chatbot with session\"}},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"JYR6a64Qecd6t8Hb\",\"name\":\"Google Sheets account\"}},\"typeVersion\":4.5},{\"id\":\"860fa8d5-6c9b-476b-857b-9c47a023d72f\",\"name\":\"Disable previous session\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[640,-760],\"parameters\":{\"columns\":{\"value\":{\"STATE\":\"expire\",\"SESSION\":\"={{ $('Get session').item.json.SESSION }}\"},\"schema\":[{\"id\":\"SESSION\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"SESSION\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"STATE\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"STATE\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"row_number\",\"type\":\"string\",\"display\":true,\"removed\":true,\"readOnly\":true,\"required\":false,\"displayName\":\"row_number\",\"defaultMatch\":false,\"canBeUsedToMatch\":true}],\"mappingMode\":\"defineBelow\",\"matchingColumns\":[\"SESSION\"],\"attemptToConvertTypes\":false,\"convertFieldsToString\":false},\"options\":{},\"operation\":\"update\",\"sheetName\":{\"__rl\":true,\"mode\":\"list\",\"value\":207843712,\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1MCJLAqKP0Y7Qr68ZYoSSBeEVyKI1QgAAZnlEiyqkzXo/edit#gid=207843712\",\"cachedResultName\":\"Session\"},\"documentId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"1MCJLAqKP0Y7Qr68ZYoSSBeEVyKI1QgAAZnlEiyqkzXo\",\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1MCJLAqKP0Y7Qr68ZYoSSBeEVyKI1QgAAZnlEiyqkzXo/edit?usp=drivesdk\",\"cachedResultName\":\"Chatbot with session\"}},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"JYR6a64Qecd6t8Hb\",\"name\":\"Google Sheets account\"}},\"typeVersion\":4.5},{\"id\":\"6ff1cf54-5406-4c86-a77e-8424208d4728\",\"name\":\"Set new session\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[960,-760],\"parameters\":{\"columns\":{\"value\":{\"STATE\":\"current\",\"SESSION\":\"={{ $('Get message').item.json.update_id }}\"},\"schema\":[{\"id\":\"SESSION\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"SESSION\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"STATE\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"STATE\",\"defaultMatch\":false,\"canBeUsedToMatch\":true}],\"mappingMode\":\"defineBelow\",\"matchingColumns\":[],\"attemptToConvertTypes\":false,\"convertFieldsToString\":false},\"options\":{},\"operation\":\"append\",\"sheetName\":{\"__rl\":true,\"mode\":\"list\",\"value\":207843712,\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1MCJLAqKP0Y7Qr68ZYoSSBeEVyKI1QgAAZnlEiyqkzXo/edit#gid=207843712\",\"cachedResultName\":\"Session\"},\"documentId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"1MCJLAqKP0Y7Qr68ZYoSSBeEVyKI1QgAAZnlEiyqkzXo\",\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1MCJLAqKP0Y7Qr68ZYoSSBeEVyKI1QgAAZnlEiyqkzXo/edit?usp=drivesdk\",\"cachedResultName\":\"Chatbot with session\"}},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"JYR6a64Qecd6t8Hb\",\"name\":\"Google Sheets account\"}},\"typeVersion\":4.5},{\"id\":\"be9c755a-0c52-453c-b448-98975d4c6e87\",\"name\":\"Session activated\",\"type\":\"n8n-nodes-base.telegram\",\"position\":[1240,-760],\"webhookId\":\"fa5e7641-068c-40cb-b490-a6809e74c629\",\"parameters\":{\"text\":\"New session activated\",\"chatId\":\"={{ $('Get message').item.json.message.from.id }}\",\"additionalFields\":{\"appendAttribution\":false}},\"credentials\":{\"telegramApi\":{\"id\":\"rQ5q95W7uKesMDx4\",\"name\":\"Telegram account Fastewb\"}},\"typeVersion\":1.2},{\"id\":\"31478ec5-c1de-43db-ac9d-9b34f68e951c\",\"name\":\"Send response\",\"type\":\"n8n-nodes-base.telegram\",\"position\":[1100,980],\"webhookId\":\"fa5e7641-068c-40cb-b490-a6809e74c629\",\"parameters\":{\"text\":\"={{ $json.output }}\",\"chatId\":\"={{ $('Get message').item.json.message.from.id }}\",\"additionalFields\":{\"appendAttribution\":false}},\"credentials\":{\"telegramApi\":{\"id\":\"rQ5q95W7uKesMDx4\",\"name\":\"Telegram account Fastewb\"}},\"typeVersion\":1.2},{\"id\":\"be35b9a6-2914-409f-bc9c-6199ccb9e4ed\",\"name\":\"Update database\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[1420,980],\"parameters\":{\"columns\":{\"value\":{\"DATE\":\"={{$now}}\",\"PROMPT\":\"={{ $('Get message').item.json.message.text }}\",\"SESSION\":\"={{ $('Get session').item.json.SESSION }}\",\"RESPONSE\":\"={{ $('Telegram Chatbot').item.json.output }}\"},\"schema\":[{\"id\":\"SESSION\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"SESSION\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"DATE\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"DATE\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"PROMPT\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"PROMPT\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"RESPONSE\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"RESPONSE\",\"defaultMatch\":false,\"canBeUsedToMatch\":true}],\"mappingMode\":\"defineBelow\",\"matchingColumns\":[],\"attemptToConvertTypes\":false,\"convertFieldsToString\":false},\"options\":{},\"operation\":\"append\",\"sheetName\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"gid=0\",\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1MCJLAqKP0Y7Qr68ZYoSSBeEVyKI1QgAAZnlEiyqkzXo/edit#gid=0\",\"cachedResultName\":\"Database\"},\"documentId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"1MCJLAqKP0Y7Qr68ZYoSSBeEVyKI1QgAAZnlEiyqkzXo\",\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1MCJLAqKP0Y7Qr68ZYoSSBeEVyKI1QgAAZnlEiyqkzXo/edit?usp=drivesdk\",\"cachedResultName\":\"Chatbot with session\"}},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"JYR6a64Qecd6t8Hb\",\"name\":\"Google Sheets account\"}},\"typeVersion\":4.5},{\"id\":\"dacc79e0-56ff-47d6-b09f-16ebfb31cbfa\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-540,-540],\"parameters\":{\"color\":3,\"width\":620,\"height\":360,\"content\":\"# Telegram ChatBot with multiple sessions\\n\\nThis workflow creates an **AI-powered Telegram chatbot** with **session management**, allowing users to:  \\n- **Start new conversations** (`/new`).  \\n- **Check current sessions** (`/current`).  \\n- **Resume past sessions** (`/resume`).  \\n- **Get summaries** (`/summary`).  \\n- **Ask questions** (`/question`). \\n\\n- Clone [this sheet](https://docs.google.com/spreadsheets/d/1MCJLAqKP0Y7Qr68ZYoSSBeEVyKI1QgAAZnlEiyqkzXo/edit?usp=sharing)\"},\"typeVersion\":1},{\"id\":\"55751f99-ee2e-429b-99cd-fef30eb56fb8\",\"name\":\"Summarization Chain\",\"type\":\"@n8n/n8n-nodes-langchain.chainSummarization\",\"position\":[1040,200],\"parameters\":{\"options\":{\"summarizationMethodAndPrompts\":{\"values\":{\"prompt\":\"=Write a concise summary of the following:\\n\\n\\n\\\"{{ $json.fullText }}\\\"\\n\\n\\nCONCISE SUMMARY:\",\"combineMapPrompt\":\"=Write a concise summary of the following:\\n\\n\\n\\\"{{ $json.fullText }}\\\"\\n\\n\\nCONCISE SUMMARY:\"}}}},\"typeVersion\":2},{\"id\":\"c7f0d136-4a77-4bc8-b2ef-b03fa41ad1ff\",\"name\":\"OpenAI Chat Model1\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\"position\":[1020,380],\"parameters\":{\"model\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"gpt-4o-mini\"},\"options\":{}},\"credentials\":{\"openAiApi\":{\"id\":\"4zwP0MSr8zkNvvV9\",\"name\":\"OpenAi account\"}},\"typeVersion\":1.2},{\"id\":\"a455cf00-2f72-4377-ac2a-d65ab8c30e31\",\"name\":\"OpenAI Chat Model2\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\"position\":[1660,800],\"parameters\":{\"model\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"gpt-4o-mini\"},\"options\":{}},\"credentials\":{\"openAiApi\":{\"id\":\"4zwP0MSr8zkNvvV9\",\"name\":\"OpenAi account\"}},\"typeVersion\":1.2},{\"id\":\"e55082e4-4e65-4fbb-8850-d3b64093eab6\",\"name\":\"Basic LLM Chain\",\"type\":\"@n8n/n8n-nodes-langchain.chainLlm\",\"position\":[1680,600],\"parameters\":{\"text\":\"=Question:\\n{{ $json.question }}\",\"messages\":{\"messageValues\":[{\"message\":\"=You have to answer the questions that are asked by analyzing the following text:\\n\\n{{ $json.fullText }}\"}]},\"promptType\":\"define\"},\"typeVersion\":1.6},{\"id\":\"1e670eaa-fd9f-4e79-b2a8-bd43240455db\",\"name\":\"Get message1\",\"type\":\"n8n-nodes-base.set\",\"position\":[600,-100],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"56bf47bc-e84c-4cee-8aa0-927f3d2e31c5\",\"name\":\"text\",\"type\":\"string\",\"value\":\"={{ $('Get message').item.json.message.text }}\"}]}},\"typeVersion\":3.4},{\"id\":\"65771b1e-47fc-439d-a1ea-9901bac047d8\",\"name\":\"Set to expire\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[1040,-100],\"parameters\":{\"columns\":{\"value\":{\"STATE\":\"expire\",\"SESSION\":\"={{ $('Get session').item.json.SESSION }}\"},\"schema\":[{\"id\":\"SESSION\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"SESSION\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"STATE\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"STATE\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"row_number\",\"type\":\"string\",\"display\":true,\"removed\":true,\"readOnly\":true,\"required\":false,\"displayName\":\"row_number\",\"defaultMatch\":false,\"canBeUsedToMatch\":true}],\"mappingMode\":\"defineBelow\",\"matchingColumns\":[\"SESSION\"],\"attemptToConvertTypes\":false,\"convertFieldsToString\":false},\"options\":{},\"operation\":\"update\",\"sheetName\":{\"__rl\":true,\"mode\":\"list\",\"value\":207843712,\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1MCJLAqKP0Y7Qr68ZYoSSBeEVyKI1QgAAZnlEiyqkzXo/edit#gid=207843712\",\"cachedResultName\":\"Session\"},\"documentId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"1MCJLAqKP0Y7Qr68ZYoSSBeEVyKI1QgAAZnlEiyqkzXo\",\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1MCJLAqKP0Y7Qr68ZYoSSBeEVyKI1QgAAZnlEiyqkzXo/edit?usp=drivesdk\",\"cachedResultName\":\"Chatbot with session\"}},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"JYR6a64Qecd6t8Hb\",\"name\":\"Google Sheets account\"}},\"typeVersion\":4.5},{\"id\":\"d18268f6-8792-4a66-aa32-35b596e7fcad\",\"name\":\"Exist?\",\"type\":\"n8n-nodes-base.if\",\"position\":[1540,-100],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"1710e38c-80d1-49ba-9814-2b2c6b3c3b8d\",\"operator\":{\"type\":\"object\",\"operation\":\"empty\",\"singleValue\":true},\"leftValue\":\"={{ $json }}\",\"rightValue\":\"\"}]}},\"typeVersion\":2.2},{\"id\":\"6eeb7e4d-8af0-4d71-981d-66a39f4870a3\",\"name\":\"OK\",\"type\":\"n8n-nodes-base.telegram\",\"position\":[1880,-40],\"webhookId\":\"fa5e7641-068c-40cb-b490-a6809e74c629\",\"parameters\":{\"text\":\"=The current session is {{ $json.SESSION }}\",\"chatId\":\"={{ $('Get message').item.json.message.from.id }}\",\"additionalFields\":{\"appendAttribution\":false}},\"credentials\":{\"telegramApi\":{\"id\":\"rQ5q95W7uKesMDx4\",\"name\":\"Telegram account Fastewb\"}},\"typeVersion\":1.2},{\"id\":\"1a6b9065-154f-4c43-9406-110636884f3d\",\"name\":\"KO\",\"type\":\"n8n-nodes-base.telegram\",\"position\":[1880,-200],\"webhookId\":\"fa5e7641-068c-40cb-b490-a6809e74c629\",\"parameters\":{\"text\":\"=This session doesn't exist\",\"chatId\":\"={{ $('Get message').item.json.message.from.id }}\",\"additionalFields\":{\"appendAttribution\":false}},\"credentials\":{\"telegramApi\":{\"id\":\"rQ5q95W7uKesMDx4\",\"name\":\"Telegram account Fastewb\"}},\"typeVersion\":1.2},{\"id\":\"a2463ecc-fc82-401d-bf1b-6104f4b379e6\",\"name\":\"Trim resume\",\"type\":\"n8n-nodes-base.code\",\"position\":[820,-100],\"parameters\":{\"jsCode\":\"for (const item of $input.all()) {\\n  const text = item.json.text || '';\\n  const match = text.match(/\\\\/resume\\\\s+(.*)/);\\n\\n  if (match) {\\n    item.json.resume = match[1].trim();\\n  } else {\\n    item.json.resume = null; \\n  }\\n}\\n\\nreturn $input.all();\"},\"typeVersion\":2},{\"id\":\"c24a0c1d-290f-4e0c-8da9-98de14a65e2b\",\"name\":\"Get session1\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[600,200],\"parameters\":{\"options\":{},\"filtersUI\":{\"values\":[{\"lookupValue\":\"={{ $('Get session').item.json.SESSION }}\",\"lookupColumn\":\"SESSION\"}]},\"sheetName\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"gid=0\",\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1MCJLAqKP0Y7Qr68ZYoSSBeEVyKI1QgAAZnlEiyqkzXo/edit#gid=0\",\"cachedResultName\":\"Database\"},\"documentId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"1MCJLAqKP0Y7Qr68ZYoSSBeEVyKI1QgAAZnlEiyqkzXo\",\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1MCJLAqKP0Y7Qr68ZYoSSBeEVyKI1QgAAZnlEiyqkzXo/edit?usp=drivesdk\",\"cachedResultName\":\"Chatbot with session\"}},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"JYR6a64Qecd6t8Hb\",\"name\":\"Google Sheets account\"}},\"typeVersion\":4.5},{\"id\":\"84cc4b12-ab2b-4509-a2e3-1c4d952904c5\",\"name\":\"Prompt + Resume\",\"type\":\"n8n-nodes-base.code\",\"position\":[820,200],\"parameters\":{\"jsCode\":\"let fullText = '';\\n\\nfor (const item of $input.all()) {\\n  const prompt = item.json.PROMPT || '';\\n  const response = item.json.RESPONSE || '';\\n  fullText += `PROMPT: ${prompt}\\\\nRESPONSE: ${response}\\\\n`;\\n}\\nconst chat_id=$('Get message').first().json.message.from.id\\n\\nreturn [{ json: { fullText, chat_id } }];\\n\"},\"typeVersion\":2},{\"id\":\"3ae34388-95a0-41d7-8f20-7fa74817dab8\",\"name\":\"Send summary\",\"type\":\"n8n-nodes-base.telegram\",\"position\":[1420,200],\"webhookId\":\"fa5e7641-068c-40cb-b490-a6809e74c629\",\"parameters\":{\"text\":\"={{ $json.response.text }}\",\"chatId\":\"={{ $('Prompt + Resume').item.json.chat_id }}\",\"additionalFields\":{\"appendAttribution\":false}},\"credentials\":{\"telegramApi\":{\"id\":\"rQ5q95W7uKesMDx4\",\"name\":\"Telegram account Fastewb\"}},\"typeVersion\":1.2},{\"id\":\"d38eb058-29a3-4500-b6de-f700b8f501e9\",\"name\":\"Get message2\",\"type\":\"n8n-nodes-base.set\",\"position\":[620,600],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"56bf47bc-e84c-4cee-8aa0-927f3d2e31c5\",\"name\":\"text\",\"type\":\"string\",\"value\":\"={{ $('Get message').item.json.message.text }}\"}]}},\"typeVersion\":3.4},{\"id\":\"ee6713b5-6264-43e8-86a4-f9584049f05b\",\"name\":\"Trim question\",\"type\":\"n8n-nodes-base.code\",\"position\":[860,600],\"parameters\":{\"jsCode\":\"for (const item of $input.all()) {\\n  const text = item.json.text || '';\\n  const match = text.match(/\\\\/question\\\\s+(.*)/);\\n\\n  if (match) {\\n    item.json.question = match[1].trim();\\n  } else {\\n    item.json.question = null; // oppure \\\"\\\" se preferisci\\n  }\\n}\\n\\nreturn $input.all();\"},\"typeVersion\":2},{\"id\":\"65482069-1c41-4977-8f18-75f192866fdd\",\"name\":\"Set new current session\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[1280,-100],\"parameters\":{\"columns\":{\"value\":{\"STATE\":\"current\",\"SESSION\":\"={{ $('Trim resume').item.json.resume }}\"},\"schema\":[{\"id\":\"SESSION\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"SESSION\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"STATE\",\"type\":\"string\",\"display\":true,\"removed\":false,\"required\":false,\"displayName\":\"STATE\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"row_number\",\"type\":\"string\",\"display\":true,\"removed\":true,\"readOnly\":true,\"required\":false,\"displayName\":\"row_number\",\"defaultMatch\":false,\"canBeUsedToMatch\":true}],\"mappingMode\":\"defineBelow\",\"matchingColumns\":[\"SESSION\"],\"attemptToConvertTypes\":false,\"convertFieldsToString\":false},\"options\":{},\"operation\":\"update\",\"sheetName\":{\"__rl\":true,\"mode\":\"list\",\"value\":207843712,\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1MCJLAqKP0Y7Qr68ZYoSSBeEVyKI1QgAAZnlEiyqkzXo/edit#gid=207843712\",\"cachedResultName\":\"Session\"},\"documentId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"1MCJLAqKP0Y7Qr68ZYoSSBeEVyKI1QgAAZnlEiyqkzXo\",\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1MCJLAqKP0Y7Qr68ZYoSSBeEVyKI1QgAAZnlEiyqkzXo/edit?usp=drivesdk\",\"cachedResultName\":\"Chatbot with session\"}},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"JYR6a64Qecd6t8Hb\",\"name\":\"Google Sheets account\"}},\"notesInFlow\":false,\"typeVersion\":4.5,\"alwaysOutputData\":true},{\"id\":\"91ef2595-acca-4efd-8331-3450fa466d33\",\"name\":\"Response + Text\",\"type\":\"n8n-nodes-base.googleSheets\",\"position\":[1140,600],\"parameters\":{\"options\":{},\"filtersUI\":{\"values\":[{\"lookupValue\":\"={{ $('Get session').item.json.SESSION }}\",\"lookupColumn\":\"SESSION\"}]},\"sheetName\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"gid=0\",\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1MCJLAqKP0Y7Qr68ZYoSSBeEVyKI1QgAAZnlEiyqkzXo/edit#gid=0\",\"cachedResultName\":\"Database\"},\"documentId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"1MCJLAqKP0Y7Qr68ZYoSSBeEVyKI1QgAAZnlEiyqkzXo\",\"cachedResultUrl\":\"https://docs.google.com/spreadsheets/d/1MCJLAqKP0Y7Qr68ZYoSSBeEVyKI1QgAAZnlEiyqkzXo/edit?usp=drivesdk\",\"cachedResultName\":\"Chatbot with session\"}},\"credentials\":{\"googleSheetsOAuth2Api\":{\"id\":\"JYR6a64Qecd6t8Hb\",\"name\":\"Google Sheets account\"}},\"typeVersion\":4.5},{\"id\":\"2fbaf240-c01e-48dc-90bf-cc655eb7cd4d\",\"name\":\"fullText\",\"type\":\"n8n-nodes-base.code\",\"position\":[1440,600],\"parameters\":{\"jsCode\":\"let fullText = '';\\n\\nfor (const item of $input.all()) {\\n  const prompt = item.json.PROMPT || '';\\n  const response = item.json.RESPONSE || '';\\n  fullText += `PROMPT: ${prompt}\\\\nRESPONSE: ${response}\\\\n`;\\n}\\nconst chat_id=$('Get message').first().json.message.from.id;\\nconst question=$('Trim question').first().json.question;\\n\\nreturn [{ json: { fullText, chat_id, question } }];\\n\"},\"typeVersion\":2},{\"id\":\"30e29b4f-da86-4cee-b875-7985b5d82b7e\",\"name\":\"Send answer\",\"type\":\"n8n-nodes-base.telegram\",\"position\":[2080,600],\"webhookId\":\"fa5e7641-068c-40cb-b490-a6809e74c629\",\"parameters\":{\"text\":\"={{ $json.text }}\",\"chatId\":\"={{ $('fullText').item.json.chat_id }}\",\"additionalFields\":{\"appendAttribution\":false}},\"credentials\":{\"telegramApi\":{\"id\":\"rQ5q95W7uKesMDx4\",\"name\":\"Telegram account Fastewb\"}},\"typeVersion\":1.2},{\"id\":\"41e2b5b3-25a2-411c-929a-ad4c22f45cd1\",\"name\":\"Send current session\",\"type\":\"n8n-nodes-base.telegram\",\"position\":[620,-440],\"webhookId\":\"fa5e7641-068c-40cb-b490-a6809e74c629\",\"parameters\":{\"text\":\"=The current session is {{ $('Get session').item.json.SESSION }}\",\"chatId\":\"={{ $('Get message').item.json.message.from.id }}\",\"additionalFields\":{\"appendAttribution\":false}},\"credentials\":{\"telegramApi\":{\"id\":\"rQ5q95W7uKesMDx4\",\"name\":\"Telegram account Fastewb\"}},\"typeVersion\":1.2},{\"id\":\"e30bb12b-8e46-4fe4-81b7-72ce036d431f\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[640,-880],\"parameters\":{\"width\":580,\"height\":80,\"content\":\"## NEW SESSION\\n\"},\"typeVersion\":1},{\"id\":\"7e23ee2d-b4ee-4be8-969b-c713039dacdf\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[620,-560],\"parameters\":{\"width\":580,\"height\":80,\"content\":\"## GET CURRENT SESSION\\n\"},\"typeVersion\":1},{\"id\":\"5b10cf55-3730-4e0c-8db7-49c82e9b1350\",\"name\":\"Sticky Note3\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[600,-220],\"parameters\":{\"width\":580,\"height\":80,\"content\":\"## RESUME SESSION\\n\"},\"typeVersion\":1},{\"id\":\"f0932a2c-ebf2-4179-972a-073e5edfa50d\",\"name\":\"Sticky Note4\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[600,100],\"parameters\":{\"width\":580,\"height\":80,\"content\":\"## GET SUMMARY\\n\"},\"typeVersion\":1},{\"id\":\"9d9fdca4-870b-4ef4-9415-2fb750eb6466\",\"name\":\"Sticky Note5\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[620,500],\"parameters\":{\"width\":580,\"height\":80,\"content\":\"## SEND QUESTION\\n\"},\"typeVersion\":1},{\"id\":\"aa55d92a-ec31-42c3-8b17-fa9d81d99c31\",\"name\":\"Sticky Note6\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[640,860],\"parameters\":{\"width\":580,\"height\":80,\"content\":\"## CHATBOT\\n\"},\"typeVersion\":1},{\"id\":\"fa4dd49c-881b-41d2-84b4-82cbd3e62d0e\",\"name\":\"Telegram Chatbot\",\"type\":\"@n8n/n8n-nodes-langchain.agent\",\"position\":[640,980],\"parameters\":{\"text\":\"={{ $('Get message').item.json.message.text }}\",\"options\":{\"systemMessage\":\"=Sei un assitente virtuale:\\n\\nData e ora corrente: {{ $now }}\"},\"promptType\":\"define\"},\"typeVersion\":1.9}],\"active\":false,\"pinData\":{},\"settings\":{\"timezone\":\"Europe/Rome\",\"callerPolicy\":\"workflowsFromSameOwner\",\"executionOrder\":\"v1\",\"executionTimeout\":-1},\"versionId\":\"c6d418c0-aec9-498a-b5c7-318a3e4efe0b\",\"connections\":{\"Exist?\":{\"main\":[[{\"node\":\"KO\",\"type\":\"main\",\"index\":0}],[{\"node\":\"OK\",\"type\":\"main\",\"index\":0}]]},\"fullText\":{\"main\":[[{\"node\":\"Basic LLM Chain\",\"type\":\"main\",\"index\":0}]]},\"Get message\":{\"main\":[[{\"node\":\"Get session\",\"type\":\"main\",\"index\":0}]]},\"Get session\":{\"main\":[[{\"node\":\"Command or text?\",\"type\":\"main\",\"index\":0}]]},\"Trim resume\":{\"main\":[[{\"node\":\"Set to expire\",\"type\":\"main\",\"index\":0}]]},\"Get message1\":{\"main\":[[{\"node\":\"Trim resume\",\"type\":\"main\",\"index\":0}]]},\"Get message2\":{\"main\":[[{\"node\":\"Trim question\",\"type\":\"main\",\"index\":0}]]},\"Get session1\":{\"main\":[[{\"node\":\"Prompt + Resume\",\"type\":\"main\",\"index\":0}]]},\"Send response\":{\"main\":[[{\"node\":\"Update database\",\"type\":\"main\",\"index\":0}]]},\"Set to expire\":{\"main\":[[{\"node\":\"Set new current session\",\"type\":\"main\",\"index\":0}]]},\"Simple Memory\":{\"ai_memory\":[[{\"node\":\"Telegram Chatbot\",\"type\":\"ai_memory\",\"index\":0}]]},\"Trim question\":{\"main\":[[{\"node\":\"Response + Text\",\"type\":\"main\",\"index\":0}]]},\"Basic LLM Chain\":{\"main\":[[{\"node\":\"Send answer\",\"type\":\"main\",\"index\":0}]]},\"Prompt + Resume\":{\"main\":[[{\"node\":\"Summarization Chain\",\"type\":\"main\",\"index\":0}]]},\"Response + Text\":{\"main\":[[{\"node\":\"fullText\",\"type\":\"main\",\"index\":0}]]},\"Set new session\":{\"main\":[[{\"node\":\"Session activated\",\"type\":\"main\",\"index\":0}]]},\"Command or text?\":{\"main\":[[{\"node\":\"Disable previous session\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Send current session\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Get message1\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Get session1\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Get message2\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Telegram Chatbot\",\"type\":\"main\",\"index\":0}]]},\"Telegram Chatbot\":{\"main\":[[{\"node\":\"Send response\",\"type\":\"main\",\"index\":0}]]},\"OpenAI Chat Model\":{\"ai_languageModel\":[[{\"node\":\"Telegram Chatbot\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"OpenAI Chat Model1\":{\"ai_languageModel\":[[{\"node\":\"Summarization Chain\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"OpenAI Chat Model2\":{\"ai_languageModel\":[[{\"node\":\"Basic LLM Chain\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"Summarization Chain\":{\"main\":[[{\"node\":\"Send summary\",\"type\":\"main\",\"index\":0}]]},\"Set new current session\":{\"main\":[[{\"node\":\"Exist?\",\"type\":\"main\",\"index\":0}]]},\"Disable previous session\":{\"main\":[[{\"node\":\"Set new session\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "### **How It Works**\n\nThis workflow creates an **AI-powered Telegram chatbot** with **session management** , allowing users to:\n\n  * **Start new conversations** (`/new`).\n  * **Check current sessions** (`/current`).\n  * **Resume past sessions** (`/resume`).\n  * **Get summaries** (`/summary`).\n  * **Ask questions** (`/question`).\n\n\n\n**Key Components** :\n\n  * **Session Management** : \n    * Uses **Google Sheets** to track active/expired sessions (storing `SESSION` IDs and `STATE`).\n    * `/new` creates a session; `/resume` reactivates past ones.\n  * **AI Processing** : \n    * **OpenAI GPT-4** generates responses with **contextual memory** (via `Simple Memory` node).\n    * **Summarization** : Condenses past conversations when requested.\n  * **Data Logging** : \n    * All interactions (prompts/responses) are saved to Google Sheets for audit and retrieval.\n  * **User Interaction** : \n    * Telegram commands trigger specific actions (e.g., `/question [query]` fetches answers from session history).\n\n\n\n* * *\n\n### Main Advantages\n\n**1\\. Multi-session Handling**  \nEach user can create, manage, and switch between multiple sessions independently, perfect for organizing different conversations without confusion.\n\n**2\\. Persistent Memory**  \nConversations are stored in Google Sheets, ensuring that chat history and session states are preserved even if the server or n8n instance restarts.\n\n**3\\. Commands for Full Control**  \nWith intuitive commands like `/new`, `/current`, `/resume`, `/summary`, and `/question`, users can manage sessions easily without needing a web interface.\n\n**4\\. Smart Summarization and Q &A**  \nThanks to OpenAI models, the workflow can **summarize** entire conversations or **answer specific questions** about past discussions, saving time and improving the chatbot’s usability.\n\n**5\\. Easy Setup and Scalability**  \nBy using Google Sheets instead of a database, the workflow is easy to clone, modify, and deploy — ideal for quick prototyping or lightweight production uses.\n\n**6\\. Modular and Extensible**  \nEach logical block (new session, get current session, resume, summarize, ask question) is modular, making it easy to **extend** the workflow with additional features like analytics, personalized greetings, or integrations with CRM systems.\n\n* * *\n\n### **Setup Steps**\n\n##### **Prerequisites** :\n\n  * **Telegram Bot Token** : Create via [BotFather](https://core.telegram.org/bots#botfather).\n  * **Google Sheets** : \n    * Duplicate [this template](https://docs.google.com/spreadsheets/d/1MCJLAqKP0Y7Qr68ZYoSSBeEVyKI1QgAAZnlEiyqkzXo/edit).\n    * Two sheets: `Session` (active/inactive sessions) and `Database` (chat logs).\n  * **OpenAI API Key** : For GPT-4 responses.\n\n\n\n##### **Configuration** :\n\n  1. **Telegram Integration** :\n\n     * Add your bot token to the **Telegram Trigger** and **Telegram Send** nodes.\n  2. **Google Sheets Setup** :\n\n     * Authenticate the **Google Sheets nodes** with OAuth.\n     * Ensure sheet names (`Session`, `Database`) and column mappings match the template.\n  3. **OpenAI & Memory**:\n\n     * Add your API key to the **OpenAI Chat Model** nodes.\n     * Adjust `contextWindowLength` in the **Simple Memory** node for conversation history length.\n  4. **Testing** :\n\n     * Use Telegram commands to test: \n       * `/new`: Starts a session.\n       * `/question [query]`: Tests AI responses.\n       * `/summary`: Checks summarization.\n  5. **Deployment** :\n\n     * Activate the workflow; the bot will respond to Telegram messages in real-time.\n\n\n\n* * *\n\n### **Need help customizing?**\n\n[Contact me](mailto:info@n3w.it) for consulting and support or add me on [Linkedin](https://www.linkedin.com/in/davideboizza/).\n",
  "readme_html": "<!--[--><div data-v-50766329=\"\"><h3><strong>How It Works</strong></h3>\n<p>This workflow creates an <strong>AI-powered Telegram chatbot</strong> with <strong>session management</strong>, allowing users to:</p>\n<ul>\n<li><strong>Start new conversations</strong> (<code>/new</code>).</li>\n<li><strong>Check current sessions</strong> (<code>/current</code>).</li>\n<li><strong>Resume past sessions</strong> (<code>/resume</code>).</li>\n<li><strong>Get summaries</strong> (<code>/summary</code>).</li>\n<li><strong>Ask questions</strong> (<code>/question</code>).</li>\n</ul>\n<p><strong>Key Components</strong>:</p>\n<ul>\n<li><strong>Session Management</strong>:\n<ul>\n<li>Uses <strong>Google Sheets</strong> to track active/expired sessions (storing <code>SESSION</code> IDs and <code>STATE</code>).</li>\n<li><code>/new</code> creates a session; <code>/resume</code> reactivates past ones.</li>\n</ul>\n</li>\n<li><strong>AI Processing</strong>:\n<ul>\n<li><strong>OpenAI GPT-4</strong> generates responses with <strong>contextual memory</strong> (via <code>Simple Memory</code> node).</li>\n<li><strong>Summarization</strong>: Condenses past conversations when requested.</li>\n</ul>\n</li>\n<li><strong>Data Logging</strong>:\n<ul>\n<li>All interactions (prompts/responses) are saved to Google Sheets for audit and retrieval.</li>\n</ul>\n</li>\n<li><strong>User Interaction</strong>:\n<ul>\n<li>Telegram commands trigger specific actions (e.g., <code>/question [query]</code> fetches answers from session history).</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h3>Main Advantages</h3>\n<p><strong>1. Multi-session Handling</strong><br>\nEach user can create, manage, and switch between multiple sessions independently, perfect for organizing different conversations without confusion.</p>\n<p><strong>2. Persistent Memory</strong><br>\nConversations are stored in Google Sheets, ensuring that chat history and session states are preserved even if the server or n8n instance restarts.</p>\n<p><strong>3. Commands for Full Control</strong><br>\nWith intuitive commands like <code>/new</code>, <code>/current</code>, <code>/resume</code>, <code>/summary</code>, and <code>/question</code>, users can manage sessions easily without needing a web interface.</p>\n<p><strong>4. Smart Summarization and Q&amp;A</strong><br>\nThanks to OpenAI models, the workflow can <strong>summarize</strong> entire conversations or <strong>answer specific questions</strong> about past discussions, saving time and improving the chatbot’s usability.</p>\n<p><strong>5. Easy Setup and Scalability</strong><br>\nBy using Google Sheets instead of a database, the workflow is easy to clone, modify, and deploy — ideal for quick prototyping or lightweight production uses.</p>\n<p><strong>6. Modular and Extensible</strong><br>\nEach logical block (new session, get current session, resume, summarize, ask question) is modular, making it easy to <strong>extend</strong> the workflow with additional features like analytics, personalized greetings, or integrations with CRM systems.</p>\n<hr>\n<h3><strong>Setup Steps</strong></h3>\n<h5><strong>Prerequisites</strong>:</h5>\n<ul>\n<li><strong>Telegram Bot Token</strong>: Create via <a href=\"https://core.telegram.org/bots#botfather\" rel=\"ugc nofollow\" target=\"_blank\">BotFather</a>.</li>\n<li><strong>Google Sheets</strong>:\n<ul>\n<li>Duplicate <a href=\"https://docs.google.com/spreadsheets/d/1MCJLAqKP0Y7Qr68ZYoSSBeEVyKI1QgAAZnlEiyqkzXo/edit\" rel=\"ugc nofollow\" target=\"_blank\">this template</a>.</li>\n<li>Two sheets: <code>Session</code> (active/inactive sessions) and <code>Database</code> (chat logs).</li>\n</ul>\n</li>\n<li><strong>OpenAI API Key</strong>: For GPT-4 responses.</li>\n</ul>\n<h5><strong>Configuration</strong>:</h5>\n<ol>\n<li>\n<p><strong>Telegram Integration</strong>:</p>\n<ul>\n<li>Add your bot token to the <strong>Telegram Trigger</strong> and <strong>Telegram Send</strong> nodes.</li>\n</ul>\n</li>\n<li>\n<p><strong>Google Sheets Setup</strong>:</p>\n<ul>\n<li>Authenticate the <strong>Google Sheets nodes</strong> with OAuth.</li>\n<li>Ensure sheet names (<code>Session</code>, <code>Database</code>) and column mappings match the template.</li>\n</ul>\n</li>\n<li>\n<p><strong>OpenAI &amp; Memory</strong>:</p>\n<ul>\n<li>Add your API key to the <strong>OpenAI Chat Model</strong> nodes.</li>\n<li>Adjust <code>contextWindowLength</code> in the <strong>Simple Memory</strong> node for conversation history length.</li>\n</ul>\n</li>\n<li>\n<p><strong>Testing</strong>:</p>\n<ul>\n<li>Use Telegram commands to test:\n<ul>\n<li><code>/new</code>: Starts a session.</li>\n<li><code>/question [query]</code>: Tests AI responses.</li>\n<li><code>/summary</code>: Checks summarization.</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><strong>Deployment</strong>:</p>\n<ul>\n<li>Activate the workflow; the bot will respond to Telegram messages in real-time.</li>\n</ul>\n</li>\n</ol>\n<hr>\n<h3><strong>Need help customizing?</strong></h3>\n<p><a href=\"mailto:info@n3w.it\" rel=\"ugc nofollow\">Contact me</a> for consulting and support or add me on <a href=\"https://www.linkedin.com/in/davideboizza/\" rel=\"ugc nofollow\" target=\"_blank\">Linkedin</a>.</p>\n</div><!--]-->",
  "readme_zh": "### **运作原理**\n\n该工作流构建了一个**支持会话管理的AI驱动Telegram聊天机器人**，用户可实现以下功能：\n\n  * **开启新对话** (`/new`)\n  * **查看当前会话** (`/current`)\n  * **恢复历史会话** (`/resume`)\n  * **获取摘要** (`/summary`)\n  * **提出问题** (`/question`)",
  "title_zh": "使用GPT-4o-mini和Google Sheets创建基于会话的Telegram聊天机器人",
  "publish_date_zh": "上次更新于5天前",
  "workflow_json_zh": "{\n  \"id\": \"A7dRnMf9WybO8O02\",\n  \"meta\": {\n    \"instanceId\": \"a4bfc93e975ca233ac45ed7c9227d84cf5a2329310525917adaf3312e10d5462\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"name\": \"Telegram ChatBot with multiple sessions\",\n  \"tags\": [],\n  \"nodes\": [\n    {\n      \"id\": \"d3104851-90ec-4f0c-ab4d-aee5a6faf81b\",\n      \"name\": \"OpenAI Chat Model\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\n      \"position\": [\n        640,\n        1180\n      ],\n      \"parameters\": {\n        \"model\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"gpt-4o-mini\"\n        },\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"4zwP0MSr8zkNvvV9\",\n          \"name\": \"OpenAi account\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"e25050a1-e49b-4b46-8452-ce7b3388c7f3\",\n      \"name\": \"Simple Memory\",\n      \"type\": \"@n8n/n8n-nodes-langchain.memoryBufferWindow\",\n      \"position\": [\n        780,\n        1180\n      ],\n      \"parameters\": {\n        \"sessionKey\": \"={{ $('Get session').item.json.SESSION }}\",\n        \"sessionIdType\": \"customKey\",\n        \"contextWindowLength\": 100\n      },\n      \"typeVersion\": 1.3\n    },\n    {\n      \"id\": \"d50951ae-e9a2-492c-8ff5-a039ca6975e4\",\n      \"name\": \"Get message\",\n      \"type\": \"n8n-nodes-base.telegramTrigger\",\n      \"position\": [\n        -520,\n        -60\n      ],\n      \"webhookId\": \"8d87dcf7-1608-4255-a1f1-03b700a42f0e\",\n      \"parameters\": {\n        \"updates\": [\n          \"message\"\n        ],\n        \"additionalFields\": {}\n      },\n      \"credentials\": {\n        \"telegramApi\": {\n          \"id\": \"rQ5q95W7uKesMDx4\",\n          \"name\": \"Telegram account Fastewb\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"1bc9aa0f-8af8-47b8-b7d7-6bfd9280b65f\",\n      \"name\": \"Command or text?\",\n      \"type\": \"n8n-nodes-base.switch\",\n      \"position\": [\n        -20,\n        -60\n      ],\n      \"parameters\": {\n        \"rules\": {\n          \"values\": [\n            {\n              \"outputKey\": \"New session\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"955f3c39-0732-4a63-b3f7-70ab0753a68a\",\n                    \"operator\": {\n                      \"type\": \"string\",\n                      \"operation\": \"startsWith\"\n                    },\n                    \"leftValue\": \"={{ $('Get message').item.json.message.text }}\",\n                    \"rightValue\": \"/new\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            },\n            {\n              \"outputKey\": \"Current session\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"790f64bc-f3cc-4ef4-9d43-80853742fee6\",\n                    \"operator\": {\n                      \"type\": \"string\",\n                      \"operation\": \"startsWith\"\n                    },\n                    \"leftValue\": \"={{ $('Get message').item.json.message.text }}\",\n                    \"rightValue\": \"/current\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            },\n            {\n              \"outputKey\": \"Resume session\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"39f35352-aee4-4a16-b82f-7f58ab8120f0\",\n                    \"operator\": {\n                      \"type\": \"string\",\n                      \"operation\": \"startsWith\"\n                    },\n                    \"leftValue\": \"={{ $('Get message').item.json.message.text }}\",\n                    \"rightValue\": \"/resume\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            },\n            {\n              \"outputKey\": \"Summary \",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"270d71bf-8ecf-46e7-a601-cc5d1dc58e72\",\n                    \"operator\": {\n                      \"name\": \"filter.operator.equals\",\n                      \"type\": \"string\",\n                      \"operation\": \"equals\"\n                    },\n                    \"leftValue\": \"={{ $('Get message').item.json.message.text }}\",\n                    \"rightValue\": \"/summary\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            },\n            {\n              \"outputKey\": \"Question\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"55fe98fa-e39a-41b3-983f-359a8e730f21\",\n                    \"operator\": {\n                      \"type\": \"string\",\n                      \"operation\": \"startsWith\"\n                    },\n                    \"leftValue\": \"={{ $('Get message').item.json.message.text }}\",\n                    \"rightValue\": \"/question\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            }\n          ]\n        },\n        \"options\": {\n          \"fallbackOutput\": \"extra\"\n        }\n      },\n      \"typeVersion\": 3.2\n    },\n    {\n      \"id\": \"4a405332-99a8-4ec9-84d5-89f9f5f1610f\",\n      \"name\": \"Get session\",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"position\": [\n        -260,\n        -60\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"returnFirstMatch\": true\n        },\n        \"filtersUI\": {\n          \"values\": [\n            {\n              \"lookupValue\": \"current\",\n              \"lookupColumn\": \"STATE\"\n            }\n          ]\n        },\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": 207843712,\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1MCJLAqKP0Y7Qr68ZYoSSBeEVyKI1QgAAZnlEiyqkzXo/edit#gid=207843712\",\n          \"cachedResultName\": \"Session\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"1MCJLAqKP0Y7Qr68ZYoSSBeEVyKI1QgAAZnlEiyqkzXo\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1MCJLAqKP0Y7Qr68ZYoSSBeEVyKI1QgAAZnlEiyqkzXo/edit?usp=drivesdk\",\n          \"cachedResultName\": \"Chatbot with session\"\n        }\n      },\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"JYR6a64Qecd6t8Hb\",\n          \"name\": \"Google Sheets account\"\n        }\n      },\n      \"typeVersion\": 4.5\n    },\n    {\n      \"id\": \"860fa8d5-6c9b-476b-857b-9c47a023d72f\",\n      \"name\": \"Disable previous session\",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"position\": [\n        640,\n        -760\n      ],\n      \"parameters\": {\n        \"columns\": {\n          \"value\": {\n            \"STATE\": \"expire\",\n            \"SESSION\": \"={{ $('Get session').item.json.SESSION }}\"\n          },\n          \"schema\": [\n            {\n              \"id\": \"SESSION\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"SESSION\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"STATE\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"STATE\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"row_number\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": true,\n              \"readOnly\": true,\n              \"required\": false,\n              \"displayName\": \"row_number\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            }\n          ],\n          \"mappingMode\": \"defineBelow\",\n          \"matchingColumns\": [\n            \"SESSION\"\n          ],\n          \"attemptToConvertTypes\": false,\n          \"convertFieldsToString\": false\n        },\n        \"options\": {},\n        \"operation\": \"update\",\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": 207843712,\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1MCJLAqKP0Y7Qr68ZYoSSBeEVyKI1QgAAZnlEiyqkzXo/edit#gid=207843712\",\n          \"cachedResultName\": \"Session\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"1MCJLAqKP0Y7Qr68ZYoSSBeEVyKI1QgAAZnlEiyqkzXo\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1MCJLAqKP0Y7Qr68ZYoSSBeEVyKI1QgAAZnlEiyqkzXo/edit?usp=drivesdk\",\n          \"cachedResultName\": \"Chatbot with session\"\n        }\n      },\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"JYR6a64Qecd6t8Hb\",\n          \"name\": \"Google Sheets account\"\n        }\n      },\n      \"typeVersion\": 4.5\n    },\n    {\n      \"id\": \"6ff1cf54-5406-4c86-a77e-8424208d4728\",\n      \"name\": \"Set new session\",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"position\": [\n        960,\n        -760\n      ],\n      \"parameters\": {\n        \"columns\": {\n          \"value\": {\n            \"STATE\": \"current\",\n            \"SESSION\": \"={{ $('Get message').item.json.update_id }}\"\n          },\n          \"schema\": [\n            {\n              \"id\": \"SESSION\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"SESSION\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"STATE\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"STATE\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            }\n          ],\n          \"mappingMode\": \"defineBelow\",\n          \"matchingColumns\": [],\n          \"attemptToConvertTypes\": false,\n          \"convertFieldsToString\": false\n        },\n        \"options\": {},\n        \"operation\": \"append\",\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": 207843712,\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1MCJLAqKP0Y7Qr68ZYoSSBeEVyKI1QgAAZnlEiyqkzXo/edit#gid=207843712\",\n          \"cachedResultName\": \"Session\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"1MCJLAqKP0Y7Qr68ZYoSSBeEVyKI1QgAAZnlEiyqkzXo\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1MCJLAqKP0Y7Qr68ZYoSSBeEVyKI1QgAAZnlEiyqkzXo/edit?usp=drivesdk\",\n          \"cachedResultName\": \"Chatbot with session\"\n        }\n      },\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"JYR6a64Qecd6t8Hb\",\n          \"name\": \"Google Sheets account\"\n        }\n      },\n      \"typeVersion\": 4.5\n    },\n    {\n      \"id\": \"be9c755a-0c52-453c-b448-98975d4c6e87\",\n      \"name\": \"Session activated\",\n      \"type\": \"n8n-nodes-base.telegram\",\n      \"position\": [\n        1240,\n        -760\n      ],\n      \"webhookId\": \"fa5e7641-068c-40cb-b490-a6809e74c629\",\n      \"parameters\": {\n        \"text\": \"New session activated\",\n        \"chatId\": \"={{ $('Get message').item.json.message.from.id }}\",\n        \"additionalFields\": {\n          \"appendAttribution\": false\n        }\n      },\n      \"credentials\": {\n        \"telegramApi\": {\n          \"id\": \"rQ5q95W7uKesMDx4\",\n          \"name\": \"Telegram account Fastewb\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"31478ec5-c1de-43db-ac9d-9b34f68e951c\",\n      \"name\": \"Send response\",\n      \"type\": \"n8n-nodes-base.telegram\",\n      \"position\": [\n        1100,\n        980\n      ],\n      \"webhookId\": \"fa5e7641-068c-40cb-b490-a6809e74c629\",\n      \"parameters\": {\n        \"text\": \"={{ $json.output }}\",\n        \"chatId\": \"={{ $('Get message').item.json.message.from.id }}\",\n        \"additionalFields\": {\n          \"appendAttribution\": false\n        }\n      },\n      \"credentials\": {\n        \"telegramApi\": {\n          \"id\": \"rQ5q95W7uKesMDx4\",\n          \"name\": \"Telegram account Fastewb\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"be35b9a6-2914-409f-bc9c-6199ccb9e4ed\",\n      \"name\": \"Update database\",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"position\": [\n        1420,\n        980\n      ],\n      \"parameters\": {\n        \"columns\": {\n          \"value\": {\n            \"DATE\": \"={{$now}}\",\n            \"PROMPT\": \"={{ $('Get message').item.json.message.text }}\",\n            \"SESSION\": \"={{ $('Get session').item.json.SESSION }}\",\n            \"RESPONSE\": \"={{ $('Telegram Chatbot').item.json.output }}\"\n          },\n          \"schema\": [\n            {\n              \"id\": \"SESSION\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"SESSION\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"DATE\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"DATE\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"PROMPT\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"PROMPT\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"RESPONSE\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"RESPONSE\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            }\n          ],\n          \"mappingMode\": \"defineBelow\",\n          \"matchingColumns\": [],\n          \"attemptToConvertTypes\": false,\n          \"convertFieldsToString\": false\n        },\n        \"options\": {},\n        \"operation\": \"append\",\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"gid=0\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1MCJLAqKP0Y7Qr68ZYoSSBeEVyKI1QgAAZnlEiyqkzXo/edit#gid=0\",\n          \"cachedResultName\": \"Database\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"1MCJLAqKP0Y7Qr68ZYoSSBeEVyKI1QgAAZnlEiyqkzXo\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1MCJLAqKP0Y7Qr68ZYoSSBeEVyKI1QgAAZnlEiyqkzXo/edit?usp=drivesdk\",\n          \"cachedResultName\": \"Chatbot with session\"\n        }\n      },\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"JYR6a64Qecd6t8Hb\",\n          \"name\": \"Google Sheets account\"\n        }\n      },\n      \"typeVersion\": 4.5\n    },\n    {\n      \"id\": \"dacc79e0-56ff-47d6-b09f-16ebfb31cbfa\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -540,\n        -540\n      ],\n      \"parameters\": {\n        \"color\": 3,\n        \"width\": 620,\n        \"height\": 360,\n        \"content\": \"# 支持多会话的Telegram聊天机器人\\n\\n此工作流创建了一个具备**会话管理功能**的**AI驱动的Telegram聊天机器人**，用户可进行以下操作：  \\n- **开启新对话** (`/new`)  \\n- **查看当前会话** (`/current`)  \\n- **恢复历史会话** (`/resume`)  \\n- **获取摘要** (`/summary`)  \\n- **提出问题** (`/question`)  \\n\\n- 复制[此表格](https://docs.google.com/spreadsheets/d/1MCJLAqKP0Y7Qr68ZYoSSBeEVyKI1QgAAZnlEiyqkzXo/edit?usp=sharing)\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"55751f99-ee2e-429b-99cd-fef30eb56fb8\",\n      \"name\": \"Summarization Chain\",\n      \"type\": \"@n8n/n8n-nodes-langchain.chainSummarization\",\n      \"position\": [\n        1040,\n        200\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"summarizationMethodAndPrompts\": {\n            \"values\": {\n              \"prompt\": \"=Write a concise summary of the following:\\n\\n\\n\\\"{{ $json.fullText }}\\\"\\n\\n\\nCONCISE SUMMARY:\",\n              \"combineMapPrompt\": \"=Write a concise summary of the following:\\n\\n\\n\\\"{{ $json.fullText }}\\\"\\n\\n\\nCONCISE SUMMARY:\"\n            }\n          }\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"c7f0d136-4a77-4bc8-b2ef-b03fa41ad1ff\",\n      \"name\": \"OpenAI Chat Model1\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\n      \"position\": [\n        1020,\n        380\n      ],\n      \"parameters\": {\n        \"model\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"gpt-4o-mini\"\n        },\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"4zwP0MSr8zkNvvV9\",\n          \"name\": \"OpenAi account\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"a455cf00-2f72-4377-ac2a-d65ab8c30e31\",\n      \"name\": \"OpenAI Chat Model2\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\n      \"position\": [\n        1660,\n        800\n      ],\n      \"parameters\": {\n        \"model\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"gpt-4o-mini\"\n        },\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"4zwP0MSr8zkNvvV9\",\n          \"name\": \"OpenAi account\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"e55082e4-4e65-4fbb-8850-d3b64093eab6\",\n      \"name\": \"Basic LLM Chain\",\n      \"type\": \"@n8n/n8n-nodes-langchain.chainLlm\",\n      \"position\": [\n        1680,\n        600\n      ],\n      \"parameters\": {\n        \"text\": \"=Question:\\n{{ $json.question }}\",\n        \"messages\": {\n          \"messageValues\": [\n            {\n              \"message\": \"=You have to answer the questions that are asked by analyzing the following text:\\n\\n{{ $json.fullText }}\"\n            }\n          ]\n        },\n        \"promptType\": \"define\"\n      },\n      \"typeVersion\": 1.6\n    },\n    {\n      \"id\": \"1e670eaa-fd9f-4e79-b2a8-bd43240455db\",\n      \"name\": \"Get message1\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        600,\n        -100\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"56bf47bc-e84c-4cee-8aa0-927f3d2e31c5\",\n              \"name\": \"text\",\n              \"type\": \"string\",\n              \"value\": \"={{ $('Get message').item.json.message.text }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"65771b1e-47fc-439d-a1ea-9901bac047d8\",\n      \"name\": \"Set to expire\",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"position\": [\n        1040,\n        -100\n      ],\n      \"parameters\": {\n        \"columns\": {\n          \"value\": {\n            \"STATE\": \"expire\",\n            \"SESSION\": \"={{ $('Get session').item.json.SESSION }}\"\n          },\n          \"schema\": [\n            {\n              \"id\": \"SESSION\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"SESSION\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"STATE\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"STATE\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"row_number\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": true,\n              \"readOnly\": true,\n              \"required\": false,\n              \"displayName\": \"row_number\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            }\n          ],\n          \"mappingMode\": \"defineBelow\",\n          \"matchingColumns\": [\n            \"SESSION\"\n          ],\n          \"attemptToConvertTypes\": false,\n          \"convertFieldsToString\": false\n        },\n        \"options\": {},\n        \"operation\": \"update\",\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": 207843712,\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1MCJLAqKP0Y7Qr68ZYoSSBeEVyKI1QgAAZnlEiyqkzXo/edit#gid=207843712\",\n          \"cachedResultName\": \"Session\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"1MCJLAqKP0Y7Qr68ZYoSSBeEVyKI1QgAAZnlEiyqkzXo\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1MCJLAqKP0Y7Qr68ZYoSSBeEVyKI1QgAAZnlEiyqkzXo/edit?usp=drivesdk\",\n          \"cachedResultName\": \"Chatbot with session\"\n        }\n      },\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"JYR6a64Qecd6t8Hb\",\n          \"name\": \"Google Sheets account\"\n        }\n      },\n      \"typeVersion\": 4.5\n    },\n    {\n      \"id\": \"d18268f6-8792-4a66-aa32-35b596e7fcad\",\n      \"name\": \"Exist?\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        1540,\n        -100\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"1710e38c-80d1-49ba-9814-2b2c6b3c3b8d\",\n              \"operator\": {\n                \"type\": \"object\",\n                \"operation\": \"empty\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json }}\",\n              \"rightValue\": \"\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"6eeb7e4d-8af0-4d71-981d-66a39f4870a3\",\n      \"name\": \"OK\",\n      \"type\": \"n8n-nodes-base.telegram\",\n      \"position\": [\n        1880,\n        -40\n      ],\n      \"webhookId\": \"fa5e7641-068c-40cb-b490-a6809e74c629\",\n      \"parameters\": {\n        \"text\": \"=The current session is {{ $json.SESSION }}\",\n        \"chatId\": \"={{ $('Get message').item.json.message.from.id }}\",\n        \"additionalFields\": {\n          \"appendAttribution\": false\n        }\n      },\n      \"credentials\": {\n        \"telegramApi\": {\n          \"id\": \"rQ5q95W7uKesMDx4\",\n          \"name\": \"Telegram account Fastewb\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"1a6b9065-154f-4c43-9406-110636884f3d\",\n      \"name\": \"KO\",\n      \"type\": \"n8n-nodes-base.telegram\",\n      \"position\": [\n        1880,\n        -200\n      ],\n      \"webhookId\": \"fa5e7641-068c-40cb-b490-a6809e74c629\",\n      \"parameters\": {\n        \"text\": \"=This session doesn't exist\",\n        \"chatId\": \"={{ $('Get message').item.json.message.from.id }}\",\n        \"additionalFields\": {\n          \"appendAttribution\": false\n        }\n      },\n      \"credentials\": {\n        \"telegramApi\": {\n          \"id\": \"rQ5q95W7uKesMDx4\",\n          \"name\": \"Telegram account Fastewb\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"a2463ecc-fc82-401d-bf1b-6104f4b379e6\",\n      \"name\": \"Trim resume\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        820,\n        -100\n      ],\n      \"parameters\": {\n        \"jsCode\": \"for (const item of $input.all()) {\\n  const text = item.json.text || '';\\n  const match = text.match(/\\\\/resume\\\\s+(.*)/);\\n\\n  if (match) {\\n    item.json.resume = match[1].trim();\\n  } else {\\n    item.json.resume = null; \\n  }\\n}\\n\\nreturn $input.all();\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"c24a0c1d-290f-4e0c-8da9-98de14a65e2b\",\n      \"name\": \"Get session1\",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"position\": [\n        600,\n        200\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"filtersUI\": {\n          \"values\": [\n            {\n              \"lookupValue\": \"={{ $('Get session').item.json.SESSION }}\",\n              \"lookupColumn\": \"SESSION\"\n            }\n          ]\n        },\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"gid=0\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1MCJLAqKP0Y7Qr68ZYoSSBeEVyKI1QgAAZnlEiyqkzXo/edit#gid=0\",\n          \"cachedResultName\": \"Database\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"1MCJLAqKP0Y7Qr68ZYoSSBeEVyKI1QgAAZnlEiyqkzXo\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1MCJLAqKP0Y7Qr68ZYoSSBeEVyKI1QgAAZnlEiyqkzXo/edit?usp=drivesdk\",\n          \"cachedResultName\": \"Chatbot with session\"\n        }\n      },\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"JYR6a64Qecd6t8Hb\",\n          \"name\": \"Google Sheets account\"\n        }\n      },\n      \"typeVersion\": 4.5\n    },\n    {\n      \"id\": \"84cc4b12-ab2b-4509-a2e3-1c4d952904c5\",\n      \"name\": \"Prompt + Resume\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        820,\n        200\n      ],\n      \"parameters\": {\n        \"jsCode\": \"let fullText = '';\\n\\nfor (const item of $input.all()) {\\n  const prompt = item.json.PROMPT || '';\\n  const response = item.json.RESPONSE || '';\\n  fullText += `PROMPT: ${prompt}\\\\nRESPONSE: ${response}\\\\n`;\\n}\\nconst chat_id=$('Get message').first().json.message.from.id\\n\\nreturn [{ json: { fullText, chat_id } }];\\n\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"3ae34388-95a0-41d7-8f20-7fa74817dab8\",\n      \"name\": \"Send summary\",\n      \"type\": \"n8n-nodes-base.telegram\",\n      \"position\": [\n        1420,\n        200\n      ],\n      \"webhookId\": \"fa5e7641-068c-40cb-b490-a6809e74c629\",\n      \"parameters\": {\n        \"text\": \"={{ $json.response.text }}\",\n        \"chatId\": \"={{ $('Prompt + Resume').item.json.chat_id }}\",\n        \"additionalFields\": {\n          \"appendAttribution\": false\n        }\n      },\n      \"credentials\": {\n        \"telegramApi\": {\n          \"id\": \"rQ5q95W7uKesMDx4\",\n          \"name\": \"Telegram account Fastewb\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"d38eb058-29a3-4500-b6de-f700b8f501e9\",\n      \"name\": \"Get message2\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        620,\n        600\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"56bf47bc-e84c-4cee-8aa0-927f3d2e31c5\",\n              \"name\": \"text\",\n              \"type\": \"string\",\n              \"value\": \"={{ $('Get message').item.json.message.text }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"ee6713b5-6264-43e8-86a4-f9584049f05b\",\n      \"name\": \"Trim question\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        860,\n        600\n      ],\n      \"parameters\": {\n        \"jsCode\": \"for (const item of $input.all()) {\\n  const text = item.json.text || '';\\n  const match = text.match(/\\\\/question\\\\s+(.*)/);\\n\\n  if (match) {\\n    item.json.question = match[1].trim();\\n  } else {\\n    item.json.question = null; // oppure \\\"\\\" se preferisci\\n  }\\n}\\n\\nreturn $input.all();\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"65482069-1c41-4977-8f18-75f192866fdd\",\n      \"name\": \"Set new current session\",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"position\": [\n        1280,\n        -100\n      ],\n      \"parameters\": {\n        \"columns\": {\n          \"value\": {\n            \"STATE\": \"current\",\n            \"SESSION\": \"={{ $('Trim resume').item.json.resume }}\"\n          },\n          \"schema\": [\n            {\n              \"id\": \"SESSION\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"SESSION\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"STATE\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"required\": false,\n              \"displayName\": \"STATE\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"row_number\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": true,\n              \"readOnly\": true,\n              \"required\": false,\n              \"displayName\": \"row_number\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            }\n          ],\n          \"mappingMode\": \"defineBelow\",\n          \"matchingColumns\": [\n            \"SESSION\"\n          ],\n          \"attemptToConvertTypes\": false,\n          \"convertFieldsToString\": false\n        },\n        \"options\": {},\n        \"operation\": \"update\",\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": 207843712,\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1MCJLAqKP0Y7Qr68ZYoSSBeEVyKI1QgAAZnlEiyqkzXo/edit#gid=207843712\",\n          \"cachedResultName\": \"Session\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"1MCJLAqKP0Y7Qr68ZYoSSBeEVyKI1QgAAZnlEiyqkzXo\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1MCJLAqKP0Y7Qr68ZYoSSBeEVyKI1QgAAZnlEiyqkzXo/edit?usp=drivesdk\",\n          \"cachedResultName\": \"Chatbot with session\"\n        }\n      },\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"JYR6a64Qecd6t8Hb\",\n          \"name\": \"Google Sheets account\"\n        }\n      },\n      \"notesInFlow\": false,\n      \"typeVersion\": 4.5,\n      \"alwaysOutputData\": true\n    },\n    {\n      \"id\": \"91ef2595-acca-4efd-8331-3450fa466d33\",\n      \"name\": \"Response + Text\",\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"position\": [\n        1140,\n        600\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"filtersUI\": {\n          \"values\": [\n            {\n              \"lookupValue\": \"={{ $('Get session').item.json.SESSION }}\",\n              \"lookupColumn\": \"SESSION\"\n            }\n          ]\n        },\n        \"sheetName\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"gid=0\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1MCJLAqKP0Y7Qr68ZYoSSBeEVyKI1QgAAZnlEiyqkzXo/edit#gid=0\",\n          \"cachedResultName\": \"Database\"\n        },\n        \"documentId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"1MCJLAqKP0Y7Qr68ZYoSSBeEVyKI1QgAAZnlEiyqkzXo\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1MCJLAqKP0Y7Qr68ZYoSSBeEVyKI1QgAAZnlEiyqkzXo/edit?usp=drivesdk\",\n          \"cachedResultName\": \"Chatbot with session\"\n        }\n      },\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"JYR6a64Qecd6t8Hb\",\n          \"name\": \"Google Sheets account\"\n        }\n      },\n      \"typeVersion\": 4.5\n    },\n    {\n      \"id\": \"2fbaf240-c01e-48dc-90bf-cc655eb7cd4d\",\n      \"name\": \"fullText\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        1440,\n        600\n      ],\n      \"parameters\": {\n        \"jsCode\": \"let fullText = '';\\n\\nfor (const item of $input.all()) {\\n  const prompt = item.json.PROMPT || '';\\n  const response = item.json.RESPONSE || '';\\n  fullText += `PROMPT: ${prompt}\\\\nRESPONSE: ${response}\\\\n`;\\n}\\nconst chat_id=$('Get message').first().json.message.from.id;\\nconst question=$('Trim question').first().json.question;\\n\\nreturn [{ json: { fullText, chat_id, question } }];\\n\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"30e29b4f-da86-4cee-b875-7985b5d82b7e\",\n      \"name\": \"Send answer\",\n      \"type\": \"n8n-nodes-base.telegram\",\n      \"position\": [\n        2080,\n        600\n      ],\n      \"webhookId\": \"fa5e7641-068c-40cb-b490-a6809e74c629\",\n      \"parameters\": {\n        \"text\": \"={{ $json.text }}\",\n        \"chatId\": \"={{ $('fullText').item.json.chat_id }}\",\n        \"additionalFields\": {\n          \"appendAttribution\": false\n        }\n      },\n      \"credentials\": {\n        \"telegramApi\": {\n          \"id\": \"rQ5q95W7uKesMDx4\",\n          \"name\": \"Telegram account Fastewb\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"41e2b5b3-25a2-411c-929a-ad4c22f45cd1\",\n      \"name\": \"Send current session\",\n      \"type\": \"n8n-nodes-base.telegram\",\n      \"position\": [\n        620,\n        -440\n      ],\n      \"webhookId\": \"fa5e7641-068c-40cb-b490-a6809e74c629\",\n      \"parameters\": {\n        \"text\": \"=The current session is {{ $('Get session').item.json.SESSION }}\",\n        \"chatId\": \"={{ $('Get message').item.json.message.from.id }}\",\n        \"additionalFields\": {\n          \"appendAttribution\": false\n        }\n      },\n      \"credentials\": {\n        \"telegramApi\": {\n          \"id\": \"rQ5q95W7uKesMDx4\",\n          \"name\": \"Telegram account Fastewb\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"e30bb12b-8e46-4fe4-81b7-72ce036d431f\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        640,\n        -880\n      ],\n      \"parameters\": {\n        \"width\": 580,\n        \"height\": 80,\n        \"content\": \"## 新会话\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"7e23ee2d-b4ee-4be8-969b-c713039dacdf\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        620,\n        -560\n      ],\n      \"parameters\": {\n        \"width\": 580,\n        \"height\": 80,\n        \"content\": \"## 获取当前会话\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"5b10cf55-3730-4e0c-8db7-49c82e9b1350\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        600,\n        -220\n      ],\n      \"parameters\": {\n        \"width\": 580,\n        \"height\": 80,\n        \"content\": \"## 恢复会话\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"f0932a2c-ebf2-4179-972a-073e5edfa50d\",\n      \"name\": \"Sticky Note4\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        600,\n        100\n      ],\n      \"parameters\": {\n        \"width\": 580,\n        \"height\": 80,\n        \"content\": \"## 获取摘要\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"9d9fdca4-870b-4ef4-9415-2fb750eb6466\",\n      \"name\": \"Sticky Note5\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        620,\n        500\n      ],\n      \"parameters\": {\n        \"width\": 580,\n        \"height\": 80,\n        \"content\": \"## 发送问题\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"aa55d92a-ec31-42c3-8b17-fa9d81d99c31\",\n      \"name\": \"Sticky Note6\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        640,\n        860\n      ],\n      \"parameters\": {\n        \"width\": 580,\n        \"height\": 80,\n        \"content\": \"## 聊天机器人\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"fa4dd49c-881b-41d2-84b4-82cbd3e62d0e\",\n      \"name\": \"Telegram Chatbot\",\n      \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n      \"position\": [\n        640,\n        980\n      ],\n      \"parameters\": {\n        \"text\": \"={{ $('Get message').item.json.message.text }}\",\n        \"options\": {\n          \"systemMessage\": \"=Sei un assitente virtuale:\\n\\nData e ora corrente: {{ $now }}\"\n        },\n        \"promptType\": \"define\"\n      },\n      \"typeVersion\": 1.9\n    }\n  ],\n  \"active\": false,\n  \"pinData\": {},\n  \"settings\": {\n    \"timezone\": \"Europe/Rome\",\n    \"callerPolicy\": \"workflowsFromSameOwner\",\n    \"executionOrder\": \"v1\",\n    \"executionTimeout\": -1\n  },\n  \"versionId\": \"c6d418c0-aec9-498a-b5c7-318a3e4efe0b\",\n  \"connections\": {\n    \"Exist?\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"KO\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"OK\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"fullText\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Basic LLM Chain\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get message\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get session\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get session\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Command or text?\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Trim resume\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Set to expire\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get message1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Trim resume\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get message2\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Trim question\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get session1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Prompt + Resume\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Send response\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Update database\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Set to expire\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Set new current session\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Simple Memory\": {\n      \"ai_memory\": [\n        [\n          {\n            \"node\": \"Telegram Chatbot\",\n            \"type\": \"ai_memory\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Trim question\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Response + Text\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Basic LLM Chain\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Send answer\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Prompt + Resume\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Summarization Chain\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Response + Text\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"fullText\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Set new session\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Session activated\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Command or text?\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Disable previous session\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Send current session\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Get message1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Get session1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Get message2\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Telegram Chatbot\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Telegram Chatbot\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Send response\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"OpenAI Chat Model\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"Telegram Chatbot\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"OpenAI Chat Model1\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"Summarization Chain\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"OpenAI Chat Model2\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"Basic LLM Chain\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Summarization Chain\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Send summary\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Set new current session\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Exist?\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Disable previous session\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Set new session\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}