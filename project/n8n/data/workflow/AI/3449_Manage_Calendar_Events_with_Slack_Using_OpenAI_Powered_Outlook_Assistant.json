{
  "title": "Manage Calendar Events with Slack Using OpenAI-Powered Outlook Assistant",
  "url": "https://n8n.io/workflows/3449-manage-calendar-events-with-slack-using-openai-powered-outlook-assistant/",
  "category": "AI",
  "category_url": "https://n8n.io/workflows/categories/ai/?count=20",
  "author": "Jimleuk",
  "publish_date": "Last update 20 days ago",
  "content": "",
  "workflow_json": "{\"meta\":{\"instanceId\":\"408f9fb9940c3cb18ffdef0e0150fe342d6e655c3a9fac21f0f644e8bedabcd9\",\"templateCredsSetupCompleted\":true},\"nodes\":[{\"id\":\"e37622d2-d9d4-4aff-8c0f-a2945e739ccd\",\"name\":\"OpenAI Chat Model\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\"position\":[-180,40],\"parameters\":{\"options\":{}},\"credentials\":{\"openAiApi\":{\"id\":\"8gccIjcuf3gvaoEr\",\"name\":\"OpenAi account\"}},\"typeVersion\":1},{\"id\":\"702c21cf-6ca5-4b1b-8511-fd082152e50b\",\"name\":\"Search All Outlook Events\",\"type\":\"n8n-nodes-base.microsoftOutlookTool\",\"position\":[180,40],\"webhookId\":\"486fda30-984a-4af6-990f-d5f30865fc29\",\"parameters\":{\"limit\":20,\"filters\":{\"custom\":\"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Filter_Query', ``, 'string') }}\"},\"resource\":\"event\",\"descriptionType\":\"manual\",\"toolDescription\":\"Call this tool to consume Microsoft Outlook API and fetch all outlook calendar events across all available calendars for a given filter.\"},\"credentials\":{\"microsoftOutlookOAuth2Api\":{\"id\":\"EWg6sbhPKcM5y3Mr\",\"name\":\"Microsoft Outlook account\"}},\"typeVersion\":2},{\"id\":\"c4d7571d-0d96-42f5-a1dd-d2ee8e467731\",\"name\":\"Create New Calendar Event\",\"type\":\"n8n-nodes-base.microsoftOutlookTool\",\"position\":[320,40],\"webhookId\":\"c4f72f45-2c3f-49cf-ac16-6b8fe701cc41\",\"parameters\":{\"subject\":\"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Title', ``, 'string') }}\",\"resource\":\"event\",\"operation\":\"create\",\"calendarId\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Calendar', ``, 'string') }}\"},\"endDateTime\":\"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('End', ``, 'string') }}\",\"startDateTime\":\"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Start', ``, 'string') }}\",\"descriptionType\":\"manual\",\"toolDescription\":\"Call this tool to consume Microsoft Outlook API and create a new outlook calendar event. Ensure the calendar ID exists before proceeding.\",\"additionalFields\":{\"body\":\"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Description', ``, 'string') }}\"}},\"credentials\":{\"microsoftOutlookOAuth2Api\":{\"id\":\"EWg6sbhPKcM5y3Mr\",\"name\":\"Microsoft Outlook account\"}},\"typeVersion\":2},{\"id\":\"db5e44ab-7ec8-4831-9e41-34c963cd2314\",\"name\":\"Get Available Calendars\",\"type\":\"n8n-nodes-base.microsoftOutlookTool\",\"position\":[460,40],\"webhookId\":\"605be4f6-e8c4-4350-9da9-55988b069c5d\",\"parameters\":{\"limit\":20,\"filters\":{},\"resource\":\"calendar\",\"descriptionType\":\"manual\",\"toolDescription\":\"Call this tool to consume Microsoft Outlook API and fetch a list of available calendars.\"},\"credentials\":{\"microsoftOutlookOAuth2Api\":{\"id\":\"EWg6sbhPKcM5y3Mr\",\"name\":\"Microsoft Outlook account\"}},\"typeVersion\":2},{\"id\":\"8102e365-eec4-48c6-986b-4ab8aac9e72a\",\"name\":\"Simple Memory\",\"type\":\"@n8n/n8n-nodes-langchain.memoryBufferWindow\",\"position\":[-20,40],\"parameters\":{\"sessionKey\":\"={{ $json.ts }}_{{ $json.user }}\",\"sessionIdType\":\"customKey\"},\"typeVersion\":1.3},{\"id\":\"ebd79d18-86b9-4e8b-9a27-f9878fd3d617\",\"name\":\"Outlook Calendar Assistant\",\"type\":\"@n8n/n8n-nodes-langchain.agent\",\"position\":[-60,-180],\"parameters\":{\"text\":\"={{ $json.message.substr($json.message.indexOf('>')+1, 9999).trim() }}\",\"options\":{\"systemMessage\":\"=You are a helpful calendar assistant who can help users with calendar and event enquiries.\\n* Today's date and time is {{ $now.toISO() }}.\"},\"promptType\":\"define\"},\"typeVersion\":1.7},{\"id\":\"f976cea5-be3e-4e14-89f5-b5d05d66f0c7\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-1340,-860],\"parameters\":{\"width\":440,\"height\":720,\"content\":\"### This n8n template demonstrates how easy it is to build an Outlook Calendar Assistant powered by an AI agent equipped with Tools.\\n\\nn8n's AI agents makes it easy to build powerful assistants which can interact with your existing services and tools. With little effort, you can expose such an agent to team members and colleagues though something like Slack and enable a company-wide productivity booster.\\n\\n### How it works\\n* A Slack Trigger node is configured to catch \\\"bot mentions\\\" events in a designated channel.\\n* The message is parsed using the Edit fields node to extract only the required attributes of the event.\\n* An AI Agent equipped with Outlook Calendar Tools enables question and answer capability for the organisation's shared calendars and events.\\n* The AI agent's response is sent back to Slack as a reply to the user's query.\\n\\n### How to use\\n* The workflow is triggered via @mention-ing the bot followed by the query. eg. \\\"@bot how many meetings does Paul have to attend to this week?\\\"\\n* To start listening to real mentions, you must activate the workflow and set it to production mode. You must use the production webhook URL for the event subscription.\\n\\n\\n### Need Help?\\nJoin the [Discord](https://discord.com/invite/XPKeKXeB7d) or ask in the [Forum](https://community.n8n.io/)!\"},\"typeVersion\":1},{\"id\":\"03083765-b3bb-42f6-8f30-7087687bc6eb\",\"name\":\"Send Reply\",\"type\":\"n8n-nodes-base.slack\",\"position\":[620,-180],\"webhookId\":\"68154e10-0b98-4d18-816c-2af8ab954694\",\"parameters\":{\"text\":\"={{ $json.output }}\",\"select\":\"channel\",\"channelId\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"={{ $('Get Message').item.json.channel }}\"},\"otherOptions\":{\"thread_ts\":{\"replyValues\":{\"thread_ts\":\"={{ $('Get Message').item.json.ts }}\"}},\"includeLinkToWorkflow\":false}},\"credentials\":{\"slackApi\":{\"id\":\"VfK3js0YdqBdQLGP\",\"name\":\"Slack account\"}},\"typeVersion\":2.3},{\"id\":\"19c8e68b-2bf1-403a-a43d-cdc465233436\",\"name\":\"Respond to Challenge\",\"type\":\"n8n-nodes-base.respondToWebhook\",\"position\":[-240,-440],\"parameters\":{\"options\":{},\"respondWith\":\"text\",\"responseBody\":\"={{ $json.body.challenge }}\"},\"typeVersion\":1.1},{\"id\":\"2b9f7d68-8e76-440b-9a8b-b9eb4fc7061c\",\"name\":\"Is Auth Challenge?\",\"type\":\"n8n-nodes-base.if\",\"position\":[-520,-300],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"cd56f5f2-dbb8-4cf0-83c8-f0566510ff51\",\"operator\":{\"type\":\"string\",\"operation\":\"exists\",\"singleValue\":true},\"leftValue\":\"={{ $json.body.challenge }}\",\"rightValue\":\"\"}]}},\"typeVersion\":2.2},{\"id\":\"c91350ef-5701-4188-8b1f-de12a0076a56\",\"name\":\"Get Message\",\"type\":\"n8n-nodes-base.set\",\"position\":[-240,-180],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"44da9c3a-35eb-4636-9483-65492e858d96\",\"name\":\"ts\",\"type\":\"string\",\"value\":\"={{ $json.body.event.ts }}\"},{\"id\":\"761840aa-d2e3-4345-95bb-e7866b755880\",\"name\":\"message\",\"type\":\"string\",\"value\":\"={{ $json.body.event.text }}\"},{\"id\":\"094457fc-c149-4175-bed2-f0906cb70dea\",\"name\":\"is_bot\",\"type\":\"boolean\",\"value\":\"={{ $json.body.authorizations[0].is_bot }}\"},{\"id\":\"baf91a59-88fa-45fc-bfcb-ff27d0fe397d\",\"name\":\"user\",\"type\":\"string\",\"value\":\"={{ $json.body.event.user }}\"},{\"id\":\"abc6c16e-50e2-4154-9db9-4e12f9009d01\",\"name\":\"channel\",\"type\":\"string\",\"value\":\"={{ $json.body.event.channel }}\"}]}},\"typeVersion\":3.4},{\"id\":\"0681782d-21f3-4130-809c-188d83ebb7a9\",\"name\":\"On BOT/APP Mention\",\"type\":\"n8n-nodes-base.webhook\",\"position\":[-800,-300],\"webhookId\":\"c63b08ce-360d-4185-aae1-294afef5cf2b\",\"parameters\":{\"path\":\"c63b08ce-360d-4185-aae1-294afef5cf2b\",\"options\":{},\"httpMethod\":\"POST\",\"responseMode\":\"responseNode\"},\"typeVersion\":2},{\"id\":\"d0b12a70-e3e8-4149-98ba-dc2cf01f9953\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-800,-520],\"parameters\":{\"color\":7,\"width\":380,\"height\":180,\"content\":\"## 1. Listen for Bot Mentions\\n[Read more about Webhook Trigger](https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.webhook)\\n\\n**Example**:\\n`@bot how many meetings does Paul have to attend to this week?` \"},\"typeVersion\":1},{\"id\":\"095fd13e-a660-46a8-95c6-b960083681f7\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[0,-440],\"parameters\":{\"color\":7,\"width\":540,\"height\":220,\"content\":\"## 2. AI Agent with Outlook Calendar Tools\\n[Learn more about the AI Agent node](https://docs.n8n.io/integrations/builtin/cluster-nodes/root-nodes/n8n-nodes-langchain.agent)\\n\\nThis agent has 3 Outlook tools to search, browse and even create calendar events for the user. Agents are great in that we don't have to tell the agent what and when to use the tools - it'll make that decision on its own!\"},\"typeVersion\":1},{\"id\":\"3b2662a2-9a79-4848-89db-a5699942f39c\",\"name\":\"Sticky Note3\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[620,0],\"parameters\":{\"color\":7,\"width\":400,\"height\":200,\"content\":\"## 3. Reply to User\\n[Learn more about the Slack node](https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.slack)\\n\\nSimple sends a reply back to the user answering their query. Of course, this is the simplest case and it'll be up to you to handle multi-turn conversation as needed.\"},\"typeVersion\":1},{\"id\":\"f00e8727-12f2-4dad-8736-98bd0996f19a\",\"name\":\"Sticky Note4\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-1340,-120],\"parameters\":{\"color\":5,\"width\":440,\"height\":340,\"content\":\"### Setting Up Slack App Event Subscriptions\\n1. Go to https://api.slack.com/apps\\n2. Create or Select your App\\n3. Under Features, click into \\\"Event Subscriptions\\\"\\n4. On this page, toggle on the \\\"Enable Events\\\" option\\n5. Enter the production URL of this template - your workflow but be active and publicly accessible for this to work.\\n6. Slack will issue a \\\"challenge\\\" request to this workflow which will respond and verify the subscription.\\n7. If successful, under \\\"subscribe to bot events\\\", find and select the \\\"app_mention\\\" option.\\n8. Hit \\\"save changes\\\" at the bottom of the page.\\n9. This workflow should now trigger when your bot is \\\"@mention\\\" in the channel.  \"},\"typeVersion\":1}],\"pinData\":{},\"connections\":{\"Get Message\":{\"main\":[[{\"node\":\"Outlook Calendar Assistant\",\"type\":\"main\",\"index\":0}]]},\"Simple Memory\":{\"ai_memory\":[[{\"node\":\"Outlook Calendar Assistant\",\"type\":\"ai_memory\",\"index\":0}]]},\"OpenAI Chat Model\":{\"ai_languageModel\":[[{\"node\":\"Outlook Calendar Assistant\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"Is Auth Challenge?\":{\"main\":[[{\"node\":\"Respond to Challenge\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Get Message\",\"type\":\"main\",\"index\":0}]]},\"On BOT/APP Mention\":{\"main\":[[{\"node\":\"Is Auth Challenge?\",\"type\":\"main\",\"index\":0}]]},\"Get Available Calendars\":{\"ai_tool\":[[{\"node\":\"Outlook Calendar Assistant\",\"type\":\"ai_tool\",\"index\":0}]]},\"Create New Calendar Event\":{\"ai_tool\":[[{\"node\":\"Outlook Calendar Assistant\",\"type\":\"ai_tool\",\"index\":0}]]},\"Search All Outlook Events\":{\"ai_tool\":[[{\"node\":\"Outlook Calendar Assistant\",\"type\":\"ai_tool\",\"index\":0}]]},\"Outlook Calendar Assistant\":{\"main\":[[{\"node\":\"Send Reply\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "### This n8n template demonstrates how easy it is to build an Outlook Calendar Assistant powered by an AI agent equipped with Tools.\n\nFor teams using Outlook Calendar and Slack who need easier calendar management, this workflow can be a great first step to introducing powerful AI tools into your daily activities.\n\n### How it works\n\n  * A Slack Trigger node is configured to catch \"bot mentions\" events in a designated channel.\n  * The message is parsed using the Edit fields node to extract only the required attributes of the event.\n  * An AI Agent equipped with Outlook Calendar Tools enables question and answer capability for the organisation's shared calendars and events.\n  * The AI agent's response is sent back to Slack as a reply to the user's query.\n\n\n\n### How to use\n\n  * The workflow is triggered via @mention-ing the bot followed by the query. eg. \"@bot how many meetings does Paul have to attend to this week?\"\n  * To start listening to real mentions, you must activate the workflow and set it to production mode. You must use the production webhook URL for the event subscription.\n\n\n\n**Some sample queries to try**\n\n  * \"What's included in the product team's sprint demo this week?\"\n  * \"Who's booked room 7 for this Thursday?\"\n  * \"When is Jim & Nik's sales meeting with Microsoft?\"\n\n\n\n### Requirements\n\n  * Slack for Chat and Trigger. \n    * To get connected to Slack, see the [official n8n docs for Slack Credentials](https://docs.n8n.io/integrations/builtin/credentials/slack/).\n  * Outlook for Agent Tools \n    * To get connected to Outlook, see the [official n8n docs for Outlook Credentials](https://docs.n8n.io/integrations/builtin/credentials/imap/outlook/).\n\n\n\n### Customising this workflow\n\n  * Not using Slack? This template can be modified to work with Teams but requires a little more configuration.\n  * Agents can have any number of tools but an overloaded agent is prone to confusion! If this happens, try splitting into multiple agents serving separate needs.\n\n\n",
  "readme_html": "<!--[--><div data-v-006f9244=\"\"><h3>This n8n template demonstrates how easy it is to build an Outlook Calendar Assistant powered by an AI agent equipped with Tools.</h3>\n<p>For teams using Outlook Calendar and Slack who need easier calendar management, this workflow can be a great first step to introducing powerful AI tools into your daily activities.</p>\n<h3>How it works</h3>\n<ul>\n<li>A Slack Trigger node is configured to catch \"bot mentions\" events in a designated channel.</li>\n<li>The message is parsed using the Edit fields node to extract only the required attributes of the event.</li>\n<li>An AI Agent equipped with Outlook Calendar Tools enables question and answer capability for the organisation's shared calendars and events.</li>\n<li>The AI agent's response is sent back to Slack as a reply to the user's query.</li>\n</ul>\n<h3>How to use</h3>\n<ul>\n<li>The workflow is triggered via @mention-ing the bot followed by the query. eg. \"@bot how many meetings does Paul have to attend to this week?\"</li>\n<li>To start listening to real mentions, you must activate the workflow and set it to production mode. You must use the production webhook URL for the event subscription.</li>\n</ul>\n<p><strong>Some sample queries to try</strong></p>\n<ul>\n<li>\"What's included in the product team's sprint demo this week?\"</li>\n<li>\"Who's booked room 7 for this Thursday?\"</li>\n<li>\"When is Jim &amp; Nik's sales meeting with Microsoft?\"</li>\n</ul>\n<h3>Requirements</h3>\n<ul>\n<li>Slack for Chat and Trigger.\n<ul>\n<li>To get connected to Slack, see the <a href=\"https://docs.n8n.io/integrations/builtin/credentials/slack/\" rel=\"ugc nofollow\" target=\"_blank\">official n8n docs for Slack Credentials</a>.</li>\n</ul>\n</li>\n<li>Outlook for Agent Tools\n<ul>\n<li>To get connected to Outlook, see the <a href=\"https://docs.n8n.io/integrations/builtin/credentials/imap/outlook/\" rel=\"ugc nofollow\" target=\"_blank\">official n8n docs for Outlook Credentials</a>.</li>\n</ul>\n</li>\n</ul>\n<h3>Customising this workflow</h3>\n<ul>\n<li>Not using Slack? This template can be modified to work with Teams but requires a little more configuration.</li>\n<li>Agents can have any number of tools but an overloaded agent is prone to confusion! If this happens, try splitting into multiple agents serving separate needs.</li>\n</ul>\n</div><!--]-->",
  "readme_zh": "### 该n8n模板展示了如何轻松构建由配备工具集的AI代理驱动的Outlook日历助手\n\n对于使用Outlook日历和Slack且需要简化日程管理的团队，此工作流是将强大AI工具引入日常工作的绝佳起点。\n\n### 运作原理\n\n  * 配置Slack触发器节点捕获指定频道中的\"提及机器人\"事件\n  * 使用字段编辑节点解析消息，仅提取事件的关键属性\n  * 配备Outlook日历工具集的AI代理可实现组织共享日历与日程的智能问答\n  * AI代理的响应将作为回复发送至Slack频道\n\n### 使用方法\n\n  * 通过@提及机器人+查询触发工作流，例如：\"@bot保罗本周要参加多少会议？\"\n  * 要启用实时监听功能，必须激活工作流并设置为生产模式，且需使用生产环境的事件订阅webhook地址\n\n**可尝试的示例查询**\n\n  * \"产品团队本周的迭代演示包含哪些内容？\"\n  * \"谁预定了本周四的7号会议室？\"\n  * \"吉姆和尼克与微软的销售会议何时举行？\"\n\n### 环境要求\n\n  * Slack通讯平台及触发器\n    * 配置Slack连接请参阅[n8n官方Slack凭证文档](https://docs.n8n.io/integrations/builtin/credentials/slack/)\n  * Outlook日历工具\n    * 配置Outlook连接请参阅[n8n官方Outlook凭证文档](https://docs.n8n.io/integrations/builtin/credentials/imap/outlook/)\n\n### 自定义工作流\n\n  * 不使用Slack？本模板可适配Teams平台，但需额外配置\n  * 代理可配备任意数量工具，但功能过载易导致混乱！建议按需求拆分为多个专项代理",
  "title_zh": "利用OpenAI驱动的Outlook助手在Slack中管理日历事件",
  "publish_date_absolute": "2025-04-17",
  "publish_date_zh": "上次更新于20天前",
  "workflow_json_zh": "{\n  \"meta\": {\n    \"instanceId\": \"408f9fb9940c3cb18ffdef0e0150fe342d6e655c3a9fac21f0f644e8bedabcd9\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"nodes\": [\n    {\n      \"id\": \"e37622d2-d9d4-4aff-8c0f-a2945e739ccd\",\n      \"name\": \"OpenAI Chat Model\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\n      \"position\": [\n        -180,\n        40\n      ],\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"8gccIjcuf3gvaoEr\",\n          \"name\": \"OpenAi account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"702c21cf-6ca5-4b1b-8511-fd082152e50b\",\n      \"name\": \"Search All Outlook Events\",\n      \"type\": \"n8n-nodes-base.microsoftOutlookTool\",\n      \"position\": [\n        180,\n        40\n      ],\n      \"webhookId\": \"486fda30-984a-4af6-990f-d5f30865fc29\",\n      \"parameters\": {\n        \"limit\": 20,\n        \"filters\": {\n          \"custom\": \"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Filter_Query', ``, 'string') }}\"\n        },\n        \"resource\": \"event\",\n        \"descriptionType\": \"manual\",\n        \"toolDescription\": \"Call this tool to consume Microsoft Outlook API and fetch all outlook calendar events across all available calendars for a given filter.\"\n      },\n      \"credentials\": {\n        \"microsoftOutlookOAuth2Api\": {\n          \"id\": \"EWg6sbhPKcM5y3Mr\",\n          \"name\": \"Microsoft Outlook account\"\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"c4d7571d-0d96-42f5-a1dd-d2ee8e467731\",\n      \"name\": \"Create New Calendar Event\",\n      \"type\": \"n8n-nodes-base.microsoftOutlookTool\",\n      \"position\": [\n        320,\n        40\n      ],\n      \"webhookId\": \"c4f72f45-2c3f-49cf-ac16-6b8fe701cc41\",\n      \"parameters\": {\n        \"subject\": \"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Title', ``, 'string') }}\",\n        \"resource\": \"event\",\n        \"operation\": \"create\",\n        \"calendarId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Calendar', ``, 'string') }}\"\n        },\n        \"endDateTime\": \"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('End', ``, 'string') }}\",\n        \"startDateTime\": \"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Start', ``, 'string') }}\",\n        \"descriptionType\": \"manual\",\n        \"toolDescription\": \"Call this tool to consume Microsoft Outlook API and create a new outlook calendar event. Ensure the calendar ID exists before proceeding.\",\n        \"additionalFields\": {\n          \"body\": \"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Description', ``, 'string') }}\"\n        }\n      },\n      \"credentials\": {\n        \"microsoftOutlookOAuth2Api\": {\n          \"id\": \"EWg6sbhPKcM5y3Mr\",\n          \"name\": \"Microsoft Outlook account\"\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"db5e44ab-7ec8-4831-9e41-34c963cd2314\",\n      \"name\": \"Get Available Calendars\",\n      \"type\": \"n8n-nodes-base.microsoftOutlookTool\",\n      \"position\": [\n        460,\n        40\n      ],\n      \"webhookId\": \"605be4f6-e8c4-4350-9da9-55988b069c5d\",\n      \"parameters\": {\n        \"limit\": 20,\n        \"filters\": {},\n        \"resource\": \"calendar\",\n        \"descriptionType\": \"manual\",\n        \"toolDescription\": \"Call this tool to consume Microsoft Outlook API and fetch a list of available calendars.\"\n      },\n      \"credentials\": {\n        \"microsoftOutlookOAuth2Api\": {\n          \"id\": \"EWg6sbhPKcM5y3Mr\",\n          \"name\": \"Microsoft Outlook account\"\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"8102e365-eec4-48c6-986b-4ab8aac9e72a\",\n      \"name\": \"Simple Memory\",\n      \"type\": \"@n8n/n8n-nodes-langchain.memoryBufferWindow\",\n      \"position\": [\n        -20,\n        40\n      ],\n      \"parameters\": {\n        \"sessionKey\": \"={{ $json.ts }}_{{ $json.user }}\",\n        \"sessionIdType\": \"customKey\"\n      },\n      \"typeVersion\": 1.3\n    },\n    {\n      \"id\": \"ebd79d18-86b9-4e8b-9a27-f9878fd3d617\",\n      \"name\": \"Outlook Calendar Assistant\",\n      \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n      \"position\": [\n        -60,\n        -180\n      ],\n      \"parameters\": {\n        \"text\": \"={{ $json.message.substr($json.message.indexOf('>')+1, 9999).trim() }}\",\n        \"options\": {\n          \"systemMessage\": \"=You are a helpful calendar assistant who can help users with calendar and event enquiries.\\n* Today's date and time is {{ $now.toISO() }}.\"\n        },\n        \"promptType\": \"define\"\n      },\n      \"typeVersion\": 1.7\n    },\n    {\n      \"id\": \"f976cea5-be3e-4e14-89f5-b5d05d66f0c7\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -1340,\n        -860\n      ],\n      \"parameters\": {\n        \"width\": 440,\n        \"height\": 720,\n        \"content\": \"### 此n8n模板展示了如何轻松构建一个由配备工具集的AI智能体驱动的Outlook日历助手。\\n\\nn8n的AI智能体让构建强大助手变得简单，这些助手能与您现有的服务和工具交互。只需少量工作，您就能通过Slack等平台将此类智能体开放给团队成员和同事，从而提升整个公司的工作效率。\\n\\n### 工作原理\\n* 配置Slack触发器节点以捕获指定频道中的\\\"机器人提及\\\"事件。\\n* 使用编辑字段节点解析消息，仅提取事件所需的属性。\\n* 配备Outlook日历工具集的AI智能体为组织共享日历和事件提供问答功能。\\n* AI智能体的响应会作为回复发送回Slack，解答用户查询。\\n\\n### 使用方法\\n* 通过@提及机器人并输入查询来触发工作流。例如：\\\"@bot保罗本周要参加多少次会议？\\\"\\n* 要开始监听实际提及，必须激活工作流并将其设置为生产模式。事件订阅必须使用生产环境的webhook URL。\\n\\n### 需要帮助？\\n加入[Discord](https://discord.com/invite/XPKeKXeB7d)或在[论坛](https://community.n8n.io/)提问！\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"03083765-b3bb-42f6-8f30-7087687bc6eb\",\n      \"name\": \"Send Reply\",\n      \"type\": \"n8n-nodes-base.slack\",\n      \"position\": [\n        620,\n        -180\n      ],\n      \"webhookId\": \"68154e10-0b98-4d18-816c-2af8ab954694\",\n      \"parameters\": {\n        \"text\": \"={{ $json.output }}\",\n        \"select\": \"channel\",\n        \"channelId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $('Get Message').item.json.channel }}\"\n        },\n        \"otherOptions\": {\n          \"thread_ts\": {\n            \"replyValues\": {\n              \"thread_ts\": \"={{ $('Get Message').item.json.ts }}\"\n            }\n          },\n          \"includeLinkToWorkflow\": false\n        }\n      },\n      \"credentials\": {\n        \"slackApi\": {\n          \"id\": \"VfK3js0YdqBdQLGP\",\n          \"name\": \"Slack account\"\n        }\n      },\n      \"typeVersion\": 2.3\n    },\n    {\n      \"id\": \"19c8e68b-2bf1-403a-a43d-cdc465233436\",\n      \"name\": \"Respond to Challenge\",\n      \"type\": \"n8n-nodes-base.respondToWebhook\",\n      \"position\": [\n        -240,\n        -440\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"respondWith\": \"text\",\n        \"responseBody\": \"={{ $json.body.challenge }}\"\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"2b9f7d68-8e76-440b-9a8b-b9eb4fc7061c\",\n      \"name\": \"Is Auth Challenge?\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        -520,\n        -300\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"cd56f5f2-dbb8-4cf0-83c8-f0566510ff51\",\n              \"operator\": {\n                \"type\": \"string\",\n                \"operation\": \"exists\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json.body.challenge }}\",\n              \"rightValue\": \"\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"c91350ef-5701-4188-8b1f-de12a0076a56\",\n      \"name\": \"Get Message\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        -240,\n        -180\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"44da9c3a-35eb-4636-9483-65492e858d96\",\n              \"name\": \"ts\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.event.ts }}\"\n            },\n            {\n              \"id\": \"761840aa-d2e3-4345-95bb-e7866b755880\",\n              \"name\": \"message\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.event.text }}\"\n            },\n            {\n              \"id\": \"094457fc-c149-4175-bed2-f0906cb70dea\",\n              \"name\": \"is_bot\",\n              \"type\": \"boolean\",\n              \"value\": \"={{ $json.body.authorizations[0].is_bot }}\"\n            },\n            {\n              \"id\": \"baf91a59-88fa-45fc-bfcb-ff27d0fe397d\",\n              \"name\": \"user\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.event.user }}\"\n            },\n            {\n              \"id\": \"abc6c16e-50e2-4154-9db9-4e12f9009d01\",\n              \"name\": \"channel\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.event.channel }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"0681782d-21f3-4130-809c-188d83ebb7a9\",\n      \"name\": \"On BOT/APP Mention\",\n      \"type\": \"n8n-nodes-base.webhook\",\n      \"position\": [\n        -800,\n        -300\n      ],\n      \"webhookId\": \"c63b08ce-360d-4185-aae1-294afef5cf2b\",\n      \"parameters\": {\n        \"path\": \"c63b08ce-360d-4185-aae1-294afef5cf2b\",\n        \"options\": {},\n        \"httpMethod\": \"POST\",\n        \"responseMode\": \"responseNode\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"d0b12a70-e3e8-4149-98ba-dc2cf01f9953\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -800,\n        -520\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 380,\n        \"height\": 180,\n        \"content\": \"## 1. 监听机器人提及  \\n[详细了解Webhook触发机制](https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.webhook)  \\n\\n**示例**：  \\n`@机器人 保罗这周要参加多少个会议？`\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"095fd13e-a660-46a8-95c6-b960083681f7\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        0,\n        -440\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 540,\n        \"height\": 220,\n        \"content\": \"## 2. 集成Outlook日历工具的AI智能体\\n[详细了解AI智能体节点](https://docs.n8n.io/integrations/builtin/cluster-nodes/root-nodes/n8n-nodes-langchain.agent)\\n\\n该智能体配备3种Outlook工具，可替用户搜索、浏览甚至创建日历事项。智能体的优势在于无需人工指定工具使用时机及方式——它能自主决策！\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"3b2662a2-9a79-4848-89db-a5699942f39c\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        620,\n        0\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 400,\n        \"height\": 200,\n        \"content\": \"## 3. 回复用户\\n[进一步了解Slack节点](https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.slack)\\n\\n简单地向用户发送回复以解答其查询。当然，这是最基础的情况，您需要根据需要自行处理多轮对话。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"f00e8727-12f2-4dad-8736-98bd0996f19a\",\n      \"name\": \"Sticky Note4\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -1340,\n        -120\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 440,\n        \"height\": 340,\n        \"content\": \"### 设置Slack应用事件订阅\\n1. 访问 https://api.slack.com/apps\\n2. 创建或选择您的应用\\n3. 在功能菜单中点击\\\"事件订阅\\\"\\n4. 在此页面开启\\\"启用事件\\\"选项\\n5. 输入本模板的生产环境URL - 您的工作流必须处于活跃状态且可公开访问才能生效\\n6. Slack会向该工作流发送\\\"挑战\\\"请求，工作流将响应并验证订阅\\n7. 验证成功后，在\\\"订阅机器人事件\\\"下找到并选择\\\"app_mention\\\"选项\\n8. 点击页面底部的\\\"保存更改\\\"按钮\\n9. 现在当有人在频道中@提及您的机器人时，该工作流就会被触发\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"pinData\": {},\n  \"connections\": {\n    \"Get Message\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Outlook Calendar Assistant\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Simple Memory\": {\n      \"ai_memory\": [\n        [\n          {\n            \"node\": \"Outlook Calendar Assistant\",\n            \"type\": \"ai_memory\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"OpenAI Chat Model\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"Outlook Calendar Assistant\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Is Auth Challenge?\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Respond to Challenge\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Get Message\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"On BOT/APP Mention\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Is Auth Challenge?\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get Available Calendars\": {\n      \"ai_tool\": [\n        [\n          {\n            \"node\": \"Outlook Calendar Assistant\",\n            \"type\": \"ai_tool\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Create New Calendar Event\": {\n      \"ai_tool\": [\n        [\n          {\n            \"node\": \"Outlook Calendar Assistant\",\n            \"type\": \"ai_tool\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Search All Outlook Events\": {\n      \"ai_tool\": [\n        [\n          {\n            \"node\": \"Outlook Calendar Assistant\",\n            \"type\": \"ai_tool\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Outlook Calendar Assistant\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Send Reply\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}