{
  "title": "Summarize Umami data with AI (via Openrouter) and save it to Baserow",
  "url": "https://n8n.io/workflows/2520-summarize-umami-data-with-ai-via-openrouter-and-save-it-to-baserow/",
  "category": "AI",
  "category_url": "https://n8n.io/workflows/categories/ai/?count=20",
  "author": "Keith Rumjahn",
  "publish_date": "Last update 2 months ago",
  "content": "",
  "workflow_json": "{\"id\":\"eZT6SZ4Kvmq5TzyQ\",\"meta\":{\"instanceId\":\"558d88703fb65b2d0e44613bc35916258b0f0bf983c5d4730c00c424b77ca36a\",\"templateCredsSetupCompleted\":true},\"name\":\"Umami analytics template\",\"tags\":[],\"nodes\":[{\"id\":\"8a54ac1c-a072-42e6-a3ba-8cde33475eb5\",\"name\":\"When clicking ‘Test workflow’\",\"type\":\"n8n-nodes-base.manualTrigger\",\"position\":[460,220],\"parameters\":{},\"typeVersion\":1},{\"id\":\"e81c9be0-f59d-467e-9bda-eeb2d66ed31e\",\"name\":\"Schedule Trigger\",\"type\":\"n8n-nodes-base.scheduleTrigger\",\"position\":[460,380],\"parameters\":{\"rule\":{\"interval\":[{\"field\":\"weeks\",\"triggerAtDay\":[4]}]}},\"typeVersion\":1.2},{\"id\":\"01b04872-9aea-4834-8df5-f6c91914133d\",\"name\":\"Get view stats from Umami\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[760,260],\"parameters\":{\"url\":\"=https://umami.mydomain.com/api/websites/86d4095c-a2a8-4fc8-9521-103e858e2b41/event-data/stats?startAt={{ DateTime.now().minus({ days: 7 }).toMillis() }}&endAt={{ DateTime.now().toMillis() }}&unit=hour&timezone=Asia%2FHong_Kong\",\"options\":{},\"authentication\":\"genericCredentialType\",\"genericAuthType\":\"httpHeaderAuth\"},\"credentials\":{\"httpHeaderAuth\":{\"id\":\"FKsKXvQUlaX5qt9n\",\"name\":\"Header Auth account 3\"}},\"typeVersion\":4.2},{\"id\":\"38d342e3-10ad-4260-8f44-5a3233ec3166\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[660,-460],\"parameters\":{\"width\":505,\"height\":320,\"content\":\"## Send data from Umami to A.I. and then save to Baserow\\n\\nYou can find out more about the stats available in the [Umami API](https://umami.is/docs/api/website-stats-api)\\n\\n[Watch youtube tutorial here](https://www.youtube.com/watch?v=hGzdhXyU-o8)\\n\\n[Get my SEO A.I. agent system here](https://2828633406999.gumroad.com/l/rumjahn)\\n\\nRead the [case study here](https://rumjahn.com/how-to-analyze-umami-data-using-n8n-and-a-i-to-improve-seo-and-uncover-hidden-insights-for-better-content-optimization/).\\n\\n\"},\"typeVersion\":1},{\"id\":\"18c997fe-61b1-464a-8bb5-fcdc017dd1f6\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[660,-60],\"parameters\":{\"color\":4,\"width\":393.16558441558414,\"height\":504.17207792207796,\"content\":\"## Get summary stats from Umami\\n\\nIt will get: Pageviews, Visitors, Visits, Bounces, Total Time\\n\\nYou need to change the URL to your website. https://{your website}/api/websites/{website ID}/\\n\\nYou can find your ID by going to your Umami account -> Settings -> Edit (next to domain)\"},\"typeVersion\":1},{\"id\":\"bfdc04a2-57fa-4a8a-b412-39047cebb370\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1080,-60],\"parameters\":{\"color\":5,\"width\":216.5746753246753,\"height\":502.37012987012963,\"content\":\"## Send data to A.I.\\n\\nTo use Openrouter, you need to register for an account.\\nThen add header authorization credentials.\\nUsername: Authroization\\nPassword: Bearer {Your API Key}\\n*It's Bearer space {API key}.\"},\"typeVersion\":1},{\"id\":\"fc373fd7-52fc-4729-8022-021c09d0c89c\",\"name\":\"Sticky Note3\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1320,-60],\"parameters\":{\"color\":6,\"width\":746.3474025974022,\"height\":505.9740259740257,\"content\":\"## Get page specific stats for this week and last\\n\\nCalls Umami to get this week and last week's data. It will get the views for each page visited on your website for comparison.\"},\"typeVersion\":1},{\"id\":\"82bd35b6-8b49-4d77-8be2-033a8bff3f41\",\"name\":\"Sticky Note4\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[2120,-60],\"parameters\":{\"color\":5,\"width\":216.5746753246753,\"height\":502.37012987012963,\"content\":\"## Send data to A.I.\\n\\nTo use Openrouter, you need to register for an account.\\nThen add header authorization credentials.\\nUsername: Authroization\\nPassword: Bearer {Your API Key}\\n*It's Bearer space {API key}.\"},\"typeVersion\":1},{\"id\":\"503c4ca3-36da-41a8-9029-f844a34daa59\",\"name\":\"Sticky Note5\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[2380,-60],\"parameters\":{\"color\":4,\"width\":393.16558441558414,\"height\":504.17207792207796,\"content\":\"## Save analysis to baserow\\n\\nYou need to create a table in advance to save. \\n- Date (date)\\n- Summary (Long text)\\n- Top pages (Long text)\\n- Blog name (Long text)\"},\"typeVersion\":1},{\"id\":\"f64cdfbd-712f-461c-b025-25f37e2bded8\",\"name\":\"Parse Umami data\",\"type\":\"n8n-nodes-base.code\",\"position\":[940,260],\"parameters\":{\"jsCode\":\"function transformToUrlString(items) {\\n    // In n8n, we need to check if items is an array and get the json property\\n    const data = items[0].json;\\n    \\n    if (!data) {\\n        console.log('No valid data found');\\n        return encodeURIComponent(JSON.stringify([]));\\n    }\\n    \\n    try {\\n        // Create a simplified object with the metrics\\n        const simplified = {\\n            pageviews: {\\n                value: parseInt(data.pageviews.value) || 0,\\n                prev: parseInt(data.pageviews.prev) || 0\\n            },\\n            visitors: {\\n                value: parseInt(data.visitors.value) || 0,\\n                prev: parseInt(data.visitors.prev) || 0\\n            },\\n            visits: {\\n                value: parseInt(data.visits.value) || 0,\\n                prev: parseInt(data.visits.prev) || 0\\n            },\\n            bounces: {\\n                value: parseInt(data.bounces.value) || 0,\\n                prev: parseInt(data.bounces.prev) || 0\\n            },\\n            totaltime: {\\n                value: parseInt(data.totaltime.value) || 0,\\n                prev: parseInt(data.totaltime.prev) || 0\\n            }\\n        };\\n        \\n        return encodeURIComponent(JSON.stringify(simplified));\\n    } catch (error) {\\n        console.log('Error processing data:', error);\\n        throw new Error('Invalid data structure');\\n    }\\n}\\n\\n// Get the input data\\nconst items = $input.all();\\n\\n// Process the data\\nconst result = transformToUrlString(items);\\n\\n// Return the result\\nreturn { json: { urlString: result } };\"},\"typeVersion\":2},{\"id\":\"470715b6-0878-48b8-b6c6-40de27fbc966\",\"name\":\"Send data to A.I.\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[1140,260],\"parameters\":{\"url\":\"https://openrouter.ai/api/v1/chat/completions\",\"method\":\"POST\",\"options\":{},\"jsonBody\":\"={\\n  \\\"model\\\": \\\"meta-llama/llama-3.1-70b-instruct:free\\\",\\n  \\\"messages\\\": [\\n    {\\n      \\\"role\\\": \\\"user\\\",\\n      \\\"content\\\": \\\"You are an SEO expert. Here is data from Umami analytics of Pennibnotes.com. Where X is URL and Y is number of visitors. Give me a table summary of this data in markdown format:{{ $('Parse Umami data').item.json.urlString }}.\\\"\\n    }\\n  ]\\n}\",\"sendBody\":true,\"specifyBody\":\"json\",\"authentication\":\"genericCredentialType\",\"genericAuthType\":\"httpHeaderAuth\"},\"credentials\":{\"httpHeaderAuth\":{\"id\":\"WY7UkF14ksPKq3S8\",\"name\":\"Header Auth account 2\"}},\"typeVersion\":4.2},{\"id\":\"ea4bb37f-96d9-41b8-bf46-fb09865a6e0f\",\"name\":\"Get page data from Umami\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[1380,260],\"parameters\":{\"url\":\"=https://umami.rumjahn.synology.me/api/websites/f375d28c-1949-4597-8871-f1b942e3aa24/metrics?startAt={{Date.now() - (7 * 24 * 60 * 60 * 1000)}}&endAt={{Date.now()}}&type=url&tz=America/Los_Angeles\",\"options\":{},\"authentication\":\"genericCredentialType\",\"genericAuthType\":\"httpHeaderAuth\"},\"credentials\":{\"httpHeaderAuth\":{\"id\":\"FKsKXvQUlaX5qt9n\",\"name\":\"Header Auth account 3\"}},\"typeVersion\":4},{\"id\":\"d982606b-49c8-4d5b-ba79-bd0fdd2600b6\",\"name\":\"Parse Umami data1\",\"type\":\"n8n-nodes-base.code\",\"position\":[1560,260],\"parameters\":{\"jsCode\":\"// Get input data\\nconst data = $input.all();\\n\\n// Create URL-encoded string from the data\\nconst encodedData = encodeURIComponent(JSON.stringify(data));\\n\\n// Return the encoded data\\nreturn {\\n    json: {\\n        thisWeek: encodedData\\n    }\\n};\"},\"typeVersion\":2},{\"id\":\"f3734045-1318-4234-a3ac-61b766124609\",\"name\":\"Get page view data from Umami\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[1760,260],\"parameters\":{\"url\":\"=https://umami.rumjahn.synology.me/api/websites/f375d28c-1949-4597-8871-f1b942e3aa24/metrics?startAt={{Date.now() - (14 * 24 * 60 * 60 * 1000)}}&endAt={{Date.now() - (7 * 24 * 60 * 60 * 1000)}}&type=url&tz=America/Los_Angeles\",\"options\":{},\"authentication\":\"genericCredentialType\",\"genericAuthType\":\"httpHeaderAuth\"},\"credentials\":{\"httpHeaderAuth\":{\"id\":\"FKsKXvQUlaX5qt9n\",\"name\":\"Header Auth account 3\"}},\"typeVersion\":4},{\"id\":\"a0153ab0-3eaf-4f97-a2dc-ab63d45a9187\",\"name\":\"Parse Umami\",\"type\":\"n8n-nodes-base.code\",\"position\":[1920,260],\"parameters\":{\"jsCode\":\"// Get input data\\nconst data = $input.all();\\n\\n// Create URL-encoded string from the data\\nconst encodedData = encodeURIComponent(JSON.stringify(data));\\n\\n// Return the encoded data\\nreturn {\\n    json: {\\n        lastweek: encodedData\\n    }\\n};\"},\"typeVersion\":2},{\"id\":\"c2d3d396-09fa-4800-b56d-40ed7592cd3c\",\"name\":\"Send data to A.I.1\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[2180,260],\"parameters\":{\"url\":\"https://openrouter.ai/api/v1/chat/completions\",\"method\":\"POST\",\"options\":{},\"jsonBody\":\"={\\n  \\\"model\\\": \\\"meta-llama/llama-3.1-70b-instruct:free\\\",\\n  \\\"messages\\\": [\\n    {\\n      \\\"role\\\": \\\"user\\\",\\n      \\\"content\\\": \\\"You are an SEO expert. Here is data from Umami analytics of Pennibnotes.com. Where X is URL and Y is number of visitors.  Compare the data from this week to last week. Present the data in a table using markdown and offer 5 improvement suggestions. This week:{{ $('Parse Umami data1').first().json.thisWeek }} Lastweek:{{ $json.lastweek }}\\\"\\n    }\\n  ]\\n}\\n\\n\",\"sendBody\":true,\"specifyBody\":\"json\",\"authentication\":\"genericCredentialType\",\"genericAuthType\":\"httpHeaderAuth\"},\"credentials\":{\"httpHeaderAuth\":{\"id\":\"WY7UkF14ksPKq3S8\",\"name\":\"Header Auth account 2\"}},\"typeVersion\":4.2},{\"id\":\"ce58a556-c05a-4395-88b0-3edecbad80e5\",\"name\":\"Save data to Baserow\",\"type\":\"n8n-nodes-base.baserow\",\"position\":[2520,260],\"parameters\":{\"tableId\":607,\"fieldsUi\":{\"fieldValues\":[{\"fieldId\":5870,\"fieldValue\":\"={{ $json.choices[0].message.content }}\"},{\"fieldId\":5869,\"fieldValue\":\"={{ $('Send data to A.I.').first().json.choices[0].message.content }}\"},{\"fieldId\":5868,\"fieldValue\":\"={{ DateTime.now().toFormat('yyyy-MM-dd') }}\"},{\"fieldId\":5871,\"fieldValue\":\"Name of your blog\"}]},\"operation\":\"create\",\"databaseId\":121},\"credentials\":{\"baserowApi\":{\"id\":\"8w0zXhycIfCAgja3\",\"name\":\"Baserow account\"}},\"typeVersion\":1}],\"active\":false,\"pinData\":{},\"settings\":{\"executionOrder\":\"v1\"},\"versionId\":\"0c09e5c7-49a9-4f11-b93e-35659360fe02\",\"connections\":{\"Parse Umami\":{\"main\":[[{\"node\":\"Send data to A.I.1\",\"type\":\"main\",\"index\":0}]]},\"Parse Umami data\":{\"main\":[[{\"node\":\"Send data to A.I.\",\"type\":\"main\",\"index\":0}]]},\"Schedule Trigger\":{\"main\":[[{\"node\":\"Get view stats from Umami\",\"type\":\"main\",\"index\":0}]]},\"Parse Umami data1\":{\"main\":[[{\"node\":\"Get page view data from Umami\",\"type\":\"main\",\"index\":0}]]},\"Send data to A.I.\":{\"main\":[[{\"node\":\"Get page data from Umami\",\"type\":\"main\",\"index\":0}]]},\"Send data to A.I.1\":{\"main\":[[{\"node\":\"Save data to Baserow\",\"type\":\"main\",\"index\":0}]]},\"Get page data from Umami\":{\"main\":[[{\"node\":\"Parse Umami data1\",\"type\":\"main\",\"index\":0}]]},\"Get view stats from Umami\":{\"main\":[[{\"node\":\"Parse Umami data\",\"type\":\"main\",\"index\":0}]]},\"Get page view data from Umami\":{\"main\":[[{\"node\":\"Parse Umami\",\"type\":\"main\",\"index\":0}]]},\"When clicking ‘Test workflow’\":{\"main\":[[{\"node\":\"Get view stats from Umami\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "## Who's this for?\n\n  * Anyone who wants to improve the SEO of their website\n  * Umami users who want insights on how to improve their site\n  * SEO managers who need to generate reports weekly\n\n\n\n![Screenshot 20241102 at 3.00.47 PM.png](https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/Screenshot_2024_11_02_at_3_00_47_PM_46ec3d0b79.png)![Screenshot 20241102 at 3.01.13 PM.png](https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/Screenshot_2024_11_02_at_3_01_13_PM_ca880dfc24.png)\n\n## Case study\n\n[Watch youtube tutorial here](https://www.youtube.com/watch?v=hGzdhXyU-o8)\n\n[Get my SEO A.I. agent system here](https://2828633406999.gumroad.com/l/rumjahn)\n\nYou can [read more about how this works here.](https://rumjahn.com/how-to-analyze-umami-data-using-n8n-and-a-i-to-improve-seo-and-uncover-hidden-insights-for-better-content-optimization/)\n\n## How it works\n\n  * This workflow calls the Umami API to get data\n  * Then it sends the data to A.I. for analysis\n  * It saves the data and analysis to Baserow\n\n\n\n## How to use this\n\n  * Input your Umami credentials\n  * Input your website property ID\n  * Input your [Openrouter.ai](http://Openrouter.ai) credentials\n  * Input your baserow credentials\n  * You will need to create a baserow database with columns: Date, Summary, Top Pages, Blog (name of your blog).\n\n\n\n## Future development\n\n  * Use this as a template. There's alot more Umami stats you can pull from the API.\n  * Change the A.I. prompt to give even more detailed analysis.\n\n\n\nCreated by [Rumjahn](https://rumjahn.com/)\n",
  "readme_html": "<!--[--><div data-v-006f9244=\"\"><h2>Who's this for?</h2>\n<ul>\n<li>Anyone who wants to improve the SEO of their website</li>\n<li>Umami users who want insights on how to improve their site</li>\n<li>SEO managers who need to generate reports weekly</li>\n</ul>\n<p><img src=\"https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/Screenshot_2024_11_02_at_3_00_47_PM_46ec3d0b79.png\" alt=\"Screenshot 20241102 at 3.00.47 PM.png\"><img src=\"https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/Screenshot_2024_11_02_at_3_01_13_PM_ca880dfc24.png\" alt=\"Screenshot 20241102 at 3.01.13 PM.png\"></p>\n<h2>Case study</h2>\n<p><a href=\"https://www.youtube.com/watch?v=hGzdhXyU-o8\" rel=\"ugc nofollow\" target=\"_blank\">Watch youtube tutorial here</a></p>\n<p><a href=\"https://2828633406999.gumroad.com/l/rumjahn\" rel=\"ugc nofollow\" target=\"_blank\">Get my SEO A.I. agent system here</a></p>\n<p>You can <a href=\"https://rumjahn.com/how-to-analyze-umami-data-using-n8n-and-a-i-to-improve-seo-and-uncover-hidden-insights-for-better-content-optimization/\" rel=\"ugc nofollow\" target=\"_blank\">read more about how this works here.</a></p>\n<h2>How it works</h2>\n<ul>\n<li>This workflow calls the Umami API to get data</li>\n<li>Then it sends the data to A.I. for analysis</li>\n<li>It saves the data and analysis to Baserow</li>\n</ul>\n<h2>How to use this</h2>\n<ul>\n<li>Input your Umami credentials</li>\n<li>Input your website property ID</li>\n<li>Input your <a href=\"http://Openrouter.ai\" rel=\"ugc nofollow\" target=\"_blank\">Openrouter.ai</a> credentials</li>\n<li>Input your baserow credentials</li>\n<li>You will need to create a baserow database with columns: Date, Summary, Top Pages, Blog (name of your blog).</li>\n</ul>\n<h2>Future development</h2>\n<ul>\n<li>Use this as a template. There's alot more Umami stats you can pull from the API.</li>\n<li>Change the A.I. prompt to give even more detailed analysis.</li>\n</ul>\n<p>Created by <a href=\"https://rumjahn.com/\" rel=\"ugc nofollow\" target=\"_blank\">Rumjahn</a></p>\n</div><!--]-->",
  "readme_zh": "## 适用人群\n\n  * 希望提升网站SEO效果的所有用户\n  * 渴望获取网站优化洞见的Umami使用者\n  * 需要每周生成报告的SEO经理",
  "title_zh": "利用AI（通过Openrouter）汇总Umami数据并保存至Baserow",
  "publish_date_absolute": "2025-03-07",
  "publish_date_zh": "最后更新于2个月前",
  "workflow_json_zh": "{\n  \"id\": \"eZT6SZ4Kvmq5TzyQ\",\n  \"meta\": {\n    \"instanceId\": \"558d88703fb65b2d0e44613bc35916258b0f0bf983c5d4730c00c424b77ca36a\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"name\": \"Umami analytics template\",\n  \"tags\": [],\n  \"nodes\": [\n    {\n      \"id\": \"8a54ac1c-a072-42e6-a3ba-8cde33475eb5\",\n      \"name\": \"When clicking ‘Test workflow’\",\n      \"type\": \"n8n-nodes-base.manualTrigger\",\n      \"position\": [\n        460,\n        220\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"e81c9be0-f59d-467e-9bda-eeb2d66ed31e\",\n      \"name\": \"Schedule Trigger\",\n      \"type\": \"n8n-nodes-base.scheduleTrigger\",\n      \"position\": [\n        460,\n        380\n      ],\n      \"parameters\": {\n        \"rule\": {\n          \"interval\": [\n            {\n              \"field\": \"weeks\",\n              \"triggerAtDay\": [\n                4\n              ]\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"01b04872-9aea-4834-8df5-f6c91914133d\",\n      \"name\": \"Get view stats from Umami\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        760,\n        260\n      ],\n      \"parameters\": {\n        \"url\": \"=https://umami.mydomain.com/api/websites/86d4095c-a2a8-4fc8-9521-103e858e2b41/event-data/stats?startAt={{ DateTime.now().minus({ days: 7 }).toMillis() }}&endAt={{ DateTime.now().toMillis() }}&unit=hour&timezone=Asia%2FHong_Kong\",\n        \"options\": {},\n        \"authentication\": \"genericCredentialType\",\n        \"genericAuthType\": \"httpHeaderAuth\"\n      },\n      \"credentials\": {\n        \"httpHeaderAuth\": {\n          \"id\": \"FKsKXvQUlaX5qt9n\",\n          \"name\": \"Header Auth account 3\"\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"38d342e3-10ad-4260-8f44-5a3233ec3166\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        660,\n        -460\n      ],\n      \"parameters\": {\n        \"width\": 505,\n        \"height\": 320,\n        \"content\": \"## 将Umami数据发送至AI处理并存储至Baserow\\n\\n您可通过[Umami API文档](https://umami.is/docs/api/website-stats-api)了解可获取的统计数据详情。\\n\\n[点击观看YouTube教程](https://www.youtube.com/watch?v=hGzdhXyU-o8)\\n\\n[获取我的SEO智能代理系统](https://2828633406999.gumroad.com/l/rumjahn)\\n\\n阅读[完整案例研究](https://rumjahn.com/how-to-analyze-umami-data-using-n8n-and-a-i-to-improve-seo-and-uncover-hidden-insights-for-better-content-optimization/)。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"18c997fe-61b1-464a-8bb5-fcdc017dd1f6\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        660,\n        -60\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 393.16558441558414,\n        \"height\": 504.17207792207796,\n        \"content\": \"## 从Umami获取统计摘要\\n\\n该操作将获取以下数据：页面浏览量、访客数、访问次数、跳出次数、总停留时长\\n\\n需将URL替换为您网站的地址：https://{您的网站}/api/websites/{网站ID}/\\n\\n可通过以下路径查找ID：登录Umami账户 -> 设置 -> 点击域名旁的编辑按钮\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"bfdc04a2-57fa-4a8a-b412-39047cebb370\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1080,\n        -60\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 216.5746753246753,\n        \"height\": 502.37012987012963,\n        \"content\": \"## 发送数据至人工智能平台\\n\\n使用Openrouter前需完成账号注册\\n随后在请求头中添加鉴权凭证\\n用户名填写：Authorization\\n密码填写：Bearer {您的API密钥}\\n*注意格式为Bearer空格{API密钥}\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"fc373fd7-52fc-4729-8022-021c09d0c89c\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1320,\n        -60\n      ],\n      \"parameters\": {\n        \"color\": 6,\n        \"width\": 746.3474025974022,\n        \"height\": 505.9740259740257,\n        \"content\": \"## 获取本周与上周的页面具体统计数据\\n\\n调用Umami获取本周和上周的数据。该功能将统计您网站上每个被访问页面的浏览量，以便进行对比分析。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"82bd35b6-8b49-4d77-8be2-033a8bff3f41\",\n      \"name\": \"Sticky Note4\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        2120,\n        -60\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 216.5746753246753,\n        \"height\": 502.37012987012963,\n        \"content\": \"## 发送数据至人工智能平台\\n\\n使用Openrouter前需完成账号注册\\n随后在请求头中添加鉴权凭证\\n用户名填写：Authorization\\n密码格式为：Bearer {您的API密钥}\\n*注意Bearer与密钥间需保留空格\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"503c4ca3-36da-41a8-9029-f844a34daa59\",\n      \"name\": \"Sticky Note5\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        2380,\n        -60\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 393.16558441558414,\n        \"height\": 504.17207792207796,\n        \"content\": \"## 保存分析结果到Baserow\\n\\n您需要提前创建好用于存储的表单结构：\\n- 日期（日期类型）\\n- 内容摘要（长文本类型）\\n- 热门页面（长文本类型）\\n- 博客名称（长文本类型）\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"f64cdfbd-712f-461c-b025-25f37e2bded8\",\n      \"name\": \"Parse Umami data\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        940,\n        260\n      ],\n      \"parameters\": {\n        \"jsCode\": \"function transformToUrlString(items) {\\n    // In n8n, we need to check if items is an array and get the json property\\n    const data = items[0].json;\\n    \\n    if (!data) {\\n        console.log('No valid data found');\\n        return encodeURIComponent(JSON.stringify([]));\\n    }\\n    \\n    try {\\n        // Create a simplified object with the metrics\\n        const simplified = {\\n            pageviews: {\\n                value: parseInt(data.pageviews.value) || 0,\\n                prev: parseInt(data.pageviews.prev) || 0\\n            },\\n            visitors: {\\n                value: parseInt(data.visitors.value) || 0,\\n                prev: parseInt(data.visitors.prev) || 0\\n            },\\n            visits: {\\n                value: parseInt(data.visits.value) || 0,\\n                prev: parseInt(data.visits.prev) || 0\\n            },\\n            bounces: {\\n                value: parseInt(data.bounces.value) || 0,\\n                prev: parseInt(data.bounces.prev) || 0\\n            },\\n            totaltime: {\\n                value: parseInt(data.totaltime.value) || 0,\\n                prev: parseInt(data.totaltime.prev) || 0\\n            }\\n        };\\n        \\n        return encodeURIComponent(JSON.stringify(simplified));\\n    } catch (error) {\\n        console.log('Error processing data:', error);\\n        throw new Error('Invalid data structure');\\n    }\\n}\\n\\n// Get the input data\\nconst items = $input.all();\\n\\n// Process the data\\nconst result = transformToUrlString(items);\\n\\n// Return the result\\nreturn { json: { urlString: result } };\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"470715b6-0878-48b8-b6c6-40de27fbc966\",\n      \"name\": \"Send data to A.I.\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1140,\n        260\n      ],\n      \"parameters\": {\n        \"url\": \"https://openrouter.ai/api/v1/chat/completions\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"jsonBody\": \"={\\n  \\\"model\\\": \\\"meta-llama/llama-3.1-70b-instruct:free\\\",\\n  \\\"messages\\\": [\\n    {\\n      \\\"role\\\": \\\"user\\\",\\n      \\\"content\\\": \\\"You are an SEO expert. Here is data from Umami analytics of Pennibnotes.com. Where X is URL and Y is number of visitors. Give me a table summary of this data in markdown format:{{ $('Parse Umami data').item.json.urlString }}.\\\"\\n    }\\n  ]\\n}\",\n        \"sendBody\": true,\n        \"specifyBody\": \"json\",\n        \"authentication\": \"genericCredentialType\",\n        \"genericAuthType\": \"httpHeaderAuth\"\n      },\n      \"credentials\": {\n        \"httpHeaderAuth\": {\n          \"id\": \"WY7UkF14ksPKq3S8\",\n          \"name\": \"Header Auth account 2\"\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"ea4bb37f-96d9-41b8-bf46-fb09865a6e0f\",\n      \"name\": \"Get page data from Umami\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1380,\n        260\n      ],\n      \"parameters\": {\n        \"url\": \"=https://umami.rumjahn.synology.me/api/websites/f375d28c-1949-4597-8871-f1b942e3aa24/metrics?startAt={{Date.now() - (7 * 24 * 60 * 60 * 1000)}}&endAt={{Date.now()}}&type=url&tz=America/Los_Angeles\",\n        \"options\": {},\n        \"authentication\": \"genericCredentialType\",\n        \"genericAuthType\": \"httpHeaderAuth\"\n      },\n      \"credentials\": {\n        \"httpHeaderAuth\": {\n          \"id\": \"FKsKXvQUlaX5qt9n\",\n          \"name\": \"Header Auth account 3\"\n        }\n      },\n      \"typeVersion\": 4\n    },\n    {\n      \"id\": \"d982606b-49c8-4d5b-ba79-bd0fdd2600b6\",\n      \"name\": \"Parse Umami data1\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        1560,\n        260\n      ],\n      \"parameters\": {\n        \"jsCode\": \"// Get input data\\nconst data = $input.all();\\n\\n// Create URL-encoded string from the data\\nconst encodedData = encodeURIComponent(JSON.stringify(data));\\n\\n// Return the encoded data\\nreturn {\\n    json: {\\n        thisWeek: encodedData\\n    }\\n};\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"f3734045-1318-4234-a3ac-61b766124609\",\n      \"name\": \"Get page view data from Umami\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1760,\n        260\n      ],\n      \"parameters\": {\n        \"url\": \"=https://umami.rumjahn.synology.me/api/websites/f375d28c-1949-4597-8871-f1b942e3aa24/metrics?startAt={{Date.now() - (14 * 24 * 60 * 60 * 1000)}}&endAt={{Date.now() - (7 * 24 * 60 * 60 * 1000)}}&type=url&tz=America/Los_Angeles\",\n        \"options\": {},\n        \"authentication\": \"genericCredentialType\",\n        \"genericAuthType\": \"httpHeaderAuth\"\n      },\n      \"credentials\": {\n        \"httpHeaderAuth\": {\n          \"id\": \"FKsKXvQUlaX5qt9n\",\n          \"name\": \"Header Auth account 3\"\n        }\n      },\n      \"typeVersion\": 4\n    },\n    {\n      \"id\": \"a0153ab0-3eaf-4f97-a2dc-ab63d45a9187\",\n      \"name\": \"Parse Umami\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        1920,\n        260\n      ],\n      \"parameters\": {\n        \"jsCode\": \"// Get input data\\nconst data = $input.all();\\n\\n// Create URL-encoded string from the data\\nconst encodedData = encodeURIComponent(JSON.stringify(data));\\n\\n// Return the encoded data\\nreturn {\\n    json: {\\n        lastweek: encodedData\\n    }\\n};\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"c2d3d396-09fa-4800-b56d-40ed7592cd3c\",\n      \"name\": \"Send data to A.I.1\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        2180,\n        260\n      ],\n      \"parameters\": {\n        \"url\": \"https://openrouter.ai/api/v1/chat/completions\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"jsonBody\": \"={\\n  \\\"model\\\": \\\"meta-llama/llama-3.1-70b-instruct:free\\\",\\n  \\\"messages\\\": [\\n    {\\n      \\\"role\\\": \\\"user\\\",\\n      \\\"content\\\": \\\"You are an SEO expert. Here is data from Umami analytics of Pennibnotes.com. Where X is URL and Y is number of visitors.  Compare the data from this week to last week. Present the data in a table using markdown and offer 5 improvement suggestions. This week:{{ $('Parse Umami data1').first().json.thisWeek }} Lastweek:{{ $json.lastweek }}\\\"\\n    }\\n  ]\\n}\\n\\n\",\n        \"sendBody\": true,\n        \"specifyBody\": \"json\",\n        \"authentication\": \"genericCredentialType\",\n        \"genericAuthType\": \"httpHeaderAuth\"\n      },\n      \"credentials\": {\n        \"httpHeaderAuth\": {\n          \"id\": \"WY7UkF14ksPKq3S8\",\n          \"name\": \"Header Auth account 2\"\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"ce58a556-c05a-4395-88b0-3edecbad80e5\",\n      \"name\": \"Save data to Baserow\",\n      \"type\": \"n8n-nodes-base.baserow\",\n      \"position\": [\n        2520,\n        260\n      ],\n      \"parameters\": {\n        \"tableId\": 607,\n        \"fieldsUi\": {\n          \"fieldValues\": [\n            {\n              \"fieldId\": 5870,\n              \"fieldValue\": \"={{ $json.choices[0].message.content }}\"\n            },\n            {\n              \"fieldId\": 5869,\n              \"fieldValue\": \"={{ $('Send data to A.I.').first().json.choices[0].message.content }}\"\n            },\n            {\n              \"fieldId\": 5868,\n              \"fieldValue\": \"={{ DateTime.now().toFormat('yyyy-MM-dd') }}\"\n            },\n            {\n              \"fieldId\": 5871,\n              \"fieldValue\": \"Name of your blog\"\n            }\n          ]\n        },\n        \"operation\": \"create\",\n        \"databaseId\": 121\n      },\n      \"credentials\": {\n        \"baserowApi\": {\n          \"id\": \"8w0zXhycIfCAgja3\",\n          \"name\": \"Baserow account\"\n        }\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"active\": false,\n  \"pinData\": {},\n  \"settings\": {\n    \"executionOrder\": \"v1\"\n  },\n  \"versionId\": \"0c09e5c7-49a9-4f11-b93e-35659360fe02\",\n  \"connections\": {\n    \"Parse Umami\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Send data to A.I.1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Parse Umami data\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Send data to A.I.\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Schedule Trigger\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get view stats from Umami\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Parse Umami data1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get page view data from Umami\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Send data to A.I.\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get page data from Umami\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Send data to A.I.1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Save data to Baserow\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get page data from Umami\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Parse Umami data1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get view stats from Umami\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Parse Umami data\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get page view data from Umami\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Parse Umami\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"When clicking ‘Test workflow’\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get view stats from Umami\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}