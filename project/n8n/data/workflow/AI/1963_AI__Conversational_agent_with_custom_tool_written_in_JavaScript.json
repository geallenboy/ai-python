{
  "title": "AI: Conversational agent with custom tool written in JavaScript",
  "url": "https://n8n.io/workflows/1963-ai-conversational-agent-with-custom-tool-written-in-javascript/",
  "category": "AI",
  "category_url": "https://n8n.io/workflows/categories/ai/?count=20",
  "author": "n8n Team",
  "publish_date": "Last update a month ago",
  "content": "",
  "workflow_json": "{\"meta\":{\"instanceId\":\"408f9fb9940c3cb18ffdef0e0150fe342d6e655c3a9fac21f0f644e8bedabcd9\",\"templateCredsSetupCompleted\":true},\"nodes\":[{\"id\":\"912b279c-30e5-4991-92ab-040fc1e89c7a\",\"name\":\"When clicking ‘Test workflow’\",\"type\":\"n8n-nodes-base.manualTrigger\",\"position\":[-60,0],\"parameters\":{},\"typeVersion\":1},{\"id\":\"749d8762-d213-4dd3-b404-4c6518fcd28f\",\"name\":\"When chat message received\",\"type\":\"@n8n/n8n-nodes-langchain.chatTrigger\",\"position\":[-60,200],\"webhookId\":\"c2e664e6-645f-422a-99d3-cf0f4c53c345\",\"parameters\":{\"options\":{}},\"typeVersion\":1.1},{\"id\":\"1eeff044-b914-40f7-8d37-8b69007862cd\",\"name\":\"AI Agent\",\"type\":\"@n8n/n8n-nodes-langchain.agent\",\"position\":[460,0],\"parameters\":{\"text\":\"={{ $json.chatInput }}\",\"options\":{},\"promptType\":\"define\"},\"typeVersion\":1.8},{\"id\":\"ac34f7f0-d1dc-4ffb-8f49-6ddc925e97bc\",\"name\":\"Debug Input\",\"type\":\"n8n-nodes-base.set\",\"position\":[160,0],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"25d97d59-b0cf-46ae-916d-18059b3d6847\",\"name\":\"chatInput\",\"type\":\"string\",\"value\":\"Return a random color but not green or blue\"}]}},\"typeVersion\":3.4},{\"id\":\"a410a0a5-1ea1-4ade-a32c-8f6fd959bae8\",\"name\":\"OpenAI Chat Model\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\"position\":[440,200],\"parameters\":{\"model\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"gpt-4o-mini\"},\"options\":{}},\"credentials\":{\"openAiApi\":{\"id\":\"8gccIjcuf3gvaoEr\",\"name\":\"OpenAi account\"}},\"typeVersion\":1.2},{\"id\":\"923b1597-2e9c-4c38-b3bb-7d6dffb52e4a\",\"name\":\"Code Tool\",\"type\":\"@n8n/n8n-nodes-langchain.toolCode\",\"position\":[660,200],\"parameters\":{\"name\":\"my_color_selector\",\"jsCode\":\"const colors = [\\n    'red',\\n    'green',\\n    'blue',\\n    'yellow',\\n    'pink',\\n    'white',\\n    'black',\\n    'orange',\\n    'brown',\\n];\\n\\nconst ignoreColors = query.split(',').map((text) => text.trim());\\n\\n// remove all the colors that should be ignored\\nconst availableColors = colors.filter((color) => {\\n    return !ignoreColors.includes(color);\\n});\\n\\n// Select a random color\\nreturn availableColors[Math.floor(Math.random() * availableColors.length)];\\n\",\"description\":\"Call this tool to get a random color. The input should be a string with comma-separated names of colors to exclude.\"},\"typeVersion\":1.1}],\"pinData\":{},\"connections\":{\"Code Tool\":{\"ai_tool\":[[{\"node\":\"AI Agent\",\"type\":\"ai_tool\",\"index\":0}]]},\"Debug Input\":{\"main\":[[{\"node\":\"AI Agent\",\"type\":\"main\",\"index\":0}]]},\"OpenAI Chat Model\":{\"ai_languageModel\":[[{\"node\":\"AI Agent\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"When chat message received\":{\"main\":[[{\"node\":\"AI Agent\",\"type\":\"main\",\"index\":0}]]},\"When clicking ‘Test workflow’\":{\"main\":[[{\"node\":\"Debug Input\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "This workflow implements a custom tool via JavaScript code which returns a random color to users and excludes the given colors.\n\nNote that to use this template, you need to be on n8n version 1.19.4 or later.\n",
  "readme_html": "<!--[--><div data-v-006f9244=\"\"><p>This workflow implements a custom tool via JavaScript code which returns a random color to users and excludes the given colors.</p>\n<p>Note that to use this template, you need to be on n8n version 1.19.4 or later.</p>\n</div><!--]-->",
  "readme_zh": "该工作流通过JavaScript代码实现了一个自定义工具，能够向用户返回随机颜色并排除指定颜色。\n\n请注意，使用此模板需确保n8n版本为1.19.4或更高。",
  "title_zh": "AI：基于JavaScript编写的自定义工具的对话代理",
  "publish_date_absolute": "",
  "publish_date_zh": "上次更新于一个月前",
  "workflow_json_zh": "{\n  \"meta\": {\n    \"instanceId\": \"408f9fb9940c3cb18ffdef0e0150fe342d6e655c3a9fac21f0f644e8bedabcd9\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"nodes\": [\n    {\n      \"id\": \"912b279c-30e5-4991-92ab-040fc1e89c7a\",\n      \"name\": \"When clicking ‘Test workflow’\",\n      \"type\": \"n8n-nodes-base.manualTrigger\",\n      \"position\": [\n        -60,\n        0\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"749d8762-d213-4dd3-b404-4c6518fcd28f\",\n      \"name\": \"When chat message received\",\n      \"type\": \"@n8n/n8n-nodes-langchain.chatTrigger\",\n      \"position\": [\n        -60,\n        200\n      ],\n      \"webhookId\": \"c2e664e6-645f-422a-99d3-cf0f4c53c345\",\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"1eeff044-b914-40f7-8d37-8b69007862cd\",\n      \"name\": \"AI Agent\",\n      \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n      \"position\": [\n        460,\n        0\n      ],\n      \"parameters\": {\n        \"text\": \"={{ $json.chatInput }}\",\n        \"options\": {},\n        \"promptType\": \"define\"\n      },\n      \"typeVersion\": 1.8\n    },\n    {\n      \"id\": \"ac34f7f0-d1dc-4ffb-8f49-6ddc925e97bc\",\n      \"name\": \"Debug Input\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        160,\n        0\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"25d97d59-b0cf-46ae-916d-18059b3d6847\",\n              \"name\": \"chatInput\",\n              \"type\": \"string\",\n              \"value\": \"Return a random color but not green or blue\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"a410a0a5-1ea1-4ade-a32c-8f6fd959bae8\",\n      \"name\": \"OpenAI Chat Model\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\n      \"position\": [\n        440,\n        200\n      ],\n      \"parameters\": {\n        \"model\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"gpt-4o-mini\"\n        },\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"8gccIjcuf3gvaoEr\",\n          \"name\": \"OpenAi account\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"923b1597-2e9c-4c38-b3bb-7d6dffb52e4a\",\n      \"name\": \"Code Tool\",\n      \"type\": \"@n8n/n8n-nodes-langchain.toolCode\",\n      \"position\": [\n        660,\n        200\n      ],\n      \"parameters\": {\n        \"name\": \"my_color_selector\",\n        \"jsCode\": \"const colors = [\\n    'red',\\n    'green',\\n    'blue',\\n    'yellow',\\n    'pink',\\n    'white',\\n    'black',\\n    'orange',\\n    'brown',\\n];\\n\\nconst ignoreColors = query.split(',').map((text) => text.trim());\\n\\n// remove all the colors that should be ignored\\nconst availableColors = colors.filter((color) => {\\n    return !ignoreColors.includes(color);\\n});\\n\\n// Select a random color\\nreturn availableColors[Math.floor(Math.random() * availableColors.length)];\\n\",\n        \"description\": \"Call this tool to get a random color. The input should be a string with comma-separated names of colors to exclude.\"\n      },\n      \"typeVersion\": 1.1\n    }\n  ],\n  \"pinData\": {},\n  \"connections\": {\n    \"Code Tool\": {\n      \"ai_tool\": [\n        [\n          {\n            \"node\": \"AI Agent\",\n            \"type\": \"ai_tool\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Debug Input\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"AI Agent\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"OpenAI Chat Model\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"AI Agent\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"When chat message received\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"AI Agent\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"When clicking ‘Test workflow’\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Debug Input\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}