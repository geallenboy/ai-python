{
  "title": "Daily Newsletter Service using Excel, Outlook and AI",
  "url": "https://n8n.io/workflows/3446-daily-newsletter-service-using-excel-outlook-and-ai/",
  "category": "AI",
  "category_url": "https://n8n.io/workflows/categories/ai/",
  "author": "Jimleuk",
  "publish_date": "Last update 19 days ago",
  "content": "",
  "workflow_json": "{\"meta\":{\"instanceId\":\"408f9fb9940c3cb18ffdef0e0150fe342d6e655c3a9fac21f0f644e8bedabcd9\",\"templateCredsSetupCompleted\":true},\"nodes\":[{\"id\":\"c3a9ba81-3a7e-4afe-be8b-cf482cbb88c2\",\"name\":\"Schedule Trigger\",\"type\":\"n8n-nodes-base.scheduleTrigger\",\"position\":[-1040,-540],\"parameters\":{\"rule\":{\"interval\":[{\"triggerAtHour\":6}]}},\"typeVersion\":1.2},{\"id\":\"f63d035c-5a7b-4cf4-8730-5fa7dff6f94b\",\"name\":\"Get Subscribers\",\"type\":\"n8n-nodes-base.microsoftExcel\",\"position\":[-860,-540],\"parameters\":{\"options\":{},\"resource\":\"worksheet\",\"workbook\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"=\"},\"operation\":\"readRows\",\"worksheet\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"=\"}},\"credentials\":{\"microsoftExcelOAuth2Api\":{\"id\":\"56tIUYYVARBe9gfX\",\"name\":\"Microsoft Excel account\"}},\"typeVersion\":2.1},{\"id\":\"e93aa8de-5c68-4a01-ae60-beb141e0a430\",\"name\":\"Get Unique Categories\",\"type\":\"n8n-nodes-base.set\",\"position\":[-400,-160],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"fe138128-50d5-469f-8c0b-0af8c873f198\",\"name\":\"categories\",\"type\":\"array\",\"value\":\"={{ $input.all().flatMap(item => item.json.categories).unique() }}\"}]}},\"executeOnce\":true,\"typeVersion\":3.4},{\"id\":\"a874ae4e-d67e-4019-9e5c-03ea677468ae\",\"name\":\"OpenAI Chat Model\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\"position\":[760,80],\"parameters\":{\"model\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"gpt-4o-mini\"},\"options\":{}},\"credentials\":{\"openAiApi\":{\"id\":\"8gccIjcuf3gvaoEr\",\"name\":\"OpenAi account\"}},\"typeVersion\":1.2},{\"id\":\"bc9c7578-3b6f-45fb-9f93-94637774d125\",\"name\":\"Aggregate\",\"type\":\"n8n-nodes-base.aggregate\",\"position\":[1180,40],\"parameters\":{\"options\":{},\"aggregate\":\"aggregateAllItemData\"},\"typeVersion\":1},{\"id\":\"ae83c9e2-a267-463c-a606-b4d101f93f92\",\"name\":\"Collect Fields\",\"type\":\"n8n-nodes-base.set\",\"position\":[980,-60],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"4a266505-4b88-41cf-bf22-f38c705c27e5\",\"name\":\"workflow_id\",\"type\":\"number\",\"value\":\"={{ $('Workflows to Items').item.json.workflow.id }}\"},{\"id\":\"df3348e2-b6ec-4c38-a146-c38be9b830bc\",\"name\":\"workflow_name\",\"type\":\"string\",\"value\":\"={{ $('Workflows to Items').item.json.workflow.name }}\"},{\"id\":\"b4646059-748f-407a-b829-d6605d5ab683\",\"name\":\"workflow_desc\",\"type\":\"string\",\"value\":\"={{ $json.response.text }}\"},{\"id\":\"eac0d9ab-9445-4bc2-9e64-160fe44b9ace\",\"name\":\"workflow_created_at\",\"type\":\"string\",\"value\":\"={{ $('Workflows to Items').item.json.workflow.createdAt }}\"},{\"id\":\"24a3c0cb-224c-4ce6-b59e-38b10ab2c02f\",\"name\":\"author_id\",\"type\":\"number\",\"value\":\"={{ $('Workflows to Items').item.json.workflow.user.id }}\"},{\"id\":\"a2b8a52f-be72-484c-aa86-582b73be1859\",\"name\":\"author_name\",\"type\":\"string\",\"value\":\"={{ $('Workflows to Items').item.json.workflow.user.name }}\"},{\"id\":\"ae735511-8c7c-4bef-b6ac-cfe3d4b87b4f\",\"name\":\"author_username\",\"type\":\"string\",\"value\":\"={{ $('Workflows to Items').item.json.workflow.user.username }}\"},{\"id\":\"2dc1f59f-a854-4322-85df-c5998f782dcd\",\"name\":\"category\",\"type\":\"string\",\"value\":\"={{ $('For Each Category').item.json.category }}\"}]}},\"typeVersion\":3.4},{\"id\":\"8ca1ea7e-9098-4e82-919b-ba98ae7d7574\",\"name\":\"Categories to Items\",\"type\":\"n8n-nodes-base.splitOut\",\"position\":[-220,-160],\"parameters\":{\"options\":{\"destinationFieldName\":\"category\"},\"fieldToSplitOut\":\"categories\"},\"typeVersion\":1},{\"id\":\"eb6d74b8-f1ed-4ab2-8c5f-7e6c6361b055\",\"name\":\"For Each Category\",\"type\":\"n8n-nodes-base.splitInBatches\",\"position\":[320,-160],\"parameters\":{\"options\":{}},\"typeVersion\":3},{\"id\":\"8640ffac-9df6-4154-bcd5-dfa90c3843d4\",\"name\":\"Workflows to Items\",\"type\":\"n8n-nodes-base.splitOut\",\"position\":[500,-60],\"parameters\":{\"options\":{\"destinationFieldName\":\"workflow\"},\"fieldToSplitOut\":\"workflows\"},\"typeVersion\":1},{\"id\":\"4456a43b-df26-4bb8-a62d-b9f05eff4479\",\"name\":\"Workflow Summarizer\",\"type\":\"@n8n/n8n-nodes-langchain.chainLlm\",\"position\":[660,-60],\"parameters\":{\"text\":\"=## Description\\n```\\n{{ $json.workflow.description.replaceAll('#', '') }}\\n```\",\"messages\":{\"messageValues\":[{\"message\":\"=You have received a description of a n8n template from the official template gallery. Your task is to summarize the description into one or two sentences. The summary should loosely follow the structure of:\\n* identify the goal of the template\\n* describe the method or approached implemented\\n* highlight which important n8n nodes were used\\n\\neg. \\\"Obtain real-time crypto market insights using an AI-powered workflow with CoinMarketCap APIs through Telegram\\\"\"}]},\"promptType\":\"define\"},\"typeVersion\":1.5},{\"id\":\"5f4a5921-c954-4523-8925-90401d8dbf22\",\"name\":\"Merge\",\"type\":\"n8n-nodes-base.merge\",\"position\":[660,-460],\"parameters\":{\"mode\":\"chooseBranch\"},\"typeVersion\":3.1},{\"id\":\"f95fb28c-875c-4105-aa83-9fea257ea440\",\"name\":\"Fetch Latest 10 per Category\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[-40,-160],\"parameters\":{\"url\":\"=https://n8n.io/api/product-api/workflows/search\",\"options\":{},\"sendQuery\":true,\"queryParameters\":{\"parameters\":[{\"name\":\"category\",\"value\":\"={{$json.category }}\"},{\"name\":\"rows\",\"value\":\"10\"},{\"name\":\"sort\",\"value\":\"createdAt:desc\"},{\"name\":\"page\",\"value\":\"1\"}]}},\"typeVersion\":4.2},{\"id\":\"4dda6cbc-e53f-452d-b257-df9ef18abd75\",\"name\":\"No Operation, do nothing\",\"type\":\"n8n-nodes-base.noOp\",\"position\":[1560,-460],\"parameters\":{},\"typeVersion\":1},{\"id\":\"881337d8-3ca8-43d2-931f-9cfec16cc367\",\"name\":\"Get Relevant Workflows\",\"type\":\"n8n-nodes-base.set\",\"position\":[1380,-280],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"fbd0ad94-e5aa-4082-81f5-d7b2e08dfbcf\",\"name\":\"workflows\",\"type\":\"array\",\"value\":\"={{\\n$json.categories\\n  .flatMap(cat =>\\n    $('Flatten Workflows').first().json.workflows.filter(item => item.category === cat)\\n  )\\n}}\"}]}},\"typeVersion\":3.4},{\"id\":\"b3ad0e26-e495-4dae-bfdd-f65961178acc\",\"name\":\"Flatten Workflows\",\"type\":\"n8n-nodes-base.set\",\"position\":[500,-280],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"17a82dd9-3fcf-44d9-b5da-bf89a1f53d59\",\"name\":\"workflows\",\"type\":\"array\",\"value\":\"={{\\n$input.all().flatMap(item => item.json.data)\\n}}\"}]}},\"executeOnce\":true,\"typeVersion\":3.4},{\"id\":\"05f72731-f8b0-4d8f-ba78-66ef8fbaf059\",\"name\":\"Remove Already Seen\",\"type\":\"n8n-nodes-base.removeDuplicates\",\"position\":[1740,-280],\"parameters\":{\"options\":{},\"operation\":\"removeItemsSeenInPreviousExecutions\",\"dedupeValue\":\"={{ $('For Each Subscriber').item.json.name.toSnakeCase() }}_{{ $json.workflow_id }}\"},\"typeVersion\":2},{\"id\":\"3904d2a2-9a95-4e11-883e-b2e88c6a884f\",\"name\":\"Workflow to Items\",\"type\":\"n8n-nodes-base.splitOut\",\"position\":[1560,-280],\"parameters\":{\"options\":{},\"fieldToSplitOut\":\"workflows\"},\"typeVersion\":1},{\"id\":\"d416dee7-df0f-4579-a25f-6baed16453e8\",\"name\":\"Combine Workflows\",\"type\":\"n8n-nodes-base.aggregate\",\"position\":[1920,-280],\"parameters\":{\"options\":{},\"aggregate\":\"aggregateAllItemData\"},\"typeVersion\":1},{\"id\":\"3797dd21-3144-47e8-9359-841b97073001\",\"name\":\"Has New Workflows?\",\"type\":\"n8n-nodes-base.if\",\"position\":[1380,-600],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"08403b2a-4ae6-4cf5-aa88-cc49441e3c56\",\"operator\":{\"type\":\"array\",\"operation\":\"lengthGt\",\"rightType\":\"number\"},\"leftValue\":\"={{ $json.data }}\",\"rightValue\":0}]}},\"typeVersion\":2.2},{\"id\":\"0cd6ce35-c083-4db6-bc87-9d21e70a3bab\",\"name\":\"With User Reference\",\"type\":\"n8n-nodes-base.set\",\"position\":[2100,-280],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"d69921eb-b518-4614-af63-e67a521ee373\",\"name\":\"name\",\"type\":\"string\",\"value\":\"={{ $('For Each Subscriber').item.json.name }}\"},{\"id\":\"01ee6e0a-9d03-42f6-ad46-68b9df861679\",\"name\":\"email\",\"type\":\"string\",\"value\":\"={{ $('For Each Subscriber').item.json.email }}\"},{\"id\":\"5263e512-1b24-43c8-9033-6547dab2811b\",\"name\":\"categories\",\"type\":\"array\",\"value\":\"={{ $('For Each Subscriber').item.json.categories }}\"}]},\"includeOtherFields\":true},\"typeVersion\":3.4},{\"id\":\"b3a616c7-615f-49ff-8e6f-530324a98be4\",\"name\":\"Generate HTML Template\",\"type\":\"n8n-nodes-base.html\",\"position\":[1740,-720],\"parameters\":{\"html\":\"<h1>New Workflows for {{ $now.format('DD') }}</h1>\\n{{\\n$json.categories\\n  .filter(cat =>\\n    $json.data.filter(item => item.category === cat).length > 0\\n  )\\n  .map(category => `\\n    <h2>${category.toSentenceCase()}</h2>\\n    <ul>\\n    ${$json.data\\n      .filter(workflow => workflow.category === category)\\n      .map(workflow => `\\n      <li>\\n        <a href=\\\"https://n8n.io/workflows/${workflow.workflow_id}\\\">\\n          <h3>${workflow.workflow_name}</h3>\\n        </a>\\n        <p>\\n          by\\n          <a href=\\\"https://n8n.io/creators/${workflow.author_username}\\\">\\n            ${workflow.author_name}\\n          </a>\\n          &middot;\\n          created on ${DateTime.fromISO(workflow.workflow_created_at).toFormat('DD')}\\n        </p>\\n        <p>${workflow.workflow_desc}</p>\\n      </li>\\n    `).join('\\\\n')}\\n    </ul>\\n  `)\\n  .join('\\\\n')\\n}}\"},\"typeVersion\":1.2},{\"id\":\"0c9865c7-9352-4fda-a943-34c8f524de6c\",\"name\":\"Parse Rows\",\"type\":\"n8n-nodes-base.set\",\"position\":[-660,-540],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"d89dfc07-3c1f-4fbc-9a52-3748797a4840\",\"name\":\"name\",\"type\":\"string\",\"value\":\"={{ $json.name }}\"},{\"id\":\"c622ceca-2e6d-4bab-bb08-235f704c7e2f\",\"name\":\"email\",\"type\":\"string\",\"value\":\"={{ $json.email }}\"},{\"id\":\"9fca8e33-330a-4e4d-b461-251cd7e5c620\",\"name\":\"categories\",\"type\":\"array\",\"value\":\"={{ $json.categories.split(',') }}\"}]}},\"typeVersion\":3.4},{\"id\":\"f5fbd7f2-65e5-4dd7-8e43-38a8a99e3321\",\"name\":\"Send Daily Digest\",\"type\":\"n8n-nodes-base.microsoftOutlook\",\"position\":[1920,-720],\"webhookId\":\"8cd83f97-1e5f-4280-9a9d-26d1ee05c45e\",\"parameters\":{\"subject\":\"=New Workflows for {{ $now.format('DD') }}\",\"bodyContent\":\"={{\\n$json.html\\n  .replaceAll('\\\\n', '')\\n  .replaceAll('  ', '')\\n  .trim()\\n}}\",\"toRecipients\":\"={{ $('Has New Workflows?').item.json.email }}\",\"additionalFields\":{\"from\":\"=no-reply <no-reply@example.com>\",\"replyTo\":\"=no-reply <no-reply@example.com>\",\"bodyContentType\":\"html\"}},\"credentials\":{\"microsoftOutlookOAuth2Api\":{\"id\":\"EWg6sbhPKcM5y3Mr\",\"name\":\"Microsoft Outlook account\"}},\"typeVersion\":2},{\"id\":\"e81ba3a0-e3f6-4231-8870-8ef03edf41e1\",\"name\":\"Append Category\",\"type\":\"n8n-nodes-base.set\",\"position\":[140,-160],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"b965dee8-f3b5-419b-b39a-79bf2b7d04c1\",\"name\":\"category\",\"type\":\"string\",\"value\":\"={{ $('Categories to Items').item.json.category }}\"}]},\"includeOtherFields\":true},\"typeVersion\":3.4},{\"id\":\"e1c2c743-a560-47e8-b906-a2e8fd17622f\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-1060,-740],\"parameters\":{\"color\":7,\"width\":440,\"content\":\"## 1. Get Subscribers from Excel\\n[Learn more about the Excel node](https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.microsoftexcel)\\n\\nExcel can be an easy way to store a simple list of subscribers who will receive our daily digest. We can also specify only the categories they are interested in.\"},\"typeVersion\":1},{\"id\":\"e10a23be-2af7-4b92-9b5f-df855e6ee349\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-400,-420],\"parameters\":{\"color\":7,\"width\":620,\"height\":220,\"content\":\"## 2. Fetch Latest Templates from n8n\\n[Learn more about the HTTP Request node](https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.httprequest)\\n\\nUsing the HTTP request node, we can call the n8n.io template search API to the latest published templates. However, to save on resources, we only want to fetch from categories relevant to our subscribers. To do so:\\n1) We only want to fetch latest templates from unique categories amongst all subscribers\\n2) Do this fetching once to later reference for all subscribers\"},\"typeVersion\":1},{\"id\":\"0ee0b2ca-0247-4471-a6f5-920fd8e67f96\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[500,260],\"parameters\":{\"color\":7,\"width\":580,\"height\":180,\"content\":\"## 3. Generate AI Summary For Each Template\\n[Read more about the Basic LLM node](https://docs.n8n.io/integrations/builtin/cluster-nodes/root-nodes/n8n-nodes-langchain.chainllm)\\n\\nWhen building our email digest, we'd rather have a shortened and summarized version of each template's description for easier scanning and reading. We can use AI to accomplish this and merge it with the template object.\"},\"typeVersion\":1},{\"id\":\"ab234694-2878-440b-aeb5-37573ebe517e\",\"name\":\"Sticky Note3\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1680,-60],\"parameters\":{\"color\":7,\"width\":580,\"height\":200,\"content\":\"## 4. Filter Relevant Templates for Subscriber\\n[Read more about the Split Out node](https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.splitout)\\n\\nFor each subscriber, we want to filter out our freshly collected n8n.io templates by the categories relevant to the subscriber as defined in the Excel sheet. A \\\"Remove duplicates\\\" node can be used to keep track of duplicate templates - as templates can have more than one category and appear twice!\"},\"typeVersion\":1},{\"id\":\"460a8b3d-c125-41c3-95c5-afdfe63c7561\",\"name\":\"Sticky Note4\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1740,-960],\"parameters\":{\"color\":7,\"width\":580,\"height\":200,\"content\":\"## 5. Generate Daily Digest and Send Via Outlook\\n[Read more about the Outlook node](https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.microsoftoutlook)\\n\\nFinally, we can construct our digest's content using the HTML node and customise it by subscriber as necessary. The Outlook node is then used to send the digest to the subscriber.\"},\"typeVersion\":1},{\"id\":\"c79a2775-6276-41df-a9f0-64017e88a8c7\",\"name\":\"Sticky Note5\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-500,0],\"parameters\":{\"color\":5,\"width\":200,\"height\":120,\"content\":\"### Execute Once\\nThis node has been set to execute once rather than for each subscriber.\"},\"typeVersion\":1},{\"id\":\"5290822e-b63b-4b73-8511-6a12e2387656\",\"name\":\"Sticky Note6\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-940,-360],\"parameters\":{\"color\":5,\"width\":280,\"height\":120,\"content\":\"### Columns\\n- name *(text)*\\n- email *(text)*\\n- categories *(text, comma-delimited)*\"},\"typeVersion\":1},{\"id\":\"56acbd11-7fa5-44b8-b031-fcdeb6e44839\",\"name\":\"For Each Subscriber\",\"type\":\"n8n-nodes-base.splitInBatches\",\"position\":[1180,-460],\"parameters\":{\"options\":{}},\"typeVersion\":3},{\"id\":\"6aef7efc-1bc7-4a1d-b0cb-459484b3d179\",\"name\":\"Sticky Note7\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-1600,-1400],\"parameters\":{\"width\":500,\"height\":1000,\"content\":\"## Try It Out!\\n### This n8n template builds a newsletter (\\\"daily digest\\\") delivery service which pulls and summarises the latest n8n.io template in select categories defined by subscribers.\\n\\nIt's scheduled to run once a day and sends the newsletter directly to subscriber via a nicely formatted email. If you've had trouble keeping up with the latest and greatest templates beign published daily, this workflow can save you a lot of time!\\n\\n### How it works\\n* A scheduled trigger pulls a list of subscribers (email and category preferences) from an Excel workbook.\\n* We work out unique categories amongst all subscribers and only fetch the latest n8n website templates from these categories to save on resources and optimise the number of API calls we make.\\n* The fetched templates are summarised via AI to produce a short description which is more suitable for our email format.\\n* For each subscriber, we filter and collect only the templates relevant to their category preferences (as defined in the Excel) and ensure that duplicate templates or those which have been \\\"seen before\\\" are omitted.\\n* A HTML node is then used to generate the email newsletter. HTML emails are the perfect format since we can add links back to the template.\\n* Finally, we use the Outlook node to send the email digest to the subscriber.\\n\\n### How to use\\n* Populate your Excel sheet with 3 columns: name, email and categories. Categories is a comma-delimited list of categories which match the n8n template website. The available categories are AI, SecOps, Sales, IT Ops, Marketing, Engineering, DevOps, Building Blocks, Design, Finance, HR, Other, Product and Support.\\n* To subscribe a new user, simply add their email to the Excel sheet with at least one category.\\n* To unsubscribe a user, remove them from the sheet.\\n* If you're not interested in paid templates, you may want to filter them out after fetching them.\\n\\n### Need Help?\\nJoin the [Discord](https://discord.com/invite/XPKeKXeB7d) or ask in the [Forum](https://community.n8n.io/)!\"},\"typeVersion\":1}],\"pinData\":{},\"connections\":{\"Merge\":{\"main\":[[{\"node\":\"For Each Subscriber\",\"type\":\"main\",\"index\":0}]]},\"Aggregate\":{\"main\":[[{\"node\":\"For Each Category\",\"type\":\"main\",\"index\":0}]]},\"Parse Rows\":{\"main\":[[{\"node\":\"Get Unique Categories\",\"type\":\"main\",\"index\":0},{\"node\":\"Merge\",\"type\":\"main\",\"index\":0}]]},\"Collect Fields\":{\"main\":[[{\"node\":\"Aggregate\",\"type\":\"main\",\"index\":0}]]},\"Append Category\":{\"main\":[[{\"node\":\"For Each Category\",\"type\":\"main\",\"index\":0}]]},\"Get Subscribers\":{\"main\":[[{\"node\":\"Parse Rows\",\"type\":\"main\",\"index\":0}]]},\"Schedule Trigger\":{\"main\":[[{\"node\":\"Get Subscribers\",\"type\":\"main\",\"index\":0}]]},\"Combine Workflows\":{\"main\":[[{\"node\":\"With User Reference\",\"type\":\"main\",\"index\":0}]]},\"Flatten Workflows\":{\"main\":[[{\"node\":\"Merge\",\"type\":\"main\",\"index\":1}]]},\"For Each Category\":{\"main\":[[{\"node\":\"Flatten Workflows\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Workflows to Items\",\"type\":\"main\",\"index\":0}]]},\"OpenAI Chat Model\":{\"ai_languageModel\":[[{\"node\":\"Workflow Summarizer\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"Workflow to Items\":{\"main\":[[{\"node\":\"Remove Already Seen\",\"type\":\"main\",\"index\":0}]]},\"Has New Workflows?\":{\"main\":[[{\"node\":\"Generate HTML Template\",\"type\":\"main\",\"index\":0}],[{\"node\":\"No Operation, do nothing\",\"type\":\"main\",\"index\":0}]]},\"Workflows to Items\":{\"main\":[[{\"node\":\"Workflow Summarizer\",\"type\":\"main\",\"index\":0}]]},\"Categories to Items\":{\"main\":[[{\"node\":\"Fetch Latest 10 per Category\",\"type\":\"main\",\"index\":0}]]},\"For Each Subscriber\":{\"main\":[[{\"node\":\"Has New Workflows?\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Get Relevant Workflows\",\"type\":\"main\",\"index\":0}]]},\"Remove Already Seen\":{\"main\":[[{\"node\":\"Combine Workflows\",\"type\":\"main\",\"index\":0}]]},\"With User Reference\":{\"main\":[[{\"node\":\"For Each Subscriber\",\"type\":\"main\",\"index\":0}]]},\"Workflow Summarizer\":{\"main\":[[{\"node\":\"Collect Fields\",\"type\":\"main\",\"index\":0}]]},\"Get Unique Categories\":{\"main\":[[{\"node\":\"Categories to Items\",\"type\":\"main\",\"index\":0}]]},\"Generate HTML Template\":{\"main\":[[{\"node\":\"Send Daily Digest\",\"type\":\"main\",\"index\":0}]]},\"Get Relevant Workflows\":{\"main\":[[{\"node\":\"Workflow to Items\",\"type\":\"main\",\"index\":0}]]},\"Fetch Latest 10 per Category\":{\"main\":[[{\"node\":\"Append Category\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "### This n8n template builds a newsletter (\"daily digest\") delivery service which pulls and summarises the latest [n8n.io](http://n8n.io) template in select categories defined by subscribers.\n\nIt's scheduled to run once a day and sends the newsletter directly to subscriber via a nicely formatted email. If you've had trouble keeping up with the latest and greatest templates beign published daily, this workflow can save you a lot of time!\n\n### How it works\n\n  * A scheduled trigger pulls a list of subscribers (email and category preferences) from an Excel workbook.\n  * We work out unique categories amongst all subscribers and only fetch the latest n8n website templates from these categories to save on resources and optimise the number of API calls we make.\n  * The fetched templates are summarised via AI to produce a short description which is more suitable for our email format.\n  * For each subscriber, we filter and collect only the templates relevant to their category preferences (as defined in the Excel) and ensure that duplicate templates or those which have been \"seen before\" are omitted.\n  * A HTML node is then used to generate the email newsletter. HTML emails are the perfect format since we can add links back to the template.\n  * Finally, we use the Outlook node to send the email digest to the subscriber.\n\n\n\n### How to use\n\n  * Populate your Excel sheet with 3 columns: name, email and categories. Categories is a comma-delimited list of categories which match the n8n template website. The available categories are AI, SecOps, Sales, IT Ops, Marketing, Engineering, DevOps, Building Blocks, Design, Finance, HR, Other, Product and Support.\n  * To subscribe a new user, simply add their email to the Excel sheet with at least one category.\n  * To unsubscribe a user, remove them from the sheet.\n  * If you're not interested in paid templates, you may want to filter them out after fetching.\n\n\n\n### Requirements\n\n  * Microsoft Excel for subscriber list\n  * Microsoft Outlook for delivering emails\n  * OpenAI for AI-generated descriptions\n\n\n\n### Customising the workflow\n\n  * Use AI to summarise the week's trend of templates types and use-cases\n  * This template can be the basis for other similar newsletters - just pull in a list of things from anywhere!\n\n\n",
  "readme_html": "<!--[--><div data-v-006f9244=\"\"><h3>This n8n template builds a newsletter (\"daily digest\") delivery service which pulls and summarises the latest <a href=\"http://n8n.io\" rel=\"ugc nofollow\" target=\"_blank\">n8n.io</a> template in select categories defined by subscribers.</h3>\n<p>It's scheduled to run once a day and sends the newsletter directly to subscriber via a nicely formatted email. If you've had trouble keeping up with the latest and greatest templates beign published daily, this workflow can save you a lot of time!</p>\n<h3>How it works</h3>\n<ul>\n<li>A scheduled trigger pulls a list of subscribers (email and category preferences) from an Excel workbook.</li>\n<li>We work out unique categories amongst all subscribers and only fetch the latest n8n website templates from these categories to save on resources and optimise the number of API calls we make.</li>\n<li>The fetched templates are summarised via AI to produce a short description which is more suitable for our email format.</li>\n<li>For each subscriber, we filter and collect only the templates relevant to their category preferences (as defined in the Excel) and ensure that duplicate templates or those which have been \"seen before\" are omitted.</li>\n<li>A HTML node is then used to generate the email newsletter. HTML emails are the perfect format since we can add links back to the template.</li>\n<li>Finally, we use the Outlook node to send the email digest to the subscriber.</li>\n</ul>\n<h3>How to use</h3>\n<ul>\n<li>Populate your Excel sheet with 3 columns: name, email and categories. Categories is a comma-delimited list of categories which match the n8n template website. The available categories are AI, SecOps, Sales, IT Ops, Marketing, Engineering, DevOps, Building Blocks, Design, Finance, HR, Other, Product and Support.</li>\n<li>To subscribe a new user, simply add their email to the Excel sheet with at least one category.</li>\n<li>To unsubscribe a user, remove them from the sheet.</li>\n<li>If you're not interested in paid templates, you may want to filter them out after fetching.</li>\n</ul>\n<h3>Requirements</h3>\n<ul>\n<li>Microsoft Excel for subscriber list</li>\n<li>Microsoft Outlook for delivering emails</li>\n<li>OpenAI for AI-generated descriptions</li>\n</ul>\n<h3>Customising the workflow</h3>\n<ul>\n<li>Use AI to summarise the week's trend of templates types and use-cases</li>\n<li>This template can be the basis for other similar newsletters - just pull in a list of things from anywhere!</li>\n</ul>\n</div><!--]-->",
  "readme_zh": "### 该n8n模板构建了一个新闻简报（\"每日摘要\"）推送服务，可自动抓取并总结订阅者选定分类下的最新[n8n.io](http://n8n.io)模板。\n\n本模板设定每日自动运行，通过精美排版的电子邮件直接向订阅者发送简报。若您苦于无法及时跟进每日发布的最新优质模板，此工作流将为您大幅节省时间！\n\n### 运行原理\n\n  * 定时触发器从Excel工作簿获取订阅者列表（邮箱及分类偏好）\n  * 提取所有订阅者的唯一分类标签，仅从这些分类抓取最新n8n官网模板，节省资源并优化API调用次数\n  * 通过AI对抓取的模板进行摘要处理，生成更适合邮件格式的简短描述\n  * 为每位订阅者筛选仅符合其偏好分类的模板（依据Excel设定），并自动排除重复模板或已推送过的内容\n  * 使用HTML节点生成电子简报，该格式可完美嵌入模板返回链接\n  * 最终通过Outlook节点向订阅者发送邮件摘要\n\n### 使用指南\n\n  * Excel表格需包含三列：姓名、邮箱和分类（分类为逗号分隔的n8n官网模板分类标签）。可选分类包括：AI、SecOps、销售、IT运维、市场营销、工程、DevOps、基础模块、设计、财务、人力资源、其他、产品和客服\n  * 新增订阅用户只需在Excel添加邮箱并标注至少一个分类\n  * 取消订阅直接删除对应行数据\n  * 若需排除付费模板，可在抓取后添加过滤条件\n\n### 环境要求\n\n  * 订阅列表管理：Microsoft Excel\n  * 邮件推送：Microsoft Outlook\n  * 摘要生成：OpenAI\n\n### 定制拓展\n\n  * 使用AI分析每周模板类型与应用场景趋势\n  * 本模板可作为其他类似简报服务的基础框架——只需替换数据源即可抓取任意内容！",
  "title_zh": "利用Excel、Outlook和AI实现的每日简报服务",
  "publish_date_absolute": "2025-04-11",
  "publish_date_zh": "上次更新于19天前",
  "workflow_json_zh": "{\n  \"meta\": {\n    \"instanceId\": \"408f9fb9940c3cb18ffdef0e0150fe342d6e655c3a9fac21f0f644e8bedabcd9\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"nodes\": [\n    {\n      \"id\": \"c3a9ba81-3a7e-4afe-be8b-cf482cbb88c2\",\n      \"name\": \"Schedule Trigger\",\n      \"type\": \"n8n-nodes-base.scheduleTrigger\",\n      \"position\": [\n        -1040,\n        -540\n      ],\n      \"parameters\": {\n        \"rule\": {\n          \"interval\": [\n            {\n              \"triggerAtHour\": 6\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"f63d035c-5a7b-4cf4-8730-5fa7dff6f94b\",\n      \"name\": \"Get Subscribers\",\n      \"type\": \"n8n-nodes-base.microsoftExcel\",\n      \"position\": [\n        -860,\n        -540\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"resource\": \"worksheet\",\n        \"workbook\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"=\"\n        },\n        \"operation\": \"readRows\",\n        \"worksheet\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"=\"\n        }\n      },\n      \"credentials\": {\n        \"microsoftExcelOAuth2Api\": {\n          \"id\": \"56tIUYYVARBe9gfX\",\n          \"name\": \"Microsoft Excel account\"\n        }\n      },\n      \"typeVersion\": 2.1\n    },\n    {\n      \"id\": \"e93aa8de-5c68-4a01-ae60-beb141e0a430\",\n      \"name\": \"Get Unique Categories\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        -400,\n        -160\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"fe138128-50d5-469f-8c0b-0af8c873f198\",\n              \"name\": \"categories\",\n              \"type\": \"array\",\n              \"value\": \"={{ $input.all().flatMap(item => item.json.categories).unique() }}\"\n            }\n          ]\n        }\n      },\n      \"executeOnce\": true,\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"a874ae4e-d67e-4019-9e5c-03ea677468ae\",\n      \"name\": \"OpenAI Chat Model\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\n      \"position\": [\n        760,\n        80\n      ],\n      \"parameters\": {\n        \"model\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"gpt-4o-mini\"\n        },\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"8gccIjcuf3gvaoEr\",\n          \"name\": \"OpenAi account\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"bc9c7578-3b6f-45fb-9f93-94637774d125\",\n      \"name\": \"Aggregate\",\n      \"type\": \"n8n-nodes-base.aggregate\",\n      \"position\": [\n        1180,\n        40\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"aggregate\": \"aggregateAllItemData\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"ae83c9e2-a267-463c-a606-b4d101f93f92\",\n      \"name\": \"Collect Fields\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        980,\n        -60\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"4a266505-4b88-41cf-bf22-f38c705c27e5\",\n              \"name\": \"workflow_id\",\n              \"type\": \"number\",\n              \"value\": \"={{ $('Workflows to Items').item.json.workflow.id }}\"\n            },\n            {\n              \"id\": \"df3348e2-b6ec-4c38-a146-c38be9b830bc\",\n              \"name\": \"workflow_name\",\n              \"type\": \"string\",\n              \"value\": \"={{ $('Workflows to Items').item.json.workflow.name }}\"\n            },\n            {\n              \"id\": \"b4646059-748f-407a-b829-d6605d5ab683\",\n              \"name\": \"workflow_desc\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.response.text }}\"\n            },\n            {\n              \"id\": \"eac0d9ab-9445-4bc2-9e64-160fe44b9ace\",\n              \"name\": \"workflow_created_at\",\n              \"type\": \"string\",\n              \"value\": \"={{ $('Workflows to Items').item.json.workflow.createdAt }}\"\n            },\n            {\n              \"id\": \"24a3c0cb-224c-4ce6-b59e-38b10ab2c02f\",\n              \"name\": \"author_id\",\n              \"type\": \"number\",\n              \"value\": \"={{ $('Workflows to Items').item.json.workflow.user.id }}\"\n            },\n            {\n              \"id\": \"a2b8a52f-be72-484c-aa86-582b73be1859\",\n              \"name\": \"author_name\",\n              \"type\": \"string\",\n              \"value\": \"={{ $('Workflows to Items').item.json.workflow.user.name }}\"\n            },\n            {\n              \"id\": \"ae735511-8c7c-4bef-b6ac-cfe3d4b87b4f\",\n              \"name\": \"author_username\",\n              \"type\": \"string\",\n              \"value\": \"={{ $('Workflows to Items').item.json.workflow.user.username }}\"\n            },\n            {\n              \"id\": \"2dc1f59f-a854-4322-85df-c5998f782dcd\",\n              \"name\": \"category\",\n              \"type\": \"string\",\n              \"value\": \"={{ $('For Each Category').item.json.category }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"8ca1ea7e-9098-4e82-919b-ba98ae7d7574\",\n      \"name\": \"Categories to Items\",\n      \"type\": \"n8n-nodes-base.splitOut\",\n      \"position\": [\n        -220,\n        -160\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"destinationFieldName\": \"category\"\n        },\n        \"fieldToSplitOut\": \"categories\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"eb6d74b8-f1ed-4ab2-8c5f-7e6c6361b055\",\n      \"name\": \"For Each Category\",\n      \"type\": \"n8n-nodes-base.splitInBatches\",\n      \"position\": [\n        320,\n        -160\n      ],\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"8640ffac-9df6-4154-bcd5-dfa90c3843d4\",\n      \"name\": \"Workflows to Items\",\n      \"type\": \"n8n-nodes-base.splitOut\",\n      \"position\": [\n        500,\n        -60\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"destinationFieldName\": \"workflow\"\n        },\n        \"fieldToSplitOut\": \"workflows\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"4456a43b-df26-4bb8-a62d-b9f05eff4479\",\n      \"name\": \"Workflow Summarizer\",\n      \"type\": \"@n8n/n8n-nodes-langchain.chainLlm\",\n      \"position\": [\n        660,\n        -60\n      ],\n      \"parameters\": {\n        \"text\": \"=## Description\\n```\\n{{ $json.workflow.description.replaceAll('#', '') }}\\n```\",\n        \"messages\": {\n          \"messageValues\": [\n            {\n              \"message\": \"=You have received a description of a n8n template from the official template gallery. Your task is to summarize the description into one or two sentences. The summary should loosely follow the structure of:\\n* identify the goal of the template\\n* describe the method or approached implemented\\n* highlight which important n8n nodes were used\\n\\neg. \\\"Obtain real-time crypto market insights using an AI-powered workflow with CoinMarketCap APIs through Telegram\\\"\"\n            }\n          ]\n        },\n        \"promptType\": \"define\"\n      },\n      \"typeVersion\": 1.5\n    },\n    {\n      \"id\": \"5f4a5921-c954-4523-8925-90401d8dbf22\",\n      \"name\": \"Merge\",\n      \"type\": \"n8n-nodes-base.merge\",\n      \"position\": [\n        660,\n        -460\n      ],\n      \"parameters\": {\n        \"mode\": \"chooseBranch\"\n      },\n      \"typeVersion\": 3.1\n    },\n    {\n      \"id\": \"f95fb28c-875c-4105-aa83-9fea257ea440\",\n      \"name\": \"Fetch Latest 10 per Category\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        -40,\n        -160\n      ],\n      \"parameters\": {\n        \"url\": \"=https://n8n.io/api/product-api/workflows/search\",\n        \"options\": {},\n        \"sendQuery\": true,\n        \"queryParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"category\",\n              \"value\": \"={{$json.category }}\"\n            },\n            {\n              \"name\": \"rows\",\n              \"value\": \"10\"\n            },\n            {\n              \"name\": \"sort\",\n              \"value\": \"createdAt:desc\"\n            },\n            {\n              \"name\": \"page\",\n              \"value\": \"1\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"4dda6cbc-e53f-452d-b257-df9ef18abd75\",\n      \"name\": \"No Operation, do nothing\",\n      \"type\": \"n8n-nodes-base.noOp\",\n      \"position\": [\n        1560,\n        -460\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"881337d8-3ca8-43d2-931f-9cfec16cc367\",\n      \"name\": \"Get Relevant Workflows\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1380,\n        -280\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"fbd0ad94-e5aa-4082-81f5-d7b2e08dfbcf\",\n              \"name\": \"workflows\",\n              \"type\": \"array\",\n              \"value\": \"={{\\n$json.categories\\n  .flatMap(cat =>\\n    $('Flatten Workflows').first().json.workflows.filter(item => item.category === cat)\\n  )\\n}}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"b3ad0e26-e495-4dae-bfdd-f65961178acc\",\n      \"name\": \"Flatten Workflows\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        500,\n        -280\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"17a82dd9-3fcf-44d9-b5da-bf89a1f53d59\",\n              \"name\": \"workflows\",\n              \"type\": \"array\",\n              \"value\": \"={{\\n$input.all().flatMap(item => item.json.data)\\n}}\"\n            }\n          ]\n        }\n      },\n      \"executeOnce\": true,\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"05f72731-f8b0-4d8f-ba78-66ef8fbaf059\",\n      \"name\": \"Remove Already Seen\",\n      \"type\": \"n8n-nodes-base.removeDuplicates\",\n      \"position\": [\n        1740,\n        -280\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"operation\": \"removeItemsSeenInPreviousExecutions\",\n        \"dedupeValue\": \"={{ $('For Each Subscriber').item.json.name.toSnakeCase() }}_{{ $json.workflow_id }}\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"3904d2a2-9a95-4e11-883e-b2e88c6a884f\",\n      \"name\": \"Workflow to Items\",\n      \"type\": \"n8n-nodes-base.splitOut\",\n      \"position\": [\n        1560,\n        -280\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"fieldToSplitOut\": \"workflows\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"d416dee7-df0f-4579-a25f-6baed16453e8\",\n      \"name\": \"Combine Workflows\",\n      \"type\": \"n8n-nodes-base.aggregate\",\n      \"position\": [\n        1920,\n        -280\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"aggregate\": \"aggregateAllItemData\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"3797dd21-3144-47e8-9359-841b97073001\",\n      \"name\": \"Has New Workflows?\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        1380,\n        -600\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"08403b2a-4ae6-4cf5-aa88-cc49441e3c56\",\n              \"operator\": {\n                \"type\": \"array\",\n                \"operation\": \"lengthGt\",\n                \"rightType\": \"number\"\n              },\n              \"leftValue\": \"={{ $json.data }}\",\n              \"rightValue\": 0\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"0cd6ce35-c083-4db6-bc87-9d21e70a3bab\",\n      \"name\": \"With User Reference\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        2100,\n        -280\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"d69921eb-b518-4614-af63-e67a521ee373\",\n              \"name\": \"name\",\n              \"type\": \"string\",\n              \"value\": \"={{ $('For Each Subscriber').item.json.name }}\"\n            },\n            {\n              \"id\": \"01ee6e0a-9d03-42f6-ad46-68b9df861679\",\n              \"name\": \"email\",\n              \"type\": \"string\",\n              \"value\": \"={{ $('For Each Subscriber').item.json.email }}\"\n            },\n            {\n              \"id\": \"5263e512-1b24-43c8-9033-6547dab2811b\",\n              \"name\": \"categories\",\n              \"type\": \"array\",\n              \"value\": \"={{ $('For Each Subscriber').item.json.categories }}\"\n            }\n          ]\n        },\n        \"includeOtherFields\": true\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"b3a616c7-615f-49ff-8e6f-530324a98be4\",\n      \"name\": \"Generate HTML Template\",\n      \"type\": \"n8n-nodes-base.html\",\n      \"position\": [\n        1740,\n        -720\n      ],\n      \"parameters\": {\n        \"html\": \"<h1>New Workflows for {{ $now.format('DD') }}</h1>\\n{{\\n$json.categories\\n  .filter(cat =>\\n    $json.data.filter(item => item.category === cat).length > 0\\n  )\\n  .map(category => `\\n    <h2>${category.toSentenceCase()}</h2>\\n    <ul>\\n    ${$json.data\\n      .filter(workflow => workflow.category === category)\\n      .map(workflow => `\\n      <li>\\n        <a href=\\\"https://n8n.io/workflows/${workflow.workflow_id}\\\">\\n          <h3>${workflow.workflow_name}</h3>\\n        </a>\\n        <p>\\n          by\\n          <a href=\\\"https://n8n.io/creators/${workflow.author_username}\\\">\\n            ${workflow.author_name}\\n          </a>\\n          &middot;\\n          created on ${DateTime.fromISO(workflow.workflow_created_at).toFormat('DD')}\\n        </p>\\n        <p>${workflow.workflow_desc}</p>\\n      </li>\\n    `).join('\\\\n')}\\n    </ul>\\n  `)\\n  .join('\\\\n')\\n}}\"\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"0c9865c7-9352-4fda-a943-34c8f524de6c\",\n      \"name\": \"Parse Rows\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        -660,\n        -540\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"d89dfc07-3c1f-4fbc-9a52-3748797a4840\",\n              \"name\": \"name\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.name }}\"\n            },\n            {\n              \"id\": \"c622ceca-2e6d-4bab-bb08-235f704c7e2f\",\n              \"name\": \"email\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.email }}\"\n            },\n            {\n              \"id\": \"9fca8e33-330a-4e4d-b461-251cd7e5c620\",\n              \"name\": \"categories\",\n              \"type\": \"array\",\n              \"value\": \"={{ $json.categories.split(',') }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"f5fbd7f2-65e5-4dd7-8e43-38a8a99e3321\",\n      \"name\": \"Send Daily Digest\",\n      \"type\": \"n8n-nodes-base.microsoftOutlook\",\n      \"position\": [\n        1920,\n        -720\n      ],\n      \"webhookId\": \"8cd83f97-1e5f-4280-9a9d-26d1ee05c45e\",\n      \"parameters\": {\n        \"subject\": \"=New Workflows for {{ $now.format('DD') }}\",\n        \"bodyContent\": \"={{\\n$json.html\\n  .replaceAll('\\\\n', '')\\n  .replaceAll('  ', '')\\n  .trim()\\n}}\",\n        \"toRecipients\": \"={{ $('Has New Workflows?').item.json.email }}\",\n        \"additionalFields\": {\n          \"from\": \"=no-reply <no-reply@example.com>\",\n          \"replyTo\": \"=no-reply <no-reply@example.com>\",\n          \"bodyContentType\": \"html\"\n        }\n      },\n      \"credentials\": {\n        \"microsoftOutlookOAuth2Api\": {\n          \"id\": \"EWg6sbhPKcM5y3Mr\",\n          \"name\": \"Microsoft Outlook account\"\n        }\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"e81ba3a0-e3f6-4231-8870-8ef03edf41e1\",\n      \"name\": \"Append Category\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        140,\n        -160\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"b965dee8-f3b5-419b-b39a-79bf2b7d04c1\",\n              \"name\": \"category\",\n              \"type\": \"string\",\n              \"value\": \"={{ $('Categories to Items').item.json.category }}\"\n            }\n          ]\n        },\n        \"includeOtherFields\": true\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"e1c2c743-a560-47e8-b906-a2e8fd17622f\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -1060,\n        -740\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 440,\n        \"content\": \"## 1. 从Excel获取订阅者\\n[了解更多关于Excel节点的信息](https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.microsoftexcel)\\n\\nExcel是存储简单订阅者列表的便捷方式，这些订阅者将接收我们的每日摘要。我们还可以专门指定他们感兴趣的类别。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"e10a23be-2af7-4b92-9b5f-df855e6ee349\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -400,\n        -420\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 620,\n        \"height\": 220,\n        \"content\": \"## 2. 从n8n获取最新模板  \\n[了解HTTP请求节点的更多信息](https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.httprequest)  \\n\\n通过HTTP请求节点，我们可以调用n8n.io的模板搜索API来获取最新发布的模板。但为了节省资源，我们只需获取与订阅用户相关的分类模板。具体步骤如下：  \\n1) 仅从所有订阅用户涉及的不同分类中获取最新模板  \\n2) 一次性完成获取操作，后续供所有订阅用户引用\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"0ee0b2ca-0247-4471-a6f5-920fd8e67f96\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        500,\n        260\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 580,\n        \"height\": 180,\n        \"content\": \"## 3. 为每个模板生成AI摘要\\n[详细了解基础LLM节点](https://docs.n8n.io/integrations/builtin/cluster-nodes/root-nodes/n8n-nodes-langchain.chainllm)\\n\\n在构建电子邮件摘要时，我们更希望获得每个模板描述的简短摘要版本，以便于快速浏览和阅读。我们可以利用AI技术实现这一目标，并将其与模板对象合并。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"ab234694-2878-440b-aeb5-37573ebe517e\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1680,\n        -60\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 580,\n        \"height\": 200,\n        \"content\": \"## 4. 为订阅者筛选相关模板\\n[详细了解拆分输出节点](https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.splitout)\\n\\n针对每位订阅者，我们需要根据Excel表格中定义的订阅者相关分类，从新收集的n8n.io模板中筛选出匹配项。通过\\\"去重\\\"节点可追踪重复模板——由于同一模板可能属于多个分类而重复出现！\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"460a8b3d-c125-41c3-95c5-afdfe63c7561\",\n      \"name\": \"Sticky Note4\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1740,\n        -960\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 580,\n        \"height\": 200,\n        \"content\": \"## 5. 生成每日摘要并通过Outlook发送\\n[进一步了解Outlook节点](https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.microsoftoutlook)\\n\\n最后，我们可以使用HTML节点构建摘要内容，并根据订阅者需求进行个性化定制。随后通过Outlook节点将摘要发送给订阅者。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"c79a2775-6276-41df-a9f0-64017e88a8c7\",\n      \"name\": \"Sticky Note5\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -500,\n        0\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 200,\n        \"height\": 120,\n        \"content\": \"### 执行一次\\n此节点已设置为仅执行一次，而非为每个订阅者执行。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"5290822e-b63b-4b73-8511-6a12e2387656\",\n      \"name\": \"Sticky Note6\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -940,\n        -360\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 280,\n        \"height\": 120,\n        \"content\": \"### 列\\n- 姓名 *(文本)*\\n- 电子邮箱 *(文本)*\\n- 分类 *(文本，逗号分隔)*\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"56acbd11-7fa5-44b8-b031-fcdeb6e44839\",\n      \"name\": \"For Each Subscriber\",\n      \"type\": \"n8n-nodes-base.splitInBatches\",\n      \"position\": [\n        1180,\n        -460\n      ],\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"6aef7efc-1bc7-4a1d-b0cb-459484b3d179\",\n      \"name\": \"Sticky Note7\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -1600,\n        -1400\n      ],\n      \"parameters\": {\n        \"width\": 500,\n        \"height\": 1000,\n        \"content\": \"## 试试看吧！\\n### 这个n8n模板构建了一个新闻简报（\\\"每日摘要\\\"）推送服务，它能根据订阅者选择的分类抓取并总结n8n.io官网上最新的模板。\\n\\n该服务每天定时运行，通过排版精美的邮件将新闻简报直接发送给订阅者。如果你苦于无法及时跟进每日发布的最新优质模板，这个工作流能为你节省大量时间！\\n\\n### 工作原理\\n* 定时触发器从Excel工作表中拉取订阅者列表（包含邮箱和分类偏好）\\n* 系统计算所有订阅者的唯一分类组合，仅从这些分类中抓取最新的n8n官网模板，从而节省资源并优化API调用次数\\n* 通过AI对抓取的模板进行总结，生成更适合邮件格式的简短描述\\n* 为每位订阅者筛选仅符合其分类偏好（定义在Excel中）的模板，并确保排除重复模板或\\\"已推送过\\\"的内容\\n* 使用HTML节点生成邮件简报。HTML邮件是理想格式，可添加返回模板页面的链接\\n* 最后通过Outlook节点将摘要邮件发送给订阅者\\n\\n### 使用指南\\n* 在Excel表中维护三列数据：姓名、邮箱和分类（分类需与n8n模板官网匹配，多个分类用英文逗号分隔）。可用分类包括：AI、SecOps、销售、IT运维、市场营销、工程、DevOps、基础模块、设计、财务、人力资源、其他、产品和客服\\n* 新增订阅用户只需在Excel表中添加其邮箱和至少一个分类\\n* 取消订阅只需从表中删除对应行\\n* 若不需要付费模板，可在抓取后添加过滤步骤\\n\\n### 需要帮助？\\n加入[Discord社区](https://discord.com/invite/XPKeKXeB7d)或访问[官方论坛](https://community.n8n.io/)提问！\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"pinData\": {},\n  \"connections\": {\n    \"Merge\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"For Each Subscriber\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Aggregate\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"For Each Category\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Parse Rows\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get Unique Categories\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Merge\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Collect Fields\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Aggregate\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Append Category\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"For Each Category\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get Subscribers\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Parse Rows\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Schedule Trigger\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get Subscribers\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Combine Workflows\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"With User Reference\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Flatten Workflows\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge\",\n            \"type\": \"main\",\n            \"index\": 1\n          }\n        ]\n      ]\n    },\n    \"For Each Category\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Flatten Workflows\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Workflows to Items\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"OpenAI Chat Model\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"Workflow Summarizer\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Workflow to Items\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Remove Already Seen\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Has New Workflows?\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Generate HTML Template\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"No Operation, do nothing\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Workflows to Items\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Workflow Summarizer\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Categories to Items\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Fetch Latest 10 per Category\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"For Each Subscriber\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Has New Workflows?\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Get Relevant Workflows\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Remove Already Seen\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Combine Workflows\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"With User Reference\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"For Each Subscriber\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Workflow Summarizer\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Collect Fields\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get Unique Categories\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Categories to Items\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Generate HTML Template\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Send Daily Digest\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get Relevant Workflows\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Workflow to Items\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Fetch Latest 10 per Category\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Append Category\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}