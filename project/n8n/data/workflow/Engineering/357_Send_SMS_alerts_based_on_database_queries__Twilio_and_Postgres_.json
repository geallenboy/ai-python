{
  "title": "Send SMS alerts based on database queries (Twilio and Postgres)",
  "url": "https://n8n.io/workflows/357-send-sms-alerts-based-on-database-queries-twilio-and-postgres/",
  "category": "Engineering",
  "category_url": "https://n8n.io/workflows/categories/engineering/?sort=createdAt:desc",
  "author": "tanaypant",
  "publish_date": "Last update 10 months ago",
  "publish_date_absolute": "2024-07-07",
  "content": "",
  "workflow_json": "{\"id\":\"34\",\"name\":\"Monitoring and alerting\",\"nodes\":[{\"name\":\"Cron\",\"type\":\"n8n-nodes-base.cron\",\"position\":[250,200],\"parameters\":{},\"typeVersion\":1},{\"name\":\"Postgres\",\"type\":\"n8n-nodes-base.postgres\",\"position\":[450,200],\"parameters\":{\"query\":\"SELECT * FROM n8n WHERE value > 70 AND notification = false;\",\"operation\":\"executeQuery\"},\"credentials\":{\"postgres\":\"Postgres\"},\"typeVersion\":1},{\"name\":\"Twilio\",\"type\":\"n8n-nodes-base.twilio\",\"position\":[650,200],\"parameters\":{\"to\":\"\",\"from\":\"\",\"message\":\"=🚨 The Sensor ({{$node[\\\"Postgres\\\"].json[\\\"sensor_id\\\"]}}) showed a reading of {{$node[\\\"Postgres\\\"].json[\\\"value\\\"]}}.\"},\"credentials\":{\"twilioApi\":\"Twilio\"},\"typeVersion\":1},{\"name\":\"Set\",\"type\":\"n8n-nodes-base.set\",\"position\":[850,200],\"parameters\":{\"values\":{\"number\":[{\"name\":\"id\",\"value\":\"={{$node[\\\"Postgres\\\"].json[\\\"id\\\"]}}\"}],\"boolean\":[{\"name\":\"notification\",\"value\":true}]},\"options\":{},\"keepOnlySet\":true},\"typeVersion\":1},{\"name\":\"Postgres1\",\"type\":\"n8n-nodes-base.postgres\",\"position\":[1050,200],\"parameters\":{\"table\":\"n8n\",\"columns\":\"notification\",\"operation\":\"update\"},\"credentials\":{\"postgres\":\"Postgres\"},\"typeVersion\":1}],\"active\":false,\"settings\":{},\"connections\":{\"Set\":{\"main\":[[{\"node\":\"Postgres1\",\"type\":\"main\",\"index\":0}]]},\"Cron\":{\"main\":[[{\"node\":\"Postgres\",\"type\":\"main\",\"index\":0}]]},\"Twilio\":{\"main\":[[{\"node\":\"Set\",\"type\":\"main\",\"index\":0}]]},\"Postgres\":{\"main\":[[{\"node\":\"Twilio\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "This workflow automatically queries a Postgres database to find outlier readings for which SMS notifications have not been sent.  \nThis is Workflow 2 in the blog tutorial [Database activity monitoring and alerting](https://blog.n8n.io/database-monitoring-and-alerting-with-n8n/).\n\n## Prerequisites\n\n  * A Postgres database set up and [credentials](https://docs.n8n.io/integrations/credentials/postgres/)\n  * A Twilio account and [credentials](https://docs.n8n.io/integrations/credentials/twilio/)\n\n\n\n## Nodes\n\n  * [Cron node](https://docs.n8n.io/integrations/core-nodes/n8n-nodes-base.cron/) triggers the workflow every minute, so the database is queried at regular intervals.\n  * [Postgres nodes](https://docs.n8n.io/integrations/nodes/n8n-nodes-base.postgres/) extract values from, and update values in the database.\n  * [Twilio node](https://docs.n8n.io/integrations/nodes/n8n-nodes-base.twilio/) sends an alert SMS about the outlier reading to a specified phone number.\n  * [Set node](https://docs.n8n.io/integrations/core-nodes/n8n-nodes-base.set/) sets the notification value to _true_.\n\n\n",
  "readme_html": "<!--[--><div data-v-50766329=\"\"><p>This workflow automatically queries a Postgres database to find outlier readings for which SMS notifications have not been sent.<br>\nThis is Workflow 2 in the blog tutorial <a href=\"https://blog.n8n.io/database-monitoring-and-alerting-with-n8n/\" rel=\"ugc nofollow\" target=\"_blank\">Database activity monitoring and alerting</a>.</p>\n<h2>Prerequisites</h2>\n<ul>\n<li>A Postgres database set up and <a href=\"https://docs.n8n.io/integrations/credentials/postgres/\" rel=\"ugc nofollow\" target=\"_blank\">credentials</a></li>\n<li>A Twilio account and <a href=\"https://docs.n8n.io/integrations/credentials/twilio/\" rel=\"ugc nofollow\" target=\"_blank\">credentials</a></li>\n</ul>\n<h2>Nodes</h2>\n<ul>\n<li><a href=\"https://docs.n8n.io/integrations/core-nodes/n8n-nodes-base.cron/\" rel=\"ugc nofollow\" target=\"_blank\">Cron node</a> triggers the workflow every minute, so the database is queried at regular intervals.</li>\n<li><a href=\"https://docs.n8n.io/integrations/nodes/n8n-nodes-base.postgres/\" rel=\"ugc nofollow\" target=\"_blank\">Postgres nodes</a> extract values from, and update values in the database.</li>\n<li><a href=\"https://docs.n8n.io/integrations/nodes/n8n-nodes-base.twilio/\" rel=\"ugc nofollow\" target=\"_blank\">Twilio node</a> sends an alert SMS about the outlier reading to a specified phone number.</li>\n<li><a href=\"https://docs.n8n.io/integrations/core-nodes/n8n-nodes-base.set/\" rel=\"ugc nofollow\" target=\"_blank\">Set node</a> sets the notification value to <em>true</em>.</li>\n</ul>\n</div><!--]-->",
  "readme_zh": "该工作流会自动查询Postgres数据库，找出尚未发送短信通知的异常读数。  \n此为博客教程《数据库活动监控与告警》中的工作流2（[原文链接](https://blog.n8n.io/database-monitoring-and-alerting-with-n8n/)）。\n\n## 先决条件\n\n* 已设置Postgres数据库及[凭证](https://docs.n8n.io/integrations/credentials/postgres/)  \n* 拥有Twilio账号及[凭证](https://docs.n8n.io/integrations/credentials/twilio/)\n\n## 节点说明\n\n* [定时触发器节点](https://docs.n8n.io/integrations/core-nodes/n8n-nodes-base.cron/)每分钟触发工作流，实现定期查询数据库  \n* [Postgres节点](https://docs.n8n.io/integrations/nodes/n8n-nodes-base.postgres/)执行数据库数值提取与更新操作  \n* [Twilio节点](https://docs.n8n.io/integrations/nodes/n8n-nodes-base.twilio/)向指定号码发送异常读数告警短信  \n* [赋值节点](https://docs.n8n.io/integrations/core-nodes/n8n-nodes-base.set/)将通知状态标记设为_true_  \n\n（注：中文技术文档中\"node\"通常译为\"节点\"，\"credentials\"译为\"凭证/认证信息\"，\"workflow\"译为\"工作流\"。链接保留原貌以便用户直接访问英文文档。）",
  "title_zh": "基于数据库查询发送短信提醒（使用Twilio和Postgres）",
  "publish_date_zh": "最后更新于10个月前",
  "workflow_json_zh": "{\"id\":\"34\",\"name\":\"Monitoring and alerting\",\"nodes\":[{\"name\":\"Cron\",\"type\":\"n8n-nodes-base.cron\",\"position\":[250,200],\"parameters\":{},\"typeVersion\":1},{\"name\":\"Postgres\",\"type\":\"n8n-nodes-base.postgres\",\"position\":[450,200],\"parameters\":{\"query\":\"SELECT * FROM n8n WHERE value > 70 AND notification = false;\",\"operation\":\"executeQuery\"},\"credentials\":{\"postgres\":\"Postgres\"},\"typeVersion\":1},{\"name\":\"Twilio\",\"type\":\"n8n-nodes-base.twilio\",\"position\":[650,200],\"parameters\":{\"to\":\"\",\"from\":\"\",\"message\":\"=🚨 The Sensor ({{$node[\\\"Postgres\\\"].json[\\\"sensor_id\\\"]}}) showed a reading of {{$node[\\\"Postgres\\\"].json[\\\"value\\\"]}}.\"},\"credentials\":{\"twilioApi\":\"Twilio\"},\"typeVersion\":1},{\"name\":\"Set\",\"type\":\"n8n-nodes-base.set\",\"position\":[850,200],\"parameters\":{\"values\":{\"number\":[{\"name\":\"id\",\"value\":\"={{$node[\\\"Postgres\\\"].json[\\\"id\\\"]}}\"}],\"boolean\":[{\"name\":\"notification\",\"value\":true}]},\"options\":{},\"keepOnlySet\":true},\"typeVersion\":1},{\"name\":\"Postgres1\",\"type\":\"n8n-nodes-base.postgres\",\"position\":[1050,200],\"parameters\":{\"table\":\"n8n\",\"columns\":\"notification\",\"operation\":\"update\"},\"credentials\":{\"postgres\":\"Postgres\"},\"typeVersion\":1}],\"active\":false,\"settings\":{},\"connections\":{\"Set\":{\"main\":[[{\"node\":\"Postgres1\",\"type\":\"main\",\"index\":0}]]},\"Cron\":{\"main\":[[{\"node\":\"Postgres\",\"type\":\"main\",\"index\":0}]]},\"Twilio\":{\"main\":[[{\"node\":\"Set\",\"type\":\"main\",\"index\":0}]]},\"Postgres\":{\"main\":[[{\"node\":\"Twilio\",\"type\":\"main\",\"index\":0}]]}}}"
}