{
  "title": "Automate SIEM Alert Enrichment with MITRE ATT&CK, Qdrant & Zendesk in n8n",
  "url": "https://n8n.io/workflows/2840-automate-siem-alert-enrichment-with-mitre-attandck-qdrant-and-zendesk-in-n8n/",
  "category": "SecOps",
  "category_url": "https://n8n.io/workflows/categories/secops/?count=20",
  "author": "Angel Menendez",
  "publish_date": "Last update 3 months ago",
  "content": "",
  "workflow_json": "{\"meta\":{\"instanceId\":\"cb484ba7b742928a2048bf8829668bed5b5ad9787579adea888f05980292a4a7\",\"templateCredsSetupCompleted\":true},\"nodes\":[{\"id\":\"86ddd018-3d6b-46b9-aa93-dedd6c6b5076\",\"name\":\"When chat message received\",\"type\":\"@n8n/n8n-nodes-langchain.chatTrigger\",\"position\":[-880,360],\"webhookId\":\"a9668bb8-bbe8-418a-b5c9-ff7dd431244f\",\"parameters\":{\"options\":{}},\"typeVersion\":1.1},{\"id\":\"a5ba5090-8e3b-4408-82df-92d2c524039e\",\"name\":\"AI Agent\",\"type\":\"@n8n/n8n-nodes-langchain.agent\",\"position\":[-680,360],\"parameters\":{\"options\":{\"systemMessage\":\"You are a cybersecurity expert trained on MITRE ATT&CK and enterprise incident response. Your job is to:\\n1. Extract TTP information from SIEM data.\\n2. Provide actionable remediation steps tailored to the alert.\\n3. Cross-reference historical patterns and related alerts.\\n4. Recommend external resources for deeper understanding.\\n\\nEnsure that:\\n- TTPs are tagged with the tactic, technique name, and technique ID.\\n- Remediation steps are specific and actionable.\\n- Historical data includes related alerts and notable trends.\\n- External links are relevant to the observed behavior.\\n\"}},\"typeVersion\":1.7},{\"id\":\"67c52944-b616-4ea6-9507-e9fb6fcdbe2b\",\"name\":\"OpenAI Chat Model\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\"position\":[-740,580],\"parameters\":{\"model\":\"gpt-4o\",\"options\":{}},\"credentials\":{\"openAiApi\":{\"id\":\"QpFZ2EiM3WGl6Zr3\",\"name\":\"Marketing OpenAI\"}},\"typeVersion\":1},{\"id\":\"55f6c16a-51ed-45e4-a1ab-aaaf1d7b5733\",\"name\":\"Split Out\",\"type\":\"n8n-nodes-base.splitOut\",\"position\":[-720,1220],\"parameters\":{\"options\":{},\"fieldToSplitOut\":\"data\"},\"typeVersion\":1},{\"id\":\"46a5b8c6-3d34-4e9b-b812-23135f28c278\",\"name\":\"Embeddings OpenAI1\",\"type\":\"@n8n/n8n-nodes-langchain.embeddingsOpenAi\",\"position\":[-580,1420],\"parameters\":{\"options\":{}},\"credentials\":{\"openAiApi\":{\"id\":\"QpFZ2EiM3WGl6Zr3\",\"name\":\"Marketing OpenAI\"}},\"typeVersion\":1.2},{\"id\":\"561b0737-26d5-450d-bd9e-08e0a608d6f9\",\"name\":\"Default Data Loader\",\"type\":\"@n8n/n8n-nodes-langchain.documentDefaultDataLoader\",\"position\":[-460,1440],\"parameters\":{\"options\":{\"metadata\":{\"metadataValues\":[{\"name\":\"id\",\"value\":\"={{ $json.id }}\"},{\"name\":\"name\",\"value\":\"={{ $json.name }}\"},{\"name\":\"killchain\",\"value\":\"={{ $json.kill_chain_phases }}\"},{\"name\":\"external\",\"value\":\"={{ $json.external_references }}\"}]}},\"jsonData\":\"={{ $json.description }}\",\"jsonMode\":\"expressionData\"},\"typeVersion\":1},{\"id\":\"6e8a4aed-7e8c-492a-b816-6ab1a98c312a\",\"name\":\"Token Splitter1\",\"type\":\"@n8n/n8n-nodes-langchain.textSplitterTokenSplitter\",\"position\":[-460,1620],\"parameters\":{},\"typeVersion\":1},{\"id\":\"0c54049e-b5e8-448f-b864-39aeb274de3e\",\"name\":\"Window Buffer Memory\",\"type\":\"@n8n/n8n-nodes-langchain.memoryBufferWindow\",\"position\":[-580,580],\"parameters\":{},\"typeVersion\":1.3},{\"id\":\"96b776a0-10da-4f70-99d0-ad6b6ee8fcca\",\"name\":\"Embeddings OpenAI2\",\"type\":\"@n8n/n8n-nodes-langchain.embeddingsOpenAi\",\"position\":[-460,720],\"parameters\":{\"model\":\"text-embedding-3-large\",\"options\":{\"dimensions\":1536}},\"credentials\":{\"openAiApi\":{\"id\":\"QpFZ2EiM3WGl6Zr3\",\"name\":\"Marketing OpenAI\"}},\"typeVersion\":1.2},{\"id\":\"695fba89-8f42-47c3-9d86-73f4ea0e72df\",\"name\":\"Extract from File\",\"type\":\"n8n-nodes-base.extractFromFile\",\"position\":[-920,1220],\"parameters\":{\"options\":{},\"operation\":\"fromJson\"},\"typeVersion\":1},{\"id\":\"0b9897b0-149b-43ce-b66c-e78552729aa5\",\"name\":\"When clicking ‘Test workflow’\",\"type\":\"n8n-nodes-base.manualTrigger\",\"position\":[-1360,1220],\"parameters\":{},\"typeVersion\":1},{\"id\":\"d8c29a14-0389-4748-a9de-686bf9a682c5\",\"name\":\"AI Agent1\",\"type\":\"@n8n/n8n-nodes-langchain.agent\",\"position\":[-540,-440],\"parameters\":{\"text\":\"=Siem Alert Data:\\nAlert: {{ $json.raw_subject }}\\nDescription: {{ $json.description }}\",\"options\":{\"systemMessage\":\"You are a cybersecurity expert trained on MITRE ATT&CK and enterprise incident response. Your job is to:\\n1. Extract TTP information from SIEM data.\\n2. Provide actionable remediation steps tailored to the alert.\\n3. Cross-reference historical patterns and related alerts.\\n4. Recommend external resources for deeper understanding.\\n\\nEnsure that:\\n- TTPs are tagged with the tactic, technique name, and technique ID.\\n- Remediation steps are specific and actionable.\\n- Historical data includes related alerts and notable trends.\\n- External links are relevant to the observed behavior.\\n\\nPlease output your response in html format, but do not include ```html at the beginning \\n\"},\"promptType\":\"define\",\"hasOutputParser\":true},\"typeVersion\":1.7},{\"id\":\"55d0b00a-5046-45fa-87cb-cb0257caae87\",\"name\":\"OpenAI Chat Model1\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\"position\":[-600,-220],\"parameters\":{\"model\":\"gpt-4o\",\"options\":{}},\"credentials\":{\"openAiApi\":{\"id\":\"QpFZ2EiM3WGl6Zr3\",\"name\":\"Marketing OpenAI\"}},\"typeVersion\":1},{\"id\":\"9b53566b-e021-403d-9d78-28504c5c1dfa\",\"name\":\"Embeddings OpenAI\",\"type\":\"@n8n/n8n-nodes-langchain.embeddingsOpenAi\",\"position\":[-320,-40],\"parameters\":{\"model\":\"text-embedding-3-large\",\"options\":{\"dimensions\":1536}},\"credentials\":{\"openAiApi\":{\"id\":\"QpFZ2EiM3WGl6Zr3\",\"name\":\"Marketing OpenAI\"}},\"typeVersion\":1.2},{\"id\":\"f3b44ef5-e928-4662-81ef-4dd044829607\",\"name\":\"Loop Over Items\",\"type\":\"n8n-nodes-base.splitInBatches\",\"position\":[-940,-440],\"parameters\":{\"options\":{}},\"typeVersion\":3},{\"id\":\"cc572b71-65c9-460c-bdcd-1d20feb15b32\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-1460,940],\"parameters\":{\"color\":7,\"width\":1380,\"height\":820,\"content\":\"![n8n](https://uploads.n8n.io/templates/qdrantlogo.png)\\n## Embed your Vector Store\\nTo provide data for your Vector store, you need to pass it in as JSON, and ensure it's setup correctly. This flow pulls the JSON file from Google Drive and extracts the JSON data and then passes it into the qdrant collection. \"},\"typeVersion\":1},{\"id\":\"d5052d52-bec2-4b70-b460-6d5789c28d2c\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-1460,220],\"parameters\":{\"color\":7,\"width\":1380,\"height\":680,\"content\":\"![n8n](https://uploads.n8n.io/templates/n8n.png)\\n## Talk to your Vector Store\\nNow that your vector store has been updated with the embedded data, \\nyou can use the n8n chat interface to talk to your data using OpenAI, \\nOllama, or any of our supported LLMs.\"},\"typeVersion\":1},{\"id\":\"5cb478f6-17f3-4d7a-9b66-9e0654bd1dc9\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-1460,-700],\"parameters\":{\"color\":7,\"width\":2140,\"height\":900,\"content\":\"![Servicenow](https://uploads.n8n.io/templates/zendesk.png)\\n## Deploy your Vector Store\\nThis flow adds contextual information to your tickets using the Mitre Attack framework to help contextualize the ticket data.\"},\"typeVersion\":1},{\"id\":\"71ee28f5-84a2-4c6c-855a-6c7c09b2d62a\",\"name\":\"Structured Output Parser\",\"type\":\"@n8n/n8n-nodes-langchain.outputParserStructured\",\"position\":[0,-160],\"parameters\":{\"jsonSchemaExample\":\"{\\n  \\\"ttp_identification\\\": {\\n    \\\"alert_summary\\\": \\\"The alert indicates a check-in from the NetSupport RAT, a known Remote Access Trojan, suggesting command and control (C2) communication.\\\",\\n    \\\"mitre_attack_ttps\\\": [\\n      {\\n        \\\"tactic\\\": \\\"Command and Control\\\",\\n        \\\"technique\\\": \\\"Protocol or Service Impersonation\\\",\\n        \\\"technique_id\\\": \\\"T1001.003\\\",\\n        \\\"description\\\": \\\"The RAT's check-in over port 443 implies potential masquerading of its traffic as legitimate SSL/TLS traffic, a tactic often used to blend C2 communications with normal web traffic.\\\",\\n        \\\"reference\\\": \\\"https://attack.mitre.org/techniques/T1001/003/\\\"\\n      }\\n    ]\\n  },\\n  \\\"remediation_steps\\\": {\\n    \\\"network_segmentation\\\": {\\n      \\\"action\\\": \\\"Isolate the affected host\\\",\\n      \\\"target\\\": \\\"10.11.26.183\\\",\\n      \\\"reason\\\": \\\"Prevents further C2 communication or lateral movement.\\\"\\n    },\\n    \\\"endpoint_inspection\\\": {\\n      \\\"action\\\": \\\"Perform a thorough inspection\\\",\\n      \\\"target\\\": \\\"Impacted endpoint\\\",\\n      \\\"method\\\": \\\"Use endpoint detection and response (EDR) tools to check for additional persistence mechanisms.\\\"\\n    },\\n    \\\"network_traffic_analysis\\\": {\\n      \\\"action\\\": \\\"Investigate and block unusual traffic\\\",\\n      \\\"target\\\": \\\"IP 194.180.191.64\\\",\\n      \\\"method\\\": \\\"Implement blocks for the IP across the firewall or IDS/IPS systems.\\\"\\n    },\\n    \\\"system_patching\\\": {\\n      \\\"action\\\": \\\"Ensure all systems are updated\\\",\\n      \\\"method\\\": \\\"Apply the latest security patches to mitigate vulnerabilities exploited by RAT malware.\\\"\\n    },\\n    \\\"ioc_hunting\\\": {\\n      \\\"action\\\": \\\"Search for Indicators of Compromise (IoCs)\\\",\\n      \\\"method\\\": \\\"Check for NetSupport RAT IoCs across other endpoints within the network.\\\"\\n    }\\n  },\\n  \\\"historical_patterns\\\": {\\n    \\\"network_anomalies\\\": \\\"Past alerts involving similar attempts to use standard web ports (e.g., 80, 443) for non-standard applications could suggest a broader attempt to blend malicious traffic into legitimate streams.\\\",\\n    \\\"persistence_tactics\\\": \\\"Any detection of anomalies in task scheduling or shortcut modifications may indicate persistence methods similar to those used by RATs.\\\"\\n  },\\n  \\\"external_resources\\\": [\\n    {\\n      \\\"title\\\": \\\"ESET Report on Okrum and Ketrican\\\",\\n      \\\"description\\\": \\\"Discusses similar tactics involving protocol impersonation and C2.\\\",\\n      \\\"url\\\": \\\"https://www.eset.com/int/about/newsroom/research/okrum-ketrican/\\\"\\n    },\\n    {\\n      \\\"title\\\": \\\"Malleable C2 Profiles\\\",\\n      \\\"description\\\": \\\"Document on crafting custom C2 traffic profiles similar to the targeting methods used by NetSupport RAT.\\\",\\n      \\\"url\\\": \\\"https://www.cobaltstrike.com/help-malleable-c2\\\"\\n    },\\n    {\\n      \\\"title\\\": \\\"MITRE ATT&CK Technique Overview\\\",\\n      \\\"description\\\": \\\"Overview of Protocol or Service Impersonation tactics.\\\",\\n      \\\"url\\\": \\\"https://attack.mitre.org/techniques/T1001/003/\\\"\\n    }\\n  ]\\n}\\n\"},\"typeVersion\":1.2},{\"id\":\"3aeb973d-22e5-4eaf-8fe8-fae3447909e1\",\"name\":\"Pull Mitre Data From Gdrive\",\"type\":\"n8n-nodes-base.googleDrive\",\"position\":[-1140,1220],\"parameters\":{\"fileId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"1oWBLO5AlIqbgo9mKD1hNtx92HdC6O28d\",\"cachedResultUrl\":\"https://drive.google.com/file/d/1oWBLO5AlIqbgo9mKD1hNtx92HdC6O28d/view?usp=drivesdk\",\"cachedResultName\":\"cleaned_mitre_attack_data.json\"},\"options\":{},\"operation\":\"download\"},\"credentials\":{\"googleDriveOAuth2Api\":{\"id\":\"AVa7MXBLiB9NYjuO\",\"name\":\"Angel Gdrive\"}},\"typeVersion\":3},{\"id\":\"3b35633c-de80-4062-8497-cb65092d5708\",\"name\":\"Embed JSON in Qdrant Collection\",\"type\":\"@n8n/n8n-nodes-langchain.vectorStoreQdrant\",\"position\":[-520,1220],\"parameters\":{\"mode\":\"insert\",\"options\":{},\"qdrantCollection\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"mitre\"}},\"credentials\":{\"qdrantApi\":{\"id\":\"u0qre50aar6iqyxu\",\"name\":\"Angel MitreAttack Demo Cluster\"}},\"typeVersion\":1},{\"id\":\"5f7f2fd8-276f-4b3a-ae88-1f1765967883\",\"name\":\"Query Qdrant Vector Store\",\"type\":\"@n8n/n8n-nodes-langchain.vectorStoreQdrant\",\"position\":[-480,580],\"parameters\":{\"mode\":\"retrieve-as-tool\",\"options\":{},\"toolName\":\"mitre_attack_vector_store\",\"toolDescription\":\"The mitre_attack_vector_store is a knowledge base trained on the MITRE ATT&CK framework. It is designed to help identify, correlate, and provide context for cybersecurity incidents based on textual descriptions of alerts, events, or behaviors. This tool leverages precomputed embeddings of attack techniques, tactics, and procedures (TTPs) to map user queries (such as SIEM-generated alerts or JIRA ticket titles) to relevant MITRE ATT&CK techniques.\\n\\nBy analyzing input text, the vector store can:\\n\\nRetrieve the most relevant MITRE ATT&CK entries (e.g., techniques, tactics, descriptions, external references).\\nProvide structured context about potential adversary behaviors.\\nSuggest remediation actions or detection methods based on the input.\",\"qdrantCollection\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"mitre\",\"cachedResultName\":\"mitre\"}},\"credentials\":{\"qdrantApi\":{\"id\":\"u0qre50aar6iqyxu\",\"name\":\"Angel MitreAttack Demo Cluster\"}},\"typeVersion\":1},{\"id\":\"298ffc29-1d60-4c05-92c6-a61071629a3f\",\"name\":\"Qdrant Vector Store query\",\"type\":\"@n8n/n8n-nodes-langchain.vectorStoreQdrant\",\"position\":[-320,-200],\"parameters\":{\"mode\":\"retrieve-as-tool\",\"options\":{},\"toolName\":\"mitre_attack_vector_store\",\"toolDescription\":\"The mitre_attack_vector_store is a knowledge base trained on the MITRE ATT&CK framework. It is designed to help identify, correlate, and provide context for cybersecurity incidents based on textual descriptions of alerts, events, or behaviors. This tool leverages precomputed embeddings of attack techniques, tactics, and procedures (TTPs) to map user queries (such as SIEM-generated alerts or JIRA ticket titles) to relevant MITRE ATT&CK techniques.\\n\\nBy analyzing input text, the vector store can:\\n\\nRetrieve the most relevant MITRE ATT&CK entries (e.g., techniques, tactics, descriptions, external references).\\nProvide structured context about potential adversary behaviors.\\nSuggest remediation actions or detection methods based on the input.\",\"qdrantCollection\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"mitre\",\"cachedResultName\":\"mitre\"}},\"credentials\":{\"qdrantApi\":{\"id\":\"u0qre50aar6iqyxu\",\"name\":\"Angel MitreAttack Demo Cluster\"}},\"typeVersion\":1},{\"id\":\"c47f0ae6-106d-46da-afc3-f7afb86923ff\",\"name\":\"Get all Zendesk Tickets\",\"type\":\"n8n-nodes-base.zendesk\",\"position\":[-1180,-440],\"parameters\":{\"options\":{},\"operation\":\"getAll\"},\"credentials\":{\"zendeskApi\":{\"id\":\"ROx0ipJapRomRxEX\",\"name\":\"Zendesk Demo Access\"}},\"typeVersion\":1},{\"id\":\"0ec2c505-5721-41af-91c8-1b0b55826d9e\",\"name\":\"Update Zendesk with Mitre Data\",\"type\":\"n8n-nodes-base.zendesk\",\"position\":[0,-360],\"parameters\":{\"id\":\"={{ $('Loop Over Items').item.json.id }}\",\"operation\":\"update\",\"updateFields\":{\"internalNote\":\"=Summary: {{ $json.output.ttp_identification.alert_summary }}\\n\\n\",\"customFieldsUi\":{\"customFieldsValues\":[{\"id\":34479547176212,\"value\":\"={{ $json.output.ttp_identification.mitre_attack_ttps[0].technique_id }}\"},{\"id\":34479570659732,\"value\":\"={{ $json.output.ttp_identification.mitre_attack_ttps[0].tactic }}\"}]}}},\"credentials\":{\"zendeskApi\":{\"id\":\"ROx0ipJapRomRxEX\",\"name\":\"Zendesk Demo Access\"}},\"typeVersion\":1},{\"id\":\"6a74a6d4-610a-4a13-afe4-7bb03d83d4c8\",\"name\":\"Move on to next ticket\",\"type\":\"n8n-nodes-base.noOp\",\"position\":[360,-80],\"parameters\":{},\"typeVersion\":1}],\"pinData\":{},\"connections\":{\"AI Agent\":{\"main\":[[]]},\"AI Agent1\":{\"main\":[[{\"node\":\"Update Zendesk with Mitre Data\",\"type\":\"main\",\"index\":0}]]},\"Split Out\":{\"main\":[[{\"node\":\"Embed JSON in Qdrant Collection\",\"type\":\"main\",\"index\":0}]]},\"Loop Over Items\":{\"main\":[[],[{\"node\":\"AI Agent1\",\"type\":\"main\",\"index\":0}]]},\"Token Splitter1\":{\"ai_textSplitter\":[[{\"node\":\"Default Data Loader\",\"type\":\"ai_textSplitter\",\"index\":0}]]},\"Embeddings OpenAI\":{\"ai_embedding\":[[{\"node\":\"Qdrant Vector Store query\",\"type\":\"ai_embedding\",\"index\":0}]]},\"Extract from File\":{\"main\":[[{\"node\":\"Split Out\",\"type\":\"main\",\"index\":0}]]},\"OpenAI Chat Model\":{\"ai_languageModel\":[[{\"node\":\"AI Agent\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"Embeddings OpenAI1\":{\"ai_embedding\":[[{\"node\":\"Embed JSON in Qdrant Collection\",\"type\":\"ai_embedding\",\"index\":0}]]},\"Embeddings OpenAI2\":{\"ai_embedding\":[[{\"node\":\"Query Qdrant Vector Store\",\"type\":\"ai_embedding\",\"index\":0}]]},\"OpenAI Chat Model1\":{\"ai_languageModel\":[[{\"node\":\"AI Agent1\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"Default Data Loader\":{\"ai_document\":[[{\"node\":\"Embed JSON in Qdrant Collection\",\"type\":\"ai_document\",\"index\":0}]]},\"Window Buffer Memory\":{\"ai_memory\":[[{\"node\":\"AI Agent\",\"type\":\"ai_memory\",\"index\":0}]]},\"Move on to next ticket\":{\"main\":[[{\"node\":\"Loop Over Items\",\"type\":\"main\",\"index\":0}]]},\"Get all Zendesk Tickets\":{\"main\":[[{\"node\":\"Loop Over Items\",\"type\":\"main\",\"index\":0}]]},\"Structured Output Parser\":{\"ai_outputParser\":[[{\"node\":\"AI Agent1\",\"type\":\"ai_outputParser\",\"index\":0}]]},\"Qdrant Vector Store query\":{\"ai_tool\":[[{\"node\":\"AI Agent1\",\"type\":\"ai_tool\",\"index\":0}]]},\"Query Qdrant Vector Store\":{\"ai_tool\":[[{\"node\":\"AI Agent\",\"type\":\"ai_tool\",\"index\":0}]]},\"When chat message received\":{\"main\":[[{\"node\":\"AI Agent\",\"type\":\"main\",\"index\":0}]]},\"Pull Mitre Data From Gdrive\":{\"main\":[[{\"node\":\"Extract from File\",\"type\":\"main\",\"index\":0}]]},\"Update Zendesk with Mitre Data\":{\"main\":[[{\"node\":\"Move on to next ticket\",\"type\":\"main\",\"index\":0}]]},\"When clicking ‘Test workflow’\":{\"main\":[[{\"node\":\"Pull Mitre Data From Gdrive\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "### **n8n Workflow: Automate SIEM Alert Enrichment with MITRE ATT &CK & Qdrant**\n\n* * *\n\n## **Who is this for?**\n\nThis workflow is ideal for:\n\n  * **Cybersecurity teams & SOC analysts** who want to automate **SIEM alert enrichment**.\n  * **IT security professionals** looking to integrate **MITRE ATT &CK intelligence** into their ticketing system.\n  * **Organizations using Zendesk for security incidents** who need enhanced **contextual threat data**.\n  * **Anyone using n8n and Qdrant** to build **AI-powered security workflows**.\n\n\n\n* * *\n\n## **What problem does this workflow solve?**\n\nSecurity teams receive **large volumes of raw SIEM alerts** that lack actionable context. Investigating every alert manually is **time-consuming** and can lead to **delayed response times**. This workflow solves this problem by:  \n✔ **Automatically enriching SIEM alerts** with MITRE ATT&CK TTPs.  \n✔ **Tagging & classifying alerts** based on known attack techniques.  \n✔ **Providing remediation steps** to guide the response team.  \n✔ **Enhancing security tickets in Zendesk** with relevant threat intelligence.\n\n* * *\n\n## **What this workflow does**\n\n1️⃣ **Ingests SIEM alerts** (via chatbot or ticketing system like Zendesk).  \n2️⃣ **Queries a Qdrant vector store** containing MITRE ATT&CK techniques.  \n3️⃣ **Extracts relevant TTPs (Tactics, Techniques, & Procedures)** from the alert.  \n4️⃣ **Generates remediation steps** using AI-powered enrichment.  \n5️⃣ **Updates Zendesk tickets** with threat intelligence & recommended actions.  \n6️⃣ **Provides structured alert data** for further automation or reporting.\n\n* * *\n\n## **Setup Guide**\n\n### **Prerequisites**\n\n  * **n8n instance** (Cloud or Self-hosted).\n  * **Qdrant vector store** with MITRE ATT&CK data embedded.\n  * **OpenAI API key** (for AI-based threat processing).\n  * **Zendesk account** (for ticket enrichment, if applicable).\n  * [Clean Mitre Data Python Script](https://drive.google.com/file/d/1Yxv5fDdQ2OigYhhfv_WqGb9QTr-Q_aeW/view?usp=sharing)\n  * [Cleaned Mitre Data](https://drive.google.com/file/d/1Kt6ZJ4DYvNm44I9fBKvmXjeHQqLJqCwA/view?usp=drive_link)\n  * [Full Mitre Data](https://drive.google.com/file/d/1Lq7v3luu3DC44Tdn2DIxiVwnh3UQWM_Y/view?usp=drive_link)\n\n\n\n### **Steps to Set Up**\n\n1️⃣ **Embed MITRE ATT &CK data into Qdrant**\n\n  * This workflow pulls MITRE ATT&CK data from **Google Drive** and **loads it into Qdrant**.\n  * The data is **vectorized using OpenAI embeddings** for fast retrieval.\n\n\n\n2️⃣ **Deploy the n8n Chatbot**\n\n  * The chatbot listens for **SIEM alerts** and sends them to the AI processing pipeline.\n  * Alerts are **analyzed using an AI agent trained on MITRE ATT &CK**.\n\n\n\n3️⃣ **Enrich Zendesk Tickets**\n\n  * The workflow extracts **MITRE ATT &CK techniques** from alerts.\n  * It **updates Zendesk tickets with contextual threat intelligence**.\n  * The **remediation steps are included as internal notes** for SOC teams.\n\n\n\n* * *\n\n## **How to Customize This Workflow**\n\n🔧 **Modify the chatbot trigger** : Adapt the chatbot node to receive alerts from **Slack, Microsoft Teams, or any other tool**.\n\n🔧 **Change the SIEM input source** : Connect your workflow to **Splunk, Elastic SIEM, or Chronicle Security**.\n\n🔧 **Customize remediation steps** : Use a **custom AI model** to tailor remediation responses based on **organization-specific security policies**.\n\n🔧 **Extend ticketing integration** : Modify the Zendesk node to also work with **Jira, ServiceNow, or another ITSM platform**.\n\n* * *\n\n## **Why This Workflow is Powerful**\n\n✅ **Saves time** : Automates **alert triage & classification**.  \n✅ **Improves security posture** : Helps **SOC teams act faster** on threats.  \n✅ **Leverages AI & vector search**: Uses **LLM-powered enrichment** for **real-time context**.  \n✅ **Works across platforms** : Supports **n8n Cloud, Self-hosted, and Qdrant**.\n\n* * *\n\n## **🚀 Get Started Now!**\n\n📖 [Watch the Setup Video](https://youtu.be/SbWrCe0R9LE)  \n💬 **Have Questions? Join the Discussion in the YouTube Comments!**\n",
  "readme_html": "<!--[--><div data-v-006f9244=\"\"><h3><strong>n8n Workflow: Automate SIEM Alert Enrichment with MITRE ATT&amp;CK &amp; Qdrant</strong></h3>\n<hr>\n<h2><strong>Who is this for?</strong></h2>\n<p>This workflow is ideal for:</p>\n<ul>\n<li><strong>Cybersecurity teams &amp; SOC analysts</strong> who want to automate <strong>SIEM alert enrichment</strong>.</li>\n<li><strong>IT security professionals</strong> looking to integrate <strong>MITRE ATT&amp;CK intelligence</strong> into their ticketing system.</li>\n<li><strong>Organizations using Zendesk for security incidents</strong> who need enhanced <strong>contextual threat data</strong>.</li>\n<li><strong>Anyone using n8n and Qdrant</strong> to build <strong>AI-powered security workflows</strong>.</li>\n</ul>\n<hr>\n<h2><strong>What problem does this workflow solve?</strong></h2>\n<p>Security teams receive <strong>large volumes of raw SIEM alerts</strong> that lack actionable context. Investigating every alert manually is <strong>time-consuming</strong> and can lead to <strong>delayed response times</strong>. This workflow solves this problem by:<br>\n✔ <strong>Automatically enriching SIEM alerts</strong> with MITRE ATT&amp;CK TTPs.<br>\n✔ <strong>Tagging &amp; classifying alerts</strong> based on known attack techniques.<br>\n✔ <strong>Providing remediation steps</strong> to guide the response team.<br>\n✔ <strong>Enhancing security tickets in Zendesk</strong> with relevant threat intelligence.</p>\n<hr>\n<h2><strong>What this workflow does</strong></h2>\n<p>1️⃣ <strong>Ingests SIEM alerts</strong> (via chatbot or ticketing system like Zendesk).<br>\n2️⃣ <strong>Queries a Qdrant vector store</strong> containing MITRE ATT&amp;CK techniques.<br>\n3️⃣ <strong>Extracts relevant TTPs (Tactics, Techniques, &amp; Procedures)</strong> from the alert.<br>\n4️⃣ <strong>Generates remediation steps</strong> using AI-powered enrichment.<br>\n5️⃣ <strong>Updates Zendesk tickets</strong> with threat intelligence &amp; recommended actions.<br>\n6️⃣ <strong>Provides structured alert data</strong> for further automation or reporting.</p>\n<hr>\n<h2><strong>Setup Guide</strong></h2>\n<h3><strong>Prerequisites</strong></h3>\n<ul>\n<li><strong>n8n instance</strong> (Cloud or Self-hosted).</li>\n<li><strong>Qdrant vector store</strong> with MITRE ATT&amp;CK data embedded.</li>\n<li><strong>OpenAI API key</strong> (for AI-based threat processing).</li>\n<li><strong>Zendesk account</strong> (for ticket enrichment, if applicable).</li>\n<li><a href=\"https://drive.google.com/file/d/1Yxv5fDdQ2OigYhhfv_WqGb9QTr-Q_aeW/view?usp=sharing\" rel=\"ugc nofollow\" target=\"_blank\">Clean Mitre Data Python Script</a></li>\n<li><a href=\"https://drive.google.com/file/d/1Kt6ZJ4DYvNm44I9fBKvmXjeHQqLJqCwA/view?usp=drive_link\" rel=\"ugc nofollow\" target=\"_blank\">Cleaned Mitre Data</a></li>\n<li><a href=\"https://drive.google.com/file/d/1Lq7v3luu3DC44Tdn2DIxiVwnh3UQWM_Y/view?usp=drive_link\" rel=\"ugc nofollow\" target=\"_blank\">Full Mitre Data</a></li>\n</ul>\n<h3><strong>Steps to Set Up</strong></h3>\n<p>1️⃣ <strong>Embed MITRE ATT&amp;CK data into Qdrant</strong></p>\n<ul>\n<li>This workflow pulls MITRE ATT&amp;CK data from <strong>Google Drive</strong> and <strong>loads it into Qdrant</strong>.</li>\n<li>The data is <strong>vectorized using OpenAI embeddings</strong> for fast retrieval.</li>\n</ul>\n<p>2️⃣ <strong>Deploy the n8n Chatbot</strong></p>\n<ul>\n<li>The chatbot listens for <strong>SIEM alerts</strong> and sends them to the AI processing pipeline.</li>\n<li>Alerts are <strong>analyzed using an AI agent trained on MITRE ATT&amp;CK</strong>.</li>\n</ul>\n<p>3️⃣ <strong>Enrich Zendesk Tickets</strong></p>\n<ul>\n<li>The workflow extracts <strong>MITRE ATT&amp;CK techniques</strong> from alerts.</li>\n<li>It <strong>updates Zendesk tickets with contextual threat intelligence</strong>.</li>\n<li>The <strong>remediation steps are included as internal notes</strong> for SOC teams.</li>\n</ul>\n<hr>\n<h2><strong>How to Customize This Workflow</strong></h2>\n<p>🔧 <strong>Modify the chatbot trigger</strong>: Adapt the chatbot node to receive alerts from <strong>Slack, Microsoft Teams, or any other tool</strong>.</p>\n<p>🔧 <strong>Change the SIEM input source</strong>: Connect your workflow to <strong>Splunk, Elastic SIEM, or Chronicle Security</strong>.</p>\n<p>🔧 <strong>Customize remediation steps</strong>: Use a <strong>custom AI model</strong> to tailor remediation responses based on <strong>organization-specific security policies</strong>.</p>\n<p>🔧 <strong>Extend ticketing integration</strong>: Modify the Zendesk node to also work with <strong>Jira, ServiceNow, or another ITSM platform</strong>.</p>\n<hr>\n<h2><strong>Why This Workflow is Powerful</strong></h2>\n<p>✅ <strong>Saves time</strong>: Automates <strong>alert triage &amp; classification</strong>.<br>\n✅ <strong>Improves security posture</strong>: Helps <strong>SOC teams act faster</strong> on threats.<br>\n✅ <strong>Leverages AI &amp; vector search</strong>: Uses <strong>LLM-powered enrichment</strong> for <strong>real-time context</strong>.<br>\n✅ <strong>Works across platforms</strong>: Supports <strong>n8n Cloud, Self-hosted, and Qdrant</strong>.</p>\n<hr>\n<h2><strong>🚀 Get Started Now!</strong></h2>\n<p>📖 <a href=\"https://youtu.be/SbWrCe0R9LE\" rel=\"ugc nofollow\" target=\"_blank\">Watch the Setup Video</a><br>\n💬 <strong>Have Questions? Join the Discussion in the YouTube Comments!</strong></p>\n</div><!--]-->",
  "readme_zh": "### **n8n工作流：利用MITRE ATT&CK与Qdrant实现SIEM告警自动化增强**\n\n* * *\n\n## **适用对象**\n\n本工作流特别适合以下人群：\n\n  * **网络安全团队与SOC分析师**：希望实现**SIEM告警自动化增强**。\n  * **IT安全专业人员**：寻求将**MITRE ATT&CK威胁情报**集成到工单系统。\n  * **使用Zendesk处理安全事件的组织**：需要补充**上下文威胁数据**。\n  * **使用n8n和Qdrant构建AI驱动安全流程**的任何用户。\n\n* * *\n\n## **解决什么问题？**\n\n安全团队常面临**海量原始SIEM告警**却缺乏可操作的上下文。人工逐条调查**耗时费力**，易导致**响应延迟**。本工作流通过以下方式解决问题：  \n✔ **自动关联MITRE ATT&CK战术技术**增强告警价值  \n✔ **基于已知攻击手法标记分类告警**  \n✔ **提供修复建议**指引响应团队  \n✔ **为Zendesk工单注入威胁情报**提升处置效率  \n\n* * *\n\n## **核心功能**\n\n1️⃣ **接收SIEM告警**（通过聊天机器人或Zendesk等工单系统）  \n2️⃣ **查询存储MITRE ATT&CK技术的Qdrant向量库**  \n3️⃣ **从告警中提取关联的TTPs（战术、技术与流程）**  \n4️⃣ **利用AI生成修复建议**  \n5️⃣ **更新Zendesk工单**附带威胁情报与处置方案  \n6️⃣ **输出结构化告警数据**支持后续自动化或报告生成  \n\n* * *\n\n## **配置指南**\n\n### **先决条件**\n\n  * **n8n实例**（云端或自托管）  \n  * **已嵌入MITRE ATT&CK数据的Qdrant向量库**  \n  * **OpenAI API密钥**（用于AI威胁分析）  \n  * **Zendesk账户**（如需工单增强）  \n  * [Mitre数据清洗脚本](https://drive.google.com/file/d/1Yxv5fDdQ2OigYhhfv_WqGb9QTr-Q_aeW/view?usp=sharing)  \n  * [清洗后的Mitre数据](https://drive.google.com/file/d/1Kt6ZJ4DYvNm44I9fBKvmXjeHQqLJqCwA/view?usp=drive_link)  \n  * [完整Mitre数据集](https://drive.google.com/file/d/1Lq7v3luu3DC44Tdn2DIxiVwnh3UQWM_Y/view?usp=drive_link)  \n\n### **配置步骤**\n\n1️⃣ **将MITRE ATT&CK数据导入Qdrant**  \n  * 从**Google Drive**获取数据并通过**OpenAI向量化**存入Qdrant  \n\n2️⃣ **部署n8n聊天机器人**  \n  * 机器人监听**SIEM告警**并推送至AI处理管道  \n  * 告警由**基于MITRE ATT&CK训练的AI代理**分析  \n\n3️⃣ **增强Zendesk工单**  \n  * 提取告警中的**MITRE ATT&CK技术指标**  \n  * 为工单追加**上下文威胁情报**  \n  * 将**修复建议**作为内部注释提供给SOC团队  \n\n* * *\n\n## **自定义方案**\n\n🔧 **修改触发方式**：适配**Slack/Microsoft Teams等平台**接收告警  \n🔧 **更换SIEM数据源**：连接**Splunk/Elastic SIEM/Chronicle**等安全平台  \n🔧 **定制修复建议**：采用**专属AI模型**生成符合**企业安全策略**的响应方案  \n🔧 **扩展工单系统**：调整节点以支持**Jira/ServiceNow等ITSM平台**  \n\n* * *\n\n## **核心优势**\n\n✅ **效率提升**：自动化**告警分诊与分类**  \n✅ **强化防御**：助力SOC团队**快速响应威胁**  \n✅ **AI驱动**：通过**大语言模型实时生成上下文**  \n✅ **跨平台兼容**：支持**n8n云端/本地版与Qdrant**  \n\n* * *\n\n## **🚀 立即开始！**\n\n📖 [观看配置视频](https://youtu.be/SbWrCe0R9LE)  \n💬 **如有疑问？欢迎在YouTube评论区交流！**",
  "title_zh": "在n8n中使用MITRE ATT&CK、Qdrant和Zendesk实现SIEM告警自动富化",
  "publish_date_absolute": "2025-02-07",
  "publish_date_zh": "最后更新于3个月前",
  "workflow_json_zh": "{\n  \"meta\": {\n    \"instanceId\": \"cb484ba7b742928a2048bf8829668bed5b5ad9787579adea888f05980292a4a7\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"nodes\": [\n    {\n      \"id\": \"86ddd018-3d6b-46b9-aa93-dedd6c6b5076\",\n      \"name\": \"When chat message received\",\n      \"type\": \"@n8n/n8n-nodes-langchain.chatTrigger\",\n      \"position\": [\n        -880,\n        360\n      ],\n      \"webhookId\": \"a9668bb8-bbe8-418a-b5c9-ff7dd431244f\",\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"a5ba5090-8e3b-4408-82df-92d2c524039e\",\n      \"name\": \"AI Agent\",\n      \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n      \"position\": [\n        -680,\n        360\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"systemMessage\": \"You are a cybersecurity expert trained on MITRE ATT&CK and enterprise incident response. Your job is to:\\n1. Extract TTP information from SIEM data.\\n2. Provide actionable remediation steps tailored to the alert.\\n3. Cross-reference historical patterns and related alerts.\\n4. Recommend external resources for deeper understanding.\\n\\nEnsure that:\\n- TTPs are tagged with the tactic, technique name, and technique ID.\\n- Remediation steps are specific and actionable.\\n- Historical data includes related alerts and notable trends.\\n- External links are relevant to the observed behavior.\\n\"\n        }\n      },\n      \"typeVersion\": 1.7\n    },\n    {\n      \"id\": \"67c52944-b616-4ea6-9507-e9fb6fcdbe2b\",\n      \"name\": \"OpenAI Chat Model\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\n      \"position\": [\n        -740,\n        580\n      ],\n      \"parameters\": {\n        \"model\": \"gpt-4o\",\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"QpFZ2EiM3WGl6Zr3\",\n          \"name\": \"Marketing OpenAI\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"55f6c16a-51ed-45e4-a1ab-aaaf1d7b5733\",\n      \"name\": \"Split Out\",\n      \"type\": \"n8n-nodes-base.splitOut\",\n      \"position\": [\n        -720,\n        1220\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"fieldToSplitOut\": \"data\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"46a5b8c6-3d34-4e9b-b812-23135f28c278\",\n      \"name\": \"Embeddings OpenAI1\",\n      \"type\": \"@n8n/n8n-nodes-langchain.embeddingsOpenAi\",\n      \"position\": [\n        -580,\n        1420\n      ],\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"QpFZ2EiM3WGl6Zr3\",\n          \"name\": \"Marketing OpenAI\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"561b0737-26d5-450d-bd9e-08e0a608d6f9\",\n      \"name\": \"Default Data Loader\",\n      \"type\": \"@n8n/n8n-nodes-langchain.documentDefaultDataLoader\",\n      \"position\": [\n        -460,\n        1440\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"metadata\": {\n            \"metadataValues\": [\n              {\n                \"name\": \"id\",\n                \"value\": \"={{ $json.id }}\"\n              },\n              {\n                \"name\": \"name\",\n                \"value\": \"={{ $json.name }}\"\n              },\n              {\n                \"name\": \"killchain\",\n                \"value\": \"={{ $json.kill_chain_phases }}\"\n              },\n              {\n                \"name\": \"external\",\n                \"value\": \"={{ $json.external_references }}\"\n              }\n            ]\n          }\n        },\n        \"jsonData\": \"={{ $json.description }}\",\n        \"jsonMode\": \"expressionData\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"6e8a4aed-7e8c-492a-b816-6ab1a98c312a\",\n      \"name\": \"Token Splitter1\",\n      \"type\": \"@n8n/n8n-nodes-langchain.textSplitterTokenSplitter\",\n      \"position\": [\n        -460,\n        1620\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"0c54049e-b5e8-448f-b864-39aeb274de3e\",\n      \"name\": \"Window Buffer Memory\",\n      \"type\": \"@n8n/n8n-nodes-langchain.memoryBufferWindow\",\n      \"position\": [\n        -580,\n        580\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1.3\n    },\n    {\n      \"id\": \"96b776a0-10da-4f70-99d0-ad6b6ee8fcca\",\n      \"name\": \"Embeddings OpenAI2\",\n      \"type\": \"@n8n/n8n-nodes-langchain.embeddingsOpenAi\",\n      \"position\": [\n        -460,\n        720\n      ],\n      \"parameters\": {\n        \"model\": \"text-embedding-3-large\",\n        \"options\": {\n          \"dimensions\": 1536\n        }\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"QpFZ2EiM3WGl6Zr3\",\n          \"name\": \"Marketing OpenAI\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"695fba89-8f42-47c3-9d86-73f4ea0e72df\",\n      \"name\": \"Extract from File\",\n      \"type\": \"n8n-nodes-base.extractFromFile\",\n      \"position\": [\n        -920,\n        1220\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"operation\": \"fromJson\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"0b9897b0-149b-43ce-b66c-e78552729aa5\",\n      \"name\": \"When clicking ‘Test workflow’\",\n      \"type\": \"n8n-nodes-base.manualTrigger\",\n      \"position\": [\n        -1360,\n        1220\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"d8c29a14-0389-4748-a9de-686bf9a682c5\",\n      \"name\": \"AI Agent1\",\n      \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n      \"position\": [\n        -540,\n        -440\n      ],\n      \"parameters\": {\n        \"text\": \"=Siem Alert Data:\\nAlert: {{ $json.raw_subject }}\\nDescription: {{ $json.description }}\",\n        \"options\": {\n          \"systemMessage\": \"You are a cybersecurity expert trained on MITRE ATT&CK and enterprise incident response. Your job is to:\\n1. Extract TTP information from SIEM data.\\n2. Provide actionable remediation steps tailored to the alert.\\n3. Cross-reference historical patterns and related alerts.\\n4. Recommend external resources for deeper understanding.\\n\\nEnsure that:\\n- TTPs are tagged with the tactic, technique name, and technique ID.\\n- Remediation steps are specific and actionable.\\n- Historical data includes related alerts and notable trends.\\n- External links are relevant to the observed behavior.\\n\\nPlease output your response in html format, but do not include ```html at the beginning \\n\"\n        },\n        \"promptType\": \"define\",\n        \"hasOutputParser\": true\n      },\n      \"typeVersion\": 1.7\n    },\n    {\n      \"id\": \"55d0b00a-5046-45fa-87cb-cb0257caae87\",\n      \"name\": \"OpenAI Chat Model1\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\n      \"position\": [\n        -600,\n        -220\n      ],\n      \"parameters\": {\n        \"model\": \"gpt-4o\",\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"QpFZ2EiM3WGl6Zr3\",\n          \"name\": \"Marketing OpenAI\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"9b53566b-e021-403d-9d78-28504c5c1dfa\",\n      \"name\": \"Embeddings OpenAI\",\n      \"type\": \"@n8n/n8n-nodes-langchain.embeddingsOpenAi\",\n      \"position\": [\n        -320,\n        -40\n      ],\n      \"parameters\": {\n        \"model\": \"text-embedding-3-large\",\n        \"options\": {\n          \"dimensions\": 1536\n        }\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"QpFZ2EiM3WGl6Zr3\",\n          \"name\": \"Marketing OpenAI\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"f3b44ef5-e928-4662-81ef-4dd044829607\",\n      \"name\": \"Loop Over Items\",\n      \"type\": \"n8n-nodes-base.splitInBatches\",\n      \"position\": [\n        -940,\n        -440\n      ],\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"cc572b71-65c9-460c-bdcd-1d20feb15b32\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -1460,\n        940\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 1380,\n        \"height\": 820,\n        \"content\": \"![n8n](https://uploads.n8n.io/templates/qdrantlogo.png)\\n## 嵌入您的向量存储\\n为了向您的向量存储提供数据，您需要以JSON格式传入数据，并确保其正确设置。此流程会从Google Drive中提取JSON文件，解析其中的JSON数据，然后将其传递到qdrant集合中。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"d5052d52-bec2-4b70-b460-6d5789c28d2c\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -1460,\n        220\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 1380,\n        \"height\": 680,\n        \"content\": \"![n8n](https://uploads.n8n.io/templates/n8n.png)\\n## 与您的向量数据库对话\\n现在您的向量数据库已更新嵌入数据，\\n您可以使用n8n聊天界面，通过OpenAI、\\nOllama或我们支持的任何LLM与您的数据进行交互。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"5cb478f6-17f3-4d7a-9b66-9e0654bd1dc9\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -1460,\n        -700\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 2140,\n        \"height\": 900,\n        \"content\": \"![Servicenow](https://uploads.n8n.io/templates/zendesk.png)\\n## 部署您的向量存储库\\n该流程利用Mitre Attack框架为您的工单添加上下文信息，以帮助理解工单数据的背景。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"71ee28f5-84a2-4c6c-855a-6c7c09b2d62a\",\n      \"name\": \"Structured Output Parser\",\n      \"type\": \"@n8n/n8n-nodes-langchain.outputParserStructured\",\n      \"position\": [\n        0,\n        -160\n      ],\n      \"parameters\": {\n        \"jsonSchemaExample\": \"{\\n  \\\"ttp_identification\\\": {\\n    \\\"alert_summary\\\": \\\"The alert indicates a check-in from the NetSupport RAT, a known Remote Access Trojan, suggesting command and control (C2) communication.\\\",\\n    \\\"mitre_attack_ttps\\\": [\\n      {\\n        \\\"tactic\\\": \\\"Command and Control\\\",\\n        \\\"technique\\\": \\\"Protocol or Service Impersonation\\\",\\n        \\\"technique_id\\\": \\\"T1001.003\\\",\\n        \\\"description\\\": \\\"The RAT's check-in over port 443 implies potential masquerading of its traffic as legitimate SSL/TLS traffic, a tactic often used to blend C2 communications with normal web traffic.\\\",\\n        \\\"reference\\\": \\\"https://attack.mitre.org/techniques/T1001/003/\\\"\\n      }\\n    ]\\n  },\\n  \\\"remediation_steps\\\": {\\n    \\\"network_segmentation\\\": {\\n      \\\"action\\\": \\\"Isolate the affected host\\\",\\n      \\\"target\\\": \\\"10.11.26.183\\\",\\n      \\\"reason\\\": \\\"Prevents further C2 communication or lateral movement.\\\"\\n    },\\n    \\\"endpoint_inspection\\\": {\\n      \\\"action\\\": \\\"Perform a thorough inspection\\\",\\n      \\\"target\\\": \\\"Impacted endpoint\\\",\\n      \\\"method\\\": \\\"Use endpoint detection and response (EDR) tools to check for additional persistence mechanisms.\\\"\\n    },\\n    \\\"network_traffic_analysis\\\": {\\n      \\\"action\\\": \\\"Investigate and block unusual traffic\\\",\\n      \\\"target\\\": \\\"IP 194.180.191.64\\\",\\n      \\\"method\\\": \\\"Implement blocks for the IP across the firewall or IDS/IPS systems.\\\"\\n    },\\n    \\\"system_patching\\\": {\\n      \\\"action\\\": \\\"Ensure all systems are updated\\\",\\n      \\\"method\\\": \\\"Apply the latest security patches to mitigate vulnerabilities exploited by RAT malware.\\\"\\n    },\\n    \\\"ioc_hunting\\\": {\\n      \\\"action\\\": \\\"Search for Indicators of Compromise (IoCs)\\\",\\n      \\\"method\\\": \\\"Check for NetSupport RAT IoCs across other endpoints within the network.\\\"\\n    }\\n  },\\n  \\\"historical_patterns\\\": {\\n    \\\"network_anomalies\\\": \\\"Past alerts involving similar attempts to use standard web ports (e.g., 80, 443) for non-standard applications could suggest a broader attempt to blend malicious traffic into legitimate streams.\\\",\\n    \\\"persistence_tactics\\\": \\\"Any detection of anomalies in task scheduling or shortcut modifications may indicate persistence methods similar to those used by RATs.\\\"\\n  },\\n  \\\"external_resources\\\": [\\n    {\\n      \\\"title\\\": \\\"ESET Report on Okrum and Ketrican\\\",\\n      \\\"description\\\": \\\"Discusses similar tactics involving protocol impersonation and C2.\\\",\\n      \\\"url\\\": \\\"https://www.eset.com/int/about/newsroom/research/okrum-ketrican/\\\"\\n    },\\n    {\\n      \\\"title\\\": \\\"Malleable C2 Profiles\\\",\\n      \\\"description\\\": \\\"Document on crafting custom C2 traffic profiles similar to the targeting methods used by NetSupport RAT.\\\",\\n      \\\"url\\\": \\\"https://www.cobaltstrike.com/help-malleable-c2\\\"\\n    },\\n    {\\n      \\\"title\\\": \\\"MITRE ATT&CK Technique Overview\\\",\\n      \\\"description\\\": \\\"Overview of Protocol or Service Impersonation tactics.\\\",\\n      \\\"url\\\": \\\"https://attack.mitre.org/techniques/T1001/003/\\\"\\n    }\\n  ]\\n}\\n\"\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"3aeb973d-22e5-4eaf-8fe8-fae3447909e1\",\n      \"name\": \"Pull Mitre Data From Gdrive\",\n      \"type\": \"n8n-nodes-base.googleDrive\",\n      \"position\": [\n        -1140,\n        1220\n      ],\n      \"parameters\": {\n        \"fileId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"1oWBLO5AlIqbgo9mKD1hNtx92HdC6O28d\",\n          \"cachedResultUrl\": \"https://drive.google.com/file/d/1oWBLO5AlIqbgo9mKD1hNtx92HdC6O28d/view?usp=drivesdk\",\n          \"cachedResultName\": \"cleaned_mitre_attack_data.json\"\n        },\n        \"options\": {},\n        \"operation\": \"download\"\n      },\n      \"credentials\": {\n        \"googleDriveOAuth2Api\": {\n          \"id\": \"AVa7MXBLiB9NYjuO\",\n          \"name\": \"Angel Gdrive\"\n        }\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"3b35633c-de80-4062-8497-cb65092d5708\",\n      \"name\": \"Embed JSON in Qdrant Collection\",\n      \"type\": \"@n8n/n8n-nodes-langchain.vectorStoreQdrant\",\n      \"position\": [\n        -520,\n        1220\n      ],\n      \"parameters\": {\n        \"mode\": \"insert\",\n        \"options\": {},\n        \"qdrantCollection\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"mitre\"\n        }\n      },\n      \"credentials\": {\n        \"qdrantApi\": {\n          \"id\": \"u0qre50aar6iqyxu\",\n          \"name\": \"Angel MitreAttack Demo Cluster\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"5f7f2fd8-276f-4b3a-ae88-1f1765967883\",\n      \"name\": \"Query Qdrant Vector Store\",\n      \"type\": \"@n8n/n8n-nodes-langchain.vectorStoreQdrant\",\n      \"position\": [\n        -480,\n        580\n      ],\n      \"parameters\": {\n        \"mode\": \"retrieve-as-tool\",\n        \"options\": {},\n        \"toolName\": \"mitre_attack_vector_store\",\n        \"toolDescription\": \"The mitre_attack_vector_store is a knowledge base trained on the MITRE ATT&CK framework. It is designed to help identify, correlate, and provide context for cybersecurity incidents based on textual descriptions of alerts, events, or behaviors. This tool leverages precomputed embeddings of attack techniques, tactics, and procedures (TTPs) to map user queries (such as SIEM-generated alerts or JIRA ticket titles) to relevant MITRE ATT&CK techniques.\\n\\nBy analyzing input text, the vector store can:\\n\\nRetrieve the most relevant MITRE ATT&CK entries (e.g., techniques, tactics, descriptions, external references).\\nProvide structured context about potential adversary behaviors.\\nSuggest remediation actions or detection methods based on the input.\",\n        \"qdrantCollection\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"mitre\",\n          \"cachedResultName\": \"mitre\"\n        }\n      },\n      \"credentials\": {\n        \"qdrantApi\": {\n          \"id\": \"u0qre50aar6iqyxu\",\n          \"name\": \"Angel MitreAttack Demo Cluster\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"298ffc29-1d60-4c05-92c6-a61071629a3f\",\n      \"name\": \"Qdrant Vector Store query\",\n      \"type\": \"@n8n/n8n-nodes-langchain.vectorStoreQdrant\",\n      \"position\": [\n        -320,\n        -200\n      ],\n      \"parameters\": {\n        \"mode\": \"retrieve-as-tool\",\n        \"options\": {},\n        \"toolName\": \"mitre_attack_vector_store\",\n        \"toolDescription\": \"The mitre_attack_vector_store is a knowledge base trained on the MITRE ATT&CK framework. It is designed to help identify, correlate, and provide context for cybersecurity incidents based on textual descriptions of alerts, events, or behaviors. This tool leverages precomputed embeddings of attack techniques, tactics, and procedures (TTPs) to map user queries (such as SIEM-generated alerts or JIRA ticket titles) to relevant MITRE ATT&CK techniques.\\n\\nBy analyzing input text, the vector store can:\\n\\nRetrieve the most relevant MITRE ATT&CK entries (e.g., techniques, tactics, descriptions, external references).\\nProvide structured context about potential adversary behaviors.\\nSuggest remediation actions or detection methods based on the input.\",\n        \"qdrantCollection\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"mitre\",\n          \"cachedResultName\": \"mitre\"\n        }\n      },\n      \"credentials\": {\n        \"qdrantApi\": {\n          \"id\": \"u0qre50aar6iqyxu\",\n          \"name\": \"Angel MitreAttack Demo Cluster\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"c47f0ae6-106d-46da-afc3-f7afb86923ff\",\n      \"name\": \"Get all Zendesk Tickets\",\n      \"type\": \"n8n-nodes-base.zendesk\",\n      \"position\": [\n        -1180,\n        -440\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"operation\": \"getAll\"\n      },\n      \"credentials\": {\n        \"zendeskApi\": {\n          \"id\": \"ROx0ipJapRomRxEX\",\n          \"name\": \"Zendesk Demo Access\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"0ec2c505-5721-41af-91c8-1b0b55826d9e\",\n      \"name\": \"Update Zendesk with Mitre Data\",\n      \"type\": \"n8n-nodes-base.zendesk\",\n      \"position\": [\n        0,\n        -360\n      ],\n      \"parameters\": {\n        \"id\": \"={{ $('Loop Over Items').item.json.id }}\",\n        \"operation\": \"update\",\n        \"updateFields\": {\n          \"internalNote\": \"=Summary: {{ $json.output.ttp_identification.alert_summary }}\\n\\n\",\n          \"customFieldsUi\": {\n            \"customFieldsValues\": [\n              {\n                \"id\": 34479547176212,\n                \"value\": \"={{ $json.output.ttp_identification.mitre_attack_ttps[0].technique_id }}\"\n              },\n              {\n                \"id\": 34479570659732,\n                \"value\": \"={{ $json.output.ttp_identification.mitre_attack_ttps[0].tactic }}\"\n              }\n            ]\n          }\n        }\n      },\n      \"credentials\": {\n        \"zendeskApi\": {\n          \"id\": \"ROx0ipJapRomRxEX\",\n          \"name\": \"Zendesk Demo Access\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"6a74a6d4-610a-4a13-afe4-7bb03d83d4c8\",\n      \"name\": \"Move on to next ticket\",\n      \"type\": \"n8n-nodes-base.noOp\",\n      \"position\": [\n        360,\n        -80\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    }\n  ],\n  \"pinData\": {},\n  \"connections\": {\n    \"AI Agent\": {\n      \"main\": [\n        []\n      ]\n    },\n    \"AI Agent1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Update Zendesk with Mitre Data\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Split Out\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Embed JSON in Qdrant Collection\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Loop Over Items\": {\n      \"main\": [\n        [],\n        [\n          {\n            \"node\": \"AI Agent1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Token Splitter1\": {\n      \"ai_textSplitter\": [\n        [\n          {\n            \"node\": \"Default Data Loader\",\n            \"type\": \"ai_textSplitter\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Embeddings OpenAI\": {\n      \"ai_embedding\": [\n        [\n          {\n            \"node\": \"Qdrant Vector Store query\",\n            \"type\": \"ai_embedding\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Extract from File\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Split Out\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"OpenAI Chat Model\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"AI Agent\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Embeddings OpenAI1\": {\n      \"ai_embedding\": [\n        [\n          {\n            \"node\": \"Embed JSON in Qdrant Collection\",\n            \"type\": \"ai_embedding\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Embeddings OpenAI2\": {\n      \"ai_embedding\": [\n        [\n          {\n            \"node\": \"Query Qdrant Vector Store\",\n            \"type\": \"ai_embedding\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"OpenAI Chat Model1\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"AI Agent1\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Default Data Loader\": {\n      \"ai_document\": [\n        [\n          {\n            \"node\": \"Embed JSON in Qdrant Collection\",\n            \"type\": \"ai_document\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Window Buffer Memory\": {\n      \"ai_memory\": [\n        [\n          {\n            \"node\": \"AI Agent\",\n            \"type\": \"ai_memory\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Move on to next ticket\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Loop Over Items\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get all Zendesk Tickets\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Loop Over Items\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Structured Output Parser\": {\n      \"ai_outputParser\": [\n        [\n          {\n            \"node\": \"AI Agent1\",\n            \"type\": \"ai_outputParser\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Qdrant Vector Store query\": {\n      \"ai_tool\": [\n        [\n          {\n            \"node\": \"AI Agent1\",\n            \"type\": \"ai_tool\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Query Qdrant Vector Store\": {\n      \"ai_tool\": [\n        [\n          {\n            \"node\": \"AI Agent\",\n            \"type\": \"ai_tool\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"When chat message received\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"AI Agent\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Pull Mitre Data From Gdrive\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Extract from File\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Update Zendesk with Mitre Data\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Move on to next ticket\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"When clicking ‘Test workflow’\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Pull Mitre Data From Gdrive\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}