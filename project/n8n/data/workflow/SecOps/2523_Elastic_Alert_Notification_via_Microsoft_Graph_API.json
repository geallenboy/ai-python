{
  "title": "Elastic Alert Notification via Microsoft Graph API",
  "url": "https://n8n.io/workflows/2523-elastic-alert-notification-via-microsoft-graph-api/",
  "category": "SecOps",
  "category_url": "https://n8n.io/workflows/categories/secops/?count=20",
  "author": "Aditya Gaur",
  "publish_date": "Last update 3 months ago",
  "content": "",
  "workflow_json": "{\"nodes\":[{\"id\":\"e4929773-39f9-4b8a-b462-235c37514479\",\"name\":\"Get Elastic Alert\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[620,440],\"parameters\":{\"url\":\"https://your-prism-elastic-api-endpoint.com/alerts\",\"options\":{}},\"typeVersion\":2},{\"id\":\"973a8254-5ec0-4ea0-95b5-7e6a0f0625ab\",\"name\":\"Send Email Notification\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[1440,220],\"parameters\":{\"url\":\"https://graph.microsoft.com/v1.0/me/sendMail\",\"options\":{\"bodyContentType\":\"json\"},\"requestMethod\":\"POST\",\"authentication\":\"oAuth2\",\"jsonParameters\":true,\"bodyParametersJson\":\"={\\n  \\\"message\\\": {\\n    \\\"subject\\\": \\\"PRISM Elastic Alert: {{$json[\\\"alert_name\\\"]}}\\\",\\n    \\\"body\\\": {\\n      \\\"contentType\\\": \\\"HTML\\\",\\n      \\\"content\\\": \\\"Hello,<br><br>An alert has been triggered:<br><strong>Alert Name:</strong> {{$json[\\\"alert_name\\\"]}}<br><strong>Severity:</strong> {{$json[\\\"severity\\\"]}}<br><strong>Timestamp:</strong> {{$json[\\\"timestamp\\\"]}}<br><br>Details:<br>{{$json[\\\"alert_message\\\"]}}<br><br>Regards,<br>PRISM Alert System\\\"\\n    },\\n    \\\"toRecipients\\\": [\\n      {\\n        \\\"emailAddress\\\": {\\n          \\\"address\\\": \\\"user@example.com\\\"\\n        }\\n      }\\n    ]\\n  },\\n  \\\"saveToSentItems\\\": \\\"true\\\"\\n}\"},\"typeVersion\":2},{\"id\":\"f7f4feee-6854-4997-ae15-870cab4abdbb\",\"name\":\"Schedule Trigger\",\"type\":\"n8n-nodes-base.scheduleTrigger\",\"position\":[380,440],\"parameters\":{\"rule\":{\"interval\":[{}]}},\"typeVersion\":1.2},{\"id\":\"b8578c55-a052-43f2-9d6a-24d8084dae8a\",\"name\":\"Response is not empty\",\"type\":\"n8n-nodes-base.if\",\"position\":[840,440],\"parameters\":{\"options\":{}},\"typeVersion\":2.1},{\"id\":\"664216e6-c212-4f4b-8b09-60675c4fcd91\",\"name\":\"No Operation, do nothing\",\"type\":\"n8n-nodes-base.noOp\",\"position\":[1100,680],\"parameters\":{},\"typeVersion\":1},{\"id\":\"bcead903-56ed-4ae8-bff9-cec274b2fe71\",\"name\":\"Loop Over Each Alert Items\",\"type\":\"n8n-nodes-base.splitInBatches\",\"position\":[1100,200],\"parameters\":{\"options\":{}},\"typeVersion\":3},{\"id\":\"a5e55903-a245-4d70-88e7-14c1f18cde25\",\"name\":\"No Operation, end of loop\",\"type\":\"n8n-nodes-base.noOp\",\"position\":[1440,0],\"parameters\":{},\"typeVersion\":1}],\"pinData\":{},\"connections\":{\"Schedule Trigger\":{\"main\":[[{\"node\":\"Get PRISM Elastic Alert\",\"type\":\"main\",\"index\":0}]]},\"Response is not empty\":{\"main\":[[{\"node\":\"Loop Over Each Alert Items\",\"type\":\"main\",\"index\":0}],[{\"node\":\"No Operation, do nothing\",\"type\":\"main\",\"index\":0}]]},\"Get PRISM Elastic Alert\":{\"main\":[[{\"node\":\"Response is not empty\",\"type\":\"main\",\"index\":0}]]},\"Send Email Notification\":{\"main\":[[{\"node\":\"Loop Over Each Alert Items\",\"type\":\"main\",\"index\":0}]]},\"Loop Over Each Alert Items\":{\"main\":[[{\"node\":\"No Operation, end of loop\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Send Email Notification\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "## **Who is this template for?**\n\nThis template is for teams and administrators who use n8n to monitor Elastic alerts and want to receive automated email notifications when an alert is triggered. It leverages Microsoft Graph API to send emails and provides an efficient way to notify users about alerts directly in their inbox.\n\n## **How it works?**\n\nThe template connects to the Elastic API to retrieve alert data. When a new alert is detected, the workflow processes the alert content and sends an email notification via Microsoft Graph API. The email includes alert details such as the alert name, timestamp, severity, and a summary of the message, allowing for quick action or review.\n\n## **Setup steps**\n\nStep 1: Set up OAuth2 Credentials in n8n for Microsoft Graph API with Mail.Send permission.  \nStep 2: Configure your Elastic API endpoint in the HTTP Request node to retrieve alerts.  \nStep 3: Modify the email recipients in the template to specify who will receive the alert notifications.  \nStep 4: Customize the email format, if necessary, to include additional alert details or adjust the message.\n",
  "readme_html": "<!--[--><div data-v-006f9244=\"\"><h2><strong>Who is this template for?</strong></h2>\n<p>This template is for teams and administrators who use n8n to monitor Elastic alerts and want to receive automated email notifications when an alert is triggered. It leverages Microsoft Graph API to send emails and provides an efficient way to notify users about alerts directly in their inbox.</p>\n<h2><strong>How it works?</strong></h2>\n<p>The template connects to the Elastic API to retrieve alert data. When a new alert is detected, the workflow processes the alert content and sends an email notification via Microsoft Graph API. The email includes alert details such as the alert name, timestamp, severity, and a summary of the message, allowing for quick action or review.</p>\n<h2><strong>Setup steps</strong></h2>\n<p>Step 1: Set up OAuth2 Credentials in n8n for Microsoft Graph API with Mail.Send permission.<br>\nStep 2: Configure your Elastic API endpoint in the HTTP Request node to retrieve alerts.<br>\nStep 3: Modify the email recipients in the template to specify who will receive the alert notifications.<br>\nStep 4: Customize the email format, if necessary, to include additional alert details or adjust the message.</p>\n</div><!--]-->",
  "readme_zh": "## **此模板适用于谁？**\n\n本模板专为使用n8n监控Elastic警报的团队和管理员设计，当警报触发时，他们希望自动接收邮件通知。该模板利用Microsoft Graph API发送邮件，提供了一种高效的方式，将警报信息直接送达用户邮箱。\n\n## **工作原理**\n\n模板通过连接Elastic API获取警报数据。一旦检测到新警报，工作流将处理警报内容，并通过Microsoft Graph API发送邮件通知。邮件包含警报名称、时间戳、严重程度及消息摘要等详细信息，便于用户快速采取行动或进行复查。\n\n## **设置步骤**\n\n步骤1：在n8n中为Microsoft Graph API配置OAuth2凭证，并授予Mail.Send权限。  \n步骤2：在HTTP Request节点中配置Elastic API端点以获取警报。  \n步骤3：修改模板中的收件人列表，指定接收警报通知的人员。  \n步骤4：如需调整邮件格式，可自定义内容以包含更多警报细节或修改消息样式。",
  "title_zh": "通过Microsoft Graph API发送弹性警报通知",
  "publish_date_zh": "最后更新于3个月前",
  "workflow_json_zh": "{\"nodes\": [{\"id\": \"e4929773-39f9-4b8a-b462-235c37514479\", \"name\": \"弹性警报\", \"type\": \"n8n-nodes-base.httpRequest\", \"position\": [620, 440], \"parameters\": {\"url\": \"https://您的棱镜弹性API端点.com/警报\", \"options\": {}}, \"typeVersion\": 2}, {\"id\": \"973a8254-5ec0-4ea0-95b5-7e6a0f0625ab\", \"name\": \"发送电子邮件通知\", \"type\": \"n8n-nodes-base.httpRequest\", \"position\": [1440, 220], \"parameters\": {\"url\": \"https://graph.microsoft.com/v1.0/me/sendMail\", \"options\": {\"bodyContentType\": \"json\"}, \"requestMethod\": \"邮政\", \"authentication\": \"OAuth2\", \"jsonParameters\": true, \"bodyParametersJson\": \"{\\n  \\\"message\\\": {\\n    \\\"subject\\\": \\\"PRISM弹性警报：{{$json[\\\"alert_name\\\"]}}\\\",\\n    \\\"body\\\": {\\n      \\\"contentType\\\": \\\"HTML\\\",\\n      \\\"content\\\": \\\"您好，<br><br>已触发警报：<br><strong>警报名称：</strong> {{$json[\\\"alert_name\\\"]}}<br><strong>严重程度：</strong> {{$json[\\\"severity\\\"]}}<br><strong>时间戳：</strong> {{$json[\\\"timestamp\\\"]}}<br><br>详情：<br>{{$json[\\\"alert_message\\\"]}}<br><br>此致，<br>PRISM警报系统\\\"\\n    },\\n    \\\"toRecipients\\\": [\\n      {\\n        \\\"emailAddress\\\": {\\n          \\\"address\\\": \\\"user@example.com\\\"\\n        }\\n      }\\n    ]\\n  },\\n  \\\"saveToSentItems\\\": \\\"true\\\"\\n}\"}, \"typeVersion\": 2}, {\"id\": \"f7f4feee-6854-4997-ae15-870cab4abdbb\", \"name\": \"计划触发器\", \"type\": \"n8n-nodes-base.scheduleTrigger\", \"position\": [380, 440], \"parameters\": {\"rule\": {\"interval\": [{}]}}, \"typeVersion\": 1.2}, {\"id\": \"b8578c55-a052-43f2-9d6a-24d8084dae8a\", \"name\": \"响应不为空\", \"type\": \"n8n-nodes-base.if\", \"position\": [840, 440], \"parameters\": {\"options\": {}}, \"typeVersion\": 2.1}, {\"id\": \"664216e6-c212-4f4b-8b09-60675c4fcd91\", \"name\": \"无操作，不执行任何动作\", \"type\": \"n8n-nodes-base.noOp\", \"position\": [1100, 680], \"parameters\": {}, \"typeVersion\": 1}, {\"id\": \"bcead903-56ed-4ae8-bff9-cec274b2fe71\", \"name\": \"循环遍历每个警报项\", \"type\": \"n8n-nodes-base.splitInBatches\", \"position\": [1100, 200], \"parameters\": {\"options\": {}}, \"typeVersion\": 3}, {\"id\": \"a5e55903-a245-4d70-88e7-14c1f18cde25\", \"name\": \"无操作，循环结束\", \"type\": \"n8n-nodes-base.noOp\", \"position\": [1440, 0], \"parameters\": {}, \"typeVersion\": 1}], \"pinData\": {}, \"connections\": {\"Schedule Trigger\": {\"main\": [[{\"node\": \"Get PRISM Elastic Alert\", \"type\": \"main\", \"index\": 0}]]}, \"Response is not empty\": {\"main\": [[{\"node\": \"Loop Over Each Alert Items\", \"type\": \"main\", \"index\": 0}], [{\"node\": \"No Operation, do nothing\", \"type\": \"main\", \"index\": 0}]]}, \"Get PRISM Elastic Alert\": {\"main\": [[{\"node\": \"Response is not empty\", \"type\": \"main\", \"index\": 0}]]}, \"Send Email Notification\": {\"main\": [[{\"node\": \"Loop Over Each Alert Items\", \"type\": \"main\", \"index\": 0}]]}, \"Loop Over Each Alert Items\": {\"main\": [[{\"node\": \"No Operation, end of loop\", \"type\": \"main\", \"index\": 0}], [{\"node\": \"Send Email Notification\", \"type\": \"main\", \"index\": 0}]]}}}"
}