{
  "title": "Venafi Cloud Slack Cert Bot",
  "url": "https://n8n.io/workflows/2422-venafi-cloud-slack-cert-bot/",
  "category": "SecOps",
  "category_url": "https://n8n.io/workflows/categories/secops/?sort=createdAt:desc",
  "author": "Angel Menendez",
  "publish_date": "Last update 5 months ago",
  "publish_date_absolute": "2024-12-07",
  "content": "",
  "workflow_json": "{\"meta\":{\"instanceId\":\"cb484ba7b742928a2048bf8829668bed5b5ad9787579adea888f05980292a4a7\"},\"nodes\":[{\"id\":\"1092ab50-67a0-4e50-8c10-f05f70b45f56\",\"name\":\"Venafi TLS Protect Cloud\",\"type\":\"n8n-nodes-base.venafiTlsProtectCloud\",\"position\":[2860,1700],\"parameters\":{\"options\":{},\"commonName\":\"={{ $('Parse Webhook').item.json.response.view.state.values.domain_name_block.domain_name_input.value.match(/^(\\\\*\\\\.)?([a-zA-Z0-9-]+\\\\.)+[a-zA-Z]{2,}$/g).toString() }}\",\"generateCsr\":true,\"applicationId\":\"f3c15c80-7151-11ef-9a22-abeac49f7094\",\"additionalFields\":{\"organizationalUnits\":[\"={{ $json.name }}\"]},\"certificateIssuingTemplateId\":\"d28d82b1-714b-11ef-9026-7bb80b32867a\"},\"credentials\":{\"venafiTlsProtectCloudApi\":{\"id\":\"WU38IpfutNNkJWuo\",\"name\":\"Venafi TLS Protect Cloud account\"}},\"typeVersion\":1},{\"id\":\"0c1f1b92-2da4-413f-a4cc-68c816e8511c\",\"name\":\"Parse Webhook\",\"type\":\"n8n-nodes-base.set\",\"position\":[440,1100],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"e63f9299-a19d-4ba1-93b0-59f458769fb2\",\"name\":\"response\",\"type\":\"object\",\"value\":\"={{ $json.body.payload }}\"}]}},\"typeVersion\":3.3},{\"id\":\"95fb1907-c9e0-4164-b0b0-c3691bb46b9a\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[108.34675483142371,741.4892041682327],\"parameters\":{\"color\":7,\"width\":466.8168310000617,\"height\":556.7924159157113,\"content\":\"![Imgur](https://i.imgur.com/iKyMV0N.png)\\n## Events Webhook Trigger\\nThe first node receives all messages from Slack API via Subscription Events API. You can find more information about setting up the subscription events API by [clicking here](https://api.slack.com/apis/connections/events-api). \\n\\nThe second node extracts the payload from slack into an object that n8n can understand.  \"},\"typeVersion\":1},{\"id\":\"4dd8cbbe-278c-4c86-bcd7-9fb0eff619b2\",\"name\":\"Sticky Note15\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[580,420],\"parameters\":{\"color\":7,\"width\":566.0553219408072,\"height\":999.0925226187064,\"content\":\"![n8n](https://i.imgur.com/lKnBNnH.png)\\n## Efficient Slack Interaction Handling with n8n\\n\\nThis section of the workflow is designed to efficiently manage and route messages and submissions from Slack based on specific triggers and conditions. When a Slack interaction occurs—such as a user triggering a vulnerability scan or generating a report through a modal—the workflow intelligently routes the message to the appropriate action:\\n\\n- **Dynamic Routing**: Uses conditions to determine the nature of the Slack interaction, whether it's a direct command to initiate a scan or a request to generate a report.\\n- **Modal Management**: Differentiates actions based on modal titles and `callback_id`s, ensuring that each type of submission is processed according to its context.\\n- **Streamlined Responses**: After routing, the workflow promptly handles the necessary responses or actions, including closing modal popups and responding to Slack with appropriate confirmation or data.\\n\\n**Purpose**: This mechanism ensures that all interactions within Slack are handled quickly and accurately, automating responses and actions in real-time to enhance user experience and workflow efficiency.\"},\"typeVersion\":1},{\"id\":\"db8aabd8-d00d-4d50-9f97-443eba7c7c90\",\"name\":\"Sticky Note11\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1153.6255461332685,516.1718360212528],\"parameters\":{\"color\":7,\"width\":396.6025898621133,\"height\":652.6603582798184,\"content\":\"![Imgur](https://i.imgur.com/iKyMV0N.png)\\n## Display Modal Popup\\nThis section pops open a modal window that is later used to send data into Virustotal, then depending on those results, to Venafi or Slack for manual approval. \\n\\nModals can be customized to perform all sorts of actions. And they are natively mobile! Additionally, messages themselves can perform actions if you include inputs like buttons or field inputs. \\n\\nLearn more about them by [clicking here](https://api.slack.com/surfaces/modals)\"},\"typeVersion\":1},{\"id\":\"a86e0b86-0740-4b77-831a-52413983818e\",\"name\":\"Close Modal Popup\",\"type\":\"n8n-nodes-base.respondToWebhook\",\"position\":[960,1200],\"parameters\":{\"options\":{},\"respondWith\":\"noData\"},\"typeVersion\":1.1},{\"id\":\"a5abc206-6b10-42bc-9196-bcedacdb3726\",\"name\":\"Sticky Note8\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-580,740],\"parameters\":{\"width\":675.1724774900403,\"height\":972.8853473866498,\"content\":\"![n8n](https://i.imgur.com/lKnBNnH.png)\\n## Enhance Security Operations with the Venafi Slack CertBot!\\n\\nOur **Venafi Slack CertBot** is strategically designed to facilitate immediate security operations directly from Slack. This tool allows end users to request Certificate Signing Requests that are automatically approved or passed to the Secops team for manual approval depending on the Virustotal analysis of the requested domain. Not only does this help centralize requests, but it helps an organization maintain the security certifications by allowing automated processes to log and analyze requests in real time. \\n\\n**Workflow Highlights:**\\n- **Interactive Modals**: Utilizes Slack modals to gather user inputs for scan configurations and report generation, providing a user-friendly interface for complex operations.\\n- **Dynamic Workflow Execution**: Integrates seamlessly with Venafi to execute CSR generation and if any issues are found, AI can generate a custom report that is then passed to a slack teams channel for manual approval with the press of a single button.\\n\\n**Operational Flow:**\\n- **Parse Webhook Data**: Captures and parses incoming data from Slack to understand user commands accurately.\\n- **Execute Actions**: Depending on the user's selection, the workflow triggers other actions within the flow like automatic Virustotal Scanning.\\n- **Respond to Slack**: Ensures that every interaction is acknowledged, maintaining a smooth user experience by managing modal popups and sending appropriate responses.\\n\\n\\n**Setup Instructions:**\\n- Verify that Slack and Qualys API integrations are correctly configured for seamless interaction.\\n- Customize the modal interfaces to align with your organization's operational protocols and security policies.\\n- Test the workflow to ensure that it responds accurately to Slack commands and that the integration with Qualys is functioning as expected.\\n\\n\\n**Need Assistance?**\\n- Explore Venafi's [Documentation](https://docs.venafi.com/) or get help from the [n8n Community](https://community.n8n.io) for more detailed guidance on setup and customization.\\n\\nDeploy this bot within your Slack environment to significantly enhance the efficiency and responsiveness of your security operations, enabling proactive management of CSR's.\"},\"typeVersion\":1},{\"id\":\"352680c7-3b77-4fc1-81eb-8b5495747d89\",\"name\":\"Respond to Slack Webhook - Vulnerability\",\"type\":\"n8n-nodes-base.respondToWebhook\",\"position\":[960,1000],\"parameters\":{\"options\":{},\"respondWith\":\"noData\"},\"typeVersion\":1.1},{\"id\":\"7e2991c3-14ee-478c-b9b6-9dd58590dde9\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1160,860],\"parameters\":{\"color\":5,\"width\":376.26546828439086,\"height\":113.6416448104651,\"content\":\"### 🙋 Don't forget your slack credentials!\\nThankfully n8n makes it easy, as long as you've added credentials to a normal slack node, these http nodes are a snap to change via the drop down. \"},\"typeVersion\":1},{\"id\":\"97b8942b-1ec5-437f-9c51-2188cc9a9d6f\",\"name\":\"Venafi Request Certificate\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[1240,1000],\"parameters\":{\"url\":\"https://slack.com/api/views.open\",\"method\":\"POST\",\"options\":{},\"jsonBody\":\"=  {\\n    \\\"trigger_id\\\": \\\"{{ $('Parse Webhook').item.json['response']['trigger_id'] }}\\\",\\n    \\\"external_id\\\": \\\"Idea Selector\\\",\\n    \\\"view\\\": {\\n\\t\\\"type\\\": \\\"modal\\\",\\n\\t\\\"callback_id\\\": \\\"certificate_request_modal\\\",\\n\\t\\\"title\\\": {\\n\\t\\t\\\"type\\\": \\\"plain_text\\\",\\n\\t\\t\\\"text\\\": \\\"Request New Certificate\\\"\\n\\t},\\n\\t\\\"submit\\\": {\\n\\t\\t\\\"type\\\": \\\"plain_text\\\",\\n\\t\\t\\\"text\\\": \\\"Request\\\"\\n\\t},\\n\\t\\\"close\\\": {\\n\\t\\t\\\"type\\\": \\\"plain_text\\\",\\n\\t\\t\\\"text\\\": \\\"Cancel\\\"\\n\\t},\\n\\t\\\"blocks\\\": [\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"image\\\",\\n\\t\\t\\t\\\"image_url\\\": \\\"https://img.securityinfowatch.com/files/base/cygnus/siw/image/2022/10/Venafi_logo.63459e2b03b7b.png?auto=format%2Ccompress&w=640&width=640\\\",\\n\\t\\t\\t\\\"alt_text\\\": \\\"delicious tacos\\\"\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"input\\\",\\n\\t\\t\\t\\\"block_id\\\": \\\"domain_name_block\\\",\\n\\t\\t\\t\\\"label\\\": {\\n\\t\\t\\t\\t\\\"type\\\": \\\"plain_text\\\",\\n\\t\\t\\t\\t\\\"text\\\": \\\"Domain Name\\\"\\n\\t\\t\\t},\\n\\t\\t\\t\\\"element\\\": {\\n\\t\\t\\t\\t\\\"type\\\": \\\"plain_text_input\\\",\\n\\t\\t\\t\\t\\\"action_id\\\": \\\"domain_name_input\\\",\\n\\t\\t\\t\\t\\\"placeholder\\\": {\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"plain_text\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"Enter the domain name\\\"\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"input\\\",\\n\\t\\t\\t\\\"block_id\\\": \\\"validity_period_block\\\",\\n\\t\\t\\t\\\"label\\\": {\\n\\t\\t\\t\\t\\\"type\\\": \\\"plain_text\\\",\\n\\t\\t\\t\\t\\\"text\\\": \\\"Validity Period\\\"\\n\\t\\t\\t},\\n\\t\\t\\t\\\"element\\\": {\\n\\t\\t\\t\\t\\\"type\\\": \\\"static_select\\\",\\n\\t\\t\\t\\t\\\"action_id\\\": \\\"validity_period_select\\\",\\n\\t\\t\\t\\t\\\"placeholder\\\": {\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"plain_text\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"Select a validity period\\\"\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\\"options\\\": [\\n\\t\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\t\\\"text\\\": {\\n\\t\\t\\t\\t\\t\\t\\t\\\"type\\\": \\\"plain_text\\\",\\n\\t\\t\\t\\t\\t\\t\\t\\\"text\\\": \\\"1 Year\\\"\\n\\t\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\t\\t\\\"value\\\": \\\"P1Y\\\"\\n\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\t\\\"text\\\": {\\n\\t\\t\\t\\t\\t\\t\\t\\\"type\\\": \\\"plain_text\\\",\\n\\t\\t\\t\\t\\t\\t\\t\\\"text\\\": \\\"2 Years\\\"\\n\\t\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\t\\t\\\"value\\\": \\\"P2Y\\\"\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t]\\n\\t\\t\\t}\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"input\\\",\\n\\t\\t\\t\\\"block_id\\\": \\\"optional_note_block\\\",\\n\\t\\t\\t\\\"optional\\\": true,\\n\\t\\t\\t\\\"label\\\": {\\n\\t\\t\\t\\t\\\"type\\\": \\\"plain_text\\\",\\n\\t\\t\\t\\t\\\"text\\\": \\\"Optional Note\\\"\\n\\t\\t\\t},\\n\\t\\t\\t\\\"element\\\": {\\n\\t\\t\\t\\t\\\"type\\\": \\\"plain_text_input\\\",\\n\\t\\t\\t\\t\\\"action_id\\\": \\\"optional_note_input\\\",\\n\\t\\t\\t\\t\\\"multiline\\\": true,\\n\\t\\t\\t\\t\\\"placeholder\\\": {\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"plain_text\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"Add any extra information (e.g., usage context, urgency)\\\"\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\t\\t}\\n\\t]\\n}\\n}\",\"sendBody\":true,\"jsonQuery\":\"{\\n  \\\"Content-type\\\": \\\"application/json\\\"\\n}\",\"sendQuery\":true,\"specifyBody\":\"json\",\"specifyQuery\":\"json\",\"authentication\":\"predefinedCredentialType\",\"nodeCredentialType\":\"slackApi\"},\"credentials\":{\"slackApi\":{\"id\":\"hkcQkp6qhtiMzBEX\",\"name\":\"certbot\"}},\"typeVersion\":4.2},{\"id\":\"12c50bad-8aab-4bab-8790-153d9e484762\",\"name\":\"Extract Fields\",\"type\":\"n8n-nodes-base.set\",\"position\":[1200,1460],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"39808a24-60f6-4f4b-8f4c-4c2aa3850b4f\",\"name\":\"domain\",\"type\":\"string\",\"value\":\"={{ $json.response.view.state.values.domain_name_block.domain_name_input.value }}\"},{\"id\":\"27c905be-18cc-434f-8af0-a08ee23a168f\",\"name\":\"validity\",\"type\":\"string\",\"value\":\"={{ $json.response.view.state.values.validity_period_block.validity_period_select.selected_option.value }}\"},{\"id\":\"ba1382e5-0629-4276-9858-34bcb59cc85a\",\"name\":\"note\",\"type\":\"string\",\"value\":\"={{ $json.response.view.state.values.optional_note_block.optional_note_input.value }}\"}]}},\"typeVersion\":3.4},{\"id\":\"f16a97d7-639e-4ec9-b003-b4ee4fdf8666\",\"name\":\"Get Slack User ID\",\"type\":\"n8n-nodes-base.set\",\"position\":[1200,2020],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"53dfe019-d91d-4f5c-b279-f8b3fde98bf1\",\"name\":\"id\",\"type\":\"string\",\"value\":\"={{ $json.response.user.id }}\"}]}},\"typeVersion\":3.4},{\"id\":\"2a6af9ae-3916-4993-b2b3-a737f54f7a37\",\"name\":\"Translate Slack User ID to Email\",\"type\":\"n8n-nodes-base.executeWorkflow\",\"position\":[1520,2020],\"parameters\":{\"options\":{\"waitForSubWorkflow\":true},\"workflowId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"afeVlIVyoIF8Psu4\",\"cachedResultName\":\"Slack ID to Email\"}},\"typeVersion\":1.1},{\"id\":\"19541f84-0d97-4711-80ed-d36a5d517d9b\",\"name\":\"VirusTotal HTTP Request\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[1440,1460],\"parameters\":{\"\":\"\",\"url\":\"=https://www.virustotal.com/api/v3/domains/{{ $json.domain }}\",\"method\":\"GET\",\"options\":{},\"sendBody\":false,\"sendQuery\":false,\"curlImport\":\"\",\"infoMessage\":\"\",\"sendHeaders\":true,\"authentication\":\"none\",\"specifyHeaders\":\"keypair\",\"headerParameters\":{\"parameters\":[{\"name\":\"accept\",\"value\":\"application/json\"},{\"name\":\"X-Apikey\",\"value\":\"455144dac89b783b2f5421578b9ab4072adebfc011c969ba384d1c8f0e2ce39e\"}]},\"httpVariantWarning\":\"\",\"provideSslCertificates\":false},\"credentials\":{\"virusTotalApi\":{\"id\":\"JRK1xDyMiseROCmY\",\"name\":\"VirusTotal account 2\"}},\"typeVersion\":4.2,\"extendsCredential\":\"virusTotalApi\"},{\"id\":\"4a0e0a71-b433-479b-87b7-7200537009af\",\"name\":\"Summarize output to save on tokens\",\"type\":\"n8n-nodes-base.set\",\"position\":[1760,1460],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"2c4689a3-4b72-4240-8a0f-2fa00d33c553\",\"name\":\"data.attributes.last_analysis_stats.malicious\",\"type\":\"number\",\"value\":\"={{ $json.data.attributes.last_analysis_stats.malicious }}\"},{\"id\":\"59db6f41-1cf1-4feb-8120-8c50fadc5c9e\",\"name\":\"data.attributes.last_analysis_stats.suspicious\",\"type\":\"number\",\"value\":\"={{ $json.data.attributes.last_analysis_stats.suspicious }}\"},{\"id\":\"b55e7d39-0358-4863-8147-c5ce2b65ea96\",\"name\":\"data.attributes.last_analysis_stats.undetected\",\"type\":\"number\",\"value\":\"={{ $json.data.attributes.last_analysis_stats.undetected }}\"},{\"id\":\"ecd98a37-cb8b-48cd-bd3d-9c8bf777c5ca\",\"name\":\"data.attributes.last_analysis_stats.harmless\",\"type\":\"number\",\"value\":\"={{ $json.data.attributes.last_analysis_stats.harmless }}\"},{\"id\":\"72a776d5-70d7-4c30-b8fc-f7da382bc626\",\"name\":\"data.attributes.last_analysis_stats.timeout\",\"type\":\"number\",\"value\":\"={{ $json.data.attributes.last_analysis_stats.timeout }}\"},{\"id\":\"b85d8e8a-620c-4bb7-97db-d780f273deee\",\"name\":\"data.attributes.reputation\",\"type\":\"number\",\"value\":\"={{ $json.data.attributes.reputation }}\"}]}},\"typeVersion\":3.4},{\"id\":\"3d641c80-8a2a-4888-9ee3-ecd82f8d0d8b\",\"name\":\"Auto Issue Certificate Based on 0 Malicious Reports\",\"type\":\"n8n-nodes-base.if\",\"position\":[2300,1840],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"795c6ff5-ac4a-4b67-b2fe-369fba276194\",\"operator\":{\"type\":\"number\",\"operation\":\"lte\"},\"leftValue\":\"={{ $json.data.attributes.last_analysis_stats.malicious }}\",\"rightValue\":0}]}},\"typeVersion\":2.2},{\"id\":\"3f6e9bf2-6c6c-4316-8d14-1b004122fa67\",\"name\":\"Auto Issue Certificate\",\"type\":\"n8n-nodes-base.noOp\",\"position\":[2560,1700],\"parameters\":{},\"typeVersion\":1},{\"id\":\"fa34e736-65c4-4bc1-a391-794225a588d2\",\"name\":\"Generate Report For Manual Approval\",\"type\":\"n8n-nodes-base.noOp\",\"position\":[2540,2220],\"parameters\":{},\"typeVersion\":1},{\"id\":\"178afe87-cdef-46f0-8166-68b661349189\",\"name\":\"Get Slack Team ID\",\"type\":\"n8n-nodes-base.set\",\"position\":[1220,2220],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"53dfe019-d91d-4f5c-b279-f8b3fde98bf1\",\"name\":\"id\",\"type\":\"string\",\"value\":\"={{ $json.response.team.id }}\"}]}},\"typeVersion\":3.4},{\"id\":\"c4d89085-f7f4-4073-bfe2-cd156275710c\",\"name\":\"Execute Workflow\",\"type\":\"n8n-nodes-base.executeWorkflow\",\"position\":[1520,2220],\"parameters\":{\"options\":{},\"workflowId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"ZIl9VdWh7BiVRRBT\",\"cachedResultName\":\"Slack Team ID to Name\"}},\"typeVersion\":1.1},{\"id\":\"51d85502-ea61-423b-a6c4-66ed8397d685\",\"name\":\"Merge User and Team Data\",\"type\":\"n8n-nodes-base.merge\",\"position\":[1820,2140],\"parameters\":{\"mode\":\"combine\",\"options\":{},\"combineBy\":\"combineByPosition\"},\"typeVersion\":3},{\"id\":\"febb1be8-7cad-46f1-a854-2ff1432216cb\",\"name\":\"OpenAI\",\"type\":\"@n8n/n8n-nodes-langchain.openAi\",\"position\":[2720,2220],\"parameters\":{\"modelId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"gpt-4o-mini\",\"cachedResultName\":\"GPT-4O-MINI\"},\"options\":{},\"messages\":{\"values\":[{\"content\":\"=Analyze the following VirusTotal scan results and summarize the overall risk as Low, Medium, or High based on the number of engines flagging the domain (excluding \\\"clean\\\" or \\\"unrated\\\" results). Use the following criteria for risk rating:\\n\\nLow: No significant threats detected; domain is clean.\\nMedium: Minor issues detected; may require further review.\\nHigh: Significant threats like phishing or malware; manual review recommended.\\n\\nHere are the scan results for the domain {{ $('Parse Webhook').item.json.response.view.state.values.domain_name_block.domain_name_input.value }}:\\n\\nMalicious: {{ $json.data.attributes.last_analysis_stats.malicious }}\\nSuspicious: {{ $json.data.attributes.last_analysis_stats.suspicious }}\\nUndetected: {{ $json.data.attributes.last_analysis_stats.undetected }}\\nHarmless: {{ $json.data.attributes.last_analysis_stats.harmless }}\\nTimeout: {{ $json.data.attributes.last_analysis_stats.timeout }}\\nReputation: {{ $json.data.attributes.reputation }}\\n\\nProvide an overall risk rating and suggest next steps based on your analysis. Please keep it concise. \"},{\"role\":\"system\",\"content\":\"Analyze the VirusTotal scan results and categorize the domain’s risk as Low, Medium, or High:\\n\\nIdentify Risks: Focus on results flagged as anything other than \\\"clean\\\" or \\\"unrated.\\\"\\nAssess Risk:\\nLow: No major threats flagged, domain is safe.\\nMedium: Minor issues flagged, review recommended.\\nHigh: Significant threats flagged (e.g., phishing, malware), manual review needed.\\nRecommendation:\\nLow: Auto-issue the certificate.\\nMedium/High: Recommend manual review.\"}]}},\"credentials\":{\"openAiApi\":{\"id\":\"2KVzlb0XZRZkoObj\",\"name\":\"angel openai auth\"}},\"typeVersion\":1.5},{\"id\":\"04ffe7bb-be5d-4ce0-b17c-68276673f585\",\"name\":\"Sticky Note16\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1160,1680],\"parameters\":{\"color\":7,\"width\":833.9929589980072,\"height\":705.5291769708515,\"content\":\"![n8n](https://i.imgur.com/qXWqiOd.png)\\n## Run Workflows within other Workflows like Functions\\n\\nThis section of the workflow contains 2 subworkflows that translate the Slack User ID to an email and name, and the Slack Team ID into the team name and Avatar of the team to make the slack messages more visual. This allows you to reuse these flows like you would use a function in code. \\n\\nThese nodes run parallel to each other so they will not override the data generated by each thread, and then are joined using the Merge nodes. \"},\"typeVersion\":1},{\"id\":\"a2b48f56-946b-4ae7-ade4-5b84b1a99bb9\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1160,1180],\"parameters\":{\"color\":7,\"width\":832.2724669887743,\"height\":485.55399396506067,\"content\":\"![VirusTotal](https://upload.wikimedia.org/wikipedia/commons/thumb/b/b7/VirusTotal_logo.svg/320px-VirusTotal_logo.svg.png)\\n## URL Analysis with VirusTotal\\nThe first node receives all messages from Slack API via Subscription Events API. You can find more information about setting up the subscription events API by [clicking here](https://api.slack.com/apis/connections/events-api). \\n\\nThe second node extracts the payload from slack into an object that n8n can understand.  \"},\"typeVersion\":1},{\"id\":\"c38c30f3-acb1-40e4-acc5-3fd4f6b8e643\",\"name\":\"Merge Requestor and VT Data\",\"type\":\"n8n-nodes-base.merge\",\"position\":[2100,1840],\"parameters\":{\"mode\":\"combine\",\"options\":{},\"combineBy\":\"combineByPosition\"},\"typeVersion\":3},{\"id\":\"2e2c6100-b82e-4cdf-a290-33c2898de652\",\"name\":\"Sticky Note3\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[2480,1420],\"parameters\":{\"color\":7,\"width\":547.705272240834,\"height\":485.55399396506067,\"content\":\"![VirusTotal](https://img.securityinfowatch.com/files/base/cygnus/siw/image/2022/10/Venafi_logo.63459e2b03b7b.png?auto=format%2Ccompress&w=250&width=250)\\n## Automatic CSR Generation via Venafi\\nContextual data from the Slack user's webhook is used to gather the needed contextual data, such as the name of the Slack team/group the user is in and their email and name if needed. \\n\\nFor automatic CSR Generation to work, ensure you have a Vsatelite deployed and active. \"},\"typeVersion\":1},{\"id\":\"4c168cd6-e5d2-4d82-9fe3-3b8431db3dcd\",\"name\":\"Sticky Note12\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[3040,1309.0359710471785],\"parameters\":{\"color\":7,\"width\":367.3323860824746,\"height\":831.2760849855022,\"content\":\"![Imgur](https://i.imgur.com/iKyMV0N.png)\\n## Send Contextual Message to Slack\\nThis section pops open a modal window that is later used to send data into TheHive. \\n\\nModals can be customized to perform all sorts of actions. And they are natively mobile! You can see a screenshot of the Slack Modals on the right. \\n\\nLearn more about them by [clicking here](https://api.slack.com/surfaces/modals)\"},\"typeVersion\":1},{\"id\":\"08687e15-90e0-42da-95a4-ada8b7ddcd36\",\"name\":\"Sticky Note17\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[2000,1421.1618229241317],\"parameters\":{\"color\":7,\"width\":465.44793569024944,\"height\":676.0664675646049,\"content\":\"![n8n](https://i.imgur.com/lKnBNnH.png)\\n## Efficient Slack Interaction Handling with n8n\\n\\nThis section of the workflow is designed to efficiently manage and route messages and submissions from Slack based on specific triggers and conditions. When a Slack interaction occurs—such as a user triggering a vulnerability scan or generating a report through a modal—the workflow intelligently routes the message to the appropriate action:\"},\"typeVersion\":1},{\"id\":\"7098d247-5f39-4c61-a055-d7e9d12c2a64\",\"name\":\"Sticky Note6\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[2480,1920],\"parameters\":{\"color\":7,\"width\":544.2406462166426,\"height\":546.0036529662652,\"content\":\"![OpenAI](https://i.imgur.com/o89G0If.png)\\n## Parse Response with AI Model \\nThis workflow currently uses OpenAI to power it's responses, but you can replace the AI Agent node below and set your own local AI LLM using the n8n options offered. \"},\"typeVersion\":1},{\"id\":\"3f2ea251-6f4e-4701-8456-d3020169f802\",\"name\":\"Send Auto Generated Confirmation\",\"type\":\"n8n-nodes-base.slack\",\"position\":[3160,1700],\"parameters\":{\"text\":\"test\",\"select\":\"channel\",\"blocksUi\":\"={\\n\\t\\\"blocks\\\": [\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"section\\\",\\n\\t\\t\\t\\\"text\\\": {\\n\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\\"text\\\": \\\"*:lock: CSR Auto-Issued Successfully!*\\\"\\n\\t\\t\\t}\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"divider\\\"\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"section\\\",\\n\\t\\t\\t\\\"text\\\": {\\n\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\\"text\\\": \\\"*Team:* {{ $('Merge Requestor and VT Data').item.json.name }}\\\\n*Requested by:* <@{{ $('Parse Webhook').item.json.response.user.id }}>\\\\n*Email:* {{ $('Merge User and Team Data').item.json.email }}\\\\n*Date Issued:* {{ $json.creationDate }}\\\"\\n\\t\\t\\t},\\n\\t\\t\\t\\\"accessory\\\": {\\n\\t\\t\\t\\t\\\"type\\\": \\\"image\\\",\\n\\t\\t\\t\\t\\\"image_url\\\": \\\"{{ $('Merge User and Team Data').item.json.team.icon.image_132 }}\\\",\\n\\t\\t\\t\\t\\\"alt_text\\\": \\\"Team Avatar\\\"\\n\\t\\t\\t}\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"context\\\",\\n\\t\\t\\t\\\"elements\\\": [\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"*CSR Details:*\\\"\\n\\t\\t\\t\\t}\\n\\t\\t\\t]\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"section\\\",\\n\\t\\t\\t\\\"fields\\\": [\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"*Common Name:* {{ $('Parse Webhook').item.json.response.view.state.values.domain_name_block.domain_name_input.value }}\\\"\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"*Organization:* n8n.io\\\"\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"*Issued By:* Venafi CA\\\"\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"*Validity Period:* {{ DateTime.fromISO($json.creationDate).toFormat('MMMM dd, yyyy') }} to {{ DateTime.fromISO($json.creationDate).plus({ years: 1 }).toFormat('MMMM dd, yyyy') }}\\\"\\n\\t\\t\\t\\t}\\n\\t\\t\\t]\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"divider\\\"\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"actions\\\",\\n\\t\\t\\t\\\"elements\\\": [\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"button\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": {\\n\\t\\t\\t\\t\\t\\t\\\"type\\\": \\\"plain_text\\\",\\n\\t\\t\\t\\t\\t\\t\\\"text\\\": \\\"View CSR Details\\\"\\n\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\t\\\"url\\\": \\\"https://eval-32690260.venafi.cloud/issuance/certificate-requests?id={{ $json.id }}\\\",\\n\\t\\t\\t\\t\\t\\\"style\\\": \\\"primary\\\"\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"button\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": {\\n\\t\\t\\t\\t\\t\\t\\\"type\\\": \\\"plain_text\\\",\\n\\t\\t\\t\\t\\t\\t\\\"text\\\": \\\"Revoke CSR\\\"\\n\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\t\\\"style\\\": \\\"danger\\\",\\n\\t\\t\\t\\t\\t\\\"value\\\": \\\"revoke_csr\\\"\\n\\t\\t\\t\\t}\\n\\t\\t\\t]\\n\\t\\t}\\n\\t]\\n}\",\"channelId\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"C07MB8PGZ36\"},\"messageType\":\"block\",\"otherOptions\":{}},\"credentials\":{\"slackApi\":{\"id\":\"hkcQkp6qhtiMzBEX\",\"name\":\"certbot\"}},\"typeVersion\":2.2},{\"id\":\"17b7cc2e-32ff-4670-a756-bb41627dc14a\",\"name\":\"Send Message Request for Manual Approval\",\"type\":\"n8n-nodes-base.slack\",\"position\":[3160,1940],\"parameters\":{\"text\":\"test\",\"select\":\"channel\",\"blocksUi\":\"={\\n\\t\\\"blocks\\\": [\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"section\\\",\\n\\t\\t\\t\\\"text\\\": {\\n\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\\"text\\\": \\\":warning: *CSR Pending Approval*\\\\n\\\\nThe Certificate Signing Request for the following domain was not auto-approved. Please review the details and press the button below to submit the request for manual approval.\\\"\\n\\t\\t\\t}\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"divider\\\"\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"section\\\",\\n\\t\\t\\t\\\"text\\\": {\\n\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\\"text\\\": \\\"*Team:* {{ $('Merge Requestor and VT Data').item.json.name }}\\\\n*Submitted by:* <@{{ $('Parse Webhook').item.json.response.user.id }}>\\\\n*Requestor Email:* {{ $('Merge Requestor and VT Data').item.json.email }}\\\\n*Date Submitted:* {{ DateTime.fromISO($json.creationDate).toFormat('MMMM dd, yyyy') }}\\\\n*Domain:* {{ $('Parse Webhook').item.json.response.view.state.values.domain_name_block.domain_name_input.value }}\\\\n\\\\n:mag: *AI Analysis*\\\\n> The AI detected the following potential issues with the CSR:\\\\n> - *VT Malicious Reports:* {{ $('Generate Report For Manual Approval').item.json.data.attributes.last_analysis_stats.malicious }}\\\\n> - *Reputation Score:* {{ $('Generate Report For Manual Approval').item.json.data.attributes.reputation }}/100\\\\n> - *Additional Notes:* {{ $json.message.content.replace(/\\\\n/g, '\\\\\\\\n').replace(/###/g, ' ').replace(/-\\\\s+\\\\*\\\\*(.*?)\\\\*\\\\*/g, '• *$1*').replace(/\\\"/g, '\\\\\\\\\\\"').replace(/\\\\*\\\\*/g, '*') }}\\\\n\\\\nPlease ensure these risks are mitigated before proceeding.\\\"\\n\\t\\t\\t},\\n\\t\\t\\t\\\"accessory\\\": {\\n\\t\\t\\t\\t\\\"type\\\": \\\"image\\\",\\n\\t\\t\\t\\t\\\"image_url\\\": \\\"https://avatars.slack-edge.com/2024-08-29/7652078599283_52acb3a88da26e76bab6_132.png\\\",\\n\\t\\t\\t\\t\\\"alt_text\\\": \\\"Team Avatar\\\"\\n\\t\\t\\t}\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"divider\\\"\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"actions\\\",\\n\\t\\t\\t\\\"elements\\\": [\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"button\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": {\\n\\t\\t\\t\\t\\t\\t\\\"type\\\": \\\"plain_text\\\",\\n\\t\\t\\t\\t\\t\\t\\\"text\\\": \\\":arrow_forward: Submit for Approval\\\"\\n\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\t\\\"value\\\": \\\"submit_for_approval\\\",\\n\\t\\t\\t\\t\\t\\\"style\\\": \\\"primary\\\",\\n\\t\\t\\t\\t\\t\\\"action_id\\\": \\\"submit_for_approval\\\"\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"button\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": {\\n\\t\\t\\t\\t\\t\\t\\\"type\\\": \\\"plain_text\\\",\\n\\t\\t\\t\\t\\t\\t\\\"text\\\": \\\"View CSR Details\\\"\\n\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\t\\\"value\\\": \\\"view_csr_details\\\",\\n\\t\\t\\t\\t\\t\\\"url\\\": \\\"https://google.com\\\",\\n\\t\\t\\t\\t\\t\\\"action_id\\\": \\\"view_csr_details\\\"\\n\\t\\t\\t\\t}\\n\\t\\t\\t]\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"context\\\",\\n\\t\\t\\t\\\"elements\\\": [\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"Submitted on {{ $now.toFormat('MMMM dd, yyyy') }}. The request requires manual approval. If you have any questions, contact the security team.\\\"\\n\\t\\t\\t\\t}\\n\\t\\t\\t]\\n\\t\\t}\\n\\t]\\n}\",\"channelId\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"C07MB8PGZ36\"},\"messageType\":\"block\",\"otherOptions\":{}},\"credentials\":{\"slackApi\":{\"id\":\"hkcQkp6qhtiMzBEX\",\"name\":\"certbot\"}},\"typeVersion\":2.2},{\"id\":\"480c7f12-fc3a-44d1-885f-d6618a1e0dc8\",\"name\":\"Route Message\",\"type\":\"n8n-nodes-base.switch\",\"position\":[620,1100],\"parameters\":{\"rules\":{\"values\":[{\"outputKey\":\"Request Modal\",\"conditions\":{\"options\":{\"version\":1,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"operator\":{\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $json.response.callback_id }}\",\"rightValue\":\"request-certificate\"}]},\"renameOutput\":true},{\"outputKey\":\"Submit Data\",\"conditions\":{\"options\":{\"version\":1,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"65daa75f-2e17-4ba0-8fd8-2ac2159399e3\",\"operator\":{\"name\":\"filter.operator.equals\",\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $json.response.type }}\",\"rightValue\":\"view_submission\"}]},\"renameOutput\":true},{\"outputKey\":\"Block Actions\",\"conditions\":{\"options\":{\"version\":1,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"87f6f93e-28c9-49bc-8e1e-d073d86347b4\",\"operator\":{\"name\":\"filter.operator.equals\",\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $json.response.type }}\",\"rightValue\":\"block_actions\"}]},\"renameOutput\":true}]},\"options\":{\"fallbackOutput\":\"none\"}},\"typeVersion\":3},{\"id\":\"a42115ce-f0d7-443b-947d-cb8d54c2df22\",\"name\":\"Venafi TLS Protect Cloud1\",\"type\":\"n8n-nodes-base.venafiTlsProtectCloud\",\"position\":[1500,2700],\"parameters\":{\"options\":{},\"commonName\":\"={{ $json.response.message.blocks[2].text.text.match(/\\\\*Domain:\\\\*\\\\s*<http[^|]+\\\\|([^\\\\n]+)>/)[1] }}\",\"generateCsr\":true,\"applicationId\":\"f3c15c80-7151-11ef-9a22-abeac49f7094\",\"additionalFields\":{\"organizationalUnits\":[\"={{ $json.response.message.blocks[2].text.text.match(/\\\\*Team:\\\\*\\\\s*([^\\\\n]*)/)[1] }}\"]},\"certificateIssuingTemplateId\":\"d28d82b1-714b-11ef-9026-7bb80b32867a\"},\"credentials\":{\"venafiTlsProtectCloudApi\":{\"id\":\"WU38IpfutNNkJWuo\",\"name\":\"Venafi TLS Protect Cloud account\"}},\"typeVersion\":1},{\"id\":\"69765a07-32ee-478a-a2f7-4de459fd69d9\",\"name\":\"Send Auto Generated Confirmation1\",\"type\":\"n8n-nodes-base.slack\",\"position\":[1800,2700],\"parameters\":{\"text\":\"test\",\"select\":\"channel\",\"blocksUi\":\"={\\n\\t\\\"blocks\\\": [\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"section\\\",\\n\\t\\t\\t\\\"text\\\": {\\n\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\\"text\\\": \\\"*:lock: CSR Auto-Issued Successfully!*\\\"\\n\\t\\t\\t}\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"divider\\\"\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"section\\\",\\n\\t\\t\\t\\\"text\\\": {\\n\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\\"text\\\": \\\"*Team:* {{ $('Parse Webhook').item.json.response.message.blocks[2].text.text.match(/\\\\*Team:\\\\*\\\\s*([^\\\\n]*)/)[1] }}\\\\n*Requested by:* \\\\n*Email:* {{ $('Parse Webhook').item.json.response.message.blocks[2].text.text.match(/\\\\*Requestor\\\\sEmail:\\\\*\\\\s*<mailto:([^|]+)\\\\|/)[1] }}\\\\n*Date Issued:* {{ $json.creationDate }}\\\"\\n\\t\\t\\t},\\n\\t\\t\\t\\\"accessory\\\": {\\n\\t\\t\\t\\t\\\"type\\\": \\\"image\\\",\\n\\t\\t\\t\\t\\\"image_url\\\": \\\"{{ $('Parse Webhook').item.json.response.message.blocks[2].accessory.image_url }}\\\",\\n\\t\\t\\t\\t\\\"alt_text\\\": \\\"Team Avatar\\\"\\n\\t\\t\\t}\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"context\\\",\\n\\t\\t\\t\\\"elements\\\": [\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"*CSR Details:*\\\"\\n\\t\\t\\t\\t}\\n\\t\\t\\t]\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"section\\\",\\n\\t\\t\\t\\\"fields\\\": [\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"*Common Name:* {{ $('Parse Webhook').item.json.response.message.blocks[2].text.text.match(/\\\\*Domain:\\\\*\\\\s*<http[^|]+\\\\|([^\\\\n]+)>/)[1] }}\\\"\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"*Organization:* n8n.io\\\"\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"*Issued By:* Venafi CA\\\"\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"*Validity Period:* {{ DateTime.fromISO($json.creationDate).toFormat('MMMM dd, yyyy') }} to {{ DateTime.fromISO($json.creationDate).plus({ years: 1 }).toFormat('MMMM dd, yyyy') }}\\\"\\n\\t\\t\\t\\t}\\n\\t\\t\\t]\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"divider\\\"\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"actions\\\",\\n\\t\\t\\t\\\"elements\\\": [\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"button\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": {\\n\\t\\t\\t\\t\\t\\t\\\"type\\\": \\\"plain_text\\\",\\n\\t\\t\\t\\t\\t\\t\\\"text\\\": \\\"View CSR Details\\\"\\n\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\t\\\"url\\\": \\\"https://eval-32690260.venafi.cloud/issuance/certificate-requests?id={{ $json.id }}\\\",\\n\\t\\t\\t\\t\\t\\\"style\\\": \\\"primary\\\"\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"button\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": {\\n\\t\\t\\t\\t\\t\\t\\\"type\\\": \\\"plain_text\\\",\\n\\t\\t\\t\\t\\t\\t\\\"text\\\": \\\"Revoke CSR\\\"\\n\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\t\\\"style\\\": \\\"danger\\\",\\n\\t\\t\\t\\t\\t\\\"value\\\": \\\"revoke_csr\\\"\\n\\t\\t\\t\\t}\\n\\t\\t\\t]\\n\\t\\t}\\n\\t]\\n}\",\"channelId\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"C07MB8PGZ36\"},\"messageType\":\"block\",\"otherOptions\":{}},\"credentials\":{\"slackApi\":{\"id\":\"hkcQkp6qhtiMzBEX\",\"name\":\"certbot\"}},\"typeVersion\":2.2},{\"id\":\"82b70dab-2c29-4ecd-8a26-8d7c9e8c007f\",\"name\":\"Sticky Note4\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1165.4582041476783,2400],\"parameters\":{\"color\":7,\"width\":822.2470680931556,\"height\":485.55399396506067,\"content\":\"![VirusTotal](https://img.securityinfowatch.com/files/base/cygnus/siw/image/2022/10/Venafi_logo.63459e2b03b7b.png?auto=format%2Ccompress&w=250&width=250)\\n## Manual CSR Generation via Venafi\\nContextual data from the Slack user's webhook is used to gather the needed contextual data, such as the name of the Slack team/group the user is in and their email and name if needed. Please note this section is still a proof of context and may not work exactly as expected.  \\n\\nFor automatic CSR Generation to work, ensure you have a Vsatelite deployed and active. \"},\"typeVersion\":1},{\"id\":\"1ae279b2-fc2d-4686-a640-2592cc98318e\",\"name\":\"Manual Issue Certificate\",\"type\":\"n8n-nodes-base.noOp\",\"position\":[1240,2700],\"parameters\":{},\"typeVersion\":1},{\"id\":\"ce9c2a38-ef95-467d-846b-35f3aa6b2c84\",\"name\":\"Webhook\",\"type\":\"n8n-nodes-base.webhook\",\"position\":[200,1100],\"webhookId\":\"4f86c00d-ceb4-4890-84c5-850f8e5dec05\",\"parameters\":{\"path\":\"venafiendpoint\",\"options\":{},\"httpMethod\":\"POST\",\"responseMode\":\"responseNode\"},\"typeVersion\":2},{\"id\":\"1caa5c53-7b65-4578-a7ca-0bf62d05cfb0\",\"name\":\"Respond to webhook success\",\"type\":\"n8n-nodes-base.respondToWebhook\",\"position\":[760,1280],\"parameters\":{\"options\":{},\"respondWith\":\"noData\"},\"typeVersion\":1.1}],\"pinData\":{},\"connections\":{\"OpenAI\":{\"main\":[[{\"node\":\"Send Message Request for Manual Approval\",\"type\":\"main\",\"index\":0}]]},\"Webhook\":{\"main\":[[{\"node\":\"Parse Webhook\",\"type\":\"main\",\"index\":0}]]},\"Parse Webhook\":{\"main\":[[{\"node\":\"Route Message\",\"type\":\"main\",\"index\":0}]]},\"Route Message\":{\"main\":[[{\"node\":\"Respond to Slack Webhook - Vulnerability\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Close Modal Popup\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Respond to webhook success\",\"type\":\"main\",\"index\":0}]]},\"Extract Fields\":{\"main\":[[{\"node\":\"VirusTotal HTTP Request\",\"type\":\"main\",\"index\":0}]]},\"Execute Workflow\":{\"main\":[[{\"node\":\"Merge User and Team Data\",\"type\":\"main\",\"index\":1}]]},\"Close Modal Popup\":{\"main\":[[{\"node\":\"Extract Fields\",\"type\":\"main\",\"index\":0},{\"node\":\"Get Slack User ID\",\"type\":\"main\",\"index\":0},{\"node\":\"Get Slack Team ID\",\"type\":\"main\",\"index\":0}]]},\"Get Slack Team ID\":{\"main\":[[{\"node\":\"Execute Workflow\",\"type\":\"main\",\"index\":0}]]},\"Get Slack User ID\":{\"main\":[[{\"node\":\"Translate Slack User ID to Email\",\"type\":\"main\",\"index\":0}]]},\"Auto Issue Certificate\":{\"main\":[[{\"node\":\"Venafi TLS Protect Cloud\",\"type\":\"main\",\"index\":0}]]},\"VirusTotal HTTP Request\":{\"main\":[[{\"node\":\"Summarize output to save on tokens\",\"type\":\"main\",\"index\":0}]]},\"Manual Issue Certificate\":{\"main\":[[{\"node\":\"Venafi TLS Protect Cloud1\",\"type\":\"main\",\"index\":0}]]},\"Merge User and Team Data\":{\"main\":[[{\"node\":\"Merge Requestor and VT Data\",\"type\":\"main\",\"index\":1}]]},\"Venafi TLS Protect Cloud\":{\"main\":[[{\"node\":\"Send Auto Generated Confirmation\",\"type\":\"main\",\"index\":0}]]},\"Venafi TLS Protect Cloud1\":{\"main\":[[{\"node\":\"Send Auto Generated Confirmation1\",\"type\":\"main\",\"index\":0}]]},\"Respond to webhook success\":{\"main\":[[{\"node\":\"Manual Issue Certificate\",\"type\":\"main\",\"index\":0}]]},\"Merge Requestor and VT Data\":{\"main\":[[{\"node\":\"Auto Issue Certificate Based on 0 Malicious Reports\",\"type\":\"main\",\"index\":0}]]},\"Translate Slack User ID to Email\":{\"main\":[[{\"node\":\"Merge User and Team Data\",\"type\":\"main\",\"index\":0}]]},\"Summarize output to save on tokens\":{\"main\":[[{\"node\":\"Merge Requestor and VT Data\",\"type\":\"main\",\"index\":0}]]},\"Generate Report For Manual Approval\":{\"main\":[[{\"node\":\"OpenAI\",\"type\":\"main\",\"index\":0}]]},\"Respond to Slack Webhook - Vulnerability\":{\"main\":[[{\"node\":\"Venafi Request Certificate\",\"type\":\"main\",\"index\":0}]]},\"Auto Issue Certificate Based on 0 Malicious Reports\":{\"main\":[[{\"node\":\"Auto Issue Certificate\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Generate Report For Manual Approval\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "## Enhance Security Operations with the Venafi Slack CertBot!\n\n[Venafi Presentation - Watch Video](https://www.loom.com/share/5f0df8389fc34183a13af1410b997802)\n\nOur **Venafi Slack CertBot** is strategically designed to facilitate immediate security operations directly from Slack. This tool allows end users to request Certificate Signing Requests that are automatically approved or passed to the Secops team for manual approval depending on the Virustotal analysis of the requested domain. Not only does this help centralize requests, but it helps an organization maintain the security certifications by allowing automated processes to log and analyze requests in real time.\n\n**Workflow Highlights:**\n\n  * **Interactive Modals** : Utilizes Slack modals to gather user inputs for scan configurations and report generation, providing a user-friendly interface for complex operations.\n  * **Dynamic Workflow Execution** : Integrates seamlessly with Venafi to execute CSR generation and if any issues are found, AI can generate a custom report that is then passed to a slack teams channel for manual approval with the press of a single button.\n\n\n\n**Operational Flow:**\n\n  * **Parse Webhook Data** : Captures and parses incoming data from Slack to understand user commands accurately.\n  * **Execute Actions** : Depending on the user's selection, the workflow triggers other actions within the flow like automatic Virustotal Scanning.\n  * **Respond to Slack** : Ensures that every interaction is acknowledged, maintaining a smooth user experience by managing modal popups and sending appropriate responses.\n\n\n\n**Setup Instructions:**\n\n  * Verify that Slack and Qualys API integrations are correctly configured for seamless interaction.\n  * Customize the modal interfaces to align with your organization's operational protocols and security policies.\n  * Test the workflow to ensure that it responds accurately to Slack commands and that the integration with Qualys is functioning as expected.\n\n\n\n**Need Assistance?**\n\n  * Explore Venafi's [Documentation](https://docs.venafi.com/) or get help from the [n8n Community](https://community.n8n.io) for more detailed guidance on setup and customization.\n\n\n\nDeploy this bot within your Slack environment to significantly enhance the efficiency and responsiveness of your security operations, enabling proactive management of CSR's.\n",
  "readme_html": "<!--[--><div data-v-50766329=\"\"><h2>Enhance Security Operations with the Venafi Slack CertBot!</h2>\n<p><a href=\"https://www.loom.com/share/5f0df8389fc34183a13af1410b997802\" rel=\"ugc nofollow\" target=\"_blank\">Venafi Presentation  - Watch Video</a></p>\n<p>Our <strong>Venafi Slack CertBot</strong> is strategically designed to facilitate immediate security operations directly from Slack. This tool allows end users to request Certificate Signing Requests that are automatically approved or passed to the Secops team for manual approval depending on the Virustotal analysis of the requested domain. Not only does this help centralize requests, but it helps an organization maintain the security certifications by allowing automated processes to log and analyze requests in real time.</p>\n<p><strong>Workflow Highlights:</strong></p>\n<ul>\n<li><strong>Interactive Modals</strong>: Utilizes Slack modals to gather user inputs for scan configurations and report generation, providing a user-friendly interface for complex operations.</li>\n<li><strong>Dynamic Workflow Execution</strong>: Integrates seamlessly with Venafi to execute CSR generation and if any issues are found, AI can generate a custom report that is then passed to a slack teams channel for manual approval with the press of a single button.</li>\n</ul>\n<p><strong>Operational Flow:</strong></p>\n<ul>\n<li><strong>Parse Webhook Data</strong>: Captures and parses incoming data from Slack to understand user commands accurately.</li>\n<li><strong>Execute Actions</strong>: Depending on the user's selection, the workflow triggers other actions within the flow like automatic Virustotal Scanning.</li>\n<li><strong>Respond to Slack</strong>: Ensures that every interaction is acknowledged, maintaining a smooth user experience by managing modal popups and sending appropriate responses.</li>\n</ul>\n<p><strong>Setup Instructions:</strong></p>\n<ul>\n<li>Verify that Slack and Qualys API integrations are correctly configured for seamless interaction.</li>\n<li>Customize the modal interfaces to align with your organization's operational protocols and security policies.</li>\n<li>Test the workflow to ensure that it responds accurately to Slack commands and that the integration with Qualys is functioning as expected.</li>\n</ul>\n<p><strong>Need Assistance?</strong></p>\n<ul>\n<li>Explore Venafi's <a href=\"https://docs.venafi.com/\" rel=\"ugc nofollow\" target=\"_blank\">Documentation</a> or get help from the <a href=\"https://community.n8n.io\" rel=\"ugc nofollow\" target=\"_blank\">n8n Community</a> for more detailed guidance on setup and customization.</li>\n</ul>\n<p>Deploy this bot within your Slack environment to significantly enhance the efficiency and responsiveness of your security operations, enabling proactive management of CSR's.</p>\n</div><!--]-->",
  "readme_zh": "## 使用Venafi Slack证书机器人强化安全运维！\n\n[Venafi演示视频 - 点击观看](https://www.loom.com/share/5f0df8389fc34183a13af1410b997802)\n\n我们的**Venafi Slack证书机器人**专为通过Slack即时开展安全运维而设计。该工具允许终端用户提交证书签名请求（CSR），系统将根据所申请域名的Virustotal分析结果自动审批或转交安全运维团队人工审核。这不仅实现了请求集中化管理，更能通过实时自动化记录与分析流程，助力企业持续保持安全认证合规。\n\n**核心工作流亮点：**\n\n  * **交互式弹窗**：利用Slack模态框收集用户扫描配置与报告生成参数，为复杂操作提供友好界面\n  * **动态流程执行**：无缝对接Venafi平台执行CSR生成，若发现问题，AI将生成定制报告并一键推送至Slack团队频道等待人工审批\n\n**标准化操作流程：**\n\n  * **解析Webhook数据**：精准捕获并解析Slack传入指令\n  * **执行响应动作**：根据用户选择触发Virustotal自动扫描等子流程\n  * **Slack实时反馈**：通过管理弹窗交互与发送系统响应，确保每个操作环节都有确认反馈\n\n**部署指南：**\n\n  * 确认Slack与Qualys API集成配置正确\n  * 根据企业安全策略定制模态交互界面\n  * 全面测试工作流，确保Slack指令响应准确且Qualys集成运行正常\n\n**获取支持：**\n\n  * 查阅Venafi[官方文档](https://docs.venafi.com/) \n  * 或加入[n8n社区](https://community.n8n.io)获取部署与定制化指导\n\n立即在您的Slack工作区部署该机器人，显著提升证书签名请求的主动管理能力，打造高效响应的安全运维体系。",
  "title_zh": "Venafi 云 Slack 证书机器人",
  "publish_date_zh": "最后更新于5个月前",
  "workflow_json_zh": "{\n  \"meta\": {\n    \"instanceId\": \"cb484ba7b742928a2048bf8829668bed5b5ad9787579adea888f05980292a4a7\"\n  },\n  \"nodes\": [\n    {\n      \"id\": \"1092ab50-67a0-4e50-8c10-f05f70b45f56\",\n      \"name\": \"Venafi TLS Protect Cloud\",\n      \"type\": \"n8n-nodes-base.venafiTlsProtectCloud\",\n      \"position\": [\n        2860,\n        1700\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"commonName\": \"={{ $('Parse Webhook').item.json.response.view.state.values.domain_name_block.domain_name_input.value.match(/^(\\\\*\\\\.)?([a-zA-Z0-9-]+\\\\.)+[a-zA-Z]{2,}$/g).toString() }}\",\n        \"generateCsr\": true,\n        \"applicationId\": \"f3c15c80-7151-11ef-9a22-abeac49f7094\",\n        \"additionalFields\": {\n          \"organizationalUnits\": [\n            \"={{ $json.name }}\"\n          ]\n        },\n        \"certificateIssuingTemplateId\": \"d28d82b1-714b-11ef-9026-7bb80b32867a\"\n      },\n      \"credentials\": {\n        \"venafiTlsProtectCloudApi\": {\n          \"id\": \"WU38IpfutNNkJWuo\",\n          \"name\": \"Venafi TLS Protect Cloud account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"0c1f1b92-2da4-413f-a4cc-68c816e8511c\",\n      \"name\": \"Parse Webhook\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        440,\n        1100\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"e63f9299-a19d-4ba1-93b0-59f458769fb2\",\n              \"name\": \"response\",\n              \"type\": \"object\",\n              \"value\": \"={{ $json.body.payload }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.3\n    },\n    {\n      \"id\": \"95fb1907-c9e0-4164-b0b0-c3691bb46b9a\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        108.34675483142371,\n        741.4892041682327\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 466.8168310000617,\n        \"height\": 556.7924159157113,\n        \"content\": \"![Imgur](https://i.imgur.com/iKyMV0N.png)\\n## 事件Webhook触发器\\n首个节点通过订阅事件API接收来自Slack API的所有消息。您可以通过[点击此处](https://api.slack.com/apis/connections/events-api)获取有关设置订阅事件API的更多信息。\\n\\n第二个节点将Slack中的有效载荷提取为n8n能够理解的格式对象。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"4dd8cbbe-278c-4c86-bcd7-9fb0eff619b2\",\n      \"name\": \"Sticky Note15\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        580,\n        420\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 566.0553219408072,\n        \"height\": 999.0925226187064,\n        \"content\": \"![n8n](https://i.imgur.com/lKnBNnH.png)\\n## 使用n8n高效处理Slack交互\\n\\n该工作流模块专为基于特定触发条件和规则高效管理及路由来自Slack的消息与提交内容而设计。当发生Slack交互时（例如用户通过模态窗口触发漏洞扫描或生成报告），工作流将智能地将消息路由至相应操作：\\n\\n- **动态路由**：通过条件判断区分Slack交互类型，无论是直接触发扫描命令还是生成报告请求\\n- **模态窗口管理**：根据模态窗口标题和`callback_id`区分操作类型，确保每种提交内容都能按上下文准确处理\\n- **响应优化**：完成路由后，工作流将即时处理必要响应或操作，包括关闭模态弹窗、向Slack返回确认信息或数据\\n\\n**设计目标**：该机制确保所有Slack平台内的交互都能得到快速精准处理，通过实时自动化响应与操作提升用户体验及工作流效率。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"db8aabd8-d00d-4d50-9f97-443eba7c7c90\",\n      \"name\": \"Sticky Note11\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1153.6255461332685,\n        516.1718360212528\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 396.6025898621133,\n        \"height\": 652.6603582798184,\n        \"content\": \"![Imgur](https://i.imgur.com/iKyMV0N.png)\\n## 显示模态弹窗\\n本部分会弹出一个模态窗口，后续用于将数据发送至Virustotal进行检测，并根据检测结果将数据转发至Venafi或Slack等待人工审批。\\n\\n模态窗口可自定义实现多种操作功能，且原生支持移动端！此外，若消息中包含按钮或字段输入等交互元素，消息本身也能触发相应操作。\\n\\n[点击此处](https://api.slack.com/surfaces/modals)了解更多关于模态窗口的信息。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"a86e0b86-0740-4b77-831a-52413983818e\",\n      \"name\": \"Close Modal Popup\",\n      \"type\": \"n8n-nodes-base.respondToWebhook\",\n      \"position\": [\n        960,\n        1200\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"respondWith\": \"noData\"\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"a5abc206-6b10-42bc-9196-bcedacdb3726\",\n      \"name\": \"Sticky Note8\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -580,\n        740\n      ],\n      \"parameters\": {\n        \"width\": 675.1724774900403,\n        \"height\": 972.8853473866498,\n        \"content\": \"![n8n](https://i.imgur.com/lKnBNnH.png)\\n## 使用Venafi Slack证书机器人强化安全运维！\\n\\n我们的**Venafi Slack证书机器人**专为通过Slack即时开展安全运维而设计。该工具允许终端用户提交证书签名请求（CSR），系统将根据所申请域名的Virustotal分析结果自动审批或转交安全运维团队人工审核。这不仅实现了请求集中化管理，还能通过自动化流程实时记录分析请求，助力企业持续维护安全认证体系。\\n\\n**核心工作流亮点：**\\n- **交互式弹窗**：运用Slack模态框收集用户扫描配置与报告生成参数，为复杂操作提供友好界面\\n- **动态流程执行**：无缝对接Venafi平台执行CSR生成，若发现问题，AI将生成定制报告并一键推送至Slack团队频道等待人工审批\\n\\n**标准化操作流程：**\\n- **解析Webhook数据**：精准捕获并解析Slack传入指令\\n- **执行操作**：根据用户选择触发Virustotal自动扫描等系列动作\\n- **Slack响应**：通过管理弹窗交互与发送适时响应，确保每个操作都有确认反馈\\n\\n**配置指南：**\\n1. 确保Slack与Qualys API集成配置正确\\n2. 根据企业安全策略定制模态交互界面\\n3. 全面测试工作流，验证Slack指令响应及Qualys集成效果\\n\\n**获取支持：**\\n- 查阅[Venafi官方文档](https://docs.venafi.com/)\\n- 加入[n8n社区](https://community.n8n.io)获取配置与定制支持\\n\\n立即部署此机器人至您的Slack环境，显著提升CSR主动管理效率，打造响应式安全运维体系。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"352680c7-3b77-4fc1-81eb-8b5495747d89\",\n      \"name\": \"Respond to Slack Webhook - Vulnerability\",\n      \"type\": \"n8n-nodes-base.respondToWebhook\",\n      \"position\": [\n        960,\n        1000\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"respondWith\": \"noData\"\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"7e2991c3-14ee-478c-b9b6-9dd58590dde9\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1160,\n        860\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 376.26546828439086,\n        \"height\": 113.6416448104651,\n        \"content\": \"### 🙋 别忘了你的Slack凭证！\\n幸好n8n让这变得很简单，只要你在常规Slack节点添加过凭证，通过这些下拉菜单就能轻松切换HTTP节点的配置。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"97b8942b-1ec5-437f-9c51-2188cc9a9d6f\",\n      \"name\": \"Venafi Request Certificate\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1240,\n        1000\n      ],\n      \"parameters\": {\n        \"url\": \"https://slack.com/api/views.open\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"jsonBody\": \"=  {\\n    \\\"trigger_id\\\": \\\"{{ $('Parse Webhook').item.json['response']['trigger_id'] }}\\\",\\n    \\\"external_id\\\": \\\"Idea Selector\\\",\\n    \\\"view\\\": {\\n\\t\\\"type\\\": \\\"modal\\\",\\n\\t\\\"callback_id\\\": \\\"certificate_request_modal\\\",\\n\\t\\\"title\\\": {\\n\\t\\t\\\"type\\\": \\\"plain_text\\\",\\n\\t\\t\\\"text\\\": \\\"Request New Certificate\\\"\\n\\t},\\n\\t\\\"submit\\\": {\\n\\t\\t\\\"type\\\": \\\"plain_text\\\",\\n\\t\\t\\\"text\\\": \\\"Request\\\"\\n\\t},\\n\\t\\\"close\\\": {\\n\\t\\t\\\"type\\\": \\\"plain_text\\\",\\n\\t\\t\\\"text\\\": \\\"Cancel\\\"\\n\\t},\\n\\t\\\"blocks\\\": [\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"image\\\",\\n\\t\\t\\t\\\"image_url\\\": \\\"https://img.securityinfowatch.com/files/base/cygnus/siw/image/2022/10/Venafi_logo.63459e2b03b7b.png?auto=format%2Ccompress&w=640&width=640\\\",\\n\\t\\t\\t\\\"alt_text\\\": \\\"delicious tacos\\\"\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"input\\\",\\n\\t\\t\\t\\\"block_id\\\": \\\"domain_name_block\\\",\\n\\t\\t\\t\\\"label\\\": {\\n\\t\\t\\t\\t\\\"type\\\": \\\"plain_text\\\",\\n\\t\\t\\t\\t\\\"text\\\": \\\"Domain Name\\\"\\n\\t\\t\\t},\\n\\t\\t\\t\\\"element\\\": {\\n\\t\\t\\t\\t\\\"type\\\": \\\"plain_text_input\\\",\\n\\t\\t\\t\\t\\\"action_id\\\": \\\"domain_name_input\\\",\\n\\t\\t\\t\\t\\\"placeholder\\\": {\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"plain_text\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"Enter the domain name\\\"\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"input\\\",\\n\\t\\t\\t\\\"block_id\\\": \\\"validity_period_block\\\",\\n\\t\\t\\t\\\"label\\\": {\\n\\t\\t\\t\\t\\\"type\\\": \\\"plain_text\\\",\\n\\t\\t\\t\\t\\\"text\\\": \\\"Validity Period\\\"\\n\\t\\t\\t},\\n\\t\\t\\t\\\"element\\\": {\\n\\t\\t\\t\\t\\\"type\\\": \\\"static_select\\\",\\n\\t\\t\\t\\t\\\"action_id\\\": \\\"validity_period_select\\\",\\n\\t\\t\\t\\t\\\"placeholder\\\": {\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"plain_text\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"Select a validity period\\\"\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\\"options\\\": [\\n\\t\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\t\\\"text\\\": {\\n\\t\\t\\t\\t\\t\\t\\t\\\"type\\\": \\\"plain_text\\\",\\n\\t\\t\\t\\t\\t\\t\\t\\\"text\\\": \\\"1 Year\\\"\\n\\t\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\t\\t\\\"value\\\": \\\"P1Y\\\"\\n\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\t\\\"text\\\": {\\n\\t\\t\\t\\t\\t\\t\\t\\\"type\\\": \\\"plain_text\\\",\\n\\t\\t\\t\\t\\t\\t\\t\\\"text\\\": \\\"2 Years\\\"\\n\\t\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\t\\t\\\"value\\\": \\\"P2Y\\\"\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t]\\n\\t\\t\\t}\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"input\\\",\\n\\t\\t\\t\\\"block_id\\\": \\\"optional_note_block\\\",\\n\\t\\t\\t\\\"optional\\\": true,\\n\\t\\t\\t\\\"label\\\": {\\n\\t\\t\\t\\t\\\"type\\\": \\\"plain_text\\\",\\n\\t\\t\\t\\t\\\"text\\\": \\\"Optional Note\\\"\\n\\t\\t\\t},\\n\\t\\t\\t\\\"element\\\": {\\n\\t\\t\\t\\t\\\"type\\\": \\\"plain_text_input\\\",\\n\\t\\t\\t\\t\\\"action_id\\\": \\\"optional_note_input\\\",\\n\\t\\t\\t\\t\\\"multiline\\\": true,\\n\\t\\t\\t\\t\\\"placeholder\\\": {\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"plain_text\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"Add any extra information (e.g., usage context, urgency)\\\"\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\t\\t}\\n\\t]\\n}\\n}\",\n        \"sendBody\": true,\n        \"jsonQuery\": \"{\\n  \\\"Content-type\\\": \\\"application/json\\\"\\n}\",\n        \"sendQuery\": true,\n        \"specifyBody\": \"json\",\n        \"specifyQuery\": \"json\",\n        \"authentication\": \"predefinedCredentialType\",\n        \"nodeCredentialType\": \"slackApi\"\n      },\n      \"credentials\": {\n        \"slackApi\": {\n          \"id\": \"hkcQkp6qhtiMzBEX\",\n          \"name\": \"certbot\"\n        }\n      },\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"12c50bad-8aab-4bab-8790-153d9e484762\",\n      \"name\": \"Extract Fields\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1200,\n        1460\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"39808a24-60f6-4f4b-8f4c-4c2aa3850b4f\",\n              \"name\": \"domain\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.response.view.state.values.domain_name_block.domain_name_input.value }}\"\n            },\n            {\n              \"id\": \"27c905be-18cc-434f-8af0-a08ee23a168f\",\n              \"name\": \"validity\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.response.view.state.values.validity_period_block.validity_period_select.selected_option.value }}\"\n            },\n            {\n              \"id\": \"ba1382e5-0629-4276-9858-34bcb59cc85a\",\n              \"name\": \"note\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.response.view.state.values.optional_note_block.optional_note_input.value }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"f16a97d7-639e-4ec9-b003-b4ee4fdf8666\",\n      \"name\": \"Get Slack User ID\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1200,\n        2020\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"53dfe019-d91d-4f5c-b279-f8b3fde98bf1\",\n              \"name\": \"id\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.response.user.id }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"2a6af9ae-3916-4993-b2b3-a737f54f7a37\",\n      \"name\": \"Translate Slack User ID to Email\",\n      \"type\": \"n8n-nodes-base.executeWorkflow\",\n      \"position\": [\n        1520,\n        2020\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"waitForSubWorkflow\": true\n        },\n        \"workflowId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"afeVlIVyoIF8Psu4\",\n          \"cachedResultName\": \"Slack ID to Email\"\n        }\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"19541f84-0d97-4711-80ed-d36a5d517d9b\",\n      \"name\": \"VirusTotal HTTP Request\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1440,\n        1460\n      ],\n      \"parameters\": {\n        \"\": \"\",\n        \"url\": \"=https://www.virustotal.com/api/v3/domains/{{ $json.domain }}\",\n        \"method\": \"GET\",\n        \"options\": {},\n        \"sendBody\": false,\n        \"sendQuery\": false,\n        \"curlImport\": \"\",\n        \"infoMessage\": \"\",\n        \"sendHeaders\": true,\n        \"authentication\": \"none\",\n        \"specifyHeaders\": \"keypair\",\n        \"headerParameters\": {\n          \"parameters\": [\n            {\n              \"name\": \"accept\",\n              \"value\": \"application/json\"\n            },\n            {\n              \"name\": \"X-Apikey\",\n              \"value\": \"455144dac89b783b2f5421578b9ab4072adebfc011c969ba384d1c8f0e2ce39e\"\n            }\n          ]\n        },\n        \"httpVariantWarning\": \"\",\n        \"provideSslCertificates\": false\n      },\n      \"credentials\": {\n        \"virusTotalApi\": {\n          \"id\": \"JRK1xDyMiseROCmY\",\n          \"name\": \"VirusTotal account 2\"\n        }\n      },\n      \"typeVersion\": 4.2,\n      \"extendsCredential\": \"virusTotalApi\"\n    },\n    {\n      \"id\": \"4a0e0a71-b433-479b-87b7-7200537009af\",\n      \"name\": \"Summarize output to save on tokens\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1760,\n        1460\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"2c4689a3-4b72-4240-8a0f-2fa00d33c553\",\n              \"name\": \"data.attributes.last_analysis_stats.malicious\",\n              \"type\": \"number\",\n              \"value\": \"={{ $json.data.attributes.last_analysis_stats.malicious }}\"\n            },\n            {\n              \"id\": \"59db6f41-1cf1-4feb-8120-8c50fadc5c9e\",\n              \"name\": \"data.attributes.last_analysis_stats.suspicious\",\n              \"type\": \"number\",\n              \"value\": \"={{ $json.data.attributes.last_analysis_stats.suspicious }}\"\n            },\n            {\n              \"id\": \"b55e7d39-0358-4863-8147-c5ce2b65ea96\",\n              \"name\": \"data.attributes.last_analysis_stats.undetected\",\n              \"type\": \"number\",\n              \"value\": \"={{ $json.data.attributes.last_analysis_stats.undetected }}\"\n            },\n            {\n              \"id\": \"ecd98a37-cb8b-48cd-bd3d-9c8bf777c5ca\",\n              \"name\": \"data.attributes.last_analysis_stats.harmless\",\n              \"type\": \"number\",\n              \"value\": \"={{ $json.data.attributes.last_analysis_stats.harmless }}\"\n            },\n            {\n              \"id\": \"72a776d5-70d7-4c30-b8fc-f7da382bc626\",\n              \"name\": \"data.attributes.last_analysis_stats.timeout\",\n              \"type\": \"number\",\n              \"value\": \"={{ $json.data.attributes.last_analysis_stats.timeout }}\"\n            },\n            {\n              \"id\": \"b85d8e8a-620c-4bb7-97db-d780f273deee\",\n              \"name\": \"data.attributes.reputation\",\n              \"type\": \"number\",\n              \"value\": \"={{ $json.data.attributes.reputation }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"3d641c80-8a2a-4888-9ee3-ecd82f8d0d8b\",\n      \"name\": \"Auto Issue Certificate Based on 0 Malicious Reports\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        2300,\n        1840\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"795c6ff5-ac4a-4b67-b2fe-369fba276194\",\n              \"operator\": {\n                \"type\": \"number\",\n                \"operation\": \"lte\"\n              },\n              \"leftValue\": \"={{ $json.data.attributes.last_analysis_stats.malicious }}\",\n              \"rightValue\": 0\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"3f6e9bf2-6c6c-4316-8d14-1b004122fa67\",\n      \"name\": \"Auto Issue Certificate\",\n      \"type\": \"n8n-nodes-base.noOp\",\n      \"position\": [\n        2560,\n        1700\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"fa34e736-65c4-4bc1-a391-794225a588d2\",\n      \"name\": \"Generate Report For Manual Approval\",\n      \"type\": \"n8n-nodes-base.noOp\",\n      \"position\": [\n        2540,\n        2220\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"178afe87-cdef-46f0-8166-68b661349189\",\n      \"name\": \"Get Slack Team ID\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1220,\n        2220\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"53dfe019-d91d-4f5c-b279-f8b3fde98bf1\",\n              \"name\": \"id\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.response.team.id }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"c4d89085-f7f4-4073-bfe2-cd156275710c\",\n      \"name\": \"Execute Workflow\",\n      \"type\": \"n8n-nodes-base.executeWorkflow\",\n      \"position\": [\n        1520,\n        2220\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"workflowId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"ZIl9VdWh7BiVRRBT\",\n          \"cachedResultName\": \"Slack Team ID to Name\"\n        }\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"51d85502-ea61-423b-a6c4-66ed8397d685\",\n      \"name\": \"Merge User and Team Data\",\n      \"type\": \"n8n-nodes-base.merge\",\n      \"position\": [\n        1820,\n        2140\n      ],\n      \"parameters\": {\n        \"mode\": \"combine\",\n        \"options\": {},\n        \"combineBy\": \"combineByPosition\"\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"febb1be8-7cad-46f1-a854-2ff1432216cb\",\n      \"name\": \"OpenAI\",\n      \"type\": \"@n8n/n8n-nodes-langchain.openAi\",\n      \"position\": [\n        2720,\n        2220\n      ],\n      \"parameters\": {\n        \"modelId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"gpt-4o-mini\",\n          \"cachedResultName\": \"GPT-4O-MINI\"\n        },\n        \"options\": {},\n        \"messages\": {\n          \"values\": [\n            {\n              \"content\": \"=Analyze the following VirusTotal scan results and summarize the overall risk as Low, Medium, or High based on the number of engines flagging the domain (excluding \\\"clean\\\" or \\\"unrated\\\" results). Use the following criteria for risk rating:\\n\\nLow: No significant threats detected; domain is clean.\\nMedium: Minor issues detected; may require further review.\\nHigh: Significant threats like phishing or malware; manual review recommended.\\n\\nHere are the scan results for the domain {{ $('Parse Webhook').item.json.response.view.state.values.domain_name_block.domain_name_input.value }}:\\n\\nMalicious: {{ $json.data.attributes.last_analysis_stats.malicious }}\\nSuspicious: {{ $json.data.attributes.last_analysis_stats.suspicious }}\\nUndetected: {{ $json.data.attributes.last_analysis_stats.undetected }}\\nHarmless: {{ $json.data.attributes.last_analysis_stats.harmless }}\\nTimeout: {{ $json.data.attributes.last_analysis_stats.timeout }}\\nReputation: {{ $json.data.attributes.reputation }}\\n\\nProvide an overall risk rating and suggest next steps based on your analysis. Please keep it concise. \"\n            },\n            {\n              \"role\": \"system\",\n              \"content\": \"Analyze the VirusTotal scan results and categorize the domain’s risk as Low, Medium, or High:\\n\\nIdentify Risks: Focus on results flagged as anything other than \\\"clean\\\" or \\\"unrated.\\\"\\nAssess Risk:\\nLow: No major threats flagged, domain is safe.\\nMedium: Minor issues flagged, review recommended.\\nHigh: Significant threats flagged (e.g., phishing, malware), manual review needed.\\nRecommendation:\\nLow: Auto-issue the certificate.\\nMedium/High: Recommend manual review.\"\n            }\n          ]\n        }\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"2KVzlb0XZRZkoObj\",\n          \"name\": \"angel openai auth\"\n        }\n      },\n      \"typeVersion\": 1.5\n    },\n    {\n      \"id\": \"04ffe7bb-be5d-4ce0-b17c-68276673f585\",\n      \"name\": \"Sticky Note16\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1160,\n        1680\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 833.9929589980072,\n        \"height\": 705.5291769708515,\n        \"content\": \"![n8n](https://i.imgur.com/qXWqiOd.png)\\n## 将工作流作为函数嵌套运行\\n\\n该工作流部分包含2个子工作流：一个将Slack用户ID转换为邮箱和姓名，另一个将Slack团队ID转换为团队名称和头像，从而使Slack消息更直观。这种设计让您可以像调用代码函数一样复用这些流程。\\n\\n这些节点并行运行，因此不会覆盖各自线程生成的数据，最终通过合并节点实现数据聚合。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"a2b48f56-946b-4ae7-ade4-5b84b1a99bb9\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1160,\n        1180\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 832.2724669887743,\n        \"height\": 485.55399396506067,\n        \"content\": \"![VirusTotal](https://upload.wikimedia.org/wikipedia/commons/thumb/b/b7/VirusTotal_logo.svg/320px-VirusTotal_logo.svg.png)\\n## 使用VirusTotal进行URL分析\\n第一个节点通过订阅事件API接收来自Slack API的所有消息。您可以通过[点击此处](https://api.slack.com/apis/connections/events-api)获取有关设置订阅事件API的更多信息。\\n\\n第二个节点将Slack中的有效载荷提取为n8n能够理解的格式对象。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"c38c30f3-acb1-40e4-acc5-3fd4f6b8e643\",\n      \"name\": \"Merge Requestor and VT Data\",\n      \"type\": \"n8n-nodes-base.merge\",\n      \"position\": [\n        2100,\n        1840\n      ],\n      \"parameters\": {\n        \"mode\": \"combine\",\n        \"options\": {},\n        \"combineBy\": \"combineByPosition\"\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"2e2c6100-b82e-4cdf-a290-33c2898de652\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        2480,\n        1420\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 547.705272240834,\n        \"height\": 485.55399396506067,\n        \"content\": \"![VirusTotal](https://img.securityinfowatch.com/files/base/cygnus/siw/image/2022/10/Venafi_logo.63459e2b03b7b.png?auto=format%2Ccompress&w=250&width=250)\\n## 通过Venafi自动生成CSR\\n系统会利用Slack用户webhook中的上下文数据来收集必要信息，例如用户所在的Slack团队/群组名称，以及需要时的用户邮箱和姓名。\\n\\n要实现自动生成CSR功能，请确保您已部署并激活了Vsatelite服务。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"4c168cd6-e5d2-4d82-9fe3-3b8431db3dcd\",\n      \"name\": \"Sticky Note12\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        3040,\n        1309.0359710471785\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 367.3323860824746,\n        \"height\": 831.2760849855022,\n        \"content\": \"![Imgur](https://i.imgur.com/iKyMV0N.png)\\n## 发送上下文消息至Slack\\n本部分会弹出一个模态窗口，后续用于向TheHive发送数据。\\n\\n模态窗口可自定义以实现各类操作，且原生支持移动设备！右侧可见Slack模态窗口的截图示例。\\n\\n了解更多信息请[点击此处](https://api.slack.com/surfaces/modals)\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"08687e15-90e0-42da-95a4-ada8b7ddcd36\",\n      \"name\": \"Sticky Note17\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        2000,\n        1421.1618229241317\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 465.44793569024944,\n        \"height\": 676.0664675646049,\n        \"content\": \"![n8n](https://i.imgur.com/lKnBNnH.png)\\n## 使用n8n高效处理Slack交互\\n\\n该工作流模块专门设计用于根据特定触发条件和规则，高效管理和路由来自Slack的消息及提交内容。当发生Slack交互时——例如用户触发漏洞扫描或通过模态窗口生成报告——工作流会智能地将消息路由至相应操作：\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"7098d247-5f39-4c61-a055-d7e9d12c2a64\",\n      \"name\": \"Sticky Note6\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        2480,\n        1920\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 544.2406462166426,\n        \"height\": 546.0036529662652,\n        \"content\": \"![OpenAI](https://i.imgur.com/o89G0If.png)\\n## 使用AI模型解析响应\\n当前工作流采用OpenAI驱动其响应生成，但您可通过n8n提供的选项替换下方AI代理节点，配置您本地的AI大语言模型。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"3f2ea251-6f4e-4701-8456-d3020169f802\",\n      \"name\": \"Send Auto Generated Confirmation\",\n      \"type\": \"n8n-nodes-base.slack\",\n      \"position\": [\n        3160,\n        1700\n      ],\n      \"parameters\": {\n        \"text\": \"test\",\n        \"select\": \"channel\",\n        \"blocksUi\": \"={\\n\\t\\\"blocks\\\": [\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"section\\\",\\n\\t\\t\\t\\\"text\\\": {\\n\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\\"text\\\": \\\"*:lock: CSR Auto-Issued Successfully!*\\\"\\n\\t\\t\\t}\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"divider\\\"\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"section\\\",\\n\\t\\t\\t\\\"text\\\": {\\n\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\\"text\\\": \\\"*Team:* {{ $('Merge Requestor and VT Data').item.json.name }}\\\\n*Requested by:* <@{{ $('Parse Webhook').item.json.response.user.id }}>\\\\n*Email:* {{ $('Merge User and Team Data').item.json.email }}\\\\n*Date Issued:* {{ $json.creationDate }}\\\"\\n\\t\\t\\t},\\n\\t\\t\\t\\\"accessory\\\": {\\n\\t\\t\\t\\t\\\"type\\\": \\\"image\\\",\\n\\t\\t\\t\\t\\\"image_url\\\": \\\"{{ $('Merge User and Team Data').item.json.team.icon.image_132 }}\\\",\\n\\t\\t\\t\\t\\\"alt_text\\\": \\\"Team Avatar\\\"\\n\\t\\t\\t}\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"context\\\",\\n\\t\\t\\t\\\"elements\\\": [\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"*CSR Details:*\\\"\\n\\t\\t\\t\\t}\\n\\t\\t\\t]\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"section\\\",\\n\\t\\t\\t\\\"fields\\\": [\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"*Common Name:* {{ $('Parse Webhook').item.json.response.view.state.values.domain_name_block.domain_name_input.value }}\\\"\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"*Organization:* n8n.io\\\"\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"*Issued By:* Venafi CA\\\"\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"*Validity Period:* {{ DateTime.fromISO($json.creationDate).toFormat('MMMM dd, yyyy') }} to {{ DateTime.fromISO($json.creationDate).plus({ years: 1 }).toFormat('MMMM dd, yyyy') }}\\\"\\n\\t\\t\\t\\t}\\n\\t\\t\\t]\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"divider\\\"\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"actions\\\",\\n\\t\\t\\t\\\"elements\\\": [\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"button\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": {\\n\\t\\t\\t\\t\\t\\t\\\"type\\\": \\\"plain_text\\\",\\n\\t\\t\\t\\t\\t\\t\\\"text\\\": \\\"View CSR Details\\\"\\n\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\t\\\"url\\\": \\\"https://eval-32690260.venafi.cloud/issuance/certificate-requests?id={{ $json.id }}\\\",\\n\\t\\t\\t\\t\\t\\\"style\\\": \\\"primary\\\"\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"button\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": {\\n\\t\\t\\t\\t\\t\\t\\\"type\\\": \\\"plain_text\\\",\\n\\t\\t\\t\\t\\t\\t\\\"text\\\": \\\"Revoke CSR\\\"\\n\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\t\\\"style\\\": \\\"danger\\\",\\n\\t\\t\\t\\t\\t\\\"value\\\": \\\"revoke_csr\\\"\\n\\t\\t\\t\\t}\\n\\t\\t\\t]\\n\\t\\t}\\n\\t]\\n}\",\n        \"channelId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"C07MB8PGZ36\"\n        },\n        \"messageType\": \"block\",\n        \"otherOptions\": {}\n      },\n      \"credentials\": {\n        \"slackApi\": {\n          \"id\": \"hkcQkp6qhtiMzBEX\",\n          \"name\": \"certbot\"\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"17b7cc2e-32ff-4670-a756-bb41627dc14a\",\n      \"name\": \"Send Message Request for Manual Approval\",\n      \"type\": \"n8n-nodes-base.slack\",\n      \"position\": [\n        3160,\n        1940\n      ],\n      \"parameters\": {\n        \"text\": \"test\",\n        \"select\": \"channel\",\n        \"blocksUi\": \"={\\n\\t\\\"blocks\\\": [\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"section\\\",\\n\\t\\t\\t\\\"text\\\": {\\n\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\\"text\\\": \\\":warning: *CSR Pending Approval*\\\\n\\\\nThe Certificate Signing Request for the following domain was not auto-approved. Please review the details and press the button below to submit the request for manual approval.\\\"\\n\\t\\t\\t}\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"divider\\\"\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"section\\\",\\n\\t\\t\\t\\\"text\\\": {\\n\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\\"text\\\": \\\"*Team:* {{ $('Merge Requestor and VT Data').item.json.name }}\\\\n*Submitted by:* <@{{ $('Parse Webhook').item.json.response.user.id }}>\\\\n*Requestor Email:* {{ $('Merge Requestor and VT Data').item.json.email }}\\\\n*Date Submitted:* {{ DateTime.fromISO($json.creationDate).toFormat('MMMM dd, yyyy') }}\\\\n*Domain:* {{ $('Parse Webhook').item.json.response.view.state.values.domain_name_block.domain_name_input.value }}\\\\n\\\\n:mag: *AI Analysis*\\\\n> The AI detected the following potential issues with the CSR:\\\\n> - *VT Malicious Reports:* {{ $('Generate Report For Manual Approval').item.json.data.attributes.last_analysis_stats.malicious }}\\\\n> - *Reputation Score:* {{ $('Generate Report For Manual Approval').item.json.data.attributes.reputation }}/100\\\\n> - *Additional Notes:* {{ $json.message.content.replace(/\\\\n/g, '\\\\\\\\n').replace(/###/g, ' ').replace(/-\\\\s+\\\\*\\\\*(.*?)\\\\*\\\\*/g, '• *$1*').replace(/\\\"/g, '\\\\\\\\\\\"').replace(/\\\\*\\\\*/g, '*') }}\\\\n\\\\nPlease ensure these risks are mitigated before proceeding.\\\"\\n\\t\\t\\t},\\n\\t\\t\\t\\\"accessory\\\": {\\n\\t\\t\\t\\t\\\"type\\\": \\\"image\\\",\\n\\t\\t\\t\\t\\\"image_url\\\": \\\"https://avatars.slack-edge.com/2024-08-29/7652078599283_52acb3a88da26e76bab6_132.png\\\",\\n\\t\\t\\t\\t\\\"alt_text\\\": \\\"Team Avatar\\\"\\n\\t\\t\\t}\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"divider\\\"\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"actions\\\",\\n\\t\\t\\t\\\"elements\\\": [\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"button\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": {\\n\\t\\t\\t\\t\\t\\t\\\"type\\\": \\\"plain_text\\\",\\n\\t\\t\\t\\t\\t\\t\\\"text\\\": \\\":arrow_forward: Submit for Approval\\\"\\n\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\t\\\"value\\\": \\\"submit_for_approval\\\",\\n\\t\\t\\t\\t\\t\\\"style\\\": \\\"primary\\\",\\n\\t\\t\\t\\t\\t\\\"action_id\\\": \\\"submit_for_approval\\\"\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"button\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": {\\n\\t\\t\\t\\t\\t\\t\\\"type\\\": \\\"plain_text\\\",\\n\\t\\t\\t\\t\\t\\t\\\"text\\\": \\\"View CSR Details\\\"\\n\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\t\\\"value\\\": \\\"view_csr_details\\\",\\n\\t\\t\\t\\t\\t\\\"url\\\": \\\"https://google.com\\\",\\n\\t\\t\\t\\t\\t\\\"action_id\\\": \\\"view_csr_details\\\"\\n\\t\\t\\t\\t}\\n\\t\\t\\t]\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"context\\\",\\n\\t\\t\\t\\\"elements\\\": [\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"Submitted on {{ $now.toFormat('MMMM dd, yyyy') }}. The request requires manual approval. If you have any questions, contact the security team.\\\"\\n\\t\\t\\t\\t}\\n\\t\\t\\t]\\n\\t\\t}\\n\\t]\\n}\",\n        \"channelId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"C07MB8PGZ36\"\n        },\n        \"messageType\": \"block\",\n        \"otherOptions\": {}\n      },\n      \"credentials\": {\n        \"slackApi\": {\n          \"id\": \"hkcQkp6qhtiMzBEX\",\n          \"name\": \"certbot\"\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"480c7f12-fc3a-44d1-885f-d6618a1e0dc8\",\n      \"name\": \"Route Message\",\n      \"type\": \"n8n-nodes-base.switch\",\n      \"position\": [\n        620,\n        1100\n      ],\n      \"parameters\": {\n        \"rules\": {\n          \"values\": [\n            {\n              \"outputKey\": \"Request Modal\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 1,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"operator\": {\n                      \"type\": \"string\",\n                      \"operation\": \"equals\"\n                    },\n                    \"leftValue\": \"={{ $json.response.callback_id }}\",\n                    \"rightValue\": \"request-certificate\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            },\n            {\n              \"outputKey\": \"Submit Data\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 1,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"65daa75f-2e17-4ba0-8fd8-2ac2159399e3\",\n                    \"operator\": {\n                      \"name\": \"filter.operator.equals\",\n                      \"type\": \"string\",\n                      \"operation\": \"equals\"\n                    },\n                    \"leftValue\": \"={{ $json.response.type }}\",\n                    \"rightValue\": \"view_submission\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            },\n            {\n              \"outputKey\": \"Block Actions\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 1,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"87f6f93e-28c9-49bc-8e1e-d073d86347b4\",\n                    \"operator\": {\n                      \"name\": \"filter.operator.equals\",\n                      \"type\": \"string\",\n                      \"operation\": \"equals\"\n                    },\n                    \"leftValue\": \"={{ $json.response.type }}\",\n                    \"rightValue\": \"block_actions\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            }\n          ]\n        },\n        \"options\": {\n          \"fallbackOutput\": \"none\"\n        }\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"a42115ce-f0d7-443b-947d-cb8d54c2df22\",\n      \"name\": \"Venafi TLS Protect Cloud1\",\n      \"type\": \"n8n-nodes-base.venafiTlsProtectCloud\",\n      \"position\": [\n        1500,\n        2700\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"commonName\": \"={{ $json.response.message.blocks[2].text.text.match(/\\\\*Domain:\\\\*\\\\s*<http[^|]+\\\\|([^\\\\n]+)>/)[1] }}\",\n        \"generateCsr\": true,\n        \"applicationId\": \"f3c15c80-7151-11ef-9a22-abeac49f7094\",\n        \"additionalFields\": {\n          \"organizationalUnits\": [\n            \"={{ $json.response.message.blocks[2].text.text.match(/\\\\*Team:\\\\*\\\\s*([^\\\\n]*)/)[1] }}\"\n          ]\n        },\n        \"certificateIssuingTemplateId\": \"d28d82b1-714b-11ef-9026-7bb80b32867a\"\n      },\n      \"credentials\": {\n        \"venafiTlsProtectCloudApi\": {\n          \"id\": \"WU38IpfutNNkJWuo\",\n          \"name\": \"Venafi TLS Protect Cloud account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"69765a07-32ee-478a-a2f7-4de459fd69d9\",\n      \"name\": \"Send Auto Generated Confirmation1\",\n      \"type\": \"n8n-nodes-base.slack\",\n      \"position\": [\n        1800,\n        2700\n      ],\n      \"parameters\": {\n        \"text\": \"test\",\n        \"select\": \"channel\",\n        \"blocksUi\": \"={\\n\\t\\\"blocks\\\": [\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"section\\\",\\n\\t\\t\\t\\\"text\\\": {\\n\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\\"text\\\": \\\"*:lock: CSR Auto-Issued Successfully!*\\\"\\n\\t\\t\\t}\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"divider\\\"\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"section\\\",\\n\\t\\t\\t\\\"text\\\": {\\n\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\\"text\\\": \\\"*Team:* {{ $('Parse Webhook').item.json.response.message.blocks[2].text.text.match(/\\\\*Team:\\\\*\\\\s*([^\\\\n]*)/)[1] }}\\\\n*Requested by:* \\\\n*Email:* {{ $('Parse Webhook').item.json.response.message.blocks[2].text.text.match(/\\\\*Requestor\\\\sEmail:\\\\*\\\\s*<mailto:([^|]+)\\\\|/)[1] }}\\\\n*Date Issued:* {{ $json.creationDate }}\\\"\\n\\t\\t\\t},\\n\\t\\t\\t\\\"accessory\\\": {\\n\\t\\t\\t\\t\\\"type\\\": \\\"image\\\",\\n\\t\\t\\t\\t\\\"image_url\\\": \\\"{{ $('Parse Webhook').item.json.response.message.blocks[2].accessory.image_url }}\\\",\\n\\t\\t\\t\\t\\\"alt_text\\\": \\\"Team Avatar\\\"\\n\\t\\t\\t}\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"context\\\",\\n\\t\\t\\t\\\"elements\\\": [\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"*CSR Details:*\\\"\\n\\t\\t\\t\\t}\\n\\t\\t\\t]\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"section\\\",\\n\\t\\t\\t\\\"fields\\\": [\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"*Common Name:* {{ $('Parse Webhook').item.json.response.message.blocks[2].text.text.match(/\\\\*Domain:\\\\*\\\\s*<http[^|]+\\\\|([^\\\\n]+)>/)[1] }}\\\"\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"*Organization:* n8n.io\\\"\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"*Issued By:* Venafi CA\\\"\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"mrkdwn\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"*Validity Period:* {{ DateTime.fromISO($json.creationDate).toFormat('MMMM dd, yyyy') }} to {{ DateTime.fromISO($json.creationDate).plus({ years: 1 }).toFormat('MMMM dd, yyyy') }}\\\"\\n\\t\\t\\t\\t}\\n\\t\\t\\t]\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"divider\\\"\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\t\\\"type\\\": \\\"actions\\\",\\n\\t\\t\\t\\\"elements\\\": [\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"button\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": {\\n\\t\\t\\t\\t\\t\\t\\\"type\\\": \\\"plain_text\\\",\\n\\t\\t\\t\\t\\t\\t\\\"text\\\": \\\"View CSR Details\\\"\\n\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\t\\\"url\\\": \\\"https://eval-32690260.venafi.cloud/issuance/certificate-requests?id={{ $json.id }}\\\",\\n\\t\\t\\t\\t\\t\\\"style\\\": \\\"primary\\\"\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"button\\\",\\n\\t\\t\\t\\t\\t\\\"text\\\": {\\n\\t\\t\\t\\t\\t\\t\\\"type\\\": \\\"plain_text\\\",\\n\\t\\t\\t\\t\\t\\t\\\"text\\\": \\\"Revoke CSR\\\"\\n\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\t\\\"style\\\": \\\"danger\\\",\\n\\t\\t\\t\\t\\t\\\"value\\\": \\\"revoke_csr\\\"\\n\\t\\t\\t\\t}\\n\\t\\t\\t]\\n\\t\\t}\\n\\t]\\n}\",\n        \"channelId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"C07MB8PGZ36\"\n        },\n        \"messageType\": \"block\",\n        \"otherOptions\": {}\n      },\n      \"credentials\": {\n        \"slackApi\": {\n          \"id\": \"hkcQkp6qhtiMzBEX\",\n          \"name\": \"certbot\"\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"82b70dab-2c29-4ecd-8a26-8d7c9e8c007f\",\n      \"name\": \"Sticky Note4\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1165.4582041476783,\n        2400\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 822.2470680931556,\n        \"height\": 485.55399396506067,\n        \"content\": \"![VirusTotal](https://img.securityinfowatch.com/files/base/cygnus/siw/image/2022/10/Venafi_logo.63459e2b03b7b.png?auto=format%2Ccompress&w=250&width=250)\\n## 通过Venafi手动生成CSR\\n系统会利用Slack用户webhook中的上下文数据来收集所需信息，例如用户所在的Slack团队/群组名称，以及必要时获取其邮箱和姓名。请注意，此部分功能仍处于概念验证阶段，实际效果可能与预期存在差异。  \\n\\n若要实现自动CSR生成功能，请确保您已部署并激活了Vsatelite服务。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"1ae279b2-fc2d-4686-a640-2592cc98318e\",\n      \"name\": \"Manual Issue Certificate\",\n      \"type\": \"n8n-nodes-base.noOp\",\n      \"position\": [\n        1240,\n        2700\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"ce9c2a38-ef95-467d-846b-35f3aa6b2c84\",\n      \"name\": \"Webhook\",\n      \"type\": \"n8n-nodes-base.webhook\",\n      \"position\": [\n        200,\n        1100\n      ],\n      \"webhookId\": \"4f86c00d-ceb4-4890-84c5-850f8e5dec05\",\n      \"parameters\": {\n        \"path\": \"venafiendpoint\",\n        \"options\": {},\n        \"httpMethod\": \"POST\",\n        \"responseMode\": \"responseNode\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"1caa5c53-7b65-4578-a7ca-0bf62d05cfb0\",\n      \"name\": \"Respond to webhook success\",\n      \"type\": \"n8n-nodes-base.respondToWebhook\",\n      \"position\": [\n        760,\n        1280\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"respondWith\": \"noData\"\n      },\n      \"typeVersion\": 1.1\n    }\n  ],\n  \"pinData\": {},\n  \"connections\": {\n    \"OpenAI\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Send Message Request for Manual Approval\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Webhook\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Parse Webhook\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Parse Webhook\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Route Message\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Route Message\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Respond to Slack Webhook - Vulnerability\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Close Modal Popup\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Respond to webhook success\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Extract Fields\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"VirusTotal HTTP Request\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Execute Workflow\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge User and Team Data\",\n            \"type\": \"main\",\n            \"index\": 1\n          }\n        ]\n      ]\n    },\n    \"Close Modal Popup\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Extract Fields\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Get Slack User ID\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Get Slack Team ID\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get Slack Team ID\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Execute Workflow\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get Slack User ID\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Translate Slack User ID to Email\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Auto Issue Certificate\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Venafi TLS Protect Cloud\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"VirusTotal HTTP Request\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Summarize output to save on tokens\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Manual Issue Certificate\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Venafi TLS Protect Cloud1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Merge User and Team Data\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge Requestor and VT Data\",\n            \"type\": \"main\",\n            \"index\": 1\n          }\n        ]\n      ]\n    },\n    \"Venafi TLS Protect Cloud\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Send Auto Generated Confirmation\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Venafi TLS Protect Cloud1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Send Auto Generated Confirmation1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Respond to webhook success\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Manual Issue Certificate\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Merge Requestor and VT Data\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Auto Issue Certificate Based on 0 Malicious Reports\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Translate Slack User ID to Email\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge User and Team Data\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Summarize output to save on tokens\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Merge Requestor and VT Data\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Generate Report For Manual Approval\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"OpenAI\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Respond to Slack Webhook - Vulnerability\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Venafi Request Certificate\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Auto Issue Certificate Based on 0 Malicious Reports\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Auto Issue Certificate\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Generate Report For Manual Approval\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}