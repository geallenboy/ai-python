{
  "title": "Monitor Authentication IPs from SaaS Alerts & Email Reports via SMTP2Go",
  "url": "https://n8n.io/workflows/3126-monitor-authentication-ips-from-saas-alerts-and-email-reports-via-smtp2go/",
  "category": "SecOps",
  "category_url": "https://n8n.io/workflows/categories/secops/?count=20",
  "author": "Benjamin Jones (SaaS Alerts)",
  "publish_date": "Last update 4 days ago",
  "content": "",
  "workflow_json": "{\"id\":\"fGq0vUaD6JoqAbDa\",\"meta\":{\"instanceId\":\"e22925d3ea42bbdc2dfe92a253c7671a357e393fc99ccbe9178245197b7f4017\"},\"name\":\"Query List of Sign-in IPs\",\"tags\":[],\"nodes\":[{\"id\":\"9d54681d-7f8b-4996-b734-96626c9134dc\",\"name\":\"GET Events - Login Successful\",\"type\":\"n8n-nodes-base.httpRequest\",\"onError\":\"continueRegularOutput\",\"position\":[-20,180],\"parameters\":{\"url\":\"=https://us-central1-the-byway-248217.cloudfunctions.net/reportApi/api/v1/reports/events?eventType=login.success&start={{ $json['Last 24 Hours'] }}&timeSort=asc&size=10000&scroll=5s\",\"options\":{},\"sendHeaders\":true,\"headerParameters\":{\"parameters\":[{\"name\":\"api_key\",\"value\":\"={{ $json.API }}\"}]}},\"typeVersion\":4.2},{\"id\":\"d789cb1c-0e8f-4389-85da-4a9b02d438d5\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-280,-220],\"parameters\":{\"color\":4,\"width\":480,\"height\":620,\"content\":\"## Query the SaaS Alerts API\\n**SaaS Alerts API Reference Guide** [Link](https://app.swaggerhub.com/apis/SaaS_Alerts/functions)\"},\"typeVersion\":1},{\"id\":\"67628c17-6520-45e9-b3af-a066b7759481\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[240,-140],\"parameters\":{\"color\":5,\"width\":680,\"height\":540,\"content\":\"## Data Processing and Deduplication\"},\"typeVersion\":1},{\"id\":\"6a64676a-b9f7-4e16-aa5a-cc554902376b\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[940,80],\"parameters\":{\"width\":340,\"height\":340,\"content\":\"## SMTP2Go API\\nAPI Documentation [Link](https://developers.smtp2go.com/docs/send-an-email)\"},\"typeVersion\":1},{\"id\":\"afefbd9f-5442-478f-b3da-3baaf7803245\",\"name\":\"Send Email Upon Completion (SMTP2Go)\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[1040,240],\"parameters\":{\"url\":\"https://api.smtp2go.com/v3/email/send\",\"method\":\"POST\",\"options\":{},\"jsonBody\":\"={\\n  \\\"sender\\\": \\\"support@managedsaasalerts.com\\\",\\n  \\\"to\\\": [\\n    \\\"{{ $('Set Date and Form Variables').first().json.Email }}\\\"\\n  ],\\n  \\\"attachments\\\": [\\n    {\\n      \\\"filename\\\": \\\"testfile.csv\\\",\\n      \\\"fileblob\\\": \\\"{{ $json.data }}\\\",\\n      \\\"mimetype\\\": \\\"application/csv\\\"\\n    }\\n  ],\\n  \\\"subject\\\": \\\"Workflow Complete\\\",\\n  \\\"text_body\\\": \\\"{{ $('Set Date and Form Variables').first().json.Name }}, attached is your IP information.\\\\n\\\\n\\\\n\\\\n\\\"\\n}\\n\",\"sendBody\":true,\"sendHeaders\":true,\"specifyBody\":\"json\",\"authentication\":\"genericCredentialType\",\"genericAuthType\":\"httpHeaderAuth\",\"headerParameters\":{\"parameters\":[{\"name\":\"Content-Type\",\"value\":\"application/json\"},{\"name\":\"accept\",\"value\":\"application/json\"}]}},\"credentials\":{\"httpHeaderAuth\":{\"id\":\"v8R6pwWX9krYGBnw\",\"name\":\"SMTP2Go\"}},\"executeOnce\":true,\"typeVersion\":4.2},{\"id\":\"04997dff-1f22-46b2-9c1c-2b6575ca7606\",\"name\":\"Remove Duplicate IPs\",\"type\":\"n8n-nodes-base.removeDuplicates\",\"onError\":\"continueRegularOutput\",\"position\":[720,20],\"parameters\":{\"compare\":\"selectedFields\",\"options\":{},\"fieldsToCompare\":\"ip\"},\"typeVersion\":2,\"alwaysOutputData\":true},{\"id\":\"bb73047a-3f43-4cf5-bc6e-706f0c76f83c\",\"name\":\"Convert CSV to Base64\",\"type\":\"n8n-nodes-base.moveBinaryData\",\"position\":[640,240],\"parameters\":{\"options\":{\"encoding\":\"base64\"},\"setAllData\":false},\"typeVersion\":1},{\"id\":\"6172642a-ec22-4fb3-9141-34afd7c7785e\",\"name\":\"Convert to CSV\",\"type\":\"n8n-nodes-base.convertToFile\",\"position\":[400,240],\"parameters\":{\"options\":{\"headerRow\":true}},\"typeVersion\":1.1},{\"id\":\"c748b13f-76c9-4552-83b9-53de9a0aa1e1\",\"name\":\"Filter IP Information\",\"type\":\"n8n-nodes-base.set\",\"position\":[500,20],\"parameters\":{\"include\":\"selected\",\"options\":{},\"assignments\":{\"assignments\":[]},\"includeFields\":\"customer.name, user.fullName,  ip, location.city, location.region, location.country, \",\"includeOtherFields\":true},\"typeVersion\":3.4},{\"id\":\"23da49b8-b3c9-421a-a6e1-750762130314\",\"name\":\"Combine all Authentication Events\",\"type\":\"n8n-nodes-base.merge\",\"position\":[300,20],\"parameters\":{\"numberInputs\":3},\"typeVersion\":3},{\"id\":\"cdb534b1-4f72-4466-8661-b4c72a60f69e\",\"name\":\"GET Events - OAuth Authentication\",\"type\":\"n8n-nodes-base.httpRequest\",\"onError\":\"continueRegularOutput\",\"position\":[-20,20],\"parameters\":{\"url\":\"=https://us-central1-the-byway-248217.cloudfunctions.net/reportApi/api/v1/reports/events?eventType=oauth.granted.permission&start={{ $json['Last 24 Hours'] }}&timeSort=asc&size=10000&scroll=5s\",\"options\":{},\"sendHeaders\":true,\"headerParameters\":{\"parameters\":[{\"name\":\"api_key\",\"value\":\"={{ $json.API }}\"}]}},\"typeVersion\":4.2},{\"id\":\"26ae2f0a-0349-4168-b6eb-48f94eb75348\",\"name\":\"GET Events - Office365 Shell WCSS\",\"type\":\"n8n-nodes-base.httpRequest\",\"onError\":\"continueRegularOutput\",\"position\":[-20,-140],\"parameters\":{\"url\":\"=https://us-central1-the-byway-248217.cloudfunctions.net/reportApi/api/v1/reports/events?eventType=ms.shell.login.success\\n&start={{ $json['Last 24 Hours'] }}&timeSort=asc&size=10000&scroll=5s\",\"options\":{},\"sendHeaders\":true,\"headerParameters\":{\"parameters\":[{\"name\":\"api_key\",\"value\":\"={{ $json.API }}\"}]}},\"typeVersion\":4.2},{\"id\":\"aae345d7-3250-4f4e-a464-164f830e8ecf\",\"name\":\"Set Date and Form Variables\",\"type\":\"n8n-nodes-base.set\",\"position\":[-240,20],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"a81fab55-cc84-4e34-96ea-66e3f13304d5\",\"name\":\"Last 24 Hours\",\"type\":\"string\",\"value\":\"={{ new Date(Date.now() - 24 * 60 * 60 * 1000).toISOString() }}\\n\"},{\"id\":\"a6da98ec-6da1-422d-a6dc-3a1d4417c285\",\"name\":\"API\",\"type\":\"string\",\"value\":\"={{ $json['What is your API key?'] }}\"},{\"id\":\"35cb5896-f667-4727-843e-ad2fb3446422\",\"name\":\"Name\",\"type\":\"string\",\"value\":\"={{ $json['What is your name?'] }}\"},{\"id\":\"f630dcbb-1b15-49b4-a287-f940e1eddae8\",\"name\":\"Email\",\"type\":\"string\",\"value\":\"={{ $json['What is your e-mail?'] }}\"}]}},\"typeVersion\":3.4},{\"id\":\"c8afb2af-4adf-4f90-afdd-31929b5d851d\",\"name\":\"Authentication Request Form\",\"type\":\"n8n-nodes-base.formTrigger\",\"position\":[-540,20],\"webhookId\":\"63923cfa-a41e-4649-922f-b83e527e8d6b\",\"parameters\":{\"options\":{\"buttonLabel\":\"Process\"},\"formTitle\":\"Request Sign-In CSV\",\"formFields\":{\"values\":[{\"fieldLabel\":\"What is your name?\",\"requiredField\":true},{\"fieldType\":\"email\",\"fieldLabel\":\"What is your e-mail?\",\"requiredField\":true},{\"fieldLabel\":\"What is your API key?\",\"requiredField\":true}]},\"formDescription\":\"This will email you a list of all Organizations, \\nAccounts, IPs and Locations.\\n\\nThis information is for the last 24 hours.\\n\\nPlease be patient, this can take some time.  \\n\\nYour list will be provided without duplicates.\"},\"typeVersion\":2.2}],\"active\":false,\"pinData\":{},\"settings\":{\"executionOrder\":\"v1\"},\"versionId\":\"a2cace5e-a6da-4953-901e-7f762c96ea77\",\"connections\":{\"Convert to CSV\":{\"main\":[[{\"node\":\"Convert CSV to Base64\",\"type\":\"main\",\"index\":0}]]},\"Remove Duplicate IPs\":{\"main\":[[{\"node\":\"Convert to CSV\",\"type\":\"main\",\"index\":0}]]},\"Convert CSV to Base64\":{\"main\":[[{\"node\":\"Send Email Upon Completion (SMTP2Go)\",\"type\":\"main\",\"index\":0}]]},\"Filter IP Information\":{\"main\":[[{\"node\":\"Remove Duplicate IPs\",\"type\":\"main\",\"index\":0}]]},\"Authentication Request Form\":{\"main\":[[{\"node\":\"Set Date and Form Variables\",\"type\":\"main\",\"index\":0}]]},\"Set Date and Form Variables\":{\"main\":[[{\"node\":\"GET Events - Login Successful\",\"type\":\"main\",\"index\":0},{\"node\":\"GET Events - OAuth Authentication\",\"type\":\"main\",\"index\":0},{\"node\":\"GET Events - Office365 Shell WCSS\",\"type\":\"main\",\"index\":0}]]},\"GET Events - Login Successful\":{\"main\":[[{\"node\":\"Combine all Authentication Events\",\"type\":\"main\",\"index\":2}]]},\"Combine all Authentication Events\":{\"main\":[[{\"node\":\"Filter IP Information\",\"type\":\"main\",\"index\":0}]]},\"GET Events - OAuth Authentication\":{\"main\":[[{\"node\":\"Combine all Authentication Events\",\"type\":\"main\",\"index\":1}]]},\"GET Events - Office365 Shell WCSS\":{\"main\":[[{\"node\":\"Combine all Authentication Events\",\"type\":\"main\",\"index\":0}]]},\"Send Email Upon Completion (SMTP2Go)\":{\"main\":[[]]}}}",
  "readme": "# Collect and Email Authentication IP Addresses from SaaS Alerts (Last 24 Hours)\n\n## Description\n\nThis n8n workflow automates the process of collecting sign-in IP addresses from SaaS Alerts over the past 24 hours and emailing the results using SMTP2Go. Designed for security teams, IT administrators, and compliance officers, this workflow helps monitor user authentication activity, detect unusual sign-ins, and respond to potential security threats in real time.\n\nBy automating data collection and email alerts, organizations can proactively track login patterns, ensure compliance with security policies, and mitigate risks associated with unauthorized access.\n\n## Use Case\n\nThis workflow is ideal for businesses and IT teams that need to:\n\n  * Monitor user authentication activity across SaaS applications.\n  * Identify login attempts from suspicious IPs.\n  * Automate security reporting and compliance tracking.\n  * Receive real-time alerts for unusual sign-in behaviors.\n\n\n\n## Pre-Conditions & Requirements\n\nBefore using this workflow, ensure you have:\n\n  * A **SaaS Alerts** account or another system that logs authentication IPs.\n  * An **SMTP2Go** account for sending email notifications.\n  * n8n set up with proper API credentials and database access (if applicable).\n\n\n\n## Setup Instructions\n\n  1. **Configure SaaS Alerts API**\n\n     * Obtain API from the SaaS Alerts Platform under the Settings menu.\n  2. **Set Up SMTP2Go for Email Alerts**\n\n     * Create an SMTP2Go account if you don’t have one.\n     * Generate a SMTP2Go API key\n     * Verify that your sending email address has been configured and verified.\n     * Define recipient email addresses for security alerts.\n  3. **Customize the Workflow**\n\n     * Modify filtering rules to track specific users, IP ranges, or flagged login attempts.\n     * Adjust email content to include relevant details for your team.\n  4. **Test & Deploy**\n\n     * Run the workflow manually to verify data retrieval and email notifications.\n     * Schedule the workflow to run daily for automated monitoring.\n\n\n\n## Workflow Steps\n\n  1. **Trigger** – Starts manually or on a scheduled interval (e.g., every 24 hours).\n  2. **Fetch Authentication Logs** – Retrieves sign-in IPs from SaaS Alerts or a custom API.\n  3. **Filter & Process Data** – Extracts relevant login attempts based on defined criteria.\n  4. **Format Data for Reporting** – Structures the data for readability in an email alert.\n  5. **Send Email Notification via SMTP2Go** – Delivers the security report to designated recipients.\n\n\n\n## Customization Options\n\n  * **Modify Filtering Rules** – Track specific login behaviors, flagged IPs, or unusual patterns.\n  * **Change Email Recipients** – Update the recipient list based on security team needs.\n  * **Integrate with Security Dashboards** – Expand the workflow to log data into a SIEM system or incident response platform.\n  * **Add Additional Triggers** – Configure alerts for specific login anomalies, such as failed login attempts.\n\n\n\n## Keywords\n\n**n8n security automation, authentication monitoring, login IP tracking, SMTP2Go email alerts, SaaS Alerts workflow, IT security automation, login anomaly detection**\n",
  "readme_html": "<!--[--><div data-v-006f9244=\"\"><h1>Collect and Email Authentication IP Addresses from SaaS Alerts (Last 24 Hours)</h1>\n<h2>Description</h2>\n<p>This n8n workflow automates the process of collecting sign-in IP addresses from SaaS Alerts over the past 24 hours and emailing the results using SMTP2Go. Designed for security teams, IT administrators, and compliance officers, this workflow helps monitor user authentication activity, detect unusual sign-ins, and respond to potential security threats in real time.</p>\n<p>By automating data collection and email alerts, organizations can proactively track login patterns, ensure compliance with security policies, and mitigate risks associated with unauthorized access.</p>\n<h2>Use Case</h2>\n<p>This workflow is ideal for businesses and IT teams that need to:</p>\n<ul>\n<li>Monitor user authentication activity across SaaS applications.</li>\n<li>Identify login attempts from suspicious IPs.</li>\n<li>Automate security reporting and compliance tracking.</li>\n<li>Receive real-time alerts for unusual sign-in behaviors.</li>\n</ul>\n<h2>Pre-Conditions &amp; Requirements</h2>\n<p>Before using this workflow, ensure you have:</p>\n<ul>\n<li>A <strong>SaaS Alerts</strong> account or another system that logs authentication IPs.</li>\n<li>An <strong>SMTP2Go</strong> account for sending email notifications.</li>\n<li>n8n set up with proper API credentials and database access (if applicable).</li>\n</ul>\n<h2>Setup Instructions</h2>\n<ol>\n<li>\n<p><strong>Configure SaaS Alerts API</strong></p>\n<ul>\n<li>Obtain API from the SaaS Alerts Platform under the Settings menu.</li>\n</ul>\n</li>\n<li>\n<p><strong>Set Up SMTP2Go for Email Alerts</strong></p>\n<ul>\n<li>Create an SMTP2Go account if you don’t have one.</li>\n<li>Generate a SMTP2Go API key</li>\n<li>Verify that your sending email address has been configured and verified.</li>\n<li>Define recipient email addresses for security alerts.</li>\n</ul>\n</li>\n<li>\n<p><strong>Customize the Workflow</strong></p>\n<ul>\n<li>Modify filtering rules to track specific users, IP ranges, or flagged login attempts.</li>\n<li>Adjust email content to include relevant details for your team.</li>\n</ul>\n</li>\n<li>\n<p><strong>Test &amp; Deploy</strong></p>\n<ul>\n<li>Run the workflow manually to verify data retrieval and email notifications.</li>\n<li>Schedule the workflow to run daily for automated monitoring.</li>\n</ul>\n</li>\n</ol>\n<h2>Workflow Steps</h2>\n<ol>\n<li><strong>Trigger</strong> – Starts manually or on a scheduled interval (e.g., every 24 hours).</li>\n<li><strong>Fetch Authentication Logs</strong> – Retrieves sign-in IPs from SaaS Alerts or a custom API.</li>\n<li><strong>Filter &amp; Process Data</strong> – Extracts relevant login attempts based on defined criteria.</li>\n<li><strong>Format Data for Reporting</strong> – Structures the data for readability in an email alert.</li>\n<li><strong>Send Email Notification via SMTP2Go</strong> – Delivers the security report to designated recipients.</li>\n</ol>\n<h2>Customization Options</h2>\n<ul>\n<li><strong>Modify Filtering Rules</strong> – Track specific login behaviors, flagged IPs, or unusual patterns.</li>\n<li><strong>Change Email Recipients</strong> – Update the recipient list based on security team needs.</li>\n<li><strong>Integrate with Security Dashboards</strong> – Expand the workflow to log data into a SIEM system or incident response platform.</li>\n<li><strong>Add Additional Triggers</strong> – Configure alerts for specific login anomalies, such as failed login attempts.</li>\n</ul>\n<h2>Keywords</h2>\n<p><strong>n8n security automation, authentication monitoring, login IP tracking, SMTP2Go email alerts, SaaS Alerts workflow, IT security automation, login anomaly detection</strong></p>\n</div><!--]-->",
  "readme_zh": "# 从SaaS Alerts收集并邮件发送认证IP地址（过去24小时）\n\n## 功能说明\n\n本n8n工作流可自动执行以下流程：从SaaS Alerts收集过去24小时的登录IP地址，并通过SMTP2Go邮件发送结果。专为安全团队、IT管理员和合规官员设计，该工作流有助于监控用户认证活动、检测异常登录行为并实时响应潜在安全威胁。\n\n通过自动化数据收集和邮件提醒，组织可主动追踪登录模式、确保符合安全策略要求，并降低未授权访问相关风险。\n\n## 适用场景\n\n本工作流特别适合以下需求的企业和IT团队：\n\n* 监控跨SaaS应用程序的用户认证活动\n* 识别可疑IP的登录尝试\n* 自动化安全报告与合规追踪\n* 接收异常登录行为的实时警报\n\n## 前置条件与要求\n\n使用前请确保具备：\n\n* **SaaS Alerts**账户或其他记录认证IP的系统\n* 用于发送邮件通知的**SMTP2Go**账户\n* 已配置API凭证和数据库访问权限的n8n环境（如适用）\n\n## 配置指南\n\n1. **配置SaaS Alerts API**\n   * 在SaaS Alerts平台设置菜单中获取API\n2. **设置SMTP2Go邮件提醒**\n   * 如无账户请先注册\n   * 生成SMTP2Go API密钥\n   * 验证发件邮箱已完成配置\n   * 设置安全警报的收件邮箱列表\n3. **自定义工作流**\n   * 修改过滤规则以追踪特定用户/IP段/标记登录尝试\n   * 调整邮件内容包含团队所需关键信息\n4. **测试与部署**\n   * 手动运行工作流验证数据获取与邮件通知\n   * 设置每日自动执行实现持续监控\n\n## 工作流步骤\n\n1. **触发器** - 手动启动或按计划间隔触发（如每24小时）\n2. **获取认证日志** - 从SaaS Alerts或自定义API检索登录IP\n3. **数据过滤处理** - 根据预设条件提取相关登录记录\n4. **格式化报告数据** - 结构化处理数据提升邮件可读性\n5. **通过SMTP2Go发送邮件** - 将安全报告递送至指定收件人\n\n## 自定义选项\n\n* **修改过滤规则** - 追踪特定登录行为/标记IP/异常模式\n* **变更收件人列表** - 根据安全团队需求调整\n* **集成安全仪表盘** - 扩展工作流将数据录入SIEM系统或事件响应平台\n* **添加额外触发器** - 配置特定登录异常（如失败尝试）的警报\n\n## 关键词\n\n**n8n安全自动化、认证监控、登录IP追踪、SMTP2Go邮件警报、SaaS Alerts工作流、IT安全自动化、登录异常检测**",
  "title_zh": "通过SMTP2Go监控SaaS警报及电子邮件报告中的认证IP",
  "publish_date_zh": "上次更新于4天前",
  "workflow_json_zh": "{\"id\": \"fGq0vUaD6JoqAbDa\", \"meta\": {\"instanceId\": \"e22925d3ea42bbdc2dfe92a253c7671a357e393fc99ccbe9178245197b7f4017\"}, \"name\": \"登录IP查询列表\", \"tags\": [], \"nodes\": [{\"id\": \"9d54681d-7f8b-4996-b734-96626c9134dc\", \"name\": \"获取事件 - 登录成功\", \"type\": \"n8n-nodes-base.httpRequest\", \"onError\": \"continueRegularOutput\", \"position\": [-20, 180], \"parameters\": {\"url\": \"https://us-central1-the-byway-248217.cloudfunctions.net/reportApi/api/v1/reports/events?eventType=login.success&start={{ $json['过去24小时'] }}&timeSort=asc&size=10000&scroll=5s\", \"options\": {}, \"sendHeaders\": true, \"headerParameters\": {\"parameters\": [{\"name\": \"api_key\", \"value\": \"={{ $json.API }}\"}]}}, \"typeVersion\": 4.2}, {\"id\": \"d789cb1c-0e8f-4389-85da-4a9b02d438d5\", \"name\": \"便利贴\", \"type\": \"n8n-nodes-base.stickyNote\", \"position\": [-280, -220], \"parameters\": {\"color\": 4, \"width\": 480, \"height\": 620, \"content\": \"## 查询SaaS警报API\\n**SaaS警报API参考指南** [链接](https://app.swaggerhub.com/apis/SaaS_Alerts/functions)\"}, \"typeVersion\": 1}, {\"id\": \"67628c17-6520-45e9-b3af-a066b7759481\", \"name\": \"便利贴1\", \"type\": \"n8n-nodes-base.stickyNote\", \"position\": [240, -140], \"parameters\": {\"color\": 5, \"width\": 680, \"height\": 540, \"content\": \"## 数据处理与去重\"}, \"typeVersion\": 1}, {\"id\": \"6a64676a-b9f7-4e16-aa5a-cc554902376b\", \"name\": \"便利贴2\", \"type\": \"n8n-nodes-base.stickyNote\", \"position\": [940, 80], \"parameters\": {\"width\": 340, \"height\": 340, \"content\": \"## SMTP2Go API\\nAPI文档 [链接](https://developers.smtp2go.com/docs/send-an-email)\"}, \"typeVersion\": 1}, {\"id\": \"afefbd9f-5442-478f-b3da-3baaf7803245\", \"name\": \"完成后发送邮件（SMTP2Go）\", \"type\": \"n8n-nodes-base.httpRequest\", \"position\": [1040, 240], \"parameters\": {\"url\": \"https://api.smtp2go.com/v3/email/send\", \"method\": \"邮政\", \"options\": {}, \"jsonBody\": \"{\\n  \\\"发件人\\\": \\\"support@managedsaasalerts.com\\\",\\n  \\\"收件人\\\": [\\n    \\\"{{ $('设置日期和表单变量').first().json.Email }}\\\"\\n  ],\\n  \\\"附件\\\": [\\n    {\\n      \\\"文件名\\\": \\\"testfile.csv\\\",\\n      \\\"文件数据\\\": \\\"{{ $json.data }}\\\",\\n      \\\"媒体类型\\\": \\\"application/csv\\\"\\n    }\\n  ],\\n  \\\"主题\\\": \\\"工作流完成\\\",\\n  \\\"正文\\\": \\\"{{ $('设置日期和表单变量').first().json.Name }}，附件是您的IP信息。\\\\n\\\\n\\\\n\\\\n\\\"\\n}\", \"sendBody\": true, \"sendHeaders\": true, \"specifyBody\": \"JSON\", \"authentication\": \"通用凭证类型\", \"genericAuthType\": \"HTTP头部认证\", \"headerParameters\": {\"parameters\": [{\"name\": \"Content-Type\", \"value\": \"application/json\"}, {\"name\": \"accept\", \"value\": \"application/json\"}]}}, \"credentials\": {\"httpHeaderAuth\": {\"id\": \"v8R6pwWX9krYGBnw\", \"name\": \"SMTP2Go\"}}, \"executeOnce\": true, \"typeVersion\": 4.2}, {\"id\": \"04997dff-1f22-46b2-9c1c-2b6575ca7606\", \"name\": \"移除重复IP地址\", \"type\": \"n8n-nodes-base.removeDuplicates\", \"onError\": \"continueRegularOutput\", \"position\": [720, 20], \"parameters\": {\"compare\": \"选定字段\", \"options\": {}, \"fieldsToCompare\": \"ip\"}, \"typeVersion\": 2, \"alwaysOutputData\": true}, {\"id\": \"bb73047a-3f43-4cf5-bc6e-706f0c76f83c\", \"name\": \"将CSV转换为Base64\", \"type\": \"n8n-nodes-base.moveBinaryData\", \"position\": [640, 240], \"parameters\": {\"options\": {\"encoding\": \"base64\"}, \"setAllData\": false}, \"typeVersion\": 1}, {\"id\": \"6172642a-ec22-4fb3-9141-34afd7c7785e\", \"name\": \"转换为CSV\", \"type\": \"n8n-nodes-base.convertToFile\", \"position\": [400, 240], \"parameters\": {\"options\": {\"headerRow\": true}}, \"typeVersion\": 1.1}, {\"id\": \"c748b13f-76c9-4552-83b9-53de9a0aa1e1\", \"name\": \"过滤IP信息\", \"type\": \"n8n-nodes-base.set\", \"position\": [500, 20], \"parameters\": {\"include\": \"精选\", \"options\": {}, \"assignments\": {\"assignments\": []}, \"includeFields\": \"客户姓名，用户全名，IP地址，所在城市，所在地区，所在国家，\", \"includeOtherFields\": true}, \"typeVersion\": 3.4}, {\"id\": \"23da49b8-b3c9-421a-a6e1-750762130314\", \"name\": \"合并所有认证事件\", \"type\": \"n8n-nodes-base.merge\", \"position\": [300, 20], \"parameters\": {\"numberInputs\": 3}, \"typeVersion\": 3}, {\"id\": \"cdb534b1-4f72-4466-8661-b4c72a60f69e\", \"name\": \"获取事件 - OAuth 认证\", \"type\": \"n8n-nodes-base.httpRequest\", \"onError\": \"continueRegularOutput\", \"position\": [-20, 20], \"parameters\": {\"url\": \"https://us-central1-the-byway-248217.cloudfunctions.net/reportApi/api/v1/reports/events?eventType=oauth.granted.permission&start={{ $json['过去24小时'] }}&timeSort=asc&size=10000&scroll=5s\", \"options\": {}, \"sendHeaders\": true, \"headerParameters\": {\"parameters\": [{\"name\": \"api_key\", \"value\": \"={{ $json.API }}\"}]}}, \"typeVersion\": 4.2}, {\"id\": \"26ae2f0a-0349-4168-b6eb-48f94eb75348\", \"name\": \"获取事件 - Office365 Shell WCSS\", \"type\": \"n8n-nodes-base.httpRequest\", \"onError\": \"continueRegularOutput\", \"position\": [-20, -140], \"parameters\": {\"url\": \"https://us-central1-the-byway-248217.cloudfunctions.net/reportApi/api/v1/reports/events?eventType=ms.shell.login.success\\n&start={{ $json['过去24小时'] }}&timeSort=asc&size=10000&scroll=5s\", \"options\": {}, \"sendHeaders\": true, \"headerParameters\": {\"parameters\": [{\"name\": \"api_key\", \"value\": \"={{ $json.API }}\"}]}}, \"typeVersion\": 4.2}, {\"id\": \"aae345d7-3250-4f4e-a464-164f830e8ecf\", \"name\": \"设置日期和表单变量\", \"type\": \"n8n-nodes-base.set\", \"position\": [-240, 20], \"parameters\": {\"options\": {}, \"assignments\": {\"assignments\": [{\"id\": \"a81fab55-cc84-4e34-96ea-66e3f13304d5\", \"name\": \"Last 24 Hours\", \"type\": \"string\", \"value\": \"={{ new Date(Date.now() - 24 * 60 * 60 * 1000).toISOString() }}\\n\"}, {\"id\": \"a6da98ec-6da1-422d-a6dc-3a1d4417c285\", \"name\": \"API\", \"type\": \"string\", \"value\": \"={{ $json['What is your API key?'] }}\"}, {\"id\": \"35cb5896-f667-4727-843e-ad2fb3446422\", \"name\": \"Name\", \"type\": \"string\", \"value\": \"={{ $json['What is your name?'] }}\"}, {\"id\": \"f630dcbb-1b15-49b4-a287-f940e1eddae8\", \"name\": \"Email\", \"type\": \"string\", \"value\": \"={{ $json['What is your e-mail?'] }}\"}]}}, \"typeVersion\": 3.4}, {\"id\": \"c8afb2af-4adf-4f90-afdd-31929b5d851d\", \"name\": \"认证申请表\", \"type\": \"n8n-nodes-base.formTrigger\", \"position\": [-540, 20], \"webhookId\": \"63923cfa-a41e-4649-922f-b83e527e8d6b\", \"parameters\": {\"options\": {\"buttonLabel\": \"Process\"}, \"formTitle\": \"请求登录CSV\", \"formFields\": {\"values\": [{\"fieldLabel\": \"What is your name?\", \"requiredField\": true}, {\"fieldType\": \"email\", \"fieldLabel\": \"What is your e-mail?\", \"requiredField\": true}, {\"fieldLabel\": \"What is your API key?\", \"requiredField\": true}]}, \"formDescription\": \"此邮件将向您发送包含所有组织、账户、IP地址及位置信息的清单。\\n\\n该信息为过去24小时内的记录。\\n\\n请耐心等待，处理可能需要一些时间。\\n\\n您收到的清单将自动剔除重复项。\"}, \"typeVersion\": 2.2}], \"active\": false, \"pinData\": {}, \"settings\": {\"executionOrder\": \"v1\"}, \"versionId\": \"a2cace5e-a6da-4953-901e-7f762c96ea77\", \"connections\": {\"Convert to CSV\": {\"main\": [[{\"node\": \"Convert CSV to Base64\", \"type\": \"main\", \"index\": 0}]]}, \"Remove Duplicate IPs\": {\"main\": [[{\"node\": \"Convert to CSV\", \"type\": \"main\", \"index\": 0}]]}, \"Convert CSV to Base64\": {\"main\": [[{\"node\": \"Send Email Upon Completion (SMTP2Go)\", \"type\": \"main\", \"index\": 0}]]}, \"Filter IP Information\": {\"main\": [[{\"node\": \"Remove Duplicate IPs\", \"type\": \"main\", \"index\": 0}]]}, \"Authentication Request Form\": {\"main\": [[{\"node\": \"Set Date and Form Variables\", \"type\": \"main\", \"index\": 0}]]}, \"Set Date and Form Variables\": {\"main\": [[{\"node\": \"GET Events - Login Successful\", \"type\": \"main\", \"index\": 0}, {\"node\": \"GET Events - OAuth Authentication\", \"type\": \"main\", \"index\": 0}, {\"node\": \"GET Events - Office365 Shell WCSS\", \"type\": \"main\", \"index\": 0}]]}, \"GET Events - Login Successful\": {\"main\": [[{\"node\": \"Combine all Authentication Events\", \"type\": \"main\", \"index\": 2}]]}, \"Combine all Authentication Events\": {\"main\": [[{\"node\": \"Filter IP Information\", \"type\": \"main\", \"index\": 0}]]}, \"GET Events - OAuth Authentication\": {\"main\": [[{\"node\": \"Combine all Authentication Events\", \"type\": \"main\", \"index\": 1}]]}, \"GET Events - Office365 Shell WCSS\": {\"main\": [[{\"node\": \"Combine all Authentication Events\", \"type\": \"main\", \"index\": 0}]]}, \"Send Email Upon Completion (SMTP2Go)\": {\"main\": [[]]}}}"
}