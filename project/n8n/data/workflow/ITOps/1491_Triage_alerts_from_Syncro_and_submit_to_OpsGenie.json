{
  "title": "Triage alerts from Syncro and submit to OpsGenie",
  "url": "https://n8n.io/workflows/1491-triage-alerts-from-syncro-and-submit-to-opsgenie/",
  "category": "ITOps",
  "category_url": "https://n8n.io/workflows/categories/it-ops/?sort=createdAt:desc",
  "author": "Jonathan",
  "publish_date": "Last update 10 months ago",
  "publish_date_absolute": "2024-07-06",
  "content": "",
  "workflow_json": "{\"id\":117,\"name\":\"Syncro Alert to OpsGenie\",\"nodes\":[{\"name\":\"Webhook\",\"type\":\"n8n-nodes-base.webhook\",\"position\":[460,380],\"webhookId\":\"fromsyncro\",\"parameters\":{\"path\":\"fromsyncro\",\"options\":{},\"httpMethod\":\"POST\",\"responseData\":\"allEntries\",\"responseMode\":\"lastNode\"},\"typeVersion\":1},{\"name\":\"Set\",\"type\":\"n8n-nodes-base.set\",\"position\":[780,380],\"parameters\":{\"values\":{\"string\":[{\"name\":\"AlertID\",\"value\":\"={{$node[\\\"Webhook\\\"].json[\\\"body\\\"][\\\"attributes\\\"][\\\"id\\\"]}}\"},{\"name\":\"Description\",\"value\":\"={{$node[\\\"Webhook\\\"].json[\\\"body\\\"][\\\"attributes\\\"][\\\"computer_name\\\"]}} ({{$node[\\\"Webhook\\\"].json[\\\"body\\\"][\\\"attributes\\\"][\\\"customer\\\"][\\\"business_then_name\\\"]}}): {{$node[\\\"Webhook\\\"].json[\\\"body\\\"][\\\"attributes\\\"][\\\"formatted_output\\\"]}}\"}]},\"options\":{},\"keepOnlySet\":true},\"typeVersion\":1},{\"name\":\"Create Alert\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[1180,260],\"parameters\":{\"url\":\"https://api.opsgenie.com/v2/alerts\",\"options\":{},\"requestMethod\":\"POST\",\"authentication\":\"headerAuth\",\"bodyParametersUi\":{\"parameter\":[{\"name\":\"message\",\"value\":\"={{$node[\\\"Webhook\\\"].json[\\\"body\\\"][\\\"attributes\\\"][\\\"computer_name\\\"]}} ({{$node[\\\"Webhook\\\"].json[\\\"body\\\"][\\\"attributes\\\"][\\\"customer\\\"][\\\"business_then_name\\\"]}}): {{$node[\\\"Webhook\\\"].json[\\\"body\\\"][\\\"attributes\\\"][\\\"formatted_output\\\"]}}\"},{\"name\":\"alias\",\"value\":\"={{$node[\\\"Webhook\\\"].json[\\\"body\\\"][\\\"attributes\\\"][\\\"id\\\"]}}\"},{\"name\":\"description\",\"value\":\"={{$node[\\\"Webhook\\\"].json[\\\"body\\\"][\\\"text\\\"]}}\\n{{$node[\\\"Webhook\\\"].json[\\\"body\\\"][\\\"link\\\"]}}\"}]}},\"credentials\":{\"httpHeaderAuth\":{\"id\":null,\"name\":\"OpsGenie\"}},\"typeVersion\":1},{\"name\":\"Close Alert\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[1180,460],\"parameters\":{\"url\":\"=https://api.opsgenie.com/v2/alerts/{{$node[\\\"Webhook\\\"].json[\\\"body\\\"][\\\"attributes\\\"][\\\"id\\\"]}}/close?identifierType=alias\",\"options\":{},\"requestMethod\":\"POST\",\"authentication\":\"headerAuth\",\"bodyParametersUi\":{\"parameter\":[{\"name\":\"note\",\"value\":\"Issue resolved automatically according to Syncro.\"}]}},\"credentials\":{\"httpHeaderAuth\":{\"id\":null,\"name\":\"OpsGenie\"}},\"typeVersion\":1},{\"name\":\"NoOp\",\"type\":\"n8n-nodes-base.noOp\",\"position\":[780,560],\"parameters\":{},\"typeVersion\":1},{\"name\":\"IF\",\"type\":\"n8n-nodes-base.if\",\"position\":[940,380],\"parameters\":{\"conditions\":{\"boolean\":[{\"value1\":\"={{$node[\\\"Webhook\\\"].json[\\\"body\\\"][\\\"attributes\\\"][\\\"resolved\\\"]}}\"}]}},\"typeVersion\":1},{\"name\":\"Switch\",\"type\":\"n8n-nodes-base.switch\",\"position\":[620,380],\"parameters\":{\"rules\":{\"rules\":[{\"value2\":\"agent_offline_trigger\"}]},\"value1\":\"={{$node[\\\"Webhook\\\"].json[\\\"body\\\"][\\\"attributes\\\"][\\\"properties\\\"][\\\"trigger\\\"]}}\",\"dataType\":\"string\"},\"typeVersion\":1}],\"active\":false,\"settings\":{},\"connections\":{\"IF\":{\"main\":[[{\"node\":\"Create Alert\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Close Alert\",\"type\":\"main\",\"index\":0}]]},\"Set\":{\"main\":[[{\"node\":\"IF\",\"type\":\"main\",\"index\":0}]]},\"Switch\":{\"main\":[[{\"node\":\"Set\",\"type\":\"main\",\"index\":0}],[{\"node\":\"NoOp\",\"type\":\"main\",\"index\":0}]]},\"Webhook\":{\"main\":[[{\"node\":\"Switch\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "This workflow will take an alert from Syncro, determine if it's an agent_offline_trigger type, then determine if it's a new alert or a close to an existing alert, and then submit it to OpsGenie. New alerts will create a new alert in OpsGenie and resolved alerts will close the alert in OpsGenie. It doesn't require any kind of Google Sheets because OpsGenie allows you to submit a unique ID (known as an alias) along with the alert, which can be referenced later when closing the alert. The trigger type can be changed to suit your needs. You will need to create an API integration in OpsGenie. In Syncro, in addition to setting up the appropriate notification to webhook, you will also need a script that closes the agent_offline_trigger alert and an automated remediation to trigger that script when the asset goes offline (the script is queued and run when the asset comes back online).\n\n> This workflow is part of an MSP collection, The original can be found here: <https://github.com/bionemesis/n8nsyncro>\n",
  "readme_html": "<!--[--><div data-v-50766329=\"\"><p>This workflow will take an alert from Syncro, determine if it's an agent_offline_trigger type, then determine if it's a new alert or a close to an existing alert, and then submit it to OpsGenie. New alerts will create a new alert in OpsGenie and resolved alerts will close the alert in OpsGenie. It doesn't require any kind of Google Sheets because OpsGenie allows you to submit a unique ID (known as an alias) along with the alert, which can be referenced later when closing the alert. The trigger type can be changed to suit your needs. You will need to create an API integration in OpsGenie. In Syncro, in addition to setting up the appropriate notification to webhook, you will also need a script that closes the agent_offline_trigger alert and an automated remediation to trigger that script when the asset goes offline (the script is queued and run when the asset comes back online).</p>\n<blockquote>\n<p>This workflow is part of an MSP collection, The original can be found here: <a href=\"https://github.com/bionemesis/n8nsyncro\" rel=\"ugc nofollow\" target=\"_blank\">https://github.com/bionemesis/n8nsyncro</a></p>\n</blockquote>\n</div><!--]-->",
  "readme_zh": "该工作流程将从Syncro接收警报，判断其是否为agent_offline_trigger类型，进而区分是新警报还是对现有警报的关闭操作，随后将其提交至OpsGenie。新警报将在OpsGenie中创建对应条目，已解决的警报则会关闭OpsGenie中的相关警报。此流程无需依赖Google表格，因为OpsGenie支持提交带有唯一标识符（称为别名）的警报，便于后续通过该别名关闭警报。触发类型可根据实际需求调整。您需要在OpsGenie中创建API集成。在Syncro平台，除配置指向webhook的适当通知外，还需准备以下两项：一个用于关闭agent_offline_trigger警报的脚本，以及当资产离线时触发该脚本的自动修复方案（脚本会在资产重新上线时加入队列并执行）。\n\n> 本工作流程隶属MSP解决方案集，原始版本参见：<https://github.com/bionemesis/n8nsyncro>",
  "title_zh": "从Syncro筛选警报并提交至OpsGenie",
  "publish_date_zh": "最后更新于10个月前",
  "workflow_json_zh": "{\"id\":117,\"name\":\"Syncro Alert to OpsGenie\",\"nodes\":[{\"name\":\"Webhook\",\"type\":\"n8n-nodes-base.webhook\",\"position\":[460,380],\"webhookId\":\"fromsyncro\",\"parameters\":{\"path\":\"fromsyncro\",\"options\":{},\"httpMethod\":\"POST\",\"responseData\":\"allEntries\",\"responseMode\":\"lastNode\"},\"typeVersion\":1},{\"name\":\"Set\",\"type\":\"n8n-nodes-base.set\",\"position\":[780,380],\"parameters\":{\"values\":{\"string\":[{\"name\":\"AlertID\",\"value\":\"={{$node[\\\"Webhook\\\"].json[\\\"body\\\"][\\\"attributes\\\"][\\\"id\\\"]}}\"},{\"name\":\"Description\",\"value\":\"={{$node[\\\"Webhook\\\"].json[\\\"body\\\"][\\\"attributes\\\"][\\\"computer_name\\\"]}} ({{$node[\\\"Webhook\\\"].json[\\\"body\\\"][\\\"attributes\\\"][\\\"customer\\\"][\\\"business_then_name\\\"]}}): {{$node[\\\"Webhook\\\"].json[\\\"body\\\"][\\\"attributes\\\"][\\\"formatted_output\\\"]}}\"}]},\"options\":{},\"keepOnlySet\":true},\"typeVersion\":1},{\"name\":\"Create Alert\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[1180,260],\"parameters\":{\"url\":\"https://api.opsgenie.com/v2/alerts\",\"options\":{},\"requestMethod\":\"POST\",\"authentication\":\"headerAuth\",\"bodyParametersUi\":{\"parameter\":[{\"name\":\"message\",\"value\":\"={{$node[\\\"Webhook\\\"].json[\\\"body\\\"][\\\"attributes\\\"][\\\"computer_name\\\"]}} ({{$node[\\\"Webhook\\\"].json[\\\"body\\\"][\\\"attributes\\\"][\\\"customer\\\"][\\\"business_then_name\\\"]}}): {{$node[\\\"Webhook\\\"].json[\\\"body\\\"][\\\"attributes\\\"][\\\"formatted_output\\\"]}}\"},{\"name\":\"alias\",\"value\":\"={{$node[\\\"Webhook\\\"].json[\\\"body\\\"][\\\"attributes\\\"][\\\"id\\\"]}}\"},{\"name\":\"description\",\"value\":\"={{$node[\\\"Webhook\\\"].json[\\\"body\\\"][\\\"text\\\"]}}\\n{{$node[\\\"Webhook\\\"].json[\\\"body\\\"][\\\"link\\\"]}}\"}]}},\"credentials\":{\"httpHeaderAuth\":{\"id\":null,\"name\":\"OpsGenie\"}},\"typeVersion\":1},{\"name\":\"Close Alert\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[1180,460],\"parameters\":{\"url\":\"=https://api.opsgenie.com/v2/alerts/{{$node[\\\"Webhook\\\"].json[\\\"body\\\"][\\\"attributes\\\"][\\\"id\\\"]}}/close?identifierType=alias\",\"options\":{},\"requestMethod\":\"POST\",\"authentication\":\"headerAuth\",\"bodyParametersUi\":{\"parameter\":[{\"name\":\"note\",\"value\":\"Issue resolved automatically according to Syncro.\"}]}},\"credentials\":{\"httpHeaderAuth\":{\"id\":null,\"name\":\"OpsGenie\"}},\"typeVersion\":1},{\"name\":\"NoOp\",\"type\":\"n8n-nodes-base.noOp\",\"position\":[780,560],\"parameters\":{},\"typeVersion\":1},{\"name\":\"IF\",\"type\":\"n8n-nodes-base.if\",\"position\":[940,380],\"parameters\":{\"conditions\":{\"boolean\":[{\"value1\":\"={{$node[\\\"Webhook\\\"].json[\\\"body\\\"][\\\"attributes\\\"][\\\"resolved\\\"]}}\"}]}},\"typeVersion\":1},{\"name\":\"Switch\",\"type\":\"n8n-nodes-base.switch\",\"position\":[620,380],\"parameters\":{\"rules\":{\"rules\":[{\"value2\":\"agent_offline_trigger\"}]},\"value1\":\"={{$node[\\\"Webhook\\\"].json[\\\"body\\\"][\\\"attributes\\\"][\\\"properties\\\"][\\\"trigger\\\"]}}\",\"dataType\":\"string\"},\"typeVersion\":1}],\"active\":false,\"settings\":{},\"connections\":{\"IF\":{\"main\":[[{\"node\":\"Create Alert\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Close Alert\",\"type\":\"main\",\"index\":0}]]},\"Set\":{\"main\":[[{\"node\":\"IF\",\"type\":\"main\",\"index\":0}]]},\"Switch\":{\"main\":[[{\"node\":\"Set\",\"type\":\"main\",\"index\":0}],[{\"node\":\"NoOp\",\"type\":\"main\",\"index\":0}]]},\"Webhook\":{\"main\":[[{\"node\":\"Switch\",\"type\":\"main\",\"index\":0}]]}}}"
}