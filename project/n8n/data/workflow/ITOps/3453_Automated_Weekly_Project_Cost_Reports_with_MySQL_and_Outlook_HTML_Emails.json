{
  "title": "Automated Weekly Project Cost Reports with MySQL and Outlook HTML Emails",
  "url": "https://n8n.io/workflows/3453-automated-weekly-project-cost-reports-with-mysql-and-outlook-html-emails/",
  "category": "ITOps",
  "category_url": "https://n8n.io/workflows/categories/it-ops/?sort=createdAt:desc",
  "author": "Amjid Ali",
  "publish_date": "Last update 8 days ago",
  "publish_date_absolute": "",
  "content": "",
  "workflow_json": "{\"meta\":{\"instanceId\":\"4359279a248a64f23ddf72d3bc2de4dead8a687e643e9296f8a007dd65120396\"},\"nodes\":[{\"id\":\"59b786fe-8e45-4616-aa45-9748df144c3a\",\"name\":\"MySQL\",\"type\":\"n8n-nodes-base.mySql\",\"position\":[-80,220],\"parameters\":{\"query\":\"SELECT \\n    company,\\n    cost_center AS default_cost_center,\\n    COUNT(*) AS project_count\\nFROM \\n    tabProject\\nWHERE \\n    status = 'Open' \\n    AND project_type = 'External'\\n    AND is_active = 'Yes'\\n    AND budgeted_project_cost = 0\\n    \\nGROUP BY \\n    company, cost_center\\nORDER BY \\n    company, project_count DESC;\\n\",\"options\":{},\"operation\":\"executeQuery\"},\"typeVersion\":2.4},{\"id\":\"48c20822-9f2e-4108-8bfb-b300689a9724\",\"name\":\"Schedule Trigger\",\"type\":\"n8n-nodes-base.scheduleTrigger\",\"position\":[-360,220],\"parameters\":{\"rule\":{\"interval\":[{\"field\":\"weeks\",\"triggerAtHour\":8}]}},\"typeVersion\":1.2},{\"id\":\"3757860b-b7a0-4617-a398-37ac42f1acea\",\"name\":\"Switch\",\"type\":\"n8n-nodes-base.switch\",\"position\":[180,200],\"parameters\":{\"rules\":{\"values\":[{\"outputKey\":\"A\",\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"423062ba-e116-4e22-aa00-29107e8c24ce\",\"operator\":{\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $json.default_cost_center }}\",\"rightValue\":\"Cost Center A\"}]},\"renameOutput\":true},{\"outputKey\":\"B\",\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"e065ab84-61fd-4e6c-8835-92d08be3e359\",\"operator\":{\"name\":\"filter.operator.equals\",\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $json.default_cost_center }}\",\"rightValue\":\"Cost Center B\"}]},\"renameOutput\":true},{\"outputKey\":\"C\",\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"0ef8ce35-2507-4ff4-8dea-11380262098e\",\"operator\":{\"name\":\"filter.operator.equals\",\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $json.default_cost_center }}\",\"rightValue\":\"=COST CENTER C\"}]},\"renameOutput\":true},{\"outputKey\":\"D\",\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"9152e548-cca9-441c-b4b6-8903f449dc2b\",\"operator\":{\"name\":\"filter.operator.equals\",\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $json.default_cost_center }}\",\"rightValue\":\"Cost Center D\"}]},\"renameOutput\":true}]},\"options\":{}},\"typeVersion\":3.2},{\"id\":\"bf8fd5f4-e107-44e8-af1a-be32596d664e\",\"name\":\"Microsoft Outlook6\",\"type\":\"n8n-nodes-base.microsoftOutlook\",\"position\":[560,-20],\"webhookId\":\"dce42873-919a-4dac-9f9d-792b0a39b7f7\",\"parameters\":{\"subject\":\"Project Cost Missing\",\"bodyContent\":\"==<!DOCTYPE html>\\n<html lang=\\\"en\\\">\\n<head>\\n  <meta charset=\\\"UTF-8\\\">\\n  <title>Missing Budgeted Cost Notification</title>\\n  <style>\\n    body { font-family: Arial, sans-serif; background-color: #f4f4f4; margin: 0; padding: 0; }\\n    .email-container { max-width: 600px; margin: 20px auto; background-color: #ffffff; border-radius: 8px; overflow: hidden; }\\n    .email-header { background-color: #007BFF; color: #ffffff; padding: 20px; text-align: center; font-size: 18px; font-weight: bold; }\\n    .email-body { padding: 20px; font-size: 16px; color: #333333; }\\n    .email-body strong { color: #007BFF; }\\n    .email-footer { padding: 10px 20px; font-size: 14px; color: #555555; text-align: left; }\\n  </style>\\n</head>\\n<body>\\n  <div class=\\\"email-container\\\">\\n    <div class=\\\"email-header\\\">\\n      {{ $json.default_cost_center }} - Project Data Missing\\n    </div>\\n    <div class=\\\"email-body\\\">\\n      Dear {{ $json.default_cost_center }} Team,<br><br>\\n      There are <strong>{{ $json.project_count }}</strong> active projects with missing <strong>Budgeted Cost</strong>.<br>\\n      Kindly coordinate with the <strong>Accounts Team</strong> to update the missing values for accurate tracking.<br><br>\\n      Your timely attention is appreciated.<br><br>\\n      Regards,\\n    </div>\\n    <div class=\\\"email-footer\\\">\\n      <strong>Amjid Ali</strong><br>\\n      Automation Demo – n8n\\n    </div>\\n  </div>\\n</body>\\n</html>\\n\",\"toRecipients\":\"amjid@amjidali.com\",\"additionalFields\":{\"bodyContentType\":\"html\"}},\"typeVersion\":2},{\"id\":\"e4ffe557-0862-401e-9f65-7195a72db1d9\",\"name\":\"Microsoft Outlook1\",\"type\":\"n8n-nodes-base.microsoftOutlook\",\"position\":[560,160],\"webhookId\":\"ea8b2720-cbb6-4712-b9ff-4b443958d0d0\",\"parameters\":{\"subject\":\"Projects Cost Missing\",\"bodyContent\":\"==<!DOCTYPE html>\\n<html lang=\\\"en\\\">\\n<head>\\n  <meta charset=\\\"UTF-8\\\">\\n  <title>Missing Budgeted Cost Notification</title>\\n  <style>\\n    body { font-family: Arial, sans-serif; background-color: #f4f4f4; margin: 0; padding: 0; }\\n    .email-container { max-width: 600px; margin: 20px auto; background-color: #ffffff; border-radius: 8px; overflow: hidden; }\\n    .email-header { background-color: #007BFF; color: #ffffff; padding: 20px; text-align: center; font-size: 18px; font-weight: bold; }\\n    .email-body { padding: 20px; font-size: 16px; color: #333333; }\\n    .email-body strong { color: #007BFF; }\\n    .email-footer { padding: 10px 20px; font-size: 14px; color: #555555; text-align: left; }\\n  </style>\\n</head>\\n<body>\\n  <div class=\\\"email-container\\\">\\n    <div class=\\\"email-header\\\">\\n      {{ $json.default_cost_center }} - Project Data Missing\\n    </div>\\n    <div class=\\\"email-body\\\">\\n      Dear {{ $json.default_cost_center }} Team,<br><br>\\n      There are <strong>{{ $json.project_count }}</strong> active projects with missing <strong>Budgeted Cost</strong>.<br>\\n      Kindly coordinate with the <strong>Accounts Team</strong> to update the missing values for accurate tracking.<br><br>\\n      Your timely attention is appreciated.<br><br>\\n      Regards,\\n    </div>\\n    <div class=\\\"email-footer\\\">\\n      <strong>Amjid Ali</strong><br>\\n      Automation Demo – n8n\\n    </div>\\n  </div>\\n</body>\\n</html>\\n\",\"toRecipients\":\"amjid@amjidali.com\",\"additionalFields\":{\"bodyContentType\":\"html\"}},\"typeVersion\":2},{\"id\":\"e0722ebd-1e05-4efe-a27a-e4db193dec80\",\"name\":\"Microsoft Outlook7\",\"type\":\"n8n-nodes-base.microsoftOutlook\",\"position\":[560,380],\"webhookId\":\"46e6a678-d922-4dfc-b51d-864477e6b01e\",\"parameters\":{\"subject\":\"Projects Cost Missing\",\"bodyContent\":\"==<!DOCTYPE html>\\n<html lang=\\\"en\\\">\\n<head>\\n  <meta charset=\\\"UTF-8\\\">\\n  <title>Missing Budgeted Cost Notification</title>\\n  <style>\\n    body { font-family: Arial, sans-serif; background-color: #f4f4f4; margin: 0; padding: 0; }\\n    .email-container { max-width: 600px; margin: 20px auto; background-color: #ffffff; border-radius: 8px; overflow: hidden; }\\n    .email-header { background-color: #007BFF; color: #ffffff; padding: 20px; text-align: center; font-size: 18px; font-weight: bold; }\\n    .email-body { padding: 20px; font-size: 16px; color: #333333; }\\n    .email-body strong { color: #007BFF; }\\n    .email-footer { padding: 10px 20px; font-size: 14px; color: #555555; text-align: left; }\\n  </style>\\n</head>\\n<body>\\n  <div class=\\\"email-container\\\">\\n    <div class=\\\"email-header\\\">\\n      {{ $json.default_cost_center }} - Project Data Missing\\n    </div>\\n    <div class=\\\"email-body\\\">\\n      Dear {{ $json.default_cost_center }} Team,<br><br>\\n      There are <strong>{{ $json.project_count }}</strong> active projects with missing <strong>Budgeted Cost</strong>.<br>\\n      Kindly coordinate with the <strong>Accounts Team</strong> to update the missing values for accurate tracking.<br><br>\\n      Your timely attention is appreciated.<br><br>\\n      Regards,\\n    </div>\\n    <div class=\\\"email-footer\\\">\\n      <strong>Amjid Ali</strong><br>\\n      Automation Demo – n8n\\n    </div>\\n  </div>\\n</body>\\n</html>\\n\",\"toRecipients\":\"amjid@amjidali.com\",\"additionalFields\":{\"bodyContentType\":\"html\"}},\"typeVersion\":2}],\"pinData\":{},\"connections\":{\"MySQL\":{\"main\":[[{\"node\":\"Switch\",\"type\":\"main\",\"index\":0}]]},\"Switch\":{\"main\":[[{\"node\":\"Microsoft Outlook6\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Microsoft Outlook1\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Microsoft Outlook7\",\"type\":\"main\",\"index\":0}],[]]},\"Schedule Trigger\":{\"main\":[[{\"node\":\"MySQL\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "## Automated Weekly Project Cost Reports with MySQL and Outlook HTML Emails\n\n## 🧠 Use Case\n\nNeed to keep your finance or operations team updated on missing project costs?  \nThis practical **automated report workflow** does the job without AI — and saves hours weekly.\n\n  * Runs on a **weekly schedule**\n  * Queries your **MySQL** database for projects missing cost data\n  * Filters by `budgeted_project_cost IS NULL`\n  * Generates a clean **HTML email report**\n  * Sends it through **Microsoft Outlook** to relevant teams\n\n\n\n## 🚀 How It Works\n\n  1. **Schedule Trigger** – Runs every Monday at 8 AM\n  2. **MySQL Node** – Connects and runs SQL to fetch project data missing `budgeted_project_cost`\n  3. **Switch Node** – Routes logic based on `cost_center` (e.g., Retail, Service, Projects)\n  4. **Outlook Nodes** – Sends formatted HTML emails; each node handles a specific group\n  5. **Dynamic Content** – Inject values using mustache tags like `{{ $json.project_name }}`\n\n\n\n## 🔧 Setup Instructions\n\n  1. **MySQL Setup** :\n\n    * Ensure the MySQL node is connected using a valid credential set: \n      * Hostname/IP\n      * Port (default: 3306)\n      * Database name\n      * Username with SELECT permissions\n      * Password\n    * Query Example:\n        \n                SELECT project_name, cost_center FROM tabProject \n        WHERE status = 'Open' AND project_type = 'External' AND budgeted_project_cost IS NULL;\n        \n\n  2. **Outlook Configuration** :\n\n    * Connect your Microsoft Outlook node using OAuth2 credentials.\n    * Rename each Outlook node clearly (e.g., `Send Email - Retail`, `Send Email - Service`).\n  3. **Switch Node** :\n\n    * Modify cost center values as needed to match your organization (e.g., `'Retail'`, `'Service'`, `'Projects'`).\n  4. **HTML Email Formatting** :\n\n    * Customize the HTML message body using inline styles and mustache syntax.\n    * Sample:\n        \n                &lt;h3&gt;Missing Budgeted Cost Report&lt;/h3&gt;\n        &lt;ul&gt;\n          &lt;li&gt;Project: {{ $json.project_name }}&lt;/li&gt;\n          &lt;li&gt;Cost Center: {{ $json.cost_center }}&lt;/li&gt;\n        &lt;/ul&gt;\n        \n\n  5. **Recipients** :\n\n    * Replace `amjid@amjidali.com` with the actual email addresses of the concerned teams.\n\n\n\n## 📘 Read More\n\n👉 [Why Simple Workflows Work](https://syncbricks.com/why-simple-n8n-workflows-often-deliver-more-value-than-complex-ones/)\n\n## 📺 Demo & Tutorial\n\n🎥 Watch the video walkthrough:  \n<https://youtube.com/@syncbricks>\n\n* * *\n\n## 👤 About the Creator\n\n**Amjid Ali**  \n🌐 [amjidali.com](https://amjidali.com)  \n📘 [n8n Book](https://lms.syncbricks.com/books/n8n/)  \n🎓 [Learn n8n](https://www.udemy.com/course/mastering-n8n-ai-agents-api-automation-webhooks-no-code/?referralCode=0309FD70BE2D72630C09)\n\n> “Start simple, scale smart. Even basic workflows like this can save your team hours!” — _Amjid Ali_\n",
  "readme_html": "<!--[--><div data-v-859c7806=\"\"><h2>Automated Weekly Project Cost Reports with MySQL and Outlook HTML Emails</h2>\n<h2>🧠 Use Case</h2>\n<p>Need to keep your finance or operations team updated on missing project costs?<br>\nThis practical <strong>automated report workflow</strong> does the job without AI — and saves hours weekly.</p>\n<ul>\n<li>Runs on a <strong>weekly schedule</strong></li>\n<li>Queries your <strong>MySQL</strong> database for projects missing cost data</li>\n<li>Filters by <code>budgeted_project_cost IS NULL</code></li>\n<li>Generates a clean <strong>HTML email report</strong></li>\n<li>Sends it through <strong>Microsoft Outlook</strong> to relevant teams</li>\n</ul>\n<h2>🚀 How It Works</h2>\n<ol>\n<li><strong>Schedule Trigger</strong> – Runs every Monday at 8 AM</li>\n<li><strong>MySQL Node</strong> – Connects and runs SQL to fetch project data missing <code>budgeted_project_cost</code></li>\n<li><strong>Switch Node</strong> – Routes logic based on <code>cost_center</code> (e.g., Retail, Service, Projects)</li>\n<li><strong>Outlook Nodes</strong> – Sends formatted HTML emails; each node handles a specific group</li>\n<li><strong>Dynamic Content</strong> – Inject values using mustache tags like <code>{{ $json.project_name }}</code></li>\n</ol>\n<h2>🔧 Setup Instructions</h2>\n<ol>\n<li>\n<p><strong>MySQL Setup</strong>:</p>\n<ul>\n<li>Ensure the MySQL node is connected using a valid credential set:\n<ul>\n<li>Hostname/IP</li>\n<li>Port (default: 3306)</li>\n<li>Database name</li>\n<li>Username with SELECT permissions</li>\n<li>Password</li>\n</ul>\n</li>\n<li>Query Example:<pre><code>SELECT project_name, cost_center FROM tabProject \nWHERE status = 'Open' AND project_type = 'External' AND budgeted_project_cost IS NULL;\n</code></pre>\n</li>\n</ul>\n</li>\n<li>\n<p><strong>Outlook Configuration</strong>:</p>\n<ul>\n<li>Connect your Microsoft Outlook node using OAuth2 credentials.</li>\n<li>Rename each Outlook node clearly (e.g., <code>Send Email - Retail</code>, <code>Send Email - Service</code>).</li>\n</ul>\n</li>\n<li>\n<p><strong>Switch Node</strong>:</p>\n<ul>\n<li>Modify cost center values as needed to match your organization (e.g., <code>'Retail'</code>, <code>'Service'</code>, <code>'Projects'</code>).</li>\n</ul>\n</li>\n<li>\n<p><strong>HTML Email Formatting</strong>:</p>\n<ul>\n<li>Customize the HTML message body using inline styles and mustache syntax.</li>\n<li>Sample:<pre><code>&amp;lt;h3&amp;gt;Missing Budgeted Cost Report&amp;lt;/h3&amp;gt;\n&amp;lt;ul&amp;gt;\n  &amp;lt;li&amp;gt;Project: {{ $json.project_name }}&amp;lt;/li&amp;gt;\n  &amp;lt;li&amp;gt;Cost Center: {{ $json.cost_center }}&amp;lt;/li&amp;gt;\n&amp;lt;/ul&amp;gt;\n</code></pre>\n</li>\n</ul>\n</li>\n<li>\n<p><strong>Recipients</strong>:</p>\n<ul>\n<li>Replace <code>amjid@amjidali.com</code> with the actual email addresses of the concerned teams.</li>\n</ul>\n</li>\n</ol>\n<h2>📘 Read More</h2>\n<p>👉 <a href=\"https://syncbricks.com/why-simple-n8n-workflows-often-deliver-more-value-than-complex-ones/\" rel=\"ugc nofollow\" target=\"_blank\">Why Simple Workflows Work</a></p>\n<h2>📺 Demo &amp; Tutorial</h2>\n<p>🎥 Watch the video walkthrough:<br>\n<a href=\"https://youtube.com/@syncbricks\" rel=\"ugc nofollow\" target=\"_blank\">https://youtube.com/@syncbricks</a></p>\n<hr>\n<h2>👤 About the Creator</h2>\n<p><strong>Amjid Ali</strong><br>\n🌐 <a href=\"https://amjidali.com\" rel=\"ugc nofollow\" target=\"_blank\">amjidali.com</a><br>\n📘 <a href=\"https://lms.syncbricks.com/books/n8n/\" rel=\"ugc nofollow\" target=\"_blank\">n8n Book</a><br>\n🎓 <a href=\"https://www.udemy.com/course/mastering-n8n-ai-agents-api-automation-webhooks-no-code/?referralCode=0309FD70BE2D72630C09\" rel=\"ugc nofollow\" target=\"_blank\">Learn n8n</a></p>\n<blockquote>\n<p>“Start simple, scale smart. Even basic workflows like this can save your team hours!” — <em>Amjid Ali</em></p>\n</blockquote>\n</div><!--]-->"
}