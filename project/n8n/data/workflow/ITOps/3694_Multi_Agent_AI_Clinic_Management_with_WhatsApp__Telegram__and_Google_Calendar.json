{
  "title": "Multi-Agent AI Clinic Management with WhatsApp, Telegram, and Google Calendar",
  "url": "https://n8n.io/workflows/3694-multi-agent-ai-clinic-management-with-whatsapp-telegram-and-google-calendar/",
  "category": "ITOps",
  "category_url": "https://n8n.io/workflows/categories/it-ops/?sort=createdAt:desc",
  "author": "Luciano Gutierrez",
  "publish_date": "Last update 9 days ago",
  "publish_date_absolute": "2025-04-27",
  "content": "",
  "workflow_json": "{\"id\":\"6LeAm5UyENgTdwkv\",\"meta\":{\"instanceId\":\"6d46e25379ef430a7067964d1096b885c773564549240cb3ad4c087f6cf94bd3\",\"templateCredsSetupCompleted\":true},\"name\":\"agente\",\"tags\":[],\"nodes\":[{\"id\":\"84ce6905-4416-4721-8627-f8c303730a4f\",\"name\":\"OpenAI Chat Model1\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\"position\":[8260,2260],\"parameters\":{\"model\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"gpt-4.1-nano-2025-04-14\",\"cachedResultName\":\"gpt-4.1-nano-2025-04-14\"},\"options\":{}},\"credentials\":{\"openAiApi\":{\"id\":\"zUnIUrOWA279vAoC\",\"name\":\"OpenAi account\"}},\"typeVersion\":1.2},{\"id\":\"a6e9358a-a873-49f3-af38-21ca545b2bfc\",\"name\":\"Assistente clinica interno\",\"type\":\"@n8n/n8n-nodes-langchain.agent\",\"position\":[8380,2020],\"parameters\":{\"text\":\"={{ $json.message.text }}\",\"options\":{\"systemMessage\":\"=Hoje Ã© {{$now}}\\nPAPEL:  \\nVocÃª Ã© um assistente interno de reagendamento na clÃ­nica, acionado diretamente por um profissional via Telegram para gerenciar situaÃ§Ãµes de remarcaÃ§Ã£o de consultas ou incluir lembretes na lista de compras.\\n\\nOBJETIVO GERAL:  \\n1. Reagendar consultas a pedido do profissional.  \\n2. Adicionar lembretes na lista de compras quando solicitado.  \\n\\nRESUMO DE RESPONSABILIDADES:  \\n1. Reagendamento de pacientes  \\n   - Acesse o Google Calendar por meio da ferramenta \\\"MCP Google Calendar\\\" para identificar as consultas afetadas.  \\n   - Extraia o nÃºmero de telefone na descriÃ§Ã£o do evento.  \\n   - Use a ferramenta \\\"Reagendar no WhatsApp\\\" para enviar mensagens de reagendamento aos pacientes.  \\n   - Lembre-se de que vocÃª apenas envia a mensagem; a resposta do paciente Ã© tratada por outro agente.  \\n\\n2. Lista de compras da clÃ­nica  \\n   - Se o profissional solicitar pelo Telegram a inclusÃ£o de um item na lista de compras, utilize a ferramenta \\\"Google Tasks\\\" para adicionar o lembrete.  \\n\\nORIENTAÃ‡Ã•ES DE LINGUAGEM E PROCEDIMENTO:  \\n- Use uma abordagem empÃ¡tica, profissional e acolhedora.  \\n- Nunca envie mensagens para pacientes sem autorizaÃ§Ã£o explÃ­cita do profissional.  \\n- Quando listar eventos ou tarefas, seja objetivo e organizado.  \\n- Mantenha clareza e concisÃ£o em todas as interaÃ§Ãµes.  \\n\\nFERRAMENTAS DISPONÃVEIS:  \\n- Reagendar no WhatsApp  \\n- Google Tasks  \\n- MCP Google Calendar  \\n\\nINSTRUÃ‡Ã•ES FINAIS:  \\n- Atenda exclusivamente Ã s solicitaÃ§Ãµes de reagendamento e inclusÃ£o de lembretes.  \\n- A remarcaÃ§Ã£o de consultas ocorre somente quando o profissional pede, utilizando o MCP Google Calendar para identificar os pacientes e o \\\"Reagendar no WhatsApp\\\" para enviar a mensagem.  \\n- Para a lista de compras, sempre registre no \\\"Google Tasks\\\".  \\n\"},\"promptType\":\"define\"},\"typeVersion\":1.8},{\"id\":\"d674fb31-cf45-47ac-b33b-4abe1920e352\",\"name\":\"Google Tasks\",\"type\":\"n8n-nodes-base.googleTasksTool\",\"position\":[8720,2320],\"parameters\":{\"task\":\"bDQ5ZlNVV2lPQ3pYT3NsNA\",\"title\":\"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Title', ``, 'string') }}\",\"additionalFields\":{\"notes\":\"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Notes', ``, 'string') }}\",\"status\":\"needsAction\"}},\"credentials\":{\"googleTasksOAuth2Api\":{\"id\":\"3SQEwHb0AR81JO8y\",\"name\":\"Google Tasks account\"}},\"typeVersion\":1},{\"id\":\"dff00a3c-6496-4104-afc4-a0556f3cabfa\",\"name\":\"MCP Google Calendar\",\"type\":\"@n8n/n8n-nodes-langchain.mcpClientTool\",\"position\":[8560,2320],\"parameters\":{\"sseEndpoint\":\"https://engaging-seahorse-19.rshare.io/mcp/ceb17fa5-1937-405f-8000-ea3be7d2b032/mcp/:tool/calendar/sse\"},\"typeVersion\":1},{\"id\":\"10a0bda3-94b3-487a-98a1-1e7badcc8775\",\"name\":\"Receber Mensagem Telegram\",\"type\":\"n8n-nodes-base.telegramTrigger\",\"position\":[8100,2020],\"webhookId\":\"f2b29356-d5d3-4f5d-9ef1-273001c0a820\",\"parameters\":{\"updates\":[\"message\"],\"additionalFields\":{}},\"credentials\":{\"telegramApi\":{\"id\":\"TAVUHrFXuDIMInWe\",\"name\":\"Telegram account\"}},\"typeVersion\":1.2},{\"id\":\"46cfa6be-f896-4e33-be3d-b4ef676c043b\",\"name\":\"Postgres Chat Memory\",\"type\":\"@n8n/n8n-nodes-langchain.memoryPostgresChat\",\"position\":[8420,2300],\"parameters\":{\"sessionKey\":\"100\",\"sessionIdType\":\"customKey\",\"contextWindowLength\":10},\"credentials\":{\"postgres\":{\"id\":\"t8gw5Kie6Oxy5TcK\",\"name\":\"Postgres account\"}},\"typeVersion\":1.3},{\"id\":\"c79c44f6-94fa-4e56-9d94-49185f83bfb4\",\"name\":\"OpenAI Chat Model\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\"position\":[5860,3980],\"parameters\":{\"model\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"gpt-4.1-mini-2025-04-14\",\"cachedResultName\":\"gpt-4.1-mini-2025-04-14\"},\"options\":{}},\"credentials\":{\"openAiApi\":{\"id\":\"zUnIUrOWA279vAoC\",\"name\":\"OpenAi account\"}},\"typeVersion\":1.2},{\"id\":\"5e7ac239-6ba1-414c-b11d-d637361e8f77\",\"name\":\"Assistente ClÃ­nica\",\"type\":\"@n8n/n8n-nodes-langchain.agent\",\"position\":[5960,3760],\"parameters\":{\"text\":\"={{ $json.text }}{{ $json.output}}\",\"options\":{\"systemMessage\":\"=HOJE Ã‰: {{ $now }}\\nCONTATO DA CLÃNICA: \\n{ coloque o seu contato aqui }\\n\\nINSTRUÃ‡ÃƒO IMPORTANTE:\\n\\nAo criar ou editar qualquer evento via MCP_CALENDAR, inclua na descriÃ§Ã£o do agendamento:\\n\\nTelefone do paciente\\n\\nNome completo\\n\\nData de nascimento\\n\\nInformaÃ§Ãµes adicionais (convÃªnio, condiÃ§Ã£o de saÃºde etc.)\\n\\nPAPEL:\\nVocÃª Ã© uma atendente do WhatsApp da ClÃ­nica Moreira, especializada em atendimento humanizado. Sua missÃ£o:\\n\\nAtender pacientes de forma Ã¡gil e eficiente\\n\\nResponder dÃºvidas sobre clÃ­nica e serviÃ§os\\n\\nAgendar, remarcar e cancelar consultas pelo MCP_CALENDAR\\n\\nPERSONALIDADE E TOM DE VOZ:\\n\\nSimpÃ¡tica, acolhedora e respeitosa\\n\\nFormal, sem emojis ou gÃ­rias\\n\\nFERRAMENTAS DISPONÃVEIS:\\n\\nMCP_CALENDAR (trigger /mcp/:tool/calendar)\\n\\nAVALIABILITY_CALENDAR: verifica horÃ¡rios livres entre Start_Time e End_Time\\n\\nGET_ALL_CALENDAR: lista todos os eventos entre After e Before\\n\\nCREATE_CALENDAR: cria novo evento com start, end e Description (inclua sempre telefone, nome e data de nascimento)\\n\\nUPDATE_CALENDAR: atualiza campos de um evento existente (Event_ID)\\n\\nDELETE_CALENDAR: remove evento (Event_ID)\\n\\nGET_CALENDAR: obtÃ©m detalhes de um evento especÃ­fico (Event_ID)\\n\\nCallToHuman (workflow id A95kslcW4H82nJuR)\\n\\nEncaminha atendimento humano via EvolutionAPI em n8n\\n\\nDisparar IMEDIATAMENTE quando:\\n\\nUrgÃªncia ou mal-estar grave\\n\\nPedido de diagnÃ³stico/opiniÃ£o mÃ©dica\\n\\nInsatisfaÃ§Ã£o expressa do paciente\\n\\nAssuntos fora do escopo da clÃ­nica\\n\\nExemplo de chamada:\\n\\n{\\n  \\\"tool\\\": \\\"CallToHuman\\\",\\n  \\\"telefone\\\": \\\"<telefone>\\\",\\n  \\\"nome\\\": \\\"<nome completo>\\\",\\n  \\\"ultima_mensagem\\\": \\\"<texto da Ãºltima mensagem>\\\"\\n}\\n\\nEnviar telegram cancelamento\\n\\nApÃ³s DELETE_CALENDAR, envie ao gestor via Telegram: nome, data, hora\\n\\nSOP (Fluxo de Atendimento):\\n\\nInÃ­cio e coleta de dados\\n\\nCumprimente e informe o link da agenda: https://calendar.google.com/calendar/embed?src=a57a3781407f42b1ad7fe24ce76f558dc6c86fea5f349b7fd39747a2294c1654%40group.calendar.google.com&ctz=America%2FArgentina%2FBuenos_Aires\\n\\nPeÃ§a: nome completo, data de nascimento e confirme o telefone\\n number: {{ $('Webhook1').item.json.body.data.key.remoteJid.replaceAll(\\\"@s.whatsapp.net\\\",\\\"\\\") }}\\n\\nVerificaÃ§Ã£o de disponibilidade\\n\\nPergunte data e turno preferidos\\n\\nChame AVALIABILITY_CALENDAR com Start_Time 08:00 e End_Time 19:00 (ou turno)\\n\\nInforme horÃ¡rios livres\\n\\nAgendamento\\n\\nApÃ³s escolha do paciente, use CREATE_CALENDAR com start, end e Description\\n\\nAguarde retorno para confirmar criaÃ§Ã£o antes de responder\\n\\nRemarcaÃ§Ã£o\\n\\nSolicite dados e nova preferÃªncia de data/turno\\n\\nLocalize evento antigo via GET_ALL_CALENDAR\\n\\nUse DELETE_CALENDAR no Event_ID antigo\\n\\nCrie novo com CREATE_CALENDAR\\n\\nConfirme apÃ³s sucesso\\n\\nCancelamento\\n\\nSolicite dados do paciente\\n\\nIdentifique Event_ID via GET_ALL_CALENDAR ou GET_CALENDAR\\n\\nExecute DELETE_CALENDAR\\n\\nUse Enviar telegram cancelamento\\n\\nConfirme cancelamento ao paciente\\n\\nConfirmaÃ§Ã£o de consulta (follow-up)\\n\\nSe paciente responder â€œConfirmar, IDâ€: use UPDATE_CALENDAR para prefixar tÃ­tulo com [Confirmado]\\n\\nSe â€œReagendar, IDâ€: DELETE_CALENDAR e oriente para usar link da agenda\\n\\nREGRAS DE ESCALONAMENTO:\\n\\nUse CallToHuman IMEDIATAMENTE em situaÃ§Ãµes de:\\n\\nUrgÃªncia/mal-estar\\n\\nPedidos de diagnÃ³stico/opiniÃ£o mÃ©dica\\n\\nInsatisfaÃ§Ã£o ou reclamaÃ§Ãµes\\n\\nAssuntos fora do escopo\\n\\nMANTENHA SEMPRE:\\n\\nTom profissional e respeitoso\\n\\nLinguagem clara e objetiva\\n\\nAgendamentos apenas em datas futuras\\n\\nNunca confirmar sem retorno do MCP_CALENDAR\\n\\nHORÃRIOS DE FUNCIONAMENTO:\\n\\nSegâ€“SÃ¡b: 08hâ€“19h | Dom e feriados: fechado\\n\\nLOCALIZAÃ‡ÃƒO:\\nRua Rio Casca, 417 â€“ Belo Horizonte, MG\\n\\nLINK DA AGENDA:\\nhttps://calendar.google.com/calendar/embed?src=a57a3781407f42b1ad7fe24ce76f558dc6c86fea5f349b7fd39747a2294c1654%40group.calendar.google.com&ctz=America%2FArgentina%2FBuenos_Aires\\n\\n\"},\"promptType\":\"define\"},\"retryOnFail\":true,\"typeVersion\":1.8,\"waitBetweenTries\":1000},{\"id\":\"2f0a6ea1-7654-4ae7-884e-d5b8ff47d4f9\",\"name\":\"Enviar alerta de cancelamento\",\"type\":\"n8n-nodes-base.telegramTool\",\"position\":[6400,3980],\"webhookId\":\"d045a8c1-ec1b-4d20-8226-457aa18934af\",\"parameters\":{\"text\":\"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Text', ``, 'string') }}\",\"chatId\":\"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Chat_ID', ``, 'string') }}\",\"additionalFields\":{}},\"credentials\":{\"telegramApi\":{\"id\":\"TAVUHrFXuDIMInWe\",\"name\":\"Telegram account\"}},\"typeVersion\":1.2},{\"id\":\"8ddaa14f-7d2f-4364-8ff7-f87e0a428e37\",\"name\":\"Gatilho diÃ¡rio\",\"type\":\"n8n-nodes-base.scheduleTrigger\",\"position\":[8060,2780],\"parameters\":{\"rule\":{\"interval\":[{\"field\":\"cronExpression\",\"expression\":\"0 8 * * 1-5\"}]}},\"typeVersion\":1.2},{\"id\":\"0784753d-123d-4259-abcc-8abf39e7fc07\",\"name\":\"Assistente de confirmaÃ§Ã£o\",\"type\":\"@n8n/n8n-nodes-langchain.agent\",\"position\":[8280,2680],\"parameters\":{\"text\":\"=Hoje Ã© {{ $now }}. VocÃª Ã© um agente especializado em **confirmaÃ§Ã£o de consultas** para a clÃ­nica. Sua funÃ§Ã£o principal Ã©:\\n\\n1. **Listar os eventos** agendados para o prÃ³ximo dia no MCP Calendar.\\n2. **Obter o numero** na descriÃ§Ã£o de cada evento.\\n3. **Enviar uma mensagem de confirmaÃ§Ã£o** usando a ferramenta â€œrelembraAGENDAMENTOâ€, perguntando se o paciente confirma a consulta ou prefere reagendar.\\n\\nImportante:\\n- VocÃª **nÃ£o recebe respostas** diretamente; o retorno do paciente Ã© tratado por outro agente.\\n\\n\",\"options\":{\"systemMessage\":\"\"},\"promptType\":\"define\"},\"typeVersion\":1.8},{\"id\":\"afa90e86-0f44-4069-976b-ca302b0d828a\",\"name\":\"AI Agent\",\"type\":\"@n8n/n8n-nodes-langchain.agent\",\"position\":[5840,4460],\"parameters\":{\"text\":\"={{ $json.output }}\",\"options\":{\"systemMessage\":\"=VocÃª Ã© especialista em formataÃ§Ã£o de mensagem para whataspp, trabalhando somente na formataÃ§Ã£o e nÃ£o alterando o conteÃºdo da menssagem.\\n\\n- Substitua ** por *\\n- Remova #\"},\"promptType\":\"define\"},\"typeVersion\":1.8},{\"id\":\"13179a70-85b6-4e18-8736-eb2cdd252591\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[6960,2580],\"parameters\":{\"color\":5,\"width\":1940,\"height\":600,\"content\":\"# \\\"Appointment Confirmation Assistant\\\"\\nDescription:\\n\\nPurpose:\\nThis section contains the configuration for the Appointment Confirmation Assistant, an agent specialized in confirming scheduled appointments with patients.\\n\\nInstructions for Use:\\n\\nIt is triggered automatically every weekday (Monday to Friday) at 08:00 AM via the Daily Trigger (Gatilho diÃ¡rio).\\n\\nThe agent retrieves all appointments scheduled for the next day using MCP Google Calendar.\\n\\nIt extracts each patient's phone number from the event description field.\\n\\nA confirmation message is sent to each patient using the relembraAGENDAMENTO tool, asking for confirmation or rescheduling.\\n\\nImportant: This agent does not handle responses from patients; another agent or workflow is responsible for follow-ups.\\n\\nMake sure event descriptions in Google Calendar are correctly filled to avoid errors.\\n\\n\"},\"typeVersion\":1},{\"id\":\"4111432b-2ddc-4e96-ba6d-d25e003e2688\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[4760,3620],\"parameters\":{\"color\":3,\"width\":1780,\"height\":640,\"content\":\"# \\\"Agent Core Components (Tools, MCP, Memory, LLM Model)\\\"\\nDescription:\\n\\nPurpose:\\n\\nThis sticky note represents the essential structure of any intelligent agent: it includes access to external tools,\\n persistent memory, the MCP system for calendar management, and a Language Model (LLM) to process natural language tasks.\\n\\nInstructions for Use:\\n\\nLanguage Model nodes (OpenAI, OpenRouter) are responsible for natural language understanding and generation.\\n\\nMemory nodes (Postgres Chat Memory) maintain conversation context over multiple interactions.\\n\\nMCP Tools interact with Google Calendar and other services to perform real-world actions.\\n\\nAlways ensure memory synchronization between the agent's context and actions performed.\\n\\nIf new tools are added, they must be connected both to the agent and properly described in the system message.\\n\\n\"},\"typeVersion\":1},{\"id\":\"4b59f903-07c2-4e66-9ea1-0727beb0d85c\",\"name\":\"Sticky Note3\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[4640,4300],\"parameters\":{\"color\":4,\"width\":1800,\"height\":640,\"content\":\"# \\\"Processing and Sending WhatsApp Responses\\\"\\nDescription:\\n\\nPurpose:\\nThis section is responsible for processing, formatting, and sending outbound WhatsApp messages to patients through the Evolution API.\\n\\nInstructions for Use:\\n\\nMessages received from the assistant agent are first reformatted by the AI Agent node to comply with WhatsApp markdown syntax (e.g., replacing **bold** with *bold*).\\n\\nOnce formatted, the messages are forwarded to WhatsApp using the Evolution API2 node.\\n\\nEnsure proper formatting before sending to maintain a professional communication tone and avoid delivery errors.\\n\\nAny future text-processing improvements should be implemented here.\"},\"typeVersion\":1},{\"id\":\"274f7f66-7613-4e9e-868d-a5705156dde6\",\"name\":\"Postgres Chat Memory1\",\"type\":\"@n8n/n8n-nodes-langchain.memoryPostgresChat\",\"position\":[6000,3980],\"parameters\":{\"sessionKey\":\"= {{ $('Webhook1').item.json.body.data.key.id }}\",\"sessionIdType\":\"customKey\",\"contextWindowLength\":50},\"credentials\":{\"postgres\":{\"id\":\"t8gw5Kie6Oxy5TcK\",\"name\":\"Postgres account\"}},\"typeVersion\":1.3},{\"id\":\"654ed617-df1a-48db-b9bc-833b2c1ecb80\",\"name\":\"MCP Google Calendar2\",\"type\":\"@n8n/n8n-nodes-langchain.mcpClientTool\",\"position\":[6120,3980],\"parameters\":{\"sseEndpoint\":\"https://engaging-seahorse-19.rshare.io/mcp/ceb17fa5-1937-405f-8000-ea3be7d2b032/mcp/:tool/calendar/sse\"},\"typeVersion\":1},{\"id\":\"b11aeec6-b446-4c02-a0b0-7f9239628df3\",\"name\":\"MCP GMAIL\",\"type\":\"@n8n/n8n-nodes-langchain.mcpClientTool\",\"position\":[8540,3000],\"parameters\":{\"sseEndpoint\":\"https://engaging-seahorse-19.rshare.io/mcp/82a7a338-618c-44f5-a1c3-f2e32b6b4833/mcp/:tool/gmail/sse\"},\"typeVersion\":1},{\"id\":\"f5a38b34-499e-4bbc-9282-ce5f4a3b85a3\",\"name\":\"MCP CALENDAR\",\"type\":\"@n8n/n8n-nodes-langchain.mcpClientTool\",\"position\":[8380,3000],\"parameters\":{\"sseEndpoint\":\"https://engaging-seahorse-19.rshare.io/mcp/ceb17fa5-1937-405f-8000-ea3be7d2b032/mcp/:tool/calendar/sse\"},\"typeVersion\":1},{\"id\":\"cd6a6147-fd18-4cd4-8aab-fcb454ab76b7\",\"name\":\"Telegram\",\"type\":\"n8n-nodes-base.telegram\",\"position\":[8740,2020],\"webhookId\":\"5bba05fc-2859-4225-aa85-7c4bc5ff532d\",\"parameters\":{\"text\":\"={{ $json.output }}\",\"chatId\":\"={{ $('Receber Mensagem Telegram').item.json.message.chat.id }}\",\"additionalFields\":{}},\"credentials\":{\"telegramApi\":{\"id\":\"TAVUHrFXuDIMInWe\",\"name\":\"Telegram account\"}},\"typeVersion\":1.2},{\"id\":\"900b8c1a-f987-4898-9fc1-bfc673773e06\",\"name\":\"OpenRouter Chat Model1\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatOpenRouter\",\"position\":[5760,4680],\"parameters\":{\"model\":\"google/gemini-2.0-flash-exp:free\",\"options\":{}},\"credentials\":{\"openRouterApi\":{\"id\":\"eGPA8rbskZCfFPBn\",\"name\":\"OpenRouter account\"}},\"typeVersion\":1},{\"id\":\"1584b448-d8f5-4bab-ad9a-9b07edb8e102\",\"name\":\"Webhook1\",\"type\":\"n8n-nodes-base.webhook\",\"position\":[5760,2100],\"webhookId\":\"405dab7c-a0ea-4f5b-a6cc-ede9d5ba78a0\",\"parameters\":{\"path\":\"evolutionAPIKORE\",\"options\":{},\"httpMethod\":\"POST\"},\"typeVersion\":2},{\"id\":\"74b5179f-502c-45d6-88e9-2c2d492603cd\",\"name\":\"Edit Fields1\",\"type\":\"n8n-nodes-base.set\",\"position\":[6000,2100],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"3e6335ae-74c3-4655-b68f-cdf0c68b864f\",\"name\":\"number\",\"type\":\"string\",\"value\":\"={{ $json.body.data.key.remoteJid }}\"},{\"id\":\"15f399cf-a98e-45e7-91ce-61b4fad340fd\",\"name\":\"name\",\"type\":\"string\",\"value\":\"={{ $json.body.data.pushName }}\"},{\"id\":\"b1943003-1f47-40e1-b418-6a52557ec44e\",\"name\":\"key_id\",\"type\":\"string\",\"value\":\"={{ $json.body.data.key.id }}\"},{\"id\":\"ed23194b-22ca-455b-a085-7dae706d0569\",\"name\":\"text\",\"type\":\"string\",\"value\":\"={{ $json.body.data.message.conversation }}\"},{\"id\":\"b35f8b61-da15-42e3-a078-4cd901e1f273\",\"name\":\"type\",\"type\":\"string\",\"value\":\"={{ $json.body.data.message.imageMessage.mimetype }}\"},{\"id\":\"a62bf96a-51aa-44c3-9e5d-f592e32a31d6\",\"name\":\"image.url\",\"type\":\"string\",\"value\":\"={{ $json.body.data.message.imageMessage.url }}\"},{\"id\":\"b004987d-3527-4040-a5e6-5fe06b25c9b9\",\"name\":\"audio.url\",\"type\":\"string\",\"value\":\"={{ $json.body.data.message.audioMessage.url }}\"},{\"id\":\"4c2cc03a-c104-4a87-9d31-6a7c256890ad\",\"name\":\"document.url\",\"type\":\"string\",\"value\":\"={{ $json.body.data.message.documentMessage.url }}\"}]}},\"typeVersion\":3.4},{\"id\":\"ce22f5bc-f0e1-463d-9b9a-5112f8d91f00\",\"name\":\"Switch\",\"type\":\"n8n-nodes-base.switch\",\"position\":[6240,2080],\"parameters\":{\"rules\":{\"values\":[{\"outputKey\":\"text\",\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"2f9854ac-26b3-446c-9d0d-ae25157c61bb\",\"operator\":{\"type\":\"string\",\"operation\":\"notEmpty\",\"singleValue\":true},\"leftValue\":\"={{ $json.text }}\",\"rightValue\":\"=\"}]},\"renameOutput\":true},{\"outputKey\":\"image\",\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"73b7d93a-928e-42ec-9c8e-ae8e9b97a867\",\"operator\":{\"type\":\"string\",\"operation\":\"notEmpty\",\"singleValue\":true},\"leftValue\":\"={{ $json.image.url }}\",\"rightValue\":\"=\"}]},\"renameOutput\":true},{\"outputKey\":\"audio\",\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"2f9915b9-e2b4-4528-ad36-515a848ab1be\",\"operator\":{\"type\":\"string\",\"operation\":\"notEmpty\",\"singleValue\":true},\"leftValue\":\"={{ $json.audio.url }}\",\"rightValue\":\"[null]\"}]},\"renameOutput\":true},{\"outputKey\":\"document\",\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"9fcbe89a-c9d7-4dc6-bb6f-27c1cacbfddc\",\"operator\":{\"type\":\"string\",\"operation\":\"notEmpty\",\"singleValue\":true},\"leftValue\":\"={{ $json.document.url }}\",\"rightValue\":\"[null]\"}]},\"renameOutput\":true}]},\"options\":{}},\"typeVersion\":3.2},{\"id\":\"c78ee758-fb71-4a4f-9450-0ffcd67a2af2\",\"name\":\"Sticky Note5\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[4960,1840],\"parameters\":{\"color\":6,\"width\":1580,\"height\":640,\"content\":\"# Incoming WhatsApp Webhook and Message Type Handling\\\"\\nDescription:\\n\\nPurpose:\\nManages the initial reception and classification of incoming WhatsApp messages from patients via the webhook system.\\n\\nInstructions for Use:\\n\\nThe Webhook1 node captures incoming messages.\\n\\nEdit Fields1 extracts structured fields such as text, image URL, audio URL, and document URL.\\n\\nSwitch node analyzes which type of content was received and directs the flow accordingly:\\n\\nText â†’ Forwarded to the assistant for handling.\\n\\nImage â†’ Sent for OCR analysis.\\n\\nAudio â†’ Sent for transcription.\\n\\nDocument â†’ (Currently unused, but ready for future workflows).\\n\\nKeep webhook credentials updated to ensure system reliability.\\n\\n\"},\"typeVersion\":1},{\"id\":\"83abbf61-91e2-4d1c-a42a-4f05b18583e7\",\"name\":\"OpenAI\",\"type\":\"@n8n/n8n-nodes-langchain.openAi\",\"position\":[6380,3260],\"parameters\":{\"options\":{},\"resource\":\"audio\",\"operation\":\"transcribe\",\"binaryPropertyName\":\"=data\"},\"credentials\":{\"openAiApi\":{\"id\":\"zUnIUrOWA279vAoC\",\"name\":\"OpenAi account\"}},\"typeVersion\":1.8},{\"id\":\"4c2dcefc-fb65-42ca-8c63-8636f2906654\",\"name\":\"Evolution API\",\"type\":\"n8n-nodes-evolution-api.evolutionApi\",\"position\":[5860,3260],\"parameters\":{\"resource\":\"chat-api\",\"messageId\":\"={{ $json.key_id }}\",\"operation\":\"get-media-base64\",\"convertToMp4\":true,\"instanceName\":\"={{ $('Webhook1').item.json.body.instance }}\"},\"credentials\":{\"evolutionApi\":{\"id\":\"fPKdX0EITLV8HI89\",\"name\":\"Evolution account\"}},\"typeVersion\":1},{\"id\":\"85909834-7564-478b-bce8-0c3fe7bf4159\",\"name\":\"Convert to File\",\"type\":\"n8n-nodes-base.convertToFile\",\"position\":[6100,3260],\"parameters\":{\"options\":{},\"operation\":\"toBinary\",\"sourceProperty\":\"data.base64\"},\"typeVersion\":1.1},{\"id\":\"3e200157-fbcc-4225-b982-2dfaea54cc23\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[4980,3100],\"parameters\":{\"width\":1760,\"height\":480,\"content\":\"## \\\"Download Audio and Convert to MP4\\\"\\nDescription:\\n\\nPurpose:\\nHandles retrieval, conversion, and transcription of audio files sent by patients via WhatsApp.\\n\\nInstructions for Use:\\n\\nEvolution API downloads the audio in base64 format.\\n\\nConvert to File transforms base64 into a binary file compatible with transcription engines.\\n\\nOpenAI Whisper API (via OpenAI node) transcribes the audio into text, preparing it for natural language processing.\\n\\nEnsure audio formats are correctly handled (e.g., MP4/MP3) to avoid conversion or transcription failures.\\n\\nMonitor for potential heavy file size issues (>25MB) which may impact performance.\"},\"typeVersion\":1},{\"id\":\"5862d5f1-2df4-40ee-881f-a6d6e302602f\",\"name\":\"Sticky Note6\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[4920,2540],\"parameters\":{\"width\":1820,\"height\":480,\"content\":\"# \\\"Extract Text from Images\\\"\\nDescription:\\n\\nPurpose:\\nProcesses images received via WhatsApp to extract text (OCR) and describe their visual content for further contextual analysis.\\n\\nInstructions for Use:\\n\\nThe OpenAI1 node uses a Vision model to transcribe and describe any text or scene from incoming images.\\n\\nThe resulting data is interpreted by the AI Agent2, which prepares insights and recommends appropriate responses.\\n\\nImage-to-text extraction is especially useful for handling prescriptions, notes, or medical documents sent by patients.\\n\\nMaintain quality standards: images must be clear and high-resolution for best transcription results.\"},\"typeVersion\":1},{\"id\":\"8dbd4e6d-8b38-44d8-ba45-5cac2713f6ca\",\"name\":\"OpenAI1\",\"type\":\"@n8n/n8n-nodes-langchain.openAi\",\"position\":[5980,2620],\"parameters\":{\"text\":\"TRANSCRIBE OS TEXTOS e describe a imagem\",\"modelId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"chatgpt-4o-latest\",\"cachedResultName\":\"CHATGPT-4O-LATEST\"},\"options\":{},\"resource\":\"image\",\"imageUrls\":\"={{ $json.image }}\",\"operation\":\"analyze\"},\"credentials\":{\"openAiApi\":{\"id\":\"zUnIUrOWA279vAoC\",\"name\":\"OpenAi account\"}},\"typeVersion\":1.8},{\"id\":\"19e8d50d-4f87-408e-96f0-236932c1d120\",\"name\":\"AI Agent2\",\"type\":\"@n8n/n8n-nodes-langchain.agent\",\"position\":[6200,2620],\"parameters\":{\"text\":\"={{$json.output}}\",\"options\":{\"systemMessage\":\"voce e encarregado de analizar o texto proveniente do analisis de uma iamgem ela pode conter texto, a ideia e que voce explique ao proximo agente como debe responder as mensagens\"},\"promptType\":\"define\"},\"typeVersion\":1.9},{\"id\":\"0d2f9842-b011-49f5-9594-24a917dee60e\",\"name\":\"OpenRouter Chat Model2\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatOpenRouter\",\"position\":[6100,2860],\"parameters\":{\"model\":\"google/gemini-2.5-pro-exp-03-25:free\",\"options\":{}},\"credentials\":{\"openRouterApi\":{\"id\":\"eGPA8rbskZCfFPBn\",\"name\":\"OpenRouter account\"}},\"typeVersion\":1},{\"id\":\"58f7f9c7-6f86-40ff-bfad-5467e5b3a9e4\",\"name\":\"Evolution API2\",\"type\":\"n8n-nodes-evolution-api.evolutionApi\",\"position\":[6200,4460],\"parameters\":{\"resource\":\"messages-api\",\"remoteJid\":\"={{ $('Webhook1').item.json.body.data.key.remoteJid }}\",\"messageText\":\"={{$json.output}}\",\"instanceName\":\"={{ $('Webhook1').item.json.body.instance }}\",\"options_message\":{}},\"credentials\":{\"evolutionApi\":{\"id\":\"fPKdX0EITLV8HI89\",\"name\":\"Evolution account\"}},\"typeVersion\":1},{\"id\":\"2b529ab1-2a7e-44e0-b7c8-ed05e07c6def\",\"name\":\"Sticky Note4\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[6960,1840],\"parameters\":{\"width\":1960,\"height\":680,\"content\":\"## \\\"Internal Clinic Assistant\\\"\\nDescription:\\n\\nPurpose:\\nRepresents the Internal Assistant for the clinic, used exclusively by the internal team via Telegram to manage patient rescheduling and manage a purchasing reminder list.\\n\\nInstructions for Use:\\n\\nTriggered by staff messages sent via Telegram.\\n\\nRescheduling tasks:\\n\\nAccess the MCP Google Calendar to locate and manage appointments.\\n\\nExtract patient contact from the event description.\\n\\nSend rescheduling messages through WhatsApp using the dedicated tool.\\n\\nShopping list tasks:\\n\\nInsert shopping list reminders into Google Tasks based on the staff's instructions.\\n\\nAlways maintain professional and empathetic tone when interacting with patients, even if the communication is indirect.\\n\\nAvoid unauthorized direct patient contact without staff permission.\"},\"typeVersion\":1},{\"id\":\"a4a51bd1-48a6-4e32-b696-0ae77a0e05fe\",\"name\":\"CallToHuman\",\"type\":\"@n8n/n8n-nodes-langchain.toolWorkflow\",\"position\":[6240,4000],\"parameters\":{\"name\":\"escalar_humano\",\"workflowId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"A95kslcW4H82nJuR\",\"cachedResultName\":\"callToHuman\"},\"description\":\"=Use essa ferramenta ao perceber que o paciente fala de:\\n- SituaÃ§Ãµes urgentes (sentindo-se mal, etc.)\\n- Assuntos nÃ£o relacionados Ã  clÃ­nica\\n- InsatisfaÃ§Ã£o extrema ou pedidos de falar com um humano\\n\",\"workflowInputs\":{\"value\":{\"nome\":\"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('nome', ``, 'string') }}\",\"telefone\":\"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('telefone', ``, 'string') }}\",\"ultima_mensagem\":\"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('ultima_mensagem', ``, 'string') }}\"},\"schema\":[{\"id\":\"telefone\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"telefone\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"nome\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"nome\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"ultima_mensagem\",\"type\":\"string\",\"display\":true,\"required\":false,\"displayName\":\"ultima_mensagem\",\"defaultMatch\":false,\"canBeUsedToMatch\":true}],\"mappingMode\":\"defineBelow\",\"matchingColumns\":[],\"attemptToConvertTypes\":false,\"convertFieldsToString\":false}},\"typeVersion\":2.1},{\"id\":\"674c5c75-a954-4306-8a02-71bdda89293c\",\"name\":\"OpenAI Chat Model2\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\"position\":[8260,2840],\"parameters\":{\"model\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"gpt-4.1-mini\",\"cachedResultName\":\"gpt-4.1-mini\"},\"options\":{}},\"credentials\":{\"openAiApi\":{\"id\":\"zUnIUrOWA279vAoC\",\"name\":\"OpenAi account\"}},\"typeVersion\":1.2},{\"id\":\"b398627e-2fbe-44e4-ac2f-523b03871eda\",\"name\":\"REMINDER\",\"type\":\"n8n-nodes-evolution-api.evolutionApi\",\"position\":[8640,2700],\"parameters\":{\"resource\":\"messages-api\",\"remoteJid\":\"5511111111111@s.whatsapp.net\",\"messageText\":\"={{$fromAI(\\\"reminder\\\")}}\",\"instanceName\":\"instance name\",\"options_message\":{}},\"credentials\":{\"evolutionApi\":{\"id\":\"fPKdX0EITLV8HI89\",\"name\":\"Evolution account\"}},\"typeVersion\":1}],\"active\":false,\"pinData\":{\"Webhook1\":[{\"json\":{\"body\":{\"data\":{\"key\":{\"id\":\"05D218BDE5BFC8378B5AA50BA87FDAFE\",\"fromMe\":false,\"remoteJid\":\"5491169701682@s.whatsapp.net\"},\"source\":\"android\",\"status\":\"DELIVERY_ACK\",\"message\":{\"conversation\":\"Sim\",\"messageContextInfo\":{\"messageSecret\":\"RdahuRio1gbaHLsCeV24k8yFFyJWGpAJ5zHYRc2QysU=\",\"deviceListMetadata\":{\"recipientKeyHash\":\"KgcEIs2I9kXQgQ==\",\"recipientTimestamp\":\"1745501413\"},\"deviceListMetadataVersion\":2}},\"pushName\":\"Luciano\",\"instanceId\":\"317a031e-567d-4c2e-9bc4-146616fe4db7\",\"messageType\":\"conversation\",\"messageTimestamp\":1745501855},\"event\":\"messages.upsert\",\"apikey\":\"59BA76B6BD78-403B-A0CC-8735B6A7ED3A\",\"sender\":\"553191282843@s.whatsapp.net\",\"instance\":\"kore\",\"date_time\":\"2025-04-24T10:37:35.514Z\",\"server_url\":\"http://localhost:8080\",\"destination\":\"https://engaging-seahorse-19.rshare.io/webhook/evolutionAPIKORE\"},\"query\":{},\"params\":{},\"headers\":{\"host\":\"host.docker.internal:5678\",\"x-scheme\":\"https\",\"forwarded\":\"by=_exposr;for=179.0.72.34;host=engaging-seahorse-19.rshare.io;proto=https\",\"x-real-ip\":\"179.0.72.34\",\"connection\":\"keep-alive\",\"exposr-via\":\"b9e7ef031eb8fe005896193e59b1d6f6d8743b1e\",\"user-agent\":\"axios/1.7.9\",\"content-type\":\"application/json\",\"x-request-id\":\"91360975101096aa10d12cb5b8925b55\",\"content-length\":\"821\",\"accept-encoding\":\"gzip, compress, deflate, br\",\"x-forwarded-for\":\"179.0.72.34\",\"x-forwarded-host\":\"engaging-seahorse-19.rshare.io\",\"x-forwarded-port\":\"443\",\"x-forwarded-proto\":\"https\",\"x-forwarded-scheme\":\"https\"},\"webhookUrl\":\"https://engaging-seahorse-19.rshare.io/webhook/evolutionAPIKORE\",\"executionMode\":\"production\"}}],\"Gatilho diÃ¡rio\":[{\"json\":{\"Hour\":\"10\",\"Year\":\"2025\",\"Month\":\"April\",\"Minute\":\"13\",\"Second\":\"11\",\"Timezone\":\"America/New_York (UTC-04:00)\",\"timestamp\":\"2025-04-24T10:13:11.035-04:00\",\"Day of week\":\"Thursday\",\"Day of month\":\"24\",\"Readable date\":\"April 24th 2025, 10:13:11 am\",\"Readable time\":\"10:13:11 am\"}}]},\"settings\":{\"executionOrder\":\"v1\"},\"versionId\":\"3044ad5c-d14e-4562-a454-0ad87f26dc68\",\"connections\":{\"OpenAI\":{\"main\":[[{\"node\":\"Assistente ClÃ­nica\",\"type\":\"main\",\"index\":0}]]},\"Switch\":{\"main\":[[{\"node\":\"Assistente ClÃ­nica\",\"type\":\"main\",\"index\":0}],[{\"node\":\"OpenAI1\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Evolution API\",\"type\":\"main\",\"index\":0}],[]]},\"OpenAI1\":{\"main\":[[{\"node\":\"AI Agent2\",\"type\":\"main\",\"index\":0}]]},\"AI Agent\":{\"main\":[[{\"node\":\"Evolution API2\",\"type\":\"main\",\"index\":0}]]},\"Webhook1\":{\"main\":[[{\"node\":\"Edit Fields1\",\"type\":\"main\",\"index\":0}]]},\"AI Agent2\":{\"main\":[[{\"node\":\"Assistente ClÃ­nica\",\"type\":\"main\",\"index\":0}]]},\"MCP GMAIL\":{\"ai_tool\":[[{\"node\":\"Assistente de confirmaÃ§Ã£o\",\"type\":\"ai_tool\",\"index\":0}]]},\"CallToHuman\":{\"ai_tool\":[[{\"node\":\"Assistente ClÃ­nica\",\"type\":\"ai_tool\",\"index\":0}]]},\"Edit Fields1\":{\"main\":[[{\"node\":\"Switch\",\"type\":\"main\",\"index\":0}]]},\"Google Tasks\":{\"ai_tool\":[[{\"node\":\"Assistente clinica interno\",\"type\":\"ai_tool\",\"index\":0}]]},\"MCP CALENDAR\":{\"ai_tool\":[[{\"node\":\"Assistente de confirmaÃ§Ã£o\",\"type\":\"ai_tool\",\"index\":0}]]},\"Evolution API\":{\"main\":[[{\"node\":\"Convert to File\",\"type\":\"main\",\"index\":0}]]},\"Convert to File\":{\"main\":[[{\"node\":\"OpenAI\",\"type\":\"main\",\"index\":0}]]},\"Gatilho diÃ¡rio\":{\"main\":[[{\"node\":\"Assistente de confirmaÃ§Ã£o\",\"type\":\"main\",\"index\":0}]]},\"OpenAI Chat Model\":{\"ai_languageModel\":[[{\"node\":\"Assistente ClÃ­nica\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"OpenAI Chat Model1\":{\"ai_languageModel\":[[{\"node\":\"Assistente clinica interno\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"OpenAI Chat Model2\":{\"ai_languageModel\":[[{\"node\":\"Assistente de confirmaÃ§Ã£o\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"Assistente ClÃ­nica\":{\"main\":[[{\"node\":\"AI Agent\",\"type\":\"main\",\"index\":0}]]},\"MCP Google Calendar\":{\"ai_tool\":[[{\"node\":\"Assistente clinica interno\",\"type\":\"ai_tool\",\"index\":0}]]},\"MCP Google Calendar2\":{\"ai_tool\":[[{\"node\":\"Assistente ClÃ­nica\",\"type\":\"ai_tool\",\"index\":0}]]},\"Postgres Chat Memory\":{\"ai_memory\":[[{\"node\":\"Assistente clinica interno\",\"type\":\"ai_memory\",\"index\":0}]]},\"Postgres Chat Memory1\":{\"ai_memory\":[[{\"node\":\"Assistente ClÃ­nica\",\"type\":\"ai_memory\",\"index\":0}]]},\"OpenRouter Chat Model1\":{\"ai_languageModel\":[[{\"node\":\"AI Agent\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"OpenRouter Chat Model2\":{\"ai_languageModel\":[[{\"node\":\"AI Agent2\",\"type\":\"ai_languageModel\",\"index\":0}]]},\"Receber Mensagem Telegram\":{\"main\":[[{\"node\":\"Assistente clinica interno\",\"type\":\"main\",\"index\":0}]]},\"Assistente clinica interno\":{\"main\":[[{\"node\":\"Telegram\",\"type\":\"main\",\"index\":0}]]},\"Assistente de confirmaÃ§Ã£o\":{\"main\":[[{\"node\":\"REMINDER\",\"type\":\"main\",\"index\":0}]]},\"Enviar alerta de cancelamento\":{\"ai_tool\":[[{\"node\":\"Assistente ClÃ­nica\",\"type\":\"ai_tool\",\"index\":0}]]}}}",
  "readme": "# Healthcare Clinic Assistant with WhatsApp and Telegram Integration\n\n**Version:** 1.1.0  \n**n8n Version:** 1.88.0+  \n**License:** MIT\n\n* * *\n\n## ğŸ“‹ Description\n\nA **comprehensive and modular automation workflow** designed for healthcare clinics.  \nIt manages patient communication, appointment scheduling, confirmations, rescheduling, internal tasks, and media processing by integrating **WhatsApp** , **Telegram** , **Google Calendar** , and **Google Tasks** , combined with **AI-powered agents** for maximum efficiency.\n\nThis system guarantees proactive communication with patients, streamlined internal clinic management, and consistent data synchronization across platforms.\n\n* * *\n\n## ğŸŒŸ Key Features\n\n  * ğŸ¤– **AI-Powered Specialized Agents** :  \nDistinct agents handle WhatsApp patient support, appointment confirmations, and internal rescheduling tasks.\n\n  * ğŸ“± **Omnichannel Communication** :  \nHandles patient interactions via WhatsApp and staff commands via Telegram.\n\n  * ğŸ“… **Google Calendar Appointment Management** :  \nFull synchronization for creating, updating, canceling, and confirming appointments.\n\n  * ğŸ“‹ **Task Management with Google Tasks** :  \nManages shopping lists and administrative tasks efficiently through staff Telegram requests.\n\n  * ğŸ”” **Automated Appointment Reminders** :  \nDaily-triggered system proactively sends WhatsApp confirmations to patients for next-day appointments.\n\n  * ğŸ–¼ï¸ **Intelligent Media Processing** :  \nTranscribes audios, extracts text from images, and processes documents using OpenAI and OpenRouter AI models.\n\n  * ğŸ›¡ï¸ **Escalation to Human Support** :  \nAutomatically detects sensitive or urgent cases and escalates them to a human agent when needed.\n\n\n\n\n* * *\n\n## ğŸ¥ Use Cases\n\n  * **Patient Communication:**  \nRespond to inquiries, schedule, reschedule, and confirm appointments seamlessly via WhatsApp.\n\n  * **Internal Clinic Operations:**  \nAllow staff to modify appointments or add shopping list reminders directly from Telegram.\n\n  * **Appointment Confirmation System:**  \nAutomatically contacts patients one day prior to appointments for confirmation or rescheduling.\n\n  * **Task and Reminder Management:**  \nKeeps clinic operations organized through automatic task management with Google Tasks.\n\n\n\n\n* * *\n\n## ğŸ› ï¸ Technical Implementation\n\n### WhatsApp Patient Interaction Flow\n\n  * **Webhook Reception:** Incoming WhatsApp messages captured via Evolution API webhook.\n  * **Message Classification:** Intelligent routing of messages based on content type (text, image, audio, document).\n  * **Media Content Processing:**\n    * **Audios:** Download, convert, and transcribe via OpenAI Whisper.\n    * **Images:** Analyze and extract text/descriptions with OpenAI Vision model.\n  * **Patient Request Handling:** Specialized WhatsApp assistant responds appropriately using AI prompts.\n  * **Outbound Message Formatting:** Ensures messages comply with WhatsApp format standards.\n  * **Message Delivery:** Sends responses back via Evolution API.\n\n\n\n### Telegram Staff Management Flow\n\n  * **Telegram Webhook Reception:** Captures messages from authorized staff accounts.\n  * **Internal Assistant Processing:**\n    * **Appointment Rescheduling:** Identifies and updates appointments through MCP Google Calendar.\n    * **Task Creation:** Adds new entries to the clinic's shopping list using Google Tasks.\n  * **Notifications and Confirmations:** Sends confirmations back to staff through Telegram.\n\n\n\n### Appointment Reminder System\n\n  * **Daily Trigger Activation:** Fires every weekday at 08:00 AM.\n  * **Calendar Scraping:** Lists next day's appointments from Google Calendar.\n  * **Patient Contact:** Sends WhatsApp confirmation messages for each appointment.\n  * **Response Management:** Redirects confirmation or rescheduling replies to appropriate agents.\n\n\n\n* * *\n\n## âš™ï¸ Setup Instructions\n\n  1. **Import the Workflow**  \nn8n â†’ Workflows â†’ Import from File â†’ Upload this JSON file.\n\n  2. **Configure Credentials**\n\n     * Evolution API (WhatsApp Communication)\n     * Telegram Bot API (Staff Communication)\n     * Google Calendar OAuth2 (Appointment Management)\n     * Google Tasks OAuth2 (Task Management)\n     * OpenAI and OpenRouter APIs (AI Agents)\n     * PostgreSQL Database (Chat Memory)\n  3. **Set Sensitive Variables**\n\n     * Replace placeholder values: \n       * `{sua instÃ¢ncia aqui}` â†’ Evolution API instance name\n       * `{nÃºmero_whatsapp}` â†’ WhatsApp numbers\n       * `{url_do_servidor}` â†’ Server URLs\n       * `{a sua apikey aqui}` â†’ API keys\n       * `{seu_calendario}` â†’ Google Calendar ID\n  4. **Customize AI Prompts**\n\n     * Adjust system prompts to fit your clinicâ€™s tone, service style, and patient communication guidelines.\n     * Set clinic operating hours, escalation rules, and cancellation procedures in AI prompts.\n  5. **Activate and Test**\n\n     * Simulate patient messages via WhatsApp.\n     * Test Telegram commands from staff members.\n     * Validate daily appointment reminders using the scheduled trigger.\n\n\n\n* * *\n\n## ğŸ·ï¸ Tags\n\n`Healthcare` `Clinic Management` `WhatsApp Integration` `Telegram Bot` `Appointment Scheduling` `Google Calendar` `Google Tasks` `AI Agents` `n8n Automation`\n\n* * *\n\n## ğŸ“š Technical Notes\n\n  * PostgreSQL is used for persistent chat memory across sessions.\n  * Multiple AI Models Used: \n    * **OpenAI GPT-4.1-nano**\n    * **OpenAI GPT-4.1-mini**\n    * **Google Gemini 2.0 and 2.5**\n  * Full media content processing supported (audio, image, text).\n  * Compliant escalation workflows ensure patient safety and proper handoff to human staff when necessary.\n  * All sensitive patient data are securely stored inside calendar event descriptions for easy retrieval by agents.\n\n\n\n* * *\n\n## ğŸ“œ License\n\nThis workflow is provided under the **MIT License**.  \nFeel free to adapt and customize it for your clinicâ€™s specific needs.\n",
  "readme_html": "<!--[--><div data-v-50766329=\"\"><h1>Healthcare Clinic Assistant with WhatsApp and Telegram Integration</h1>\n<p><strong>Version:</strong> 1.1.0<br>\n<strong>n8n Version:</strong> 1.88.0+<br>\n<strong>License:</strong> MIT</p>\n<hr>\n<h2>ğŸ“‹ Description</h2>\n<p>A <strong>comprehensive and modular automation workflow</strong> designed for healthcare clinics.<br>\nIt manages patient communication, appointment scheduling, confirmations, rescheduling, internal tasks, and media processing by integrating <strong>WhatsApp</strong>, <strong>Telegram</strong>, <strong>Google Calendar</strong>, and <strong>Google Tasks</strong>, combined with <strong>AI-powered agents</strong> for maximum efficiency.</p>\n<p>This system guarantees proactive communication with patients, streamlined internal clinic management, and consistent data synchronization across platforms.</p>\n<hr>\n<h2>ğŸŒŸ Key Features</h2>\n<ul>\n<li>\n<p>ğŸ¤– <strong>AI-Powered Specialized Agents</strong>:<br>\nDistinct agents handle WhatsApp patient support, appointment confirmations, and internal rescheduling tasks.</p>\n</li>\n<li>\n<p>ğŸ“± <strong>Omnichannel Communication</strong>:<br>\nHandles patient interactions via WhatsApp and staff commands via Telegram.</p>\n</li>\n<li>\n<p>ğŸ“… <strong>Google Calendar Appointment Management</strong>:<br>\nFull synchronization for creating, updating, canceling, and confirming appointments.</p>\n</li>\n<li>\n<p>ğŸ“‹ <strong>Task Management with Google Tasks</strong>:<br>\nManages shopping lists and administrative tasks efficiently through staff Telegram requests.</p>\n</li>\n<li>\n<p>ğŸ”” <strong>Automated Appointment Reminders</strong>:<br>\nDaily-triggered system proactively sends WhatsApp confirmations to patients for next-day appointments.</p>\n</li>\n<li>\n<p>ğŸ–¼ï¸ <strong>Intelligent Media Processing</strong>:<br>\nTranscribes audios, extracts text from images, and processes documents using OpenAI and OpenRouter AI models.</p>\n</li>\n<li>\n<p>ğŸ›¡ï¸ <strong>Escalation to Human Support</strong>:<br>\nAutomatically detects sensitive or urgent cases and escalates them to a human agent when needed.</p>\n</li>\n</ul>\n<hr>\n<h2>ğŸ¥ Use Cases</h2>\n<ul>\n<li>\n<p><strong>Patient Communication:</strong><br>\nRespond to inquiries, schedule, reschedule, and confirm appointments seamlessly via WhatsApp.</p>\n</li>\n<li>\n<p><strong>Internal Clinic Operations:</strong><br>\nAllow staff to modify appointments or add shopping list reminders directly from Telegram.</p>\n</li>\n<li>\n<p><strong>Appointment Confirmation System:</strong><br>\nAutomatically contacts patients one day prior to appointments for confirmation or rescheduling.</p>\n</li>\n<li>\n<p><strong>Task and Reminder Management:</strong><br>\nKeeps clinic operations organized through automatic task management with Google Tasks.</p>\n</li>\n</ul>\n<hr>\n<h2>ğŸ› ï¸ Technical Implementation</h2>\n<h3>WhatsApp Patient Interaction Flow</h3>\n<ul>\n<li><strong>Webhook Reception:</strong> Incoming WhatsApp messages captured via Evolution API webhook.</li>\n<li><strong>Message Classification:</strong> Intelligent routing of messages based on content type (text, image, audio, document).</li>\n<li><strong>Media Content Processing:</strong>\n<ul>\n<li><strong>Audios:</strong> Download, convert, and transcribe via OpenAI Whisper.</li>\n<li><strong>Images:</strong> Analyze and extract text/descriptions with OpenAI Vision model.</li>\n</ul>\n</li>\n<li><strong>Patient Request Handling:</strong> Specialized WhatsApp assistant responds appropriately using AI prompts.</li>\n<li><strong>Outbound Message Formatting:</strong> Ensures messages comply with WhatsApp format standards.</li>\n<li><strong>Message Delivery:</strong> Sends responses back via Evolution API.</li>\n</ul>\n<h3>Telegram Staff Management Flow</h3>\n<ul>\n<li><strong>Telegram Webhook Reception:</strong> Captures messages from authorized staff accounts.</li>\n<li><strong>Internal Assistant Processing:</strong>\n<ul>\n<li><strong>Appointment Rescheduling:</strong> Identifies and updates appointments through MCP Google Calendar.</li>\n<li><strong>Task Creation:</strong> Adds new entries to the clinic's shopping list using Google Tasks.</li>\n</ul>\n</li>\n<li><strong>Notifications and Confirmations:</strong> Sends confirmations back to staff through Telegram.</li>\n</ul>\n<h3>Appointment Reminder System</h3>\n<ul>\n<li><strong>Daily Trigger Activation:</strong> Fires every weekday at 08:00 AM.</li>\n<li><strong>Calendar Scraping:</strong> Lists next day's appointments from Google Calendar.</li>\n<li><strong>Patient Contact:</strong> Sends WhatsApp confirmation messages for each appointment.</li>\n<li><strong>Response Management:</strong> Redirects confirmation or rescheduling replies to appropriate agents.</li>\n</ul>\n<hr>\n<h2>âš™ï¸ Setup Instructions</h2>\n<ol>\n<li>\n<p><strong>Import the Workflow</strong><br>\nn8n â†’ Workflows â†’ Import from File â†’ Upload this JSON file.</p>\n</li>\n<li>\n<p><strong>Configure Credentials</strong></p>\n<ul>\n<li>Evolution API (WhatsApp Communication)</li>\n<li>Telegram Bot API (Staff Communication)</li>\n<li>Google Calendar OAuth2 (Appointment Management)</li>\n<li>Google Tasks OAuth2 (Task Management)</li>\n<li>OpenAI and OpenRouter APIs (AI Agents)</li>\n<li>PostgreSQL Database (Chat Memory)</li>\n</ul>\n</li>\n<li>\n<p><strong>Set Sensitive Variables</strong></p>\n<ul>\n<li>Replace placeholder values:\n<ul>\n<li><code>{sua instÃ¢ncia aqui}</code> â†’ Evolution API instance name</li>\n<li><code>{nÃºmero_whatsapp}</code> â†’ WhatsApp numbers</li>\n<li><code>{url_do_servidor}</code> â†’ Server URLs</li>\n<li><code>{a sua apikey aqui}</code> â†’ API keys</li>\n<li><code>{seu_calendario}</code> â†’ Google Calendar ID</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><strong>Customize AI Prompts</strong></p>\n<ul>\n<li>Adjust system prompts to fit your clinicâ€™s tone, service style, and patient communication guidelines.</li>\n<li>Set clinic operating hours, escalation rules, and cancellation procedures in AI prompts.</li>\n</ul>\n</li>\n<li>\n<p><strong>Activate and Test</strong></p>\n<ul>\n<li>Simulate patient messages via WhatsApp.</li>\n<li>Test Telegram commands from staff members.</li>\n<li>Validate daily appointment reminders using the scheduled trigger.</li>\n</ul>\n</li>\n</ol>\n<hr>\n<h2>ğŸ·ï¸ Tags</h2>\n<p><code>Healthcare</code> <code>Clinic Management</code> <code>WhatsApp Integration</code> <code>Telegram Bot</code> <code>Appointment Scheduling</code> <code>Google Calendar</code> <code>Google Tasks</code> <code>AI Agents</code> <code>n8n Automation</code></p>\n<hr>\n<h2>ğŸ“š Technical Notes</h2>\n<ul>\n<li>PostgreSQL is used for persistent chat memory across sessions.</li>\n<li>Multiple AI Models Used:\n<ul>\n<li><strong>OpenAI GPT-4.1-nano</strong></li>\n<li><strong>OpenAI GPT-4.1-mini</strong></li>\n<li><strong>Google Gemini 2.0 and 2.5</strong></li>\n</ul>\n</li>\n<li>Full media content processing supported (audio, image, text).</li>\n<li>Compliant escalation workflows ensure patient safety and proper handoff to human staff when necessary.</li>\n<li>All sensitive patient data are securely stored inside calendar event descriptions for easy retrieval by agents.</li>\n</ul>\n<hr>\n<h2>ğŸ“œ License</h2>\n<p>This workflow is provided under the <strong>MIT License</strong>.<br>\nFeel free to adapt and customize it for your clinicâ€™s specific needs.</p>\n</div><!--]-->",
  "readme_zh": "# é›†æˆWhatsAppä¸Telegramçš„åŒ»ç–—è¯Šæ‰€åŠ©æ‰‹\n\n**ç‰ˆæœ¬å·ï¼š** 1.1.0  \n**n8nç‰ˆæœ¬è¦æ±‚ï¼š** 1.88.0+  \n**è®¸å¯åè®®ï¼š** MIT\n\n* * *\n\n## ğŸ“‹ æ–¹æ¡ˆæ¦‚è¿°\n\nä¸€å¥—**æ¨¡å—åŒ–åŒ»ç–—è¯Šæ‰€è‡ªåŠ¨åŒ–å·¥ä½œæµ**ï¼Œé€šè¿‡æ•´åˆ**WhatsApp**ã€**Telegram**ã€**Googleæ—¥å†**å’Œ**Googleä»»åŠ¡**ï¼Œç»“åˆ**AIæ™ºèƒ½ä½“**å®ç°é«˜æ•ˆç®¡ç†ã€‚ç³»ç»Ÿæ¶µç›–æ‚£è€…æ²Ÿé€šã€é¢„çº¦å®‰æ’ã€ç¡®è®¤é€šçŸ¥ã€æ”¹æœŸåè°ƒã€å†…éƒ¨ä»»åŠ¡åŠå¤šåª’ä½“å¤„ç†ç­‰å…¨æµç¨‹ã€‚\n\nè¯¥ç³»ç»Ÿç¡®ä¿ä¸»åŠ¨å¼æ‚£è€…æ²Ÿé€šã€è¯Šæ‰€å†…éƒ¨ç®¡ç†æµç¨‹ä¼˜åŒ–ï¼Œä»¥åŠè·¨å¹³å°æ•°æ®å®æ—¶åŒæ­¥ã€‚\n\n* * *\n\n## ğŸŒŸ æ ¸å¿ƒåŠŸèƒ½\n\n  * ğŸ¤– **ä¸“ä¸šåŒ–AIæ™ºèƒ½ä½“**ï¼š  \nç‹¬ç«‹æ™ºèƒ½ä½“åˆ†åˆ«å¤„ç†WhatsAppæ‚£è€…æ”¯æŒã€é¢„çº¦ç¡®è®¤åŠå†…éƒ¨æ”¹æœŸä»»åŠ¡ã€‚\n\n  * ğŸ“± **å…¨æ¸ é“æ²Ÿé€š**ï¼š  \né€šè¿‡WhatsAppå¤„ç†æ‚£è€…å’¨è¯¢ï¼Œé€šè¿‡Telegramæ¥æ”¶å‘˜å·¥æŒ‡ä»¤ã€‚\n\n  * ğŸ“… **Googleæ—¥å†é¢„çº¦ç®¡ç†**ï¼š  \nå®Œæ•´æ”¯æŒé¢„çº¦åˆ›å»ºã€æ›´æ–°ã€å–æ¶ˆåŠç¡®è®¤çš„åŒæ­¥æœºåˆ¶ã€‚\n\n  * ğŸ“‹ **Googleä»»åŠ¡ç®¡ç†**ï¼š  \né€šè¿‡TelegramæŒ‡ä»¤é«˜æ•ˆç®¡ç†é‡‡è´­æ¸…å•ä¸è¡Œæ”¿ä»»åŠ¡ã€‚\n\n  * ğŸ”” **è‡ªåŠ¨é¢„çº¦æé†’**ï¼š  \næ¯æ—¥è§¦å‘æœºåˆ¶ä¸»åŠ¨å‘æ¬¡æ—¥é¢„çº¦æ‚£è€…å‘é€WhatsAppç¡®è®¤é€šçŸ¥ã€‚\n\n  * ğŸ–¼ï¸ **æ™ºèƒ½åª’ä½“å¤„ç†**ï¼š  \né€šè¿‡OpenAIä¸OpenRouteræ¨¡å‹å®ç°éŸ³é¢‘è½¬å†™ã€å›¾ç‰‡æ–‡å­—æå–åŠæ–‡æ¡£è§£æã€‚\n\n  * ğŸ›¡ï¸ **äººå·¥ä»‹å…¥æœºåˆ¶**ï¼š  \nè‡ªåŠ¨è¯†åˆ«æ•æ„Ÿæˆ–ç´§æ€¥æƒ…å†µï¼Œå¿…è¦æ—¶è½¬æ¥äººå·¥å¤„ç†ã€‚\n\n* * *\n\n## ğŸ¥ åº”ç”¨åœºæ™¯\n\n  * **æ‚£è€…æ²Ÿé€š**ï¼š  \né€šè¿‡WhatsAppæ— ç¼å¤„ç†å’¨è¯¢ã€é¢„çº¦ã€æ”¹æœŸåŠç¡®è®¤ã€‚\n\n  * **è¯Šæ‰€å†…éƒ¨è¿è¥**ï¼š  \nå…è®¸å‘˜å·¥é€šè¿‡Telegramç›´æ¥ä¿®æ”¹é¢„çº¦æˆ–æ·»åŠ é‡‡è´­æé†’ã€‚\n\n  * **é¢„çº¦ç¡®è®¤ç³»ç»Ÿ**ï¼š  \næå‰ä¸€å¤©è‡ªåŠ¨è”ç³»æ‚£è€…è¿›è¡Œé¢„çº¦ç¡®è®¤æˆ–æ”¹æœŸåè°ƒã€‚\n\n  * **ä»»åŠ¡æé†’ç®¡ç†**ï¼š  \né€šè¿‡Googleä»»åŠ¡å®ç°è¯Šæ‰€è¿è¥äº‹åŠ¡çš„è‡ªåŠ¨åŒ–ç®¡ç†ã€‚\n\n* * *\n\n## ğŸ› ï¸ æŠ€æœ¯å®ç°\n\n### WhatsAppæ‚£è€…äº¤äº’æµç¨‹\n\n  * **Webhookæ¥æ”¶**ï¼šé€šè¿‡Evolution APIæ•è·WhatsAppæ¶ˆæ¯\n  * **æ¶ˆæ¯åˆ†ç±»**ï¼šæ ¹æ®å†…å®¹ç±»å‹ï¼ˆæ–‡å­—/å›¾ç‰‡/éŸ³é¢‘/æ–‡æ¡£ï¼‰æ™ºèƒ½è·¯ç”±\n  * **åª’ä½“å¤„ç†**ï¼š\n    * **éŸ³é¢‘**ï¼šä¸‹è½½åé€šè¿‡OpenAI Whisperè½¬å†™\n    * **å›¾ç‰‡**ï¼šä½¿ç”¨OpenAIè§†è§‰æ¨¡å‹è§£ææ–‡å­—\n  * **è¯·æ±‚å¤„ç†**ï¼šä¸“å±WhatsAppåŠ©æ‰‹é€šè¿‡AIç”Ÿæˆå“åº”\n  * **æ¶ˆæ¯æ ¼å¼åŒ–**ï¼šç¡®ä¿ç¬¦åˆWhatsAppæ¶ˆæ¯è§„èŒƒ\n  * **æ¶ˆæ¯å‘é€**ï¼šé€šè¿‡Evolution APIè¿”å›å“åº”\n\n### Telegramå‘˜å·¥ç®¡ç†æµç¨‹\n\n  * **Webhookæ¥æ”¶**ï¼šæ•è·æˆæƒå‘˜å·¥è´¦æˆ·æ¶ˆæ¯\n  * **å†…éƒ¨åŠ©æ‰‹å¤„ç†**ï¼š\n    * **é¢„çº¦æ”¹æœŸ**ï¼šé€šè¿‡Googleæ—¥å†æ¥å£æ›´æ–°\n    * **ä»»åŠ¡åˆ›å»º**ï¼šä½¿ç”¨Google Tasksç®¡ç†é‡‡è´­æ¸…å•\n  * **ç¡®è®¤é€šçŸ¥**ï¼šé€šè¿‡Telegramå‘å‘˜å·¥å‘é€æ“ä½œåé¦ˆ\n\n### é¢„çº¦æé†’ç³»ç»Ÿ\n\n  * **æ¯æ—¥è§¦å‘**ï¼šå·¥ä½œæ—¥08:00è‡ªåŠ¨å¯åŠ¨\n  * **æ—¥å†æ‰«æ**ï¼šè·å–æ¬¡æ—¥é¢„çº¦åˆ—è¡¨\n  * **æ‚£è€…è”ç³»**ï¼šå‘é€WhatsAppç¡®è®¤æ¶ˆæ¯\n  * **å“åº”å¤„ç†**ï¼šå°†ç¡®è®¤/æ”¹æœŸè¯·æ±‚è·¯ç”±è‡³å¯¹åº”å¤„ç†å™¨\n\n* * *\n\n## âš™ï¸ éƒ¨ç½²æŒ‡å—\n\n  1. **å¯¼å…¥å·¥ä½œæµ**  \nn8næ§åˆ¶å° â†’ å·¥ä½œæµ â†’ ä»æ–‡ä»¶å¯¼å…¥ â†’ ä¸Šä¼ æœ¬JSONæ–‡ä»¶\n\n  2. **å‡­è¯é…ç½®**\n     * Evolution APIï¼ˆWhatsAppé€šä¿¡ï¼‰\n     * Telegram Bot APIï¼ˆå‘˜å·¥é€šä¿¡ï¼‰\n     * Googleæ—¥å†OAuth2ï¼ˆé¢„çº¦ç®¡ç†ï¼‰\n     * Googleä»»åŠ¡OAuth2ï¼ˆä»»åŠ¡ç®¡ç†ï¼‰\n     * OpenAIä¸OpenRouter APIï¼ˆAIæ™ºèƒ½ä½“ï¼‰\n     * PostgreSQLæ•°æ®åº“ï¼ˆä¼šè¯è®°å¿†ï¼‰\n\n  3. **æ•æ„Ÿå˜é‡è®¾ç½®**\n     * æ›¿æ¢å ä½ç¬¦ï¼š\n       * `{sua instÃ¢ncia aqui}` â†’ Evolution APIå®ä¾‹å\n       * `{nÃºmero_whatsapp}` â†’ WhatsAppå·ç \n       * `{url_do_servidor}` â†’ æœåŠ¡å™¨åœ°å€\n       * `{a sua apikey aqui}` â†’ APIå¯†é’¥\n       * `{seu_calendario}` â†’ Googleæ—¥å†ID\n\n  4. **AIæç¤ºè¯å®šåˆ¶**\n     * æ ¹æ®è¯Šæ‰€é£æ ¼è°ƒæ•´ç³»ç»Ÿæç¤ºè¯\n     * åœ¨AIæç¤ºä¸­è®¾ç½®è¥ä¸šæ—¶é—´ã€å‡çº§è§„åˆ™ç­‰å‚æ•°\n\n  5. **æµ‹è¯•éªŒè¯**\n     * æ¨¡æ‹ŸWhatsAppæ‚£è€…æ¶ˆæ¯\n     * æµ‹è¯•å‘˜å·¥TelegramæŒ‡ä»¤\n     * éªŒè¯å®šæ—¶é¢„çº¦æé†’åŠŸèƒ½\n\n* * *\n\n## ğŸ·ï¸ æ ‡ç­¾\n\n`åŒ»ç–—å¥åº·` `è¯Šæ‰€ç®¡ç†` `WhatsAppé›†æˆ` `Telegramæœºå™¨äºº` `é¢„çº¦æ’ç¨‹` `Googleæ—¥å†` `Googleä»»åŠ¡` `AIæ™ºèƒ½ä½“` `n8nè‡ªåŠ¨åŒ–`\n\n* * *\n\n## ğŸ“š æŠ€æœ¯è¯´æ˜\n\n  * ä½¿ç”¨PostgreSQLå®ç°è·¨ä¼šè¯è®°å¿†å­˜å‚¨\n  * å¤šAIæ¨¡å‹ååŒï¼š\n    * **OpenAI GPT-4.1-nano**\n    * **OpenAI GPT-4.1-mini**\n    * **Google Gemini 2.0/2.5**\n  * æ”¯æŒå…¨åª’ä½“ç±»å‹å¤„ç†ï¼ˆéŸ³é¢‘/å›¾ç‰‡/æ–‡æœ¬ï¼‰\n  * åˆè§„çš„å‡çº§æµç¨‹ä¿éšœæ‚£è€…å®‰å…¨\n  * æ•æ„Ÿæ•°æ®åŠ å¯†å­˜å‚¨äºæ—¥å†äº‹ä»¶æè¿°å­—æ®µ\n\n* * *\n\n## ğŸ“œ è®¸å¯å£°æ˜\n\næœ¬å·¥ä½œæµåŸºäº**MITè®¸å¯è¯**å‘å¸ƒã€‚  \nå¯æ ¹æ®å®é™…éœ€æ±‚è‡ªç”±ä¿®æ”¹é€‚é…ã€‚",
  "title_zh": "å¤šæ™ºèƒ½ä½“AIè¯Šæ‰€ç®¡ç†ç³»ç»Ÿé›†æˆWhatsAppã€Telegramä¸Googleæ—¥å†",
  "publish_date_zh": "æœ€åæ›´æ–°äº9å¤©å‰",
  "workflow_json_zh": "{\n  \"id\": \"6LeAm5UyENgTdwkv\",\n  \"meta\": {\n    \"instanceId\": \"6d46e25379ef430a7067964d1096b885c773564549240cb3ad4c087f6cf94bd3\",\n    \"templateCredsSetupCompleted\": true\n  },\n  \"name\": \"agente\",\n  \"tags\": [],\n  \"nodes\": [\n    {\n      \"id\": \"84ce6905-4416-4721-8627-f8c303730a4f\",\n      \"name\": \"OpenAI Chat Model1\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\n      \"position\": [\n        8260,\n        2260\n      ],\n      \"parameters\": {\n        \"model\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"gpt-4.1-nano-2025-04-14\",\n          \"cachedResultName\": \"gpt-4.1-nano-2025-04-14\"\n        },\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"zUnIUrOWA279vAoC\",\n          \"name\": \"OpenAi account\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"a6e9358a-a873-49f3-af38-21ca545b2bfc\",\n      \"name\": \"Assistente clinica interno\",\n      \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n      \"position\": [\n        8380,\n        2020\n      ],\n      \"parameters\": {\n        \"text\": \"={{ $json.message.text }}\",\n        \"options\": {\n          \"systemMessage\": \"=Hoje Ã© {{$now}}\\nPAPEL:  \\nVocÃª Ã© um assistente interno de reagendamento na clÃ­nica, acionado diretamente por um profissional via Telegram para gerenciar situaÃ§Ãµes de remarcaÃ§Ã£o de consultas ou incluir lembretes na lista de compras.\\n\\nOBJETIVO GERAL:  \\n1. Reagendar consultas a pedido do profissional.  \\n2. Adicionar lembretes na lista de compras quando solicitado.  \\n\\nRESUMO DE RESPONSABILIDADES:  \\n1. Reagendamento de pacientes  \\n   - Acesse o Google Calendar por meio da ferramenta \\\"MCP Google Calendar\\\" para identificar as consultas afetadas.  \\n   - Extraia o nÃºmero de telefone na descriÃ§Ã£o do evento.  \\n   - Use a ferramenta \\\"Reagendar no WhatsApp\\\" para enviar mensagens de reagendamento aos pacientes.  \\n   - Lembre-se de que vocÃª apenas envia a mensagem; a resposta do paciente Ã© tratada por outro agente.  \\n\\n2. Lista de compras da clÃ­nica  \\n   - Se o profissional solicitar pelo Telegram a inclusÃ£o de um item na lista de compras, utilize a ferramenta \\\"Google Tasks\\\" para adicionar o lembrete.  \\n\\nORIENTAÃ‡Ã•ES DE LINGUAGEM E PROCEDIMENTO:  \\n- Use uma abordagem empÃ¡tica, profissional e acolhedora.  \\n- Nunca envie mensagens para pacientes sem autorizaÃ§Ã£o explÃ­cita do profissional.  \\n- Quando listar eventos ou tarefas, seja objetivo e organizado.  \\n- Mantenha clareza e concisÃ£o em todas as interaÃ§Ãµes.  \\n\\nFERRAMENTAS DISPONÃVEIS:  \\n- Reagendar no WhatsApp  \\n- Google Tasks  \\n- MCP Google Calendar  \\n\\nINSTRUÃ‡Ã•ES FINAIS:  \\n- Atenda exclusivamente Ã s solicitaÃ§Ãµes de reagendamento e inclusÃ£o de lembretes.  \\n- A remarcaÃ§Ã£o de consultas ocorre somente quando o profissional pede, utilizando o MCP Google Calendar para identificar os pacientes e o \\\"Reagendar no WhatsApp\\\" para enviar a mensagem.  \\n- Para a lista de compras, sempre registre no \\\"Google Tasks\\\".  \\n\"\n        },\n        \"promptType\": \"define\"\n      },\n      \"typeVersion\": 1.8\n    },\n    {\n      \"id\": \"d674fb31-cf45-47ac-b33b-4abe1920e352\",\n      \"name\": \"Google Tasks\",\n      \"type\": \"n8n-nodes-base.googleTasksTool\",\n      \"position\": [\n        8720,\n        2320\n      ],\n      \"parameters\": {\n        \"task\": \"bDQ5ZlNVV2lPQ3pYT3NsNA\",\n        \"title\": \"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Title', ``, 'string') }}\",\n        \"additionalFields\": {\n          \"notes\": \"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Notes', ``, 'string') }}\",\n          \"status\": \"needsAction\"\n        }\n      },\n      \"credentials\": {\n        \"googleTasksOAuth2Api\": {\n          \"id\": \"3SQEwHb0AR81JO8y\",\n          \"name\": \"Google Tasks account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"dff00a3c-6496-4104-afc4-a0556f3cabfa\",\n      \"name\": \"MCP Google Calendar\",\n      \"type\": \"@n8n/n8n-nodes-langchain.mcpClientTool\",\n      \"position\": [\n        8560,\n        2320\n      ],\n      \"parameters\": {\n        \"sseEndpoint\": \"https://engaging-seahorse-19.rshare.io/mcp/ceb17fa5-1937-405f-8000-ea3be7d2b032/mcp/:tool/calendar/sse\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"10a0bda3-94b3-487a-98a1-1e7badcc8775\",\n      \"name\": \"Receber Mensagem Telegram\",\n      \"type\": \"n8n-nodes-base.telegramTrigger\",\n      \"position\": [\n        8100,\n        2020\n      ],\n      \"webhookId\": \"f2b29356-d5d3-4f5d-9ef1-273001c0a820\",\n      \"parameters\": {\n        \"updates\": [\n          \"message\"\n        ],\n        \"additionalFields\": {}\n      },\n      \"credentials\": {\n        \"telegramApi\": {\n          \"id\": \"TAVUHrFXuDIMInWe\",\n          \"name\": \"Telegram account\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"46cfa6be-f896-4e33-be3d-b4ef676c043b\",\n      \"name\": \"Postgres Chat Memory\",\n      \"type\": \"@n8n/n8n-nodes-langchain.memoryPostgresChat\",\n      \"position\": [\n        8420,\n        2300\n      ],\n      \"parameters\": {\n        \"sessionKey\": \"100\",\n        \"sessionIdType\": \"customKey\",\n        \"contextWindowLength\": 10\n      },\n      \"credentials\": {\n        \"postgres\": {\n          \"id\": \"t8gw5Kie6Oxy5TcK\",\n          \"name\": \"Postgres account\"\n        }\n      },\n      \"typeVersion\": 1.3\n    },\n    {\n      \"id\": \"c79c44f6-94fa-4e56-9d94-49185f83bfb4\",\n      \"name\": \"OpenAI Chat Model\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\n      \"position\": [\n        5860,\n        3980\n      ],\n      \"parameters\": {\n        \"model\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"gpt-4.1-mini-2025-04-14\",\n          \"cachedResultName\": \"gpt-4.1-mini-2025-04-14\"\n        },\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"zUnIUrOWA279vAoC\",\n          \"name\": \"OpenAi account\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"5e7ac239-6ba1-414c-b11d-d637361e8f77\",\n      \"name\": \"Assistente ClÃ­nica\",\n      \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n      \"position\": [\n        5960,\n        3760\n      ],\n      \"parameters\": {\n        \"text\": \"={{ $json.text }}{{ $json.output}}\",\n        \"options\": {\n          \"systemMessage\": \"=HOJE Ã‰: {{ $now }}\\nCONTATO DA CLÃNICA: \\n{ coloque o seu contato aqui }\\n\\nINSTRUÃ‡ÃƒO IMPORTANTE:\\n\\nAo criar ou editar qualquer evento via MCP_CALENDAR, inclua na descriÃ§Ã£o do agendamento:\\n\\nTelefone do paciente\\n\\nNome completo\\n\\nData de nascimento\\n\\nInformaÃ§Ãµes adicionais (convÃªnio, condiÃ§Ã£o de saÃºde etc.)\\n\\nPAPEL:\\nVocÃª Ã© uma atendente do WhatsApp da ClÃ­nica Moreira, especializada em atendimento humanizado. Sua missÃ£o:\\n\\nAtender pacientes de forma Ã¡gil e eficiente\\n\\nResponder dÃºvidas sobre clÃ­nica e serviÃ§os\\n\\nAgendar, remarcar e cancelar consultas pelo MCP_CALENDAR\\n\\nPERSONALIDADE E TOM DE VOZ:\\n\\nSimpÃ¡tica, acolhedora e respeitosa\\n\\nFormal, sem emojis ou gÃ­rias\\n\\nFERRAMENTAS DISPONÃVEIS:\\n\\nMCP_CALENDAR (trigger /mcp/:tool/calendar)\\n\\nAVALIABILITY_CALENDAR: verifica horÃ¡rios livres entre Start_Time e End_Time\\n\\nGET_ALL_CALENDAR: lista todos os eventos entre After e Before\\n\\nCREATE_CALENDAR: cria novo evento com start, end e Description (inclua sempre telefone, nome e data de nascimento)\\n\\nUPDATE_CALENDAR: atualiza campos de um evento existente (Event_ID)\\n\\nDELETE_CALENDAR: remove evento (Event_ID)\\n\\nGET_CALENDAR: obtÃ©m detalhes de um evento especÃ­fico (Event_ID)\\n\\nCallToHuman (workflow id A95kslcW4H82nJuR)\\n\\nEncaminha atendimento humano via EvolutionAPI em n8n\\n\\nDisparar IMEDIATAMENTE quando:\\n\\nUrgÃªncia ou mal-estar grave\\n\\nPedido de diagnÃ³stico/opiniÃ£o mÃ©dica\\n\\nInsatisfaÃ§Ã£o expressa do paciente\\n\\nAssuntos fora do escopo da clÃ­nica\\n\\nExemplo de chamada:\\n\\n{\\n  \\\"tool\\\": \\\"CallToHuman\\\",\\n  \\\"telefone\\\": \\\"<telefone>\\\",\\n  \\\"nome\\\": \\\"<nome completo>\\\",\\n  \\\"ultima_mensagem\\\": \\\"<texto da Ãºltima mensagem>\\\"\\n}\\n\\nEnviar telegram cancelamento\\n\\nApÃ³s DELETE_CALENDAR, envie ao gestor via Telegram: nome, data, hora\\n\\nSOP (Fluxo de Atendimento):\\n\\nInÃ­cio e coleta de dados\\n\\nCumprimente e informe o link da agenda: https://calendar.google.com/calendar/embed?src=a57a3781407f42b1ad7fe24ce76f558dc6c86fea5f349b7fd39747a2294c1654%40group.calendar.google.com&ctz=America%2FArgentina%2FBuenos_Aires\\n\\nPeÃ§a: nome completo, data de nascimento e confirme o telefone\\n number: {{ $('Webhook1').item.json.body.data.key.remoteJid.replaceAll(\\\"@s.whatsapp.net\\\",\\\"\\\") }}\\n\\nVerificaÃ§Ã£o de disponibilidade\\n\\nPergunte data e turno preferidos\\n\\nChame AVALIABILITY_CALENDAR com Start_Time 08:00 e End_Time 19:00 (ou turno)\\n\\nInforme horÃ¡rios livres\\n\\nAgendamento\\n\\nApÃ³s escolha do paciente, use CREATE_CALENDAR com start, end e Description\\n\\nAguarde retorno para confirmar criaÃ§Ã£o antes de responder\\n\\nRemarcaÃ§Ã£o\\n\\nSolicite dados e nova preferÃªncia de data/turno\\n\\nLocalize evento antigo via GET_ALL_CALENDAR\\n\\nUse DELETE_CALENDAR no Event_ID antigo\\n\\nCrie novo com CREATE_CALENDAR\\n\\nConfirme apÃ³s sucesso\\n\\nCancelamento\\n\\nSolicite dados do paciente\\n\\nIdentifique Event_ID via GET_ALL_CALENDAR ou GET_CALENDAR\\n\\nExecute DELETE_CALENDAR\\n\\nUse Enviar telegram cancelamento\\n\\nConfirme cancelamento ao paciente\\n\\nConfirmaÃ§Ã£o de consulta (follow-up)\\n\\nSe paciente responder â€œConfirmar, IDâ€: use UPDATE_CALENDAR para prefixar tÃ­tulo com [Confirmado]\\n\\nSe â€œReagendar, IDâ€: DELETE_CALENDAR e oriente para usar link da agenda\\n\\nREGRAS DE ESCALONAMENTO:\\n\\nUse CallToHuman IMEDIATAMENTE em situaÃ§Ãµes de:\\n\\nUrgÃªncia/mal-estar\\n\\nPedidos de diagnÃ³stico/opiniÃ£o mÃ©dica\\n\\nInsatisfaÃ§Ã£o ou reclamaÃ§Ãµes\\n\\nAssuntos fora do escopo\\n\\nMANTENHA SEMPRE:\\n\\nTom profissional e respeitoso\\n\\nLinguagem clara e objetiva\\n\\nAgendamentos apenas em datas futuras\\n\\nNunca confirmar sem retorno do MCP_CALENDAR\\n\\nHORÃRIOS DE FUNCIONAMENTO:\\n\\nSegâ€“SÃ¡b: 08hâ€“19h | Dom e feriados: fechado\\n\\nLOCALIZAÃ‡ÃƒO:\\nRua Rio Casca, 417 â€“ Belo Horizonte, MG\\n\\nLINK DA AGENDA:\\nhttps://calendar.google.com/calendar/embed?src=a57a3781407f42b1ad7fe24ce76f558dc6c86fea5f349b7fd39747a2294c1654%40group.calendar.google.com&ctz=America%2FArgentina%2FBuenos_Aires\\n\\n\"\n        },\n        \"promptType\": \"define\"\n      },\n      \"retryOnFail\": true,\n      \"typeVersion\": 1.8,\n      \"waitBetweenTries\": 1000\n    },\n    {\n      \"id\": \"2f0a6ea1-7654-4ae7-884e-d5b8ff47d4f9\",\n      \"name\": \"Enviar alerta de cancelamento\",\n      \"type\": \"n8n-nodes-base.telegramTool\",\n      \"position\": [\n        6400,\n        3980\n      ],\n      \"webhookId\": \"d045a8c1-ec1b-4d20-8226-457aa18934af\",\n      \"parameters\": {\n        \"text\": \"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Text', ``, 'string') }}\",\n        \"chatId\": \"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Chat_ID', ``, 'string') }}\",\n        \"additionalFields\": {}\n      },\n      \"credentials\": {\n        \"telegramApi\": {\n          \"id\": \"TAVUHrFXuDIMInWe\",\n          \"name\": \"Telegram account\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"8ddaa14f-7d2f-4364-8ff7-f87e0a428e37\",\n      \"name\": \"Gatilho diÃ¡rio\",\n      \"type\": \"n8n-nodes-base.scheduleTrigger\",\n      \"position\": [\n        8060,\n        2780\n      ],\n      \"parameters\": {\n        \"rule\": {\n          \"interval\": [\n            {\n              \"field\": \"cronExpression\",\n              \"expression\": \"0 8 * * 1-5\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"0784753d-123d-4259-abcc-8abf39e7fc07\",\n      \"name\": \"Assistente de confirmaÃ§Ã£o\",\n      \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n      \"position\": [\n        8280,\n        2680\n      ],\n      \"parameters\": {\n        \"text\": \"=Hoje Ã© {{ $now }}. VocÃª Ã© um agente especializado em **confirmaÃ§Ã£o de consultas** para a clÃ­nica. Sua funÃ§Ã£o principal Ã©:\\n\\n1. **Listar os eventos** agendados para o prÃ³ximo dia no MCP Calendar.\\n2. **Obter o numero** na descriÃ§Ã£o de cada evento.\\n3. **Enviar uma mensagem de confirmaÃ§Ã£o** usando a ferramenta â€œrelembraAGENDAMENTOâ€, perguntando se o paciente confirma a consulta ou prefere reagendar.\\n\\nImportante:\\n- VocÃª **nÃ£o recebe respostas** diretamente; o retorno do paciente Ã© tratado por outro agente.\\n\\n\",\n        \"options\": {\n          \"systemMessage\": \"\"\n        },\n        \"promptType\": \"define\"\n      },\n      \"typeVersion\": 1.8\n    },\n    {\n      \"id\": \"afa90e86-0f44-4069-976b-ca302b0d828a\",\n      \"name\": \"AI Agent\",\n      \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n      \"position\": [\n        5840,\n        4460\n      ],\n      \"parameters\": {\n        \"text\": \"={{ $json.output }}\",\n        \"options\": {\n          \"systemMessage\": \"=VocÃª Ã© especialista em formataÃ§Ã£o de mensagem para whataspp, trabalhando somente na formataÃ§Ã£o e nÃ£o alterando o conteÃºdo da menssagem.\\n\\n- Substitua ** por *\\n- Remova #\"\n        },\n        \"promptType\": \"define\"\n      },\n      \"typeVersion\": 1.8\n    },\n    {\n      \"id\": \"13179a70-85b6-4e18-8736-eb2cdd252591\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        6960,\n        2580\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 1940,\n        \"height\": 600,\n        \"content\": \"# \\\"é¢„çº¦ç¡®è®¤åŠ©æ‰‹\\\"\\nåŠŸèƒ½æè¿°ï¼š\\n\\nç”¨é€”ï¼š\\næœ¬æ¨¡å—ç”¨äºé…ç½®\\\"é¢„çº¦ç¡®è®¤åŠ©æ‰‹\\\"ï¼Œè¿™æ˜¯ä¸€ä¸ªä¸“é—¨ç”¨äºä¸æ‚£è€…ç¡®è®¤å·²é¢„çº¦æ—¶é—´çš„æ™ºèƒ½ä»£ç†ã€‚\\n\\nä½¿ç”¨è¯´æ˜ï¼š\\n\\nè¯¥ä»£ç†ä¼šé€šè¿‡æ¯æ—¥è§¦å‘å™¨ï¼ˆGatilho diÃ¡rioï¼‰åœ¨æ¯ä¸ªå·¥ä½œæ—¥ï¼ˆå‘¨ä¸€è‡³å‘¨äº”ï¼‰ä¸Šåˆ08:00è‡ªåŠ¨æ¿€æ´»ã€‚\\n\\nä»£ç†å°†é€šè¿‡MCPè°·æ­Œæ—¥å†è·å–æ¬¡æ—¥æ‰€æœ‰é¢„çº¦å®‰æ’ã€‚\\n\\nä»äº‹ä»¶æè¿°å­—æ®µä¸­æå–æ¯ä½æ‚£è€…çš„è”ç³»ç”µè¯å·ç ã€‚\\n\\nä½¿ç”¨relembraAGENDAMENTOå·¥å…·å‘æ¯ä½æ‚£è€…å‘é€ç¡®è®¤ä¿¡æ¯ï¼Œè¯¢é—®æ˜¯å¦ç¡®è®¤é¢„çº¦æˆ–éœ€è¦æ”¹æœŸã€‚\\n\\né‡è¦æç¤ºï¼šæœ¬ä»£ç†ä¸å¤„ç†æ‚£è€…å›å¤ï¼Œåç»­è·Ÿè¿›ç”±å…¶ä»–ä»£ç†æˆ–å·¥ä½œæµç¨‹è´Ÿè´£ã€‚\\n\\nè¯·ç¡®ä¿è°·æ­Œæ—¥å†ä¸­çš„äº‹ä»¶æè¿°ä¿¡æ¯å¡«å†™å®Œæ•´å‡†ç¡®ï¼Œä»¥é¿å…å‡ºç°é”™è¯¯ã€‚\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"4111432b-2ddc-4e96-ba6d-d25e003e2688\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        4760,\n        3620\n      ],\n      \"parameters\": {\n        \"color\": 3,\n        \"width\": 1780,\n        \"height\": 640,\n        \"content\": \"# \\\"æ™ºèƒ½ä½“æ ¸å¿ƒç»„ä»¶ï¼ˆå·¥å…·ã€MCPã€è®°å¿†ã€LLMæ¨¡å‹ï¼‰\\\"\\nåŠŸèƒ½è¯´æ˜ï¼š\\n\\nç”¨é€”ï¼š\\n\\næœ¬ä¾¿ç­¾ä»£è¡¨æ™ºèƒ½ä½“çš„åŸºç¡€æ¶æ„ï¼šåŒ…å«å¤–éƒ¨å·¥å…·è°ƒç”¨æ¥å£ã€æŒä¹…åŒ–è®°å¿†ç³»ç»Ÿã€ç”¨äºæ—¥å†ç®¡ç†çš„MCPç³»ç»Ÿï¼Œä»¥åŠå¤„ç†è‡ªç„¶è¯­è¨€ä»»åŠ¡çš„å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰ã€‚\\n\\nä½¿ç”¨æŒ‡å—ï¼š\\n\\nè¯­è¨€æ¨¡å‹èŠ‚ç‚¹ï¼ˆå¦‚OpenAIã€OpenRouterï¼‰è´Ÿè´£è‡ªç„¶è¯­è¨€ç†è§£ä¸ç”Ÿæˆã€‚\\n\\nè®°å¿†èŠ‚ç‚¹ï¼ˆPostgresèŠå¤©è®°å¿†åº“ï¼‰ç»´æŠ¤è·¨å¤šæ¬¡äº¤äº’çš„ä¼šè¯ä¸Šä¸‹æ–‡ã€‚\\n\\nMCPå·¥å…·æ¨¡å—å¯æ“ä½œGoogleæ—¥å†ç­‰å¤–éƒ¨æœåŠ¡æ‰§è¡Œç°å®ä»»åŠ¡ã€‚\\n\\nå¿…é¡»å§‹ç»ˆä¿æŒæ™ºèƒ½ä½“ä¸Šä¸‹æ–‡ä¸å·²æ‰§è¡Œæ“ä½œé—´çš„è®°å¿†åŒæ­¥ã€‚\\n\\næ–°å¢å·¥å…·æ—¶ï¼Œéœ€åŒæ—¶æ¥å…¥æ™ºèƒ½ä½“ç³»ç»Ÿå¹¶åœ¨ç³»ç»Ÿæ¶ˆæ¯ä¸­å®Œå–„åŠŸèƒ½æè¿°ã€‚\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"4b59f903-07c2-4e66-9ea1-0727beb0d85c\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        4640,\n        4300\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 1800,\n        \"height\": 640,\n        \"content\": \"# \\\"å¤„ç†å¹¶å‘é€WhatsAppå›å¤\\\"\\nåŠŸèƒ½è¯´æ˜ï¼š\\n\\nç”¨é€”ï¼š\\næœ¬æ¨¡å—è´Ÿè´£é€šè¿‡Evolution APIå¯¹æ‚£è€…å¤–å‘çš„WhatsAppæ¶ˆæ¯è¿›è¡Œå¤„ç†ã€æ ¼å¼åŒ–å’Œå‘é€ã€‚\\n\\nä½¿ç”¨æŒ‡å—ï¼š\\n\\n1. ä»åŠ©ç†æ¥æ”¶åˆ°çš„æ¶ˆæ¯ä¼šå…ˆç»è¿‡AIä»£ç†èŠ‚ç‚¹é‡æ–°æ ¼å¼åŒ–ï¼Œä»¥ç¬¦åˆWhatsAppæ ‡è®°è¯­æ³•ï¼ˆä¾‹å¦‚å°†**åŠ ç²—**è½¬æ¢ä¸º*åŠ ç²—*ï¼‰\\n\\n2. æ ¼å¼åŒ–å®Œæˆåï¼Œæ¶ˆæ¯å°†é€šè¿‡Evolution API2èŠ‚ç‚¹è½¬å‘è‡³WhatsApp\\n\\n3. å‘é€å‰è¯·ç¡®ä¿æ ¼å¼æ­£ç¡®ï¼Œä»¥ä¿æŒä¸“ä¸šæ²Ÿé€šè¯­æ°”å¹¶é¿å…æŠ•é€’é”™è¯¯\\n\\n4. æ‰€æœ‰åç»­çš„æ–‡å­—å¤„ç†ä¼˜åŒ–éƒ½åº”åœ¨æ­¤æ¨¡å—å®æ–½\\n\\nï¼ˆæ³¨ï¼šæ ¹æ®æŠ€æœ¯æ–‡æ¡£ç¿»è¯‘è§„èŒƒï¼Œä¿ç•™ä¸“ä¸šæœ¯è¯­\\\"Evolution API\\\"ä¸è¯‘ï¼›\\\"markdown syntax\\\"è¯‘ä¸º\\\"æ ‡è®°è¯­æ³•\\\"ç¬¦åˆä¸­æ–‡æŠ€æœ¯è¯­å¢ƒï¼›å°†è‹±æ–‡é•¿å¥æ‹†åˆ†ä¸ºç¬¦åˆä¸­æ–‡é˜…è¯»ä¹ æƒ¯çš„çŸ­å¥ç»“æ„ï¼›\\\"outbound messages\\\"è¯‘ä¸º\\\"å¤–å‘æ¶ˆæ¯\\\"å‡†ç¡®ä¼ è¾¾ä¸šåŠ¡åœºæ™¯ï¼‰\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"274f7f66-7613-4e9e-868d-a5705156dde6\",\n      \"name\": \"Postgres Chat Memory1\",\n      \"type\": \"@n8n/n8n-nodes-langchain.memoryPostgresChat\",\n      \"position\": [\n        6000,\n        3980\n      ],\n      \"parameters\": {\n        \"sessionKey\": \"= {{ $('Webhook1').item.json.body.data.key.id }}\",\n        \"sessionIdType\": \"customKey\",\n        \"contextWindowLength\": 50\n      },\n      \"credentials\": {\n        \"postgres\": {\n          \"id\": \"t8gw5Kie6Oxy5TcK\",\n          \"name\": \"Postgres account\"\n        }\n      },\n      \"typeVersion\": 1.3\n    },\n    {\n      \"id\": \"654ed617-df1a-48db-b9bc-833b2c1ecb80\",\n      \"name\": \"MCP Google Calendar2\",\n      \"type\": \"@n8n/n8n-nodes-langchain.mcpClientTool\",\n      \"position\": [\n        6120,\n        3980\n      ],\n      \"parameters\": {\n        \"sseEndpoint\": \"https://engaging-seahorse-19.rshare.io/mcp/ceb17fa5-1937-405f-8000-ea3be7d2b032/mcp/:tool/calendar/sse\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"b11aeec6-b446-4c02-a0b0-7f9239628df3\",\n      \"name\": \"MCP GMAIL\",\n      \"type\": \"@n8n/n8n-nodes-langchain.mcpClientTool\",\n      \"position\": [\n        8540,\n        3000\n      ],\n      \"parameters\": {\n        \"sseEndpoint\": \"https://engaging-seahorse-19.rshare.io/mcp/82a7a338-618c-44f5-a1c3-f2e32b6b4833/mcp/:tool/gmail/sse\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"f5a38b34-499e-4bbc-9282-ce5f4a3b85a3\",\n      \"name\": \"MCP CALENDAR\",\n      \"type\": \"@n8n/n8n-nodes-langchain.mcpClientTool\",\n      \"position\": [\n        8380,\n        3000\n      ],\n      \"parameters\": {\n        \"sseEndpoint\": \"https://engaging-seahorse-19.rshare.io/mcp/ceb17fa5-1937-405f-8000-ea3be7d2b032/mcp/:tool/calendar/sse\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"cd6a6147-fd18-4cd4-8aab-fcb454ab76b7\",\n      \"name\": \"Telegram\",\n      \"type\": \"n8n-nodes-base.telegram\",\n      \"position\": [\n        8740,\n        2020\n      ],\n      \"webhookId\": \"5bba05fc-2859-4225-aa85-7c4bc5ff532d\",\n      \"parameters\": {\n        \"text\": \"={{ $json.output }}\",\n        \"chatId\": \"={{ $('Receber Mensagem Telegram').item.json.message.chat.id }}\",\n        \"additionalFields\": {}\n      },\n      \"credentials\": {\n        \"telegramApi\": {\n          \"id\": \"TAVUHrFXuDIMInWe\",\n          \"name\": \"Telegram account\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"900b8c1a-f987-4898-9fc1-bfc673773e06\",\n      \"name\": \"OpenRouter Chat Model1\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatOpenRouter\",\n      \"position\": [\n        5760,\n        4680\n      ],\n      \"parameters\": {\n        \"model\": \"google/gemini-2.0-flash-exp:free\",\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"openRouterApi\": {\n          \"id\": \"eGPA8rbskZCfFPBn\",\n          \"name\": \"OpenRouter account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"1584b448-d8f5-4bab-ad9a-9b07edb8e102\",\n      \"name\": \"Webhook1\",\n      \"type\": \"n8n-nodes-base.webhook\",\n      \"position\": [\n        5760,\n        2100\n      ],\n      \"webhookId\": \"405dab7c-a0ea-4f5b-a6cc-ede9d5ba78a0\",\n      \"parameters\": {\n        \"path\": \"evolutionAPIKORE\",\n        \"options\": {},\n        \"httpMethod\": \"POST\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"74b5179f-502c-45d6-88e9-2c2d492603cd\",\n      \"name\": \"Edit Fields1\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        6000,\n        2100\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"3e6335ae-74c3-4655-b68f-cdf0c68b864f\",\n              \"name\": \"number\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.data.key.remoteJid }}\"\n            },\n            {\n              \"id\": \"15f399cf-a98e-45e7-91ce-61b4fad340fd\",\n              \"name\": \"name\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.data.pushName }}\"\n            },\n            {\n              \"id\": \"b1943003-1f47-40e1-b418-6a52557ec44e\",\n              \"name\": \"key_id\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.data.key.id }}\"\n            },\n            {\n              \"id\": \"ed23194b-22ca-455b-a085-7dae706d0569\",\n              \"name\": \"text\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.data.message.conversation }}\"\n            },\n            {\n              \"id\": \"b35f8b61-da15-42e3-a078-4cd901e1f273\",\n              \"name\": \"type\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.data.message.imageMessage.mimetype }}\"\n            },\n            {\n              \"id\": \"a62bf96a-51aa-44c3-9e5d-f592e32a31d6\",\n              \"name\": \"image.url\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.data.message.imageMessage.url }}\"\n            },\n            {\n              \"id\": \"b004987d-3527-4040-a5e6-5fe06b25c9b9\",\n              \"name\": \"audio.url\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.data.message.audioMessage.url }}\"\n            },\n            {\n              \"id\": \"4c2cc03a-c104-4a87-9d31-6a7c256890ad\",\n              \"name\": \"document.url\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.data.message.documentMessage.url }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"ce22f5bc-f0e1-463d-9b9a-5112f8d91f00\",\n      \"name\": \"Switch\",\n      \"type\": \"n8n-nodes-base.switch\",\n      \"position\": [\n        6240,\n        2080\n      ],\n      \"parameters\": {\n        \"rules\": {\n          \"values\": [\n            {\n              \"outputKey\": \"text\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"2f9854ac-26b3-446c-9d0d-ae25157c61bb\",\n                    \"operator\": {\n                      \"type\": \"string\",\n                      \"operation\": \"notEmpty\",\n                      \"singleValue\": true\n                    },\n                    \"leftValue\": \"={{ $json.text }}\",\n                    \"rightValue\": \"=\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            },\n            {\n              \"outputKey\": \"image\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"73b7d93a-928e-42ec-9c8e-ae8e9b97a867\",\n                    \"operator\": {\n                      \"type\": \"string\",\n                      \"operation\": \"notEmpty\",\n                      \"singleValue\": true\n                    },\n                    \"leftValue\": \"={{ $json.image.url }}\",\n                    \"rightValue\": \"=\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            },\n            {\n              \"outputKey\": \"audio\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"2f9915b9-e2b4-4528-ad36-515a848ab1be\",\n                    \"operator\": {\n                      \"type\": \"string\",\n                      \"operation\": \"notEmpty\",\n                      \"singleValue\": true\n                    },\n                    \"leftValue\": \"={{ $json.audio.url }}\",\n                    \"rightValue\": \"[null]\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            },\n            {\n              \"outputKey\": \"document\",\n              \"conditions\": {\n                \"options\": {\n                  \"version\": 2,\n                  \"leftValue\": \"\",\n                  \"caseSensitive\": true,\n                  \"typeValidation\": \"strict\"\n                },\n                \"combinator\": \"and\",\n                \"conditions\": [\n                  {\n                    \"id\": \"9fcbe89a-c9d7-4dc6-bb6f-27c1cacbfddc\",\n                    \"operator\": {\n                      \"type\": \"string\",\n                      \"operation\": \"notEmpty\",\n                      \"singleValue\": true\n                    },\n                    \"leftValue\": \"={{ $json.document.url }}\",\n                    \"rightValue\": \"[null]\"\n                  }\n                ]\n              },\n              \"renameOutput\": true\n            }\n          ]\n        },\n        \"options\": {}\n      },\n      \"typeVersion\": 3.2\n    },\n    {\n      \"id\": \"c78ee758-fb71-4a4f-9450-0ffcd67a2af2\",\n      \"name\": \"Sticky Note5\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        4960,\n        1840\n      ],\n      \"parameters\": {\n        \"color\": 6,\n        \"width\": 1580,\n        \"height\": 640,\n        \"content\": \"# WhatsApp ç½‘é¡µé’©å­æ¥å…¥ä¸æ¶ˆæ¯ç±»å‹å¤„ç†\\\"\\nåŠŸèƒ½æè¿°ï¼š\\n\\næ ¸å¿ƒç”¨é€”ï¼š\\né€šè¿‡ç½‘é¡µé’©å­ç³»ç»Ÿæ¥æ”¶å¹¶åˆ†ç±»å¤„ç†æ¥è‡ªæ‚£è€…çš„WhatsAppæ¶ˆæ¯ã€‚\\n\\næ“ä½œæŒ‡å—ï¼š\\n\\n1. Webhook1èŠ‚ç‚¹è´Ÿè´£æ•è·æ‰€æœ‰æ¥å…¥æ¶ˆæ¯\\n2. Edit Fields1æ¨¡å—æå–ç»“æ„åŒ–å­—æ®µï¼ˆåŒ…æ‹¬æ–‡æœ¬/å›¾ç‰‡é“¾æ¥/éŸ³é¢‘é“¾æ¥/æ–‡æ¡£é“¾æ¥ï¼‰\\n3. SwitchèŠ‚ç‚¹è‡ªåŠ¨è¯†åˆ«å†…å®¹ç±»å‹å¹¶åˆ†æµå¤„ç†ï¼š\\n   - æ–‡æœ¬æ¶ˆæ¯ â†’ è½¬äº¤åŠ©æ‰‹å¤„ç†\\n   - å›¾ç‰‡ â†’ å‘é€è‡³OCRè¯†åˆ«æ¨¡å—\\n   - è¯­éŸ³ â†’ æäº¤è½¬æ–‡å­—æœåŠ¡\\n   - æ–‡ä»¶ â†’ (é¢„ç•™æœªæ¥å·¥ä½œæµæ¥å£)\\n\\nç³»ç»Ÿç»´æŠ¤ï¼š\\néœ€å®šæœŸæ›´æ–°ç½‘é¡µé’©å­å‡­è¯ä»¥ç¡®ä¿æœåŠ¡ç¨³å®šæ€§\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"83abbf61-91e2-4d1c-a42a-4f05b18583e7\",\n      \"name\": \"OpenAI\",\n      \"type\": \"@n8n/n8n-nodes-langchain.openAi\",\n      \"position\": [\n        6380,\n        3260\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"resource\": \"audio\",\n        \"operation\": \"transcribe\",\n        \"binaryPropertyName\": \"=data\"\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"zUnIUrOWA279vAoC\",\n          \"name\": \"OpenAi account\"\n        }\n      },\n      \"typeVersion\": 1.8\n    },\n    {\n      \"id\": \"4c2dcefc-fb65-42ca-8c63-8636f2906654\",\n      \"name\": \"Evolution API\",\n      \"type\": \"n8n-nodes-evolution-api.evolutionApi\",\n      \"position\": [\n        5860,\n        3260\n      ],\n      \"parameters\": {\n        \"resource\": \"chat-api\",\n        \"messageId\": \"={{ $json.key_id }}\",\n        \"operation\": \"get-media-base64\",\n        \"convertToMp4\": true,\n        \"instanceName\": \"={{ $('Webhook1').item.json.body.instance }}\"\n      },\n      \"credentials\": {\n        \"evolutionApi\": {\n          \"id\": \"fPKdX0EITLV8HI89\",\n          \"name\": \"Evolution account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"85909834-7564-478b-bce8-0c3fe7bf4159\",\n      \"name\": \"Convert to File\",\n      \"type\": \"n8n-nodes-base.convertToFile\",\n      \"position\": [\n        6100,\n        3260\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"operation\": \"toBinary\",\n        \"sourceProperty\": \"data.base64\"\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"3e200157-fbcc-4225-b982-2dfaea54cc23\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        4980,\n        3100\n      ],\n      \"parameters\": {\n        \"width\": 1760,\n        \"height\": 480,\n        \"content\": \"## \\\"ä¸‹è½½éŸ³é¢‘å¹¶è½¬æ¢ä¸ºMP4\\\"\\nåŠŸèƒ½è¯´æ˜ï¼š\\n\\nç”¨é€”ï¼š\\nå¤„ç†æ‚£è€…é€šè¿‡WhatsAppå‘é€çš„éŸ³é¢‘æ–‡ä»¶çš„è·å–ã€è½¬æ¢åŠæ–‡å­—è½¬å½•ã€‚\\n\\nä½¿ç”¨æŒ‡å—ï¼š\\n\\n1. Evolution APIä»¥base64æ ¼å¼ä¸‹è½½éŸ³é¢‘æ–‡ä»¶\\n2. é€šè¿‡\\\"è½¬æ¢ä¸ºæ–‡ä»¶\\\"åŠŸèƒ½å°†base64æ•°æ®è½¬ç ä¸ºè½¬å½•å¼•æ“å…¼å®¹çš„äºŒè¿›åˆ¶æ–‡ä»¶\\n3. OpenAI Whisper APIï¼ˆç»ç”±OpenAIèŠ‚ç‚¹ï¼‰å°†éŸ³é¢‘è½¬å½•ä¸ºæ–‡æœ¬ï¼Œä¸ºè‡ªç„¶è¯­è¨€å¤„ç†ä½œå‡†å¤‡\\n\\næ³¨æ„äº‹é¡¹ï¼š\\nâ€¢ ç¡®ä¿æ­£ç¡®å¤„ç†éŸ³é¢‘æ ¼å¼ï¼ˆå¦‚MP4/MP3ï¼‰ä»¥é¿å…è½¬ç æˆ–è½¬å½•å¤±è´¥\\nâ€¢ æ³¨æ„ç›‘æ§å¤§æ–‡ä»¶ï¼ˆ>25MBï¼‰å¯èƒ½å¯¼è‡´çš„æ€§èƒ½é—®é¢˜\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"5862d5f1-2df4-40ee-881f-a6d6e302602f\",\n      \"name\": \"Sticky Note6\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        4920,\n        2540\n      ],\n      \"parameters\": {\n        \"width\": 1820,\n        \"height\": 480,\n        \"content\": \"# \\\"ä»å›¾ç‰‡ä¸­æå–æ–‡å­—\\\"\\nåŠŸèƒ½æè¿°ï¼š\\n\\nç”¨é€”ï¼š\\nå¤„ç†é€šè¿‡WhatsAppæ¥æ”¶çš„å›¾ç‰‡ï¼Œæå–å…¶ä¸­æ–‡å­—ï¼ˆOCRï¼‰å¹¶æè¿°è§†è§‰å†…å®¹ï¼Œä»¥ä¾¿è¿›è¡Œåç»­æƒ…å¢ƒåˆ†æã€‚\\n\\nä½¿ç”¨è¯´æ˜ï¼š\\n\\n1. OpenAI1èŠ‚ç‚¹é‡‡ç”¨è§†è§‰æ¨¡å‹ï¼Œå¯è½¬å½•å¹¶æè¿°è¾“å…¥å›¾ç‰‡ä¸­çš„ä»»ä½•æ–‡å­—æˆ–åœºæ™¯å†…å®¹ã€‚\\n\\n2. AIæ™ºèƒ½ä½“2ä¼šå¯¹ç”Ÿæˆçš„æ•°æ®è¿›è¡Œè§£è¯»ï¼Œå‡†å¤‡åˆ†æè§è§£å¹¶æ¨èåˆé€‚çš„å“åº”æ–¹æ¡ˆã€‚\\n\\n3. è¯¥å›¾ç‰‡è½¬æ–‡å­—åŠŸèƒ½ç‰¹åˆ«é€‚ç”¨äºå¤„ç†æ‚£è€…å‘é€çš„å¤„æ–¹ã€ç¬”è®°æˆ–åŒ»ç–—æ–‡ä»¶ç­‰åœºæ™¯ã€‚\\n\\nè´¨é‡è¦æ±‚ï¼šä¸ºä¿è¯æœ€ä½³è½¬å½•æ•ˆæœï¼Œå›¾ç‰‡å¿…é¡»æ¸…æ™°ä¸”ä¸ºé«˜åˆ†è¾¨ç‡ã€‚\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"8dbd4e6d-8b38-44d8-ba45-5cac2713f6ca\",\n      \"name\": \"OpenAI1\",\n      \"type\": \"@n8n/n8n-nodes-langchain.openAi\",\n      \"position\": [\n        5980,\n        2620\n      ],\n      \"parameters\": {\n        \"text\": \"TRANSCRIBE OS TEXTOS e describe a imagem\",\n        \"modelId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"chatgpt-4o-latest\",\n          \"cachedResultName\": \"CHATGPT-4O-LATEST\"\n        },\n        \"options\": {},\n        \"resource\": \"image\",\n        \"imageUrls\": \"={{ $json.image }}\",\n        \"operation\": \"analyze\"\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"zUnIUrOWA279vAoC\",\n          \"name\": \"OpenAi account\"\n        }\n      },\n      \"typeVersion\": 1.8\n    },\n    {\n      \"id\": \"19e8d50d-4f87-408e-96f0-236932c1d120\",\n      \"name\": \"AI Agent2\",\n      \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n      \"position\": [\n        6200,\n        2620\n      ],\n      \"parameters\": {\n        \"text\": \"={{$json.output}}\",\n        \"options\": {\n          \"systemMessage\": \"voce e encarregado de analizar o texto proveniente do analisis de uma iamgem ela pode conter texto, a ideia e que voce explique ao proximo agente como debe responder as mensagens\"\n        },\n        \"promptType\": \"define\"\n      },\n      \"typeVersion\": 1.9\n    },\n    {\n      \"id\": \"0d2f9842-b011-49f5-9594-24a917dee60e\",\n      \"name\": \"OpenRouter Chat Model2\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatOpenRouter\",\n      \"position\": [\n        6100,\n        2860\n      ],\n      \"parameters\": {\n        \"model\": \"google/gemini-2.5-pro-exp-03-25:free\",\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"openRouterApi\": {\n          \"id\": \"eGPA8rbskZCfFPBn\",\n          \"name\": \"OpenRouter account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"58f7f9c7-6f86-40ff-bfad-5467e5b3a9e4\",\n      \"name\": \"Evolution API2\",\n      \"type\": \"n8n-nodes-evolution-api.evolutionApi\",\n      \"position\": [\n        6200,\n        4460\n      ],\n      \"parameters\": {\n        \"resource\": \"messages-api\",\n        \"remoteJid\": \"={{ $('Webhook1').item.json.body.data.key.remoteJid }}\",\n        \"messageText\": \"={{$json.output}}\",\n        \"instanceName\": \"={{ $('Webhook1').item.json.body.instance }}\",\n        \"options_message\": {}\n      },\n      \"credentials\": {\n        \"evolutionApi\": {\n          \"id\": \"fPKdX0EITLV8HI89\",\n          \"name\": \"Evolution account\"\n        }\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"2b529ab1-2a7e-44e0-b7c8-ed05e07c6def\",\n      \"name\": \"Sticky Note4\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        6960,\n        1840\n      ],\n      \"parameters\": {\n        \"width\": 1960,\n        \"height\": 680,\n        \"content\": \"## \\\"å†…éƒ¨è¯Šæ‰€åŠ©ç†\\\"\\næè¿°ï¼š\\n\\nç”¨é€”ï¼š\\nä»£è¡¨è¯Šæ‰€å†…éƒ¨åŠ©ç†ï¼Œä»…ä¾›å†…éƒ¨å›¢é˜Ÿé€šè¿‡Telegramä½¿ç”¨ï¼Œç”¨äºç®¡ç†æ‚£è€…æ”¹æœŸäº‹å®œå’Œç»´æŠ¤é‡‡è´­æé†’æ¸…å•ã€‚\\n\\nä½¿ç”¨è¯´æ˜ï¼š\\n\\nç”±å·¥ä½œäººå‘˜é€šè¿‡Telegramå‘é€çš„æ¶ˆæ¯è§¦å‘ã€‚\\n\\næ”¹æœŸä»»åŠ¡ï¼š\\n- è®¿é—®MCPè°·æ­Œæ—¥å†ä»¥æŸ¥æ‰¾å’Œç®¡ç†é¢„çº¦\\n- ä»æ´»åŠ¨æè¿°ä¸­æå–æ‚£è€…è”ç³»æ–¹å¼\\n- ä½¿ç”¨ä¸“ç”¨å·¥å…·é€šè¿‡WhatsAppå‘é€æ”¹æœŸæ¶ˆæ¯\\n\\né‡‡è´­æ¸…å•ä»»åŠ¡ï¼š\\n- æ ¹æ®å·¥ä½œäººå‘˜æŒ‡ç¤ºå°†é‡‡è´­æé†’æ·»åŠ åˆ°Google Tasksä¸­\\n\\næ³¨æ„äº‹é¡¹ï¼š\\n- ä¸æ‚£è€…äº’åŠ¨æ—¶ï¼ˆå³ä½¿æ˜¯é—´æ¥æ²Ÿé€šï¼‰å§‹ç»ˆä¿æŒä¸“ä¸šå’ŒåŒç†å¿ƒ\\n- æœªç»å·¥ä½œäººå‘˜è®¸å¯ä¸å¾—æ“…è‡ªç›´æ¥è”ç³»æ‚£è€…\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"a4a51bd1-48a6-4e32-b696-0ae77a0e05fe\",\n      \"name\": \"CallToHuman\",\n      \"type\": \"@n8n/n8n-nodes-langchain.toolWorkflow\",\n      \"position\": [\n        6240,\n        4000\n      ],\n      \"parameters\": {\n        \"name\": \"escalar_humano\",\n        \"workflowId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"A95kslcW4H82nJuR\",\n          \"cachedResultName\": \"callToHuman\"\n        },\n        \"description\": \"=Use essa ferramenta ao perceber que o paciente fala de:\\n- SituaÃ§Ãµes urgentes (sentindo-se mal, etc.)\\n- Assuntos nÃ£o relacionados Ã  clÃ­nica\\n- InsatisfaÃ§Ã£o extrema ou pedidos de falar com um humano\\n\",\n        \"workflowInputs\": {\n          \"value\": {\n            \"nome\": \"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('nome', ``, 'string') }}\",\n            \"telefone\": \"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('telefone', ``, 'string') }}\",\n            \"ultima_mensagem\": \"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('ultima_mensagem', ``, 'string') }}\"\n          },\n          \"schema\": [\n            {\n              \"id\": \"telefone\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"telefone\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"nome\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"nome\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"ultima_mensagem\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"required\": false,\n              \"displayName\": \"ultima_mensagem\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            }\n          ],\n          \"mappingMode\": \"defineBelow\",\n          \"matchingColumns\": [],\n          \"attemptToConvertTypes\": false,\n          \"convertFieldsToString\": false\n        }\n      },\n      \"typeVersion\": 2.1\n    },\n    {\n      \"id\": \"674c5c75-a954-4306-8a02-71bdda89293c\",\n      \"name\": \"OpenAI Chat Model2\",\n      \"type\": \"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\n      \"position\": [\n        8260,\n        2840\n      ],\n      \"parameters\": {\n        \"model\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"gpt-4.1-mini\",\n          \"cachedResultName\": \"gpt-4.1-mini\"\n        },\n        \"options\": {}\n      },\n      \"credentials\": {\n        \"openAiApi\": {\n          \"id\": \"zUnIUrOWA279vAoC\",\n          \"name\": \"OpenAi account\"\n        }\n      },\n      \"typeVersion\": 1.2\n    },\n    {\n      \"id\": \"b398627e-2fbe-44e4-ac2f-523b03871eda\",\n      \"name\": \"REMINDER\",\n      \"type\": \"n8n-nodes-evolution-api.evolutionApi\",\n      \"position\": [\n        8640,\n        2700\n      ],\n      \"parameters\": {\n        \"resource\": \"messages-api\",\n        \"remoteJid\": \"5511111111111@s.whatsapp.net\",\n        \"messageText\": \"={{$fromAI(\\\"reminder\\\")}}\",\n        \"instanceName\": \"instance name\",\n        \"options_message\": {}\n      },\n      \"credentials\": {\n        \"evolutionApi\": {\n          \"id\": \"fPKdX0EITLV8HI89\",\n          \"name\": \"Evolution account\"\n        }\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"active\": false,\n  \"pinData\": {\n    \"Webhook1\": [\n      {\n        \"json\": {\n          \"body\": {\n            \"data\": {\n              \"key\": {\n                \"id\": \"05D218BDE5BFC8378B5AA50BA87FDAFE\",\n                \"fromMe\": false,\n                \"remoteJid\": \"5491169701682@s.whatsapp.net\"\n              },\n              \"source\": \"android\",\n              \"status\": \"DELIVERY_ACK\",\n              \"message\": {\n                \"conversation\": \"Sim\",\n                \"messageContextInfo\": {\n                  \"messageSecret\": \"RdahuRio1gbaHLsCeV24k8yFFyJWGpAJ5zHYRc2QysU=\",\n                  \"deviceListMetadata\": {\n                    \"recipientKeyHash\": \"KgcEIs2I9kXQgQ==\",\n                    \"recipientTimestamp\": \"1745501413\"\n                  },\n                  \"deviceListMetadataVersion\": 2\n                }\n              },\n              \"pushName\": \"Luciano\",\n              \"instanceId\": \"317a031e-567d-4c2e-9bc4-146616fe4db7\",\n              \"messageType\": \"conversation\",\n              \"messageTimestamp\": 1745501855\n            },\n            \"event\": \"messages.upsert\",\n            \"apikey\": \"59BA76B6BD78-403B-A0CC-8735B6A7ED3A\",\n            \"sender\": \"553191282843@s.whatsapp.net\",\n            \"instance\": \"kore\",\n            \"date_time\": \"2025-04-24T10:37:35.514Z\",\n            \"server_url\": \"http://localhost:8080\",\n            \"destination\": \"https://engaging-seahorse-19.rshare.io/webhook/evolutionAPIKORE\"\n          },\n          \"query\": {},\n          \"params\": {},\n          \"headers\": {\n            \"host\": \"host.docker.internal:5678\",\n            \"x-scheme\": \"https\",\n            \"forwarded\": \"by=_exposr;for=179.0.72.34;host=engaging-seahorse-19.rshare.io;proto=https\",\n            \"x-real-ip\": \"179.0.72.34\",\n            \"connection\": \"keep-alive\",\n            \"exposr-via\": \"b9e7ef031eb8fe005896193e59b1d6f6d8743b1e\",\n            \"user-agent\": \"axios/1.7.9\",\n            \"content-type\": \"application/json\",\n            \"x-request-id\": \"91360975101096aa10d12cb5b8925b55\",\n            \"content-length\": \"821\",\n            \"accept-encoding\": \"gzip, compress, deflate, br\",\n            \"x-forwarded-for\": \"179.0.72.34\",\n            \"x-forwarded-host\": \"engaging-seahorse-19.rshare.io\",\n            \"x-forwarded-port\": \"443\",\n            \"x-forwarded-proto\": \"https\",\n            \"x-forwarded-scheme\": \"https\"\n          },\n          \"webhookUrl\": \"https://engaging-seahorse-19.rshare.io/webhook/evolutionAPIKORE\",\n          \"executionMode\": \"production\"\n        }\n      }\n    ],\n    \"Gatilho diÃ¡rio\": [\n      {\n        \"json\": {\n          \"Hour\": \"10\",\n          \"Year\": \"2025\",\n          \"Month\": \"April\",\n          \"Minute\": \"13\",\n          \"Second\": \"11\",\n          \"Timezone\": \"America/New_York (UTC-04:00)\",\n          \"timestamp\": \"2025-04-24T10:13:11.035-04:00\",\n          \"Day of week\": \"Thursday\",\n          \"Day of month\": \"24\",\n          \"Readable date\": \"April 24th 2025, 10:13:11 am\",\n          \"Readable time\": \"10:13:11 am\"\n        }\n      }\n    ]\n  },\n  \"settings\": {\n    \"executionOrder\": \"v1\"\n  },\n  \"versionId\": \"3044ad5c-d14e-4562-a454-0ad87f26dc68\",\n  \"connections\": {\n    \"OpenAI\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Assistente ClÃ­nica\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Switch\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Assistente ClÃ­nica\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"OpenAI1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Evolution API\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        []\n      ]\n    },\n    \"OpenAI1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"AI Agent2\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"AI Agent\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Evolution API2\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Webhook1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Edit Fields1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"AI Agent2\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Assistente ClÃ­nica\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"MCP GMAIL\": {\n      \"ai_tool\": [\n        [\n          {\n            \"node\": \"Assistente de confirmaÃ§Ã£o\",\n            \"type\": \"ai_tool\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"CallToHuman\": {\n      \"ai_tool\": [\n        [\n          {\n            \"node\": \"Assistente ClÃ­nica\",\n            \"type\": \"ai_tool\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Edit Fields1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Switch\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Google Tasks\": {\n      \"ai_tool\": [\n        [\n          {\n            \"node\": \"Assistente clinica interno\",\n            \"type\": \"ai_tool\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"MCP CALENDAR\": {\n      \"ai_tool\": [\n        [\n          {\n            \"node\": \"Assistente de confirmaÃ§Ã£o\",\n            \"type\": \"ai_tool\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Evolution API\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Convert to File\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Convert to File\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"OpenAI\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Gatilho diÃ¡rio\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Assistente de confirmaÃ§Ã£o\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"OpenAI Chat Model\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"Assistente ClÃ­nica\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"OpenAI Chat Model1\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"Assistente clinica interno\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"OpenAI Chat Model2\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"Assistente de confirmaÃ§Ã£o\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Assistente ClÃ­nica\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"AI Agent\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"MCP Google Calendar\": {\n      \"ai_tool\": [\n        [\n          {\n            \"node\": \"Assistente clinica interno\",\n            \"type\": \"ai_tool\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"MCP Google Calendar2\": {\n      \"ai_tool\": [\n        [\n          {\n            \"node\": \"Assistente ClÃ­nica\",\n            \"type\": \"ai_tool\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Postgres Chat Memory\": {\n      \"ai_memory\": [\n        [\n          {\n            \"node\": \"Assistente clinica interno\",\n            \"type\": \"ai_memory\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Postgres Chat Memory1\": {\n      \"ai_memory\": [\n        [\n          {\n            \"node\": \"Assistente ClÃ­nica\",\n            \"type\": \"ai_memory\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"OpenRouter Chat Model1\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"AI Agent\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"OpenRouter Chat Model2\": {\n      \"ai_languageModel\": [\n        [\n          {\n            \"node\": \"AI Agent2\",\n            \"type\": \"ai_languageModel\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Receber Mensagem Telegram\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Assistente clinica interno\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Assistente clinica interno\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Telegram\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Assistente de confirmaÃ§Ã£o\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"REMINDER\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Enviar alerta de cancelamento\": {\n      \"ai_tool\": [\n        [\n          {\n            \"node\": \"Assistente ClÃ­nica\",\n            \"type\": \"ai_tool\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}