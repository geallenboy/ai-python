{
  "title": "Replace Images in Google Docs Documents and Download as PDF/Docx",
  "url": "https://n8n.io/workflows/2501-replace-images-in-google-docs-documents-and-download-as-pdfdocx/",
  "category": "ITOps",
  "category_url": "https://n8n.io/workflows/categories/it-ops/?sort=createdAt:desc",
  "author": "simonscrapes",
  "publish_date": "Last update 3 months ago",
  "publish_date_absolute": "2025-02-07",
  "content": "",
  "workflow_json": "{\"meta\":{\"instanceId\":\"6b6a2db47bdf8371d21090c511052883cc9a3f6af5d0d9d567c702d74a18820e\"},\"nodes\":[{\"id\":\"f4570aad-db25-4dcd-8589-b1c8335935de\",\"name\":\"When clicking ‘Test workflow’\",\"type\":\"n8n-nodes-base.manualTrigger\",\"position\":[20,5220],\"parameters\":{},\"typeVersion\":1},{\"id\":\"675243b0-080f-4d5e-a0ca-a0fe0e7c04a9\",\"name\":\"Sticky Note9\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[185,5140],\"parameters\":{\"color\":7,\"width\":426.32566328767217,\"height\":260.3707944299243,\"content\":\"**Find and replace image in docx. Connect to a datasource with an image URL you want to insert into the Docx file**\"},\"typeVersion\":1},{\"id\":\"16bbf5da-5ebc-4e9c-8b3c-80d0077c51b8\",\"name\":\"Find Image ID in Docx\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[900,5220],\"parameters\":{\"url\":\"=https://docs.googleapis.com/v1/documents/{{$json.documentId}}\",\"options\":{},\"authentication\":\"predefinedCredentialType\",\"nodeCredentialType\":\"googleDocsOAuth2Api\"},\"notesInFlow\":true,\"typeVersion\":4.2},{\"id\":\"60325192-4730-4410-ae33-9127ff8cc5f7\",\"name\":\"Make file shareable publically (optional)\",\"type\":\"n8n-nodes-base.googleDrive\",\"position\":[1360,5220],\"parameters\":{\"fileId\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"={{ $json.documentId }}\"},\"options\":{},\"operation\":\"share\",\"permissionsUi\":{\"permissionsValues\":{\"role\":\"writer\",\"type\":\"anyone\"}}},\"typeVersion\":3},{\"id\":\"6f254810-3ab8-4ec1-b964-8b399472acf3\",\"name\":\"Image URL\",\"type\":\"n8n-nodes-base.set\",\"notes\":\"Define Image URL\",\"position\":[440,5220],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"cc2c6af0-68d3-49eb-85fe-3288d2ed0f6b\",\"name\":\"url\",\"type\":\"string\",\"value\":\"https://picsum.photos/id/400/300/300\"}]},\"includeOtherFields\":true},\"notesInFlow\":true,\"typeVersion\":3.4},{\"id\":\"d33a913a-2d98-4922-ba8d-5d325b114572\",\"name\":\"Find & Copy Docx Template\",\"type\":\"n8n-nodes-base.googleDrive\",\"position\":[660,5220],\"parameters\":{\"name\":\"Chosen filename\",\"fileId\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"1RQAX2CszNqw79gZxeocEZU0-KquTq3RQc2-5Uv1mgd0\",\"cachedResultUrl\":\"https://docs.google.com/document/d/1RQAX2CszNqw79gZxeocEZU0-KquTq3RQc2-5Uv1mgd0/edit?usp=drivesdk\",\"cachedResultName\":\"Marketing Plan (template)\"},\"options\":{},\"operation\":\"copy\"},\"notesInFlow\":true,\"typeVersion\":3},{\"id\":\"1f43d321-eddf-4008-99e2-9338cc85bad2\",\"name\":\"Sticky Note42\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[180,5420],\"parameters\":{\"color\":3,\"width\":415.45208033736463,\"height\":105.04337297263078,\"content\":\"**REQUIRED**\\nConnect to your database of image urls to input. Name the column `url` like in the `Image URL` node. This flow works with an image URL only, not a physical image file\"},\"typeVersion\":1},{\"id\":\"0e1bb319-8429-4bde-88a3-9fd69df7c986\",\"name\":\"Own datasource\",\"type\":\"n8n-nodes-base.noOp\",\"position\":[240,5220],\"parameters\":{},\"typeVersion\":1},{\"id\":\"d534cc1f-e651-4c06-860b-ce3d3c648964\",\"name\":\"Sticky Note43\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[620,5420],\"parameters\":{\"color\":2,\"width\":415.45208033736463,\"height\":222.7191963089109,\"content\":\"**OPTIONAL**\\nIf you want to create multiple documents with multiple images then create a template in your GDrive folder with a placeholder image that you want to replace. This template will be copied each time you run the flow, and the ID of that new document will be passed to `find image ID in Docx` to find the relevant image to replace with your image url. If you are just doing this for a single document then remove the `find and copy docx template` node. If you do this step, follow the [n8n guide](https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.googledrive/) on how to connect to your GDrive account.\"},\"typeVersion\":1},{\"id\":\"b6a22eb4-0b13-4eb5-be40-ed2dfedf99b5\",\"name\":\"Sticky Note44\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[620,5120],\"parameters\":{\"color\":7,\"width\":169.22824698060023,\"height\":278.7193163441844,\"content\":\"**Optional - create and copy a template document in your GDrive folder**\"},\"typeVersion\":1},{\"id\":\"25d2a7c0-cef7-4aaf-9bb8-fe9c83d73731\",\"name\":\"Sticky Note45\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[853,5120],\"parameters\":{\"color\":7,\"width\":435.22861330045936,\"height\":278.7193163441844,\"content\":\"**Sends request to Google API to retrieve document details (including image ID) in the template document**\"},\"typeVersion\":1},{\"id\":\"f8dcb709-5505-4c63-afe9-83a0dfb608e9\",\"name\":\"Replace Image in Docx\",\"type\":\"n8n-nodes-base.httpRequest\",\"position\":[1100,5220],\"parameters\":{\"url\":\"=https://docs.googleapis.com/v1/documents/{{$json.documentId}}:batchUpdate\",\"method\":\"POST\",\"options\":{},\"jsonBody\":\"={\\n  \\\"requests\\\": [\\n    {\\n      \\\"replaceImage\\\": {\\n        \\\"imageObjectId\\\": {{ $json.body.content[1].paragraph.elements[0].inlineObjectElement.inlineObjectId }},\\n        \\\"uri\\\": \\\"{{ $('Image URL').item.json.url }}\\\",\\n        \\\"imageReplaceMethod\\\": \\\"CENTER_CROP\\\"\\n      }\\n    }\\n  ]\\n} \",\"sendBody\":true,\"specifyBody\":\"json\",\"authentication\":\"predefinedCredentialType\",\"nodeCredentialType\":\"googleDocsOAuth2Api\"},\"notesInFlow\":true,\"typeVersion\":4.2},{\"id\":\"f800131b-e8d3-4741-8e8d-ad208e53ebe7\",\"name\":\"Sticky Note46\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1060,5420],\"parameters\":{\"color\":3,\"width\":297.15093794343295,\"height\":373.0766632058715,\"content\":\"**REQUIRED**\\n- Update the Google Docs OAuth 2 API credentials [with your own](https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.googledocs/)\\n- Ensure Document ID is passing correctly to `Find Image ID in Docx` if you removed the previous step\\n- Ensure the `imageObjectId` in the `Replace Image in Docx` node is correct, if you only have a single image in the document it should use the `\\\"{{ $json.body.content[1].paragraph.elements[0].inlineObjectElement.inlineObjectId }}\\\"` returned from the previous node. If you have more than one image then id will be nested in the `\\\"body.content[1].paragraph.positionedObjectIds[0]\\\"` object from the previous node \"},\"typeVersion\":1},{\"id\":\"0cdad7ae-e407-4c21-b454-8b2824e2b6d4\",\"name\":\"Sticky Note47\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1380,5420],\"parameters\":{\"color\":2,\"width\":747.7707439712262,\"height\":222.7191963089109,\"content\":\"**OPTIONAL**\\n- Make the file publically shareable (anyone can view/edit)\\n- Download the file as a Docx\\n- Download the file as a PDF\\n\\n\\nAll of the above requires authenticating with your GDrive account, ensuring the `documentID` is pulling correctly from previous nodes and choosing a `filename` if relevant\"},\"typeVersion\":1},{\"id\":\"fa6a214e-b6c5-403a-884a-d915f5a1362f\",\"name\":\"Download File - Docx\",\"type\":\"n8n-nodes-base.googleDrive\",\"position\":[1580,5220],\"parameters\":{\"fileId\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"={{ $json.documentId }}\"},\"options\":{},\"operation\":\"download\"},\"notesInFlow\":true,\"typeVersion\":3},{\"id\":\"399e08ae-864d-4ffa-bc18-d82e03e30f7c\",\"name\":\"Download File - PDF\",\"type\":\"n8n-nodes-base.googleDrive\",\"position\":[1800,5220],\"parameters\":{\"fileId\":{\"__rl\":true,\"mode\":\"id\",\"value\":\"={{ $json.documentId }}\"},\"options\":{\"fileName\":\"=filename - PDF\",\"googleFileConversion\":{\"conversion\":{\"docsToFormat\":\"application/pdf\"}}},\"operation\":\"download\"},\"notesInFlow\":true,\"typeVersion\":3},{\"id\":\"0855b49a-dca3-4da8-8e22-4294523798d7\",\"name\":\"Sticky Note48\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1320,5120],\"parameters\":{\"color\":7,\"width\":683.4764182113373,\"height\":278.7193163441844,\"content\":\"**Optional - make the file shareable, and download in docx and PDF format**\"},\"typeVersion\":1},{\"id\":\"d4a2e23d-9c14-4b0c-8fd3-99a981d2f39b\",\"name\":\"Sticky Note49\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-800,4960],\"parameters\":{\"color\":4,\"width\":773.6179704580734,\"height\":875.8289847608302,\"content\":\"## Replace Images in Google Docs Documents and Download as PDF/Docx\\n\\n## Use Case\\nAutomate image replacement in Google Docs:\\n- You need to update document images dynamically\\n- You want to create multiple versions of a template with different images\\n- You need to batch process document images from a URL database\\n- You want to generate shareable documents with custom images\\n\\n## What this Workflow Does\\nThe workflow automates image replacement in Google Docs:\\n- Accepts image URLs from your database\\n- Finds and replaces images in template documents\\n- Creates new document copies with updated images\\n- Optionally converts to PDF and makes documents shareable\\n\\n## Setup\\n1. Connect your image URL database (column name must be \\\"url\\\")\\n2. Set up [Google Docs OAuth 2 API credentials](https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.googledocs/)\\n3. Optional: Create a template document in Google Drive with placeholder images\\n4. Optional: Configure [Google Drive authentication](https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.googledrive/) for additional features\\n\\n## How to Adjust it to Your Needs\\n- Remove template copying for single document processing\\n- Adjust image ID selection for documents with multiple images\\n- Configure sharing settings and download formats\\n- Customize file naming and storage location\\n\\n\\nMade by Simon @ [automake.io](https://automake.io)\"},\"typeVersion\":1}],\"pinData\":{},\"connections\":{\"Image URL\":{\"main\":[[{\"node\":\"Find & Copy Docx Template\",\"type\":\"main\",\"index\":0}]]},\"Own datasource\":{\"main\":[[{\"node\":\"Image URL\",\"type\":\"main\",\"index\":0}]]},\"Download File - Docx\":{\"main\":[[{\"node\":\"Download File - PDF\",\"type\":\"main\",\"index\":0}]]},\"Find Image ID in Docx\":{\"main\":[[{\"node\":\"Replace Image in Docx\",\"type\":\"main\",\"index\":0}]]},\"Replace Image in Docx\":{\"main\":[[{\"node\":\"Make file shareable publically (optional)\",\"type\":\"main\",\"index\":0}]]},\"Find & Copy Docx Template\":{\"main\":[[{\"node\":\"Find Image ID in Docx\",\"type\":\"main\",\"index\":0}]]},\"When clicking ‘Test workflow’\":{\"main\":[[{\"node\":\"Own datasource\",\"type\":\"main\",\"index\":0}]]},\"Make file shareable publically (optional)\":{\"main\":[[{\"node\":\"Download File - Docx\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "## Use Case\n\nAutomate image replacement in Google Docs:\n\n  * You need to update document images dynamically\n  * You want to create multiple versions of a template with different images\n  * You need to batch process document images from a URL database\n  * You want to generate shareable documents with custom images\n\n\n\n## What this Workflow Does\n\nThe workflow automates image replacement in Google Docs:\n\n  * Accepts image URLs from your database\n  * Finds and replaces images in template documents\n  * Creates new document copies with updated images\n  * Optionally converts to PDF and makes documents shareable\n\n\n\n## Setup\n\n  1. Connect your image URL database (column name must be \"url\")\n  2. Set up [Google Docs OAuth 2 API credentials](https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.googledocs/)\n  3. Optional: Create a template document in Google Drive with placeholder images\n  4. Optional: Configure [Google Drive authentication](https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.googledrive/) for additional features\n\n\n\n## How to Adjust it to Your Needs\n\n  * Remove template copying for single document processing\n  * Adjust image ID selection for documents with multiple images\n  * Configure sharing settings and download formats\n  * Customize file naming and storage location\n\n\n\nMore templates and n8n workflows >>> [@simonscrapes](https://www.youtube.com/@simonscrapes?sub_confirmation=1)\n",
  "readme_html": "<!--[--><div data-v-50766329=\"\"><h2>Use Case</h2>\n<p>Automate image replacement in Google Docs:</p>\n<ul>\n<li>You need to update document images dynamically</li>\n<li>You want to create multiple versions of a template with different images</li>\n<li>You need to batch process document images from a URL database</li>\n<li>You want to generate shareable documents with custom images</li>\n</ul>\n<h2>What this Workflow Does</h2>\n<p>The workflow automates image replacement in Google Docs:</p>\n<ul>\n<li>Accepts image URLs from your database</li>\n<li>Finds and replaces images in template documents</li>\n<li>Creates new document copies with updated images</li>\n<li>Optionally converts to PDF and makes documents shareable</li>\n</ul>\n<h2>Setup</h2>\n<ol>\n<li>Connect your image URL database (column name must be \"url\")</li>\n<li>Set up <a href=\"https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.googledocs/\" rel=\"ugc nofollow\" target=\"_blank\">Google Docs OAuth 2 API credentials</a></li>\n<li>Optional: Create a template document in Google Drive with placeholder images</li>\n<li>Optional: Configure <a href=\"https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.googledrive/\" rel=\"ugc nofollow\" target=\"_blank\">Google Drive authentication</a> for additional features</li>\n</ol>\n<h2>How to Adjust it to Your Needs</h2>\n<ul>\n<li>Remove template copying for single document processing</li>\n<li>Adjust image ID selection for documents with multiple images</li>\n<li>Configure sharing settings and download formats</li>\n<li>Customize file naming and storage location</li>\n</ul>\n<p>More templates and n8n workflows &gt;&gt;&gt; <a href=\"https://www.youtube.com/@simonscrapes?sub_confirmation=1\" rel=\"ugc nofollow\" target=\"_blank\">@simonscrapes</a></p>\n</div><!--]-->",
  "readme_zh": "## 使用场景\n\n实现谷歌文档中的图片自动替换：\n\n  * 需要动态更新文档中的图片\n  * 希望基于模板创建含不同图片的多个版本\n  * 需批量处理来自URL数据库的文档图片\n  * 需要生成含定制图片的可共享文档",
  "title_zh": "在Google文档中替换图片并下载为PDF/Docx格式",
  "publish_date_zh": "最后更新于3个月前",
  "workflow_json_zh": "{\n  \"meta\": {\n    \"instanceId\": \"6b6a2db47bdf8371d21090c511052883cc9a3f6af5d0d9d567c702d74a18820e\"\n  },\n  \"nodes\": [\n    {\n      \"id\": \"f4570aad-db25-4dcd-8589-b1c8335935de\",\n      \"name\": \"When clicking ‘Test workflow’\",\n      \"type\": \"n8n-nodes-base.manualTrigger\",\n      \"position\": [\n        20,\n        5220\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"675243b0-080f-4d5e-a0ca-a0fe0e7c04a9\",\n      \"name\": \"Sticky Note9\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        185,\n        5140\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 426.32566328767217,\n        \"height\": 260.3707944299243,\n        \"content\": \"**在docx中查找并替换图片。连接到包含要插入Docx文件的图片URL的数据源**\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"16bbf5da-5ebc-4e9c-8b3c-80d0077c51b8\",\n      \"name\": \"Find Image ID in Docx\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        900,\n        5220\n      ],\n      \"parameters\": {\n        \"url\": \"=https://docs.googleapis.com/v1/documents/{{$json.documentId}}\",\n        \"options\": {},\n        \"authentication\": \"predefinedCredentialType\",\n        \"nodeCredentialType\": \"googleDocsOAuth2Api\"\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"60325192-4730-4410-ae33-9127ff8cc5f7\",\n      \"name\": \"Make file shareable publically (optional)\",\n      \"type\": \"n8n-nodes-base.googleDrive\",\n      \"position\": [\n        1360,\n        5220\n      ],\n      \"parameters\": {\n        \"fileId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $json.documentId }}\"\n        },\n        \"options\": {},\n        \"operation\": \"share\",\n        \"permissionsUi\": {\n          \"permissionsValues\": {\n            \"role\": \"writer\",\n            \"type\": \"anyone\"\n          }\n        }\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"6f254810-3ab8-4ec1-b964-8b399472acf3\",\n      \"name\": \"Image URL\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"notes\": \"Define Image URL\",\n      \"position\": [\n        440,\n        5220\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"cc2c6af0-68d3-49eb-85fe-3288d2ed0f6b\",\n              \"name\": \"url\",\n              \"type\": \"string\",\n              \"value\": \"https://picsum.photos/id/400/300/300\"\n            }\n          ]\n        },\n        \"includeOtherFields\": true\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"d33a913a-2d98-4922-ba8d-5d325b114572\",\n      \"name\": \"Find & Copy Docx Template\",\n      \"type\": \"n8n-nodes-base.googleDrive\",\n      \"position\": [\n        660,\n        5220\n      ],\n      \"parameters\": {\n        \"name\": \"Chosen filename\",\n        \"fileId\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"1RQAX2CszNqw79gZxeocEZU0-KquTq3RQc2-5Uv1mgd0\",\n          \"cachedResultUrl\": \"https://docs.google.com/document/d/1RQAX2CszNqw79gZxeocEZU0-KquTq3RQc2-5Uv1mgd0/edit?usp=drivesdk\",\n          \"cachedResultName\": \"Marketing Plan (template)\"\n        },\n        \"options\": {},\n        \"operation\": \"copy\"\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"1f43d321-eddf-4008-99e2-9338cc85bad2\",\n      \"name\": \"Sticky Note42\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        180,\n        5420\n      ],\n      \"parameters\": {\n        \"color\": 3,\n        \"width\": 415.45208033736463,\n        \"height\": 105.04337297263078,\n        \"content\": \"**必填项**\\n连接到您的图片网址数据库以输入数据。将列命名为 `url`，如同在 `Image URL` 节点中一样。此流程仅适用于图片网址，不适用于实体图片文件。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"0e1bb319-8429-4bde-88a3-9fd69df7c986\",\n      \"name\": \"Own datasource\",\n      \"type\": \"n8n-nodes-base.noOp\",\n      \"position\": [\n        240,\n        5220\n      ],\n      \"parameters\": {},\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"d534cc1f-e651-4c06-860b-ce3d3c648964\",\n      \"name\": \"Sticky Note43\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        620,\n        5420\n      ],\n      \"parameters\": {\n        \"color\": 2,\n        \"width\": 415.45208033736463,\n        \"height\": 222.7191963089109,\n        \"content\": \"**可选**  \\n若需创建包含多张图片的多个文档，请在Google Drive文件夹中制作一个模板，其中包含待替换的占位图片。每次运行流程时，该模板将被复制，新文档的ID会传递至`在Docx中查找图片ID`节点，用于定位需替换为指定图片URL的对应图片。若仅针对单个文档操作，请移除`查找并复制Docx模板`节点。执行此步骤时，请参照[n8n指南](https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.googledrive/)连接您的Google Drive账户。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"b6a22eb4-0b13-4eb5-be40-ed2dfedf99b5\",\n      \"name\": \"Sticky Note44\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        620,\n        5120\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 169.22824698060023,\n        \"height\": 278.7193163441844,\n        \"content\": \"**可选 - 在您的Google Drive文件夹中创建并复制模板文档**\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"25d2a7c0-cef7-4aaf-9bb8-fe9c83d73731\",\n      \"name\": \"Sticky Note45\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        853,\n        5120\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 435.22861330045936,\n        \"height\": 278.7193163441844,\n        \"content\": \"**向Google API发送请求以获取模板文档中的文档详情（包括图片ID）**\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"f8dcb709-5505-4c63-afe9-83a0dfb608e9\",\n      \"name\": \"Replace Image in Docx\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"position\": [\n        1100,\n        5220\n      ],\n      \"parameters\": {\n        \"url\": \"=https://docs.googleapis.com/v1/documents/{{$json.documentId}}:batchUpdate\",\n        \"method\": \"POST\",\n        \"options\": {},\n        \"jsonBody\": \"={\\n  \\\"requests\\\": [\\n    {\\n      \\\"replaceImage\\\": {\\n        \\\"imageObjectId\\\": {{ $json.body.content[1].paragraph.elements[0].inlineObjectElement.inlineObjectId }},\\n        \\\"uri\\\": \\\"{{ $('Image URL').item.json.url }}\\\",\\n        \\\"imageReplaceMethod\\\": \\\"CENTER_CROP\\\"\\n      }\\n    }\\n  ]\\n} \",\n        \"sendBody\": true,\n        \"specifyBody\": \"json\",\n        \"authentication\": \"predefinedCredentialType\",\n        \"nodeCredentialType\": \"googleDocsOAuth2Api\"\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 4.2\n    },\n    {\n      \"id\": \"f800131b-e8d3-4741-8e8d-ad208e53ebe7\",\n      \"name\": \"Sticky Note46\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1060,\n        5420\n      ],\n      \"parameters\": {\n        \"color\": 3,\n        \"width\": 297.15093794343295,\n        \"height\": 373.0766632058715,\n        \"content\": \"**必填项**\\n- 更新Google Docs OAuth 2 API凭证[为您的自有凭证](https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.googledocs/)\\n- 若移除了前一步骤，请确保文档ID能正确传递至`在Docx中查找图片ID`节点\\n- 确保`替换Docx中的图片`节点内的`imageObjectId`准确无误：若文档仅含单张图片，应使用前一节点返回的`\\\"{{ $json.body.content[1].paragraph.elements[0].inlineObjectElement.inlineObjectId }}\\\"`；若含多张图片，则ID将嵌套在前一节点的`\\\"body.content[1].paragraph.positionedObjectIds[0]\\\"`对象中\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"0cdad7ae-e407-4c21-b454-8b2824e2b6d4\",\n      \"name\": \"Sticky Note47\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1380,\n        5420\n      ],\n      \"parameters\": {\n        \"color\": 2,\n        \"width\": 747.7707439712262,\n        \"height\": 222.7191963089109,\n        \"content\": \"**可选操作**\\n- 将文件设为公开可共享（任何人可查看/编辑）\\n- 下载文件为Docx格式\\n- 下载文件为PDF格式\\n\\n以上所有操作均需通过您的谷歌云盘账户进行身份验证，确保从先前的节点正确获取`documentID`，并在相关情况下选择`filename`。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"fa6a214e-b6c5-403a-884a-d915f5a1362f\",\n      \"name\": \"Download File - Docx\",\n      \"type\": \"n8n-nodes-base.googleDrive\",\n      \"position\": [\n        1580,\n        5220\n      ],\n      \"parameters\": {\n        \"fileId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $json.documentId }}\"\n        },\n        \"options\": {},\n        \"operation\": \"download\"\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"399e08ae-864d-4ffa-bc18-d82e03e30f7c\",\n      \"name\": \"Download File - PDF\",\n      \"type\": \"n8n-nodes-base.googleDrive\",\n      \"position\": [\n        1800,\n        5220\n      ],\n      \"parameters\": {\n        \"fileId\": {\n          \"__rl\": true,\n          \"mode\": \"id\",\n          \"value\": \"={{ $json.documentId }}\"\n        },\n        \"options\": {\n          \"fileName\": \"=filename - PDF\",\n          \"googleFileConversion\": {\n            \"conversion\": {\n              \"docsToFormat\": \"application/pdf\"\n            }\n          }\n        },\n        \"operation\": \"download\"\n      },\n      \"notesInFlow\": true,\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"0855b49a-dca3-4da8-8e22-4294523798d7\",\n      \"name\": \"Sticky Note48\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1320,\n        5120\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 683.4764182113373,\n        \"height\": 278.7193163441844,\n        \"content\": \"**可选 - 使文件可共享，并以docx和PDF格式下载**\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"d4a2e23d-9c14-4b0c-8fd3-99a981d2f39b\",\n      \"name\": \"Sticky Note49\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -800,\n        4960\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 773.6179704580734,\n        \"height\": 875.8289847608302,\n        \"content\": \"## Replace Images in Google Docs Documents and Download as PDF/Docx\\n\\n## Use Case\\nAutomate image replacement in Google Docs:\\n- You need to update document images dynamically\\n- You want to create multiple versions of a template with different images\\n- You need to batch process document images from a URL database\\n- You want to generate shareable documents with custom images\\n\\n## What this Workflow Does\\nThe workflow automates image replacement in Google Docs:\\n- Accepts image URLs from your database\\n- Finds and replaces images in template documents\\n- Creates new document copies with updated images\\n- Optionally converts to PDF and makes documents shareable\\n\\n## Setup\\n1. Connect your image URL database (column name must be \\\"url\\\")\\n2. Set up [Google Docs OAuth 2 API credentials](https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.googledocs/)\\n3. Optional: Create a template document in Google Drive with placeholder images\\n4. Optional: Configure [Google Drive authentication](https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.googledrive/) for additional features\\n\\n## How to Adjust it to Your Needs\\n- Remove template copying for single document processing\\n- Adjust image ID selection for documents with multiple images\\n- Configure sharing settings and download formats\\n- Customize file naming and storage location\\n\\n\\nMade by Simon @ [automake.io](https://automake.io)\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"pinData\": {},\n  \"connections\": {\n    \"Image URL\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Find & Copy Docx Template\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Own datasource\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Image URL\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Download File - Docx\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Download File - PDF\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Find Image ID in Docx\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Replace Image in Docx\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Replace Image in Docx\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Make file shareable publically (optional)\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Find & Copy Docx Template\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Find Image ID in Docx\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"When clicking ‘Test workflow’\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Own datasource\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Make file shareable publically (optional)\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Download File - Docx\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}