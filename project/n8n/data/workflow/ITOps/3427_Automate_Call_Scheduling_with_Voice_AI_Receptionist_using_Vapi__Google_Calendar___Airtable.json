{
  "title": "Automate Call Scheduling with Voice AI Receptionist using Vapi, Google Calendar & Airtable",
  "url": "https://n8n.io/workflows/3427-automate-call-scheduling-with-voice-ai-receptionist-using-vapi-google-calendar-and-airtable/",
  "category": "ITOps",
  "category_url": "https://n8n.io/workflows/categories/it-ops/?sort=createdAt:desc",
  "author": "SuperAgent",
  "publish_date": "Last update 8 days ago",
  "publish_date_absolute": "2025-05-14",
  "content": "",
  "workflow_json": "{\"meta\":{\"instanceId\":\"1954c8c806bedb8f0628725b26b786028ade16c78a82bc25deb9dd961e036832\"},\"nodes\":[{\"id\":\"36d0b0d4-b454-4a9b-8168-bcc7942a7cc7\",\"name\":\"Input Arguments\",\"type\":\"n8n-nodes-base.set\",\"position\":[520,740],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"ccabe9f4-7911-4488-a75b-7c5779fb2014\",\"name\":\"timeZone\",\"type\":\"string\",\"value\":\"=America/Chicago\"},{\"id\":\"b802d976-78f5-4c00-8764-f8c49eaded29\",\"name\":\"endtime\",\"type\":\"string\",\"value\":\"={{ $json.body.message.toolCalls[0].function.arguments.endtime }}\"},{\"id\":\"02d58122-6a0f-4bdb-9914-6f50d2af6df4\",\"name\":\"starttime\",\"type\":\"string\",\"value\":\"={{ $json.body.message.toolCalls[0].function.arguments.starttime }}\"},{\"id\":\"c1249493-a1d7-4a91-9468-9e5c49430d2e\",\"name\":\"body.message.toolCalls[0].id\",\"type\":\"string\",\"value\":\"={{ $json.body.message.toolCalls[0].id }}\"},{\"id\":\"2d1e0d9a-4c70-488e-b430-b8137fd54970\",\"name\":\"customer.number\",\"type\":\"string\",\"value\":\"={{ $json.body.message.call.customer.number }}\"}]}},\"typeVersion\":3.3},{\"id\":\"2d8485ad-9007-4664-9182-7eda25fc96ee\",\"name\":\"Format response\",\"type\":\"n8n-nodes-base.itemLists\",\"position\":[2000,840],\"parameters\":{\"include\":\"allFieldsExcept\",\"options\":{},\"aggregate\":\"aggregateAllItemData\",\"operation\":\"concatenateItems\",\"fieldsToExclude\":\"sort\",\"destinationFieldName\":\"response\"},\"typeVersion\":3},{\"id\":\"b23c75e0-3697-4137-a595-cf26fedaa898\",\"name\":\"Sort\",\"type\":\"n8n-nodes-base.itemLists\",\"position\":[1760,840],\"parameters\":{\"options\":{},\"operation\":\"sort\",\"sortFieldsUi\":{\"sortField\":[{\"fieldName\":\"sort\"}]}},\"typeVersion\":3},{\"id\":\"660e3d2f-a424-4e76-8c13-5b62b9f22202\",\"name\":\"Available Start Times & Ranges\",\"type\":\"n8n-nodes-base.code\",\"position\":[2240,840],\"parameters\":{\"jsCode\":\"// Input data\\nconst inputData = $input.all()[0].json.response;\\n\\n// Define workday hours in CST\\nconst WORKDAY_START = \\\"09:00:00 CST\\\";\\nconst WORKDAY_END = \\\"18:00:00 CST\\\";\\nconst SLOT_DURATION = 30 * 60 * 1000; // 30 minutes in milliseconds\\n\\n// Helper to parse CST datetime strings\\nconst parseCST = (datetime) => {\\n  const parsedDate = new Date(datetime.replace(\\\" CST\\\", \\\"-06:00\\\"));\\n  return isNaN(parsedDate) ? null : parsedDate;\\n};\\n\\n// Function to generate 30-minute start times\\nconst generateStartTimes = (start, end) => {\\n  const startTimes = [];\\n  let current = new Date(start);\\n\\n  while (current < end) {\\n    startTimes.push(\\n      current.toLocaleTimeString('en-US', {\\n        timeZone: 'CST',\\n        hour: '2-digit',\\n        minute: '2-digit',\\n      })\\n    );\\n    current = new Date(current.getTime() + SLOT_DURATION);\\n  }\\n\\n  return startTimes;\\n};\\n\\n// Function to find wide open ranges\\nconst findWideOpenRanges = (startTimes) => {\\n  if (startTimes.length < 3) return []; // Not enough slots for a wide open range\\n\\n  const ranges = [];\\n  let rangeStart = null;\\n  let consecutiveCount = 0;\\n\\n  for (let i = 0; i < startTimes.length - 1; i++) {\\n    const currentTime = parseCST(`2000-01-01 ${startTimes[i]} CST`);\\n    const nextTime = parseCST(`2000-01-01 ${startTimes[i + 1]} CST`);\\n    const diff = nextTime - currentTime;\\n\\n    if (diff === SLOT_DURATION) {\\n      consecutiveCount += 1;\\n      if (rangeStart === null) rangeStart = startTimes[i];\\n    } else {\\n      if (consecutiveCount >= 2) {\\n        ranges.push(`${rangeStart} to ${startTimes[i]}`);\\n      }\\n      rangeStart = null;\\n      consecutiveCount = 0;\\n    }\\n  }\\n\\n  // Handle the final range\\n  if (consecutiveCount >= 2) {\\n    ranges.push(`${rangeStart} to ${startTimes[startTimes.length - 1]}`);\\n  }\\n\\n  return ranges;\\n};\\n\\n// Group meetings by date, ignoring invalid dates\\nconst meetingsByDate = inputData.reduce((acc, meeting) => {\\n  const start = parseCST(meeting.start);\\n  const end = parseCST(meeting.end);\\n\\n  if (!start || !end) {\\n    return acc; // Ignore invalid dates\\n  }\\n\\n  const dateKey = start.toISOString().split('T')[0];\\n\\n  if (!acc[dateKey]) {\\n    acc[dateKey] = [];\\n  }\\n\\n  acc[dateKey].push({ start, end });\\n  return acc;\\n}, {});\\n\\n// Generate availability\\nconst availability = Object.keys(meetingsByDate)\\n  .filter((date) => {\\n    // Exclude Saturdays (6) and Sundays (0)\\n    const dayOfWeek = new Date(date).getUTCDay();\\n    return dayOfWeek !== 0 && dayOfWeek !== 6;\\n  })\\n  .map((date) => {\\n    const workdayStart = parseCST(`${date} ${WORKDAY_START}`);\\n    const workdayEnd = parseCST(`${date} ${WORKDAY_END}`);\\n\\n    const dayMeetings = meetingsByDate[date].sort((a, b) => a.start - b.start);\\n\\n    let availableStartTimes = [];\\n    let lastEnd = workdayStart;\\n\\n    for (const meeting of dayMeetings) {\\n      if (meeting.start > lastEnd) {\\n        availableStartTimes = availableStartTimes.concat(generateStartTimes(lastEnd, meeting.start));\\n      }\\n      lastEnd = meeting.end > lastEnd ? meeting.end : lastEnd;\\n    }\\n\\n    if (lastEnd < workdayEnd) {\\n      availableStartTimes = availableStartTimes.concat(generateStartTimes(lastEnd, workdayEnd));\\n    }\\n\\n    const wideOpenRanges = findWideOpenRanges(availableStartTimes);\\n\\n    return {\\n      date: new Date(date).toLocaleDateString('en-US', {\\n        weekday: 'long',\\n        year: 'numeric',\\n        month: 'long',\\n        day: 'numeric',\\n      }),\\n      availableStartTimes,\\n      wideOpenRanges,\\n    };\\n  });\\n\\n// Format output as plaintext\\nconst availableTimes = availability\\n  .map(({ date, availableStartTimes, wideOpenRanges }) => {\\n    const times = availableStartTimes.map((time) => `- ${time}`).join('\\\\n');\\n    const ranges = wideOpenRanges.length\\n      ? `Wide Open Ranges:\\\\n${wideOpenRanges.map((range) => `- ${range}`).join('\\\\n')}`\\n      : \\\"Wide Open Ranges: None\\\";\\n\\n    return `### ${date}\\\\nAvailable Start Times:\\\\n${times}\\\\n\\\\n${ranges}`;\\n  })\\n  .join('\\\\n\\\\n');\\n\\n// Set the output\\nreturn {\\n  json: {\\n    availableTimes,\\n  },\\n};\\n\"},\"typeVersion\":2},{\"id\":\"f3110658-2f90-4b19-9874-7d6c4e108895\",\"name\":\"Flatten Slots\",\"type\":\"n8n-nodes-base.code\",\"position\":[2460,840],\"parameters\":{\"mode\":\"runOnceForEachItem\",\"jsCode\":\"const flattenSlots = (data) => {\\n  // If data is missing or empty, return an empty array of slots\\n  if (!data) {\\n    return { slots: [] };\\n  }\\n\\n  // data is an object whose keys are dates\\n  // each date key has an array of slot objects\\n  // we just need to flatten them all into one array\\n  const flattened = Object.values(data).flat();  // merges all arrays from each date key\\n\\n  // Return a new object with a single 'slots' array\\n  return { slots: flattened };\\n};\\n\\n// Then assign the flattened slots back to $input.item.json.data\\n$input.item.json.data = flattenSlots($input.item.json.data);\\nreturn $input.item;\\n\"},\"typeVersion\":2},{\"id\":\"5065439e-34e3-4eaf-8226-8ba7393a5cf3\",\"name\":\"Enrich Date\",\"type\":\"n8n-nodes-base.code\",\"position\":[2680,840],\"parameters\":{\"mode\":\"runOnceForEachItem\",\"jsCode\":\"function formatTimeSlot(dateString) {\\n  // Format options for date/time with America/Chicago timezone\\n  const options = {\\n    timeZone: 'America/Chicago',\\n    weekday: 'long',\\n    month: 'long',\\n    day: 'numeric',\\n    hour: 'numeric',\\n    minute: 'numeric',\\n    hour12: true\\n  };\\n\\n  // Create a formatter with timezone support\\n  const dateFormatter = new Intl.DateTimeFormat('en-US', options);\\n  \\n  // Format the date/time string\\n  return dateFormatter.format(new Date(dateString));\\n}\\n\\n// Process each slot and add formatted time strings to the result\\nconst slots = $input.item.json.data.slots;\\nconst formattedSlots = slots.map(slot => formatTimeSlot(slot.start));\\n\\n// Attach formatted results to the output\\n$input.item.json.data.slots = formattedSlots;\\n\\nreturn $input.item;\\n\"},\"typeVersion\":2},{\"id\":\"d8ed3a92-697b-4718-b65f-5276c9a9bfaf\",\"name\":\"Build Response Payload\",\"type\":\"n8n-nodes-base.set\",\"position\":[2900,840],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"5cb05b10-e916-459e-84a2-9c314a859a07\",\"name\":\"results[0].toolCallId\",\"type\":\"string\",\"value\":\"={{ $('Input Arguments').item.json.body.message.toolCalls[0].id }}\"},{\"id\":\"552246f9-7afd-404e-9fb3-cb38c7447359\",\"name\":\"results[0].result\",\"type\":\"string\",\"value\":\"={{ $json.availableTimes }}\"}]}},\"typeVersion\":3.4},{\"id\":\"a0697944-c5a6-4ca1-9948-8248940841b2\",\"name\":\"Booking Payload\",\"type\":\"n8n-nodes-base.set\",\"position\":[1980,1400],\"parameters\":{\"options\":{\"ignoreConversionErrors\":true},\"assignments\":{\"assignments\":[{\"id\":\"05bbc797-b781-489c-ab70-e234fe17eb62\",\"name\":\"id\",\"type\":\"number\",\"value\":\"={{ $json.id }}\"},{\"id\":\"4bb68abf-18c8-4445-b446-21667abd95aa\",\"name\":\"description\",\"type\":\"string\",\"value\":\"={{ $json.description }}\"},{\"id\":\"74a98b77-b9fe-40cc-84c8-fc7303c5cfa6\",\"name\":\"startTime\",\"type\":\"string\",\"value\":\"={{ $json.start.dateTime }}\"},{\"id\":\"2934d6a7-9e6b-4038-891c-0b05ba18cb21\",\"name\":\"endTime\",\"type\":\"string\",\"value\":\"={{ $json.end.dateTime }}\"},{\"id\":\"10f091c8-5e52-40dc-a294-87625be9af99\",\"name\":\"status\",\"type\":\"string\",\"value\":\"={{ $json.status }}\"},{\"id\":\"cdc5e1ab-a29b-447f-8343-ff1c1b168717\",\"name\":\"Timezone\",\"type\":\"string\",\"value\":\"={{ $json.end.timeZone }}\"},{\"id\":\"f5b6820c-ab4b-496c-9957-f86753243388\",\"name\":\"attendees\",\"type\":\"array\",\"value\":\"={{ $json.attendees }}\"},{\"id\":\"b39a06a5-4fbf-4fdf-9d9a-a07dcb37d157\",\"name\":\"hangoutLink\",\"type\":\"string\",\"value\":\"={{ $json.hangoutLink }}\"},{\"id\":\"345f49fc-93bc-48b8-9ced-326139a82119\",\"name\":\"Title\",\"type\":\"string\",\"value\":\"={{ $json.summary }}\"}]}},\"typeVersion\":3.4},{\"id\":\"4f7b157c-f657-48fa-8bb5-a1e074b042eb\",\"name\":\"Success Response\",\"type\":\"n8n-nodes-base.set\",\"position\":[2200,1400],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"2c3894da-7bf7-4a35-95c0-d3d9199dd0ad\",\"name\":\"results[0].toolCallId\",\"type\":\"string\",\"value\":\"={{ $('Input Arguments from booking tools').item.json.toolCallId }}\"},{\"id\":\"685c67c7-a30b-4bcc-b9ba-827c4b570548\",\"name\":\"results[0].result\",\"type\":\"string\",\"value\":\"={{ $json.status }}\"}]}},\"typeVersion\":3.3},{\"id\":\"b7fe16e3-b625-4cb4-b971-9c26698af89b\",\"name\":\"Add Friendly Error\",\"type\":\"n8n-nodes-base.code\",\"position\":[1980,1760],\"parameters\":{\"mode\":\"runOnceForEachItem\",\"jsCode\":\"function replaceValue(value) {\\n  if (error.message.include('no_available_users_found_error')) {\\n    return \\\"This time slot is no longer available.\\\";\\n  }\\n  return value;\\n}\\n\\n$input.item.json.message = replaceValue($input.item.json.error.description);\\n\\nreturn $input.item;\"},\"typeVersion\":2},{\"id\":\"b5bff0df-2bef-4c43-9fcf-91cadc68b7ca\",\"name\":\"Error Response\",\"type\":\"n8n-nodes-base.set\",\"position\":[2200,1760],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"2c3894da-7bf7-4a35-95c0-d3d9199dd0ad\",\"name\":\"results[0].toolCallId\",\"type\":\"string\",\"value\":\"={{ $('Input Arguments from booking tools').item.json.toolCallId }}\"},{\"id\":\"93e45166-de94-4fa5-9148-2b8d0e4b960c\",\"name\":\"results[0].result\",\"type\":\"string\",\"value\":\"={{ $json.message || $json.status }}\"}]}},\"typeVersion\":3.3},{\"id\":\"fe62c0bc-2d73-4f14-8e76-02847ef4e14a\",\"name\":\"Escape Json\",\"type\":\"n8n-nodes-base.code\",\"position\":[1260,1580],\"parameters\":{\"mode\":\"runOnceForEachItem\",\"jsCode\":\"const escapeStringForJson = (str) => {\\n    return str\\n        .replace(/\\\\\\\\/g, '\\\\\\\\\\\\\\\\') // Escape backslashes\\n        .replace(/\\\"/g, '\\\\\\\\\\\"')    // Escape double quotes\\n        .replace(/\\\\n/g, '\\\\\\\\n')   // Escape newlines\\n        .replace(/\\\\r/g, '\\\\\\\\r')   // Escape carriage returns\\n        .replace(/\\\\t/g, '\\\\\\\\t');  // Escape tabs\\n};\\n\\n// Escape the notes field\\n$input.item.json.notes = escapeStringForJson($input.item.json.notes);\\n\\nreturn $input.item;\\n\"},\"typeVersion\":2},{\"id\":\"17927aa4-8f91-4134-b914-1160a724226f\",\"name\":\"Has all information\",\"type\":\"n8n-nodes-base.if\",\"position\":[940,1800],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"e0af7f69-0c89-4a02-a49f-dd5a90e31dff\",\"operator\":{\"type\":\"boolean\",\"operation\":\"true\",\"singleValue\":true},\"leftValue\":\"={{ ($json.email || \\\"\\\").isEmail() }}\",\"rightValue\":\"\"}]}},\"typeVersion\":2.2},{\"id\":\"6f0bb9e6-9d82-4cc6-a98f-4d00c47ed910\",\"name\":\"Respond with Error\",\"type\":\"n8n-nodes-base.respondToWebhook\",\"position\":[1480,1900],\"parameters\":{\"options\":{}},\"typeVersion\":1.1},{\"id\":\"fdedba34-a374-405d-a86e-0b0a1759ede9\",\"name\":\"Build Error Response Payload\",\"type\":\"n8n-nodes-base.set\",\"position\":[1260,1900],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"5cb05b10-e916-459e-84a2-9c314a859a07\",\"name\":\"results[0].toolCallId\",\"type\":\"string\",\"value\":\"={{ $('Input Arguments from booking tools').item.json.toolCallId }}\"},{\"id\":\"552246f9-7afd-404e-9fb3-cb38c7447359\",\"name\":\"results[0].result\",\"type\":\"string\",\"value\":\"=You must provide an email, name and notes to call this tool\"}]}},\"typeVersion\":3.4},{\"id\":\"1e111f9d-bb43-4126-b7a2-3353e7c7c72f\",\"name\":\"Build Error Response Payload2\",\"type\":\"n8n-nodes-base.set\",\"position\":[1560,2840],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"5cb05b10-e916-459e-84a2-9c314a859a07\",\"name\":\"results[0].toolCallId\",\"type\":\"string\",\"value\":\"={{ $('Input Arguments from updateslot tool').item.json.toolCallId || $json.Calls[0].id }}\"},{\"id\":\"552246f9-7afd-404e-9fb3-cb38c7447359\",\"name\":\"results[0].result\",\"type\":\"string\",\"value\":\"=You must provide an email, name , previous starttime & endtime and resceduled starttime to call this tool\"}]}},\"typeVersion\":3.4},{\"id\":\"d6cbad26-d974-4a11-b0fd-2a35bb555378\",\"name\":\"Sticky Note\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[260,620],\"parameters\":{\"color\":4,\"width\":190,\"height\":80,\"content\":\"# Get Slots\"},\"typeVersion\":1},{\"id\":\"bcccc8cb-2e9d-4f8b-9964-e4d656e794ed\",\"name\":\"Sticky Note1\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[740,920],\"parameters\":{\"width\":230,\"height\":80,\"content\":\"## Check Availability\\n\"},\"typeVersion\":1},{\"id\":\"30b34e37-ee7a-434c-ab4d-445df994459a\",\"name\":\"Sticky Note2\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1320,520],\"parameters\":{\"width\":310,\"height\":80,\"content\":\"## If time available Respond\\n\"},\"typeVersion\":1},{\"id\":\"725a9b59-ea66-4326-a410-93a723157ced\",\"name\":\"Sticky Note3\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1280,1020],\"parameters\":{\"width\":190,\"height\":80,\"content\":\"## Get All Events\\n\"},\"typeVersion\":1},{\"id\":\"1f2bf4a3-8aeb-4a56-8bff-0bb370e12718\",\"name\":\"Sticky Note4\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[2140,1020],\"parameters\":{\"width\":350,\"height\":100,\"content\":\"## Get Available Slots\\n\\nFormat the slots and Enrich the date and timings\\n\"},\"typeVersion\":1},{\"id\":\"5909d88f-b9c6-4e62-b1e3-bdc1d05ad7aa\",\"name\":\"Sticky Note5\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[3280,1000],\"parameters\":{\"width\":230,\"height\":80,\"content\":\"## Respond to Vapi\"},\"typeVersion\":1},{\"id\":\"f627c5b0-f3b6-4f95-a3a3-2c1b7e2860c7\",\"name\":\"Sticky Note BookSlot Webhook\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[380,1680],\"parameters\":{\"color\":5,\"width\":190,\"height\":80,\"content\":\"# Book Slot\"},\"typeVersion\":1},{\"id\":\"9c3e8b9f-3fe3-4380-8cbc-413146d752b9\",\"name\":\"Sticky Note BookSlot Check\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[880,1700],\"parameters\":{\"width\":230,\"height\":80,\"content\":\"Checks if required booking info (email, name, etc.) is provided.\"},\"typeVersion\":1},{\"id\":\"c723bbd0-5a04-4efb-ba67-59bc722b9d4e\",\"name\":\"Sticky Note BookSlot Error\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1440,2060],\"parameters\":{\"width\":190,\"height\":80,\"content\":\"If info missing, sends error back.\"},\"typeVersion\":1},{\"id\":\"a843e795-8046-4538-93e0-2de2e688c863\",\"name\":\"Sticky Note BookSlot GCal\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1660,1740],\"parameters\":{\"width\":190,\"height\":80,\"content\":\"Books the appointment in Google Calendar.\"},\"typeVersion\":1},{\"id\":\"a7627281-15fc-438a-b031-b00cbc4b9fa4\",\"name\":\"Sticky Note BookSlot Error Handle\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1920,1920],\"parameters\":{\"width\":230,\"height\":80,\"content\":\"Handles potential booking errors (e.g., slot taken).\"},\"typeVersion\":1},{\"id\":\"71c0c722-b5df-47d7-97e6-3d23533a4a4e\",\"name\":\"Sticky Note BookSlot Response\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[2420,1740],\"parameters\":{\"width\":210,\"height\":80,\"content\":\"Sends confirmation/error back to Vapi.\"},\"typeVersion\":1},{\"id\":\"4e598ebb-cfdb-432f-a01a-bb76d1d20f24\",\"name\":\"Sticky Note BookSlot Airtable\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[3100,1740],\"parameters\":{\"width\":230,\"height\":80,\"content\":\"Logs the confirmed booking details to Airtable.\"},\"typeVersion\":1},{\"id\":\"cc085c75-d45f-4453-b78b-1b9b480fb02c\",\"name\":\"Sticky Note CancelSlot Webhook\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[440,3480],\"parameters\":{\"color\":3,\"width\":250,\"height\":80,\"content\":\"# Cancel Slots\"},\"typeVersion\":1},{\"id\":\"9504b7e8-7964-4a0e-bfa4-32540c1fb895\",\"name\":\"Sticky Note CancelSlot Check\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[960,3780],\"parameters\":{\"width\":230,\"height\":80,\"content\":\"Checks if required info (email, name, start time) is provided.\"},\"typeVersion\":1},{\"id\":\"3bb9d976-d922-4016-839c-22e8b1adcf35\",\"name\":\"Sticky Note CancelSlot Error\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1520,3940],\"parameters\":{\"width\":150,\"height\":80,\"content\":\"If info missing, sends error back.\"},\"typeVersion\":1},{\"id\":\"87442b3a-b8eb-43e6-b15d-0240a58bff79\",\"name\":\"Sticky Note CancelSlot Search\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1300,3440],\"parameters\":{\"width\":190,\"height\":100,\"content\":\"Finds the appointment record in Airtable by phone number to get event ID.\"},\"typeVersion\":1},{\"id\":\"4e0cec59-1acc-4604-80ce-09479c7a6652\",\"name\":\"Sticky Note CancelSlot GCal Delete\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1720,3720],\"parameters\":{\"width\":190,\"height\":80,\"content\":\"Deletes the event from Google Calendar using event ID.\"},\"typeVersion\":1},{\"id\":\"68e00556-93d2-45a8-9fee-deb1477ffff2\",\"name\":\"Sticky Note CancelSlot Airtable Update\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[2060,3400],\"parameters\":{\"width\":190,\"height\":80,\"content\":\"Updates Airtable record status to 'Canceled'.\"},\"typeVersion\":1},{\"id\":\"5853b0f6-1e73-435e-aff8-5d9d8de53693\",\"name\":\"Sticky Note CancelSlot Response\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[2380,3740],\"parameters\":{\"width\":190,\"height\":80,\"content\":\"Sends cancellation confirmation/error back to Vapi.\"},\"typeVersion\":1},{\"id\":\"660cdb51-84ac-434e-b7d8-f7b17ef7ef5b\",\"name\":\"Sticky Note UpdateSlot Webhook\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[460,2600],\"parameters\":{\"color\":6,\"width\":250,\"height\":80,\"content\":\"# Update Slots\"},\"typeVersion\":1},{\"id\":\"030e4bce-4b8b-42b7-8cf4-86b3a88f375b\",\"name\":\"Sticky Note UpdateSlot Check\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1000,2900],\"parameters\":{\"width\":230,\"height\":80,\"content\":\"Checks if required info (email, name, old/new times) is provided.\"},\"typeVersion\":1},{\"id\":\"02e9f8e3-7561-4ace-95a2-2b1807940f1a\",\"name\":\"Sticky Note UpdateSlot Error\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1500,3020],\"parameters\":{\"width\":190,\"height\":80,\"content\":\"If info missing, sends error back.\"},\"typeVersion\":1},{\"id\":\"4820cb6c-de15-4e9a-bca7-e3f172af6b80\",\"name\":\"Sticky Note UpdateSlot Search\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1580,2460],\"parameters\":{\"width\":190,\"height\":80,\"content\":\"Finds original appointment in Airtable by old phone number\"},\"typeVersion\":1},{\"id\":\"5dd3075e-8e0b-4f76-8d21-39aa66d449da\",\"name\":\"Sticky Note UpdateSlot GCal Update\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[1940,2720],\"parameters\":{\"width\":190,\"height\":80,\"content\":\"Updates the event time in Google Calendar.\"},\"typeVersion\":1},{\"id\":\"2e08b4f6-f279-4a9e-9bd3-d6a6283b45f4\",\"name\":\"Sticky Note UpdateSlot Airtable Update\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[2240,2320],\"parameters\":{\"width\":170,\"height\":100,\"content\":\"Updates Airtable record with new times & 'Updated' status.\"},\"typeVersion\":1},{\"id\":\"d1369c19-401e-4ce2-a21e-0d5ae01af119\",\"name\":\"Sticky Note UpdateSlot Response\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[2720,2460],\"parameters\":{\"width\":230,\"height\":80,\"content\":\"Sends rescheduling confirmation/error back to Vapi.\"},\"typeVersion\":1},{\"id\":\"ca064fbe-b175-443f-b8e8-70a2a7551ba9\",\"name\":\"Sticky Note CallResults Webhook\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[440,4160],\"parameters\":{\"color\":2,\"width\":390,\"height\":120,\"content\":\"# Call Result logs\\nReceives call summary and recording details post-call.\"},\"typeVersion\":1},{\"id\":\"4941246b-82d1-4f16-b7b8-e1fdb6e7c833\",\"name\":\"Sticky Note CallResults Airtable\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[860,4460],\"parameters\":{\"width\":230,\"height\":80,\"content\":\"Logs call transcript, recording URL, summary, cost, customer number to Airtable.\"},\"typeVersion\":1},{\"id\":\"e5622e9e-9b0a-43b2-ab80-e3e33a4b0409\",\"name\":\"Getslot_tool\",\"type\":\"n8n-nodes-base.webhook\",\"position\":[260,740],\"webhookId\":\"42afdbc1-afd0-4d65-a713-cf7a59062d6c\",\"parameters\":{\"path\":\"getslots\",\"options\":{},\"httpMethod\":\"POST\",\"responseMode\":\"responseNode\"},\"typeVersion\":2},{\"id\":\"e15781cf-5405-4f60-aa6d-ba19d1b7dabc\",\"name\":\"Check Availability\",\"type\":\"n8n-nodes-base.googleCalendar\",\"position\":[800,740],\"parameters\":{\"options\":{},\"timeMax\":\"={{ $json.endtime.toDateTime() || $now.plus(1, 'hour').toISO() }}\",\"timeMin\":\"={{ $json.starttime.toDateTime() }}\",\"calendar\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"pratik@customaistudio.io\",\"cachedResultName\":\"pratik@customaistudio.io\"},\"resource\":\"calendar\"},\"credentials\":{},\"typeVersion\":1.3},{\"id\":\"1e064283-2964-4eba-a893-e4270157c603\",\"name\":\"Response\",\"type\":\"n8n-nodes-base.respondToWebhook\",\"position\":[1540,640],\"parameters\":{\"options\":{},\"respondWith\":\"json\",\"responseBody\":\"={\\n    \\\"results\\\":[\\n        {\\n            \\\"toolCallId\\\":\\\"{{ $('Getslot_tool').first().json.body.message.toolCalls[0].id }}\\\",\\n            \\\"result\\\":\\\"available:{{ $json.available }}\\\"\\n        }\\n    ]\\n}\"},\"typeVersion\":1.1},{\"id\":\"498401cb-00e5-4fdd-b6a9-dd3e91376993\",\"name\":\"Check if time is available or not\",\"type\":\"n8n-nodes-base.if\",\"position\":[1020,740],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"strict\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"4a8741a2-a903-4fb7-b0a3-5c74c7eea6ca\",\"operator\":{\"type\":\"boolean\",\"operation\":\"true\",\"singleValue\":true},\"leftValue\":\"={{ $json.available }}\",\"rightValue\":\"=\"}]}},\"typeVersion\":2.2},{\"id\":\"96e43c15-a332-4acf-af04-80dd989d5660\",\"name\":\"Time available (true) & Call_id\",\"type\":\"n8n-nodes-base.set\",\"position\":[1320,640],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"f582d965-af15-4ecf-8a8c-d8bf6c0d15c1\",\"name\":\"body.message.toolCalls[0].id\",\"type\":\"string\",\"value\":\"={{ $('Input Arguments').item.json.body.message.toolCalls[0].id }}\"},{\"id\":\"834ee925-5c8d-4e46-aeee-f399dc1ff40c\",\"name\":\"available\",\"type\":\"boolean\",\"value\":\"={{ $json.available }}\"}]}},\"typeVersion\":3.4},{\"id\":\"fb7ad8c6-9f78-4518-b955-60f3f7088cb9\",\"name\":\"Get All Calendar Events\",\"type\":\"n8n-nodes-base.googleCalendar\",\"position\":[1320,840],\"parameters\":{\"options\":{\"orderBy\":\"startTime\",\"timeMax\":\"={{ $now.plus(1, 'week').toISO() }}\",\"timeMin\":\"={{ $now.toISO() }}\",\"singleEvents\":true},\"calendar\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"pratik@customaistudio.io\",\"cachedResultName\":\"pratik@customaistudio.io\"},\"operation\":\"getAll\",\"returnAll\":true},\"credentials\":{},\"typeVersion\":1,\"alwaysOutputData\":true},{\"id\":\"390599ee-ddeb-4628-af0b-36fbdd357cee\",\"name\":\"Extract start, end and name\",\"type\":\"n8n-nodes-base.set\",\"position\":[1540,840],\"parameters\":{\"options\":{\"ignoreConversionErrors\":true},\"assignments\":{\"assignments\":[{\"id\":\"1045b97f-c76f-450e-8f57-008602000848\",\"name\":\"start\",\"type\":\"string\",\"value\":\"={{ DateTime.fromISO($json.start.dateTime).toLocaleString(DateTime.DATE_HUGE) }}, {{ DateTime.fromISO($json.start.dateTime).toLocaleString(DateTime.TIME_24_WITH_SHORT_OFFSET) }}\"},{\"id\":\"457e3a2b-d33e-4a65-b2da-d19ad9d754ac\",\"name\":\"end\",\"type\":\"string\",\"value\":\"={{ DateTime.fromISO($json.end.dateTime).toLocaleString(DateTime.DATE_HUGE) }}, {{ DateTime.fromISO($json.end.dateTime).toLocaleString(DateTime.TIME_24_WITH_SHORT_OFFSET) }}\"},{\"id\":\"b6802452-557e-4568-af14-4574e8ecc013\",\"name\":\"name\",\"type\":\"string\",\"value\":\"={{ $json.summary }}\"},{\"id\":\"799b656f-68b6-467c-88a1-217ff7c7801b\",\"name\":\"sort\",\"type\":\"string\",\"value\":\"={{ $json.start.dateTime }}\"}]}},\"typeVersion\":3.4},{\"id\":\"2c9a73da-37b7-4abd-af5e-695036cd2c2b\",\"name\":\"Convert into Json format for Vapi\",\"type\":\"n8n-nodes-base.code\",\"position\":[3120,840],\"parameters\":{\"jsCode\":\"// Get the input data for the first item\\nconst inputData = $input.first().json;\\nconsole.log(\\\"Input Data:\\\", inputData); // Log input for debugging\\n\\n// Access the message string from the correct path within the input structure.\\n// The input comes from the \\\"Build Response Payload\\\" node, which structures data under 'results'.\\n// Use optional chaining (?.) for safety in case the structure is not as expected.\\nlet message = inputData.results?.[0]?.result;\\n\\n// Check if the message was found and is a string\\nif (typeof message !== 'string') {\\n    console.error(\\\"Could not find the message string at inputData.results[0].result or it's not a string. Input:\\\", inputData);\\n    // Return an object with an empty message or an error indicator\\n    return { message: \\\"\\\" }; // Or potentially throw an error: throw new Error(\\\"Input message not found or not a string\\\");\\n}\\n\\n// Start cleaning the message string\\n\\n// 1. Replace the literal string \\\"\\\\\\\\n\\\" (backslash followed by n) with a space.\\n// This handles the newline representation seen in the input screenshot.\\nlet cleanedMessage = message.replace(/\\\\\\\\n/g, ' ');\\n\\n// 2. Remove spaces immediately surrounding colons (e.g., \\\"Times : \\\" becomes \\\"Times:\\\").\\ncleanedMessage = cleanedMessage.replace(/\\\\s*:\\\\s*/g, ':');\\n\\n// 3. Replace sequences of multiple whitespace characters (including spaces from replaced \\\\n)\\n// with a single space. Then, trim any leading or trailing whitespace from the result.\\ncleanedMessage = cleanedMessage.replace(/\\\\s+/g, ' ').trim();\\n\\n// Create the final output JSON object containing the cleaned message.\\nconst output = {\\n    message: cleanedMessage\\n};\\n\\n// Return the output object. This will be the output of the Code node.\\nreturn output;\"},\"typeVersion\":2},{\"id\":\"e00cf72a-af6a-441b-9b76-81bd8096d3df\",\"name\":\"Response to Vapi\",\"type\":\"n8n-nodes-base.respondToWebhook\",\"position\":[3360,840],\"parameters\":{\"options\":{},\"respondWith\":\"json\",\"responseBody\":\"={\\n    \\\"results\\\":[\\n        {\\n            \\\"toolCallId\\\":\\\"{{ $('Getslot_tool').first().json.body.message.toolCalls[0].id }}\\\",\\n            \\\"result\\\":\\\"The original time is not available, here are available slots:{{ $json.message }}\\\"\\n        }\\n    ]\\n}\"},\"typeVersion\":1.1},{\"id\":\"facf3bf9-e05e-4953-a221-bf7f566a3b0f\",\"name\":\"bookslots_tool\",\"type\":\"n8n-nodes-base.webhook\",\"position\":[400,1800],\"webhookId\":\"42afdbc1-afd0-4d65-a713-cf7a59062d6c\",\"parameters\":{\"path\":\"bookslots\",\"options\":{},\"httpMethod\":\"POST\",\"responseMode\":\"responseNode\"},\"typeVersion\":2},{\"id\":\"9266904b-300f-4c83-a518-4cd69b13de41\",\"name\":\"Input Arguments from booking tools\",\"type\":\"n8n-nodes-base.set\",\"position\":[720,1800],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"eac930a3-ba65-4b0d-b236-aa167d7edb3f\",\"name\":\"toolCallId\",\"type\":\"string\",\"value\":\"={{ $json.body.message.toolCalls[0].id }}\"},{\"id\":\"492186b8-e3a3-4ab9-87f4-45d8cbc38c13\",\"name\":\"timeZone\",\"type\":\"string\",\"value\":\"=America/Chicago\"},{\"id\":\"12aeec42-9414-4d43-8837-1ff747f49305\",\"name\":\"name\",\"type\":\"string\",\"value\":\"={{ $json.body.message.toolCalls[0].function.arguments.name || \\\"John Smith\\\" }}\"},{\"id\":\"36673f27-c026-4ad9-81da-ad11e71bbfb6\",\"name\":\"email\",\"type\":\"string\",\"value\":\"={{ $json.body.message.toolCalls[0].function.arguments.email }}\"},{\"id\":\"469ddc00-a399-47a5-8c55-97cd3adf4143\",\"name\":\"language\",\"type\":\"string\",\"value\":\"en\"},{\"id\":\"b191cd98-f3f7-48b1-a2e0-2c9e248a4983\",\"name\":\"notes\",\"type\":\"string\",\"value\":\"={{ $json.body.message.toolCalls[0].function.arguments.notes || \\\"\\\"}}\"},{\"id\":\"783cb161-65e4-4829-ac90-5c6c2c55585f\",\"name\":\"starttime\",\"type\":\"string\",\"value\":\"={{ $json.body.message.toolCalls[0].function.arguments.starttime }}\"},{\"id\":\"bfcdade9-14c8-4867-8a22-3865a2bcc116\",\"name\":\"endtime\",\"type\":\"string\",\"value\":\"={{ $json.body.message.toolCalls[0].function.arguments.endtime }}\"},{\"id\":\"26ca39ef-48f5-41ed-990e-40c2a26d6132\",\"name\":\"Tittle\",\"type\":\"string\",\"value\":\"={{ $json.body.message.toolCalls[0].function.arguments.Title }}\"},{\"id\":\"43575f7a-3873-4d74-90c5-4467c7779514\",\"name\":\"customer_number\",\"type\":\"string\",\"value\":\"={{ $json.body.message.call.customer.number }}\"}]}},\"typeVersion\":3.3},{\"id\":\"b4bc5cee-d631-4aa8-a3ff-59a0b647d36a\",\"name\":\"Convert time to CST America / Chicago\",\"type\":\"n8n-nodes-base.code\",\"position\":[1480,1580],\"parameters\":{\"jsCode\":\"// Get all input items\\nconst items = $input.all();\\n\\n// Loop through each item\\nfor (const item of items) {\\n  // Get the values from the current item's JSON data\\n  const startTimeUTC = item.json.starttime;\\n  const endTimeUTC = item.json.endtime;\\n  const targetTimeZone = item.json.timeZone; // e.g., \\\"America/Chicago\\\"\\n\\n  // Basic validation: ensure the necessary fields exist\\n  if (!startTimeUTC || !endTimeUTC || !targetTimeZone) {\\n    console.warn(`Skipping item due to missing time data or timezone. Item JSON: ${JSON.stringify(item.json)}`);\\n    item.json.conversionError = \\\"Missing starttime, endtime, or timeZone\\\";\\n    continue; // Move to the next item\\n  }\\n\\n  try {\\n    // --- Start Time Conversion ---\\n    // Parse the original UTC ISO string using Luxon (NO $ prefix)\\n    const startDt = luxon.DateTime.fromISO(startTimeUTC, { zone: 'utc' });\\n\\n    // Convert the DateTime object to the target timezone\\n    const startDtTargetZone = startDt.setZone(targetTimeZone);\\n\\n    // Check if the conversion was valid\\n    if (!startDtTargetZone.isValid) {\\n      throw new Error(`Failed to convert start time. Reason: ${startDtTargetZone.invalidReason || 'Unknown'}`);\\n    }\\n\\n    // Format the result back into an ISO string with the correct offset\\n    item.json.starttime = startDtTargetZone.toISO();\\n\\n    // --- End Time Conversion ---\\n    // Parse the original UTC ISO string using Luxon (NO $ prefix)\\n    const endDt = luxon.DateTime.fromISO(endTimeUTC, { zone: 'utc' });\\n\\n    // Convert the DateTime object to the target timezone\\n    const endDtTargetZone = endDt.setZone(targetTimeZone);\\n\\n     // Check if the conversion was valid\\n    if (!endDtTargetZone.isValid) {\\n      throw new Error(`Failed to convert end time. Reason: ${endDtTargetZone.invalidReason || 'Unknown'}`);\\n    }\\n\\n    // Format the result back into an ISO string with the correct offset\\n    item.json.endtime = endDtTargetZone.toISO();\\n\\n    // Optionally remove the error flag if conversion was successful this time\\n    delete item.json.conversionError;\\n\\n  } catch (error) {\\n    console.error(`Error converting time for item: ${JSON.stringify(item.json)}. Error: ${error.message}`);\\n    // Add/update the error flag to the item's JSON\\n    item.json.conversionError = error.message;\\n  }\\n}\\n// Return the modified array of items\\nreturn items;\"},\"typeVersion\":2},{\"id\":\"2c8b2884-14d3-4bd4-92d8-6e402ca3a8de\",\"name\":\"Create Event\",\"type\":\"n8n-nodes-base.googleCalendar\",\"onError\":\"continueErrorOutput\",\"position\":[1700,1580],\"parameters\":{\"end\":\"={{ $json.endtime }}\",\"start\":\"={{ $json.starttime }}\",\"calendar\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"pratik@customaistudio.io\",\"cachedResultName\":\"pratik@customaistudio.io\"},\"additionalFields\":{\"allday\":\"no\",\"summary\":\"={{ $json.Tittle }}\",\"showMeAs\":\"opaque\",\"attendees\":[\"={{ $json.email }}\"],\"description\":\"={{ $json.notes }}\",\"conferenceDataUi\":{\"conferenceDataValues\":{\"conferenceSolution\":\"hangoutsMeet\"}}}},\"credentials\":{},\"typeVersion\":1.3},{\"id\":\"b8890ab2-9850-4608-996d-45c8a6d3a52e\",\"name\":\"Respond to Vapi\",\"type\":\"n8n-nodes-base.respondToWebhook\",\"onError\":\"continueRegularOutput\",\"position\":[2480,1580],\"parameters\":{\"options\":{},\"respondWith\":\"json\",\"responseBody\":\"={\\n    \\\"results\\\":[\\n        {\\n            \\\"toolCallId\\\":\\\"{{ $json.results[0].toolCallId }}\\\",\\n            \\\"result\\\":\\\"available:{{ $json.results[0].result }}\\\"\\n        }\\n    ]\\n}\"},\"typeVersion\":1.1,\"alwaysOutputData\":true},{\"id\":\"77f75f42-46bb-47f5-8a43-55543ae46f10\",\"name\":\"If the booking is confirmed then true\",\"type\":\"n8n-nodes-base.if\",\"position\":[2700,1580],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"loose\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"932dd430-309b-4d3b-8bf6-768f84fd2dd2\",\"operator\":{\"name\":\"filter.operator.equals\",\"type\":\"string\",\"operation\":\"equals\"},\"leftValue\":\"={{ $json.results[0].result }}\",\"rightValue\":\"=confirmed\"}]},\"looseTypeValidation\":true},\"typeVersion\":2.2},{\"id\":\"230ddb29-67f0-4486-a6f3-f4dd3dbbee42\",\"name\":\"Information to be Saved in Airtable\",\"type\":\"n8n-nodes-base.set\",\"position\":[2940,1560],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"b103265d-86da-4256-994d-85a78f33f933\",\"name\":\"startTime\",\"type\":\"string\",\"value\":\"={{ $('Booking Payload').item.json.startTime }}\"},{\"id\":\"a8e6e9c5-6ebb-48d8-951f-b007bed2421d\",\"name\":\"endTime\",\"type\":\"string\",\"value\":\"={{ $('Booking Payload').item.json.endTime }}\"},{\"id\":\"d4bcb1d1-043a-4205-8488-0a67b4e7b582\",\"name\":\"status\",\"type\":\"string\",\"value\":\"={{ $('Booking Payload').item.json.status }}\"},{\"id\":\"92ac8c99-ad94-4b3c-9c5e-ba032dac2255\",\"name\":\"description\",\"type\":\"string\",\"value\":\"={{ $('Booking Payload').item.json.description }}\"},{\"id\":\"98c5653d-1e0e-4a6a-8630-17802d437593\",\"name\":\"attendees[0].email\",\"type\":\"string\",\"value\":\"={{ $('Booking Payload').item.json.attendees[0].email }}\"},{\"id\":\"f94bdfc1-dc74-4675-ad29-19244fb21ebe\",\"name\":\"attendees[0].responseStatus\",\"type\":\"string\",\"value\":\"={{ $('Booking Payload').item.json.attendees[0].responseStatus }}\"},{\"id\":\"12bd5ed5-4934-4c19-a9b9-54fe989eaa4f\",\"name\":\"hangoutLink\",\"type\":\"string\",\"value\":\"={{ $('Booking Payload').item.json.hangoutLink }}\"},{\"id\":\"5b1f9356-7d62-4999-ae4e-86f3f20d72bf\",\"name\":\"attendee.name\",\"type\":\"string\",\"value\":\"={{ $('bookslots_tool').item.json.body.message.toolCalls[0].function.arguments.name }}\"},{\"id\":\"6e93805e-8754-4f92-870f-7b46525f3eb3\",\"name\":\"call.id\",\"type\":\"string\",\"value\":\"={{ $('bookslots_tool').item.json.body.message.call.id }}\"},{\"id\":\"f174e2be-3230-4fc9-970b-971aff6e9b8e\",\"name\":\"assistant.name\",\"type\":\"string\",\"value\":\"={{ $('bookslots_tool').item.json.body.message.assistant.name }}\"},{\"id\":\"a4bc9d70-7d51-487f-b622-433e767ef71f\",\"name\":\"event.id\",\"type\":\"string\",\"value\":\"={{ $('Create Event').item.json.id }}\"},{\"id\":\"9259b1d3-3658-4ab5-b434-364e6a84d145\",\"name\":\"Title\",\"type\":\"string\",\"value\":\"={{ $('Booking Payload').item.json.Title }}\"},{\"id\":\"2102a7be-5d74-458f-bafd-21651e24adb1\",\"name\":\"customer_number\",\"type\":\"string\",\"value\":\"={{ $('Input Arguments from booking tools').item.json.customer_number}}\"}]}},\"typeVersion\":3.4},{\"id\":\"f6c7774d-a8c7-466a-ba77-401194fe6fb4\",\"name\":\"Logs the confirmed booking details\",\"type\":\"n8n-nodes-base.airtable\",\"position\":[3160,1560],\"parameters\":{\"base\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"appnj853UnMRnJ8D3\",\"cachedResultUrl\":\"https://airtable.com/appnj853UnMRnJ8D3\",\"cachedResultName\":\"Voice Receptionist Agent\"},\"table\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"tblF8LF9lmkHMbk7v\",\"cachedResultUrl\":\"https://airtable.com/appnj853UnMRnJ8D3/tblF8LF9lmkHMbk7v\",\"cachedResultName\":\"Appointments\"},\"columns\":{\"value\":{\"Name\":\"={{ $json.attendee.name }}\",\"Email\":\"={{ $json.attendees[0].email }}\",\"endtime\":\"={{ $json.endTime }}\",\"eventId\":\"={{ $json.event.id }}\",\"meetlink\":\"={{ $json.hangoutLink }}\",\"starttime\":\"={{ $json.startTime }}\",\"Voice Agent\":\"={{ [$json.assistant.name] }}\",\"Phone Number\":\"={{ $json.customer_number }}\",\"Booking Status\":\"={{ $json.status }}\",\"CallRecordingId\":\"={{ [$json.call.id] }}\",\"meetdescription\":\"={{ $json.Title }} {{ $json.description }}\"},\"schema\":[{\"id\":\"Email\",\"type\":\"string\",\"display\":true,\"removed\":false,\"readOnly\":false,\"required\":false,\"displayName\":\"Email\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Phone Number\",\"type\":\"string\",\"display\":true,\"removed\":false,\"readOnly\":false,\"required\":false,\"displayName\":\"Phone Number\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Name\",\"type\":\"string\",\"display\":true,\"removed\":false,\"readOnly\":false,\"required\":false,\"displayName\":\"Name\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Booking Status\",\"type\":\"string\",\"display\":true,\"removed\":false,\"readOnly\":false,\"required\":false,\"displayName\":\"Booking Status\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"CallRecordingId\",\"type\":\"array\",\"display\":true,\"removed\":false,\"readOnly\":false,\"required\":false,\"displayName\":\"CallRecordingId\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"starttime\",\"type\":\"dateTime\",\"display\":true,\"removed\":false,\"readOnly\":false,\"required\":false,\"displayName\":\"starttime\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"endtime\",\"type\":\"dateTime\",\"display\":true,\"removed\":false,\"readOnly\":false,\"required\":false,\"displayName\":\"endtime\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"meetlink\",\"type\":\"string\",\"display\":true,\"removed\":false,\"readOnly\":false,\"required\":false,\"displayName\":\"meetlink\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"meetdescription\",\"type\":\"string\",\"display\":true,\"removed\":false,\"readOnly\":false,\"required\":false,\"displayName\":\"meetdescription\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Voice Agent\",\"type\":\"array\",\"display\":true,\"removed\":false,\"readOnly\":false,\"required\":false,\"displayName\":\"Voice Agent\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"eventId\",\"type\":\"string\",\"display\":true,\"removed\":false,\"readOnly\":false,\"required\":false,\"displayName\":\"eventId\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Appointments\",\"type\":\"string\",\"display\":true,\"removed\":true,\"readOnly\":true,\"required\":false,\"displayName\":\"Appointments\",\"defaultMatch\":false,\"canBeUsedToMatch\":true}],\"mappingMode\":\"defineBelow\",\"matchingColumns\":[\"Email\"],\"attemptToConvertTypes\":false,\"convertFieldsToString\":false},\"options\":{\"typecast\":true},\"operation\":\"create\"},\"credentials\":{},\"typeVersion\":2.1},{\"id\":\"154bee14-9281-4b92-8204-57c5436785ba\",\"name\":\"Updateslots_tool\",\"type\":\"n8n-nodes-base.webhook\",\"position\":[460,2720],\"webhookId\":\"66b278fe-97d1-4413-b6dd-4288d8ec66b2\",\"parameters\":{\"path\":\"updateslots\",\"options\":{},\"httpMethod\":\"POST\",\"responseMode\":\"responseNode\"},\"typeVersion\":2},{\"id\":\"891fb4ec-3a82-4433-bebf-3f0616027e3d\",\"name\":\"Input Arguments from updateslot tool\",\"type\":\"n8n-nodes-base.set\",\"position\":[840,2720],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"6f6388ab-a233-4643-9b28-917ad6bdfe22\",\"name\":\"Calls[0].id\",\"type\":\"string\",\"value\":\"={{ $json.body.message.toolCalls[0].id }}\"},{\"id\":\"40888d2c-b99d-401d-a6b9-944ba41543c6\",\"name\":\"name\",\"type\":\"string\",\"value\":\"={{ $json.body.message.toolCalls[0].function.arguments.name }}\"},{\"id\":\"17be6cf6-8c48-4a4e-a0e8-b5b714f94242\",\"name\":\"email\",\"type\":\"string\",\"value\":\"={{ $json.body.message.toolCalls[0].function.arguments.email }}\"},{\"id\":\"d06fd547-39c1-457b-8422-393f140aead6\",\"name\":\"starttime\",\"type\":\"string\",\"value\":\"={{ $json.body.message.toolCalls[0].function.arguments.starttime }}\"},{\"id\":\"c224df67-ec82-40f3-9af2-3472731a57fa\",\"name\":\"endtime\",\"type\":\"string\",\"value\":\"={{ $json.body.message.toolCalls[0].function.arguments.endtime }}\"},{\"id\":\"b2fb0887-5545-409c-bba8-fae76a71f660\",\"name\":\"call.id\",\"type\":\"string\",\"value\":\"={{ $json.body.message.call.id }}\"},{\"id\":\"19efa4c6-25e0-4fe8-a00e-0b37f16b6de0\",\"name\":\"Rescheduled_starttime\",\"type\":\"string\",\"value\":\"={{ $json.body.message.toolCalls[0].function.arguments.Rescheduled_starttime }}\"},{\"id\":\"ad47dfdb-66fa-478d-899f-1d9d202aac6f\",\"name\":\"Rescheduled_endttime\",\"type\":\"string\",\"value\":\"={{ $json.body.message.toolCalls[0].function.arguments.Rescheduled_endttime }}\"},{\"id\":\"6d1bf6c0-a4b4-41d4-826e-e7c73f920905\",\"name\":\"customer_number\",\"type\":\"string\",\"value\":\"={{ $json.body.message.call.customer.number }}\"}]}},\"typeVersion\":3.4},{\"id\":\"617a7742-299a-4c91-be82-cba598d1bb82\",\"name\":\"Checks if required info is provided.\",\"type\":\"n8n-nodes-base.if\",\"position\":[1060,2720],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"loose\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"87304425-5f17-4637-8aa3-cd84b2f8d856\",\"operator\":{\"type\":\"string\",\"operation\":\"exists\",\"singleValue\":true},\"leftValue\":\"={{ $json.name }}\",\"rightValue\":\"\"},{\"id\":\"fdc6ffb0-f234-4869-8f5e-482c394ab860\",\"operator\":{\"type\":\"string\",\"operation\":\"exists\",\"singleValue\":true},\"leftValue\":\"={{ $json.email }}\",\"rightValue\":\"\"},{\"id\":\"7950d7bc-7416-48b6-8ec5-a635a9161013\",\"operator\":{\"type\":\"dateTime\",\"operation\":\"exists\",\"singleValue\":true},\"leftValue\":\"={{ $json.Rescheduled_starttime }}\",\"rightValue\":\"={{ $json.Rescheduledtime }}\"},{\"id\":\"aa54ee15-1273-48b0-863f-939597af04e6\",\"operator\":{\"type\":\"dateTime\",\"operation\":\"exists\",\"singleValue\":true},\"leftValue\":\"={{ $json.Rescheduled_endttime }}\",\"rightValue\":\"\"},{\"id\":\"8ceefa9d-360c-48b6-8faf-e156459f2c07\",\"operator\":{\"type\":\"dateTime\",\"operation\":\"exists\",\"singleValue\":true},\"leftValue\":\"={{ $json.starttime }}\",\"rightValue\":\"\"}]},\"looseTypeValidation\":true},\"typeVersion\":2.2},{\"id\":\"dded1cfa-ce89-481f-967b-6843854a32bd\",\"name\":\"Finds original appointment\",\"type\":\"n8n-nodes-base.airtable\",\"maxTries\":2,\"position\":[1600,2560],\"parameters\":{\"base\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"appnj853UnMRnJ8D3\",\"cachedResultUrl\":\"https://airtable.com/appnj853UnMRnJ8D3\",\"cachedResultName\":\"Voice Receptionist Agent\"},\"table\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"tblF8LF9lmkHMbk7v\",\"cachedResultUrl\":\"https://airtable.com/appnj853UnMRnJ8D3/tblF8LF9lmkHMbk7v\",\"cachedResultName\":\"Appointments\"},\"options\":{\"fields\":[\"Email\",\"Name\",\"starttime\",\"eventId\"]},\"operation\":\"search\",\"filterByFormula\":\"={Phone Number} = (\\\"{{ $json.customer_number }}\\\")\"},\"credentials\":{},\"retryOnFail\":false,\"typeVersion\":2.1,\"alwaysOutputData\":false},{\"id\":\"a3fd9971-20bb-414a-b06c-1af4da053241\",\"name\":\"Response with Error\",\"type\":\"n8n-nodes-base.respondToWebhook\",\"position\":[1780,2840],\"parameters\":{\"options\":{}},\"typeVersion\":1.1},{\"id\":\"0731f0ae-fbdb-4149-890a-0a44c95b2691\",\"name\":\"Update Event\",\"type\":\"n8n-nodes-base.googleCalendar\",\"onError\":\"continueErrorOutput\",\"position\":[1980,2560],\"parameters\":{\"eventId\":\"={{ $json.eventId }}\",\"calendar\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"pratik@customaistudio.io\",\"cachedResultName\":\"pratik@customaistudio.io\"},\"operation\":\"update\",\"updateFields\":{\"end\":\"={{ $('Checks if required info is provided.').item.json.Rescheduled_endttime }}\",\"start\":\"={{ $('Checks if required info is provided.').item.json.Rescheduled_starttime }}\",\"allday\":\"no\"}},\"credentials\":{},\"typeVersion\":1.3},{\"id\":\"1e7af704-6c5d-4e6b-a606-2c5c7ef64b10\",\"name\":\"Updates Airtable record\",\"type\":\"n8n-nodes-base.airtable\",\"position\":[2280,2440],\"parameters\":{\"base\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"appnj853UnMRnJ8D3\",\"cachedResultUrl\":\"https://airtable.com/appnj853UnMRnJ8D3\",\"cachedResultName\":\"Voice Receptionist Agent\"},\"table\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"tblF8LF9lmkHMbk7v\",\"cachedResultUrl\":\"https://airtable.com/appnj853UnMRnJ8D3/tblF8LF9lmkHMbk7v\",\"cachedResultName\":\"Appointments\"},\"columns\":{\"value\":{\"endtime\":\"={{ $json.end.dateTime }}\",\"eventId\":\"={{ $('Finds original appointment').item.json.eventId }}\",\"starttime\":\"={{ $json.start.dateTime }}\",\"Booking Status\":\"Updated/Rescheduled\"},\"schema\":[{\"id\":\"id\",\"type\":\"string\",\"display\":true,\"removed\":true,\"readOnly\":true,\"required\":false,\"displayName\":\"id\",\"defaultMatch\":true},{\"id\":\"Email\",\"type\":\"string\",\"display\":true,\"removed\":true,\"readOnly\":false,\"required\":false,\"displayName\":\"Email\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Phone Number\",\"type\":\"string\",\"display\":true,\"removed\":true,\"readOnly\":false,\"required\":false,\"displayName\":\"Phone Number\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Name\",\"type\":\"string\",\"display\":true,\"removed\":true,\"readOnly\":false,\"required\":false,\"displayName\":\"Name\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Booking Status\",\"type\":\"string\",\"display\":true,\"removed\":false,\"readOnly\":false,\"required\":false,\"displayName\":\"Booking Status\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"CallRecordingId\",\"type\":\"array\",\"display\":true,\"removed\":true,\"readOnly\":false,\"required\":false,\"displayName\":\"CallRecordingId\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"starttime\",\"type\":\"dateTime\",\"display\":true,\"removed\":false,\"readOnly\":false,\"required\":false,\"displayName\":\"starttime\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"endtime\",\"type\":\"dateTime\",\"display\":true,\"removed\":false,\"readOnly\":false,\"required\":false,\"displayName\":\"endtime\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"meetlink\",\"type\":\"string\",\"display\":true,\"removed\":true,\"readOnly\":false,\"required\":false,\"displayName\":\"meetlink\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"meetdescription\",\"type\":\"string\",\"display\":true,\"removed\":true,\"readOnly\":false,\"required\":false,\"displayName\":\"meetdescription\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Voice Agent\",\"type\":\"array\",\"display\":true,\"removed\":true,\"readOnly\":false,\"required\":false,\"displayName\":\"Voice Agent\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"eventId\",\"type\":\"string\",\"display\":true,\"removed\":false,\"readOnly\":false,\"required\":false,\"displayName\":\"eventId\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Appointments\",\"type\":\"string\",\"display\":true,\"removed\":true,\"readOnly\":true,\"required\":false,\"displayName\":\"Appointments\",\"defaultMatch\":false,\"canBeUsedToMatch\":true}],\"mappingMode\":\"defineBelow\",\"matchingColumns\":[\"eventId\"],\"attemptToConvertTypes\":false,\"convertFieldsToString\":false},\"options\":{},\"operation\":\"update\"},\"credentials\":{},\"typeVersion\":2.1},{\"id\":\"5a74d949-f08e-422c-afde-e41690a8512b\",\"name\":\"Response & call_id\",\"type\":\"n8n-nodes-base.set\",\"position\":[2620,2580],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"074d1ef3-e96b-4149-a12c-b8aa71c9c117\",\"name\":\"results[0].toolCallId\",\"type\":\"string\",\"value\":\"={{ $('Updateslots_tool').item.json.body.message.toolCalls[0].id }}\"},{\"id\":\"098bb88d-9b17-4aeb-850c-819406aa0f3b\",\"name\":\"results[0].result\",\"type\":\"string\",\"value\":\"={{ $json.error || $json.fields['Booking Status']  }}\"}]}},\"typeVersion\":3.4},{\"id\":\"bb7dc099-c4ac-48d4-bf8c-50f4f8858dd4\",\"name\":\"Respond to Vapi about Updating slots\",\"type\":\"n8n-nodes-base.respondToWebhook\",\"position\":[2820,2580],\"parameters\":{\"options\":{},\"respondWith\":\"json\",\"responseBody\":\"={\\n    \\\"results\\\":[\\n        {\\n            \\\"toolCallId\\\":\\\"{{ $json.results[0].toolCallId }}\\\",\\n            \\\"result\\\":\\\"{{ $json.results[0].result }}\\\"\\n        }\\n    ]\\n}\"},\"typeVersion\":1.1},{\"id\":\"2154c9c8-acd3-4144-9fa6-f6f7de7bbf48\",\"name\":\"CancelSlots_tool\",\"type\":\"n8n-nodes-base.webhook\",\"position\":[440,3620],\"webhookId\":\"00fedd5a-c03d-4302-b8e0-22c79f26ed05\",\"parameters\":{\"path\":\"cancelslots\",\"options\":{},\"httpMethod\":\"POST\",\"responseMode\":\"responseNode\"},\"typeVersion\":2},{\"id\":\"aeabd266-4b0e-436f-9c8c-607fb7b6734a\",\"name\":\"Input Arguments from cancelslot tool\",\"type\":\"n8n-nodes-base.set\",\"position\":[800,3620],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"6f6388ab-a233-4643-9b28-917ad6bdfe22\",\"name\":\"Calls[0].id\",\"type\":\"string\",\"value\":\"={{ $json.body.message.toolCalls[0].id }}\"},{\"id\":\"40888d2c-b99d-401d-a6b9-944ba41543c6\",\"name\":\"name\",\"type\":\"string\",\"value\":\"={{ $json.body.message.toolCalls[0].function.arguments.name }}\"},{\"id\":\"17be6cf6-8c48-4a4e-a0e8-b5b714f94242\",\"name\":\"email\",\"type\":\"string\",\"value\":\"={{ $json.body.message.toolCalls[0].function.arguments.email }}\"},{\"id\":\"d06fd547-39c1-457b-8422-393f140aead6\",\"name\":\"starttime\",\"type\":\"string\",\"value\":\"={{ $json.body.message.toolCalls[0].function.arguments.starttime }}\"},{\"id\":\"0a0243b2-afc4-44f1-92cd-81572df79cc5\",\"name\":\"Cancelnotes\",\"type\":\"string\",\"value\":\"={{ $json.body.message.toolCalls[0].function.arguments.Cancelnotes }}\"},{\"id\":\"b2fb0887-5545-409c-bba8-fae76a71f660\",\"name\":\"call.id\",\"type\":\"string\",\"value\":\"={{ $json.body.message.call.id }}\"},{\"id\":\"8d528786-75d7-466e-8e8f-2013e4638bc2\",\"name\":\"customer_number\",\"type\":\"string\",\"value\":\"={{ $json.body.message.call.customer.number }}\"}]}},\"typeVersion\":3.4},{\"id\":\"b702973e-15f0-4bbe-98ac-d4af7a57cff1\",\"name\":\"Checks if required info is provided for cancelation\",\"type\":\"n8n-nodes-base.if\",\"position\":[1020,3620],\"parameters\":{\"options\":{},\"conditions\":{\"options\":{\"version\":2,\"leftValue\":\"\",\"caseSensitive\":true,\"typeValidation\":\"loose\"},\"combinator\":\"and\",\"conditions\":[{\"id\":\"87304425-5f17-4637-8aa3-cd84b2f8d856\",\"operator\":{\"type\":\"string\",\"operation\":\"exists\",\"singleValue\":true},\"leftValue\":\"={{ $json.name }}\",\"rightValue\":\"\"},{\"id\":\"fdc6ffb0-f234-4869-8f5e-482c394ab860\",\"operator\":{\"type\":\"string\",\"operation\":\"exists\",\"singleValue\":true},\"leftValue\":\"={{ $json.email }}\",\"rightValue\":\"\"},{\"id\":\"c0b869e4-9490-4c01-b138-835bb34eb1ba\",\"operator\":{\"type\":\"dateTime\",\"operation\":\"exists\",\"singleValue\":true},\"leftValue\":\"={{ $json.starttime }}\",\"rightValue\":\"\"}]},\"looseTypeValidation\":true},\"typeVersion\":2.2},{\"id\":\"c5e49060-7b76-4622-bc23-b389f1665215\",\"name\":\"Finds the appointment record\",\"type\":\"n8n-nodes-base.airtable\",\"position\":[1300,3560],\"parameters\":{\"base\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"appnj853UnMRnJ8D3\",\"cachedResultUrl\":\"https://airtable.com/appnj853UnMRnJ8D3\",\"cachedResultName\":\"Voice Receptionist Agent\"},\"table\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"tblF8LF9lmkHMbk7v\",\"cachedResultUrl\":\"https://airtable.com/appnj853UnMRnJ8D3/tblF8LF9lmkHMbk7v\",\"cachedResultName\":\"Appointments\"},\"options\":{\"fields\":[\"Email\",\"Name\",\"starttime\",\"eventId\"]},\"operation\":\"search\",\"filterByFormula\":\"={Phone Number} = (\\\"{{ $json.customer_number }}\\\")\"},\"credentials\":{},\"typeVersion\":2.1,\"alwaysOutputData\":true},{\"id\":\"dd83c017-6f5b-49b4-83f9-ec2f33ca5ed0\",\"name\":\"Build Error Response\",\"type\":\"n8n-nodes-base.set\",\"position\":[1300,3780],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"5cb05b10-e916-459e-84a2-9c314a859a07\",\"name\":\"results[0].toolCallId\",\"type\":\"string\",\"value\":\"={{ $('Input Arguments from booking tools').item.json.toolCallId }}\"},{\"id\":\"552246f9-7afd-404e-9fb3-cb38c7447359\",\"name\":\"results[0].result\",\"type\":\"string\",\"value\":\"=You must provide an email, name and starttime to call this tool\"}]}},\"typeVersion\":3.4},{\"id\":\"ca74e845-ee23-4f8a-ba8e-789186fe7add\",\"name\":\"Respond with Error to Vapi\",\"type\":\"n8n-nodes-base.respondToWebhook\",\"position\":[1500,3780],\"parameters\":{\"options\":{}},\"typeVersion\":1.1},{\"id\":\"ad3c2ad0-ba5e-48a6-865f-a8da63173562\",\"name\":\"Delete Event\",\"type\":\"n8n-nodes-base.googleCalendar\",\"onError\":\"continueErrorOutput\",\"position\":[1720,3560],\"parameters\":{\"eventId\":\"={{ $json.eventId }}\",\"options\":{\"sendUpdates\":\"all\"},\"calendar\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"pratik@customaistudio.io\",\"cachedResultName\":\"pratik@customaistudio.io\"},\"operation\":\"delete\"},\"credentials\":{},\"typeVersion\":1.3},{\"id\":\"177a1297-8e96-4d04-a0ff-e16aab71d5b9\",\"name\":\"Update Airtable record\",\"type\":\"n8n-nodes-base.airtable\",\"position\":[1940,3440],\"parameters\":{\"base\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"appnj853UnMRnJ8D3\",\"cachedResultUrl\":\"https://airtable.com/appnj853UnMRnJ8D3\",\"cachedResultName\":\"Voice Receptionist Agent\"},\"table\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"tblF8LF9lmkHMbk7v\",\"cachedResultUrl\":\"https://airtable.com/appnj853UnMRnJ8D3/tblF8LF9lmkHMbk7v\",\"cachedResultName\":\"Appointments\"},\"columns\":{\"value\":{\"eventId\":\"={{ $('Finds the appointment record').item.json.eventId }}\",\"Booking Status\":\"Canceled\"},\"schema\":[{\"id\":\"id\",\"type\":\"string\",\"display\":true,\"removed\":true,\"readOnly\":true,\"required\":false,\"displayName\":\"id\",\"defaultMatch\":true},{\"id\":\"Email\",\"type\":\"string\",\"display\":true,\"removed\":true,\"readOnly\":false,\"required\":false,\"displayName\":\"Email\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Phone Number\",\"type\":\"string\",\"display\":true,\"removed\":true,\"readOnly\":false,\"required\":false,\"displayName\":\"Phone Number\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Name\",\"type\":\"string\",\"display\":true,\"removed\":true,\"readOnly\":false,\"required\":false,\"displayName\":\"Name\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Booking Status\",\"type\":\"string\",\"display\":true,\"removed\":false,\"readOnly\":false,\"required\":false,\"displayName\":\"Booking Status\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"CallRecordingId\",\"type\":\"array\",\"display\":true,\"removed\":true,\"readOnly\":false,\"required\":false,\"displayName\":\"CallRecordingId\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"starttime\",\"type\":\"dateTime\",\"display\":true,\"removed\":true,\"readOnly\":false,\"required\":false,\"displayName\":\"starttime\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"endtime\",\"type\":\"dateTime\",\"display\":true,\"removed\":true,\"readOnly\":false,\"required\":false,\"displayName\":\"endtime\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"meetlink\",\"type\":\"string\",\"display\":true,\"removed\":true,\"readOnly\":false,\"required\":false,\"displayName\":\"meetlink\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"meetdescription\",\"type\":\"string\",\"display\":true,\"removed\":true,\"readOnly\":false,\"required\":false,\"displayName\":\"meetdescription\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Voice Agent\",\"type\":\"array\",\"display\":true,\"removed\":true,\"readOnly\":false,\"required\":false,\"displayName\":\"Voice Agent\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"eventId\",\"type\":\"string\",\"display\":true,\"removed\":false,\"readOnly\":false,\"required\":false,\"displayName\":\"eventId\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Appointments\",\"type\":\"string\",\"display\":true,\"removed\":true,\"readOnly\":true,\"required\":false,\"displayName\":\"Appointments\",\"defaultMatch\":false,\"canBeUsedToMatch\":true}],\"mappingMode\":\"defineBelow\",\"matchingColumns\":[\"eventId\"],\"attemptToConvertTypes\":false,\"convertFieldsToString\":false},\"options\":{},\"operation\":\"update\"},\"credentials\":{},\"typeVersion\":2.1},{\"id\":\"4d0c155c-68ad-4f70-b9c6-0dbd4db70fd1\",\"name\":\"Call_id & Response\",\"type\":\"n8n-nodes-base.set\",\"position\":[2160,3580],\"parameters\":{\"options\":{},\"assignments\":{\"assignments\":[{\"id\":\"074d1ef3-e96b-4149-a12c-b8aa71c9c117\",\"name\":\"results[0].toolCallId\",\"type\":\"string\",\"value\":\"={{ $('CancelSlots_tool').item.json.body.message.toolCalls[0].id }}\"},{\"id\":\"098bb88d-9b17-4aeb-850c-819406aa0f3b\",\"name\":\"results[0].result\",\"type\":\"string\",\"value\":\"={{ $json.error || $json.fields['Booking Status']  }}\"}]}},\"typeVersion\":3.4},{\"id\":\"41ff13bf-0793-4082-8be6-51f0617ab0f8\",\"name\":\"Respond to Vapi about cancelation\",\"type\":\"n8n-nodes-base.respondToWebhook\",\"position\":[2400,3580],\"parameters\":{\"options\":{},\"respondWith\":\"json\",\"responseBody\":\"={\\n    \\\"results\\\":[\\n        {\\n            \\\"toolCallId\\\":\\\"{{ $json.results[0].toolCallId }}\\\",\\n            \\\"result\\\":\\\"{{ $json.results[0].result }}\\\"\\n        }\\n    ]\\n}\"},\"typeVersion\":1.1},{\"id\":\"599592b1-214c-4e99-84f6-e244e690ed79\",\"name\":\"call_results\",\"type\":\"n8n-nodes-base.webhook\",\"position\":[440,4300],\"webhookId\":\"4a6205cd-4277-4686-8008-540b802b99fe\",\"parameters\":{\"path\":\"callresults\",\"options\":{},\"httpMethod\":\"POST\"},\"typeVersion\":2},{\"id\":\"baf3ce79-f302-42ad-bb7e-49f2d9197eae\",\"name\":\"All Input Arguments\",\"type\":\"n8n-nodes-base.set\",\"position\":[720,4300],\"parameters\":{\"options\":{\"ignoreConversionErrors\":true},\"assignments\":{\"assignments\":[{\"id\":\"fd00208a-e833-4834-8c37-0034c44fb47d\",\"name\":\"transcript\",\"type\":\"string\",\"value\":\"={{ $json.body.message.artifact.transcript }}\"},{\"id\":\"b72ffa4d-aef3-4d7c-8b81-9238a3c5890b\",\"name\":\"recordingUrl\",\"type\":\"string\",\"value\":\"={{ $json.body.message.artifact.recordingUrl }}\"},{\"id\":\"e45d90de-0103-46ba-9fcb-f4c969816da0\",\"name\":\"call.summary\",\"type\":\"string\",\"value\":\"={{ $json.body.message.analysis.summary }}\"},{\"id\":\"b0a5557f-483f-47c9-955a-c12ce84f270b\",\"name\":\"cost\",\"type\":\"number\",\"value\":\"={{ $json.body.message.cost }}\"},{\"id\":\"2bfcfe4f-4eaf-4274-b3f2-cdaea8c2cc46\",\"name\":\"call.id\",\"type\":\"string\",\"value\":\"={{ $json.body.message.call.id }}\"},{\"id\":\"2b7b1638-0d0e-4c48-9989-287fd4e0babd\",\"name\":\"call.orgId\",\"type\":\"string\",\"value\":\"={{ $json.body.message.call.orgId }}\"},{\"id\":\"adf4d062-bbfd-4f97-bda4-bdfec1e40ee4\",\"name\":\"assistant.name\",\"type\":\"string\",\"value\":\"={{ $json.body.message.assistant.name }}\"},{\"id\":\"3c2af504-d320-45f0-9008-79b3bc1ff897\",\"name\":\"startedAt\",\"type\":\"string\",\"value\":\"={{ $json.body.message.startedAt }}\"},{\"id\":\"0486dbfa-ca10-45b5-a79a-3ce1064f13fa\",\"name\":\"endedAt\",\"type\":\"string\",\"value\":\"={{ $json.body.message.endedAt }}\"},{\"id\":\"bf97b5eb-5baa-4a87-b34e-2f64c97c0d42\",\"name\":\"assistant.id\",\"type\":\"string\",\"value\":\"={{ $json.body.message.assistant.id }}\"},{\"id\":\"58ee9b29-7aa1-4a15-bf83-606287a964a6\",\"name\":\"assistant.model\",\"type\":\"string\",\"value\":\"={{ $json.body.message.assistant.model.model }}\"},{\"id\":\"36e2bbef-e12d-4fc4-a0af-bb65aa446023\",\"name\":\"body.message.assistant\",\"type\":\"object\",\"value\":\"={{ $json.body.message.assistant }}\"},{\"id\":\"dfa93dbb-67dc-417b-874a-32fbd55d92b0\",\"name\":\"assistantId\",\"type\":\"string\",\"value\":\"={{ $json.body.message.call.assistantId }}\"},{\"id\":\"4bc2b480-92a1-470e-bdf0-d6609f346ed2\",\"name\":\"body.message.assistant.model.emotionRecognitionEnabled\",\"type\":\"boolean\",\"value\":\"={{ $json.body.message.assistant.model.emotionRecognitionEnabled }}\"},{\"id\":\"acb64bba-e295-4dd0-9ab3-b4166ef5d0ad\",\"name\":\"customer.number\",\"type\":\"string\",\"value\":\"={{ $json.body.message.call.customer.number }}\"}]}},\"typeVersion\":3.4},{\"id\":\"f3394750-7438-47e9-8aa3-996accfa9bac\",\"name\":\"Save all information\",\"type\":\"n8n-nodes-base.airtable\",\"position\":[900,4300],\"parameters\":{\"base\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"appnj853UnMRnJ8D3\",\"cachedResultUrl\":\"https://airtable.com/appnj853UnMRnJ8D3\",\"cachedResultName\":\"Voice Receptionist Agent\"},\"table\":{\"__rl\":true,\"mode\":\"list\",\"value\":\"tbl1b6vMhq9IT9JEZ\",\"cachedResultUrl\":\"https://airtable.com/appnj853UnMRnJ8D3/tbl1b6vMhq9IT9JEZ\",\"cachedResultName\":\"Call Recording\"},\"columns\":{\"value\":{\"Cost\":\"={{ $json.cost }}\",\"endedAt\":\"={{ $json.endedAt }}\",\"startedAt\":\"={{ $json.startedAt }}\",\"transcript\":\"={{ $json.transcript }}\",\"callsummary\":\"={{ $json.call.summary }}\",\"customer_Number\":\"={{ $json.customer.number }}\",\"callrecording_id\":\"={{ $json.call.id }}\",\"Call recording Url\":\"={{ $json.recordingUrl }}\"},\"schema\":[{\"id\":\"id\",\"type\":\"string\",\"display\":true,\"removed\":true,\"readOnly\":true,\"required\":false,\"displayName\":\"id\",\"defaultMatch\":true},{\"id\":\"callrecording_id\",\"type\":\"string\",\"display\":true,\"removed\":false,\"readOnly\":false,\"required\":false,\"displayName\":\"callrecording_id\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Cost\",\"type\":\"number\",\"display\":true,\"removed\":false,\"readOnly\":false,\"required\":false,\"displayName\":\"Cost\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Call recording Url\",\"type\":\"string\",\"display\":true,\"removed\":false,\"readOnly\":false,\"required\":false,\"displayName\":\"Call recording Url\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"transcript\",\"type\":\"string\",\"display\":true,\"removed\":false,\"readOnly\":false,\"required\":false,\"displayName\":\"transcript\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"customer_Number\",\"type\":\"string\",\"display\":true,\"removed\":false,\"readOnly\":false,\"required\":false,\"displayName\":\"customer_Number\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Appointments\",\"type\":\"array\",\"display\":true,\"removed\":true,\"readOnly\":false,\"required\":false,\"displayName\":\"Appointments\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Appointment time (from Appointments)\",\"type\":\"string\",\"display\":true,\"removed\":true,\"readOnly\":true,\"required\":false,\"displayName\":\"Appointment time (from Appointments)\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"Voice Agent (from Appointments)\",\"type\":\"string\",\"display\":true,\"removed\":true,\"readOnly\":true,\"required\":false,\"displayName\":\"Voice Agent (from Appointments)\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"startedAt\",\"type\":\"dateTime\",\"display\":true,\"removed\":false,\"readOnly\":false,\"required\":false,\"displayName\":\"startedAt\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"endedAt\",\"type\":\"dateTime\",\"display\":true,\"removed\":false,\"readOnly\":false,\"required\":false,\"displayName\":\"endedAt\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"call_Length (in secs)\",\"type\":\"string\",\"display\":true,\"removed\":true,\"readOnly\":true,\"required\":false,\"displayName\":\"call_Length (in secs)\",\"defaultMatch\":false,\"canBeUsedToMatch\":true},{\"id\":\"callsummary\",\"type\":\"string\",\"display\":true,\"removed\":false,\"readOnly\":false,\"required\":false,\"displayName\":\"callsummary\",\"defaultMatch\":false,\"canBeUsedToMatch\":true}],\"mappingMode\":\"defineBelow\",\"matchingColumns\":[\"callrecording_id\"],\"attemptToConvertTypes\":false,\"convertFieldsToString\":false},\"options\":{\"typecast\":true},\"operation\":\"upsert\"},\"credentials\":{},\"typeVersion\":2.1},{\"id\":\"5671dcff-8894-42a8-af77-df01d0b6c190\",\"name\":\"Sticky Note7\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-1800,1980],\"parameters\":{\"color\":4,\"width\":1680,\"height\":2700,\"content\":\"# Vapi System Prompt\\n\\n### First Message: \\nHi, this is Ellie with Harrison Climate Solutions how can I help you?\\n\\n----**END**----\\n\\n### System Prompt:\\n\\n[Identity]  \\nYou are Ellie, the friendly and knowledgeable voice receptionist for Harrison Climate Solutions, an HVAC service company based in San Antonio, Texas.\\n- Current Date and Time: {{\\\"now\\\" | date: \\\"%b %d, %Y, %I:%M %p\\\", \\\"America/Chicago\\\"}}\\n\\n[Style]  \\n- Use a friendly, conversational tone with a hint of Texan warmth.\\n- Be warm, approachable, and slightly humorous to create a comfortable and friendly experience for callers.\\n- Use casual, conversational language, incorporating friendly fillers like “Umm...,” “Well...,” or “I mean.”\\n- Keep responses brief and engaging, mirroring a natural conversation style to suit the voice format.\\n\\n[Response Guideline]  \\n- Use a friendly and conversational tone, never saying \\\"Asterisk\\\" or similar technical terms.\\n- Limit responses to essential information only, breaking up information into bite-sized pieces when possible.\\n- Remember this is a telephone conversation. Give the caller opportunities to talk.\\n- Politely redirect any off-topic questions back to Harrison Climate Solutions' services or appointment scheduling.\\n- If they hadn't requested an endtime always assume for 30 mins meeting.\\n- When asking for EMAIL always say: \\\" Can you spell your email please ? \\\".\\n\\n[Reminder]  \\n- Use your knowledge base to access more information about the business.\\n- Current Date and Time: {{\\\"now\\\" | date: \\\"%b %d, %Y, %I:%M %p\\\", \\\"America/Chicago\\\"}}\\n- Do not repeat the caller.\\n- Do not Book Calls on Saturday and Sunday and on Holidays (Always getslots)\\n- Mention that Harrison Climate Solutions operates Monday through Friday, 8 a.m. to 5 p.m.\\n- ONLY MOVE FORWARD when you have correct NAME, EMAIL and TIMMINGS. \\n\\n- When people ask about your phone number, your phone number is 4158923245\\n **Guideline**\\nWhen speaking the phone number, transform the format as follows:\\n- Input formats like 4158923245, (415) 892-3245, or 415-892-3245\\n- Should be pronounced as: \\\"four one five - eight nine two - three two four five\\\"\\n- Important: Don't omit the space around the dash when speaking\\n\\nAlways ask to spell the email out. \\n**How to spell out**\\nThe possible email format is name@company.com\\nto spell out an email address is N - A - M - E - @company.com,\\nYOU MUST read them out with regular words like 'company' or 'blue'.\\nFor names, you must read them out letter by letter, for example, 'P - R - A - T - I - K'.\\n@ is pronounced by \\\"at\\\" or \\\"at direct\\\".\\n\\n- State Numbers, Times & Dates Slowly\\nFor 1:00 PM, say “One PM.”\\nFor 3:30 PM, say “Three thirty PM.”\\nFor 8:45 AM, say “Eight forty-five AM.”\\nNever say “O’Clock.” Instead just say O-Clock never O'clock, This is non-negotiable—always say “AM” or “PM.\\n\\n[Tool Usage Guidelines]  \\n\\n1. **Booking Appointments (BookSlot Tool)**  \\n   - **Purpose**: Use the `BookSlot` function to finalize an appointment when all required details (name, email, start time, and notes) are gathered.\\n   - **Parameters**: Ensure the following parameters are complete before calling:\\n     - `name`: The attendee's name (never make up or use a placeholder).\\n     - `email`: The attendee's email (never make up or use a placeholder).\\n     - `start`: Appointment start time in ISO 8601 format (e.g., `\\\"2023-04-25T15:00:00Z\\\"`) in America/Chicago timezone.\\n     - `notes`: A brief description (2-3 sentences) summarizing what the customer is looking for and why they need the appointment.\\n \\n2. **Finding Available Slots (GetSlots Tool)**  \\n   - **Purpose**: Use `GetSlots` to check available time slots for an appointment when date parameters (start and end time in ISO format) are known.\\n   - **Parameters**:\\n     - `startTime`: Start of the search window.\\n     - `endTime`: End of the search window.\\n   - **Directive**: Immediately call `GetSlots` without waiting for any additional user response if you have all required information for `startTime` and `endTime`. Do not pause or expect further input before calling.\\n\\n3. **Canceling Appointments (CancelSlots Tool)**  \\n   - **Purpose**: Use the `CancelSlots` function to cancel an appointment when all required details (name, email, start time) are gathered.\\n   - **Parameters**: Ensure the following parameters are complete before calling:\\n     - `name`: The attendee's name (never make up or use a placeholder).\\n     - `email`: The attendee's email (never make up or use a placeholder).\\n     - `start`: Appointment start time in ISO 8601 format (e.g., `\\\"2023-04-25T15:00:00Z\\\"`)  in America/Chicago timezone.\\n     - `Cancelnotes`: A brief description (2-3 sentences) summarizing why the customer want to cancel the appointment.\\n\\n4. **Transferring Calls (TransferCall Tool)**\\n**Purpose**: Use the `TransferCall` function to connect the caller to Sam’s forwarding number when absolutely necessary.\\n   - **When to Use**: \\n     - If the caller says the secret phrase \\\"Hot Brisket.\\\"\\n     - If you determine the situation is a genuine emergency and requires immediate attention.\\n   - **Directive**: Use the `TransferCall` tool immediately when one of the above conditions is met, forwarding the caller to Sam’s specified phone number. Do not attempt to handle emergencies yourself, and do not wait for caller feedback before initiating the transfer. Transfer the call to Sam.\\n\\n[Task]\\n1. **Service Questions**\\n   - If the caller has questions about services, provide a concise description of the relevant services based on company offerings.\\n   - Mention popular seasonal promotions as relevant (e.g., furnace tune-ups in winter, AC installation deals in summer).\\n   - For questions about pricing, explain that Harrison Climate Solutions offers free estimates and stress the transparency of pricing with no hidden fees.\\n\\n2. **Appointment Scheduling**\\n   - Do not try to schedule an appointment for a time in the past. Give a friendly joke about scheduling in the past if they try.\\n   - If the caller is interested in scheduling an appointment, **follow these steps**:\\n      1. Gather attendee’s email, ask them to spell their email: \\\" Can you spell your email \\\" eg: \\\" P-R-A-T-I-K@gmail.com \\\", name , preferred time, and reason for the appointment. ONLY MOVE FORWARD when you have correct NAME, EMAIL and TIMMINGS. \\n      2. If you have both `startTime` and `endTime`, **immediately call `GetSlots` to check for availability**. Do not wait for caller feedback after confirming you’ll check.\\n      3. Only suggest available slots based on confirmed results from `GetSlots`. Never make up availability if none is returned.\\n      4. If `GetSlots` returns more than three options, offer just two to three choices to help the caller decide.\\n      5. If no availability is found, inform the caller courteously that slots are fully booked and suggest calling back later.\\n   - Once a suitable time is identified, use the `BookSlot` tool to schedule the appointment, and confirm the details with the caller. **Only use this tool to book an appointment. Never make up an appointment booking. Do not wait for caller feedback before calling this tool if you have everything you need.**\\n   - Mention that Harrison Climate Solutions operates Monday through Friday, 8 a.m. to 5 p.m. If emergency then only 24-hour, 7-day-a-week if needed in America/Chicago time zone.\\n\\n3. ** Update Appointment** \\n- if the caller is interested in Rescheduling/Updating their booking **follow the steps**:\\n   1. Gather attendee's name and ask them to spell their email : \\\" Can you spell your email \\\", Previous booking timings like starttime and rescheduling time for rescheduling. (ONLY MOVE FORWARD when you have correct NAME, EMAIL and TIMMINGS. )\\n   2. If you have 'starttime' and email, **immediately call 'GetSlots' to check if time is not available . Do not wait for caller feedback after confirming you’ll check. \\n  3. if time is not available, then Call the 'UpdateSlots' tool for rescheduling.\\n  4. If time is available, inform the caller that there is no appointment booked at that time.\\n\\n4. **Cancel Appointment **\\n  - if the caller is interested in canceling a booking, **follow the steps**:\\n    1. Gather attendee's name and ask them to spell their email : \\\" Can you spell your email \\\", timings and if possible reason for cancelation. ( ONLY MOVE FORWARD when you have correct NAME, EMAIL and TIMMINGS. )\\n    2. If you have 'starttime' and email, **immediately call 'GetSlots' to check if time is not available . Do not wait for caller feedback after confirming you’ll check. \\n    3. if time is not available, then insists caller to 'Update appointment' first and if he don't want to update appointment then use the 'CancelSlots' tool to cancel the appointment. \\n    4. If time is available, inform the caller that there is no appointment booked at that time.\\n\\n---**END**---\"},\"typeVersion\":1},{\"id\":\"44596616-27ba-47c0-8a6d-cf50f86a136e\",\"name\":\"Sticky Note15\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[280,900],\"parameters\":{\"color\":7,\"width\":191,\"height\":80,\"content\":\"**☝️ Set up `Getslot` tool and Webhook in Vapi**\\n\"},\"typeVersion\":1},{\"id\":\"226635e5-05cf-4da6-bbd5-304e458a7112\",\"name\":\"Sticky Note16\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[400,1960],\"parameters\":{\"color\":7,\"width\":191,\"height\":80,\"content\":\"**☝️ Set up `Bookslot` tool and Webhook in Vapi**\\n\"},\"typeVersion\":1},{\"id\":\"dd2caca4-8669-447f-85ee-b0d829e0e8c4\",\"name\":\"Sticky Note17\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[460,2880],\"parameters\":{\"color\":7,\"width\":191,\"height\":80,\"content\":\"**☝️ Set up `Updateslot` tool and Webhook in Vapi**\\n\"},\"typeVersion\":1},{\"id\":\"be40ca37-c272-4170-a6b1-cf17a28c37ba\",\"name\":\"Sticky Note18\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[440,3780],\"parameters\":{\"color\":7,\"width\":191,\"height\":80,\"content\":\"**☝️ Set up `Cancelslot` tool and Webhook in Vapi**\\n\"},\"typeVersion\":1},{\"id\":\"98af9e21-fb6e-41ef-a15e-f0b914e1dc8d\",\"name\":\"Sticky Note19\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[440,4440],\"parameters\":{\"color\":7,\"width\":191,\"height\":80,\"content\":\"**☝️ Set up `call_results` as a Server Webhook in Vapi**\\n\"},\"typeVersion\":1},{\"id\":\"ab8f9a65-74b1-42ce-ba65-8f0e0e390839\",\"name\":\"Sticky Note9\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[-1800,340],\"parameters\":{\"color\":7,\"width\":1460,\"height\":1540,\"content\":\"## Voice Receptionist for Appointment Management (tools)\\n\\n## Introduction\\n### What This Template Does:\\n- This n8n workflow template automates appointment management using a voice AI receptionist powered by Vapi. It integrates Vapi with Google Calendar for real-time scheduling and Airtable for logging and data management. Agent checks availability, books new appointments, reschedules existing ones, or cancels appointments directly within Google Calendar.\\n\\n### Problem It Solves:\\n- Managing appointment scheduling manually can be time-consuming, and limited by business hours. This template solves these issues by providing an automated, 24/7 (within configured business rules) voice-based scheduling system. It frees up human staff from routine scheduling tasks, reduces booking errors, ensures appointments are logged consistently, and enhances the customer experience by offering immediate scheduling capabilities over the phone. It also captures valuable call data like recordings, summaries, and costs for analysis.\\n\\n## Setup Instructions\\n\\n### Prerequisites:\\n- An active n8n instance.\\n- A Vapi account for the voice agent.\\n- A Google account with access to Google Calendar.\\n- An Airtable account.\\n- API Keys/Credentials for Google Calendar and Airtable configured in your n8n instance.\\n\\n## Step-by-Step Setup:\\n### 1. Copy Airtable Base:\\n- Duplicate the provided Airtable base structure to your own Airtable account using this link: https://airtable.com/appxDqRoEgG5sF2gu/shrnZU0D29TPMCjpt\\n- Note: The n8n workflow is configured to work with the specific tables and fields in this base (\\\"Appointments\\\" and \\\"Call Recording\\\" tables).\\n\\n### 2. Import n8n Workflow:\\n- Import the provided n8n workflow JSON into your n8n instance.\\n\\n### 3. Configure n8n Credentials:\\n- Locate the Google Calendar nodes within the workflow (e.g., \\\"Check Availability\\\", \\\"Get All Calendar Events\\\", \\\"Create Event\\\", \\\"Update Event\\\", \\\"Delete Event\\\"). Ensure they are configured to use your Google Calendar credentials in n8n. Select the correct calendar to manage.\\n- Locate the Airtable nodes (e.g., \\\"Logs the confirmed booking details\\\", \\\"Finds original appointment\\\", \\\"Updates Airtable record\\\", \\\"Save all information\\\"). Ensure they are configured with your Airtable credentials and point to the correct Base and Tables you created in Step 1.\\n\\n### 4. Activate the n8n Workflow:\\n- Save and activate the n8n workflow. This generates the live Webhook URLs needed for Vapi.\\n\\n### 5. Configure Vapi Assistant:\\n- **System Prompt:** Copy the system prompt provided in the large sticky note within the n8n workflow. Adapt it as needed (e.g., business name, hours) and paste it into your Vapi Assistant's System Prompt configuration. This prompt instructs the AI on its role, rules, and how/when to use the tools.\\n\\n- **Tools Setup:** In your Vapi Assistant configuration, define the following 4 tools:\\n  - Getslots Tool:\\n    - Purpose: To check calendar availability.\\n    - Webhook URL: Copy the Production URL from the \\\"Getslot_tool\\\" Webhook node in your active n8n workflow (path: /getslots) and paste it here.\\n  - Bookslots Tool:\\n    - Purpose: To create a new calendar event.\\n    - Webhook URL: Copy the Production URL from the \\\"bookslots_tool\\\" Webhook node in your active n8n workflow (path: /bookslots) and paste it here.\\n  - Updateslots Tool:\\n    - Purpose: To modify an existing calendar event.\\n    - Webhook URL: Copy the Production URL from the \\\"Updateslots_tool\\\" Webhook node in your active n8n workflow (path: /updateslots) and paste it here.\\n  - Cancelslots Tool:\\n    - Purpose: To delete a calendar event.\\n    - Webhook URL: Copy the Production URL from the \\\"CancelSlots_tool\\\" Webhook node in your active n8n workflow (path: /cancelslots) and paste it here.\\n- **Server Webhook (End of Call Report):**\\n  - In Vapi's server configuration section (often under webhooks or reporting), find the setting for the end-of-call-report or similar event.\\n  - Copy the Production URL from the \\\"call_results\\\" Webhook node in your active n8n workflow (path: /callresults).\\n  - Paste this URL into the Vapi configuration for the end-of-call server webhook. This allows n8n to receive and log call summaries, recordings, etc., after the call ends.\\n\\n## Video Walkthrough (coming soon)\\n### [🎥 Watch set up video (~2min)](https://www.loom.com/share/d379895004374ddc85dc9171ca37c139?sid=0996f0d2-aff2-45a7-aae9-c62df4fb0799)\\n\"},\"typeVersion\":1},{\"id\":\"8d984e05-5bca-4c70-beee-16f7cd70594e\",\"name\":\"Sticky Note12\",\"type\":\"n8n-nodes-base.stickyNote\",\"position\":[40,300],\"parameters\":{\"color\":7,\"width\":3700,\"height\":4400,\"content\":\"# Workflow\"},\"typeVersion\":1}],\"pinData\":{},\"connections\":{\"Sort\":{\"main\":[[{\"node\":\"Format response\",\"type\":\"main\",\"index\":0}]]},\"Enrich Date\":{\"main\":[[{\"node\":\"Build Response Payload\",\"type\":\"main\",\"index\":0}]]},\"Escape Json\":{\"main\":[[{\"node\":\"Convert time to CST America / Chicago\",\"type\":\"main\",\"index\":0}]]},\"Create Event\":{\"main\":[[{\"node\":\"Booking Payload\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Add Friendly Error\",\"type\":\"main\",\"index\":0}]]},\"Delete Event\":{\"main\":[[{\"node\":\"Update Airtable record\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Call_id & Response\",\"type\":\"main\",\"index\":0}]]},\"Getslot_tool\":{\"main\":[[{\"node\":\"Input Arguments\",\"type\":\"main\",\"index\":0}]]},\"Update Event\":{\"main\":[[{\"node\":\"Updates Airtable record\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Response & call_id\",\"type\":\"main\",\"index\":0}]]},\"call_results\":{\"main\":[[{\"node\":\"All Input Arguments\",\"type\":\"main\",\"index\":0}]]},\"Flatten Slots\":{\"main\":[[{\"node\":\"Enrich Date\",\"type\":\"main\",\"index\":0}]]},\"Error Response\":{\"main\":[[{\"node\":\"Respond to Vapi\",\"type\":\"main\",\"index\":0}]]},\"bookslots_tool\":{\"main\":[[{\"node\":\"Input Arguments from booking tools\",\"type\":\"main\",\"index\":0}]]},\"Booking Payload\":{\"main\":[[{\"node\":\"Success Response\",\"type\":\"main\",\"index\":0}]]},\"Format response\":{\"main\":[[{\"node\":\"Available Start Times & Ranges\",\"type\":\"main\",\"index\":0}]]},\"Input Arguments\":{\"main\":[[{\"node\":\"Check Availability\",\"type\":\"main\",\"index\":0}]]},\"Respond to Vapi\":{\"main\":[[{\"node\":\"If the booking is confirmed then true\",\"type\":\"main\",\"index\":0}]]},\"CancelSlots_tool\":{\"main\":[[{\"node\":\"Input Arguments from cancelslot tool\",\"type\":\"main\",\"index\":0}]]},\"Success Response\":{\"main\":[[{\"node\":\"Respond to Vapi\",\"type\":\"main\",\"index\":0}]]},\"Updateslots_tool\":{\"main\":[[{\"node\":\"Input Arguments from updateslot tool\",\"type\":\"main\",\"index\":0}]]},\"Add Friendly Error\":{\"main\":[[{\"node\":\"Error Response\",\"type\":\"main\",\"index\":0}]]},\"Call_id & Response\":{\"main\":[[{\"node\":\"Respond to Vapi about cancelation\",\"type\":\"main\",\"index\":0}]]},\"Check Availability\":{\"main\":[[{\"node\":\"Check if time is available or not\",\"type\":\"main\",\"index\":0}]]},\"Response & call_id\":{\"main\":[[{\"node\":\"Respond to Vapi about Updating slots\",\"type\":\"main\",\"index\":0}]]},\"All Input Arguments\":{\"main\":[[{\"node\":\"Save all information\",\"type\":\"main\",\"index\":0}]]},\"Has all information\":{\"main\":[[{\"node\":\"Escape Json\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Build Error Response Payload\",\"type\":\"main\",\"index\":0}]]},\"Build Error Response\":{\"main\":[[{\"node\":\"Respond with Error to Vapi\",\"type\":\"main\",\"index\":0}]]},\"Build Response Payload\":{\"main\":[[{\"node\":\"Convert into Json format for Vapi\",\"type\":\"main\",\"index\":0}]]},\"Update Airtable record\":{\"main\":[[{\"node\":\"Call_id & Response\",\"type\":\"main\",\"index\":0}]]},\"Get All Calendar Events\":{\"main\":[[{\"node\":\"Extract start, end and name\",\"type\":\"main\",\"index\":0}]]},\"Updates Airtable record\":{\"main\":[[{\"node\":\"Response & call_id\",\"type\":\"main\",\"index\":0}]]},\"Finds original appointment\":{\"main\":[[{\"node\":\"Update Event\",\"type\":\"main\",\"index\":0}]]},\"Extract start, end and name\":{\"main\":[[{\"node\":\"Sort\",\"type\":\"main\",\"index\":0}]]},\"Build Error Response Payload\":{\"main\":[[{\"node\":\"Respond with Error\",\"type\":\"main\",\"index\":0}]]},\"Finds the appointment record\":{\"main\":[[{\"node\":\"Delete Event\",\"type\":\"main\",\"index\":0}]]},\"Build Error Response Payload2\":{\"main\":[[{\"node\":\"Response with Error\",\"type\":\"main\",\"index\":0}]]},\"Available Start Times & Ranges\":{\"main\":[[{\"node\":\"Flatten Slots\",\"type\":\"main\",\"index\":0}]]},\"Time available (true) & Call_id\":{\"main\":[[{\"node\":\"Response\",\"type\":\"main\",\"index\":0}]]},\"Check if time is available or not\":{\"main\":[[{\"node\":\"Time available (true) & Call_id\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Get All Calendar Events\",\"type\":\"main\",\"index\":0}]]},\"Convert into Json format for Vapi\":{\"main\":[[{\"node\":\"Response to Vapi\",\"type\":\"main\",\"index\":0}]]},\"Input Arguments from booking tools\":{\"main\":[[{\"node\":\"Has all information\",\"type\":\"main\",\"index\":0}]]},\"Information to be Saved in Airtable\":{\"main\":[[{\"node\":\"Logs the confirmed booking details\",\"type\":\"main\",\"index\":0}]]},\"Checks if required info is provided.\":{\"main\":[[{\"node\":\"Finds original appointment\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Build Error Response Payload2\",\"type\":\"main\",\"index\":0}]]},\"Input Arguments from cancelslot tool\":{\"main\":[[{\"node\":\"Checks if required info is provided for cancelation\",\"type\":\"main\",\"index\":0}]]},\"Input Arguments from updateslot tool\":{\"main\":[[{\"node\":\"Checks if required info is provided.\",\"type\":\"main\",\"index\":0}]]},\"Convert time to CST America / Chicago\":{\"main\":[[{\"node\":\"Create Event\",\"type\":\"main\",\"index\":0}]]},\"If the booking is confirmed then true\":{\"main\":[[{\"node\":\"Information to be Saved in Airtable\",\"type\":\"main\",\"index\":0}]]},\"Checks if required info is provided for cancelation\":{\"main\":[[{\"node\":\"Finds the appointment record\",\"type\":\"main\",\"index\":0}],[{\"node\":\"Build Error Response\",\"type\":\"main\",\"index\":0}]]}}}",
  "readme": "## Who is this template for?\n\nThis template is ideal for small businesses, agencies, and solo professionals who want to automate appointment scheduling and caller follow-up through a voice-based AI receptionist. If you’re using tools like Google Calendar, Airtable, and Vapi (Twilio), this setup is for you.\n\n## What problem does this workflow solve?\n\nManual call handling, appointment booking, and email coordination can be time-consuming and prone to errors. This workflow solves that by automating the receptionist role: answering calls, checking calendar availability, managing appointments, and storing call summaries—all without human intervention.\n\n## What this workflow does\n\nThis Agent Receptionist manages inbound voice calls and scheduling tasks using Vapi and Google Calendar. It checks availability, books or updates calendar events, sends email confirmations, and logs call details into Airtable. The workflow includes built-in logic for slot management, email triggers, and storing call transcripts.\n\n## Setup Instructions\n\nDuplicate Airtable Base: Use this Airtable base template[BASE LINK](.)\n\nImport Workflow: Load provided JSON into your n8n instance.\n\nCredentials: Connect your Google Calendar and Airtable credentials in n8n.\n\nActivate Workflow: Enable workflow to get live webhook URLs.\n\nVapi Configuration:\n\nPaste provided system prompt into Vapi Assistant.\n\nLink the appropriate webhook URLs from n8n (GetSlots, BookSlots, UpdateSlots, CancelSlots, and end-of-call report).\n\nDisclaimer\n\nOptimized for cloud-hosted n8n instances. Self-hosted users should verify webhook and credential setups.\n",
  "readme_html": "<!--[--><div data-v-859c7806=\"\"><h2>Who is this template for?</h2>\n<p>This template is ideal for small businesses, agencies, and solo professionals who want to automate appointment scheduling and caller follow-up through a voice-based AI receptionist. If you’re using tools like Google Calendar, Airtable, and Vapi (Twilio), this setup is for you.</p>\n<h2>What problem does this workflow solve?</h2>\n<p>Manual call handling, appointment booking, and email coordination can be time-consuming and prone to errors. This workflow solves that by automating the receptionist role: answering calls, checking calendar availability, managing appointments, and storing call summaries—all without human intervention.</p>\n<h2>What this workflow does</h2>\n<p>This Agent Receptionist manages inbound voice calls and scheduling tasks using Vapi and Google Calendar. It checks availability, books or updates calendar events, sends email confirmations, and logs call details into Airtable. The workflow includes built-in logic for slot management, email triggers, and storing call transcripts.</p>\n<h2>Setup Instructions</h2>\n<p>Duplicate Airtable Base: Use this Airtable base template<a href=\".\" rel=\"ugc nofollow\">BASE LINK</a></p>\n<p>Import Workflow: Load provided JSON into your n8n instance.</p>\n<p>Credentials: Connect your Google Calendar and Airtable credentials in n8n.</p>\n<p>Activate Workflow: Enable workflow to get live webhook URLs.</p>\n<p>Vapi Configuration:</p>\n<p>Paste provided system prompt into Vapi Assistant.</p>\n<p>Link the appropriate webhook URLs from n8n (GetSlots, BookSlots, UpdateSlots, CancelSlots, and end-of-call report).</p>\n<p>Disclaimer</p>\n<p>Optimized for cloud-hosted n8n instances. Self-hosted users should verify webhook and credential setups.</p>\n</div><!--]-->",
  "readme_zh": "## 适用对象\n\n本模板专为中小型企业、服务机构及个人专业从业者设计，适用于希望通过AI语音助手实现预约自动化和来电跟进的用户。如果您正在使用Google日历、Airtable和Vapi（Twilio）等工具，这套解决方案将完美契合您的需求。\n\n## 核心痛点解决\n\n传统人工接听电话、预约安排及邮件协调不仅耗时耗力，还容易出错。本工作流通过自动化接待流程彻底解决这些问题：智能应答来电、实时查询日程空档、自主管理预约事项、自动归档通话记录——全程无需人工干预。\n\n## 功能概述\n\n这位AI接待员基于Vapi和Google日历实现智能通话管理：实时查询可预约时段、创建/修改日历事项、自动发送邮件确认函，并将通话记录同步至Airtable数据库。工作流内置时段管理逻辑、邮件触发机制及通话文本存储功能。\n\n## 配置指南\n\n1. 复制Airtable模板库：[基础模板链接](.)\n\n2. 导入工作流：将提供的JSON文件加载至n8n平台\n\n3. 凭证配置：在n8n中关联您的Google日历和Airtable账户\n\n4. 激活工作流：启用后获取实时Webhook链接\n\n5. Vapi配置：\n   - 将提供的系统指令粘贴至Vapi助手\n   - 关联n8n生成的Webhook链接（包括时段查询、预约登记、时段更新、预约取消及通话结束报告）\n\n## 注意事项\n\n本方案针对云端部署的n8n实例优化，自建服务器用户需额外验证Webhook与凭证配置。",
  "title_zh": "利用Vapi、Google日历和Airtable实现语音AI接待员自动呼叫排程",
  "publish_date_zh": "上次更新于8天前",
  "workflow_json_zh": "{\n  \"meta\": {\n    \"instanceId\": \"1954c8c806bedb8f0628725b26b786028ade16c78a82bc25deb9dd961e036832\"\n  },\n  \"nodes\": [\n    {\n      \"id\": \"36d0b0d4-b454-4a9b-8168-bcc7942a7cc7\",\n      \"name\": \"Input Arguments\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        520,\n        740\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"ccabe9f4-7911-4488-a75b-7c5779fb2014\",\n              \"name\": \"timeZone\",\n              \"type\": \"string\",\n              \"value\": \"=America/Chicago\"\n            },\n            {\n              \"id\": \"b802d976-78f5-4c00-8764-f8c49eaded29\",\n              \"name\": \"endtime\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.message.toolCalls[0].function.arguments.endtime }}\"\n            },\n            {\n              \"id\": \"02d58122-6a0f-4bdb-9914-6f50d2af6df4\",\n              \"name\": \"starttime\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.message.toolCalls[0].function.arguments.starttime }}\"\n            },\n            {\n              \"id\": \"c1249493-a1d7-4a91-9468-9e5c49430d2e\",\n              \"name\": \"body.message.toolCalls[0].id\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.message.toolCalls[0].id }}\"\n            },\n            {\n              \"id\": \"2d1e0d9a-4c70-488e-b430-b8137fd54970\",\n              \"name\": \"customer.number\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.message.call.customer.number }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.3\n    },\n    {\n      \"id\": \"2d8485ad-9007-4664-9182-7eda25fc96ee\",\n      \"name\": \"Format response\",\n      \"type\": \"n8n-nodes-base.itemLists\",\n      \"position\": [\n        2000,\n        840\n      ],\n      \"parameters\": {\n        \"include\": \"allFieldsExcept\",\n        \"options\": {},\n        \"aggregate\": \"aggregateAllItemData\",\n        \"operation\": \"concatenateItems\",\n        \"fieldsToExclude\": \"sort\",\n        \"destinationFieldName\": \"response\"\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"b23c75e0-3697-4137-a595-cf26fedaa898\",\n      \"name\": \"Sort\",\n      \"type\": \"n8n-nodes-base.itemLists\",\n      \"position\": [\n        1760,\n        840\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"operation\": \"sort\",\n        \"sortFieldsUi\": {\n          \"sortField\": [\n            {\n              \"fieldName\": \"sort\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3\n    },\n    {\n      \"id\": \"660e3d2f-a424-4e76-8c13-5b62b9f22202\",\n      \"name\": \"Available Start Times & Ranges\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        2240,\n        840\n      ],\n      \"parameters\": {\n        \"jsCode\": \"// Input data\\nconst inputData = $input.all()[0].json.response;\\n\\n// Define workday hours in CST\\nconst WORKDAY_START = \\\"09:00:00 CST\\\";\\nconst WORKDAY_END = \\\"18:00:00 CST\\\";\\nconst SLOT_DURATION = 30 * 60 * 1000; // 30 minutes in milliseconds\\n\\n// Helper to parse CST datetime strings\\nconst parseCST = (datetime) => {\\n  const parsedDate = new Date(datetime.replace(\\\" CST\\\", \\\"-06:00\\\"));\\n  return isNaN(parsedDate) ? null : parsedDate;\\n};\\n\\n// Function to generate 30-minute start times\\nconst generateStartTimes = (start, end) => {\\n  const startTimes = [];\\n  let current = new Date(start);\\n\\n  while (current < end) {\\n    startTimes.push(\\n      current.toLocaleTimeString('en-US', {\\n        timeZone: 'CST',\\n        hour: '2-digit',\\n        minute: '2-digit',\\n      })\\n    );\\n    current = new Date(current.getTime() + SLOT_DURATION);\\n  }\\n\\n  return startTimes;\\n};\\n\\n// Function to find wide open ranges\\nconst findWideOpenRanges = (startTimes) => {\\n  if (startTimes.length < 3) return []; // Not enough slots for a wide open range\\n\\n  const ranges = [];\\n  let rangeStart = null;\\n  let consecutiveCount = 0;\\n\\n  for (let i = 0; i < startTimes.length - 1; i++) {\\n    const currentTime = parseCST(`2000-01-01 ${startTimes[i]} CST`);\\n    const nextTime = parseCST(`2000-01-01 ${startTimes[i + 1]} CST`);\\n    const diff = nextTime - currentTime;\\n\\n    if (diff === SLOT_DURATION) {\\n      consecutiveCount += 1;\\n      if (rangeStart === null) rangeStart = startTimes[i];\\n    } else {\\n      if (consecutiveCount >= 2) {\\n        ranges.push(`${rangeStart} to ${startTimes[i]}`);\\n      }\\n      rangeStart = null;\\n      consecutiveCount = 0;\\n    }\\n  }\\n\\n  // Handle the final range\\n  if (consecutiveCount >= 2) {\\n    ranges.push(`${rangeStart} to ${startTimes[startTimes.length - 1]}`);\\n  }\\n\\n  return ranges;\\n};\\n\\n// Group meetings by date, ignoring invalid dates\\nconst meetingsByDate = inputData.reduce((acc, meeting) => {\\n  const start = parseCST(meeting.start);\\n  const end = parseCST(meeting.end);\\n\\n  if (!start || !end) {\\n    return acc; // Ignore invalid dates\\n  }\\n\\n  const dateKey = start.toISOString().split('T')[0];\\n\\n  if (!acc[dateKey]) {\\n    acc[dateKey] = [];\\n  }\\n\\n  acc[dateKey].push({ start, end });\\n  return acc;\\n}, {});\\n\\n// Generate availability\\nconst availability = Object.keys(meetingsByDate)\\n  .filter((date) => {\\n    // Exclude Saturdays (6) and Sundays (0)\\n    const dayOfWeek = new Date(date).getUTCDay();\\n    return dayOfWeek !== 0 && dayOfWeek !== 6;\\n  })\\n  .map((date) => {\\n    const workdayStart = parseCST(`${date} ${WORKDAY_START}`);\\n    const workdayEnd = parseCST(`${date} ${WORKDAY_END}`);\\n\\n    const dayMeetings = meetingsByDate[date].sort((a, b) => a.start - b.start);\\n\\n    let availableStartTimes = [];\\n    let lastEnd = workdayStart;\\n\\n    for (const meeting of dayMeetings) {\\n      if (meeting.start > lastEnd) {\\n        availableStartTimes = availableStartTimes.concat(generateStartTimes(lastEnd, meeting.start));\\n      }\\n      lastEnd = meeting.end > lastEnd ? meeting.end : lastEnd;\\n    }\\n\\n    if (lastEnd < workdayEnd) {\\n      availableStartTimes = availableStartTimes.concat(generateStartTimes(lastEnd, workdayEnd));\\n    }\\n\\n    const wideOpenRanges = findWideOpenRanges(availableStartTimes);\\n\\n    return {\\n      date: new Date(date).toLocaleDateString('en-US', {\\n        weekday: 'long',\\n        year: 'numeric',\\n        month: 'long',\\n        day: 'numeric',\\n      }),\\n      availableStartTimes,\\n      wideOpenRanges,\\n    };\\n  });\\n\\n// Format output as plaintext\\nconst availableTimes = availability\\n  .map(({ date, availableStartTimes, wideOpenRanges }) => {\\n    const times = availableStartTimes.map((time) => `- ${time}`).join('\\\\n');\\n    const ranges = wideOpenRanges.length\\n      ? `Wide Open Ranges:\\\\n${wideOpenRanges.map((range) => `- ${range}`).join('\\\\n')}`\\n      : \\\"Wide Open Ranges: None\\\";\\n\\n    return `### ${date}\\\\nAvailable Start Times:\\\\n${times}\\\\n\\\\n${ranges}`;\\n  })\\n  .join('\\\\n\\\\n');\\n\\n// Set the output\\nreturn {\\n  json: {\\n    availableTimes,\\n  },\\n};\\n\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"f3110658-2f90-4b19-9874-7d6c4e108895\",\n      \"name\": \"Flatten Slots\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        2460,\n        840\n      ],\n      \"parameters\": {\n        \"mode\": \"runOnceForEachItem\",\n        \"jsCode\": \"const flattenSlots = (data) => {\\n  // If data is missing or empty, return an empty array of slots\\n  if (!data) {\\n    return { slots: [] };\\n  }\\n\\n  // data is an object whose keys are dates\\n  // each date key has an array of slot objects\\n  // we just need to flatten them all into one array\\n  const flattened = Object.values(data).flat();  // merges all arrays from each date key\\n\\n  // Return a new object with a single 'slots' array\\n  return { slots: flattened };\\n};\\n\\n// Then assign the flattened slots back to $input.item.json.data\\n$input.item.json.data = flattenSlots($input.item.json.data);\\nreturn $input.item;\\n\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"5065439e-34e3-4eaf-8226-8ba7393a5cf3\",\n      \"name\": \"Enrich Date\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        2680,\n        840\n      ],\n      \"parameters\": {\n        \"mode\": \"runOnceForEachItem\",\n        \"jsCode\": \"function formatTimeSlot(dateString) {\\n  // Format options for date/time with America/Chicago timezone\\n  const options = {\\n    timeZone: 'America/Chicago',\\n    weekday: 'long',\\n    month: 'long',\\n    day: 'numeric',\\n    hour: 'numeric',\\n    minute: 'numeric',\\n    hour12: true\\n  };\\n\\n  // Create a formatter with timezone support\\n  const dateFormatter = new Intl.DateTimeFormat('en-US', options);\\n  \\n  // Format the date/time string\\n  return dateFormatter.format(new Date(dateString));\\n}\\n\\n// Process each slot and add formatted time strings to the result\\nconst slots = $input.item.json.data.slots;\\nconst formattedSlots = slots.map(slot => formatTimeSlot(slot.start));\\n\\n// Attach formatted results to the output\\n$input.item.json.data.slots = formattedSlots;\\n\\nreturn $input.item;\\n\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"d8ed3a92-697b-4718-b65f-5276c9a9bfaf\",\n      \"name\": \"Build Response Payload\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        2900,\n        840\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"5cb05b10-e916-459e-84a2-9c314a859a07\",\n              \"name\": \"results[0].toolCallId\",\n              \"type\": \"string\",\n              \"value\": \"={{ $('Input Arguments').item.json.body.message.toolCalls[0].id }}\"\n            },\n            {\n              \"id\": \"552246f9-7afd-404e-9fb3-cb38c7447359\",\n              \"name\": \"results[0].result\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.availableTimes }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"a0697944-c5a6-4ca1-9948-8248940841b2\",\n      \"name\": \"Booking Payload\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1980,\n        1400\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"ignoreConversionErrors\": true\n        },\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"05bbc797-b781-489c-ab70-e234fe17eb62\",\n              \"name\": \"id\",\n              \"type\": \"number\",\n              \"value\": \"={{ $json.id }}\"\n            },\n            {\n              \"id\": \"4bb68abf-18c8-4445-b446-21667abd95aa\",\n              \"name\": \"description\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.description }}\"\n            },\n            {\n              \"id\": \"74a98b77-b9fe-40cc-84c8-fc7303c5cfa6\",\n              \"name\": \"startTime\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.start.dateTime }}\"\n            },\n            {\n              \"id\": \"2934d6a7-9e6b-4038-891c-0b05ba18cb21\",\n              \"name\": \"endTime\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.end.dateTime }}\"\n            },\n            {\n              \"id\": \"10f091c8-5e52-40dc-a294-87625be9af99\",\n              \"name\": \"status\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.status }}\"\n            },\n            {\n              \"id\": \"cdc5e1ab-a29b-447f-8343-ff1c1b168717\",\n              \"name\": \"Timezone\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.end.timeZone }}\"\n            },\n            {\n              \"id\": \"f5b6820c-ab4b-496c-9957-f86753243388\",\n              \"name\": \"attendees\",\n              \"type\": \"array\",\n              \"value\": \"={{ $json.attendees }}\"\n            },\n            {\n              \"id\": \"b39a06a5-4fbf-4fdf-9d9a-a07dcb37d157\",\n              \"name\": \"hangoutLink\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.hangoutLink }}\"\n            },\n            {\n              \"id\": \"345f49fc-93bc-48b8-9ced-326139a82119\",\n              \"name\": \"Title\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.summary }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"4f7b157c-f657-48fa-8bb5-a1e074b042eb\",\n      \"name\": \"Success Response\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        2200,\n        1400\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"2c3894da-7bf7-4a35-95c0-d3d9199dd0ad\",\n              \"name\": \"results[0].toolCallId\",\n              \"type\": \"string\",\n              \"value\": \"={{ $('Input Arguments from booking tools').item.json.toolCallId }}\"\n            },\n            {\n              \"id\": \"685c67c7-a30b-4bcc-b9ba-827c4b570548\",\n              \"name\": \"results[0].result\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.status }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.3\n    },\n    {\n      \"id\": \"b7fe16e3-b625-4cb4-b971-9c26698af89b\",\n      \"name\": \"Add Friendly Error\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        1980,\n        1760\n      ],\n      \"parameters\": {\n        \"mode\": \"runOnceForEachItem\",\n        \"jsCode\": \"function replaceValue(value) {\\n  if (error.message.include('no_available_users_found_error')) {\\n    return \\\"This time slot is no longer available.\\\";\\n  }\\n  return value;\\n}\\n\\n$input.item.json.message = replaceValue($input.item.json.error.description);\\n\\nreturn $input.item;\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"b5bff0df-2bef-4c43-9fcf-91cadc68b7ca\",\n      \"name\": \"Error Response\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        2200,\n        1760\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"2c3894da-7bf7-4a35-95c0-d3d9199dd0ad\",\n              \"name\": \"results[0].toolCallId\",\n              \"type\": \"string\",\n              \"value\": \"={{ $('Input Arguments from booking tools').item.json.toolCallId }}\"\n            },\n            {\n              \"id\": \"93e45166-de94-4fa5-9148-2b8d0e4b960c\",\n              \"name\": \"results[0].result\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.message || $json.status }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.3\n    },\n    {\n      \"id\": \"fe62c0bc-2d73-4f14-8e76-02847ef4e14a\",\n      \"name\": \"Escape Json\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        1260,\n        1580\n      ],\n      \"parameters\": {\n        \"mode\": \"runOnceForEachItem\",\n        \"jsCode\": \"const escapeStringForJson = (str) => {\\n    return str\\n        .replace(/\\\\\\\\/g, '\\\\\\\\\\\\\\\\') // Escape backslashes\\n        .replace(/\\\"/g, '\\\\\\\\\\\"')    // Escape double quotes\\n        .replace(/\\\\n/g, '\\\\\\\\n')   // Escape newlines\\n        .replace(/\\\\r/g, '\\\\\\\\r')   // Escape carriage returns\\n        .replace(/\\\\t/g, '\\\\\\\\t');  // Escape tabs\\n};\\n\\n// Escape the notes field\\n$input.item.json.notes = escapeStringForJson($input.item.json.notes);\\n\\nreturn $input.item;\\n\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"17927aa4-8f91-4134-b914-1160a724226f\",\n      \"name\": \"Has all information\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        940,\n        1800\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"e0af7f69-0c89-4a02-a49f-dd5a90e31dff\",\n              \"operator\": {\n                \"type\": \"boolean\",\n                \"operation\": \"true\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ ($json.email || \\\"\\\").isEmail() }}\",\n              \"rightValue\": \"\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"6f0bb9e6-9d82-4cc6-a98f-4d00c47ed910\",\n      \"name\": \"Respond with Error\",\n      \"type\": \"n8n-nodes-base.respondToWebhook\",\n      \"position\": [\n        1480,\n        1900\n      ],\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"fdedba34-a374-405d-a86e-0b0a1759ede9\",\n      \"name\": \"Build Error Response Payload\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1260,\n        1900\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"5cb05b10-e916-459e-84a2-9c314a859a07\",\n              \"name\": \"results[0].toolCallId\",\n              \"type\": \"string\",\n              \"value\": \"={{ $('Input Arguments from booking tools').item.json.toolCallId }}\"\n            },\n            {\n              \"id\": \"552246f9-7afd-404e-9fb3-cb38c7447359\",\n              \"name\": \"results[0].result\",\n              \"type\": \"string\",\n              \"value\": \"=You must provide an email, name and notes to call this tool\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"1e111f9d-bb43-4126-b7a2-3353e7c7c72f\",\n      \"name\": \"Build Error Response Payload2\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1560,\n        2840\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"5cb05b10-e916-459e-84a2-9c314a859a07\",\n              \"name\": \"results[0].toolCallId\",\n              \"type\": \"string\",\n              \"value\": \"={{ $('Input Arguments from updateslot tool').item.json.toolCallId || $json.Calls[0].id }}\"\n            },\n            {\n              \"id\": \"552246f9-7afd-404e-9fb3-cb38c7447359\",\n              \"name\": \"results[0].result\",\n              \"type\": \"string\",\n              \"value\": \"=You must provide an email, name , previous starttime & endtime and resceduled starttime to call this tool\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"d6cbad26-d974-4a11-b0fd-2a35bb555378\",\n      \"name\": \"Sticky Note\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        260,\n        620\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 190,\n        \"height\": 80,\n        \"content\": \"# 获取插槽\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"bcccc8cb-2e9d-4f8b-9964-e4d656e794ed\",\n      \"name\": \"Sticky Note1\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        740,\n        920\n      ],\n      \"parameters\": {\n        \"width\": 230,\n        \"height\": 80,\n        \"content\": \"## 检查可用性\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"30b34e37-ee7a-434c-ab4d-445df994459a\",\n      \"name\": \"Sticky Note2\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1320,\n        520\n      ],\n      \"parameters\": {\n        \"width\": 310,\n        \"height\": 80,\n        \"content\": \"## 如有时间请回复\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"725a9b59-ea66-4326-a410-93a723157ced\",\n      \"name\": \"Sticky Note3\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1280,\n        1020\n      ],\n      \"parameters\": {\n        \"width\": 190,\n        \"height\": 80,\n        \"content\": \"## 获取所有事件\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"1f2bf4a3-8aeb-4a56-8bff-0bb370e12718\",\n      \"name\": \"Sticky Note4\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        2140,\n        1020\n      ],\n      \"parameters\": {\n        \"width\": 350,\n        \"height\": 100,\n        \"content\": \"## 获取可用时段\\n\\n格式化时段并丰富日期和时间信息\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"5909d88f-b9c6-4e62-b1e3-bdc1d05ad7aa\",\n      \"name\": \"Sticky Note5\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        3280,\n        1000\n      ],\n      \"parameters\": {\n        \"width\": 230,\n        \"height\": 80,\n        \"content\": \"## 回应Vapi\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"f627c5b0-f3b6-4f95-a3a3-2c1b7e2860c7\",\n      \"name\": \"Sticky Note BookSlot Webhook\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        380,\n        1680\n      ],\n      \"parameters\": {\n        \"color\": 5,\n        \"width\": 190,\n        \"height\": 80,\n        \"content\": \"# 预约时段\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"9c3e8b9f-3fe3-4380-8cbc-413146d752b9\",\n      \"name\": \"Sticky Note BookSlot Check\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        880,\n        1700\n      ],\n      \"parameters\": {\n        \"width\": 230,\n        \"height\": 80,\n        \"content\": \"检查是否提供了必要的预订信息（如电子邮件、姓名等）。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"c723bbd0-5a04-4efb-ba67-59bc722b9d4e\",\n      \"name\": \"Sticky Note BookSlot Error\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1440,\n        2060\n      ],\n      \"parameters\": {\n        \"width\": 190,\n        \"height\": 80,\n        \"content\": \"若信息缺失，则返回错误。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"a843e795-8046-4538-93e0-2de2e688c863\",\n      \"name\": \"Sticky Note BookSlot GCal\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1660,\n        1740\n      ],\n      \"parameters\": {\n        \"width\": 190,\n        \"height\": 80,\n        \"content\": \"在Google日历中预约。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"a7627281-15fc-438a-b031-b00cbc4b9fa4\",\n      \"name\": \"Sticky Note BookSlot Error Handle\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1920,\n        1920\n      ],\n      \"parameters\": {\n        \"width\": 230,\n        \"height\": 80,\n        \"content\": \"处理潜在的预约错误（例如，时段已被占用）。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"71c0c722-b5df-47d7-97e6-3d23533a4a4e\",\n      \"name\": \"Sticky Note BookSlot Response\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        2420,\n        1740\n      ],\n      \"parameters\": {\n        \"width\": 210,\n        \"height\": 80,\n        \"content\": \"将确认/错误信息发送回Vapi。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"4e598ebb-cfdb-432f-a01a-bb76d1d20f24\",\n      \"name\": \"Sticky Note BookSlot Airtable\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        3100,\n        1740\n      ],\n      \"parameters\": {\n        \"width\": 230,\n        \"height\": 80,\n        \"content\": \"将确认的预订详情记录到Airtable中。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"cc085c75-d45f-4453-b78b-1b9b480fb02c\",\n      \"name\": \"Sticky Note CancelSlot Webhook\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        440,\n        3480\n      ],\n      \"parameters\": {\n        \"color\": 3,\n        \"width\": 250,\n        \"height\": 80,\n        \"content\": \"# 取消槽位\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"9504b7e8-7964-4a0e-bfa4-32540c1fb895\",\n      \"name\": \"Sticky Note CancelSlot Check\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        960,\n        3780\n      ],\n      \"parameters\": {\n        \"width\": 230,\n        \"height\": 80,\n        \"content\": \"检查是否提供了必要信息（电子邮件、姓名、开始时间）。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"3bb9d976-d922-4016-839c-22e8b1adcf35\",\n      \"name\": \"Sticky Note CancelSlot Error\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1520,\n        3940\n      ],\n      \"parameters\": {\n        \"width\": 150,\n        \"height\": 80,\n        \"content\": \"若信息缺失，则返回错误。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"87442b3a-b8eb-43e6-b15d-0240a58bff79\",\n      \"name\": \"Sticky Note CancelSlot Search\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1300,\n        3440\n      ],\n      \"parameters\": {\n        \"width\": 190,\n        \"height\": 100,\n        \"content\": \"通过电话号码在Airtable中查找预约记录以获取事件ID。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"4e0cec59-1acc-4604-80ce-09479c7a6652\",\n      \"name\": \"Sticky Note CancelSlot GCal Delete\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1720,\n        3720\n      ],\n      \"parameters\": {\n        \"width\": 190,\n        \"height\": 80,\n        \"content\": \"使用事件ID从Google日历中删除该事件。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"68e00556-93d2-45a8-9fee-deb1477ffff2\",\n      \"name\": \"Sticky Note CancelSlot Airtable Update\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        2060,\n        3400\n      ],\n      \"parameters\": {\n        \"width\": 190,\n        \"height\": 80,\n        \"content\": \"将Airtable记录状态更新为“已取消”。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"5853b0f6-1e73-435e-aff8-5d9d8de53693\",\n      \"name\": \"Sticky Note CancelSlot Response\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        2380,\n        3740\n      ],\n      \"parameters\": {\n        \"width\": 190,\n        \"height\": 80,\n        \"content\": \"将取消确认/错误信息发送回Vapi。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"660cdb51-84ac-434e-b7d8-f7b17ef7ef5b\",\n      \"name\": \"Sticky Note UpdateSlot Webhook\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        460,\n        2600\n      ],\n      \"parameters\": {\n        \"color\": 6,\n        \"width\": 250,\n        \"height\": 80,\n        \"content\": \"# 更新槽位\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"030e4bce-4b8b-42b7-8cf4-86b3a88f375b\",\n      \"name\": \"Sticky Note UpdateSlot Check\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1000,\n        2900\n      ],\n      \"parameters\": {\n        \"width\": 230,\n        \"height\": 80,\n        \"content\": \"检查是否提供了必要信息（电子邮件、姓名、旧/新时间）。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"02e9f8e3-7561-4ace-95a2-2b1807940f1a\",\n      \"name\": \"Sticky Note UpdateSlot Error\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1500,\n        3020\n      ],\n      \"parameters\": {\n        \"width\": 190,\n        \"height\": 80,\n        \"content\": \"若信息缺失，则返回错误。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"4820cb6c-de15-4e9a-bca7-e3f172af6b80\",\n      \"name\": \"Sticky Note UpdateSlot Search\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1580,\n        2460\n      ],\n      \"parameters\": {\n        \"width\": 190,\n        \"height\": 80,\n        \"content\": \"在Airtable中通过旧电话号码查找原始预约记录\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"5dd3075e-8e0b-4f76-8d21-39aa66d449da\",\n      \"name\": \"Sticky Note UpdateSlot GCal Update\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        1940,\n        2720\n      ],\n      \"parameters\": {\n        \"width\": 190,\n        \"height\": 80,\n        \"content\": \"更新Google日历中的活动时间。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"2e08b4f6-f279-4a9e-9bd3-d6a6283b45f4\",\n      \"name\": \"Sticky Note UpdateSlot Airtable Update\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        2240,\n        2320\n      ],\n      \"parameters\": {\n        \"width\": 170,\n        \"height\": 100,\n        \"content\": \"更新Airtable记录，填入新时间并标记为“已更新”状态。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"d1369c19-401e-4ce2-a21e-0d5ae01af119\",\n      \"name\": \"Sticky Note UpdateSlot Response\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        2720,\n        2460\n      ],\n      \"parameters\": {\n        \"width\": 230,\n        \"height\": 80,\n        \"content\": \"将重新安排的确认/错误信息发送回Vapi。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"ca064fbe-b175-443f-b8e8-70a2a7551ba9\",\n      \"name\": \"Sticky Note CallResults Webhook\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        440,\n        4160\n      ],\n      \"parameters\": {\n        \"color\": 2,\n        \"width\": 390,\n        \"height\": 120,\n        \"content\": \"# 通话结果日志\\n接收通话后的摘要和录音详情。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"4941246b-82d1-4f16-b7b8-e1fdb6e7c833\",\n      \"name\": \"Sticky Note CallResults Airtable\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        860,\n        4460\n      ],\n      \"parameters\": {\n        \"width\": 230,\n        \"height\": 80,\n        \"content\": \"将通话记录日志、录音网址、摘要、费用及客户编号录入至Airtable。\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"e5622e9e-9b0a-43b2-ab80-e3e33a4b0409\",\n      \"name\": \"Getslot_tool\",\n      \"type\": \"n8n-nodes-base.webhook\",\n      \"position\": [\n        260,\n        740\n      ],\n      \"webhookId\": \"42afdbc1-afd0-4d65-a713-cf7a59062d6c\",\n      \"parameters\": {\n        \"path\": \"getslots\",\n        \"options\": {},\n        \"httpMethod\": \"POST\",\n        \"responseMode\": \"responseNode\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"e15781cf-5405-4f60-aa6d-ba19d1b7dabc\",\n      \"name\": \"Check Availability\",\n      \"type\": \"n8n-nodes-base.googleCalendar\",\n      \"position\": [\n        800,\n        740\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"timeMax\": \"={{ $json.endtime.toDateTime() || $now.plus(1, 'hour').toISO() }}\",\n        \"timeMin\": \"={{ $json.starttime.toDateTime() }}\",\n        \"calendar\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"pratik@customaistudio.io\",\n          \"cachedResultName\": \"pratik@customaistudio.io\"\n        },\n        \"resource\": \"calendar\"\n      },\n      \"credentials\": {},\n      \"typeVersion\": 1.3\n    },\n    {\n      \"id\": \"1e064283-2964-4eba-a893-e4270157c603\",\n      \"name\": \"Response\",\n      \"type\": \"n8n-nodes-base.respondToWebhook\",\n      \"position\": [\n        1540,\n        640\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"respondWith\": \"json\",\n        \"responseBody\": \"={\\n    \\\"results\\\":[\\n        {\\n            \\\"toolCallId\\\":\\\"{{ $('Getslot_tool').first().json.body.message.toolCalls[0].id }}\\\",\\n            \\\"result\\\":\\\"available:{{ $json.available }}\\\"\\n        }\\n    ]\\n}\"\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"498401cb-00e5-4fdd-b6a9-dd3e91376993\",\n      \"name\": \"Check if time is available or not\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        1020,\n        740\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"strict\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"4a8741a2-a903-4fb7-b0a3-5c74c7eea6ca\",\n              \"operator\": {\n                \"type\": \"boolean\",\n                \"operation\": \"true\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json.available }}\",\n              \"rightValue\": \"=\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"96e43c15-a332-4acf-af04-80dd989d5660\",\n      \"name\": \"Time available (true) & Call_id\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1320,\n        640\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"f582d965-af15-4ecf-8a8c-d8bf6c0d15c1\",\n              \"name\": \"body.message.toolCalls[0].id\",\n              \"type\": \"string\",\n              \"value\": \"={{ $('Input Arguments').item.json.body.message.toolCalls[0].id }}\"\n            },\n            {\n              \"id\": \"834ee925-5c8d-4e46-aeee-f399dc1ff40c\",\n              \"name\": \"available\",\n              \"type\": \"boolean\",\n              \"value\": \"={{ $json.available }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"fb7ad8c6-9f78-4518-b955-60f3f7088cb9\",\n      \"name\": \"Get All Calendar Events\",\n      \"type\": \"n8n-nodes-base.googleCalendar\",\n      \"position\": [\n        1320,\n        840\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"orderBy\": \"startTime\",\n          \"timeMax\": \"={{ $now.plus(1, 'week').toISO() }}\",\n          \"timeMin\": \"={{ $now.toISO() }}\",\n          \"singleEvents\": true\n        },\n        \"calendar\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"pratik@customaistudio.io\",\n          \"cachedResultName\": \"pratik@customaistudio.io\"\n        },\n        \"operation\": \"getAll\",\n        \"returnAll\": true\n      },\n      \"credentials\": {},\n      \"typeVersion\": 1,\n      \"alwaysOutputData\": true\n    },\n    {\n      \"id\": \"390599ee-ddeb-4628-af0b-36fbdd357cee\",\n      \"name\": \"Extract start, end and name\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1540,\n        840\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"ignoreConversionErrors\": true\n        },\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"1045b97f-c76f-450e-8f57-008602000848\",\n              \"name\": \"start\",\n              \"type\": \"string\",\n              \"value\": \"={{ DateTime.fromISO($json.start.dateTime).toLocaleString(DateTime.DATE_HUGE) }}, {{ DateTime.fromISO($json.start.dateTime).toLocaleString(DateTime.TIME_24_WITH_SHORT_OFFSET) }}\"\n            },\n            {\n              \"id\": \"457e3a2b-d33e-4a65-b2da-d19ad9d754ac\",\n              \"name\": \"end\",\n              \"type\": \"string\",\n              \"value\": \"={{ DateTime.fromISO($json.end.dateTime).toLocaleString(DateTime.DATE_HUGE) }}, {{ DateTime.fromISO($json.end.dateTime).toLocaleString(DateTime.TIME_24_WITH_SHORT_OFFSET) }}\"\n            },\n            {\n              \"id\": \"b6802452-557e-4568-af14-4574e8ecc013\",\n              \"name\": \"name\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.summary }}\"\n            },\n            {\n              \"id\": \"799b656f-68b6-467c-88a1-217ff7c7801b\",\n              \"name\": \"sort\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.start.dateTime }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"2c9a73da-37b7-4abd-af5e-695036cd2c2b\",\n      \"name\": \"Convert into Json format for Vapi\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        3120,\n        840\n      ],\n      \"parameters\": {\n        \"jsCode\": \"// Get the input data for the first item\\nconst inputData = $input.first().json;\\nconsole.log(\\\"Input Data:\\\", inputData); // Log input for debugging\\n\\n// Access the message string from the correct path within the input structure.\\n// The input comes from the \\\"Build Response Payload\\\" node, which structures data under 'results'.\\n// Use optional chaining (?.) for safety in case the structure is not as expected.\\nlet message = inputData.results?.[0]?.result;\\n\\n// Check if the message was found and is a string\\nif (typeof message !== 'string') {\\n    console.error(\\\"Could not find the message string at inputData.results[0].result or it's not a string. Input:\\\", inputData);\\n    // Return an object with an empty message or an error indicator\\n    return { message: \\\"\\\" }; // Or potentially throw an error: throw new Error(\\\"Input message not found or not a string\\\");\\n}\\n\\n// Start cleaning the message string\\n\\n// 1. Replace the literal string \\\"\\\\\\\\n\\\" (backslash followed by n) with a space.\\n// This handles the newline representation seen in the input screenshot.\\nlet cleanedMessage = message.replace(/\\\\\\\\n/g, ' ');\\n\\n// 2. Remove spaces immediately surrounding colons (e.g., \\\"Times : \\\" becomes \\\"Times:\\\").\\ncleanedMessage = cleanedMessage.replace(/\\\\s*:\\\\s*/g, ':');\\n\\n// 3. Replace sequences of multiple whitespace characters (including spaces from replaced \\\\n)\\n// with a single space. Then, trim any leading or trailing whitespace from the result.\\ncleanedMessage = cleanedMessage.replace(/\\\\s+/g, ' ').trim();\\n\\n// Create the final output JSON object containing the cleaned message.\\nconst output = {\\n    message: cleanedMessage\\n};\\n\\n// Return the output object. This will be the output of the Code node.\\nreturn output;\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"e00cf72a-af6a-441b-9b76-81bd8096d3df\",\n      \"name\": \"Response to Vapi\",\n      \"type\": \"n8n-nodes-base.respondToWebhook\",\n      \"position\": [\n        3360,\n        840\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"respondWith\": \"json\",\n        \"responseBody\": \"={\\n    \\\"results\\\":[\\n        {\\n            \\\"toolCallId\\\":\\\"{{ $('Getslot_tool').first().json.body.message.toolCalls[0].id }}\\\",\\n            \\\"result\\\":\\\"The original time is not available, here are available slots:{{ $json.message }}\\\"\\n        }\\n    ]\\n}\"\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"facf3bf9-e05e-4953-a221-bf7f566a3b0f\",\n      \"name\": \"bookslots_tool\",\n      \"type\": \"n8n-nodes-base.webhook\",\n      \"position\": [\n        400,\n        1800\n      ],\n      \"webhookId\": \"42afdbc1-afd0-4d65-a713-cf7a59062d6c\",\n      \"parameters\": {\n        \"path\": \"bookslots\",\n        \"options\": {},\n        \"httpMethod\": \"POST\",\n        \"responseMode\": \"responseNode\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"9266904b-300f-4c83-a518-4cd69b13de41\",\n      \"name\": \"Input Arguments from booking tools\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        720,\n        1800\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"eac930a3-ba65-4b0d-b236-aa167d7edb3f\",\n              \"name\": \"toolCallId\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.message.toolCalls[0].id }}\"\n            },\n            {\n              \"id\": \"492186b8-e3a3-4ab9-87f4-45d8cbc38c13\",\n              \"name\": \"timeZone\",\n              \"type\": \"string\",\n              \"value\": \"=America/Chicago\"\n            },\n            {\n              \"id\": \"12aeec42-9414-4d43-8837-1ff747f49305\",\n              \"name\": \"name\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.message.toolCalls[0].function.arguments.name || \\\"John Smith\\\" }}\"\n            },\n            {\n              \"id\": \"36673f27-c026-4ad9-81da-ad11e71bbfb6\",\n              \"name\": \"email\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.message.toolCalls[0].function.arguments.email }}\"\n            },\n            {\n              \"id\": \"469ddc00-a399-47a5-8c55-97cd3adf4143\",\n              \"name\": \"language\",\n              \"type\": \"string\",\n              \"value\": \"en\"\n            },\n            {\n              \"id\": \"b191cd98-f3f7-48b1-a2e0-2c9e248a4983\",\n              \"name\": \"notes\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.message.toolCalls[0].function.arguments.notes || \\\"\\\"}}\"\n            },\n            {\n              \"id\": \"783cb161-65e4-4829-ac90-5c6c2c55585f\",\n              \"name\": \"starttime\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.message.toolCalls[0].function.arguments.starttime }}\"\n            },\n            {\n              \"id\": \"bfcdade9-14c8-4867-8a22-3865a2bcc116\",\n              \"name\": \"endtime\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.message.toolCalls[0].function.arguments.endtime }}\"\n            },\n            {\n              \"id\": \"26ca39ef-48f5-41ed-990e-40c2a26d6132\",\n              \"name\": \"Tittle\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.message.toolCalls[0].function.arguments.Title }}\"\n            },\n            {\n              \"id\": \"43575f7a-3873-4d74-90c5-4467c7779514\",\n              \"name\": \"customer_number\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.message.call.customer.number }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.3\n    },\n    {\n      \"id\": \"b4bc5cee-d631-4aa8-a3ff-59a0b647d36a\",\n      \"name\": \"Convert time to CST America / Chicago\",\n      \"type\": \"n8n-nodes-base.code\",\n      \"position\": [\n        1480,\n        1580\n      ],\n      \"parameters\": {\n        \"jsCode\": \"// Get all input items\\nconst items = $input.all();\\n\\n// Loop through each item\\nfor (const item of items) {\\n  // Get the values from the current item's JSON data\\n  const startTimeUTC = item.json.starttime;\\n  const endTimeUTC = item.json.endtime;\\n  const targetTimeZone = item.json.timeZone; // e.g., \\\"America/Chicago\\\"\\n\\n  // Basic validation: ensure the necessary fields exist\\n  if (!startTimeUTC || !endTimeUTC || !targetTimeZone) {\\n    console.warn(`Skipping item due to missing time data or timezone. Item JSON: ${JSON.stringify(item.json)}`);\\n    item.json.conversionError = \\\"Missing starttime, endtime, or timeZone\\\";\\n    continue; // Move to the next item\\n  }\\n\\n  try {\\n    // --- Start Time Conversion ---\\n    // Parse the original UTC ISO string using Luxon (NO $ prefix)\\n    const startDt = luxon.DateTime.fromISO(startTimeUTC, { zone: 'utc' });\\n\\n    // Convert the DateTime object to the target timezone\\n    const startDtTargetZone = startDt.setZone(targetTimeZone);\\n\\n    // Check if the conversion was valid\\n    if (!startDtTargetZone.isValid) {\\n      throw new Error(`Failed to convert start time. Reason: ${startDtTargetZone.invalidReason || 'Unknown'}`);\\n    }\\n\\n    // Format the result back into an ISO string with the correct offset\\n    item.json.starttime = startDtTargetZone.toISO();\\n\\n    // --- End Time Conversion ---\\n    // Parse the original UTC ISO string using Luxon (NO $ prefix)\\n    const endDt = luxon.DateTime.fromISO(endTimeUTC, { zone: 'utc' });\\n\\n    // Convert the DateTime object to the target timezone\\n    const endDtTargetZone = endDt.setZone(targetTimeZone);\\n\\n     // Check if the conversion was valid\\n    if (!endDtTargetZone.isValid) {\\n      throw new Error(`Failed to convert end time. Reason: ${endDtTargetZone.invalidReason || 'Unknown'}`);\\n    }\\n\\n    // Format the result back into an ISO string with the correct offset\\n    item.json.endtime = endDtTargetZone.toISO();\\n\\n    // Optionally remove the error flag if conversion was successful this time\\n    delete item.json.conversionError;\\n\\n  } catch (error) {\\n    console.error(`Error converting time for item: ${JSON.stringify(item.json)}. Error: ${error.message}`);\\n    // Add/update the error flag to the item's JSON\\n    item.json.conversionError = error.message;\\n  }\\n}\\n// Return the modified array of items\\nreturn items;\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"2c8b2884-14d3-4bd4-92d8-6e402ca3a8de\",\n      \"name\": \"Create Event\",\n      \"type\": \"n8n-nodes-base.googleCalendar\",\n      \"onError\": \"continueErrorOutput\",\n      \"position\": [\n        1700,\n        1580\n      ],\n      \"parameters\": {\n        \"end\": \"={{ $json.endtime }}\",\n        \"start\": \"={{ $json.starttime }}\",\n        \"calendar\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"pratik@customaistudio.io\",\n          \"cachedResultName\": \"pratik@customaistudio.io\"\n        },\n        \"additionalFields\": {\n          \"allday\": \"no\",\n          \"summary\": \"={{ $json.Tittle }}\",\n          \"showMeAs\": \"opaque\",\n          \"attendees\": [\n            \"={{ $json.email }}\"\n          ],\n          \"description\": \"={{ $json.notes }}\",\n          \"conferenceDataUi\": {\n            \"conferenceDataValues\": {\n              \"conferenceSolution\": \"hangoutsMeet\"\n            }\n          }\n        }\n      },\n      \"credentials\": {},\n      \"typeVersion\": 1.3\n    },\n    {\n      \"id\": \"b8890ab2-9850-4608-996d-45c8a6d3a52e\",\n      \"name\": \"Respond to Vapi\",\n      \"type\": \"n8n-nodes-base.respondToWebhook\",\n      \"onError\": \"continueRegularOutput\",\n      \"position\": [\n        2480,\n        1580\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"respondWith\": \"json\",\n        \"responseBody\": \"={\\n    \\\"results\\\":[\\n        {\\n            \\\"toolCallId\\\":\\\"{{ $json.results[0].toolCallId }}\\\",\\n            \\\"result\\\":\\\"available:{{ $json.results[0].result }}\\\"\\n        }\\n    ]\\n}\"\n      },\n      \"typeVersion\": 1.1,\n      \"alwaysOutputData\": true\n    },\n    {\n      \"id\": \"77f75f42-46bb-47f5-8a43-55543ae46f10\",\n      \"name\": \"If the booking is confirmed then true\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        2700,\n        1580\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"loose\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"932dd430-309b-4d3b-8bf6-768f84fd2dd2\",\n              \"operator\": {\n                \"name\": \"filter.operator.equals\",\n                \"type\": \"string\",\n                \"operation\": \"equals\"\n              },\n              \"leftValue\": \"={{ $json.results[0].result }}\",\n              \"rightValue\": \"=confirmed\"\n            }\n          ]\n        },\n        \"looseTypeValidation\": true\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"230ddb29-67f0-4486-a6f3-f4dd3dbbee42\",\n      \"name\": \"Information to be Saved in Airtable\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        2940,\n        1560\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"b103265d-86da-4256-994d-85a78f33f933\",\n              \"name\": \"startTime\",\n              \"type\": \"string\",\n              \"value\": \"={{ $('Booking Payload').item.json.startTime }}\"\n            },\n            {\n              \"id\": \"a8e6e9c5-6ebb-48d8-951f-b007bed2421d\",\n              \"name\": \"endTime\",\n              \"type\": \"string\",\n              \"value\": \"={{ $('Booking Payload').item.json.endTime }}\"\n            },\n            {\n              \"id\": \"d4bcb1d1-043a-4205-8488-0a67b4e7b582\",\n              \"name\": \"status\",\n              \"type\": \"string\",\n              \"value\": \"={{ $('Booking Payload').item.json.status }}\"\n            },\n            {\n              \"id\": \"92ac8c99-ad94-4b3c-9c5e-ba032dac2255\",\n              \"name\": \"description\",\n              \"type\": \"string\",\n              \"value\": \"={{ $('Booking Payload').item.json.description }}\"\n            },\n            {\n              \"id\": \"98c5653d-1e0e-4a6a-8630-17802d437593\",\n              \"name\": \"attendees[0].email\",\n              \"type\": \"string\",\n              \"value\": \"={{ $('Booking Payload').item.json.attendees[0].email }}\"\n            },\n            {\n              \"id\": \"f94bdfc1-dc74-4675-ad29-19244fb21ebe\",\n              \"name\": \"attendees[0].responseStatus\",\n              \"type\": \"string\",\n              \"value\": \"={{ $('Booking Payload').item.json.attendees[0].responseStatus }}\"\n            },\n            {\n              \"id\": \"12bd5ed5-4934-4c19-a9b9-54fe989eaa4f\",\n              \"name\": \"hangoutLink\",\n              \"type\": \"string\",\n              \"value\": \"={{ $('Booking Payload').item.json.hangoutLink }}\"\n            },\n            {\n              \"id\": \"5b1f9356-7d62-4999-ae4e-86f3f20d72bf\",\n              \"name\": \"attendee.name\",\n              \"type\": \"string\",\n              \"value\": \"={{ $('bookslots_tool').item.json.body.message.toolCalls[0].function.arguments.name }}\"\n            },\n            {\n              \"id\": \"6e93805e-8754-4f92-870f-7b46525f3eb3\",\n              \"name\": \"call.id\",\n              \"type\": \"string\",\n              \"value\": \"={{ $('bookslots_tool').item.json.body.message.call.id }}\"\n            },\n            {\n              \"id\": \"f174e2be-3230-4fc9-970b-971aff6e9b8e\",\n              \"name\": \"assistant.name\",\n              \"type\": \"string\",\n              \"value\": \"={{ $('bookslots_tool').item.json.body.message.assistant.name }}\"\n            },\n            {\n              \"id\": \"a4bc9d70-7d51-487f-b622-433e767ef71f\",\n              \"name\": \"event.id\",\n              \"type\": \"string\",\n              \"value\": \"={{ $('Create Event').item.json.id }}\"\n            },\n            {\n              \"id\": \"9259b1d3-3658-4ab5-b434-364e6a84d145\",\n              \"name\": \"Title\",\n              \"type\": \"string\",\n              \"value\": \"={{ $('Booking Payload').item.json.Title }}\"\n            },\n            {\n              \"id\": \"2102a7be-5d74-458f-bafd-21651e24adb1\",\n              \"name\": \"customer_number\",\n              \"type\": \"string\",\n              \"value\": \"={{ $('Input Arguments from booking tools').item.json.customer_number}}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"f6c7774d-a8c7-466a-ba77-401194fe6fb4\",\n      \"name\": \"Logs the confirmed booking details\",\n      \"type\": \"n8n-nodes-base.airtable\",\n      \"position\": [\n        3160,\n        1560\n      ],\n      \"parameters\": {\n        \"base\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"appnj853UnMRnJ8D3\",\n          \"cachedResultUrl\": \"https://airtable.com/appnj853UnMRnJ8D3\",\n          \"cachedResultName\": \"Voice Receptionist Agent\"\n        },\n        \"table\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"tblF8LF9lmkHMbk7v\",\n          \"cachedResultUrl\": \"https://airtable.com/appnj853UnMRnJ8D3/tblF8LF9lmkHMbk7v\",\n          \"cachedResultName\": \"Appointments\"\n        },\n        \"columns\": {\n          \"value\": {\n            \"Name\": \"={{ $json.attendee.name }}\",\n            \"Email\": \"={{ $json.attendees[0].email }}\",\n            \"endtime\": \"={{ $json.endTime }}\",\n            \"eventId\": \"={{ $json.event.id }}\",\n            \"meetlink\": \"={{ $json.hangoutLink }}\",\n            \"starttime\": \"={{ $json.startTime }}\",\n            \"Voice Agent\": \"={{ [$json.assistant.name] }}\",\n            \"Phone Number\": \"={{ $json.customer_number }}\",\n            \"Booking Status\": \"={{ $json.status }}\",\n            \"CallRecordingId\": \"={{ [$json.call.id] }}\",\n            \"meetdescription\": \"={{ $json.Title }} {{ $json.description }}\"\n          },\n          \"schema\": [\n            {\n              \"id\": \"Email\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"readOnly\": false,\n              \"required\": false,\n              \"displayName\": \"Email\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Phone Number\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"readOnly\": false,\n              \"required\": false,\n              \"displayName\": \"Phone Number\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Name\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"readOnly\": false,\n              \"required\": false,\n              \"displayName\": \"Name\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Booking Status\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"readOnly\": false,\n              \"required\": false,\n              \"displayName\": \"Booking Status\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"CallRecordingId\",\n              \"type\": \"array\",\n              \"display\": true,\n              \"removed\": false,\n              \"readOnly\": false,\n              \"required\": false,\n              \"displayName\": \"CallRecordingId\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"starttime\",\n              \"type\": \"dateTime\",\n              \"display\": true,\n              \"removed\": false,\n              \"readOnly\": false,\n              \"required\": false,\n              \"displayName\": \"starttime\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"endtime\",\n              \"type\": \"dateTime\",\n              \"display\": true,\n              \"removed\": false,\n              \"readOnly\": false,\n              \"required\": false,\n              \"displayName\": \"endtime\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"meetlink\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"readOnly\": false,\n              \"required\": false,\n              \"displayName\": \"meetlink\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"meetdescription\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"readOnly\": false,\n              \"required\": false,\n              \"displayName\": \"meetdescription\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Voice Agent\",\n              \"type\": \"array\",\n              \"display\": true,\n              \"removed\": false,\n              \"readOnly\": false,\n              \"required\": false,\n              \"displayName\": \"Voice Agent\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"eventId\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"readOnly\": false,\n              \"required\": false,\n              \"displayName\": \"eventId\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Appointments\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": true,\n              \"readOnly\": true,\n              \"required\": false,\n              \"displayName\": \"Appointments\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            }\n          ],\n          \"mappingMode\": \"defineBelow\",\n          \"matchingColumns\": [\n            \"Email\"\n          ],\n          \"attemptToConvertTypes\": false,\n          \"convertFieldsToString\": false\n        },\n        \"options\": {\n          \"typecast\": true\n        },\n        \"operation\": \"create\"\n      },\n      \"credentials\": {},\n      \"typeVersion\": 2.1\n    },\n    {\n      \"id\": \"154bee14-9281-4b92-8204-57c5436785ba\",\n      \"name\": \"Updateslots_tool\",\n      \"type\": \"n8n-nodes-base.webhook\",\n      \"position\": [\n        460,\n        2720\n      ],\n      \"webhookId\": \"66b278fe-97d1-4413-b6dd-4288d8ec66b2\",\n      \"parameters\": {\n        \"path\": \"updateslots\",\n        \"options\": {},\n        \"httpMethod\": \"POST\",\n        \"responseMode\": \"responseNode\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"891fb4ec-3a82-4433-bebf-3f0616027e3d\",\n      \"name\": \"Input Arguments from updateslot tool\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        840,\n        2720\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"6f6388ab-a233-4643-9b28-917ad6bdfe22\",\n              \"name\": \"Calls[0].id\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.message.toolCalls[0].id }}\"\n            },\n            {\n              \"id\": \"40888d2c-b99d-401d-a6b9-944ba41543c6\",\n              \"name\": \"name\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.message.toolCalls[0].function.arguments.name }}\"\n            },\n            {\n              \"id\": \"17be6cf6-8c48-4a4e-a0e8-b5b714f94242\",\n              \"name\": \"email\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.message.toolCalls[0].function.arguments.email }}\"\n            },\n            {\n              \"id\": \"d06fd547-39c1-457b-8422-393f140aead6\",\n              \"name\": \"starttime\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.message.toolCalls[0].function.arguments.starttime }}\"\n            },\n            {\n              \"id\": \"c224df67-ec82-40f3-9af2-3472731a57fa\",\n              \"name\": \"endtime\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.message.toolCalls[0].function.arguments.endtime }}\"\n            },\n            {\n              \"id\": \"b2fb0887-5545-409c-bba8-fae76a71f660\",\n              \"name\": \"call.id\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.message.call.id }}\"\n            },\n            {\n              \"id\": \"19efa4c6-25e0-4fe8-a00e-0b37f16b6de0\",\n              \"name\": \"Rescheduled_starttime\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.message.toolCalls[0].function.arguments.Rescheduled_starttime }}\"\n            },\n            {\n              \"id\": \"ad47dfdb-66fa-478d-899f-1d9d202aac6f\",\n              \"name\": \"Rescheduled_endttime\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.message.toolCalls[0].function.arguments.Rescheduled_endttime }}\"\n            },\n            {\n              \"id\": \"6d1bf6c0-a4b4-41d4-826e-e7c73f920905\",\n              \"name\": \"customer_number\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.message.call.customer.number }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"617a7742-299a-4c91-be82-cba598d1bb82\",\n      \"name\": \"Checks if required info is provided.\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        1060,\n        2720\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"loose\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"87304425-5f17-4637-8aa3-cd84b2f8d856\",\n              \"operator\": {\n                \"type\": \"string\",\n                \"operation\": \"exists\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json.name }}\",\n              \"rightValue\": \"\"\n            },\n            {\n              \"id\": \"fdc6ffb0-f234-4869-8f5e-482c394ab860\",\n              \"operator\": {\n                \"type\": \"string\",\n                \"operation\": \"exists\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json.email }}\",\n              \"rightValue\": \"\"\n            },\n            {\n              \"id\": \"7950d7bc-7416-48b6-8ec5-a635a9161013\",\n              \"operator\": {\n                \"type\": \"dateTime\",\n                \"operation\": \"exists\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json.Rescheduled_starttime }}\",\n              \"rightValue\": \"={{ $json.Rescheduledtime }}\"\n            },\n            {\n              \"id\": \"aa54ee15-1273-48b0-863f-939597af04e6\",\n              \"operator\": {\n                \"type\": \"dateTime\",\n                \"operation\": \"exists\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json.Rescheduled_endttime }}\",\n              \"rightValue\": \"\"\n            },\n            {\n              \"id\": \"8ceefa9d-360c-48b6-8faf-e156459f2c07\",\n              \"operator\": {\n                \"type\": \"dateTime\",\n                \"operation\": \"exists\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json.starttime }}\",\n              \"rightValue\": \"\"\n            }\n          ]\n        },\n        \"looseTypeValidation\": true\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"dded1cfa-ce89-481f-967b-6843854a32bd\",\n      \"name\": \"Finds original appointment\",\n      \"type\": \"n8n-nodes-base.airtable\",\n      \"maxTries\": 2,\n      \"position\": [\n        1600,\n        2560\n      ],\n      \"parameters\": {\n        \"base\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"appnj853UnMRnJ8D3\",\n          \"cachedResultUrl\": \"https://airtable.com/appnj853UnMRnJ8D3\",\n          \"cachedResultName\": \"Voice Receptionist Agent\"\n        },\n        \"table\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"tblF8LF9lmkHMbk7v\",\n          \"cachedResultUrl\": \"https://airtable.com/appnj853UnMRnJ8D3/tblF8LF9lmkHMbk7v\",\n          \"cachedResultName\": \"Appointments\"\n        },\n        \"options\": {\n          \"fields\": [\n            \"Email\",\n            \"Name\",\n            \"starttime\",\n            \"eventId\"\n          ]\n        },\n        \"operation\": \"search\",\n        \"filterByFormula\": \"={Phone Number} = (\\\"{{ $json.customer_number }}\\\")\"\n      },\n      \"credentials\": {},\n      \"retryOnFail\": false,\n      \"typeVersion\": 2.1,\n      \"alwaysOutputData\": false\n    },\n    {\n      \"id\": \"a3fd9971-20bb-414a-b06c-1af4da053241\",\n      \"name\": \"Response with Error\",\n      \"type\": \"n8n-nodes-base.respondToWebhook\",\n      \"position\": [\n        1780,\n        2840\n      ],\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"0731f0ae-fbdb-4149-890a-0a44c95b2691\",\n      \"name\": \"Update Event\",\n      \"type\": \"n8n-nodes-base.googleCalendar\",\n      \"onError\": \"continueErrorOutput\",\n      \"position\": [\n        1980,\n        2560\n      ],\n      \"parameters\": {\n        \"eventId\": \"={{ $json.eventId }}\",\n        \"calendar\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"pratik@customaistudio.io\",\n          \"cachedResultName\": \"pratik@customaistudio.io\"\n        },\n        \"operation\": \"update\",\n        \"updateFields\": {\n          \"end\": \"={{ $('Checks if required info is provided.').item.json.Rescheduled_endttime }}\",\n          \"start\": \"={{ $('Checks if required info is provided.').item.json.Rescheduled_starttime }}\",\n          \"allday\": \"no\"\n        }\n      },\n      \"credentials\": {},\n      \"typeVersion\": 1.3\n    },\n    {\n      \"id\": \"1e7af704-6c5d-4e6b-a606-2c5c7ef64b10\",\n      \"name\": \"Updates Airtable record\",\n      \"type\": \"n8n-nodes-base.airtable\",\n      \"position\": [\n        2280,\n        2440\n      ],\n      \"parameters\": {\n        \"base\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"appnj853UnMRnJ8D3\",\n          \"cachedResultUrl\": \"https://airtable.com/appnj853UnMRnJ8D3\",\n          \"cachedResultName\": \"Voice Receptionist Agent\"\n        },\n        \"table\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"tblF8LF9lmkHMbk7v\",\n          \"cachedResultUrl\": \"https://airtable.com/appnj853UnMRnJ8D3/tblF8LF9lmkHMbk7v\",\n          \"cachedResultName\": \"Appointments\"\n        },\n        \"columns\": {\n          \"value\": {\n            \"endtime\": \"={{ $json.end.dateTime }}\",\n            \"eventId\": \"={{ $('Finds original appointment').item.json.eventId }}\",\n            \"starttime\": \"={{ $json.start.dateTime }}\",\n            \"Booking Status\": \"Updated/Rescheduled\"\n          },\n          \"schema\": [\n            {\n              \"id\": \"id\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": true,\n              \"readOnly\": true,\n              \"required\": false,\n              \"displayName\": \"id\",\n              \"defaultMatch\": true\n            },\n            {\n              \"id\": \"Email\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": true,\n              \"readOnly\": false,\n              \"required\": false,\n              \"displayName\": \"Email\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Phone Number\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": true,\n              \"readOnly\": false,\n              \"required\": false,\n              \"displayName\": \"Phone Number\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Name\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": true,\n              \"readOnly\": false,\n              \"required\": false,\n              \"displayName\": \"Name\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Booking Status\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"readOnly\": false,\n              \"required\": false,\n              \"displayName\": \"Booking Status\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"CallRecordingId\",\n              \"type\": \"array\",\n              \"display\": true,\n              \"removed\": true,\n              \"readOnly\": false,\n              \"required\": false,\n              \"displayName\": \"CallRecordingId\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"starttime\",\n              \"type\": \"dateTime\",\n              \"display\": true,\n              \"removed\": false,\n              \"readOnly\": false,\n              \"required\": false,\n              \"displayName\": \"starttime\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"endtime\",\n              \"type\": \"dateTime\",\n              \"display\": true,\n              \"removed\": false,\n              \"readOnly\": false,\n              \"required\": false,\n              \"displayName\": \"endtime\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"meetlink\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": true,\n              \"readOnly\": false,\n              \"required\": false,\n              \"displayName\": \"meetlink\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"meetdescription\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": true,\n              \"readOnly\": false,\n              \"required\": false,\n              \"displayName\": \"meetdescription\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Voice Agent\",\n              \"type\": \"array\",\n              \"display\": true,\n              \"removed\": true,\n              \"readOnly\": false,\n              \"required\": false,\n              \"displayName\": \"Voice Agent\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"eventId\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"readOnly\": false,\n              \"required\": false,\n              \"displayName\": \"eventId\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Appointments\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": true,\n              \"readOnly\": true,\n              \"required\": false,\n              \"displayName\": \"Appointments\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            }\n          ],\n          \"mappingMode\": \"defineBelow\",\n          \"matchingColumns\": [\n            \"eventId\"\n          ],\n          \"attemptToConvertTypes\": false,\n          \"convertFieldsToString\": false\n        },\n        \"options\": {},\n        \"operation\": \"update\"\n      },\n      \"credentials\": {},\n      \"typeVersion\": 2.1\n    },\n    {\n      \"id\": \"5a74d949-f08e-422c-afde-e41690a8512b\",\n      \"name\": \"Response & call_id\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        2620,\n        2580\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"074d1ef3-e96b-4149-a12c-b8aa71c9c117\",\n              \"name\": \"results[0].toolCallId\",\n              \"type\": \"string\",\n              \"value\": \"={{ $('Updateslots_tool').item.json.body.message.toolCalls[0].id }}\"\n            },\n            {\n              \"id\": \"098bb88d-9b17-4aeb-850c-819406aa0f3b\",\n              \"name\": \"results[0].result\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.error || $json.fields['Booking Status']  }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"bb7dc099-c4ac-48d4-bf8c-50f4f8858dd4\",\n      \"name\": \"Respond to Vapi about Updating slots\",\n      \"type\": \"n8n-nodes-base.respondToWebhook\",\n      \"position\": [\n        2820,\n        2580\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"respondWith\": \"json\",\n        \"responseBody\": \"={\\n    \\\"results\\\":[\\n        {\\n            \\\"toolCallId\\\":\\\"{{ $json.results[0].toolCallId }}\\\",\\n            \\\"result\\\":\\\"{{ $json.results[0].result }}\\\"\\n        }\\n    ]\\n}\"\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"2154c9c8-acd3-4144-9fa6-f6f7de7bbf48\",\n      \"name\": \"CancelSlots_tool\",\n      \"type\": \"n8n-nodes-base.webhook\",\n      \"position\": [\n        440,\n        3620\n      ],\n      \"webhookId\": \"00fedd5a-c03d-4302-b8e0-22c79f26ed05\",\n      \"parameters\": {\n        \"path\": \"cancelslots\",\n        \"options\": {},\n        \"httpMethod\": \"POST\",\n        \"responseMode\": \"responseNode\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"aeabd266-4b0e-436f-9c8c-607fb7b6734a\",\n      \"name\": \"Input Arguments from cancelslot tool\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        800,\n        3620\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"6f6388ab-a233-4643-9b28-917ad6bdfe22\",\n              \"name\": \"Calls[0].id\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.message.toolCalls[0].id }}\"\n            },\n            {\n              \"id\": \"40888d2c-b99d-401d-a6b9-944ba41543c6\",\n              \"name\": \"name\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.message.toolCalls[0].function.arguments.name }}\"\n            },\n            {\n              \"id\": \"17be6cf6-8c48-4a4e-a0e8-b5b714f94242\",\n              \"name\": \"email\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.message.toolCalls[0].function.arguments.email }}\"\n            },\n            {\n              \"id\": \"d06fd547-39c1-457b-8422-393f140aead6\",\n              \"name\": \"starttime\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.message.toolCalls[0].function.arguments.starttime }}\"\n            },\n            {\n              \"id\": \"0a0243b2-afc4-44f1-92cd-81572df79cc5\",\n              \"name\": \"Cancelnotes\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.message.toolCalls[0].function.arguments.Cancelnotes }}\"\n            },\n            {\n              \"id\": \"b2fb0887-5545-409c-bba8-fae76a71f660\",\n              \"name\": \"call.id\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.message.call.id }}\"\n            },\n            {\n              \"id\": \"8d528786-75d7-466e-8e8f-2013e4638bc2\",\n              \"name\": \"customer_number\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.message.call.customer.number }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"b702973e-15f0-4bbe-98ac-d4af7a57cff1\",\n      \"name\": \"Checks if required info is provided for cancelation\",\n      \"type\": \"n8n-nodes-base.if\",\n      \"position\": [\n        1020,\n        3620\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"conditions\": {\n          \"options\": {\n            \"version\": 2,\n            \"leftValue\": \"\",\n            \"caseSensitive\": true,\n            \"typeValidation\": \"loose\"\n          },\n          \"combinator\": \"and\",\n          \"conditions\": [\n            {\n              \"id\": \"87304425-5f17-4637-8aa3-cd84b2f8d856\",\n              \"operator\": {\n                \"type\": \"string\",\n                \"operation\": \"exists\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json.name }}\",\n              \"rightValue\": \"\"\n            },\n            {\n              \"id\": \"fdc6ffb0-f234-4869-8f5e-482c394ab860\",\n              \"operator\": {\n                \"type\": \"string\",\n                \"operation\": \"exists\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json.email }}\",\n              \"rightValue\": \"\"\n            },\n            {\n              \"id\": \"c0b869e4-9490-4c01-b138-835bb34eb1ba\",\n              \"operator\": {\n                \"type\": \"dateTime\",\n                \"operation\": \"exists\",\n                \"singleValue\": true\n              },\n              \"leftValue\": \"={{ $json.starttime }}\",\n              \"rightValue\": \"\"\n            }\n          ]\n        },\n        \"looseTypeValidation\": true\n      },\n      \"typeVersion\": 2.2\n    },\n    {\n      \"id\": \"c5e49060-7b76-4622-bc23-b389f1665215\",\n      \"name\": \"Finds the appointment record\",\n      \"type\": \"n8n-nodes-base.airtable\",\n      \"position\": [\n        1300,\n        3560\n      ],\n      \"parameters\": {\n        \"base\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"appnj853UnMRnJ8D3\",\n          \"cachedResultUrl\": \"https://airtable.com/appnj853UnMRnJ8D3\",\n          \"cachedResultName\": \"Voice Receptionist Agent\"\n        },\n        \"table\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"tblF8LF9lmkHMbk7v\",\n          \"cachedResultUrl\": \"https://airtable.com/appnj853UnMRnJ8D3/tblF8LF9lmkHMbk7v\",\n          \"cachedResultName\": \"Appointments\"\n        },\n        \"options\": {\n          \"fields\": [\n            \"Email\",\n            \"Name\",\n            \"starttime\",\n            \"eventId\"\n          ]\n        },\n        \"operation\": \"search\",\n        \"filterByFormula\": \"={Phone Number} = (\\\"{{ $json.customer_number }}\\\")\"\n      },\n      \"credentials\": {},\n      \"typeVersion\": 2.1,\n      \"alwaysOutputData\": true\n    },\n    {\n      \"id\": \"dd83c017-6f5b-49b4-83f9-ec2f33ca5ed0\",\n      \"name\": \"Build Error Response\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        1300,\n        3780\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"5cb05b10-e916-459e-84a2-9c314a859a07\",\n              \"name\": \"results[0].toolCallId\",\n              \"type\": \"string\",\n              \"value\": \"={{ $('Input Arguments from booking tools').item.json.toolCallId }}\"\n            },\n            {\n              \"id\": \"552246f9-7afd-404e-9fb3-cb38c7447359\",\n              \"name\": \"results[0].result\",\n              \"type\": \"string\",\n              \"value\": \"=You must provide an email, name and starttime to call this tool\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"ca74e845-ee23-4f8a-ba8e-789186fe7add\",\n      \"name\": \"Respond with Error to Vapi\",\n      \"type\": \"n8n-nodes-base.respondToWebhook\",\n      \"position\": [\n        1500,\n        3780\n      ],\n      \"parameters\": {\n        \"options\": {}\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"ad3c2ad0-ba5e-48a6-865f-a8da63173562\",\n      \"name\": \"Delete Event\",\n      \"type\": \"n8n-nodes-base.googleCalendar\",\n      \"onError\": \"continueErrorOutput\",\n      \"position\": [\n        1720,\n        3560\n      ],\n      \"parameters\": {\n        \"eventId\": \"={{ $json.eventId }}\",\n        \"options\": {\n          \"sendUpdates\": \"all\"\n        },\n        \"calendar\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"pratik@customaistudio.io\",\n          \"cachedResultName\": \"pratik@customaistudio.io\"\n        },\n        \"operation\": \"delete\"\n      },\n      \"credentials\": {},\n      \"typeVersion\": 1.3\n    },\n    {\n      \"id\": \"177a1297-8e96-4d04-a0ff-e16aab71d5b9\",\n      \"name\": \"Update Airtable record\",\n      \"type\": \"n8n-nodes-base.airtable\",\n      \"position\": [\n        1940,\n        3440\n      ],\n      \"parameters\": {\n        \"base\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"appnj853UnMRnJ8D3\",\n          \"cachedResultUrl\": \"https://airtable.com/appnj853UnMRnJ8D3\",\n          \"cachedResultName\": \"Voice Receptionist Agent\"\n        },\n        \"table\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"tblF8LF9lmkHMbk7v\",\n          \"cachedResultUrl\": \"https://airtable.com/appnj853UnMRnJ8D3/tblF8LF9lmkHMbk7v\",\n          \"cachedResultName\": \"Appointments\"\n        },\n        \"columns\": {\n          \"value\": {\n            \"eventId\": \"={{ $('Finds the appointment record').item.json.eventId }}\",\n            \"Booking Status\": \"Canceled\"\n          },\n          \"schema\": [\n            {\n              \"id\": \"id\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": true,\n              \"readOnly\": true,\n              \"required\": false,\n              \"displayName\": \"id\",\n              \"defaultMatch\": true\n            },\n            {\n              \"id\": \"Email\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": true,\n              \"readOnly\": false,\n              \"required\": false,\n              \"displayName\": \"Email\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Phone Number\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": true,\n              \"readOnly\": false,\n              \"required\": false,\n              \"displayName\": \"Phone Number\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Name\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": true,\n              \"readOnly\": false,\n              \"required\": false,\n              \"displayName\": \"Name\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Booking Status\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"readOnly\": false,\n              \"required\": false,\n              \"displayName\": \"Booking Status\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"CallRecordingId\",\n              \"type\": \"array\",\n              \"display\": true,\n              \"removed\": true,\n              \"readOnly\": false,\n              \"required\": false,\n              \"displayName\": \"CallRecordingId\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"starttime\",\n              \"type\": \"dateTime\",\n              \"display\": true,\n              \"removed\": true,\n              \"readOnly\": false,\n              \"required\": false,\n              \"displayName\": \"starttime\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"endtime\",\n              \"type\": \"dateTime\",\n              \"display\": true,\n              \"removed\": true,\n              \"readOnly\": false,\n              \"required\": false,\n              \"displayName\": \"endtime\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"meetlink\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": true,\n              \"readOnly\": false,\n              \"required\": false,\n              \"displayName\": \"meetlink\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"meetdescription\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": true,\n              \"readOnly\": false,\n              \"required\": false,\n              \"displayName\": \"meetdescription\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Voice Agent\",\n              \"type\": \"array\",\n              \"display\": true,\n              \"removed\": true,\n              \"readOnly\": false,\n              \"required\": false,\n              \"displayName\": \"Voice Agent\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"eventId\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"readOnly\": false,\n              \"required\": false,\n              \"displayName\": \"eventId\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Appointments\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": true,\n              \"readOnly\": true,\n              \"required\": false,\n              \"displayName\": \"Appointments\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            }\n          ],\n          \"mappingMode\": \"defineBelow\",\n          \"matchingColumns\": [\n            \"eventId\"\n          ],\n          \"attemptToConvertTypes\": false,\n          \"convertFieldsToString\": false\n        },\n        \"options\": {},\n        \"operation\": \"update\"\n      },\n      \"credentials\": {},\n      \"typeVersion\": 2.1\n    },\n    {\n      \"id\": \"4d0c155c-68ad-4f70-b9c6-0dbd4db70fd1\",\n      \"name\": \"Call_id & Response\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        2160,\n        3580\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"074d1ef3-e96b-4149-a12c-b8aa71c9c117\",\n              \"name\": \"results[0].toolCallId\",\n              \"type\": \"string\",\n              \"value\": \"={{ $('CancelSlots_tool').item.json.body.message.toolCalls[0].id }}\"\n            },\n            {\n              \"id\": \"098bb88d-9b17-4aeb-850c-819406aa0f3b\",\n              \"name\": \"results[0].result\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.error || $json.fields['Booking Status']  }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"41ff13bf-0793-4082-8be6-51f0617ab0f8\",\n      \"name\": \"Respond to Vapi about cancelation\",\n      \"type\": \"n8n-nodes-base.respondToWebhook\",\n      \"position\": [\n        2400,\n        3580\n      ],\n      \"parameters\": {\n        \"options\": {},\n        \"respondWith\": \"json\",\n        \"responseBody\": \"={\\n    \\\"results\\\":[\\n        {\\n            \\\"toolCallId\\\":\\\"{{ $json.results[0].toolCallId }}\\\",\\n            \\\"result\\\":\\\"{{ $json.results[0].result }}\\\"\\n        }\\n    ]\\n}\"\n      },\n      \"typeVersion\": 1.1\n    },\n    {\n      \"id\": \"599592b1-214c-4e99-84f6-e244e690ed79\",\n      \"name\": \"call_results\",\n      \"type\": \"n8n-nodes-base.webhook\",\n      \"position\": [\n        440,\n        4300\n      ],\n      \"webhookId\": \"4a6205cd-4277-4686-8008-540b802b99fe\",\n      \"parameters\": {\n        \"path\": \"callresults\",\n        \"options\": {},\n        \"httpMethod\": \"POST\"\n      },\n      \"typeVersion\": 2\n    },\n    {\n      \"id\": \"baf3ce79-f302-42ad-bb7e-49f2d9197eae\",\n      \"name\": \"All Input Arguments\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"position\": [\n        720,\n        4300\n      ],\n      \"parameters\": {\n        \"options\": {\n          \"ignoreConversionErrors\": true\n        },\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"fd00208a-e833-4834-8c37-0034c44fb47d\",\n              \"name\": \"transcript\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.message.artifact.transcript }}\"\n            },\n            {\n              \"id\": \"b72ffa4d-aef3-4d7c-8b81-9238a3c5890b\",\n              \"name\": \"recordingUrl\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.message.artifact.recordingUrl }}\"\n            },\n            {\n              \"id\": \"e45d90de-0103-46ba-9fcb-f4c969816da0\",\n              \"name\": \"call.summary\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.message.analysis.summary }}\"\n            },\n            {\n              \"id\": \"b0a5557f-483f-47c9-955a-c12ce84f270b\",\n              \"name\": \"cost\",\n              \"type\": \"number\",\n              \"value\": \"={{ $json.body.message.cost }}\"\n            },\n            {\n              \"id\": \"2bfcfe4f-4eaf-4274-b3f2-cdaea8c2cc46\",\n              \"name\": \"call.id\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.message.call.id }}\"\n            },\n            {\n              \"id\": \"2b7b1638-0d0e-4c48-9989-287fd4e0babd\",\n              \"name\": \"call.orgId\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.message.call.orgId }}\"\n            },\n            {\n              \"id\": \"adf4d062-bbfd-4f97-bda4-bdfec1e40ee4\",\n              \"name\": \"assistant.name\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.message.assistant.name }}\"\n            },\n            {\n              \"id\": \"3c2af504-d320-45f0-9008-79b3bc1ff897\",\n              \"name\": \"startedAt\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.message.startedAt }}\"\n            },\n            {\n              \"id\": \"0486dbfa-ca10-45b5-a79a-3ce1064f13fa\",\n              \"name\": \"endedAt\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.message.endedAt }}\"\n            },\n            {\n              \"id\": \"bf97b5eb-5baa-4a87-b34e-2f64c97c0d42\",\n              \"name\": \"assistant.id\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.message.assistant.id }}\"\n            },\n            {\n              \"id\": \"58ee9b29-7aa1-4a15-bf83-606287a964a6\",\n              \"name\": \"assistant.model\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.message.assistant.model.model }}\"\n            },\n            {\n              \"id\": \"36e2bbef-e12d-4fc4-a0af-bb65aa446023\",\n              \"name\": \"body.message.assistant\",\n              \"type\": \"object\",\n              \"value\": \"={{ $json.body.message.assistant }}\"\n            },\n            {\n              \"id\": \"dfa93dbb-67dc-417b-874a-32fbd55d92b0\",\n              \"name\": \"assistantId\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.message.call.assistantId }}\"\n            },\n            {\n              \"id\": \"4bc2b480-92a1-470e-bdf0-d6609f346ed2\",\n              \"name\": \"body.message.assistant.model.emotionRecognitionEnabled\",\n              \"type\": \"boolean\",\n              \"value\": \"={{ $json.body.message.assistant.model.emotionRecognitionEnabled }}\"\n            },\n            {\n              \"id\": \"acb64bba-e295-4dd0-9ab3-b4166ef5d0ad\",\n              \"name\": \"customer.number\",\n              \"type\": \"string\",\n              \"value\": \"={{ $json.body.message.call.customer.number }}\"\n            }\n          ]\n        }\n      },\n      \"typeVersion\": 3.4\n    },\n    {\n      \"id\": \"f3394750-7438-47e9-8aa3-996accfa9bac\",\n      \"name\": \"Save all information\",\n      \"type\": \"n8n-nodes-base.airtable\",\n      \"position\": [\n        900,\n        4300\n      ],\n      \"parameters\": {\n        \"base\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"appnj853UnMRnJ8D3\",\n          \"cachedResultUrl\": \"https://airtable.com/appnj853UnMRnJ8D3\",\n          \"cachedResultName\": \"Voice Receptionist Agent\"\n        },\n        \"table\": {\n          \"__rl\": true,\n          \"mode\": \"list\",\n          \"value\": \"tbl1b6vMhq9IT9JEZ\",\n          \"cachedResultUrl\": \"https://airtable.com/appnj853UnMRnJ8D3/tbl1b6vMhq9IT9JEZ\",\n          \"cachedResultName\": \"Call Recording\"\n        },\n        \"columns\": {\n          \"value\": {\n            \"Cost\": \"={{ $json.cost }}\",\n            \"endedAt\": \"={{ $json.endedAt }}\",\n            \"startedAt\": \"={{ $json.startedAt }}\",\n            \"transcript\": \"={{ $json.transcript }}\",\n            \"callsummary\": \"={{ $json.call.summary }}\",\n            \"customer_Number\": \"={{ $json.customer.number }}\",\n            \"callrecording_id\": \"={{ $json.call.id }}\",\n            \"Call recording Url\": \"={{ $json.recordingUrl }}\"\n          },\n          \"schema\": [\n            {\n              \"id\": \"id\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": true,\n              \"readOnly\": true,\n              \"required\": false,\n              \"displayName\": \"id\",\n              \"defaultMatch\": true\n            },\n            {\n              \"id\": \"callrecording_id\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"readOnly\": false,\n              \"required\": false,\n              \"displayName\": \"callrecording_id\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Cost\",\n              \"type\": \"number\",\n              \"display\": true,\n              \"removed\": false,\n              \"readOnly\": false,\n              \"required\": false,\n              \"displayName\": \"Cost\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Call recording Url\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"readOnly\": false,\n              \"required\": false,\n              \"displayName\": \"Call recording Url\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"transcript\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"readOnly\": false,\n              \"required\": false,\n              \"displayName\": \"transcript\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"customer_Number\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"readOnly\": false,\n              \"required\": false,\n              \"displayName\": \"customer_Number\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Appointments\",\n              \"type\": \"array\",\n              \"display\": true,\n              \"removed\": true,\n              \"readOnly\": false,\n              \"required\": false,\n              \"displayName\": \"Appointments\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Appointment time (from Appointments)\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": true,\n              \"readOnly\": true,\n              \"required\": false,\n              \"displayName\": \"Appointment time (from Appointments)\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"Voice Agent (from Appointments)\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": true,\n              \"readOnly\": true,\n              \"required\": false,\n              \"displayName\": \"Voice Agent (from Appointments)\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"startedAt\",\n              \"type\": \"dateTime\",\n              \"display\": true,\n              \"removed\": false,\n              \"readOnly\": false,\n              \"required\": false,\n              \"displayName\": \"startedAt\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"endedAt\",\n              \"type\": \"dateTime\",\n              \"display\": true,\n              \"removed\": false,\n              \"readOnly\": false,\n              \"required\": false,\n              \"displayName\": \"endedAt\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"call_Length (in secs)\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": true,\n              \"readOnly\": true,\n              \"required\": false,\n              \"displayName\": \"call_Length (in secs)\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            },\n            {\n              \"id\": \"callsummary\",\n              \"type\": \"string\",\n              \"display\": true,\n              \"removed\": false,\n              \"readOnly\": false,\n              \"required\": false,\n              \"displayName\": \"callsummary\",\n              \"defaultMatch\": false,\n              \"canBeUsedToMatch\": true\n            }\n          ],\n          \"mappingMode\": \"defineBelow\",\n          \"matchingColumns\": [\n            \"callrecording_id\"\n          ],\n          \"attemptToConvertTypes\": false,\n          \"convertFieldsToString\": false\n        },\n        \"options\": {\n          \"typecast\": true\n        },\n        \"operation\": \"upsert\"\n      },\n      \"credentials\": {},\n      \"typeVersion\": 2.1\n    },\n    {\n      \"id\": \"5671dcff-8894-42a8-af77-df01d0b6c190\",\n      \"name\": \"Sticky Note7\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -1800,\n        1980\n      ],\n      \"parameters\": {\n        \"color\": 4,\n        \"width\": 1680,\n        \"height\": 2700,\n        \"content\": \"# Vapi 系统提示\\n\\n### 首条问候语：\\n您好，我是哈里森气候解决方案公司的艾莉，有什么可以帮您的吗？\\n\\n----**结束**----\\n\\n### 系统提示：\\n\\n[身份设定]  \\n您将扮演艾莉——哈里森气候解决方案公司（位于得克萨斯州圣安东尼奥市的暖通空调服务公司）亲切专业的语音接待员。\\n- 当前日期时间：{{\\\"now\\\" | date: \\\"%b %d, %Y, %I:%M %p\\\", \\\"America/Chicago\\\"}}\\n\\n[风格要求]  \\n- 采用友好对话式语气，略带得州特有的热情\\n- 保持温暖可亲且略带幽默感，为来电者营造舒适友好的沟通体验\\n- 使用日常口语化表达，适当加入\\\"嗯...\\\"、\\\"那个...\\\"等自然语气词\\n- 回复简洁生动，模拟真实电话交谈节奏\\n\\n[应答准则]  \\n- 始终保持自然对话感，严禁使用\\\"星号\\\"等技术术语\\n- 信息传达简明扼要，复杂内容分块处理\\n- 牢记这是电话沟通，需为来电者预留应答空间\\n- 礼貌引导偏离主题的询问回归公司服务或预约事宜\\n- 未明确结束时间时默认安排30分钟会面\\n- 询问邮箱时必须说：\\\"能麻烦拼写一下您的邮箱吗？\\\"\\n\\n[重要提醒]  \\n- 通过知识库获取企业详细信息\\n- 当前日期时间：{{\\\"now\\\" | date: \\\"%b %d, %Y, %I:%M %p\\\", \\\"America/Chicago\\\"}}\\n- 禁止复述来电者原话\\n- 周六日及节假日不安排预约（始终使用GetSlots工具查询）\\n- 声明公司营业时间为周一至周五早8点至晚5点\\n- 仅在确认姓名、邮箱、时间三要素准确后推进流程\\n\\n- 当被问及电话号码时，统一应答：\\\"四一五 - 八九二 - 三二四五\\\"\\n\\n**数字读法规范**\\n- 所有数字格式统一转换为：\\\"四一五 - 八九二 - 三二四五\\\"\\n- 特别注意：连字符前后必须保留空格\\n\\n邮箱拼写规则：\\n- 标准格式为name@company.com\\n- 拼读方式示例：P-R-A-T-I-K-at公司全拼.com\\n- \\\"@\\\"统一读作\\\"at\\\"或\\\"艾特\\\"\\n- 名称部分必须逐字母拼读\\n\\n时间日期表述：\\n- 下午1点读作\\\"下午一点\\\"\\n- 下午3:30读作\\\"下午三点三十\\\"\\n- 上午8:45读作\\\"上午八点四十五\\\"\\n- 严禁使用\\\"O'clock\\\"，必须明确\\\"上午/下午\\\"\\n\\n[工具使用规范]  \\n\\n1. **预约工具（BookSlot）**  \\n   - 用途：当收集齐姓名、邮箱、开始时间、备注后确认预约\\n   - 必备参数：\\n     - 真实姓名（禁止使用占位符）\\n     - 完整邮箱（禁止使用占位符）\\n     - 芝加哥时区ISO 8601格式开始时间\\n     - 2-3句预约事由说明\\n\\n2. **查询空档（GetSlots）**  \\n   - 用途：当已知时间范围时查询可预约时段\\n   - 参数要求：\\n     - 搜索窗口起止时间（ISO格式）\\n   - 操作准则：获取完整时间信息后立即调用，无需等待用户确认\\n\\n3. **取消预约（CancelSlots）**  \\n   - 用途：当收集齐姓名、邮箱、原定时间后取消预约\\n   - 必备参数：\\n     - 真实姓名\\n     - 完整邮箱\\n     - 原定开始时间（芝加哥时区ISO格式）\\n     - 2-3句取消原因说明\\n\\n4. **紧急转接（TransferCall）**\\n   - 触发条件：\\n     - 来电者说出密语\\\"热熏胸肉\\\"\\n     - 判定为真实紧急情况\\n   - 操作准则：立即转接至Sam的指定号码，不得自行处理\\n\\n[任务流程]  \\n1. **服务咨询**  \\n   - 根据公司服务项目简明解答\\n   - 适时推荐季节性促销（如冬季暖炉保养/夏季空调安装优惠）\\n   - 价格咨询统一回复\\\"提供免费透明报价，绝无隐藏费用\\\"\\n\\n2. **新建预约**  \\n   - 严禁安排过去时段，可幽默提醒\\\"我们还没发明时光机呢\\\"\\n   - 标准流程：\\n     1. 确认姓名、拼写邮箱、首选时间、预约事由（三要素不全不推进）\\n     2. 获取时间范围后立即调用GetSlots\\n     3. 仅提供系统返回的有效时段\\n     4. 超过3个选项时精选2-3个推荐\\n     5. 无空档时礼貌建议改日咨询\\n   - 最终使用BookSlot确认预约\\n\\n3. **改期预约**  \\n   - 标准流程：\\n     1. 确认姓名、拼写邮箱、原定时间、新时段（三要素不全不推进）\\n     2. 立即调用GetSlots验证\\n     3. 原时段无预约时调用UpdateSlots改期\\n     4. 时段空闲时提示无预约记录\\n\\n4. **取消预约**  \\n   - 标准流程：\\n     1. 确认姓名、拼写邮箱、原定时间（三要素不全不推进）\\n     2. 立即调用GetSlots验证\\n     3. 存在预约时先建议改期，坚持取消则调用CancelSlots\\n     4. 时段空闲时提示无预约记录\\n\\n---**结束**---\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"44596616-27ba-47c0-8a6d-cf50f86a136e\",\n      \"name\": \"Sticky Note15\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        280,\n        900\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 191,\n        \"height\": 80,\n        \"content\": \"**☝️ 在Vapi中设置`Getslot`工具和Webhook**\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"226635e5-05cf-4da6-bbd5-304e458a7112\",\n      \"name\": \"Sticky Note16\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        400,\n        1960\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 191,\n        \"height\": 80,\n        \"content\": \"**☝️ 在Vapi中设置`Bookslot`工具和Webhook**\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"dd2caca4-8669-447f-85ee-b0d829e0e8c4\",\n      \"name\": \"Sticky Note17\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        460,\n        2880\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 191,\n        \"height\": 80,\n        \"content\": \"**☝️ 在Vapi中设置`Updateslot`工具和Webhook**\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"be40ca37-c272-4170-a6b1-cf17a28c37ba\",\n      \"name\": \"Sticky Note18\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        440,\n        3780\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 191,\n        \"height\": 80,\n        \"content\": \"**☝️ 在Vapi中设置`Cancelslot`工具和Webhook**\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"98af9e21-fb6e-41ef-a15e-f0b914e1dc8d\",\n      \"name\": \"Sticky Note19\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        440,\n        4440\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 191,\n        \"height\": 80,\n        \"content\": \"**☝️ 在Vapi中将`call_results`设置为服务器Webhook**\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"ab8f9a65-74b1-42ce-ba65-8f0e0e390839\",\n      \"name\": \"Sticky Note9\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        -1800,\n        340\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 1460,\n        \"height\": 1540,\n        \"content\": \"## 语音接待员预约管理系统（工具集）\\n\\n## 简介\\n### 模板功能：\\n- 该n8n工作流模板通过Vapi驱动的语音AI接待员实现预约管理自动化。系统集成Vapi与谷歌日历实现实时排程，并通过Airtable进行记录与数据管理。AI代理可核查空闲时段、新建预约、调整现有预约或直接在谷歌日历中取消预约。\\n\\n### 解决问题：\\n- 人工管理预约耗时且受限于工作时间。本模板通过自动化语音调度系统（在预设业务规则内支持24/7服务）解决这些问题：将人力从常规调度中解放，减少预订错误，确保预约记录一致性，并通过电话即时预约提升客户体验。系统还会捕获通话录音、摘要及成本等关键数据供分析。\\n\\n## 配置指南\\n\\n### 先决条件：\\n- 运行中的n8n实例\\n- Vapi语音代理账户\\n- 可访问谷歌日历的谷歌账户\\n- Airtable账户\\n- 已在n8n实例中配置谷歌日历和Airtable的API密钥/凭证\\n\\n## 分步配置：\\n### 1. 复制Airtable基表：\\n- 通过此链接复制预设Airtable基表结构至您的账户：https://airtable.com/appxDqRoEgG5sF2gu/shrnZU0D29TPMCjpt\\n- 注：n8n工作流已适配该基表中特定表格和字段（\\\"预约记录\\\"与\\\"通话录音\\\"表）\\n\\n### 2. 导入n8n工作流：\\n- 将提供的n8n工作流JSON文件导入您的实例\\n\\n### 3. 配置n8n凭证：\\n- 定位工作流中的谷歌日历节点（如\\\"检查空闲时段\\\"、\\\"获取所有日历事件\\\"、\\\"创建事件\\\"等），确保其使用您在n8n中配置的谷歌日历凭证，并选择正确的管理日历\\n- 定位Airtable节点（如\\\"记录确认的预订详情\\\"、\\\"查找原始预约\\\"等），确保配置正确的Airtable凭证并指向步骤1创建的基表\\n\\n### 4. 激活n8n工作流：\\n- 保存并激活工作流，生成Vapi所需的实时Webhook网址\\n\\n### 5. 配置Vapi助手：\\n- **系统提示词：** 复制n8n工作流中大型便签提供的系统提示词，按需修改（如企业名称、营业时间）后粘贴至Vapi助手的系统提示配置区\\n\\n- **工具配置：** 在Vapi助手中设置以下4个工具：\\n  - 空闲时段查询工具：\\n    - 用途：检查日历空闲时段\\n    - Webhook网址：从n8n工作流\\\"Getslot_tool\\\" Webhook节点复制生产环境URL（路径：/getslots）\\n  - 时段预订工具：\\n    - 用途：创建新日历事件\\n    - Webhook网址：复制\\\"bookslots_tool\\\" Webhook节点的生产环境URL（路径：/bookslots）\\n  - 时段更新工具：\\n    - 用途：修改现有日历事件\\n    - Webhook网址：复制\\\"Updateslots_tool\\\" Webhook节点的生产环境URL（路径：/updateslots）\\n  - 时段取消工具：\\n    - 用途：删除日历事件\\n    - Webhook网址：复制\\\"CancelSlots_tool\\\" Webhook节点的生产环境URL（路径：/cancelslots）\\n\\n- **服务器Webhook（通话结束报告）：**\\n  - 在Vapi服务器配置区（通常位于webhook或报告设置下），找到通话结束报告事件配置项\\n  - 从n8n工作流\\\"call_results\\\" Webhook节点复制生产环境URL（路径：/callresults）\\n  - 将该URL粘贴至Vapi的通话结束服务器webhook配置项，使n8n能接收并记录通话摘要、录音等信息\\n\\n## 视频演示（即将上线）\\n### [🎥 观看配置视频（约2分钟）](https://www.loom.com/share/d379895004374ddc85dc9171ca37c139?sid=0996f0d2-aff2-45a7-aae9-c62df4fb0799)\"\n      },\n      \"typeVersion\": 1\n    },\n    {\n      \"id\": \"8d984e05-5bca-4c70-beee-16f7cd70594e\",\n      \"name\": \"Sticky Note12\",\n      \"type\": \"n8n-nodes-base.stickyNote\",\n      \"position\": [\n        40,\n        300\n      ],\n      \"parameters\": {\n        \"color\": 7,\n        \"width\": 3700,\n        \"height\": 4400,\n        \"content\": \"# 工作流程\"\n      },\n      \"typeVersion\": 1\n    }\n  ],\n  \"pinData\": {},\n  \"connections\": {\n    \"Sort\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Format response\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Enrich Date\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Build Response Payload\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Escape Json\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Convert time to CST America / Chicago\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Create Event\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Booking Payload\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Add Friendly Error\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Delete Event\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Update Airtable record\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Call_id & Response\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Getslot_tool\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Input Arguments\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Update Event\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Updates Airtable record\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Response & call_id\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"call_results\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"All Input Arguments\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Flatten Slots\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Enrich Date\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Error Response\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Respond to Vapi\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"bookslots_tool\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Input Arguments from booking tools\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Booking Payload\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Success Response\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Format response\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Available Start Times & Ranges\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Input Arguments\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Check Availability\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Respond to Vapi\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"If the booking is confirmed then true\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"CancelSlots_tool\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Input Arguments from cancelslot tool\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Success Response\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Respond to Vapi\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Updateslots_tool\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Input Arguments from updateslot tool\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Add Friendly Error\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Error Response\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Call_id & Response\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Respond to Vapi about cancelation\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Check Availability\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Check if time is available or not\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Response & call_id\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Respond to Vapi about Updating slots\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"All Input Arguments\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Save all information\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Has all information\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Escape Json\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Build Error Response Payload\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Build Error Response\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Respond with Error to Vapi\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Build Response Payload\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Convert into Json format for Vapi\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Update Airtable record\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Call_id & Response\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get All Calendar Events\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Extract start, end and name\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Updates Airtable record\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Response & call_id\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Finds original appointment\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Update Event\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Extract start, end and name\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Sort\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Build Error Response Payload\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Respond with Error\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Finds the appointment record\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Delete Event\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Build Error Response Payload2\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Response with Error\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Available Start Times & Ranges\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Flatten Slots\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Time available (true) & Call_id\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Response\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Check if time is available or not\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Time available (true) & Call_id\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Get All Calendar Events\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Convert into Json format for Vapi\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Response to Vapi\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Input Arguments from booking tools\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Has all information\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Information to be Saved in Airtable\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Logs the confirmed booking details\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Checks if required info is provided.\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Finds original appointment\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Build Error Response Payload2\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Input Arguments from cancelslot tool\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Checks if required info is provided for cancelation\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Input Arguments from updateslot tool\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Checks if required info is provided.\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Convert time to CST America / Chicago\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Create Event\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"If the booking is confirmed then true\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Information to be Saved in Airtable\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Checks if required info is provided for cancelation\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Finds the appointment record\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ],\n        [\n          {\n            \"node\": \"Build Error Response\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  }\n}"
}