{
  "url": "https://blog.n8n.io/how-to-extract-data-from-pdf-to-excel-spreadsheet-advance-parsing-with-n8n-io-and-llamaparse/",
  "title": "How to extract data from PDF to Excel/Spreadsheet: Advance parsing with n8n.io and LlamaParse",
  "excerpt": "In this article, we’ll learn how to integrate LlamaParse into n8n for automated invoice parsing and data extraction.",
  "thumbnail": "https://blog.n8n.io/content/images/size/w1200/2024/06/17b3a2c7-9a52-402a-9bfb-e9cef6818c1d--1-.png",
  "tags": [
    "AI"
  ],
  "html": "<p>In this article, we’ll learn how to integrate LlamaParse into n8n for automated invoice parsing and data extraction.</p><p>If you’ve ever tried to automate document parsing for invoices, remittance notes, order forms or similar, you quickly realize that extracting table data from PDFs isn’t easy due to limitations with available parsing solutions. Third party professional OCR software technologies are expensive and slow whilst naive PDF-to-text converters lose all tabular structure making it near impossible to workaround for larger documents.</p><p>Enter LlamaParse, a new sophisticated document parsing service from LlamaIndex.ai. Parsing and understanding PDFs has become an increasingly popular problem space for Large Language Models (LLMs) and so LLamaParse was built for this very purpose. LlamaParse works by converting PDF tables to Markdown tables which are easier for LLMs to understand and thus allow LLMs to identify and extract table data more accurately.</p><h3 id=\"parsing-and-extracting-from-email-invoices\">Parsing and Extracting from Email Invoices</h3><p>In this article, we’ll use the scenario where we receive PDF invoices by email which need to be reconciled by entering the details into a spreadsheet. We’ll use n8n to automate the entire process; from downloading the PDF attachment from the email, handing it off to LLamaParse for processing, using AI to extract the invoice data and finally writing it to our spreadsheet.</p><!--kg-card-begin: html--><script>\n  workflowBanner(2320, document.currentScript)\n</script><div class=\"workflow\">\n      <div class=\"workflow-content\">\n        <div class=\"workflow-nodes\">\n          <img src=\"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTM2Ljg2NzEgMTYuMzcxOEMzNy43NzQ2IDEzLjY0OCAzNy40NjIxIDEwLjY2NDIgMzYuMDEwOCA4LjE4NjYxQzMzLjgyODIgNC4zODY1MyAyOS40NDA3IDIuNDMxNDkgMjUuMTU1NiAzLjM1MTUxQzIzLjI0OTMgMS4yMDM5NiAyMC41MTA1IC0wLjAxNzMxNDggMTcuNjM5MiAwLjAwMDE4NTUzM0MxMy4yNTkxIC0wLjAwOTgxNDY4IDkuMzcyNzMgMi44MTAyNSA4LjAyNTIgNi45Nzc4M0M1LjIxMTM5IDcuNTU0MSAyLjc4MjU4IDkuMzE1MzggMS4zNjEzIDExLjgxMTdDLTAuODM3NDkzIDE1LjYwMTggLTAuMzM2MjMyIDIwLjM3OTQgMi42MDEzMyAyMy42Mjk0QzEuNjkzODEgMjYuMzUzMiAyLjAwNjMyIDI5LjMzNzEgMy40NTc2IDMxLjgxNDZDNS42NDAxNSAzNS42MTQ3IDEwLjAyNzcgMzcuNTY5NyAxNC4zMTI4IDM2LjY0OTdDMTYuMjE3OSAzOC43OTczIDE4Ljk1NzkgNDAuMDE4NSAyMS44MjkyIDM5Ljk5OThDMjYuMjExOCA0MC4wMTEgMzAuMDk5NCAzNy4xODg1IDMxLjQ0NjkgMzMuMDE3MUMzNC4yNjA4IDMyLjQ0MDkgMzYuNjg5NiAzMC42Nzk2IDM4LjExMDggMjguMTgzM0M0MC4zMDcxIDI0LjM5MzIgMzkuODA0NiAxOS42MTk0IDM2Ljg2ODMgMTYuMzY5M0wzNi44NjcxIDE2LjM3MThaTTIxLjgzMTcgMzcuMzg2QzIwLjA3OCAzNy4zODg1IDE4LjM3OTIgMzYuNzc0NyAxNy4wMzI5IDM1LjY1MDlDMTcuMDk0MSAzNS42MTg0IDE3LjIwMDQgMzUuNTU5NyAxNy4yNjkxIDM1LjUxNzJMMjUuMjM0MyAzMC45MTcxQzI1LjY0MTggMzAuNjg1OCAyNS44OTE4IDMwLjI1MjEgMjUuODg5MyAyOS43ODMzVjE4LjU1NDNMMjkuMjU1NyAyMC40OTgxQzI5LjI5MTkgMjAuNTE1NiAyOS4zMTU3IDIwLjU1MDYgMjkuMzIwNyAyMC41OTA2VjI5Ljg4OTZDMjkuMzE1NyAzNC4wMjQ3IDI1Ljk2NjggMzcuMzc3MiAyMS44MzE3IDM3LjM4NlpNNS43MjY0IDMwLjUwNzFDNC44NDc2MyAyOC45ODk2IDQuNTMxMzcgMjcuMjEwOCA0LjgzMjYzIDI1LjQ4NDVDNC44OTEzOCAyNS41MTk1IDQuOTk1MTMgMjUuNTgzMiA1LjA2ODg4IDI1LjYyNTdMMTMuMDM0MSAzMC4yMjU4QzEzLjQzNzggMzAuNDYyMSAxMy45Mzc4IDMwLjQ2MjEgMTQuMzQyOCAzMC4yMjU4TDI0LjA2NjggMjQuNjEwN1YyOC40OTgzQzI0LjA2OTMgMjguNTM4MyAyNC4wNTA1IDI4LjU3NyAyNC4wMTkzIDI4LjYwMkwxNS45Njc5IDMzLjI1MDlDMTIuMzgxNSAzNS4zMTU5IDcuODAxNDQgMzQuMDg4NCA1LjcyNzY1IDMwLjUwNzFINS43MjY0Wk0zLjYzMDEgMTMuMTIwNUM0LjUwNTEyIDExLjYwMDQgNS44ODY0IDEwLjQzNzkgNy41MzE0NCA5LjgzNDE1QzcuNTMxNDQgOS45MDI5IDcuNTI3NjkgMTAuMDI0MiA3LjUyNzY5IDEwLjEwOTJWMTkuMzEwNkM3LjUyNTE5IDE5Ljc3ODEgNy43NzUxOSAyMC4yMTE5IDguMTgxNDUgMjAuNDQzMUwxNy45MDU0IDI2LjA1N0wxNC41MzkxIDI4LjAwMDhDMTQuNTA1MyAyOC4wMjMzIDE0LjQ2MjggMjguMDI3IDE0LjQyNTMgMjguMDEwOEw2LjM3MjY2IDIzLjM1ODJDMi43OTM4MyAyMS4yODU2IDEuNTY2MzEgMTYuNzA2OCAzLjYyODg1IDEzLjEyMTdMMy42MzAxIDEzLjEyMDVaTTMxLjI4ODIgMTkuNTU2OUwyMS41NjQyIDEzLjk0MTdMMjQuOTMwNiAxMS45OTkyQzI0Ljk2NDMgMTEuOTc2NyAyNS4wMDY4IDExLjk3MjkgMjUuMDQ0MyAxMS45ODkyTDMzLjA5NyAxNi42MzhDMzYuNjgyMSAxOC43MDkzIDM3LjkxMDggMjMuMjk1NyAzNS44Mzk1IDI2Ljg4MDhDMzQuOTYzMyAyOC4zOTgzIDMzLjU4MzIgMjkuNTYwOCAzMS45Mzk1IDMwLjE2NThWMjAuNjg5NEMzMS45NDMyIDIwLjIyMTkgMzEuNjk0NSAxOS43ODk0IDMxLjI4OTQgMTkuNTU2OUgzMS4yODgyWk0zNC42MzgzIDE0LjUxNDJDMzQuNTc5NSAxNC40NzggMzQuNDc1OCAxNC40MTU1IDM0LjQwMiAxNC4zNzNMMjYuNDM2OCA5Ljc3Mjg5QzI2LjAzMzEgOS41MzY2NCAyNS41MzMxIDkuNTM2NjQgMjUuMTI4MSA5Ljc3Mjg5TDE1LjQwNDEgMTUuMzg4VjExLjUwMDRDMTUuNDAxNiAxMS40NjA0IDE1LjQyMDQgMTEuNDIxNyAxNS40NTE2IDExLjM5NjdMMjMuNTAzIDYuNzUxNThDMjcuMDg5NCA0LjY4Mjc5IDMxLjY3NDUgNS45MTQwNiAzMy43NDIgOS41MDE2NEMzNC42MTU4IDExLjAxNjcgMzQuOTMyIDEyLjc5MDUgMzQuNjM1OCAxNC41MTQySDM0LjYzODNaTTEzLjU3NDEgMjEuNDQzMUwxMC4yMDY1IDE5LjQ5OTRDMTAuMTcwMiAxOS40ODE5IDEwLjE0NjUgMTkuNDQ2OCAxMC4xNDE1IDE5LjQwNjhWMTAuMTA3OUMxMC4xNDQgNS45Njc4MSAxMy41MDI4IDIuNjEyNzQgMTcuNjQyOSAyLjYxNTI0QzE5LjM5NDIgMi42MTUyNCAyMS4wODkyIDMuMjMwMjUgMjIuNDM1NSA0LjM1MDI4QzIyLjM3NDMgNC4zODI3OCAyMi4yNjkzIDQuNDQxNTMgMjIuMTk5MiA0LjQ4NDAzTDE0LjIzNDEgOS4wODQxM0MxMy44MjY2IDkuMzE1MzggMTMuNTc2NiA5Ljc0Nzg5IDEzLjU3OTEgMTAuMjE2N0wxMy41NzQxIDIxLjQ0MDZWMjEuNDQzMVpNMTUuNDAyOSAxNy41MDA2TDE5LjczNDIgMTQuOTk5M0wyNC4wNjU1IDE3LjQ5OTNWMjIuNTAwN0wxOS43MzQyIDI1LjAwMDdMMTUuNDAyOSAyMi41MDA3VjE3LjUwMDZaIiBmaWxsPSIjN0Q3RDg3Ii8+Cjwvc3ZnPgo=\" alt=\"OpenAI Model\" title=\"OpenAI Model\">\n          <i class=\"fa fa-code\" aria-hidden=\"true\"></i>\n        <img src=\"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik00MCAyMEM0MCA4Ljk1MzE0IDMxLjA0NjkgMCAyMCAwQzguOTUzMTQgMCAwIDguOTUzMTQgMCAyMEMwIDMxLjA0NjkgOC45NTMxNCA0MCAyMCA0MEMzMS4wNDY5IDQwIDQwIDMxLjA0NjkgNDAgMjBaTTIwIDM2Ljk0NThDMTguODg1MiAzNi45NDU4IDE3LjEzNzggMzUuOTY3IDE1LjQ5OTggMzIuNjk4NUMxNC43OTY0IDMxLjI5MTggMTQuMTk2MSAyOS41NDMxIDEzLjc1MjYgMjcuNjg0N0gyNi4xODk4QzI1LjgwNDUgMjkuNTQwMyAyNS4yMDQ0IDMxLjI5MDEgMjQuNTAwMiAzMi42OTg1QzIyLjg2MjIgMzUuOTY3IDIxLjExNDggMzYuOTQ1OCAyMCAzNi45NDU4Wk0xMi45MDY0IDIwQzEyLjkwNjQgMjEuNjA5NyAxMy4wMDg3IDIzLjE2NCAxMy4yMDAzIDI0LjYzMDVIMjYuNzk5N0MyNi45OTEzIDIzLjE2NCAyNy4wOTM2IDIxLjYwOTcgMjcuMDkzNiAyMEMyNy4wOTM2IDE4LjM5MDMgMjYuOTkxMyAxNi44MzYgMjYuNzk5NyAxNS4zNjk1SDEzLjIwMDNDMTMuMDA4NyAxNi44MzYgMTIuOTA2NCAxOC4zOTAzIDEyLjkwNjQgMjBaTTIwIDMuMDU0MTlDMjEuMTE0OSAzLjA1NDE5IDIyLjg2MjIgNC4wMzA3OCAyNC41MDAxIDcuMzAwMzlDMjUuMjA2NiA4LjcxNDA4IDI1LjgwNzIgMTAuNDA2NyAyNi4xOTIgMTIuMzE1M0gxMy43NTAxQzE0LjE5MzMgMTAuNDA0NyAxNC43OTQyIDguNzEyNTQgMTUuNDk5OCA3LjMwMDY0QzE3LjEzNzcgNC4wMzA4MyAxOC44ODUxIDMuMDU0MTkgMjAgMy4wNTQxOVpNMzAuMTQ3OCAyMEMzMC4xNDc4IDE4LjQwOTkgMzAuMDU0MyAxNi44NjE3IDI5LjgyMjcgMTUuMzY5NUgzNi4zMDQyQzM2LjcyNTIgMTYuODQyIDM2Ljk0NTggMTguMzk2NCAzNi45NDU4IDIwQzM2Ljk0NTggMjEuNjAzNiAzNi43MjUyIDIzLjE1OCAzNi4zMDQyIDI0LjYzMDVIMjkuODIyN0MzMC4wNTQzIDIzLjEzODMgMzAuMTQ3OCAyMS41OTAxIDMwLjE0NzggMjBaTTI2LjI3NjcgNC4yNTUxMkMyNy42MzY1IDYuMzYwMTkgMjguNzExIDkuMTMyIDI5LjM3NzQgMTIuMzE1M0gzNS4xMDQ2QzMzLjI1MTEgOC42NjggMzAuMTA3IDUuNzgzNDYgMjYuMjc2NyA0LjI1NTEyWk0xMC42MjI2IDEyLjMxNTNINC44OTI5M0M2Ljc1MTQ3IDguNjY3ODQgOS44OTM1MSA1Ljc4MzQxIDEzLjcyMzIgNC4yNTUxM0MxMi4zNjM1IDYuMzYwMjEgMTEuMjg5IDkuMTMyMDEgMTAuNjIyNiAxMi4zMTUzWk0zLjA1NDE5IDIwQzMuMDU0MTkgMjEuNjAzIDMuMjc3NDMgMjMuMTU3NSAzLjY5NDg0IDI0LjYzMDVIMTAuMTIxN0M5Ljk0NjE5IDIzLjE0MiA5Ljg1MjIyIDIxLjU5NDMgOS44NTIyMiAyMEM5Ljg1MjIyIDE4LjQwNTcgOS45NDYxOSAxNi44NTggMTAuMTIxNyAxNS4zNjk1SDMuNjk0ODRDMy4yNzc0MyAxNi44NDI1IDMuMDU0MTkgMTguMzk3IDMuMDU0MTkgMjBaTTI2LjI3NjYgMzUuNzQyN0MyNy42MzY1IDMzLjYzOTMgMjguNzExIDMwLjg2OCAyOS4zNzc0IDI3LjY4NDdIMzUuMTA0NkMzMy4yNTEgMzEuMzMyMiAzMC4xMDY4IDM0LjIxNzkgMjYuMjc2NiAzNS43NDI3Wk0xMy43MjM0IDM1Ljc0MjdDOS44OTM2OSAzNC4yMTc5IDYuNzUxNTUgMzEuMzMyNCA0Ljg5MjkzIDI3LjY4NDdIMTAuNjIyNkMxMS4yODkgMzAuODY4IDEyLjM2MzUgMzMuNjM5MyAxMy43MjM0IDM1Ljc0MjdaIiBmaWxsPSIjM0E0MkU5Ii8+Cjwvc3ZnPgo=\" alt=\"HTTP Request\" title=\"HTTP Request\">\n          <i class=\"fa fa-sticky-note\" aria-hidden=\"true\" style=\"color:#FFD233\"></i>\n        <img src=\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNTYiIGhlaWdodD0iMTkzIiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJ4TWlkWU1pZCI+PHBhdGggZmlsbD0iIzQyODVGNCIgZD0iTTU4LjE4MiAxOTIuMDVWOTMuMTRMMjcuNTA3IDY1LjA3NyAwIDQ5LjUwNHYxMjUuMDkxYzAgOS42NTggNy44MjUgMTcuNDU1IDE3LjQ1NSAxNy40NTV6Ii8+PHBhdGggZmlsbD0iIzM0QTg1MyIgZD0iTTE5Ny44MTggMTkyLjA1aDQwLjcyN2M5LjY1OSAwIDE3LjQ1NS03LjgyNiAxNy40NTUtMTcuNDU1VjQ5LjUwNWwtMzEuMTU2IDE3LjgzNy0yNy4wMjYgMjUuNzk4eiIvPjxwYXRoIGZpbGw9IiNFQTQzMzUiIGQ9Im01OC4xODIgOTMuMTQtNC4xNzQtMzguNjQ3IDQuMTc0LTM2Ljk4OUwxMjggNjkuODY4bDY5LjgxOC01Mi4zNjQgNC42NyAzNC45OTItNC42NyA0MC42NDRMMTI4IDE0NS41MDR6Ii8+PHBhdGggZmlsbD0iI0ZCQkMwNCIgZD0iTTE5Ny44MTggMTcuNTA0VjkzLjE0TDI1NiA0OS41MDRWMjYuMjMxYzAtMjEuNTg1LTI0LjY0LTMzLjg5LTQxLjg5LTIwLjk0NXoiLz48cGF0aCBmaWxsPSIjQzUyMjFGIiBkPSJtMCA0OS41MDQgMjYuNzU5IDIwLjA3TDU4LjE4MiA5My4xNFYxNy41MDRMNDEuODkgNS4yODZDMjQuNjEtNy42NiAwIDQuNjQ2IDAgMjYuMjN6Ii8+PC9zdmc+\" alt=\"Gmail Trigger\" title=\"Gmail Trigger\">\n          <span>+5</span>\n        </div>\n        <div class=\"workflow-details\">\n          <p class=\"workflow-details-name\">\n            <a href=\"https://n8n.io/workflows/2320-invoice-data-extraction-with-llamaparse-and-openai/\" class=\"blog-banner-workflow\">Invoice data extraction with LlamaParse and OpenAI</a>\n          </p>\n          <p class=\"workflow-details-stats\">by jimleuk</p>\n        </div>\n      </div>\n      <a href=\"https://n8n.io/workflows/2320-invoice-data-extraction-with-llamaparse-and-openai/\" class=\"global-button blog-banner-workflow\">\n        Use this workflow\n      </a>\n    </div><!--kg-card-end: html--><h3 id=\"prerequisites\">Prerequisites</h3><ul><li><strong>A cloud-hosted or self-hosted version of n8n</strong>.<br>Easiest way is to sign up for an n8n account at https://n8n.io. The workflow template in this article can be imported without having to rebuild the steps.</li><li><strong>A LlamaIndex cloud account and API key.</strong><br>You can get one by signing up for a free account at &nbsp;<a href=\"https://cloud.llamaindex.ai/?ref=blog.n8n.io\" target=\"_blank\" rel=\"noopener\">https://cloud.llamaIndex.ai</a></li><li><strong>OpenAI account and API key</strong>.<br>You can find instructions here https://openai.com/blog/openai-api</li></ul><h3 id=\"step-1-setting-up-our-llamaparse-credentials-in-n8n\">Step 1: Setting up our LlamaParse Credentials in n8n</h3><p>To use LlamaParse, we first need a LlamaParse API key which we can get for free by signing up to <a href=\"https://cloud.llamaindex.ai/?ref=blog.n8n.io\" target=\"_blank\" rel=\"noopener\">https://cloud.llamaIndex.ai</a>. At time of writing, LlamaIndex is offering a free tier which allows for 1000 uploads a day.</p><figure class=\"kg-card kg-image-card\"><img src=\"https://lh7-us.googleusercontent.com/docsz/AD_4nXcXF1pfVHyZpy6yopXZNLxDuz7GR-SOmQpSPdfQq6LeYB8rOuxOr5UtQN5prcQO1ubLvgs1V5OSOvAqQYGRtV1ismbCZ7cwNl24pWpIXbqp_m3i23Mjv7LvVweEI9CdBZKEixSQfM9Sy1xaYhmopla7pXZ_?key=LTiwkbhFEiOqSdlXhq93RA\" class=\"kg-image lightense-target\" alt=\"\" loading=\"lazy\"></figure><p>Once you have the LlamaParse API key, create a <strong>Header Auth Credential </strong>that we will use when making calls to the LlamaParse API in our n8n workflow.</p><ul><li>Go to the <strong>Credentials </strong>tab</li><li>Click the <strong>Add Credential</strong> button</li><li>Search for <strong>Header Auth</strong></li><li>Enter \"Bearer &lt;API Key&gt;\" into the <strong>Value</strong> input box and click <strong>Save.</strong></li></ul><figure class=\"kg-card kg-image-card\"><img src=\"https://blog.n8n.io/content/images/2024/09/Screenshot-2024-09-19-at-13.17.29.png\" class=\"kg-image lightense-target\" alt=\"\" loading=\"lazy\" width=\"1189\" height=\"444\" srcset=\"https://blog.n8n.io/content/images/size/w600/2024/09/Screenshot-2024-09-19-at-13.17.29.png 600w, https://blog.n8n.io/content/images/size/w1000/2024/09/Screenshot-2024-09-19-at-13.17.29.png 1000w, https://blog.n8n.io/content/images/2024/09/Screenshot-2024-09-19-at-13.17.29.png 1189w\" sizes=\"(min-width: 720px) 720px\"></figure><h3 id=\"step-2-create-the-llamaparse-api-workflow\">Step 2: Create the LlamaParse API workflow</h3><p>Since n8n does not have a built-in node for LlamaParse, we’ll have to work directly with the LlamaIndex API. Don’t worry, this is quite manageable as there are only 3 APIs calls we need to make.</p><ol><li>API call to upload a PDF to the LlamaParse service.<br><a href=\"https://docs.cloud.llamaindex.ai/API/upload-file-api-v-1-parsing-upload-post?ref=blog.n8n.io\" rel=\"noopener\" target=\"_blank\">https://docs.cloud.llamaindex.ai/API/upload-file-api-v-1-parsing-upload-post</a></li><li>API call to query the status of the PDF processing job. This may take longer if the PDF is large.<br><a href=\"https://docs.cloud.llamaindex.ai/API/get-job-api-v-1-parsing-job-job-id-get?ref=blog.n8n.io\" rel=\"noopener\" target=\"_blank\">https://docs.cloud.llamaindex.ai/API/get-job-api-v-1-parsing-job-job-id-get</a></li><li>API call to fetch the parsed output of the PDF once the job is completed.<br><a href=\"https://docs.cloud.llamaindex.ai/API/get-job-raw-md-result-api-v-1-parsing-job-job-id-result-raw-markdown-get?ref=blog.n8n.io\" rel=\"noopener\" target=\"_blank\">https://docs.cloud.llamaindex.ai/API/get-job-raw-md-result-api-v-1-parsing-job-job-id-result-raw-markdown-get</a></li></ol><p>Here, I’ve implemented this flow using the HTTP request node, a SWITCH node to determine if the job is completed otherwise to query again and a WAIT node to throttle calls to stay within API service rate limits.</p><figure class=\"kg-card kg-image-card\"><img src=\"https://lh7-us.googleusercontent.com/docsz/AD_4nXdwuV6L4MF8xsel5bOq1h6qhwKgts6r5GLY5rPfiL8ruGJPRxkPizX6IpQNYeKs_OwBeNt4OvoAwe1XfRrnrk6qK0QdUS0d_FVhn0-sbCQC1KITJbIOyRPeZxL_71vD3EtIxX2jCDuHIdse4aRkgJFwan0?key=LTiwkbhFEiOqSdlXhq93RA\" class=\"kg-image lightense-target\" alt=\"\" loading=\"lazy\"></figure><h3 id=\"step-3-data-extraction-using-openai-gpt-4o\">Step 3. Data Extraction using OpenAI GPT-4o<br></h3><p>To extract the data from our parsed PDF output, we’ll use the <strong>LLM Basic Chain</strong> to feed it to the <strong>OpenAI GPT-4o Model</strong> and ask the model to pull out the relevant invoice data attributes we care about. Here’s the list of attributes we want for our scenario:</p><ul><li>Invoice date</li><li>Invoice number and Purchase order number</li><li>Supplier name and address, VAT identification number</li><li>Customer name and address</li><li>Any shipping addresses</li><li>Line items, including a description of the goods or services rendered</li><li>Price with and without VAT and the total price</li></ul><p>The output should be JSON formatted so that we may easily insert this data as a row in our reconciliation spreadsheet. To achieve this, it is important that we use the <strong>Structured Output Parser</strong> and give it a JSON schema for the desired attributes.</p><figure class=\"kg-card kg-image-card\"><img src=\"https://lh7-us.googleusercontent.com/docsz/AD_4nXfECdOftYaC30ZK32YVcyct2xS3A_sbV0UsPhjv_NmIL_tWqMcA19Uz1JVRbXinks6AVvB85VXziPLTwTvlLVDpqQtIqOgIYKY1k3OduCc1EQITcBcpcYCv-tpQllusNmRfKMd8vmouwNuMj_-ncpGacFaU?key=LTiwkbhFEiOqSdlXhq93RA\" class=\"kg-image lightense-target\" alt=\"\" loading=\"lazy\"></figure><figure class=\"kg-card kg-image-card\"><img src=\"https://lh7-us.googleusercontent.com/docsz/AD_4nXeYnr6EjJkwd42IpAp5KylrRF0FjEOjfCqCRuZIXkZwdrMtzgqxIH0ZzY3bAdIT3IAv_qZMC3hwTuOWaXf9yd-jWOFEb3H1D_AkijZMfytbxz0Qv-4-Qe5LQDgoTJS-b6CujIw1HOTh1nbETG532qr6qp15?key=LTiwkbhFEiOqSdlXhq93RA\" class=\"kg-image lightense-target\" alt=\"\" loading=\"lazy\"></figure><figure class=\"kg-card kg-image-card kg-width-wide\"><img src=\"https://lh7-us.googleusercontent.com/docsz/AD_4nXd2P-7RnePYNnmHTELiEbGirmwcSVqCGD7vAFdhvn6BxJ46JHdrieXIh5VWJrIJ9pSOtLdL7clXaiztN9SeIGn6l6xFOcKyLWRiKi4-whx1KVEe5fm7m8pCFnQglrVj7sFNkIW1OT-y4r8leKA9cXDIT4Eh?key=LTiwkbhFEiOqSdlXhq93RA\" class=\"kg-image lightense-target\" alt=\"\" loading=\"lazy\"></figure><h3 id=\"step-4-add-email-trigger-to-start-capture-invoices\">Step 4. Add Email Trigger to Start Capture Invoices!</h3><p>Now that the hard work has been done, we can set up a simple email trigger to watch for invoices as they come through. Depending on how you receive the invoices, you may need to filter based on subject line, labels or checking for attachments.</p><ul><li>Create an Email Trigger Node for your workflow</li><li>Set an interval of how often the workflow should watch the inbox for new invoices.</li><li>Under filters, apply any criteria which will help get actual email invoices sent to the workflow.</li><li>Under options, be sure to check the option to download attachments. We’ll need this to get the actual pdf from the invoice. If you have multiple invoices, you may need to process them individually.</li></ul><figure class=\"kg-card kg-image-card\"><img src=\"https://lh7-us.googleusercontent.com/docsz/AD_4nXcmOK-XNXVNrTmT6CbEubRnOmcMGwBnNHpH-yGH7_rIvaNTEgBk6-aArhiAqQvtByID2o8eOFYJ6lp03mdu7-M4Mi8Brm9UG-I841aveaKiuUhq6KffhjrJAcq8iq2aS3ucvs5X4uzVx7ABYqFiUPxlhf8_?key=LTiwkbhFEiOqSdlXhq93RA\" class=\"kg-image lightense-target\" alt=\"\" loading=\"lazy\"></figure><figure class=\"kg-card kg-image-card\"><img src=\"https://lh7-us.googleusercontent.com/docsz/AD_4nXcm9Ry7pO__X0op_o4H-8in09JtZkWoJzd_zK3bH0v-H8GPwdc1KQ7BXfuqwaRxwTukgpl9TMuncku5DWAkR8qszeRbr230mlkaH1L2ArIRgNqbMUKykR-vGpbCo3TMPVYFDMWdRC5aGFWy6748P7H8xSm5?key=LTiwkbhFEiOqSdlXhq93RA\" class=\"kg-image lightense-target\" alt=\"\" loading=\"lazy\"></figure><h3 id=\"step-5-done\">Step 5. Done!</h3><p>In this article, we’ve successfully implemented a powerful AI-based PDF parsing and data extraction not only for invoices but for any PDF document with tabular data in n8n.</p><p>Utilizing powerful parsers like LlamaParse and models like GPT-4o for this use-case can provide significant productivity benefits at a fraction of the cost to traditional solutions such as OCR, whilst using n8n provides a simple no-code automation solution to reduce development and maintenance costs.</p>\n\t\t<div class=\"newsletter-banner\">\n\t    <div class=\"newsletter-banner-content\">\n\t      <div class=\"section-header\">\n\t        <h2>Subscribe to <span>n8n newsletter</span></h2>\n\t        <div class=\"section-subheader--bottom\">\n\t          Get the best, coolest, and latest in automation and low-code delivered to your inbox each week.\n\t        </div>\n\t      </div>\n\t      <div class=\"newsletter-banner-form\">\n\t        <form autocomplete=\"off\" class=\"contact-form\" onsubmit=\"subscribeNewsletter(event)\">\n\t        \t<div id=\"recaptcha\" class=\"g-recaptcha\" data-sitekey=\"6LeAQeopAAAAAKlLsRb1weWm6T_vijoQBkGkbHzB\" data-callback=\"submitSubscription\" data-size=\"invisible\"><div class=\"grecaptcha-badge\" data-style=\"bottomright\" style=\"width: 256px; height: 60px; display: block; transition: right 0.3s ease 0s; position: fixed; bottom: 14px; right: -186px; box-shadow: gray 0px 0px 5px; border-radius: 2px; overflow: hidden;\"><div class=\"grecaptcha-logo\"><iframe title=\"reCAPTCHA\" width=\"256\" height=\"60\" role=\"presentation\" name=\"a-ep64atq5qphw\" frameborder=\"0\" scrolling=\"no\" sandbox=\"allow-forms allow-popups allow-same-origin allow-scripts allow-top-navigation allow-modals allow-popups-to-escape-sandbox allow-storage-access-by-user-activation\" src=\"https://www.google.com/recaptcha/api2/anchor?ar=1&amp;k=6LeAQeopAAAAAKlLsRb1weWm6T_vijoQBkGkbHzB&amp;co=aHR0cHM6Ly9ibG9nLm44bi5pbzo0NDM.&amp;hl=en&amp;v=jt8Oh2-Ue1u7nEbJQUIdocyd&amp;size=invisible&amp;cb=y6e60ff6cyvd\"></iframe></div><div class=\"grecaptcha-error\"></div><textarea id=\"g-recaptcha-response\" name=\"g-recaptcha-response\" class=\"g-recaptcha-response\" style=\"width: 250px; height: 40px; border: 1px solid rgb(193, 193, 193); margin: 10px 25px; padding: 0px; resize: none; display: none;\"></textarea></div><iframe style=\"display: none;\"></iframe></div>\n\t          <div class=\"input-wrapper\">\n\t            <input placeholder=\"Email\" name=\"email\" type=\"email\" required=\"required\" class=\"\">\n\t            <div class=\"messages\">\n\t              <div class=\"message message--error\">Something went wrong. Please try again later.</div>\n\t              <div class=\"message message--success\">Subscribed!</div>\n\t            </div>\n\t          </div>\n\t          <button type=\"submit\" class=\"submit-btn\">Subscribe</button>\n\t        </form>\n\t      </div>\n\t    </div>\n    </div>\n\t\t<div class=\"post-share-section\">\n\t<div class=\"post-share-wrap\">\n\t\t<a href=\"https://twitter.com/intent/tweet?text=How%20to%20extract%20data%20from%20PDF%20to%20Excel%2FSpreadsheet%3A%20Advance%20parsing%20with%20n8n.io%20and%20LlamaParse&amp;url=https://blog.n8n.io/how-to-extract-data-from-pdf-to-excel-spreadsheet-advance-parsing-with-n8n-io-and-llamaparse/\" target=\"_blank\" rel=\"noopener\" aria-label=\"Twitter share icon\"><svg role=\"img\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M23.954 4.569c-.885.389-1.83.654-2.825.775 1.014-.611 1.794-1.574 2.163-2.723-.951.555-2.005.959-3.127 1.184-.896-.959-2.173-1.559-3.591-1.559-2.717 0-4.92 2.203-4.92 4.917 0 .39.045.765.127 1.124C7.691 8.094 4.066 6.13 1.64 3.161c-.427.722-.666 1.561-.666 2.475 0 1.71.87 3.213 2.188 4.096-.807-.026-1.566-.248-2.228-.616v.061c0 2.385 1.693 4.374 3.946 4.827-.413.111-.849.171-1.296.171-.314 0-.615-.03-.916-.086.631 1.953 2.445 3.377 4.604 3.417-1.68 1.319-3.809 2.105-6.102 2.105-.39 0-.779-.023-1.17-.067 2.189 1.394 4.768 2.209 7.557 2.209 9.054 0 13.999-7.496 13.999-13.986 0-.209 0-.42-.015-.63.961-.689 1.8-1.56 2.46-2.548l-.047-.02z\"></path></svg></a>\n\t\t<a href=\"https://www.facebook.com/sharer/sharer.php?u=https://blog.n8n.io/how-to-extract-data-from-pdf-to-excel-spreadsheet-advance-parsing-with-n8n-io-and-llamaparse/\" target=\"_blank\" rel=\"noopener\" aria-label=\"Facebook share icon\"><svg role=\"img\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M23.9981 11.9991C23.9981 5.37216 18.626 0 11.9991 0C5.37216 0 0 5.37216 0 11.9991C0 17.9882 4.38789 22.9522 10.1242 23.8524V15.4676H7.07758V11.9991H10.1242V9.35553C10.1242 6.34826 11.9156 4.68714 14.6564 4.68714C15.9692 4.68714 17.3424 4.92149 17.3424 4.92149V7.87439H15.8294C14.3388 7.87439 13.8739 8.79933 13.8739 9.74824V11.9991H17.2018L16.6698 15.4676H13.8739V23.8524C19.6103 22.9522 23.9981 17.9882 23.9981 11.9991Z\"></path></svg></a>\n\t\t<!-- <a href=\"javascript:\" class=\"post-share-link\" id=\"copy\" data-clipboard-target=\"#copy-link\" aria-label=\"Copy link icon\"><svg role=\"img\" viewBox=\"0 0 33 24\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M27.3999996,13.4004128 L21.7999996,13.4004128 L21.7999996,19 L18.9999996,19 L18.9999996,13.4004128 L13.3999996,13.4004128 L13.3999996,10.6006192 L18.9999996,10.6006192 L18.9999996,5 L21.7999996,5 L21.7999996,10.6006192 L27.3999996,10.6006192 L27.3999996,13.4004128 Z M12,20.87 C7.101,20.87 3.13,16.898 3.13,12 C3.13,7.102 7.101,3.13 12,3.13 C12.091,3.13 12.181,3.139 12.272,3.142 C9.866,5.336 8.347,8.487 8.347,12 C8.347,15.512 9.866,18.662 12.271,20.857 C12.18,20.859 12.091,20.87 12,20.87 Z M20.347,0 C18.882,0 17.484,0.276 16.186,0.756 C14.882,0.271 13.473,0 12,0 C5.372,0 0,5.373 0,12 C0,18.628 5.372,24 12,24 C13.471,24 14.878,23.726 16.181,23.242 C17.481,23.724 18.88,24 20.347,24 C26.975,24 32.347,18.628 32.347,12 C32.347,5.373 26.975,0 20.347,0 Z\"/></svg></a>\n\t\t<small class=\"share-link-info\">The link has been copied!</small> -->\n\t</div>\n\t<input type=\"text\" value=\"https://blog.n8n.io/how-to-extract-data-from-pdf-to-excel-spreadsheet-advance-parsing-with-n8n-io-and-llamaparse/\" id=\"copy-link\" aria-label=\"Copy link input\">\n</div>",
  "readme": "In this article, we’ll learn how to integrate LlamaParse into n8n for automated invoice parsing and data extraction.\n\nIf you’ve ever tried to automate document parsing for invoices, remittance notes, order forms or similar, you quickly realize that extracting table data from PDFs isn’t easy due to limitations with available parsing solutions. Third party professional OCR software technologies are expensive and slow whilst naive PDF-to-text converters lose all tabular structure making it near impossible to workaround for larger documents.\n\nEnter LlamaParse, a new sophisticated document parsing service from LlamaIndex.ai. Parsing and understanding PDFs has become an increasingly popular problem space for Large Language Models (LLMs) and so LLamaParse was built for this very purpose. LlamaParse works by converting PDF tables to Markdown tables which are easier for LLMs to understand and thus allow LLMs to identify and extract table data more accurately.\n\n### Parsing and Extracting from Email Invoices\n\nIn this article, we’ll use the scenario where we receive PDF invoices by email which need to be reconciled by entering the details into a spreadsheet. We’ll use n8n to automate the entire process; from downloading the PDF attachment from the email, handing it off to LLamaParse for processing, using AI to extract the invoice data and finally writing it to our spreadsheet.\n\n![OpenAI Model](data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTM2Ljg2NzEgMTYuMzcxOEMzNy43NzQ2IDEzLjY0OCAzNy40NjIxIDEwLjY2NDIgMzYuMDEwOCA4LjE4NjYxQzMzLjgyODIgNC4zODY1MyAyOS40NDA3IDIuNDMxNDkgMjUuMTU1NiAzLjM1MTUxQzIzLjI0OTMgMS4yMDM5NiAyMC41MTA1IC0wLjAxNzMxNDggMTcuNjM5MiAwLjAwMDE4NTUzM0MxMy4yNTkxIC0wLjAwOTgxNDY4IDkuMzcyNzMgMi44MTAyNSA4LjAyNTIgNi45Nzc4M0M1LjIxMTM5IDcuNTU0MSAyLjc4MjU4IDkuMzE1MzggMS4zNjEzIDExLjgxMTdDLTAuODM3NDkzIDE1LjYwMTggLTAuMzM2MjMyIDIwLjM3OTQgMi42MDEzMyAyMy42Mjk0QzEuNjkzODEgMjYuMzUzMiAyLjAwNjMyIDI5LjMzNzEgMy40NTc2IDMxLjgxNDZDNS42NDAxNSAzNS42MTQ3IDEwLjAyNzcgMzcuNTY5NyAxNC4zMTI4IDM2LjY0OTdDMTYuMjE3OSAzOC43OTczIDE4Ljk1NzkgNDAuMDE4NSAyMS44MjkyIDM5Ljk5OThDMjYuMjExOCA0MC4wMTEgMzAuMDk5NCAzNy4xODg1IDMxLjQ0NjkgMzMuMDE3MUMzNC4yNjA4IDMyLjQ0MDkgMzYuNjg5NiAzMC42Nzk2IDM4LjExMDggMjguMTgzM0M0MC4zMDcxIDI0LjM5MzIgMzkuODA0NiAxOS42MTk0IDM2Ljg2ODMgMTYuMzY5M0wzNi44NjcxIDE2LjM3MThaTTIxLjgzMTcgMzcuMzg2QzIwLjA3OCAzNy4zODg1IDE4LjM3OTIgMzYuNzc0NyAxNy4wMzI5IDM1LjY1MDlDMTcuMDk0MSAzNS42MTg0IDE3LjIwMDQgMzUuNTU5NyAxNy4yNjkxIDM1LjUxNzJMMjUuMjM0MyAzMC45MTcxQzI1LjY0MTggMzAuNjg1OCAyNS44OTE4IDMwLjI1MjEgMjUuODg5MyAyOS43ODMzVjE4LjU1NDNMMjkuMjU1NyAyMC40OTgxQzI5LjI5MTkgMjAuNTE1NiAyOS4zMTU3IDIwLjU1MDYgMjkuMzIwNyAyMC41OTA2VjI5Ljg4OTZDMjkuMzE1NyAzNC4wMjQ3IDI1Ljk2NjggMzcuMzc3MiAyMS44MzE3IDM3LjM4NlpNNS43MjY0IDMwLjUwNzFDNC44NDc2MyAyOC45ODk2IDQuNTMxMzcgMjcuMjEwOCA0LjgzMjYzIDI1LjQ4NDVDNC44OTEzOCAyNS41MTk1IDQuOTk1MTMgMjUuNTgzMiA1LjA2ODg4IDI1LjYyNTdMMTMuMDM0MSAzMC4yMjU4QzEzLjQzNzggMzAuNDYyMSAxMy45Mzc4IDMwLjQ2MjEgMTQuMzQyOCAzMC4yMjU4TDI0LjA2NjggMjQuNjEwN1YyOC40OTgzQzI0LjA2OTMgMjguNTM4MyAyNC4wNTA1IDI4LjU3NyAyNC4wMTkzIDI4LjYwMkwxNS45Njc5IDMzLjI1MDlDMTIuMzgxNSAzNS4zMTU5IDcuODAxNDQgMzQuMDg4NCA1LjcyNzY1IDMwLjUwNzFINS43MjY0Wk0zLjYzMDEgMTMuMTIwNUM0LjUwNTEyIDExLjYwMDQgNS44ODY0IDEwLjQzNzkgNy41MzE0NCA5LjgzNDE1QzcuNTMxNDQgOS45MDI5IDcuNTI3NjkgMTAuMDI0MiA3LjUyNzY5IDEwLjEwOTJWMTkuMzEwNkM3LjUyNTE5IDE5Ljc3ODEgNy43NzUxOSAyMC4yMTE5IDguMTgxNDUgMjAuNDQzMUwxNy45MDU0IDI2LjA1N0wxNC41MzkxIDI4LjAwMDhDMTQuNTA1MyAyOC4wMjMzIDE0LjQ2MjggMjguMDI3IDE0LjQyNTMgMjguMDEwOEw2LjM3MjY2IDIzLjM1ODJDMi43OTM4MyAyMS4yODU2IDEuNTY2MzEgMTYuNzA2OCAzLjYyODg1IDEzLjEyMTdMMy42MzAxIDEzLjEyMDVaTTMxLjI4ODIgMTkuNTU2OUwyMS41NjQyIDEzLjk0MTdMMjQuOTMwNiAxMS45OTkyQzI0Ljk2NDMgMTEuOTc2NyAyNS4wMDY4IDExLjk3MjkgMjUuMDQ0MyAxMS45ODkyTDMzLjA5NyAxNi42MzhDMzYuNjgyMSAxOC43MDkzIDM3LjkxMDggMjMuMjk1NyAzNS44Mzk1IDI2Ljg4MDhDMzQuOTYzMyAyOC4zOTgzIDMzLjU4MzIgMjkuNTYwOCAzMS45Mzk1IDMwLjE2NThWMjAuNjg5NEMzMS45NDMyIDIwLjIyMTkgMzEuNjk0NSAxOS43ODk0IDMxLjI4OTQgMTkuNTU2OUgzMS4yODgyWk0zNC42MzgzIDE0LjUxNDJDMzQuNTc5NSAxNC40NzggMzQuNDc1OCAxNC40MTU1IDM0LjQwMiAxNC4zNzNMMjYuNDM2OCA5Ljc3Mjg5QzI2LjAzMzEgOS41MzY2NCAyNS41MzMxIDkuNTM2NjQgMjUuMTI4MSA5Ljc3Mjg5TDE1LjQwNDEgMTUuMzg4VjExLjUwMDRDMTUuNDAxNiAxMS40NjA0IDE1LjQyMDQgMTEuNDIxNyAxNS40NTE2IDExLjM5NjdMMjMuNTAzIDYuNzUxNThDMjcuMDg5NCA0LjY4Mjc5IDMxLjY3NDUgNS45MTQwNiAzMy43NDIgOS41MDE2NEMzNC42MTU4IDExLjAxNjcgMzQuOTMyIDEyLjc5MDUgMzQuNjM1OCAxNC41MTQySDM0LjYzODNaTTEzLjU3NDEgMjEuNDQzMUwxMC4yMDY1IDE5LjQ5OTRDMTAuMTcwMiAxOS40ODE5IDEwLjE0NjUgMTkuNDQ2OCAxMC4xNDE1IDE5LjQwNjhWMTAuMTA3OUMxMC4xNDQgNS45Njc4MSAxMy41MDI4IDIuNjEyNzQgMTcuNjQyOSAyLjYxNTI0QzE5LjM5NDIgMi42MTUyNCAyMS4wODkyIDMuMjMwMjUgMjIuNDM1NSA0LjM1MDI4QzIyLjM3NDMgNC4zODI3OCAyMi4yNjkzIDQuNDQxNTMgMjIuMTk5MiA0LjQ4NDAzTDE0LjIzNDEgOS4wODQxM0MxMy44MjY2IDkuMzE1MzggMTMuNTc2NiA5Ljc0Nzg5IDEzLjU3OTEgMTAuMjE2N0wxMy41NzQxIDIxLjQ0MDZWMjEuNDQzMVpNMTUuNDAyOSAxNy41MDA2TDE5LjczNDIgMTQuOTk5M0wyNC4wNjU1IDE3LjQ5OTNWMjIuNTAwN0wxOS43MzQyIDI1LjAwMDdMMTUuNDAyOSAyMi41MDA3VjE3LjUwMDZaIiBmaWxsPSIjN0Q3RDg3Ii8+Cjwvc3ZnPgo=) __![HTTP Request](data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik00MCAyMEM0MCA4Ljk1MzE0IDMxLjA0NjkgMCAyMCAwQzguOTUzMTQgMCAwIDguOTUzMTQgMCAyMEMwIDMxLjA0NjkgOC45NTMxNCA0MCAyMCA0MEMzMS4wNDY5IDQwIDQwIDMxLjA0NjkgNDAgMjBaTTIwIDM2Ljk0NThDMTguODg1MiAzNi45NDU4IDE3LjEzNzggMzUuOTY3IDE1LjQ5OTggMzIuNjk4NUMxNC43OTY0IDMxLjI5MTggMTQuMTk2MSAyOS41NDMxIDEzLjc1MjYgMjcuNjg0N0gyNi4xODk4QzI1LjgwNDUgMjkuNTQwMyAyNS4yMDQ0IDMxLjI5MDEgMjQuNTAwMiAzMi42OTg1QzIyLjg2MjIgMzUuOTY3IDIxLjExNDggMzYuOTQ1OCAyMCAzNi45NDU4Wk0xMi45MDY0IDIwQzEyLjkwNjQgMjEuNjA5NyAxMy4wMDg3IDIzLjE2NCAxMy4yMDAzIDI0LjYzMDVIMjYuNzk5N0MyNi45OTEzIDIzLjE2NCAyNy4wOTM2IDIxLjYwOTcgMjcuMDkzNiAyMEMyNy4wOTM2IDE4LjM5MDMgMjYuOTkxMyAxNi44MzYgMjYuNzk5NyAxNS4zNjk1SDEzLjIwMDNDMTMuMDA4NyAxNi44MzYgMTIuOTA2NCAxOC4zOTAzIDEyLjkwNjQgMjBaTTIwIDMuMDU0MTlDMjEuMTE0OSAzLjA1NDE5IDIyLjg2MjIgNC4wMzA3OCAyNC41MDAxIDcuMzAwMzlDMjUuMjA2NiA4LjcxNDA4IDI1LjgwNzIgMTAuNDA2NyAyNi4xOTIgMTIuMzE1M0gxMy43NTAxQzE0LjE5MzMgMTAuNDA0NyAxNC43OTQyIDguNzEyNTQgMTUuNDk5OCA3LjMwMDY0QzE3LjEzNzcgNC4wMzA4MyAxOC44ODUxIDMuMDU0MTkgMjAgMy4wNTQxOVpNMzAuMTQ3OCAyMEMzMC4xNDc4IDE4LjQwOTkgMzAuMDU0MyAxNi44NjE3IDI5LjgyMjcgMTUuMzY5NUgzNi4zMDQyQzM2LjcyNTIgMTYuODQyIDM2Ljk0NTggMTguMzk2NCAzNi45NDU4IDIwQzM2Ljk0NTggMjEuNjAzNiAzNi43MjUyIDIzLjE1OCAzNi4zMDQyIDI0LjYzMDVIMjkuODIyN0MzMC4wNTQzIDIzLjEzODMgMzAuMTQ3OCAyMS41OTAxIDMwLjE0NzggMjBaTTI2LjI3NjcgNC4yNTUxMkMyNy42MzY1IDYuMzYwMTkgMjguNzExIDkuMTMyIDI5LjM3NzQgMTIuMzE1M0gzNS4xMDQ2QzMzLjI1MTEgOC42NjggMzAuMTA3IDUuNzgzNDYgMjYuMjc2NyA0LjI1NTEyWk0xMC42MjI2IDEyLjMxNTNINC44OTI5M0M2Ljc1MTQ3IDguNjY3ODQgOS44OTM1MSA1Ljc4MzQxIDEzLjcyMzIgNC4yNTUxM0MxMi4zNjM1IDYuMzYwMjEgMTEuMjg5IDkuMTMyMDEgMTAuNjIyNiAxMi4zMTUzWk0zLjA1NDE5IDIwQzMuMDU0MTkgMjEuNjAzIDMuMjc3NDMgMjMuMTU3NSAzLjY5NDg0IDI0LjYzMDVIMTAuMTIxN0M5Ljk0NjE5IDIzLjE0MiA5Ljg1MjIyIDIxLjU5NDMgOS44NTIyMiAyMEM5Ljg1MjIyIDE4LjQwNTcgOS45NDYxOSAxNi44NTggMTAuMTIxNyAxNS4zNjk1SDMuNjk0ODRDMy4yNzc0MyAxNi44NDI1IDMuMDU0MTkgMTguMzk3IDMuMDU0MTkgMjBaTTI2LjI3NjYgMzUuNzQyN0MyNy42MzY1IDMzLjYzOTMgMjguNzExIDMwLjg2OCAyOS4zNzc0IDI3LjY4NDdIMzUuMTA0NkMzMy4yNTEgMzEuMzMyMiAzMC4xMDY4IDM0LjIxNzkgMjYuMjc2NiAzNS43NDI3Wk0xMy43MjM0IDM1Ljc0MjdDOS44OTM2OSAzNC4yMTc5IDYuNzUxNTUgMzEuMzMyNCA0Ljg5MjkzIDI3LjY4NDdIMTAuNjIyNkMxMS4yODkgMzAuODY4IDEyLjM2MzUgMzMuNjM5MyAxMy43MjM0IDM1Ljc0MjdaIiBmaWxsPSIjM0E0MkU5Ii8+Cjwvc3ZnPgo=) __![Gmail Trigger](data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNTYiIGhlaWdodD0iMTkzIiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJ4TWlkWU1pZCI+PHBhdGggZmlsbD0iIzQyODVGNCIgZD0iTTU4LjE4MiAxOTIuMDVWOTMuMTRMMjcuNTA3IDY1LjA3NyAwIDQ5LjUwNHYxMjUuMDkxYzAgOS42NTggNy44MjUgMTcuNDU1IDE3LjQ1NSAxNy40NTV6Ii8+PHBhdGggZmlsbD0iIzM0QTg1MyIgZD0iTTE5Ny44MTggMTkyLjA1aDQwLjcyN2M5LjY1OSAwIDE3LjQ1NS03LjgyNiAxNy40NTUtMTcuNDU1VjQ5LjUwNWwtMzEuMTU2IDE3LjgzNy0yNy4wMjYgMjUuNzk4eiIvPjxwYXRoIGZpbGw9IiNFQTQzMzUiIGQ9Im01OC4xODIgOTMuMTQtNC4xNzQtMzguNjQ3IDQuMTc0LTM2Ljk4OUwxMjggNjkuODY4bDY5LjgxOC01Mi4zNjQgNC42NyAzNC45OTItNC42NyA0MC42NDRMMTI4IDE0NS41MDR6Ii8+PHBhdGggZmlsbD0iI0ZCQkMwNCIgZD0iTTE5Ny44MTggMTcuNTA0VjkzLjE0TDI1NiA0OS41MDRWMjYuMjMxYzAtMjEuNTg1LTI0LjY0LTMzLjg5LTQxLjg5LTIwLjk0NXoiLz48cGF0aCBmaWxsPSIjQzUyMjFGIiBkPSJtMCA0OS41MDQgMjYuNzU5IDIwLjA3TDU4LjE4MiA5My4xNFYxNy41MDRMNDEuODkgNS4yODZDMjQuNjEtNy42NiAwIDQuNjQ2IDAgMjYuMjN6Ii8+PC9zdmc+) +5\n\n[Invoice data extraction with LlamaParse and OpenAI](https://n8n.io/workflows/2320-invoice-data-extraction-with-llamaparse-and-openai/)\n\nby jimleuk\n\n[ Use this workflow ](https://n8n.io/workflows/2320-invoice-data-extraction-with-llamaparse-and-openai/)\n\n### Prerequisites\n\n  * **A cloud-hosted or self-hosted version of n8n**.  \nEasiest way is to sign up for an n8n account at https://n8n.io. The workflow template in this article can be imported without having to rebuild the steps.\n  * **A LlamaIndex cloud account and API key.**  \nYou can get one by signing up for a free account at  [https://cloud.llamaIndex.ai](https://cloud.llamaindex.ai/?ref=blog.n8n.io)\n  * **OpenAI account and API key**.  \nYou can find instructions here https://openai.com/blog/openai-api\n\n\n\n### Step 1: Setting up our LlamaParse Credentials in n8n\n\nTo use LlamaParse, we first need a LlamaParse API key which we can get for free by signing up to [https://cloud.llamaIndex.ai](https://cloud.llamaindex.ai/?ref=blog.n8n.io). At time of writing, LlamaIndex is offering a free tier which allows for 1000 uploads a day.\n\n![](https://lh7-us.googleusercontent.com/docsz/AD_4nXcXF1pfVHyZpy6yopXZNLxDuz7GR-SOmQpSPdfQq6LeYB8rOuxOr5UtQN5prcQO1ubLvgs1V5OSOvAqQYGRtV1ismbCZ7cwNl24pWpIXbqp_m3i23Mjv7LvVweEI9CdBZKEixSQfM9Sy1xaYhmopla7pXZ_?key=LTiwkbhFEiOqSdlXhq93RA)\n\nOnce you have the LlamaParse API key, create a **Header Auth Credential** that we will use when making calls to the LlamaParse API in our n8n workflow.\n\n  * Go to the **Credentials** tab\n  * Click the **Add Credential** button\n  * Search for **Header Auth**\n  * Enter \"Bearer <API Key>\" into the **Value** input box and click **Save.**\n\n![](https://blog.n8n.io/content/images/2024/09/Screenshot-2024-09-19-at-13.17.29.png)\n\n### Step 2: Create the LlamaParse API workflow\n\nSince n8n does not have a built-in node for LlamaParse, we’ll have to work directly with the LlamaIndex API. Don’t worry, this is quite manageable as there are only 3 APIs calls we need to make.\n\n  1. API call to upload a PDF to the LlamaParse service.  \n[https://docs.cloud.llamaindex.ai/API/upload-file-api-v-1-parsing-upload-post](https://docs.cloud.llamaindex.ai/API/upload-file-api-v-1-parsing-upload-post?ref=blog.n8n.io)\n  2. API call to query the status of the PDF processing job. This may take longer if the PDF is large.  \n[https://docs.cloud.llamaindex.ai/API/get-job-api-v-1-parsing-job-job-id-get](https://docs.cloud.llamaindex.ai/API/get-job-api-v-1-parsing-job-job-id-get?ref=blog.n8n.io)\n  3. API call to fetch the parsed output of the PDF once the job is completed.  \n[https://docs.cloud.llamaindex.ai/API/get-job-raw-md-result-api-v-1-parsing-job-job-id-result-raw-markdown-get](https://docs.cloud.llamaindex.ai/API/get-job-raw-md-result-api-v-1-parsing-job-job-id-result-raw-markdown-get?ref=blog.n8n.io)\n\n\n\nHere, I’ve implemented this flow using the HTTP request node, a SWITCH node to determine if the job is completed otherwise to query again and a WAIT node to throttle calls to stay within API service rate limits.\n\n![](https://lh7-us.googleusercontent.com/docsz/AD_4nXdwuV6L4MF8xsel5bOq1h6qhwKgts6r5GLY5rPfiL8ruGJPRxkPizX6IpQNYeKs_OwBeNt4OvoAwe1XfRrnrk6qK0QdUS0d_FVhn0-sbCQC1KITJbIOyRPeZxL_71vD3EtIxX2jCDuHIdse4aRkgJFwan0?key=LTiwkbhFEiOqSdlXhq93RA)\n\n### Step 3. Data Extraction using OpenAI GPT-4o  \n\n\nTo extract the data from our parsed PDF output, we’ll use the **LLM Basic Chain** to feed it to the **OpenAI GPT-4o Model** and ask the model to pull out the relevant invoice data attributes we care about. Here’s the list of attributes we want for our scenario:\n\n  * Invoice date\n  * Invoice number and Purchase order number\n  * Supplier name and address, VAT identification number\n  * Customer name and address\n  * Any shipping addresses\n  * Line items, including a description of the goods or services rendered\n  * Price with and without VAT and the total price\n\n\n\nThe output should be JSON formatted so that we may easily insert this data as a row in our reconciliation spreadsheet. To achieve this, it is important that we use the **Structured Output Parser** and give it a JSON schema for the desired attributes.\n\n![](https://lh7-us.googleusercontent.com/docsz/AD_4nXfECdOftYaC30ZK32YVcyct2xS3A_sbV0UsPhjv_NmIL_tWqMcA19Uz1JVRbXinks6AVvB85VXziPLTwTvlLVDpqQtIqOgIYKY1k3OduCc1EQITcBcpcYCv-tpQllusNmRfKMd8vmouwNuMj_-ncpGacFaU?key=LTiwkbhFEiOqSdlXhq93RA)![](https://lh7-us.googleusercontent.com/docsz/AD_4nXeYnr6EjJkwd42IpAp5KylrRF0FjEOjfCqCRuZIXkZwdrMtzgqxIH0ZzY3bAdIT3IAv_qZMC3hwTuOWaXf9yd-jWOFEb3H1D_AkijZMfytbxz0Qv-4-Qe5LQDgoTJS-b6CujIw1HOTh1nbETG532qr6qp15?key=LTiwkbhFEiOqSdlXhq93RA)![](https://lh7-us.googleusercontent.com/docsz/AD_4nXd2P-7RnePYNnmHTELiEbGirmwcSVqCGD7vAFdhvn6BxJ46JHdrieXIh5VWJrIJ9pSOtLdL7clXaiztN9SeIGn6l6xFOcKyLWRiKi4-whx1KVEe5fm7m8pCFnQglrVj7sFNkIW1OT-y4r8leKA9cXDIT4Eh?key=LTiwkbhFEiOqSdlXhq93RA)\n\n### Step 4. Add Email Trigger to Start Capture Invoices!\n\nNow that the hard work has been done, we can set up a simple email trigger to watch for invoices as they come through. Depending on how you receive the invoices, you may need to filter based on subject line, labels or checking for attachments.\n\n  * Create an Email Trigger Node for your workflow\n  * Set an interval of how often the workflow should watch the inbox for new invoices.\n  * Under filters, apply any criteria which will help get actual email invoices sent to the workflow.\n  * Under options, be sure to check the option to download attachments. We’ll need this to get the actual pdf from the invoice. If you have multiple invoices, you may need to process them individually.\n\n![](https://lh7-us.googleusercontent.com/docsz/AD_4nXcmOK-XNXVNrTmT6CbEubRnOmcMGwBnNHpH-yGH7_rIvaNTEgBk6-aArhiAqQvtByID2o8eOFYJ6lp03mdu7-M4Mi8Brm9UG-I841aveaKiuUhq6KffhjrJAcq8iq2aS3ucvs5X4uzVx7ABYqFiUPxlhf8_?key=LTiwkbhFEiOqSdlXhq93RA)![](https://lh7-us.googleusercontent.com/docsz/AD_4nXcm9Ry7pO__X0op_o4H-8in09JtZkWoJzd_zK3bH0v-H8GPwdc1KQ7BXfuqwaRxwTukgpl9TMuncku5DWAkR8qszeRbr230mlkaH1L2ArIRgNqbMUKykR-vGpbCo3TMPVYFDMWdRC5aGFWy6748P7H8xSm5?key=LTiwkbhFEiOqSdlXhq93RA)\n\n### Step 5. Done!\n\nIn this article, we’ve successfully implemented a powerful AI-based PDF parsing and data extraction not only for invoices but for any PDF document with tabular data in n8n.\n\nUtilizing powerful parsers like LlamaParse and models like GPT-4o for this use-case can provide significant productivity benefits at a fraction of the cost to traditional solutions such as OCR, whilst using n8n provides a simple no-code automation solution to reduce development and maintenance costs.\n\n## Subscribe to n8n newsletter\n\nGet the best, coolest, and latest in automation and low-code delivered to your inbox each week. \n\nSomething went wrong. Please try again later.\n\nSubscribed!\n\nSubscribe\n\n[](https://twitter.com/intent/tweet?text=How%20to%20extract%20data%20from%20PDF%20to%20Excel%2FSpreadsheet%3A%20Advance%20parsing%20with%20n8n.io%20and%20LlamaParse&url=https://blog.n8n.io/how-to-extract-data-from-pdf-to-excel-spreadsheet-advance-parsing-with-n8n-io-and-llamaparse/) [](https://www.facebook.com/sharer/sharer.php?u=https://blog.n8n.io/how-to-extract-data-from-pdf-to-excel-spreadsheet-advance-parsing-with-n8n-io-and-llamaparse/)\n",
  "crawled_at": "2025-05-28T10:49:27.038920"
}